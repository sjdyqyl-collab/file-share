<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: deployment_dag Pages: 1 -->
<svg width="1440pt" height="1019pt"
 viewBox="0.00 0.00 1440.00 1018.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.34 0.34) rotate(0) translate(4 3003.43)">
<title>deployment_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3003.43 4246.15,-3003.43 4246.15,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<path fill="#000000" stroke="blue" d="M20,-2736.93C20,-2736.93 207,-2736.93 207,-2736.93 213,-2736.93 219,-2742.93 219,-2748.93 219,-2748.93 219,-2973.43 219,-2973.43 219,-2979.43 213,-2985.43 207,-2985.43 207,-2985.43 20,-2985.43 20,-2985.43 14,-2985.43 8,-2979.43 8,-2973.43 8,-2973.43 8,-2748.93 8,-2748.93 8,-2742.93 14,-2736.93 20,-2736.93"/>
<text text-anchor="middle" x="113.5" y="-2970.23" font-family="Times,serif" font-size="14.00">GPU 0 (H100)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_1</title>
<path fill="#000000" stroke="blue" d="M239,-2556.93C239,-2556.93 426,-2556.93 426,-2556.93 432,-2556.93 438,-2562.93 438,-2568.93 438,-2568.93 438,-2802.43 438,-2802.43 438,-2808.43 432,-2814.43 426,-2814.43 426,-2814.43 239,-2814.43 239,-2814.43 233,-2814.43 227,-2808.43 227,-2802.43 227,-2802.43 227,-2568.93 227,-2568.93 227,-2562.93 233,-2556.93 239,-2556.93"/>
<text text-anchor="middle" x="332.5" y="-2799.23" font-family="Times,serif" font-size="14.00">GPU 1 (H100)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_2</title>
<path fill="#000000" stroke="blue" d="M458,-2376.93C458,-2376.93 645,-2376.93 645,-2376.93 651,-2376.93 657,-2382.93 657,-2388.93 657,-2388.93 657,-2622.43 657,-2622.43 657,-2628.43 651,-2634.43 645,-2634.43 645,-2634.43 458,-2634.43 458,-2634.43 452,-2634.43 446,-2628.43 446,-2622.43 446,-2622.43 446,-2388.93 446,-2388.93 446,-2382.93 452,-2376.93 458,-2376.93"/>
<text text-anchor="middle" x="551.5" y="-2619.23" font-family="Times,serif" font-size="14.00">GPU 2 (H100)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu_3</title>
<path fill="#000000" stroke="blue" d="M677,-2196.93C677,-2196.93 864,-2196.93 864,-2196.93 870,-2196.93 876,-2202.93 876,-2208.93 876,-2208.93 876,-2442.43 876,-2442.43 876,-2448.43 870,-2454.43 864,-2454.43 864,-2454.43 677,-2454.43 677,-2454.43 671,-2454.43 665,-2448.43 665,-2442.43 665,-2442.43 665,-2208.93 665,-2208.93 665,-2202.93 671,-2196.93 677,-2196.93"/>
<text text-anchor="middle" x="770.5" y="-2439.23" font-family="Times,serif" font-size="14.00">GPU 3 (H100)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu_4</title>
<path fill="#000000" stroke="blue" d="M896,-2016.93C896,-2016.93 1083,-2016.93 1083,-2016.93 1089,-2016.93 1095,-2022.93 1095,-2028.93 1095,-2028.93 1095,-2262.43 1095,-2262.43 1095,-2268.43 1089,-2274.43 1083,-2274.43 1083,-2274.43 896,-2274.43 896,-2274.43 890,-2274.43 884,-2268.43 884,-2262.43 884,-2262.43 884,-2028.93 884,-2028.93 884,-2022.93 890,-2016.93 896,-2016.93"/>
<text text-anchor="middle" x="989.5" y="-2259.23" font-family="Times,serif" font-size="14.00">GPU 4 (H100)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_5</title>
<path fill="#000000" stroke="blue" d="M1115,-1836.93C1115,-1836.93 1302,-1836.93 1302,-1836.93 1308,-1836.93 1314,-1842.93 1314,-1848.93 1314,-1848.93 1314,-2082.43 1314,-2082.43 1314,-2088.43 1308,-2094.43 1302,-2094.43 1302,-2094.43 1115,-2094.43 1115,-2094.43 1109,-2094.43 1103,-2088.43 1103,-2082.43 1103,-2082.43 1103,-1848.93 1103,-1848.93 1103,-1842.93 1109,-1836.93 1115,-1836.93"/>
<text text-anchor="middle" x="1208.5" y="-2079.23" font-family="Times,serif" font-size="14.00">GPU 5 (H100)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu_6</title>
<path fill="#000000" stroke="blue" d="M1334,-1656.93C1334,-1656.93 1521,-1656.93 1521,-1656.93 1527,-1656.93 1533,-1662.93 1533,-1668.93 1533,-1668.93 1533,-1902.43 1533,-1902.43 1533,-1908.43 1527,-1914.43 1521,-1914.43 1521,-1914.43 1334,-1914.43 1334,-1914.43 1328,-1914.43 1322,-1908.43 1322,-1902.43 1322,-1902.43 1322,-1668.93 1322,-1668.93 1322,-1662.93 1328,-1656.93 1334,-1656.93"/>
<text text-anchor="middle" x="1427.5" y="-1899.23" font-family="Times,serif" font-size="14.00">GPU 6 (H100)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu_7</title>
<path fill="#000000" stroke="blue" d="M1553,-1476.93C1553,-1476.93 1740,-1476.93 1740,-1476.93 1746,-1476.93 1752,-1482.93 1752,-1488.93 1752,-1488.93 1752,-1722.43 1752,-1722.43 1752,-1728.43 1746,-1734.43 1740,-1734.43 1740,-1734.43 1553,-1734.43 1553,-1734.43 1547,-1734.43 1541,-1728.43 1541,-1722.43 1541,-1722.43 1541,-1488.93 1541,-1488.93 1541,-1482.93 1547,-1476.93 1553,-1476.93"/>
<text text-anchor="middle" x="1646.5" y="-1719.23" font-family="Times,serif" font-size="14.00">GPU 7 (H100)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu_8</title>
<path fill="#000000" stroke="blue" d="M1772,-1296.93C1772,-1296.93 1959,-1296.93 1959,-1296.93 1965,-1296.93 1971,-1302.93 1971,-1308.93 1971,-1308.93 1971,-1542.43 1971,-1542.43 1971,-1548.43 1965,-1554.43 1959,-1554.43 1959,-1554.43 1772,-1554.43 1772,-1554.43 1766,-1554.43 1760,-1548.43 1760,-1542.43 1760,-1542.43 1760,-1308.93 1760,-1308.93 1760,-1302.93 1766,-1296.93 1772,-1296.93"/>
<text text-anchor="middle" x="1865.5" y="-1539.23" font-family="Times,serif" font-size="14.00">GPU 8 (H100)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu_9</title>
<path fill="#000000" stroke="blue" d="M1991,-1116.93C1991,-1116.93 2178,-1116.93 2178,-1116.93 2184,-1116.93 2190,-1122.93 2190,-1128.93 2190,-1128.93 2190,-1362.43 2190,-1362.43 2190,-1368.43 2184,-1374.43 2178,-1374.43 2178,-1374.43 1991,-1374.43 1991,-1374.43 1985,-1374.43 1979,-1368.43 1979,-1362.43 1979,-1362.43 1979,-1128.93 1979,-1128.93 1979,-1122.93 1985,-1116.93 1991,-1116.93"/>
<text text-anchor="middle" x="2084.5" y="-1359.23" font-family="Times,serif" font-size="14.00">GPU 9 (H100)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_10</title>
<path fill="#000000" stroke="blue" d="M2210,-936.93C2210,-936.93 2397,-936.93 2397,-936.93 2403,-936.93 2409,-942.93 2409,-948.93 2409,-948.93 2409,-1182.43 2409,-1182.43 2409,-1188.43 2403,-1194.43 2397,-1194.43 2397,-1194.43 2210,-1194.43 2210,-1194.43 2204,-1194.43 2198,-1188.43 2198,-1182.43 2198,-1182.43 2198,-948.93 2198,-948.93 2198,-942.93 2204,-936.93 2210,-936.93"/>
<text text-anchor="middle" x="2303.5" y="-1179.23" font-family="Times,serif" font-size="14.00">GPU 10 (H100)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_11</title>
<path fill="#000000" stroke="blue" d="M2429,-756.93C2429,-756.93 2616,-756.93 2616,-756.93 2622,-756.93 2628,-762.93 2628,-768.93 2628,-768.93 2628,-1002.43 2628,-1002.43 2628,-1008.43 2622,-1014.43 2616,-1014.43 2616,-1014.43 2429,-1014.43 2429,-1014.43 2423,-1014.43 2417,-1008.43 2417,-1002.43 2417,-1002.43 2417,-768.93 2417,-768.93 2417,-762.93 2423,-756.93 2429,-756.93"/>
<text text-anchor="middle" x="2522.5" y="-999.23" font-family="Times,serif" font-size="14.00">GPU 11 (H100)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu_12</title>
<path fill="#000000" stroke="blue" d="M2648,-576.93C2648,-576.93 2835,-576.93 2835,-576.93 2841,-576.93 2847,-582.93 2847,-588.93 2847,-588.93 2847,-822.43 2847,-822.43 2847,-828.43 2841,-834.43 2835,-834.43 2835,-834.43 2648,-834.43 2648,-834.43 2642,-834.43 2636,-828.43 2636,-822.43 2636,-822.43 2636,-588.93 2636,-588.93 2636,-582.93 2642,-576.93 2648,-576.93"/>
<text text-anchor="middle" x="2741.5" y="-819.23" font-family="Times,serif" font-size="14.00">GPU 12 (H100)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu_13</title>
<path fill="#000000" stroke="blue" d="M2867,-396.93C2867,-396.93 3054,-396.93 3054,-396.93 3060,-396.93 3066,-402.93 3066,-408.93 3066,-408.93 3066,-642.43 3066,-642.43 3066,-648.43 3060,-654.43 3054,-654.43 3054,-654.43 2867,-654.43 2867,-654.43 2861,-654.43 2855,-648.43 2855,-642.43 2855,-642.43 2855,-408.93 2855,-408.93 2855,-402.93 2861,-396.93 2867,-396.93"/>
<text text-anchor="middle" x="2960.5" y="-639.23" font-family="Times,serif" font-size="14.00">GPU 13 (H100)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu_14</title>
<path fill="#000000" stroke="blue" d="M3086,-216.93C3086,-216.93 3273,-216.93 3273,-216.93 3279,-216.93 3285,-222.93 3285,-228.93 3285,-228.93 3285,-462.43 3285,-462.43 3285,-468.43 3279,-474.43 3273,-474.43 3273,-474.43 3086,-474.43 3086,-474.43 3080,-474.43 3074,-468.43 3074,-462.43 3074,-462.43 3074,-228.93 3074,-228.93 3074,-222.93 3080,-216.93 3086,-216.93"/>
<text text-anchor="middle" x="3179.5" y="-459.23" font-family="Times,serif" font-size="14.00">GPU 14 (H100)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_15</title>
<path fill="#000000" stroke="blue" d="M3305,-79.43C3305,-79.43 3492,-79.43 3492,-79.43 3498,-79.43 3504,-85.43 3504,-91.43 3504,-91.43 3504,-282.43 3504,-282.43 3504,-288.43 3498,-294.43 3492,-294.43 3492,-294.43 3305,-294.43 3305,-294.43 3299,-294.43 3293,-288.43 3293,-282.43 3293,-282.43 3293,-91.43 3293,-91.43 3293,-85.43 3299,-79.43 3305,-79.43"/>
<text text-anchor="middle" x="3398.5" y="-279.23" font-family="Times,serif" font-size="14.00">GPU 15 (H100)</text>
</g>
<!-- cache_0 -->
<g id="node1" class="node">
<title>cache_0</title>
<polygon fill="lightyellow" stroke="black" points="158.5,-2954.43 65.5,-2954.43 65.5,-2918.43 158.5,-2918.43 158.5,-2954.43"/>
<text text-anchor="middle" x="112" y="-2939.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="112" y="-2928.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- d_layer_1 -->
<g id="node2" class="node">
<title>d_layer_1</title>
<polygon fill="lightgreen" stroke="black" points="211.5,-2785.93 126.5,-2785.93 122.5,-2781.93 122.5,-2744.93 207.5,-2744.93 211.5,-2748.93 211.5,-2785.93"/>
<polyline fill="none" stroke="black" points="207.5,-2781.93 122.5,-2781.93 "/>
<polyline fill="none" stroke="black" points="207.5,-2781.93 207.5,-2744.93 "/>
<polyline fill="none" stroke="black" points="207.5,-2781.93 211.5,-2785.93 "/>
<text text-anchor="middle" x="167" y="-2773.93" font-family="Arial" font-size="10.00">Dense Layer 1</text>
<text text-anchor="middle" x="167" y="-2762.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="167" y="-2751.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- cache_0&#45;&gt;d_layer_1 -->
<g id="edge1" class="edge">
<title>cache_0&#45;&gt;d_layer_1</title>
<path fill="none" stroke="black" d="M117.58,-2918.29C126.95,-2889.5 145.96,-2831.09 157.48,-2795.69"/>
<polygon fill="black" stroke="black" points="160.88,-2796.53 160.65,-2785.93 154.23,-2794.36 160.88,-2796.53"/>
<text text-anchor="middle" x="148" y="-2849.03" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- m_layer_1 -->
<g id="node3" class="node">
<title>m_layer_1</title>
<polygon fill="lightcoral" stroke="black" points="104.5,-2785.93 19.5,-2785.93 15.5,-2781.93 15.5,-2744.93 100.5,-2744.93 104.5,-2748.93 104.5,-2785.93"/>
<polyline fill="none" stroke="black" points="100.5,-2781.93 15.5,-2781.93 "/>
<polyline fill="none" stroke="black" points="100.5,-2781.93 100.5,-2744.93 "/>
<polyline fill="none" stroke="black" points="100.5,-2781.93 104.5,-2785.93 "/>
<text text-anchor="middle" x="60" y="-2773.93" font-family="Arial" font-size="10.00">MoE Layer 1</text>
<text text-anchor="middle" x="60" y="-2762.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="60" y="-2751.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- cache_0&#45;&gt;m_layer_1 -->
<g id="edge2" class="edge">
<title>cache_0&#45;&gt;m_layer_1</title>
<path fill="none" stroke="black" d="M106.73,-2918.29C97.87,-2889.5 79.9,-2831.09 69.01,-2795.69"/>
<polygon fill="black" stroke="black" points="72.29,-2794.46 66,-2785.93 65.6,-2796.52 72.29,-2794.46"/>
<text text-anchor="middle" x="94" y="-2849.03" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_2 -->
<g id="node5" class="node">
<title>d_layer_2</title>
<polygon fill="lightgreen" stroke="black" points="430.5,-2605.93 345.5,-2605.93 341.5,-2601.93 341.5,-2564.93 426.5,-2564.93 430.5,-2568.93 430.5,-2605.93"/>
<polyline fill="none" stroke="black" points="426.5,-2601.93 341.5,-2601.93 "/>
<polyline fill="none" stroke="black" points="426.5,-2601.93 426.5,-2564.93 "/>
<polyline fill="none" stroke="black" points="426.5,-2601.93 430.5,-2605.93 "/>
<text text-anchor="middle" x="386" y="-2593.93" font-family="Arial" font-size="10.00">Dense Layer 2</text>
<text text-anchor="middle" x="386" y="-2582.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="386" y="-2571.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_1&#45;&gt;d_layer_2 -->
<g id="edge33" class="edge">
<title>d_layer_1&#45;&gt;d_layer_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M174.84,-2744.74C184.95,-2722.04 204.8,-2685.41 234,-2666.43 271.13,-2642.29 293.52,-2670.35 332,-2648.43 346.41,-2640.22 358.86,-2626.69 368.17,-2614.36"/>
<polygon fill="blue" stroke="blue" points="371.11,-2616.26 374.09,-2606.09 365.42,-2612.18 371.11,-2616.26"/>
<text text-anchor="middle" x="267" y="-2678.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="267" y="-2669.03" font-family="Arial" font-size="8.00">[GPU 0 → GPU 1]</text>
</g>
<!-- m_layer_2 -->
<g id="node6" class="node">
<title>m_layer_2</title>
<polygon fill="lightcoral" stroke="black" points="323.5,-2605.93 238.5,-2605.93 234.5,-2601.93 234.5,-2564.93 319.5,-2564.93 323.5,-2568.93 323.5,-2605.93"/>
<polyline fill="none" stroke="black" points="319.5,-2601.93 234.5,-2601.93 "/>
<polyline fill="none" stroke="black" points="319.5,-2601.93 319.5,-2564.93 "/>
<polyline fill="none" stroke="black" points="319.5,-2601.93 323.5,-2605.93 "/>
<text text-anchor="middle" x="279" y="-2593.93" font-family="Arial" font-size="10.00">MoE Layer 2</text>
<text text-anchor="middle" x="279" y="-2582.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="279" y="-2571.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_1&#45;&gt;m_layer_2 -->
<g id="edge34" class="edge">
<title>m_layer_1&#45;&gt;m_layer_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M76.61,-2744.8C87.01,-2732.56 100.72,-2716.52 113,-2702.43 127.07,-2686.29 128.51,-2680.07 145,-2666.43 171.05,-2644.87 203.54,-2625.32 230.01,-2610.95"/>
<polygon fill="red" stroke="red" points="231.93,-2613.89 239.1,-2606.08 228.63,-2607.71 231.93,-2613.89"/>
<text text-anchor="middle" x="178" y="-2678.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="178" y="-2669.03" font-family="Arial" font-size="8.00">[GPU 0 → GPU 1]</text>
</g>
<!-- cache_1 -->
<g id="node4" class="node">
<title>cache_1</title>
<polygon fill="lightyellow" stroke="black" points="377.5,-2783.43 284.5,-2783.43 284.5,-2747.43 377.5,-2747.43 377.5,-2783.43"/>
<text text-anchor="middle" x="331" y="-2768.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="331" y="-2757.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_1&#45;&gt;d_layer_2 -->
<g id="edge3" class="edge">
<title>cache_1&#45;&gt;d_layer_2</title>
<path fill="none" stroke="black" d="M336.27,-2747.36C345.64,-2717.06 365.27,-2653.52 376.87,-2615.98"/>
<polygon fill="black" stroke="black" points="380.3,-2616.72 379.91,-2606.13 373.62,-2614.65 380.3,-2616.72"/>
<text text-anchor="middle" x="369" y="-2673.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_1&#45;&gt;m_layer_2 -->
<g id="edge4" class="edge">
<title>cache_1&#45;&gt;m_layer_2</title>
<path fill="none" stroke="black" d="M326.01,-2747.36C317.16,-2717.06 298.6,-2653.52 287.63,-2615.98"/>
<polygon fill="black" stroke="black" points="290.92,-2614.75 284.76,-2606.13 284.2,-2616.71 290.92,-2614.75"/>
<text text-anchor="middle" x="315" y="-2673.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_3 -->
<g id="node8" class="node">
<title>d_layer_3</title>
<polygon fill="lightgreen" stroke="black" points="649.5,-2425.93 564.5,-2425.93 560.5,-2421.93 560.5,-2384.93 645.5,-2384.93 649.5,-2388.93 649.5,-2425.93"/>
<polyline fill="none" stroke="black" points="645.5,-2421.93 560.5,-2421.93 "/>
<polyline fill="none" stroke="black" points="645.5,-2421.93 645.5,-2384.93 "/>
<polyline fill="none" stroke="black" points="645.5,-2421.93 649.5,-2425.93 "/>
<text text-anchor="middle" x="605" y="-2413.93" font-family="Arial" font-size="10.00">Dense Layer 3</text>
<text text-anchor="middle" x="605" y="-2402.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="605" y="-2391.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_2&#45;&gt;d_layer_3 -->
<g id="edge35" class="edge">
<title>d_layer_2&#45;&gt;d_layer_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M393.02,-2564.72C402.19,-2541.99 420.53,-2505.34 449,-2486.43 487.71,-2460.72 511.63,-2491.45 552,-2468.43 566.29,-2460.28 578.53,-2446.75 587.63,-2434.41"/>
<polygon fill="blue" stroke="blue" points="590.55,-2436.34 593.42,-2426.14 584.82,-2432.33 590.55,-2436.34"/>
<text text-anchor="middle" x="482" y="-2498.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="482" y="-2489.03" font-family="Arial" font-size="8.00">[GPU 1 → GPU 2]</text>
</g>
<!-- m_layer_3 -->
<g id="node9" class="node">
<title>m_layer_3</title>
<polygon fill="lightcoral" stroke="black" points="542.5,-2425.93 457.5,-2425.93 453.5,-2421.93 453.5,-2384.93 538.5,-2384.93 542.5,-2388.93 542.5,-2425.93"/>
<polyline fill="none" stroke="black" points="538.5,-2421.93 453.5,-2421.93 "/>
<polyline fill="none" stroke="black" points="538.5,-2421.93 538.5,-2384.93 "/>
<polyline fill="none" stroke="black" points="538.5,-2421.93 542.5,-2425.93 "/>
<text text-anchor="middle" x="498" y="-2413.93" font-family="Arial" font-size="10.00">MoE Layer 3</text>
<text text-anchor="middle" x="498" y="-2402.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="498" y="-2391.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_2&#45;&gt;m_layer_3 -->
<g id="edge36" class="edge">
<title>m_layer_2&#45;&gt;m_layer_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M292.16,-2564.62C306.9,-2543.46 332.38,-2509.82 360,-2486.43 386.2,-2464.24 419.39,-2444.77 446.66,-2430.6"/>
<polygon fill="red" stroke="red" points="448.34,-2433.67 455.66,-2426.01 445.16,-2427.44 448.34,-2433.67"/>
<text text-anchor="middle" x="393" y="-2498.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="393" y="-2489.03" font-family="Arial" font-size="8.00">[GPU 1 → GPU 2]</text>
</g>
<!-- cache_2 -->
<g id="node7" class="node">
<title>cache_2</title>
<polygon fill="lightyellow" stroke="black" points="590.5,-2603.43 497.5,-2603.43 497.5,-2567.43 590.5,-2567.43 590.5,-2603.43"/>
<text text-anchor="middle" x="544" y="-2588.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="544" y="-2577.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_2&#45;&gt;d_layer_3 -->
<g id="edge5" class="edge">
<title>cache_2&#45;&gt;d_layer_3</title>
<path fill="none" stroke="black" d="M549.85,-2567.36C560.23,-2537.06 582.01,-2473.52 594.87,-2435.98"/>
<polygon fill="black" stroke="black" points="598.32,-2436.72 598.25,-2426.13 591.69,-2434.46 598.32,-2436.72"/>
<text text-anchor="middle" x="584" y="-2493.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_2&#45;&gt;m_layer_3 -->
<g id="edge6" class="edge">
<title>cache_2&#45;&gt;m_layer_3</title>
<path fill="none" stroke="black" d="M539.59,-2567.36C531.76,-2537.06 515.34,-2473.52 505.64,-2435.98"/>
<polygon fill="black" stroke="black" points="508.98,-2434.94 503.09,-2426.13 502.21,-2436.69 508.98,-2434.94"/>
<text text-anchor="middle" x="530" y="-2493.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_4 -->
<g id="node11" class="node">
<title>d_layer_4</title>
<polygon fill="lightgreen" stroke="black" points="868.5,-2245.93 783.5,-2245.93 779.5,-2241.93 779.5,-2204.93 864.5,-2204.93 868.5,-2208.93 868.5,-2245.93"/>
<polyline fill="none" stroke="black" points="864.5,-2241.93 779.5,-2241.93 "/>
<polyline fill="none" stroke="black" points="864.5,-2241.93 864.5,-2204.93 "/>
<polyline fill="none" stroke="black" points="864.5,-2241.93 868.5,-2245.93 "/>
<text text-anchor="middle" x="824" y="-2233.93" font-family="Arial" font-size="10.00">Dense Layer 4</text>
<text text-anchor="middle" x="824" y="-2222.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="824" y="-2211.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_3&#45;&gt;d_layer_4 -->
<g id="edge37" class="edge">
<title>d_layer_3&#45;&gt;d_layer_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M612.63,-2384.73C622.5,-2362.01 641.97,-2325.37 671,-2306.43 708.82,-2281.75 731.83,-2310.9 771,-2288.43 785.27,-2280.24 797.51,-2266.71 806.61,-2254.38"/>
<polygon fill="blue" stroke="blue" points="809.53,-2256.31 812.4,-2246.11 803.8,-2252.29 809.53,-2256.31"/>
<text text-anchor="middle" x="704" y="-2318.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="704" y="-2309.03" font-family="Arial" font-size="8.00">[GPU 2 → GPU 3]</text>
</g>
<!-- m_layer_4 -->
<g id="node12" class="node">
<title>m_layer_4</title>
<polygon fill="lightcoral" stroke="black" points="761.5,-2245.93 676.5,-2245.93 672.5,-2241.93 672.5,-2204.93 757.5,-2204.93 761.5,-2208.93 761.5,-2245.93"/>
<polyline fill="none" stroke="black" points="757.5,-2241.93 672.5,-2241.93 "/>
<polyline fill="none" stroke="black" points="757.5,-2241.93 757.5,-2204.93 "/>
<polyline fill="none" stroke="black" points="757.5,-2241.93 761.5,-2245.93 "/>
<text text-anchor="middle" x="717" y="-2233.93" font-family="Arial" font-size="10.00">MoE Layer 4</text>
<text text-anchor="middle" x="717" y="-2222.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="717" y="-2211.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_3&#45;&gt;m_layer_4 -->
<g id="edge38" class="edge">
<title>m_layer_3&#45;&gt;m_layer_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M511.62,-2384.68C526.83,-2363.57 553.03,-2329.98 581,-2306.43 607.07,-2284.47 639.93,-2264.96 666.82,-2250.7"/>
<polygon fill="red" stroke="red" points="668.44,-2253.8 675.69,-2246.07 665.2,-2247.59 668.44,-2253.8"/>
<text text-anchor="middle" x="614" y="-2318.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="614" y="-2309.03" font-family="Arial" font-size="8.00">[GPU 2 → GPU 3]</text>
</g>
<!-- cache_3 -->
<g id="node10" class="node">
<title>cache_3</title>
<polygon fill="lightyellow" stroke="black" points="815.5,-2423.43 722.5,-2423.43 722.5,-2387.43 815.5,-2387.43 815.5,-2423.43"/>
<text text-anchor="middle" x="769" y="-2408.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="769" y="-2397.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_3&#45;&gt;d_layer_4 -->
<g id="edge7" class="edge">
<title>cache_3&#45;&gt;d_layer_4</title>
<path fill="none" stroke="black" d="M774.27,-2387.36C783.64,-2357.06 803.27,-2293.52 814.87,-2255.98"/>
<polygon fill="black" stroke="black" points="818.3,-2256.72 817.91,-2246.13 811.62,-2254.65 818.3,-2256.72"/>
<text text-anchor="middle" x="806" y="-2313.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_3&#45;&gt;m_layer_4 -->
<g id="edge8" class="edge">
<title>cache_3&#45;&gt;m_layer_4</title>
<path fill="none" stroke="black" d="M764.01,-2387.36C755.16,-2357.06 736.6,-2293.52 725.63,-2255.98"/>
<polygon fill="black" stroke="black" points="728.92,-2254.75 722.76,-2246.13 722.2,-2256.71 728.92,-2254.75"/>
<text text-anchor="middle" x="752" y="-2313.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_5 -->
<g id="node14" class="node">
<title>d_layer_5</title>
<polygon fill="lightgreen" stroke="black" points="1087.5,-2065.93 1002.5,-2065.93 998.5,-2061.93 998.5,-2024.93 1083.5,-2024.93 1087.5,-2028.93 1087.5,-2065.93"/>
<polyline fill="none" stroke="black" points="1083.5,-2061.93 998.5,-2061.93 "/>
<polyline fill="none" stroke="black" points="1083.5,-2061.93 1083.5,-2024.93 "/>
<polyline fill="none" stroke="black" points="1083.5,-2061.93 1087.5,-2065.93 "/>
<text text-anchor="middle" x="1043" y="-2053.93" font-family="Arial" font-size="10.00">Dense Layer 5</text>
<text text-anchor="middle" x="1043" y="-2042.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="1043" y="-2031.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_4&#45;&gt;d_layer_5 -->
<g id="edge39" class="edge">
<title>d_layer_4&#45;&gt;d_layer_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M831.02,-2204.72C840.19,-2181.99 858.53,-2145.34 887,-2126.43 925.71,-2100.72 949.63,-2131.45 990,-2108.43 1004.29,-2100.28 1016.53,-2086.75 1025.63,-2074.41"/>
<polygon fill="blue" stroke="blue" points="1028.55,-2076.34 1031.42,-2066.14 1022.82,-2072.33 1028.55,-2076.34"/>
<text text-anchor="middle" x="920" y="-2138.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="920" y="-2129.03" font-family="Arial" font-size="8.00">[GPU 3 → GPU 4]</text>
</g>
<!-- m_layer_5 -->
<g id="node15" class="node">
<title>m_layer_5</title>
<polygon fill="lightcoral" stroke="black" points="980.5,-2065.93 895.5,-2065.93 891.5,-2061.93 891.5,-2024.93 976.5,-2024.93 980.5,-2028.93 980.5,-2065.93"/>
<polyline fill="none" stroke="black" points="976.5,-2061.93 891.5,-2061.93 "/>
<polyline fill="none" stroke="black" points="976.5,-2061.93 976.5,-2024.93 "/>
<polyline fill="none" stroke="black" points="976.5,-2061.93 980.5,-2065.93 "/>
<text text-anchor="middle" x="936" y="-2053.93" font-family="Arial" font-size="10.00">MoE Layer 5</text>
<text text-anchor="middle" x="936" y="-2042.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="936" y="-2031.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_4&#45;&gt;m_layer_5 -->
<g id="edge40" class="edge">
<title>m_layer_4&#45;&gt;m_layer_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M730.16,-2204.62C744.9,-2183.46 770.38,-2149.82 798,-2126.43 824.2,-2104.24 857.39,-2084.77 884.66,-2070.6"/>
<polygon fill="red" stroke="red" points="886.34,-2073.67 893.66,-2066.01 883.16,-2067.44 886.34,-2073.67"/>
<text text-anchor="middle" x="831" y="-2138.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="831" y="-2129.03" font-family="Arial" font-size="8.00">[GPU 3 → GPU 4]</text>
</g>
<!-- cache_4 -->
<g id="node13" class="node">
<title>cache_4</title>
<polygon fill="lightyellow" stroke="black" points="1028.5,-2243.43 935.5,-2243.43 935.5,-2207.43 1028.5,-2207.43 1028.5,-2243.43"/>
<text text-anchor="middle" x="982" y="-2228.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="982" y="-2217.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_4&#45;&gt;d_layer_5 -->
<g id="edge9" class="edge">
<title>cache_4&#45;&gt;d_layer_5</title>
<path fill="none" stroke="black" d="M987.85,-2207.36C998.23,-2177.06 1020.01,-2113.52 1032.87,-2075.98"/>
<polygon fill="black" stroke="black" points="1036.32,-2076.72 1036.25,-2066.13 1029.69,-2074.46 1036.32,-2076.72"/>
<text text-anchor="middle" x="1022" y="-2133.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_4&#45;&gt;m_layer_5 -->
<g id="edge10" class="edge">
<title>cache_4&#45;&gt;m_layer_5</title>
<path fill="none" stroke="black" d="M977.59,-2207.36C969.76,-2177.06 953.34,-2113.52 943.64,-2075.98"/>
<polygon fill="black" stroke="black" points="946.98,-2074.94 941.09,-2066.13 940.21,-2076.69 946.98,-2074.94"/>
<text text-anchor="middle" x="968" y="-2133.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_6 -->
<g id="node17" class="node">
<title>d_layer_6</title>
<polygon fill="lightgreen" stroke="black" points="1306.5,-1885.93 1221.5,-1885.93 1217.5,-1881.93 1217.5,-1844.93 1302.5,-1844.93 1306.5,-1848.93 1306.5,-1885.93"/>
<polyline fill="none" stroke="black" points="1302.5,-1881.93 1217.5,-1881.93 "/>
<polyline fill="none" stroke="black" points="1302.5,-1881.93 1302.5,-1844.93 "/>
<polyline fill="none" stroke="black" points="1302.5,-1881.93 1306.5,-1885.93 "/>
<text text-anchor="middle" x="1262" y="-1873.93" font-family="Arial" font-size="10.00">Dense Layer 6</text>
<text text-anchor="middle" x="1262" y="-1862.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="1262" y="-1851.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_5&#45;&gt;d_layer_6 -->
<g id="edge41" class="edge">
<title>d_layer_5&#45;&gt;d_layer_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1050.02,-2024.72C1059.19,-2001.99 1077.53,-1965.34 1106,-1946.43 1144.71,-1920.72 1168.63,-1951.45 1209,-1928.43 1223.29,-1920.28 1235.53,-1906.75 1244.63,-1894.41"/>
<polygon fill="blue" stroke="blue" points="1247.55,-1896.34 1250.42,-1886.14 1241.82,-1892.33 1247.55,-1896.34"/>
<text text-anchor="middle" x="1139" y="-1958.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1139" y="-1949.03" font-family="Arial" font-size="8.00">[GPU 4 → GPU 5]</text>
</g>
<!-- m_layer_6 -->
<g id="node18" class="node">
<title>m_layer_6</title>
<polygon fill="lightcoral" stroke="black" points="1199.5,-1885.93 1114.5,-1885.93 1110.5,-1881.93 1110.5,-1844.93 1195.5,-1844.93 1199.5,-1848.93 1199.5,-1885.93"/>
<polyline fill="none" stroke="black" points="1195.5,-1881.93 1110.5,-1881.93 "/>
<polyline fill="none" stroke="black" points="1195.5,-1881.93 1195.5,-1844.93 "/>
<polyline fill="none" stroke="black" points="1195.5,-1881.93 1199.5,-1885.93 "/>
<text text-anchor="middle" x="1155" y="-1873.93" font-family="Arial" font-size="10.00">MoE Layer 6</text>
<text text-anchor="middle" x="1155" y="-1862.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1155" y="-1851.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_5&#45;&gt;m_layer_6 -->
<g id="edge42" class="edge">
<title>m_layer_5&#45;&gt;m_layer_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M949.16,-2024.62C963.9,-2003.46 989.38,-1969.82 1017,-1946.43 1043.2,-1924.24 1076.39,-1904.77 1103.66,-1890.6"/>
<polygon fill="red" stroke="red" points="1105.34,-1893.67 1112.66,-1886.01 1102.16,-1887.44 1105.34,-1893.67"/>
<text text-anchor="middle" x="1050" y="-1958.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1050" y="-1949.03" font-family="Arial" font-size="8.00">[GPU 4 → GPU 5]</text>
</g>
<!-- cache_5 -->
<g id="node16" class="node">
<title>cache_5</title>
<polygon fill="lightyellow" stroke="black" points="1247.5,-2063.43 1154.5,-2063.43 1154.5,-2027.43 1247.5,-2027.43 1247.5,-2063.43"/>
<text text-anchor="middle" x="1201" y="-2048.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="1201" y="-2037.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_5&#45;&gt;d_layer_6 -->
<g id="edge11" class="edge">
<title>cache_5&#45;&gt;d_layer_6</title>
<path fill="none" stroke="black" d="M1206.85,-2027.36C1217.23,-1997.06 1239.01,-1933.52 1251.87,-1895.98"/>
<polygon fill="black" stroke="black" points="1255.32,-1896.72 1255.25,-1886.13 1248.69,-1894.46 1255.32,-1896.72"/>
<text text-anchor="middle" x="1241" y="-1953.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_5&#45;&gt;m_layer_6 -->
<g id="edge12" class="edge">
<title>cache_5&#45;&gt;m_layer_6</title>
<path fill="none" stroke="black" d="M1196.59,-2027.36C1188.76,-1997.06 1172.34,-1933.52 1162.64,-1895.98"/>
<polygon fill="black" stroke="black" points="1165.98,-1894.94 1160.09,-1886.13 1159.21,-1896.69 1165.98,-1894.94"/>
<text text-anchor="middle" x="1187" y="-1953.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_7 -->
<g id="node20" class="node">
<title>d_layer_7</title>
<polygon fill="lightgreen" stroke="black" points="1525.5,-1705.93 1440.5,-1705.93 1436.5,-1701.93 1436.5,-1664.93 1521.5,-1664.93 1525.5,-1668.93 1525.5,-1705.93"/>
<polyline fill="none" stroke="black" points="1521.5,-1701.93 1436.5,-1701.93 "/>
<polyline fill="none" stroke="black" points="1521.5,-1701.93 1521.5,-1664.93 "/>
<polyline fill="none" stroke="black" points="1521.5,-1701.93 1525.5,-1705.93 "/>
<text text-anchor="middle" x="1481" y="-1693.93" font-family="Arial" font-size="10.00">Dense Layer 7</text>
<text text-anchor="middle" x="1481" y="-1682.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="1481" y="-1671.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_6&#45;&gt;d_layer_7 -->
<g id="edge43" class="edge">
<title>d_layer_6&#45;&gt;d_layer_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1269.63,-1844.73C1279.5,-1822.01 1298.97,-1785.37 1328,-1766.43 1365.82,-1741.75 1388.83,-1770.9 1428,-1748.43 1442.27,-1740.24 1454.51,-1726.71 1463.61,-1714.38"/>
<polygon fill="blue" stroke="blue" points="1466.53,-1716.31 1469.4,-1706.11 1460.8,-1712.29 1466.53,-1716.31"/>
<text text-anchor="middle" x="1361" y="-1778.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1361" y="-1769.03" font-family="Arial" font-size="8.00">[GPU 5 → GPU 6]</text>
</g>
<!-- m_layer_7 -->
<g id="node21" class="node">
<title>m_layer_7</title>
<polygon fill="lightcoral" stroke="black" points="1418.5,-1705.93 1333.5,-1705.93 1329.5,-1701.93 1329.5,-1664.93 1414.5,-1664.93 1418.5,-1668.93 1418.5,-1705.93"/>
<polyline fill="none" stroke="black" points="1414.5,-1701.93 1329.5,-1701.93 "/>
<polyline fill="none" stroke="black" points="1414.5,-1701.93 1414.5,-1664.93 "/>
<polyline fill="none" stroke="black" points="1414.5,-1701.93 1418.5,-1705.93 "/>
<text text-anchor="middle" x="1374" y="-1693.93" font-family="Arial" font-size="10.00">MoE Layer 7</text>
<text text-anchor="middle" x="1374" y="-1682.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1374" y="-1671.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_6&#45;&gt;m_layer_7 -->
<g id="edge44" class="edge">
<title>m_layer_6&#45;&gt;m_layer_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1168.62,-1844.68C1183.83,-1823.57 1210.03,-1789.98 1238,-1766.43 1264.07,-1744.47 1296.93,-1724.96 1323.82,-1710.7"/>
<polygon fill="red" stroke="red" points="1325.44,-1713.8 1332.69,-1706.07 1322.2,-1707.59 1325.44,-1713.8"/>
<text text-anchor="middle" x="1271" y="-1778.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1271" y="-1769.03" font-family="Arial" font-size="8.00">[GPU 5 → GPU 6]</text>
</g>
<!-- cache_6 -->
<g id="node19" class="node">
<title>cache_6</title>
<polygon fill="lightyellow" stroke="black" points="1472.5,-1883.43 1379.5,-1883.43 1379.5,-1847.43 1472.5,-1847.43 1472.5,-1883.43"/>
<text text-anchor="middle" x="1426" y="-1868.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="1426" y="-1857.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_6&#45;&gt;d_layer_7 -->
<g id="edge13" class="edge">
<title>cache_6&#45;&gt;d_layer_7</title>
<path fill="none" stroke="black" d="M1431.27,-1847.36C1440.64,-1817.06 1460.27,-1753.52 1471.87,-1715.98"/>
<polygon fill="black" stroke="black" points="1475.3,-1716.72 1474.91,-1706.13 1468.62,-1714.65 1475.3,-1716.72"/>
<text text-anchor="middle" x="1463" y="-1773.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_6&#45;&gt;m_layer_7 -->
<g id="edge14" class="edge">
<title>cache_6&#45;&gt;m_layer_7</title>
<path fill="none" stroke="black" d="M1421.01,-1847.36C1412.16,-1817.06 1393.6,-1753.52 1382.63,-1715.98"/>
<polygon fill="black" stroke="black" points="1385.92,-1714.75 1379.76,-1706.13 1379.2,-1716.71 1385.92,-1714.75"/>
<text text-anchor="middle" x="1409" y="-1773.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_8 -->
<g id="node23" class="node">
<title>d_layer_8</title>
<polygon fill="lightgreen" stroke="black" points="1744.5,-1525.93 1659.5,-1525.93 1655.5,-1521.93 1655.5,-1484.93 1740.5,-1484.93 1744.5,-1488.93 1744.5,-1525.93"/>
<polyline fill="none" stroke="black" points="1740.5,-1521.93 1655.5,-1521.93 "/>
<polyline fill="none" stroke="black" points="1740.5,-1521.93 1740.5,-1484.93 "/>
<polyline fill="none" stroke="black" points="1740.5,-1521.93 1744.5,-1525.93 "/>
<text text-anchor="middle" x="1700" y="-1513.93" font-family="Arial" font-size="10.00">Dense Layer 8</text>
<text text-anchor="middle" x="1700" y="-1502.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="1700" y="-1491.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_7&#45;&gt;d_layer_8 -->
<g id="edge45" class="edge">
<title>d_layer_7&#45;&gt;d_layer_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1488.63,-1664.73C1498.5,-1642.01 1517.97,-1605.37 1547,-1586.43 1584.82,-1561.75 1607.83,-1590.9 1647,-1568.43 1661.27,-1560.24 1673.51,-1546.71 1682.61,-1534.38"/>
<polygon fill="blue" stroke="blue" points="1685.53,-1536.31 1688.4,-1526.11 1679.8,-1532.29 1685.53,-1536.31"/>
<text text-anchor="middle" x="1580" y="-1598.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1580" y="-1589.03" font-family="Arial" font-size="8.00">[GPU 6 → GPU 7]</text>
</g>
<!-- m_layer_8 -->
<g id="node24" class="node">
<title>m_layer_8</title>
<polygon fill="lightcoral" stroke="black" points="1637.5,-1525.93 1552.5,-1525.93 1548.5,-1521.93 1548.5,-1484.93 1633.5,-1484.93 1637.5,-1488.93 1637.5,-1525.93"/>
<polyline fill="none" stroke="black" points="1633.5,-1521.93 1548.5,-1521.93 "/>
<polyline fill="none" stroke="black" points="1633.5,-1521.93 1633.5,-1484.93 "/>
<polyline fill="none" stroke="black" points="1633.5,-1521.93 1637.5,-1525.93 "/>
<text text-anchor="middle" x="1593" y="-1513.93" font-family="Arial" font-size="10.00">MoE Layer 8</text>
<text text-anchor="middle" x="1593" y="-1502.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1593" y="-1491.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_7&#45;&gt;m_layer_8 -->
<g id="edge46" class="edge">
<title>m_layer_7&#45;&gt;m_layer_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1387.62,-1664.68C1402.83,-1643.57 1429.03,-1609.98 1457,-1586.43 1483.07,-1564.47 1515.93,-1544.96 1542.82,-1530.7"/>
<polygon fill="red" stroke="red" points="1544.44,-1533.8 1551.69,-1526.07 1541.2,-1527.59 1544.44,-1533.8"/>
<text text-anchor="middle" x="1490" y="-1598.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1490" y="-1589.03" font-family="Arial" font-size="8.00">[GPU 6 → GPU 7]</text>
</g>
<!-- cache_7 -->
<g id="node22" class="node">
<title>cache_7</title>
<polygon fill="lightyellow" stroke="black" points="1691.5,-1703.43 1598.5,-1703.43 1598.5,-1667.43 1691.5,-1667.43 1691.5,-1703.43"/>
<text text-anchor="middle" x="1645" y="-1688.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="1645" y="-1677.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_7&#45;&gt;d_layer_8 -->
<g id="edge15" class="edge">
<title>cache_7&#45;&gt;d_layer_8</title>
<path fill="none" stroke="black" d="M1650.27,-1667.36C1659.64,-1637.06 1679.27,-1573.52 1690.87,-1535.98"/>
<polygon fill="black" stroke="black" points="1694.3,-1536.72 1693.91,-1526.13 1687.62,-1534.65 1694.3,-1536.72"/>
<text text-anchor="middle" x="1682" y="-1593.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_7&#45;&gt;m_layer_8 -->
<g id="edge16" class="edge">
<title>cache_7&#45;&gt;m_layer_8</title>
<path fill="none" stroke="black" d="M1640.01,-1667.36C1631.16,-1637.06 1612.6,-1573.52 1601.63,-1535.98"/>
<polygon fill="black" stroke="black" points="1604.92,-1534.75 1598.76,-1526.13 1598.2,-1536.71 1604.92,-1534.75"/>
<text text-anchor="middle" x="1628" y="-1593.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_9 -->
<g id="node26" class="node">
<title>d_layer_9</title>
<polygon fill="lightgreen" stroke="black" points="1963.5,-1345.93 1878.5,-1345.93 1874.5,-1341.93 1874.5,-1304.93 1959.5,-1304.93 1963.5,-1308.93 1963.5,-1345.93"/>
<polyline fill="none" stroke="black" points="1959.5,-1341.93 1874.5,-1341.93 "/>
<polyline fill="none" stroke="black" points="1959.5,-1341.93 1959.5,-1304.93 "/>
<polyline fill="none" stroke="black" points="1959.5,-1341.93 1963.5,-1345.93 "/>
<text text-anchor="middle" x="1919" y="-1333.93" font-family="Arial" font-size="10.00">Dense Layer 9</text>
<text text-anchor="middle" x="1919" y="-1322.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="1919" y="-1311.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_8&#45;&gt;d_layer_9 -->
<g id="edge47" class="edge">
<title>d_layer_8&#45;&gt;d_layer_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1704.55,-1484.72C1710.88,-1461.99 1724.68,-1425.34 1751,-1406.43 1793.01,-1376.24 1820.83,-1413.65 1866,-1388.43 1880.46,-1380.35 1892.78,-1366.7 1901.89,-1354.27"/>
<polygon fill="blue" stroke="blue" points="1904.84,-1356.15 1907.67,-1345.93 1899.09,-1352.16 1904.84,-1356.15"/>
<text text-anchor="middle" x="1784" y="-1418.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1784" y="-1409.03" font-family="Arial" font-size="8.00">[GPU 7 → GPU 8]</text>
</g>
<!-- m_layer_9 -->
<g id="node27" class="node">
<title>m_layer_9</title>
<polygon fill="lightcoral" stroke="black" points="1856.5,-1345.93 1771.5,-1345.93 1767.5,-1341.93 1767.5,-1304.93 1852.5,-1304.93 1856.5,-1308.93 1856.5,-1345.93"/>
<polyline fill="none" stroke="black" points="1852.5,-1341.93 1767.5,-1341.93 "/>
<polyline fill="none" stroke="black" points="1852.5,-1341.93 1852.5,-1304.93 "/>
<polyline fill="none" stroke="black" points="1852.5,-1341.93 1856.5,-1345.93 "/>
<text text-anchor="middle" x="1812" y="-1333.93" font-family="Arial" font-size="10.00">MoE Layer 9</text>
<text text-anchor="middle" x="1812" y="-1322.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1812" y="-1311.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_8&#45;&gt;m_layer_9 -->
<g id="edge48" class="edge">
<title>m_layer_8&#45;&gt;m_layer_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1603.43,-1484.72C1615.51,-1463.34 1637.1,-1429.22 1663,-1406.43 1690.94,-1381.84 1727.75,-1361.98 1757.79,-1348.2"/>
<polygon fill="red" stroke="red" points="1759.6,-1351.23 1767.29,-1343.94 1756.73,-1344.84 1759.6,-1351.23"/>
<text text-anchor="middle" x="1696" y="-1418.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1696" y="-1409.03" font-family="Arial" font-size="8.00">[GPU 7 → GPU 8]</text>
</g>
<!-- cache_8 -->
<g id="node25" class="node">
<title>cache_8</title>
<polygon fill="lightyellow" stroke="black" points="1878.5,-1523.43 1785.5,-1523.43 1785.5,-1487.43 1878.5,-1487.43 1878.5,-1523.43"/>
<text text-anchor="middle" x="1832" y="-1508.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="1832" y="-1497.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_8&#45;&gt;d_layer_9 -->
<g id="edge17" class="edge">
<title>cache_8&#45;&gt;d_layer_9</title>
<path fill="none" stroke="black" d="M1840.34,-1487.36C1855.22,-1456.93 1886.47,-1392.98 1904.79,-1355.5"/>
<polygon fill="black" stroke="black" points="1908.12,-1356.65 1909.37,-1346.13 1901.83,-1353.58 1908.12,-1356.65"/>
<text text-anchor="middle" x="1886" y="-1413.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_8&#45;&gt;m_layer_9 -->
<g id="edge18" class="edge">
<title>cache_8&#45;&gt;m_layer_9</title>
<path fill="none" stroke="black" d="M1830.08,-1487.36C1826.69,-1457.18 1819.6,-1394.06 1815.37,-1356.46"/>
<polygon fill="black" stroke="black" points="1818.81,-1355.68 1814.21,-1346.13 1811.85,-1356.46 1818.81,-1355.68"/>
<text text-anchor="middle" x="1830" y="-1413.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_10 -->
<g id="node29" class="node">
<title>d_layer_10</title>
<polygon fill="lightgreen" stroke="black" points="2182.5,-1165.93 2097.5,-1165.93 2093.5,-1161.93 2093.5,-1124.93 2178.5,-1124.93 2182.5,-1128.93 2182.5,-1165.93"/>
<polyline fill="none" stroke="black" points="2178.5,-1161.93 2093.5,-1161.93 "/>
<polyline fill="none" stroke="black" points="2178.5,-1161.93 2178.5,-1124.93 "/>
<polyline fill="none" stroke="black" points="2178.5,-1161.93 2182.5,-1165.93 "/>
<text text-anchor="middle" x="2138" y="-1153.93" font-family="Arial" font-size="10.00">Dense Layer 10</text>
<text text-anchor="middle" x="2138" y="-1142.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="2138" y="-1131.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_9&#45;&gt;d_layer_10 -->
<g id="edge49" class="edge">
<title>d_layer_9&#45;&gt;d_layer_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1926.02,-1304.72C1935.19,-1281.99 1953.53,-1245.34 1982,-1226.43 2020.71,-1200.72 2044.63,-1231.45 2085,-1208.43 2099.29,-1200.28 2111.53,-1186.75 2120.63,-1174.41"/>
<polygon fill="blue" stroke="blue" points="2123.55,-1176.34 2126.42,-1166.14 2117.82,-1172.33 2123.55,-1176.34"/>
<text text-anchor="middle" x="2015" y="-1238.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2015" y="-1229.03" font-family="Arial" font-size="8.00">[GPU 8 → GPU 9]</text>
</g>
<!-- m_layer_10 -->
<g id="node30" class="node">
<title>m_layer_10</title>
<polygon fill="lightcoral" stroke="black" points="2075.5,-1165.93 1990.5,-1165.93 1986.5,-1161.93 1986.5,-1124.93 2071.5,-1124.93 2075.5,-1128.93 2075.5,-1165.93"/>
<polyline fill="none" stroke="black" points="2071.5,-1161.93 1986.5,-1161.93 "/>
<polyline fill="none" stroke="black" points="2071.5,-1161.93 2071.5,-1124.93 "/>
<polyline fill="none" stroke="black" points="2071.5,-1161.93 2075.5,-1165.93 "/>
<text text-anchor="middle" x="2031" y="-1153.93" font-family="Arial" font-size="10.00">MoE Layer 10</text>
<text text-anchor="middle" x="2031" y="-1142.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2031" y="-1131.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_9&#45;&gt;m_layer_10 -->
<g id="edge50" class="edge">
<title>m_layer_9&#45;&gt;m_layer_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1825.16,-1304.62C1839.9,-1283.46 1865.38,-1249.82 1893,-1226.43 1919.2,-1204.24 1952.39,-1184.77 1979.66,-1170.6"/>
<polygon fill="red" stroke="red" points="1981.34,-1173.67 1988.66,-1166.01 1978.16,-1167.44 1981.34,-1173.67"/>
<text text-anchor="middle" x="1926" y="-1238.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="1926" y="-1229.03" font-family="Arial" font-size="8.00">[GPU 8 → GPU 9]</text>
</g>
<!-- cache_9 -->
<g id="node28" class="node">
<title>cache_9</title>
<polygon fill="lightyellow" stroke="black" points="2123.5,-1343.43 2030.5,-1343.43 2030.5,-1307.43 2123.5,-1307.43 2123.5,-1343.43"/>
<text text-anchor="middle" x="2077" y="-1328.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="2077" y="-1317.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_9&#45;&gt;d_layer_10 -->
<g id="edge19" class="edge">
<title>cache_9&#45;&gt;d_layer_10</title>
<path fill="none" stroke="black" d="M2082.85,-1307.36C2093.23,-1277.06 2115.01,-1213.52 2127.87,-1175.98"/>
<polygon fill="black" stroke="black" points="2131.32,-1176.72 2131.25,-1166.13 2124.69,-1174.46 2131.32,-1176.72"/>
<text text-anchor="middle" x="2117" y="-1233.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_9&#45;&gt;m_layer_10 -->
<g id="edge20" class="edge">
<title>cache_9&#45;&gt;m_layer_10</title>
<path fill="none" stroke="black" d="M2072.59,-1307.36C2064.76,-1277.06 2048.34,-1213.52 2038.64,-1175.98"/>
<polygon fill="black" stroke="black" points="2041.98,-1174.94 2036.09,-1166.13 2035.21,-1176.69 2041.98,-1174.94"/>
<text text-anchor="middle" x="2063" y="-1233.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_11 -->
<g id="node32" class="node">
<title>d_layer_11</title>
<polygon fill="lightgreen" stroke="black" points="2401.5,-985.93 2316.5,-985.93 2312.5,-981.93 2312.5,-944.93 2397.5,-944.93 2401.5,-948.93 2401.5,-985.93"/>
<polyline fill="none" stroke="black" points="2397.5,-981.93 2312.5,-981.93 "/>
<polyline fill="none" stroke="black" points="2397.5,-981.93 2397.5,-944.93 "/>
<polyline fill="none" stroke="black" points="2397.5,-981.93 2401.5,-985.93 "/>
<text text-anchor="middle" x="2357" y="-973.93" font-family="Arial" font-size="10.00">Dense Layer 11</text>
<text text-anchor="middle" x="2357" y="-962.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="2357" y="-951.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_10&#45;&gt;d_layer_11 -->
<g id="edge51" class="edge">
<title>d_layer_10&#45;&gt;d_layer_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2144.81,-1124.71C2153.75,-1101.98 2171.71,-1065.33 2200,-1046.43 2239,-1020.37 2263.23,-1051.63 2304,-1028.43 2318.3,-1020.29 2330.54,-1006.77 2339.64,-994.42"/>
<polygon fill="blue" stroke="blue" points="2342.56,-996.35 2345.42,-986.15 2336.83,-992.34 2342.56,-996.35"/>
<text text-anchor="middle" x="2235" y="-1058.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2235" y="-1049.03" font-family="Arial" font-size="8.00">[GPU 9 → GPU 10]</text>
</g>
<!-- m_layer_11 -->
<g id="node33" class="node">
<title>m_layer_11</title>
<polygon fill="lightcoral" stroke="black" points="2294.5,-985.93 2209.5,-985.93 2205.5,-981.93 2205.5,-944.93 2290.5,-944.93 2294.5,-948.93 2294.5,-985.93"/>
<polyline fill="none" stroke="black" points="2290.5,-981.93 2205.5,-981.93 "/>
<polyline fill="none" stroke="black" points="2290.5,-981.93 2290.5,-944.93 "/>
<polyline fill="none" stroke="black" points="2290.5,-981.93 2294.5,-985.93 "/>
<text text-anchor="middle" x="2250" y="-973.93" font-family="Arial" font-size="10.00">MoE Layer 11</text>
<text text-anchor="middle" x="2250" y="-962.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2250" y="-951.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_10&#45;&gt;m_layer_11 -->
<g id="edge52" class="edge">
<title>m_layer_10&#45;&gt;m_layer_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2042.78,-1124.87C2056.28,-1103.61 2080.07,-1069.6 2107,-1046.43 2133.54,-1023.59 2167.62,-1004.22 2195.85,-990.26"/>
<polygon fill="red" stroke="red" points="2197.71,-993.25 2205.18,-985.74 2194.65,-986.95 2197.71,-993.25"/>
<text text-anchor="middle" x="2142" y="-1058.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2142" y="-1049.03" font-family="Arial" font-size="8.00">[GPU 9 → GPU 10]</text>
</g>
<!-- cache_10 -->
<g id="node31" class="node">
<title>cache_10</title>
<polygon fill="lightyellow" stroke="black" points="2348.5,-1163.43 2255.5,-1163.43 2255.5,-1127.43 2348.5,-1127.43 2348.5,-1163.43"/>
<text text-anchor="middle" x="2302" y="-1148.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="2302" y="-1137.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_10&#45;&gt;d_layer_11 -->
<g id="edge21" class="edge">
<title>cache_10&#45;&gt;d_layer_11</title>
<path fill="none" stroke="black" d="M2307.27,-1127.36C2316.64,-1097.06 2336.27,-1033.52 2347.87,-995.98"/>
<polygon fill="black" stroke="black" points="2351.3,-996.72 2350.91,-986.13 2344.62,-994.65 2351.3,-996.72"/>
<text text-anchor="middle" x="2339" y="-1053.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_10&#45;&gt;m_layer_11 -->
<g id="edge22" class="edge">
<title>cache_10&#45;&gt;m_layer_11</title>
<path fill="none" stroke="black" d="M2297.01,-1127.36C2288.16,-1097.06 2269.6,-1033.52 2258.63,-995.98"/>
<polygon fill="black" stroke="black" points="2261.92,-994.75 2255.76,-986.13 2255.2,-996.71 2261.92,-994.75"/>
<text text-anchor="middle" x="2285" y="-1053.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_12 -->
<g id="node35" class="node">
<title>d_layer_12</title>
<polygon fill="lightgreen" stroke="black" points="2620.5,-805.93 2535.5,-805.93 2531.5,-801.93 2531.5,-764.93 2616.5,-764.93 2620.5,-768.93 2620.5,-805.93"/>
<polyline fill="none" stroke="black" points="2616.5,-801.93 2531.5,-801.93 "/>
<polyline fill="none" stroke="black" points="2616.5,-801.93 2616.5,-764.93 "/>
<polyline fill="none" stroke="black" points="2616.5,-801.93 2620.5,-805.93 "/>
<text text-anchor="middle" x="2576" y="-793.93" font-family="Arial" font-size="10.00">Dense Layer 12</text>
<text text-anchor="middle" x="2576" y="-782.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="2576" y="-771.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_11&#45;&gt;d_layer_12 -->
<g id="edge53" class="edge">
<title>d_layer_11&#45;&gt;d_layer_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2359.66,-944.77C2363.83,-922.09 2374.19,-885.48 2399,-866.43 2443.16,-832.5 2474.23,-875.31 2523,-848.43 2537.51,-840.43 2549.83,-826.79 2558.93,-814.34"/>
<polygon fill="blue" stroke="blue" points="2561.89,-816.21 2564.7,-805.99 2556.13,-812.23 2561.89,-816.21"/>
<text text-anchor="middle" x="2436.5" y="-878.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2436.5" y="-869.03" font-family="Arial" font-size="8.00">[GPU 10 → GPU 11]</text>
</g>
<!-- m_layer_12 -->
<g id="node36" class="node">
<title>m_layer_12</title>
<polygon fill="lightcoral" stroke="black" points="2513.5,-805.93 2428.5,-805.93 2424.5,-801.93 2424.5,-764.93 2509.5,-764.93 2513.5,-768.93 2513.5,-805.93"/>
<polyline fill="none" stroke="black" points="2509.5,-801.93 2424.5,-801.93 "/>
<polyline fill="none" stroke="black" points="2509.5,-801.93 2509.5,-764.93 "/>
<polyline fill="none" stroke="black" points="2509.5,-801.93 2513.5,-805.93 "/>
<text text-anchor="middle" x="2469" y="-793.93" font-family="Arial" font-size="10.00">MoE Layer 12</text>
<text text-anchor="middle" x="2469" y="-782.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2469" y="-771.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_11&#45;&gt;m_layer_12 -->
<g id="edge54" class="edge">
<title>m_layer_11&#45;&gt;m_layer_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2256.66,-944.84C2264.85,-923.24 2280.61,-888.63 2304,-866.43 2335.34,-836.68 2379.84,-815.98 2414.72,-803.11"/>
<polygon fill="red" stroke="red" points="2416.05,-806.35 2424.29,-799.68 2413.69,-799.76 2416.05,-806.35"/>
<text text-anchor="middle" x="2341.5" y="-878.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2341.5" y="-869.03" font-family="Arial" font-size="8.00">[GPU 10 → GPU 11]</text>
</g>
<!-- cache_11 -->
<g id="node34" class="node">
<title>cache_11</title>
<polygon fill="lightyellow" stroke="black" points="2535.5,-983.43 2442.5,-983.43 2442.5,-947.43 2535.5,-947.43 2535.5,-983.43"/>
<text text-anchor="middle" x="2489" y="-968.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="2489" y="-957.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_11&#45;&gt;d_layer_12 -->
<g id="edge23" class="edge">
<title>cache_11&#45;&gt;d_layer_12</title>
<path fill="none" stroke="black" d="M2497.34,-947.36C2512.22,-916.93 2543.47,-852.98 2561.79,-815.5"/>
<polygon fill="black" stroke="black" points="2565.12,-816.65 2566.37,-806.13 2558.83,-813.58 2565.12,-816.65"/>
<text text-anchor="middle" x="2543" y="-873.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_11&#45;&gt;m_layer_12 -->
<g id="edge24" class="edge">
<title>cache_11&#45;&gt;m_layer_12</title>
<path fill="none" stroke="black" d="M2487.08,-947.36C2483.69,-917.18 2476.6,-854.06 2472.37,-816.46"/>
<polygon fill="black" stroke="black" points="2475.81,-815.68 2471.21,-806.13 2468.85,-816.46 2475.81,-815.68"/>
<text text-anchor="middle" x="2487" y="-873.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_13 -->
<g id="node38" class="node">
<title>d_layer_13</title>
<polygon fill="lightgreen" stroke="black" points="2839.5,-625.93 2754.5,-625.93 2750.5,-621.93 2750.5,-584.93 2835.5,-584.93 2839.5,-588.93 2839.5,-625.93"/>
<polyline fill="none" stroke="black" points="2835.5,-621.93 2750.5,-621.93 "/>
<polyline fill="none" stroke="black" points="2835.5,-621.93 2835.5,-584.93 "/>
<polyline fill="none" stroke="black" points="2835.5,-621.93 2839.5,-625.93 "/>
<text text-anchor="middle" x="2795" y="-613.93" font-family="Arial" font-size="10.00">Dense Layer 13</text>
<text text-anchor="middle" x="2795" y="-602.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="2795" y="-591.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_12&#45;&gt;d_layer_13 -->
<g id="edge55" class="edge">
<title>d_layer_12&#45;&gt;d_layer_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2581.79,-764.71C2589.55,-741.97 2605.62,-705.31 2633,-686.43 2673.42,-658.55 2699.23,-692.55 2742,-668.43 2756.33,-660.34 2768.57,-646.83 2777.67,-634.47"/>
<polygon fill="blue" stroke="blue" points="2780.59,-636.39 2783.45,-626.19 2774.85,-632.39 2780.59,-636.39"/>
<text text-anchor="middle" x="2670.5" y="-698.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2670.5" y="-689.03" font-family="Arial" font-size="8.00">[GPU 11 → GPU 12]</text>
</g>
<!-- m_layer_13 -->
<g id="node39" class="node">
<title>m_layer_13</title>
<polygon fill="lightcoral" stroke="black" points="2732.5,-625.93 2647.5,-625.93 2643.5,-621.93 2643.5,-584.93 2728.5,-584.93 2732.5,-588.93 2732.5,-625.93"/>
<polyline fill="none" stroke="black" points="2728.5,-621.93 2643.5,-621.93 "/>
<polyline fill="none" stroke="black" points="2728.5,-621.93 2728.5,-584.93 "/>
<polyline fill="none" stroke="black" points="2728.5,-621.93 2732.5,-625.93 "/>
<text text-anchor="middle" x="2688" y="-613.93" font-family="Arial" font-size="10.00">MoE Layer 13</text>
<text text-anchor="middle" x="2688" y="-602.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2688" y="-591.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_12&#45;&gt;m_layer_13 -->
<g id="edge56" class="edge">
<title>m_layer_12&#45;&gt;m_layer_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2478.75,-764.66C2490.12,-743.22 2510.61,-709.05 2536,-686.43 2564.65,-660.9 2602.91,-640.82 2633.87,-627.16"/>
<polygon fill="red" stroke="red" points="2635.43,-630.3 2643.23,-623.13 2632.66,-623.87 2635.43,-630.3"/>
<text text-anchor="middle" x="2573.5" y="-698.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2573.5" y="-689.03" font-family="Arial" font-size="8.00">[GPU 11 → GPU 12]</text>
</g>
<!-- cache_12 -->
<g id="node37" class="node">
<title>cache_12</title>
<polygon fill="lightyellow" stroke="black" points="2786.5,-803.43 2693.5,-803.43 2693.5,-767.43 2786.5,-767.43 2786.5,-803.43"/>
<text text-anchor="middle" x="2740" y="-788.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="2740" y="-777.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_12&#45;&gt;d_layer_13 -->
<g id="edge25" class="edge">
<title>cache_12&#45;&gt;d_layer_13</title>
<path fill="none" stroke="black" d="M2745.27,-767.36C2754.64,-737.06 2774.27,-673.52 2785.87,-635.98"/>
<polygon fill="black" stroke="black" points="2789.3,-636.72 2788.91,-626.13 2782.62,-634.65 2789.3,-636.72"/>
<text text-anchor="middle" x="2777" y="-693.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_12&#45;&gt;m_layer_13 -->
<g id="edge26" class="edge">
<title>cache_12&#45;&gt;m_layer_13</title>
<path fill="none" stroke="black" d="M2735.01,-767.36C2726.16,-737.06 2707.6,-673.52 2696.63,-635.98"/>
<polygon fill="black" stroke="black" points="2699.92,-634.75 2693.76,-626.13 2693.2,-636.71 2699.92,-634.75"/>
<text text-anchor="middle" x="2723" y="-693.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_14 -->
<g id="node41" class="node">
<title>d_layer_14</title>
<polygon fill="lightgreen" stroke="black" points="3058.5,-445.93 2973.5,-445.93 2969.5,-441.93 2969.5,-404.93 3054.5,-404.93 3058.5,-408.93 3058.5,-445.93"/>
<polyline fill="none" stroke="black" points="3054.5,-441.93 2969.5,-441.93 "/>
<polyline fill="none" stroke="black" points="3054.5,-441.93 3054.5,-404.93 "/>
<polyline fill="none" stroke="black" points="3054.5,-441.93 3058.5,-445.93 "/>
<text text-anchor="middle" x="3014" y="-433.93" font-family="Arial" font-size="10.00">Dense Layer 14</text>
<text text-anchor="middle" x="3014" y="-422.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="3014" y="-411.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_13&#45;&gt;d_layer_14 -->
<g id="edge57" class="edge">
<title>d_layer_13&#45;&gt;d_layer_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M2799.13,-584.73C2804.99,-562.01 2818.02,-525.36 2844,-506.43 2886.51,-475.43 2915.03,-514.02 2961,-488.43 2975.48,-480.37 2987.79,-466.72 2996.89,-454.28"/>
<polygon fill="blue" stroke="blue" points="2999.85,-456.16 3002.67,-445.95 2994.1,-452.17 2999.85,-456.16"/>
<text text-anchor="middle" x="2881.5" y="-518.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2881.5" y="-509.03" font-family="Arial" font-size="8.00">[GPU 12 → GPU 13]</text>
</g>
<!-- m_layer_14 -->
<g id="node42" class="node">
<title>m_layer_14</title>
<polygon fill="lightcoral" stroke="black" points="2951.5,-445.93 2866.5,-445.93 2862.5,-441.93 2862.5,-404.93 2947.5,-404.93 2951.5,-408.93 2951.5,-445.93"/>
<polyline fill="none" stroke="black" points="2947.5,-441.93 2862.5,-441.93 "/>
<polyline fill="none" stroke="black" points="2947.5,-441.93 2947.5,-404.93 "/>
<polyline fill="none" stroke="black" points="2947.5,-441.93 2951.5,-445.93 "/>
<text text-anchor="middle" x="2907" y="-433.93" font-family="Arial" font-size="10.00">MoE Layer 14</text>
<text text-anchor="middle" x="2907" y="-422.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2907" y="-411.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_13&#45;&gt;m_layer_14 -->
<g id="edge58" class="edge">
<title>m_layer_13&#45;&gt;m_layer_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2696,-584.92C2705.64,-563.4 2723.63,-528.85 2748,-506.43 2778.11,-478.72 2819.62,-458.27 2852.67,-444.98"/>
<polygon fill="red" stroke="red" points="2854.16,-448.16 2862.2,-441.26 2851.61,-441.64 2854.16,-448.16"/>
<text text-anchor="middle" x="2785.5" y="-518.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="2785.5" y="-509.03" font-family="Arial" font-size="8.00">[GPU 12 → GPU 13]</text>
</g>
<!-- cache_13 -->
<g id="node40" class="node">
<title>cache_13</title>
<polygon fill="lightyellow" stroke="black" points="2988.5,-623.43 2895.5,-623.43 2895.5,-587.43 2988.5,-587.43 2988.5,-623.43"/>
<text text-anchor="middle" x="2942" y="-608.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="2942" y="-597.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_13&#45;&gt;d_layer_14 -->
<g id="edge27" class="edge">
<title>cache_13&#45;&gt;d_layer_14</title>
<path fill="none" stroke="black" d="M2948.9,-587.36C2961.21,-556.93 2987.08,-492.98 3002.24,-455.5"/>
<polygon fill="black" stroke="black" points="3005.52,-456.71 3006.03,-446.13 2999.04,-454.09 3005.52,-456.71"/>
<text text-anchor="middle" x="2988" y="-513.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_13&#45;&gt;m_layer_14 -->
<g id="edge28" class="edge">
<title>cache_13&#45;&gt;m_layer_14</title>
<path fill="none" stroke="black" d="M2938.64,-587.36C2932.69,-557.06 2920.19,-493.52 2912.81,-455.98"/>
<polygon fill="black" stroke="black" points="2916.24,-455.27 2910.87,-446.13 2909.37,-456.62 2916.24,-455.27"/>
<text text-anchor="middle" x="2933" y="-513.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_15 -->
<g id="node44" class="node">
<title>d_layer_15</title>
<polygon fill="lightgreen" stroke="black" points="3277.5,-265.93 3192.5,-265.93 3188.5,-261.93 3188.5,-224.93 3273.5,-224.93 3277.5,-228.93 3277.5,-265.93"/>
<polyline fill="none" stroke="black" points="3273.5,-261.93 3188.5,-261.93 "/>
<polyline fill="none" stroke="black" points="3273.5,-261.93 3273.5,-224.93 "/>
<polyline fill="none" stroke="black" points="3273.5,-261.93 3277.5,-265.93 "/>
<text text-anchor="middle" x="3233" y="-253.93" font-family="Arial" font-size="10.00">Dense Layer 15</text>
<text text-anchor="middle" x="3233" y="-242.93" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="3233" y="-231.93" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_14&#45;&gt;d_layer_15 -->
<g id="edge59" class="edge">
<title>d_layer_14&#45;&gt;d_layer_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3019.79,-404.71C3027.55,-381.97 3043.62,-345.31 3071,-326.43 3111.42,-298.55 3137.23,-332.55 3180,-308.43 3194.33,-300.34 3206.57,-286.83 3215.67,-274.47"/>
<polygon fill="blue" stroke="blue" points="3218.59,-276.39 3221.45,-266.19 3212.85,-272.39 3218.59,-276.39"/>
<text text-anchor="middle" x="3108.5" y="-338.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="3108.5" y="-329.03" font-family="Arial" font-size="8.00">[GPU 13 → GPU 14]</text>
</g>
<!-- m_layer_15 -->
<g id="node45" class="node">
<title>m_layer_15</title>
<polygon fill="lightcoral" stroke="black" points="3170.5,-265.93 3085.5,-265.93 3081.5,-261.93 3081.5,-224.93 3166.5,-224.93 3170.5,-228.93 3170.5,-265.93"/>
<polyline fill="none" stroke="black" points="3166.5,-261.93 3081.5,-261.93 "/>
<polyline fill="none" stroke="black" points="3166.5,-261.93 3166.5,-224.93 "/>
<polyline fill="none" stroke="black" points="3166.5,-261.93 3170.5,-265.93 "/>
<text text-anchor="middle" x="3126" y="-253.93" font-family="Arial" font-size="10.00">MoE Layer 15</text>
<text text-anchor="middle" x="3126" y="-242.93" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="3126" y="-231.93" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_14&#45;&gt;m_layer_15 -->
<g id="edge60" class="edge">
<title>m_layer_14&#45;&gt;m_layer_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M2916.75,-404.66C2928.12,-383.22 2948.61,-349.05 2974,-326.43 3002.65,-300.9 3040.91,-280.82 3071.87,-267.16"/>
<polygon fill="red" stroke="red" points="3073.43,-270.3 3081.23,-263.13 3070.66,-263.87 3073.43,-270.3"/>
<text text-anchor="middle" x="3011.5" y="-338.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="3011.5" y="-329.03" font-family="Arial" font-size="8.00">[GPU 13 → GPU 14]</text>
</g>
<!-- cache_14 -->
<g id="node43" class="node">
<title>cache_14</title>
<polygon fill="lightyellow" stroke="black" points="3224.5,-443.43 3131.5,-443.43 3131.5,-407.43 3224.5,-407.43 3224.5,-443.43"/>
<text text-anchor="middle" x="3178" y="-428.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="3178" y="-417.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_14&#45;&gt;d_layer_15 -->
<g id="edge29" class="edge">
<title>cache_14&#45;&gt;d_layer_15</title>
<path fill="none" stroke="black" d="M3183.27,-407.36C3192.64,-377.06 3212.27,-313.52 3223.87,-275.98"/>
<polygon fill="black" stroke="black" points="3227.3,-276.72 3226.91,-266.13 3220.62,-274.65 3227.3,-276.72"/>
<text text-anchor="middle" x="3215" y="-333.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_14&#45;&gt;m_layer_15 -->
<g id="edge30" class="edge">
<title>cache_14&#45;&gt;m_layer_15</title>
<path fill="none" stroke="black" d="M3173.01,-407.36C3164.16,-377.06 3145.6,-313.52 3134.63,-275.98"/>
<polygon fill="black" stroke="black" points="3137.92,-274.75 3131.76,-266.13 3131.2,-276.71 3137.92,-274.75"/>
<text text-anchor="middle" x="3161" y="-333.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- d_layer_16 -->
<g id="node47" class="node">
<title>d_layer_16</title>
<polygon fill="lightgreen" stroke="black" points="3496.5,-128.43 3411.5,-128.43 3407.5,-124.43 3407.5,-87.43 3492.5,-87.43 3496.5,-91.43 3496.5,-128.43"/>
<polyline fill="none" stroke="black" points="3492.5,-124.43 3407.5,-124.43 "/>
<polyline fill="none" stroke="black" points="3492.5,-124.43 3492.5,-87.43 "/>
<polyline fill="none" stroke="black" points="3492.5,-124.43 3496.5,-128.43 "/>
<text text-anchor="middle" x="3452" y="-116.43" font-family="Arial" font-size="10.00">Dense Layer 16</text>
<text text-anchor="middle" x="3452" y="-105.43" font-family="Arial" font-size="10.00">Params: ~120M</text>
<text text-anchor="middle" x="3452" y="-94.43" font-family="Arial" font-size="10.00">Memory: ~45MB</text>
</g>
<!-- d_layer_15&#45;&gt;d_layer_16 -->
<g id="edge61" class="edge">
<title>d_layer_15&#45;&gt;d_layer_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M3235.87,-224.76C3240.29,-202.07 3251.03,-165.46 3276,-146.43 3317.54,-114.76 3342.61,-139.04 3397.54,-128.31"/>
<polygon fill="blue" stroke="blue" points="3398.41,-131.7 3407.39,-126.08 3396.86,-124.88 3398.41,-131.7"/>
<text text-anchor="middle" x="3313.5" y="-158.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="3313.5" y="-149.03" font-family="Arial" font-size="8.00">[GPU 14 → GPU 15]</text>
</g>
<!-- m_layer_16 -->
<g id="node48" class="node">
<title>m_layer_16</title>
<polygon fill="lightcoral" stroke="black" points="3389.5,-128.43 3304.5,-128.43 3300.5,-124.43 3300.5,-87.43 3385.5,-87.43 3389.5,-91.43 3389.5,-128.43"/>
<polyline fill="none" stroke="black" points="3385.5,-124.43 3300.5,-124.43 "/>
<polyline fill="none" stroke="black" points="3385.5,-124.43 3385.5,-87.43 "/>
<polyline fill="none" stroke="black" points="3385.5,-124.43 3389.5,-128.43 "/>
<text text-anchor="middle" x="3345" y="-116.43" font-family="Arial" font-size="10.00">MoE Layer 16</text>
<text text-anchor="middle" x="3345" y="-105.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="3345" y="-94.43" font-family="Arial" font-size="10.00">Memory: ~48MB</text>
</g>
<!-- m_layer_15&#45;&gt;m_layer_16 -->
<g id="edge62" class="edge">
<title>m_layer_15&#45;&gt;m_layer_16</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M3131.72,-224.61C3139.27,-202.13 3154.75,-166.06 3181,-146.43 3212.27,-123.05 3255.6,-113.86 3289.86,-110.42"/>
<polygon fill="red" stroke="red" points="3290.52,-113.87 3300.19,-109.52 3289.92,-106.9 3290.52,-113.87"/>
<text text-anchor="middle" x="3218.5" y="-158.03" font-family="Arial" font-size="8.00">activation</text>
<text text-anchor="middle" x="3218.5" y="-149.03" font-family="Arial" font-size="8.00">[GPU 14 → GPU 15]</text>
</g>
<!-- cache_15 -->
<g id="node46" class="node">
<title>cache_15</title>
<polygon fill="lightyellow" stroke="black" points="3426.5,-263.43 3333.5,-263.43 3333.5,-227.43 3426.5,-227.43 3426.5,-263.43"/>
<text text-anchor="middle" x="3380" y="-248.43" font-family="Arial" font-size="10.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="3380" y="-237.43" font-family="Arial" font-size="10.00">Capacity: ~50MB</text>
</g>
<!-- cache_15&#45;&gt;d_layer_16 -->
<g id="edge31" class="edge">
<title>cache_15&#45;&gt;d_layer_16</title>
<path fill="none" stroke="black" d="M3389.12,-227.27C3401.1,-204.71 3422.32,-164.79 3436.76,-137.61"/>
<polygon fill="black" stroke="black" points="3439.96,-139.05 3441.56,-128.58 3433.78,-135.77 3439.96,-139.05"/>
<text text-anchor="middle" x="3438" y="-153.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- cache_15&#45;&gt;m_layer_16 -->
<g id="edge32" class="edge">
<title>cache_15&#45;&gt;m_layer_16</title>
<path fill="none" stroke="black" d="M3375.57,-227.27C3369.79,-204.91 3359.61,-165.49 3352.59,-138.33"/>
<polygon fill="black" stroke="black" points="3355.97,-137.38 3350.08,-128.58 3349.19,-139.13 3355.97,-137.38"/>
<text text-anchor="middle" x="3366" y="-153.53" font-family="Arial" font-size="8.00">load</text>
</g>
<!-- output_dense -->
<g id="node49" class="node">
<title>output_dense</title>
<ellipse fill="gold" stroke="black" cx="3496" cy="-21.21" rx="88.5" ry="21.43"/>
<text text-anchor="middle" x="3496" y="-24.21" font-family="Arial" font-size="10.00">Output Tokens</text>
<text text-anchor="middle" x="3496" y="-13.21" font-family="Arial" font-size="10.00">(Batch: 1024, Seq: 2048)</text>
</g>
<!-- d_layer_16&#45;&gt;output_dense -->
<g id="edge63" class="edge">
<title>d_layer_16&#45;&gt;output_dense</title>
<path fill="none" stroke="black" d="M3462.21,-87.28C3467.73,-76.63 3474.67,-63.27 3480.82,-51.43"/>
<polygon fill="black" stroke="black" points="3484.04,-52.83 3485.54,-42.34 3477.83,-49.6 3484.04,-52.83"/>
<text text-anchor="middle" x="3486.5" y="-63.03" font-family="Arial" font-size="8.00">output</text>
</g>
<!-- output_moe -->
<g id="node50" class="node">
<title>output_moe</title>
<ellipse fill="gold" stroke="black" cx="3301" cy="-21.21" rx="88.5" ry="21.43"/>
<text text-anchor="middle" x="3301" y="-24.21" font-family="Arial" font-size="10.00">Output Tokens</text>
<text text-anchor="middle" x="3301" y="-13.21" font-family="Arial" font-size="10.00">(Batch: 1024, Seq: 2048)</text>
</g>
<!-- m_layer_16&#45;&gt;output_moe -->
<g id="edge64" class="edge">
<title>m_layer_16&#45;&gt;output_moe</title>
<path fill="none" stroke="black" d="M3334.79,-87.28C3329.27,-76.63 3322.33,-63.27 3316.18,-51.43"/>
<polygon fill="black" stroke="black" points="3319.17,-49.6 3311.46,-42.34 3312.96,-52.83 3319.17,-49.6"/>
<text text-anchor="middle" x="3335.5" y="-63.03" font-family="Arial" font-size="8.00">output</text>
</g>
<!-- input_dense -->
<g id="node51" class="node">
<title>input_dense</title>
<ellipse fill="gold" stroke="black" cx="717" cy="-2936.43" rx="88.5" ry="21.43"/>
<text text-anchor="middle" x="717" y="-2939.43" font-family="Arial" font-size="10.00">Input Tokens</text>
<text text-anchor="middle" x="717" y="-2928.43" font-family="Arial" font-size="10.00">(Batch: 1024, Seq: 2048)</text>
</g>
<!-- input_dense&#45;&gt;d_layer_1 -->
<g id="edge65" class="edge">
<title>input_dense&#45;&gt;d_layer_1</title>
<path fill="none" stroke="black" d="M693.12,-2915.73C674.43,-2901.46 647.13,-2883.05 620,-2873.43 599.08,-2866.01 242.74,-2838.57 223,-2828.43 207.9,-2820.67 194.91,-2807.06 185.25,-2794.55"/>
<polygon fill="black" stroke="black" points="187.84,-2792.17 179.11,-2786.16 182.19,-2796.3 187.84,-2792.17"/>
<text text-anchor="middle" x="468" y="-2849.03" font-family="Arial" font-size="8.00">forward</text>
</g>
<!-- input_moe -->
<g id="node52" class="node">
<title>input_moe</title>
<ellipse fill="gold" stroke="black" cx="315" cy="-2936.43" rx="88.5" ry="21.43"/>
<text text-anchor="middle" x="315" y="-2939.43" font-family="Arial" font-size="10.00">Input Tokens</text>
<text text-anchor="middle" x="315" y="-2928.43" font-family="Arial" font-size="10.00">(Batch: 1024, Seq: 2048)</text>
</g>
<!-- input_moe&#45;&gt;m_layer_1 -->
<g id="edge66" class="edge">
<title>input_moe&#45;&gt;m_layer_1</title>
<path fill="none" stroke="black" d="M288.53,-2915.94C270.33,-2903.02 245.34,-2886.16 222,-2873.43 195.61,-2859.03 187.82,-2857.8 160,-2846.43 139.3,-2837.96 131.27,-2841.33 113,-2828.43 99.97,-2819.23 88.14,-2806.12 78.98,-2794.32"/>
<polygon fill="black" stroke="black" points="81.59,-2791.96 72.81,-2786.04 75.98,-2796.15 81.59,-2791.96"/>
<text text-anchor="middle" x="196" y="-2849.03" font-family="Arial" font-size="8.00">forward</text>
</g>
<!-- expert_comm_0 -->
<g id="node53" class="node">
<title>expert_comm_0</title>
<polygon fill="orange" stroke="black" points="610.5,-2936.43 563.25,-2978.93 468.75,-2978.93 421.5,-2936.43 468.75,-2893.93 563.25,-2893.93 610.5,-2936.43"/>
<text text-anchor="middle" x="516" y="-2950.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="516" y="-2939.43" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="516" y="-2928.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="516" y="-2917.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_0&#45;&gt;m_layer_1 -->
<g id="edge67" class="edge">
<title>expert_comm_0&#45;&gt;m_layer_1</title>
<path fill="none" stroke="black" d="M463.19,-2898.58C447.35,-2889.03 429.52,-2879.69 412,-2873.43 396.18,-2867.77 127.69,-2836.57 113,-2828.43 98.51,-2820.39 86.2,-2806.75 77.09,-2794.3"/>
<polygon fill="black" stroke="black" points="79.89,-2792.19 71.32,-2785.96 74.13,-2796.18 79.89,-2792.19"/>
<text text-anchor="middle" x="313" y="-2849.03" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_1 -->
<g id="node54" class="node">
<title>expert_comm_1</title>
<polygon fill="orange" stroke="black" points="635.5,-2765.43 588.25,-2807.93 493.75,-2807.93 446.5,-2765.43 493.75,-2722.93 588.25,-2722.93 635.5,-2765.43"/>
<text text-anchor="middle" x="541" y="-2779.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="541" y="-2768.43" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="541" y="-2757.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="541" y="-2746.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_1&#45;&gt;m_layer_2 -->
<g id="edge68" class="edge">
<title>expert_comm_1&#45;&gt;m_layer_2</title>
<path fill="none" stroke="black" d="M487.77,-2727.97C457.37,-2708.15 418.03,-2684.13 381,-2666.43 360.44,-2656.6 351.72,-2661.41 333,-2648.43 319.79,-2639.26 307.75,-2626.15 298.4,-2614.35"/>
<polygon fill="black" stroke="black" points="300.94,-2611.9 292.1,-2606.06 295.37,-2616.14 300.94,-2611.9"/>
<text text-anchor="middle" x="437" y="-2673.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_2 -->
<g id="node55" class="node">
<title>expert_comm_2</title>
<polygon fill="orange" stroke="black" points="854.5,-2585.43 807.25,-2627.93 712.75,-2627.93 665.5,-2585.43 712.75,-2542.93 807.25,-2542.93 854.5,-2585.43"/>
<text text-anchor="middle" x="760" y="-2599.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="760" y="-2588.43" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="760" y="-2577.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="760" y="-2566.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_2&#45;&gt;m_layer_3 -->
<g id="edge69" class="edge">
<title>expert_comm_2&#45;&gt;m_layer_3</title>
<path fill="none" stroke="black" d="M705.97,-2548.72C674.64,-2528.9 633.98,-2504.64 596,-2486.43 576.95,-2477.29 569.18,-2480.73 552,-2468.43 539.02,-2459.13 527.07,-2446.12 517.73,-2434.42"/>
<polygon fill="black" stroke="black" points="520.29,-2432 511.42,-2426.2 514.74,-2436.27 520.29,-2432"/>
<text text-anchor="middle" x="653" y="-2493.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_3 -->
<g id="node56" class="node">
<title>expert_comm_3</title>
<polygon fill="orange" stroke="black" points="1073.5,-2405.43 1026.25,-2447.93 931.75,-2447.93 884.5,-2405.43 931.75,-2362.93 1026.25,-2362.93 1073.5,-2405.43"/>
<text text-anchor="middle" x="979" y="-2419.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="979" y="-2408.43" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="979" y="-2397.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="979" y="-2386.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_3&#45;&gt;m_layer_4 -->
<g id="edge70" class="edge">
<title>expert_comm_3&#45;&gt;m_layer_4</title>
<path fill="none" stroke="black" d="M925.76,-2368.27C895.1,-2348.42 855.35,-2324.28 818,-2306.43 797.82,-2296.78 789.33,-2301.24 771,-2288.43 757.82,-2279.21 745.78,-2266.1 736.43,-2254.31"/>
<polygon fill="black" stroke="black" points="738.97,-2251.86 730.12,-2246.03 733.4,-2256.1 738.97,-2251.86"/>
<text text-anchor="middle" x="875" y="-2313.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_4 -->
<g id="node57" class="node">
<title>expert_comm_4</title>
<polygon fill="orange" stroke="black" points="1292.5,-2225.43 1245.25,-2267.93 1150.75,-2267.93 1103.5,-2225.43 1150.75,-2182.93 1245.25,-2182.93 1292.5,-2225.43"/>
<text text-anchor="middle" x="1198" y="-2239.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="1198" y="-2228.43" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1198" y="-2217.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1198" y="-2206.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_4&#45;&gt;m_layer_5 -->
<g id="edge71" class="edge">
<title>expert_comm_4&#45;&gt;m_layer_5</title>
<path fill="none" stroke="black" d="M1143.97,-2188.72C1112.64,-2168.9 1071.98,-2144.64 1034,-2126.43 1014.95,-2117.29 1007.18,-2120.73 990,-2108.43 977.02,-2099.13 965.07,-2086.12 955.73,-2074.42"/>
<polygon fill="black" stroke="black" points="958.29,-2072 949.42,-2066.2 952.74,-2076.27 958.29,-2072"/>
<text text-anchor="middle" x="1091" y="-2133.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_5 -->
<g id="node58" class="node">
<title>expert_comm_5</title>
<polygon fill="orange" stroke="black" points="1511.5,-2045.43 1464.25,-2087.93 1369.75,-2087.93 1322.5,-2045.43 1369.75,-2002.93 1464.25,-2002.93 1511.5,-2045.43"/>
<text text-anchor="middle" x="1417" y="-2059.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="1417" y="-2048.43" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1417" y="-2037.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1417" y="-2026.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_5&#45;&gt;m_layer_6 -->
<g id="edge72" class="edge">
<title>expert_comm_5&#45;&gt;m_layer_6</title>
<path fill="none" stroke="black" d="M1362.97,-2008.72C1331.64,-1988.9 1290.98,-1964.64 1253,-1946.43 1233.95,-1937.29 1226.18,-1940.73 1209,-1928.43 1196.02,-1919.13 1184.07,-1906.12 1174.73,-1894.42"/>
<polygon fill="black" stroke="black" points="1177.29,-1892 1168.42,-1886.2 1171.74,-1896.27 1177.29,-1892"/>
<text text-anchor="middle" x="1310" y="-1953.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_6 -->
<g id="node59" class="node">
<title>expert_comm_6</title>
<polygon fill="orange" stroke="black" points="1730.5,-1865.43 1683.25,-1907.93 1588.75,-1907.93 1541.5,-1865.43 1588.75,-1822.93 1683.25,-1822.93 1730.5,-1865.43"/>
<text text-anchor="middle" x="1636" y="-1879.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="1636" y="-1868.43" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1636" y="-1857.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1636" y="-1846.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_6&#45;&gt;m_layer_7 -->
<g id="edge73" class="edge">
<title>expert_comm_6&#45;&gt;m_layer_7</title>
<path fill="none" stroke="black" d="M1582.76,-1828.27C1552.1,-1808.42 1512.35,-1784.28 1475,-1766.43 1454.82,-1756.78 1446.33,-1761.24 1428,-1748.43 1414.82,-1739.21 1402.78,-1726.1 1393.43,-1714.31"/>
<polygon fill="black" stroke="black" points="1395.97,-1711.86 1387.12,-1706.03 1390.4,-1716.1 1395.97,-1711.86"/>
<text text-anchor="middle" x="1532" y="-1773.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_7 -->
<g id="node60" class="node">
<title>expert_comm_7</title>
<polygon fill="orange" stroke="black" points="1949.5,-1685.43 1902.25,-1727.93 1807.75,-1727.93 1760.5,-1685.43 1807.75,-1642.93 1902.25,-1642.93 1949.5,-1685.43"/>
<text text-anchor="middle" x="1855" y="-1699.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="1855" y="-1688.43" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="1855" y="-1677.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="1855" y="-1666.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_7&#45;&gt;m_layer_8 -->
<g id="edge74" class="edge">
<title>expert_comm_7&#45;&gt;m_layer_8</title>
<path fill="none" stroke="black" d="M1801.76,-1648.27C1771.1,-1628.42 1731.35,-1604.28 1694,-1586.43 1673.82,-1576.78 1665.33,-1581.24 1647,-1568.43 1633.82,-1559.21 1621.78,-1546.1 1612.43,-1534.31"/>
<polygon fill="black" stroke="black" points="1614.97,-1531.86 1606.12,-1526.03 1609.4,-1536.1 1614.97,-1531.86"/>
<text text-anchor="middle" x="1751" y="-1593.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_8 -->
<g id="node61" class="node">
<title>expert_comm_8</title>
<polygon fill="orange" stroke="black" points="2168.5,-1505.43 2121.25,-1547.93 2026.75,-1547.93 1979.5,-1505.43 2026.75,-1462.93 2121.25,-1462.93 2168.5,-1505.43"/>
<text text-anchor="middle" x="2074" y="-1519.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="2074" y="-1508.43" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2074" y="-1497.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2074" y="-1486.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_8&#45;&gt;m_layer_9 -->
<g id="edge75" class="edge">
<title>expert_comm_8&#45;&gt;m_layer_9</title>
<path fill="none" stroke="black" d="M2019.6,-1469C2005.26,-1460.04 1989.69,-1450.64 1975,-1442.43 1963.2,-1435.83 1876.7,-1396.68 1866,-1388.43 1853.45,-1378.74 1841.63,-1365.8 1832.26,-1354.24"/>
<polygon fill="black" stroke="black" points="1834.83,-1351.84 1825.9,-1346.13 1829.32,-1356.16 1834.83,-1351.84"/>
<text text-anchor="middle" x="1962" y="-1413.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_9 -->
<g id="node62" class="node">
<title>expert_comm_9</title>
<polygon fill="orange" stroke="black" points="2387.5,-1325.43 2340.25,-1367.93 2245.75,-1367.93 2198.5,-1325.43 2245.75,-1282.93 2340.25,-1282.93 2387.5,-1325.43"/>
<text text-anchor="middle" x="2293" y="-1339.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="2293" y="-1328.43" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2293" y="-1317.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2293" y="-1306.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_9&#45;&gt;m_layer_10 -->
<g id="edge76" class="edge">
<title>expert_comm_9&#45;&gt;m_layer_10</title>
<path fill="none" stroke="black" d="M2238.97,-1288.72C2207.64,-1268.9 2166.98,-1244.64 2129,-1226.43 2109.95,-1217.29 2102.18,-1220.73 2085,-1208.43 2072.02,-1199.13 2060.07,-1186.12 2050.73,-1174.42"/>
<polygon fill="black" stroke="black" points="2053.29,-1172 2044.42,-1166.2 2047.74,-1176.27 2053.29,-1172"/>
<text text-anchor="middle" x="2186" y="-1233.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_10 -->
<g id="node63" class="node">
<title>expert_comm_10</title>
<polygon fill="orange" stroke="black" points="2606.5,-1145.43 2559.25,-1187.93 2464.75,-1187.93 2417.5,-1145.43 2464.75,-1102.93 2559.25,-1102.93 2606.5,-1145.43"/>
<text text-anchor="middle" x="2512" y="-1159.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="2512" y="-1148.43" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2512" y="-1137.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2512" y="-1126.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_10&#45;&gt;m_layer_11 -->
<g id="edge77" class="edge">
<title>expert_comm_10&#45;&gt;m_layer_11</title>
<path fill="none" stroke="black" d="M2458.76,-1108.27C2428.1,-1088.42 2388.35,-1064.28 2351,-1046.43 2330.82,-1036.78 2322.33,-1041.24 2304,-1028.43 2290.82,-1019.21 2278.78,-1006.1 2269.43,-994.31"/>
<polygon fill="black" stroke="black" points="2271.97,-991.86 2263.12,-986.03 2266.4,-996.1 2271.97,-991.86"/>
<text text-anchor="middle" x="2408" y="-1053.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_11 -->
<g id="node64" class="node">
<title>expert_comm_11</title>
<polygon fill="orange" stroke="black" points="2825.5,-965.43 2778.25,-1007.93 2683.75,-1007.93 2636.5,-965.43 2683.75,-922.93 2778.25,-922.93 2825.5,-965.43"/>
<text text-anchor="middle" x="2731" y="-979.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="2731" y="-968.43" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2731" y="-957.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2731" y="-946.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_11&#45;&gt;m_layer_12 -->
<g id="edge78" class="edge">
<title>expert_comm_11&#45;&gt;m_layer_12</title>
<path fill="none" stroke="black" d="M2676.6,-929C2662.26,-920.04 2646.69,-910.64 2632,-902.43 2620.2,-895.83 2533.7,-856.68 2523,-848.43 2510.45,-838.74 2498.63,-825.8 2489.26,-814.24"/>
<polygon fill="black" stroke="black" points="2491.83,-811.84 2482.9,-806.13 2486.32,-816.16 2491.83,-811.84"/>
<text text-anchor="middle" x="2619" y="-873.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_12 -->
<g id="node65" class="node">
<title>expert_comm_12</title>
<polygon fill="orange" stroke="black" points="3044.5,-785.43 2997.25,-827.93 2902.75,-827.93 2855.5,-785.43 2902.75,-742.93 2997.25,-742.93 3044.5,-785.43"/>
<text text-anchor="middle" x="2950" y="-799.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="2950" y="-788.43" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="2950" y="-777.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="2950" y="-766.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_12&#45;&gt;m_layer_13 -->
<g id="edge79" class="edge">
<title>expert_comm_12&#45;&gt;m_layer_13</title>
<path fill="none" stroke="black" d="M2896.76,-748.27C2866.1,-728.42 2826.35,-704.28 2789,-686.43 2768.82,-676.78 2760.33,-681.24 2742,-668.43 2728.82,-659.21 2716.78,-646.1 2707.43,-634.31"/>
<polygon fill="black" stroke="black" points="2709.97,-631.86 2701.12,-626.03 2704.4,-636.1 2709.97,-631.86"/>
<text text-anchor="middle" x="2846" y="-693.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_13 -->
<g id="node66" class="node">
<title>expert_comm_13</title>
<polygon fill="orange" stroke="black" points="3263.5,-605.43 3216.25,-647.93 3121.75,-647.93 3074.5,-605.43 3121.75,-562.93 3216.25,-562.93 3263.5,-605.43"/>
<text text-anchor="middle" x="3169" y="-619.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="3169" y="-608.43" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3169" y="-597.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="3169" y="-586.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_13&#45;&gt;m_layer_14 -->
<g id="edge80" class="edge">
<title>expert_comm_13&#45;&gt;m_layer_14</title>
<path fill="none" stroke="black" d="M3114.52,-569.16C3100.18,-560.19 3084.63,-550.75 3070,-542.43 3039.59,-525.13 3031.44,-521.76 3000,-506.43 2982.84,-498.06 2976.27,-499.88 2961,-488.43 2948.23,-478.85 2936.31,-465.81 2926.93,-454.15"/>
<polygon fill="black" stroke="black" points="2929.48,-451.73 2920.58,-445.98 2923.95,-456.03 2929.48,-451.73"/>
<text text-anchor="middle" x="3061" y="-513.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_14 -->
<g id="node67" class="node">
<title>expert_comm_14</title>
<polygon fill="orange" stroke="black" points="3482.5,-425.43 3435.25,-467.93 3340.75,-467.93 3293.5,-425.43 3340.75,-382.93 3435.25,-382.93 3482.5,-425.43"/>
<text text-anchor="middle" x="3388" y="-439.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="3388" y="-428.43" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3388" y="-417.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="3388" y="-406.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_14&#45;&gt;m_layer_15 -->
<g id="edge81" class="edge">
<title>expert_comm_14&#45;&gt;m_layer_15</title>
<path fill="none" stroke="black" d="M3334.76,-388.27C3304.1,-368.42 3264.35,-344.28 3227,-326.43 3206.82,-316.78 3198.33,-321.24 3180,-308.43 3166.82,-299.21 3154.78,-286.1 3145.43,-274.31"/>
<polygon fill="black" stroke="black" points="3147.97,-271.86 3139.12,-266.03 3142.4,-276.1 3147.97,-271.86"/>
<text text-anchor="middle" x="3284" y="-333.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- expert_comm_15 -->
<g id="node68" class="node">
<title>expert_comm_15</title>
<polygon fill="orange" stroke="black" points="3701.5,-245.43 3654.25,-287.93 3559.75,-287.93 3512.5,-245.43 3559.75,-202.93 3654.25,-202.93 3701.5,-245.43"/>
<text text-anchor="middle" x="3607" y="-259.43" font-family="Arial" font-size="10.00">Expert Communication</text>
<text text-anchor="middle" x="3607" y="-248.43" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3607" y="-237.43" font-family="Arial" font-size="10.00">8 Experts</text>
<text text-anchor="middle" x="3607" y="-226.43" font-family="Arial" font-size="10.00">All&#45;to&#45;All</text>
</g>
<!-- expert_comm_15&#45;&gt;m_layer_16 -->
<g id="edge82" class="edge">
<title>expert_comm_15&#45;&gt;m_layer_16</title>
<path fill="none" stroke="black" d="M3554.54,-207.59C3524.8,-187.76 3486.36,-163.87 3450,-146.43 3430.7,-137.16 3423.28,-136.53 3399.38,-128.46"/>
<polygon fill="black" stroke="black" points="3400.37,-125.1 3389.78,-125.13 3398.08,-131.72 3400.37,-125.1"/>
<text text-anchor="middle" x="3506" y="-153.53" font-family="Arial" font-size="8.00">expert routing</text>
</g>
<!-- memory_legend -->
<g id="node69" class="node">
<title>memory_legend</title>
<polygon fill="lightgray" stroke="black" points="1579.5,-2968.43 1364.5,-2968.43 1364.5,-2904.43 1585.5,-2904.43 1585.5,-2962.43 1579.5,-2968.43"/>
<polyline fill="none" stroke="black" points="1579.5,-2968.43 1579.5,-2962.43 "/>
<polyline fill="none" stroke="black" points="1585.5,-2962.43 1579.5,-2962.43 "/>
<text text-anchor="middle" x="1475" y="-2956.43" font-family="Arial" font-size="10.00">Memory Footprint Legend:</text>
<text text-anchor="middle" x="1475" y="-2933.43" font-family="Arial" font-size="10.00">Dense Layer: ~45MB (weights + activations)</text>
<text text-anchor="middle" x="1475" y="-2922.43" font-family="Arial" font-size="10.00">MoE Layer: ~48MB (8 experts × 6MB each)</text>
<text text-anchor="middle" x="1475" y="-2911.43" font-family="Arial" font-size="10.00">Cache Capacity: ~50MB (fits within SRAM/L2)</text>
</g>
<!-- perf_metrics -->
<g id="node70" class="node">
<title>perf_metrics</title>
<polygon fill="lightcyan" stroke="black" points="1788,-2990.93 1604,-2990.93 1604,-2881.93 1794,-2881.93 1794,-2984.93 1788,-2990.93"/>
<polyline fill="none" stroke="black" points="1788,-2990.93 1788,-2984.93 "/>
<polyline fill="none" stroke="black" points="1794,-2984.93 1788,-2984.93 "/>
<text text-anchor="middle" x="1699" y="-2978.93" font-family="Arial" font-size="10.00">Performance Metrics:</text>
<text text-anchor="middle" x="1699" y="-2955.93" font-family="Arial" font-size="10.00">Dense Model:</text>
<text text-anchor="middle" x="1699" y="-2944.93" font-family="Arial" font-size="10.00"> &#160;TPS: 15,360 (vs 12,800 baseline)</text>
<text text-anchor="middle" x="1699" y="-2933.93" font-family="Arial" font-size="10.00"> &#160;TPOT: 0.065ms (vs 0.078ms baseline)</text>
<text text-anchor="middle" x="1699" y="-2910.93" font-family="Arial" font-size="10.00">MoE Model:</text>
<text text-anchor="middle" x="1699" y="-2899.93" font-family="Arial" font-size="10.00"> &#160;TPS: 13,400 (vs 10,200 baseline)</text>
<text text-anchor="middle" x="1699" y="-2888.93" font-family="Arial" font-size="10.00"> &#160;TPOT: 0.075ms (vs 0.098ms baseline)</text>
</g>
<!-- attn_tp_0 -->
<g id="node71" class="node">
<title>attn_tp_0</title>
<polygon fill="lightpink" stroke="black" points="1086.3,-2988.43 877.43,-2988.43 823.7,-2884.43 1032.57,-2884.43 1086.3,-2988.43"/>
<text text-anchor="middle" x="955" y="-2950.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="955" y="-2939.43" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="955" y="-2928.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="955" y="-2917.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_0&#45;&gt;d_layer_1 -->
<g id="edge83" class="edge">
<title>attn_tp_0&#45;&gt;d_layer_1</title>
<path fill="none" stroke="black" d="M849.69,-2884.37C838.17,-2880.12 826.46,-2876.35 815,-2873.43 672.83,-2837.22 632.3,-2857.44 486,-2846.43 427.58,-2842.03 275.69,-2854.03 223,-2828.43 207.48,-2820.89 194.3,-2806.97 184.62,-2794.23"/>
<polygon fill="black" stroke="black" points="187.46,-2792.18 178.79,-2786.1 181.78,-2796.27 187.46,-2792.18"/>
<text text-anchor="middle" x="759.5" y="-2849.03" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_0 -->
<g id="node72" class="node">
<title>ffn_tp_0</title>
<polygon fill="lightpink" stroke="black" points="1346.1,-2999.43 1153.46,-2999.43 1103.9,-2873.43 1296.54,-2873.43 1346.1,-2999.43"/>
<text text-anchor="middle" x="1225" y="-2955.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="1225" y="-2944.93" font-family="Arial" font-size="10.00">GPU 0</text>
<text text-anchor="middle" x="1225" y="-2933.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="1225" y="-2922.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="1225" y="-2911.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_0&#45;&gt;d_layer_1 -->
<g id="edge84" class="edge">
<title>ffn_tp_0&#45;&gt;d_layer_1</title>
<path fill="none" stroke="black" d="M1104.81,-2876.34C1101.53,-2875.3 1098.25,-2874.32 1095,-2873.43 968.91,-2838.74 932.53,-2854.46 802,-2846.43 737.76,-2842.47 281.41,-2855.47 223,-2828.43 207.24,-2821.13 193.97,-2807.09 184.31,-2794.21"/>
<polygon fill="black" stroke="black" points="187.13,-2792.14 178.49,-2786 181.41,-2796.19 187.13,-2792.14"/>
<text text-anchor="middle" x="1042.5" y="-2849.03" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_1 -->
<g id="node73" class="node">
<title>attn_tp_1</title>
<polygon fill="lightpink" stroke="black" points="1176.3,-2817.43 967.43,-2817.43 913.7,-2713.43 1122.57,-2713.43 1176.3,-2817.43"/>
<text text-anchor="middle" x="1045" y="-2779.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="1045" y="-2768.43" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="1045" y="-2757.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="1045" y="-2746.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_1&#45;&gt;d_layer_2 -->
<g id="edge85" class="edge">
<title>attn_tp_1&#45;&gt;d_layer_2</title>
<path fill="none" stroke="black" d="M937.99,-2713.37C927,-2709.24 915.88,-2705.49 905,-2702.43 787.61,-2669.4 754.17,-2680.15 633,-2666.43 590.64,-2661.63 480.1,-2667.55 442,-2648.43 426.73,-2640.76 413.65,-2627.02 403.98,-2614.42"/>
<polygon fill="black" stroke="black" points="406.56,-2612.01 397.85,-2605.97 400.89,-2616.12 406.56,-2612.01"/>
<text text-anchor="middle" x="865.5" y="-2673.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_1 -->
<g id="node74" class="node">
<title>ffn_tp_1</title>
<polygon fill="lightpink" stroke="black" points="896.1,-2828.43 703.46,-2828.43 653.9,-2702.43 846.54,-2702.43 896.1,-2828.43"/>
<text text-anchor="middle" x="775" y="-2784.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="775" y="-2773.93" font-family="Arial" font-size="10.00">GPU 1</text>
<text text-anchor="middle" x="775" y="-2762.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="775" y="-2751.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="775" y="-2740.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_1&#45;&gt;d_layer_2 -->
<g id="edge86" class="edge">
<title>ffn_tp_1&#45;&gt;d_layer_2</title>
<path fill="none" stroke="black" d="M655.29,-2706.34C651.84,-2704.99 648.4,-2703.68 645,-2702.43 557.38,-2670.19 521.68,-2697.07 442,-2648.43 427.72,-2639.71 414.93,-2626.25 405.2,-2614.1"/>
<polygon fill="black" stroke="black" points="407.83,-2611.78 398.97,-2605.98 402.27,-2616.04 407.83,-2611.78"/>
<text text-anchor="middle" x="597.5" y="-2673.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_2 -->
<g id="node75" class="node">
<title>attn_tp_2</title>
<polygon fill="lightpink" stroke="black" points="1395.3,-2637.43 1186.43,-2637.43 1132.7,-2533.43 1341.57,-2533.43 1395.3,-2637.43"/>
<text text-anchor="middle" x="1264" y="-2599.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="1264" y="-2588.43" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="1264" y="-2577.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="1264" y="-2566.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_2&#45;&gt;d_layer_3 -->
<g id="edge87" class="edge">
<title>attn_tp_2&#45;&gt;d_layer_3</title>
<path fill="none" stroke="black" d="M1156.99,-2533.37C1146,-2529.24 1134.88,-2525.49 1124,-2522.43 1006.61,-2489.4 973.17,-2500.15 852,-2486.43 809.64,-2481.63 699.1,-2487.55 661,-2468.43 645.73,-2460.76 632.65,-2447.02 622.98,-2434.42"/>
<polygon fill="black" stroke="black" points="625.56,-2432.01 616.85,-2425.97 619.89,-2436.12 625.56,-2432.01"/>
<text text-anchor="middle" x="1084.5" y="-2493.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_2 -->
<g id="node76" class="node">
<title>ffn_tp_2</title>
<polygon fill="lightpink" stroke="black" points="1115.1,-2648.43 922.46,-2648.43 872.9,-2522.43 1065.54,-2522.43 1115.1,-2648.43"/>
<text text-anchor="middle" x="994" y="-2604.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="994" y="-2593.93" font-family="Arial" font-size="10.00">GPU 2</text>
<text text-anchor="middle" x="994" y="-2582.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="994" y="-2571.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="994" y="-2560.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_2&#45;&gt;d_layer_3 -->
<g id="edge88" class="edge">
<title>ffn_tp_2&#45;&gt;d_layer_3</title>
<path fill="none" stroke="black" d="M874.29,-2526.34C870.84,-2524.99 867.4,-2523.68 864,-2522.43 776.38,-2490.19 740.68,-2517.07 661,-2468.43 646.72,-2459.71 633.93,-2446.25 624.2,-2434.1"/>
<polygon fill="black" stroke="black" points="626.83,-2431.78 617.97,-2425.98 621.27,-2436.04 626.83,-2431.78"/>
<text text-anchor="middle" x="816.5" y="-2493.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_3 -->
<g id="node77" class="node">
<title>attn_tp_3</title>
<polygon fill="lightpink" stroke="black" points="1614.3,-2457.43 1405.43,-2457.43 1351.7,-2353.43 1560.57,-2353.43 1614.3,-2457.43"/>
<text text-anchor="middle" x="1483" y="-2419.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="1483" y="-2408.43" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1483" y="-2397.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="1483" y="-2386.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_3&#45;&gt;d_layer_4 -->
<g id="edge89" class="edge">
<title>attn_tp_3&#45;&gt;d_layer_4</title>
<path fill="none" stroke="black" d="M1375.99,-2353.37C1365,-2349.24 1353.88,-2345.49 1343,-2342.43 1225.61,-2309.4 1192.17,-2320.15 1071,-2306.43 1028.64,-2301.63 918.1,-2307.55 880,-2288.43 864.73,-2280.76 851.65,-2267.02 841.98,-2254.42"/>
<polygon fill="black" stroke="black" points="844.56,-2252.01 835.85,-2245.97 838.89,-2256.12 844.56,-2252.01"/>
<text text-anchor="middle" x="1303.5" y="-2313.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_3 -->
<g id="node78" class="node">
<title>ffn_tp_3</title>
<polygon fill="lightpink" stroke="black" points="1334.1,-2468.43 1141.46,-2468.43 1091.9,-2342.43 1284.54,-2342.43 1334.1,-2468.43"/>
<text text-anchor="middle" x="1213" y="-2424.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="1213" y="-2413.93" font-family="Arial" font-size="10.00">GPU 3</text>
<text text-anchor="middle" x="1213" y="-2402.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="1213" y="-2391.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="1213" y="-2380.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_3&#45;&gt;d_layer_4 -->
<g id="edge90" class="edge">
<title>ffn_tp_3&#45;&gt;d_layer_4</title>
<path fill="none" stroke="black" d="M1093.29,-2346.34C1089.84,-2344.99 1086.4,-2343.68 1083,-2342.43 995.38,-2310.19 959.68,-2337.07 880,-2288.43 865.72,-2279.71 852.93,-2266.25 843.2,-2254.1"/>
<polygon fill="black" stroke="black" points="845.83,-2251.78 836.97,-2245.98 840.27,-2256.04 845.83,-2251.78"/>
<text text-anchor="middle" x="1035.5" y="-2313.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_4 -->
<g id="node79" class="node">
<title>attn_tp_4</title>
<polygon fill="lightpink" stroke="black" points="1833.3,-2277.43 1624.43,-2277.43 1570.7,-2173.43 1779.57,-2173.43 1833.3,-2277.43"/>
<text text-anchor="middle" x="1702" y="-2239.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="1702" y="-2228.43" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1702" y="-2217.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="1702" y="-2206.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_4&#45;&gt;d_layer_5 -->
<g id="edge91" class="edge">
<title>attn_tp_4&#45;&gt;d_layer_5</title>
<path fill="none" stroke="black" d="M1594.99,-2173.37C1584,-2169.24 1572.88,-2165.49 1562,-2162.43 1444.61,-2129.4 1411.17,-2140.15 1290,-2126.43 1247.64,-2121.63 1137.1,-2127.55 1099,-2108.43 1083.73,-2100.76 1070.65,-2087.02 1060.98,-2074.42"/>
<polygon fill="black" stroke="black" points="1063.56,-2072.01 1054.85,-2065.97 1057.89,-2076.12 1063.56,-2072.01"/>
<text text-anchor="middle" x="1522.5" y="-2133.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_4 -->
<g id="node80" class="node">
<title>ffn_tp_4</title>
<polygon fill="lightpink" stroke="black" points="1553.1,-2288.43 1360.46,-2288.43 1310.9,-2162.43 1503.54,-2162.43 1553.1,-2288.43"/>
<text text-anchor="middle" x="1432" y="-2244.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="1432" y="-2233.93" font-family="Arial" font-size="10.00">GPU 4</text>
<text text-anchor="middle" x="1432" y="-2222.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="1432" y="-2211.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="1432" y="-2200.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_4&#45;&gt;d_layer_5 -->
<g id="edge92" class="edge">
<title>ffn_tp_4&#45;&gt;d_layer_5</title>
<path fill="none" stroke="black" d="M1312.29,-2166.34C1308.84,-2164.99 1305.4,-2163.68 1302,-2162.43 1214.38,-2130.19 1178.68,-2157.07 1099,-2108.43 1084.72,-2099.71 1071.93,-2086.25 1062.2,-2074.1"/>
<polygon fill="black" stroke="black" points="1064.83,-2071.78 1055.97,-2065.98 1059.27,-2076.04 1064.83,-2071.78"/>
<text text-anchor="middle" x="1254.5" y="-2133.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_5 -->
<g id="node81" class="node">
<title>attn_tp_5</title>
<polygon fill="lightpink" stroke="black" points="2052.3,-2097.43 1843.43,-2097.43 1789.7,-1993.43 1998.57,-1993.43 2052.3,-2097.43"/>
<text text-anchor="middle" x="1921" y="-2059.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="1921" y="-2048.43" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1921" y="-2037.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="1921" y="-2026.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_5&#45;&gt;d_layer_6 -->
<g id="edge93" class="edge">
<title>attn_tp_5&#45;&gt;d_layer_6</title>
<path fill="none" stroke="black" d="M1813.99,-1993.37C1803,-1989.24 1791.88,-1985.49 1781,-1982.43 1663.61,-1949.4 1630.17,-1960.15 1509,-1946.43 1466.64,-1941.63 1356.1,-1947.55 1318,-1928.43 1302.73,-1920.76 1289.65,-1907.02 1279.98,-1894.42"/>
<polygon fill="black" stroke="black" points="1282.56,-1892.01 1273.85,-1885.97 1276.89,-1896.12 1282.56,-1892.01"/>
<text text-anchor="middle" x="1741.5" y="-1953.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_5 -->
<g id="node82" class="node">
<title>ffn_tp_5</title>
<polygon fill="lightpink" stroke="black" points="1772.1,-2108.43 1579.46,-2108.43 1529.9,-1982.43 1722.54,-1982.43 1772.1,-2108.43"/>
<text text-anchor="middle" x="1651" y="-2064.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="1651" y="-2053.93" font-family="Arial" font-size="10.00">GPU 5</text>
<text text-anchor="middle" x="1651" y="-2042.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="1651" y="-2031.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="1651" y="-2020.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_5&#45;&gt;d_layer_6 -->
<g id="edge94" class="edge">
<title>ffn_tp_5&#45;&gt;d_layer_6</title>
<path fill="none" stroke="black" d="M1531.29,-1986.34C1527.84,-1984.99 1524.4,-1983.68 1521,-1982.43 1433.38,-1950.19 1397.68,-1977.07 1318,-1928.43 1303.72,-1919.71 1290.93,-1906.25 1281.2,-1894.1"/>
<polygon fill="black" stroke="black" points="1283.83,-1891.78 1274.97,-1885.98 1278.27,-1896.04 1283.83,-1891.78"/>
<text text-anchor="middle" x="1473.5" y="-1953.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_6 -->
<g id="node83" class="node">
<title>attn_tp_6</title>
<polygon fill="lightpink" stroke="black" points="2271.3,-1917.43 2062.43,-1917.43 2008.7,-1813.43 2217.57,-1813.43 2271.3,-1917.43"/>
<text text-anchor="middle" x="2140" y="-1879.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="2140" y="-1868.43" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="2140" y="-1857.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="2140" y="-1846.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_6&#45;&gt;d_layer_7 -->
<g id="edge95" class="edge">
<title>attn_tp_6&#45;&gt;d_layer_7</title>
<path fill="none" stroke="black" d="M2032.99,-1813.37C2022,-1809.24 2010.88,-1805.49 2000,-1802.43 1882.61,-1769.4 1849.17,-1780.15 1728,-1766.43 1685.64,-1761.63 1575.1,-1767.55 1537,-1748.43 1521.73,-1740.76 1508.65,-1727.02 1498.98,-1714.42"/>
<polygon fill="black" stroke="black" points="1501.56,-1712.01 1492.85,-1705.97 1495.89,-1716.12 1501.56,-1712.01"/>
<text text-anchor="middle" x="1960.5" y="-1773.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_6 -->
<g id="node84" class="node">
<title>ffn_tp_6</title>
<polygon fill="lightpink" stroke="black" points="1991.1,-1928.43 1798.46,-1928.43 1748.9,-1802.43 1941.54,-1802.43 1991.1,-1928.43"/>
<text text-anchor="middle" x="1870" y="-1884.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="1870" y="-1873.93" font-family="Arial" font-size="10.00">GPU 6</text>
<text text-anchor="middle" x="1870" y="-1862.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="1870" y="-1851.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="1870" y="-1840.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_6&#45;&gt;d_layer_7 -->
<g id="edge96" class="edge">
<title>ffn_tp_6&#45;&gt;d_layer_7</title>
<path fill="none" stroke="black" d="M1750.29,-1806.34C1746.84,-1804.99 1743.4,-1803.68 1740,-1802.43 1652.38,-1770.19 1616.68,-1797.07 1537,-1748.43 1522.72,-1739.71 1509.93,-1726.25 1500.2,-1714.1"/>
<polygon fill="black" stroke="black" points="1502.83,-1711.78 1493.97,-1705.98 1497.27,-1716.04 1502.83,-1711.78"/>
<text text-anchor="middle" x="1692.5" y="-1773.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_7 -->
<g id="node85" class="node">
<title>attn_tp_7</title>
<polygon fill="lightpink" stroke="black" points="2490.3,-1737.43 2281.43,-1737.43 2227.7,-1633.43 2436.57,-1633.43 2490.3,-1737.43"/>
<text text-anchor="middle" x="2359" y="-1699.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="2359" y="-1688.43" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2359" y="-1677.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="2359" y="-1666.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_7&#45;&gt;d_layer_8 -->
<g id="edge97" class="edge">
<title>attn_tp_7&#45;&gt;d_layer_8</title>
<path fill="none" stroke="black" d="M2251.99,-1633.37C2241,-1629.24 2229.88,-1625.49 2219,-1622.43 2101.61,-1589.4 2068.17,-1600.15 1947,-1586.43 1904.64,-1581.63 1794.1,-1587.55 1756,-1568.43 1740.73,-1560.76 1727.65,-1547.02 1717.98,-1534.42"/>
<polygon fill="black" stroke="black" points="1720.56,-1532.01 1711.85,-1525.97 1714.89,-1536.12 1720.56,-1532.01"/>
<text text-anchor="middle" x="2179.5" y="-1593.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_7 -->
<g id="node86" class="node">
<title>ffn_tp_7</title>
<polygon fill="lightpink" stroke="black" points="2210.1,-1748.43 2017.46,-1748.43 1967.9,-1622.43 2160.54,-1622.43 2210.1,-1748.43"/>
<text text-anchor="middle" x="2089" y="-1704.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="2089" y="-1693.93" font-family="Arial" font-size="10.00">GPU 7</text>
<text text-anchor="middle" x="2089" y="-1682.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="2089" y="-1671.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="2089" y="-1660.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_7&#45;&gt;d_layer_8 -->
<g id="edge98" class="edge">
<title>ffn_tp_7&#45;&gt;d_layer_8</title>
<path fill="none" stroke="black" d="M1969.29,-1626.34C1965.84,-1624.99 1962.4,-1623.68 1959,-1622.43 1871.38,-1590.19 1835.68,-1617.07 1756,-1568.43 1741.72,-1559.71 1728.93,-1546.25 1719.2,-1534.1"/>
<polygon fill="black" stroke="black" points="1721.83,-1531.78 1712.97,-1525.98 1716.27,-1536.04 1721.83,-1531.78"/>
<text text-anchor="middle" x="1911.5" y="-1593.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_8 -->
<g id="node87" class="node">
<title>attn_tp_8</title>
<polygon fill="lightpink" stroke="black" points="2709.3,-1557.43 2500.43,-1557.43 2446.7,-1453.43 2655.57,-1453.43 2709.3,-1557.43"/>
<text text-anchor="middle" x="2578" y="-1519.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="2578" y="-1508.43" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2578" y="-1497.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="2578" y="-1486.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_8&#45;&gt;d_layer_9 -->
<g id="edge99" class="edge">
<title>attn_tp_8&#45;&gt;d_layer_9</title>
<path fill="none" stroke="black" d="M2470.99,-1453.37C2460,-1449.24 2448.88,-1445.49 2438,-1442.43 2320.61,-1409.4 2287.17,-1420.15 2166,-1406.43 2123.64,-1401.63 2013.1,-1407.55 1975,-1388.43 1959.73,-1380.76 1946.65,-1367.02 1936.98,-1354.42"/>
<polygon fill="black" stroke="black" points="1939.56,-1352.01 1930.85,-1345.97 1933.89,-1356.12 1939.56,-1352.01"/>
<text text-anchor="middle" x="2398.5" y="-1413.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_8 -->
<g id="node88" class="node">
<title>ffn_tp_8</title>
<polygon fill="lightpink" stroke="black" points="2429.1,-1568.43 2236.46,-1568.43 2186.9,-1442.43 2379.54,-1442.43 2429.1,-1568.43"/>
<text text-anchor="middle" x="2308" y="-1524.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="2308" y="-1513.93" font-family="Arial" font-size="10.00">GPU 8</text>
<text text-anchor="middle" x="2308" y="-1502.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="2308" y="-1491.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="2308" y="-1480.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_8&#45;&gt;d_layer_9 -->
<g id="edge100" class="edge">
<title>ffn_tp_8&#45;&gt;d_layer_9</title>
<path fill="none" stroke="black" d="M2188.29,-1446.34C2184.84,-1444.99 2181.4,-1443.68 2178,-1442.43 2090.38,-1410.19 2054.68,-1437.07 1975,-1388.43 1960.72,-1379.71 1947.93,-1366.25 1938.2,-1354.1"/>
<polygon fill="black" stroke="black" points="1940.83,-1351.78 1931.97,-1345.98 1935.27,-1356.04 1940.83,-1351.78"/>
<text text-anchor="middle" x="2130.5" y="-1413.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_9 -->
<g id="node89" class="node">
<title>attn_tp_9</title>
<polygon fill="lightpink" stroke="black" points="2928.3,-1377.43 2719.43,-1377.43 2665.7,-1273.43 2874.57,-1273.43 2928.3,-1377.43"/>
<text text-anchor="middle" x="2797" y="-1339.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="2797" y="-1328.43" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2797" y="-1317.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="2797" y="-1306.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_9&#45;&gt;d_layer_10 -->
<g id="edge101" class="edge">
<title>attn_tp_9&#45;&gt;d_layer_10</title>
<path fill="none" stroke="black" d="M2689.99,-1273.37C2679,-1269.24 2667.88,-1265.49 2657,-1262.43 2539.61,-1229.4 2506.17,-1240.15 2385,-1226.43 2342.64,-1221.63 2232.1,-1227.55 2194,-1208.43 2178.73,-1200.76 2165.65,-1187.02 2155.98,-1174.42"/>
<polygon fill="black" stroke="black" points="2158.56,-1172.01 2149.85,-1165.97 2152.89,-1176.12 2158.56,-1172.01"/>
<text text-anchor="middle" x="2617.5" y="-1233.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_9 -->
<g id="node90" class="node">
<title>ffn_tp_9</title>
<polygon fill="lightpink" stroke="black" points="2648.1,-1388.43 2455.46,-1388.43 2405.9,-1262.43 2598.54,-1262.43 2648.1,-1388.43"/>
<text text-anchor="middle" x="2527" y="-1344.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="2527" y="-1333.93" font-family="Arial" font-size="10.00">GPU 9</text>
<text text-anchor="middle" x="2527" y="-1322.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="2527" y="-1311.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="2527" y="-1300.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_9&#45;&gt;d_layer_10 -->
<g id="edge102" class="edge">
<title>ffn_tp_9&#45;&gt;d_layer_10</title>
<path fill="none" stroke="black" d="M2407.29,-1266.34C2403.84,-1264.99 2400.4,-1263.68 2397,-1262.43 2309.38,-1230.19 2273.68,-1257.07 2194,-1208.43 2179.72,-1199.71 2166.93,-1186.25 2157.2,-1174.1"/>
<polygon fill="black" stroke="black" points="2159.83,-1171.78 2150.97,-1165.98 2154.27,-1176.04 2159.83,-1171.78"/>
<text text-anchor="middle" x="2349.5" y="-1233.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_10 -->
<g id="node91" class="node">
<title>attn_tp_10</title>
<polygon fill="lightpink" stroke="black" points="3147.3,-1197.43 2938.43,-1197.43 2884.7,-1093.43 3093.57,-1093.43 3147.3,-1197.43"/>
<text text-anchor="middle" x="3016" y="-1159.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="3016" y="-1148.43" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="3016" y="-1137.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="3016" y="-1126.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_10&#45;&gt;d_layer_11 -->
<g id="edge103" class="edge">
<title>attn_tp_10&#45;&gt;d_layer_11</title>
<path fill="none" stroke="black" d="M2908.99,-1093.37C2898,-1089.24 2886.88,-1085.49 2876,-1082.43 2758.61,-1049.4 2725.17,-1060.15 2604,-1046.43 2561.64,-1041.63 2451.1,-1047.55 2413,-1028.43 2397.73,-1020.76 2384.65,-1007.02 2374.98,-994.42"/>
<polygon fill="black" stroke="black" points="2377.56,-992.01 2368.85,-985.97 2371.89,-996.12 2377.56,-992.01"/>
<text text-anchor="middle" x="2836.5" y="-1053.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_10 -->
<g id="node92" class="node">
<title>ffn_tp_10</title>
<polygon fill="lightpink" stroke="black" points="2867.1,-1208.43 2674.46,-1208.43 2624.9,-1082.43 2817.54,-1082.43 2867.1,-1208.43"/>
<text text-anchor="middle" x="2746" y="-1164.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="2746" y="-1153.93" font-family="Arial" font-size="10.00">GPU 10</text>
<text text-anchor="middle" x="2746" y="-1142.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="2746" y="-1131.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="2746" y="-1120.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_10&#45;&gt;d_layer_11 -->
<g id="edge104" class="edge">
<title>ffn_tp_10&#45;&gt;d_layer_11</title>
<path fill="none" stroke="black" d="M2626.29,-1086.34C2622.84,-1084.99 2619.4,-1083.68 2616,-1082.43 2528.38,-1050.19 2492.68,-1077.07 2413,-1028.43 2398.72,-1019.71 2385.93,-1006.25 2376.2,-994.1"/>
<polygon fill="black" stroke="black" points="2378.83,-991.78 2369.97,-985.98 2373.27,-996.04 2378.83,-991.78"/>
<text text-anchor="middle" x="2568.5" y="-1053.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_11 -->
<g id="node93" class="node">
<title>attn_tp_11</title>
<polygon fill="lightpink" stroke="black" points="3366.3,-1017.43 3157.43,-1017.43 3103.7,-913.43 3312.57,-913.43 3366.3,-1017.43"/>
<text text-anchor="middle" x="3235" y="-979.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="3235" y="-968.43" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="3235" y="-957.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="3235" y="-946.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_11&#45;&gt;d_layer_12 -->
<g id="edge105" class="edge">
<title>attn_tp_11&#45;&gt;d_layer_12</title>
<path fill="none" stroke="black" d="M3127.99,-913.37C3117,-909.24 3105.88,-905.49 3095,-902.43 2977.61,-869.4 2944.17,-880.15 2823,-866.43 2780.64,-861.63 2670.1,-867.55 2632,-848.43 2616.73,-840.76 2603.65,-827.02 2593.98,-814.42"/>
<polygon fill="black" stroke="black" points="2596.56,-812.01 2587.85,-805.97 2590.89,-816.12 2596.56,-812.01"/>
<text text-anchor="middle" x="3055.5" y="-873.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_11 -->
<g id="node94" class="node">
<title>ffn_tp_11</title>
<polygon fill="lightpink" stroke="black" points="3086.1,-1028.43 2893.46,-1028.43 2843.9,-902.43 3036.54,-902.43 3086.1,-1028.43"/>
<text text-anchor="middle" x="2965" y="-984.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="2965" y="-973.93" font-family="Arial" font-size="10.00">GPU 11</text>
<text text-anchor="middle" x="2965" y="-962.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="2965" y="-951.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="2965" y="-940.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_11&#45;&gt;d_layer_12 -->
<g id="edge106" class="edge">
<title>ffn_tp_11&#45;&gt;d_layer_12</title>
<path fill="none" stroke="black" d="M2845.29,-906.34C2841.84,-904.99 2838.4,-903.68 2835,-902.43 2747.38,-870.19 2711.68,-897.07 2632,-848.43 2617.72,-839.71 2604.93,-826.25 2595.2,-814.1"/>
<polygon fill="black" stroke="black" points="2597.83,-811.78 2588.97,-805.98 2592.27,-816.04 2597.83,-811.78"/>
<text text-anchor="middle" x="2787.5" y="-873.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_12 -->
<g id="node95" class="node">
<title>attn_tp_12</title>
<polygon fill="lightpink" stroke="black" points="3585.3,-837.43 3376.43,-837.43 3322.7,-733.43 3531.57,-733.43 3585.3,-837.43"/>
<text text-anchor="middle" x="3454" y="-799.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="3454" y="-788.43" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3454" y="-777.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="3454" y="-766.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_12&#45;&gt;d_layer_13 -->
<g id="edge107" class="edge">
<title>attn_tp_12&#45;&gt;d_layer_13</title>
<path fill="none" stroke="black" d="M3346.99,-733.37C3336,-729.24 3324.88,-725.49 3314,-722.43 3196.61,-689.4 3163.17,-700.15 3042,-686.43 2999.64,-681.63 2889.1,-687.55 2851,-668.43 2835.73,-660.76 2822.65,-647.02 2812.98,-634.42"/>
<polygon fill="black" stroke="black" points="2815.56,-632.01 2806.85,-625.97 2809.89,-636.12 2815.56,-632.01"/>
<text text-anchor="middle" x="3274.5" y="-693.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_12 -->
<g id="node96" class="node">
<title>ffn_tp_12</title>
<polygon fill="lightpink" stroke="black" points="3305.1,-848.43 3112.46,-848.43 3062.9,-722.43 3255.54,-722.43 3305.1,-848.43"/>
<text text-anchor="middle" x="3184" y="-804.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="3184" y="-793.93" font-family="Arial" font-size="10.00">GPU 12</text>
<text text-anchor="middle" x="3184" y="-782.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="3184" y="-771.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="3184" y="-760.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_12&#45;&gt;d_layer_13 -->
<g id="edge108" class="edge">
<title>ffn_tp_12&#45;&gt;d_layer_13</title>
<path fill="none" stroke="black" d="M3064.29,-726.34C3060.84,-724.99 3057.4,-723.68 3054,-722.43 2966.38,-690.19 2930.68,-717.07 2851,-668.43 2836.72,-659.71 2823.93,-646.25 2814.2,-634.1"/>
<polygon fill="black" stroke="black" points="2816.83,-631.78 2807.97,-625.98 2811.27,-636.04 2816.83,-631.78"/>
<text text-anchor="middle" x="3006.5" y="-693.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_13 -->
<g id="node97" class="node">
<title>attn_tp_13</title>
<polygon fill="lightpink" stroke="black" points="3804.3,-657.43 3595.43,-657.43 3541.7,-553.43 3750.57,-553.43 3804.3,-657.43"/>
<text text-anchor="middle" x="3673" y="-619.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="3673" y="-608.43" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3673" y="-597.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="3673" y="-586.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_13&#45;&gt;d_layer_14 -->
<g id="edge109" class="edge">
<title>attn_tp_13&#45;&gt;d_layer_14</title>
<path fill="none" stroke="black" d="M3565.99,-553.37C3555,-549.24 3543.88,-545.49 3533,-542.43 3415.61,-509.4 3382.17,-520.15 3261,-506.43 3218.64,-501.63 3108.1,-507.55 3070,-488.43 3054.73,-480.76 3041.65,-467.02 3031.98,-454.42"/>
<polygon fill="black" stroke="black" points="3034.56,-452.01 3025.85,-445.97 3028.89,-456.12 3034.56,-452.01"/>
<text text-anchor="middle" x="3493.5" y="-513.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_13 -->
<g id="node98" class="node">
<title>ffn_tp_13</title>
<polygon fill="lightpink" stroke="black" points="3524.1,-668.43 3331.46,-668.43 3281.9,-542.43 3474.54,-542.43 3524.1,-668.43"/>
<text text-anchor="middle" x="3403" y="-624.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="3403" y="-613.93" font-family="Arial" font-size="10.00">GPU 13</text>
<text text-anchor="middle" x="3403" y="-602.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="3403" y="-591.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="3403" y="-580.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_13&#45;&gt;d_layer_14 -->
<g id="edge110" class="edge">
<title>ffn_tp_13&#45;&gt;d_layer_14</title>
<path fill="none" stroke="black" d="M3283.29,-546.34C3279.84,-544.99 3276.4,-543.68 3273,-542.43 3185.38,-510.19 3149.68,-537.07 3070,-488.43 3055.72,-479.71 3042.93,-466.25 3033.2,-454.1"/>
<polygon fill="black" stroke="black" points="3035.83,-451.78 3026.97,-445.98 3030.27,-456.04 3035.83,-451.78"/>
<text text-anchor="middle" x="3225.5" y="-513.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_14 -->
<g id="node99" class="node">
<title>attn_tp_14</title>
<polygon fill="lightpink" stroke="black" points="4023.3,-477.43 3814.43,-477.43 3760.7,-373.43 3969.57,-373.43 4023.3,-477.43"/>
<text text-anchor="middle" x="3892" y="-439.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="3892" y="-428.43" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3892" y="-417.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="3892" y="-406.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_14&#45;&gt;d_layer_15 -->
<g id="edge111" class="edge">
<title>attn_tp_14&#45;&gt;d_layer_15</title>
<path fill="none" stroke="black" d="M3784.99,-373.37C3774,-369.24 3762.88,-365.49 3752,-362.43 3634.61,-329.4 3601.17,-340.15 3480,-326.43 3437.64,-321.63 3327.1,-327.55 3289,-308.43 3273.73,-300.76 3260.65,-287.02 3250.98,-274.42"/>
<polygon fill="black" stroke="black" points="3253.56,-272.01 3244.85,-265.97 3247.89,-276.12 3253.56,-272.01"/>
<text text-anchor="middle" x="3712.5" y="-333.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_14 -->
<g id="node100" class="node">
<title>ffn_tp_14</title>
<polygon fill="lightpink" stroke="black" points="3743.1,-488.43 3550.46,-488.43 3500.9,-362.43 3693.54,-362.43 3743.1,-488.43"/>
<text text-anchor="middle" x="3622" y="-444.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="3622" y="-433.93" font-family="Arial" font-size="10.00">GPU 14</text>
<text text-anchor="middle" x="3622" y="-422.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="3622" y="-411.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="3622" y="-400.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_14&#45;&gt;d_layer_15 -->
<g id="edge112" class="edge">
<title>ffn_tp_14&#45;&gt;d_layer_15</title>
<path fill="none" stroke="black" d="M3502.29,-366.34C3498.84,-364.99 3495.4,-363.68 3492,-362.43 3404.38,-330.19 3368.68,-357.07 3289,-308.43 3274.72,-299.71 3261.93,-286.25 3252.2,-274.1"/>
<polygon fill="black" stroke="black" points="3254.83,-271.78 3245.97,-265.98 3249.27,-276.04 3254.83,-271.78"/>
<text text-anchor="middle" x="3444.5" y="-333.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- attn_tp_15 -->
<g id="node101" class="node">
<title>attn_tp_15</title>
<polygon fill="lightpink" stroke="black" points="4242.3,-297.43 4033.43,-297.43 3979.7,-193.43 4188.57,-193.43 4242.3,-297.43"/>
<text text-anchor="middle" x="4111" y="-259.43" font-family="Arial" font-size="10.00">Attention Tensor Parallel</text>
<text text-anchor="middle" x="4111" y="-248.43" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="4111" y="-237.43" font-family="Arial" font-size="10.00">QKV: Column Parallel</text>
<text text-anchor="middle" x="4111" y="-226.43" font-family="Arial" font-size="10.00">Output: Row Parallel</text>
</g>
<!-- attn_tp_15&#45;&gt;d_layer_16 -->
<g id="edge113" class="edge">
<title>attn_tp_15&#45;&gt;d_layer_16</title>
<path fill="none" stroke="black" d="M4003.56,-193.36C3992.71,-189.26 3981.73,-185.51 3971,-182.43 3806.04,-134.95 3602.4,-117.53 3506.64,-111.65"/>
<polygon fill="black" stroke="black" points="3506.8,-108.16 3496.61,-111.06 3506.39,-115.14 3506.8,-108.16"/>
<text text-anchor="middle" x="3925.5" y="-153.53" font-family="Arial" font-size="8.00">attention computation</text>
</g>
<!-- ffn_tp_15 -->
<g id="node102" class="node">
<title>ffn_tp_15</title>
<polygon fill="lightpink" stroke="black" points="3962.1,-308.43 3769.46,-308.43 3719.9,-182.43 3912.54,-182.43 3962.1,-308.43"/>
<text text-anchor="middle" x="3841" y="-264.93" font-family="Arial" font-size="10.00">FFN Tensor Parallel</text>
<text text-anchor="middle" x="3841" y="-253.93" font-family="Arial" font-size="10.00">GPU 15</text>
<text text-anchor="middle" x="3841" y="-242.93" font-family="Arial" font-size="10.00">Gate: Column Parallel</text>
<text text-anchor="middle" x="3841" y="-231.93" font-family="Arial" font-size="10.00">Up: Column Parallel</text>
<text text-anchor="middle" x="3841" y="-220.93" font-family="Arial" font-size="10.00">Down: Row Parallel</text>
</g>
<!-- ffn_tp_15&#45;&gt;d_layer_16 -->
<g id="edge114" class="edge">
<title>ffn_tp_15&#45;&gt;d_layer_16</title>
<path fill="none" stroke="black" d="M3721.26,-186.42C3717.82,-185.04 3714.39,-183.71 3711,-182.43 3641.98,-156.39 3559.62,-134.52 3506.6,-121.57"/>
<polygon fill="black" stroke="black" points="3507.27,-118.14 3496.73,-119.18 3505.62,-124.94 3507.27,-118.14"/>
<text text-anchor="middle" x="3686.5" y="-153.53" font-family="Arial" font-size="8.00">FFN computation</text>
</g>
<!-- comm_info_0 -->
<g id="node103" class="node">
<title>comm_info_0</title>
<text text-anchor="middle" x="1874" y="-2933.93" font-family="Arial" font-size="10.00">Communication Volume:</text>
</g>
<!-- comm_info_1 -->
<g id="node104" class="node">
<title>comm_info_1</title>
<text text-anchor="middle" x="2058" y="-2933.93" font-family="Arial" font-size="10.00">Dense Model: ~8MB activations per transfer</text>
</g>
<!-- comm_info_2 -->
<g id="node105" class="node">
<title>comm_info_2</title>
<text text-anchor="middle" x="2284" y="-2933.93" font-family="Arial" font-size="10.00">MoE Model: ~10MB activations per transfer</text>
</g>
<!-- comm_info_3 -->
<g id="node106" class="node">
<title>comm_info_3</title>
<text text-anchor="middle" x="2484" y="-2933.93" font-family="Arial" font-size="10.00">Expert All&#45;to&#45;All: ~2MB per GPU</text>
</g>
</g>
</svg>
