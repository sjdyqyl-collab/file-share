<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="123pt" height="1800pt"
 viewBox="0.00 0.00 122.61 1800.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.05 0.05) rotate(0) translate(4 35971.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-35971.91 2446.5,-35971.91 2446.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<path fill="lightblue" stroke="blue" d="M33,-33759.3C33,-33759.3 2065,-33759.3 2065,-33759.3 2071,-33759.3 2077,-33765.3 2077,-33771.3 2077,-33771.3 2077,-35947.91 2077,-35947.91 2077,-35953.91 2071,-35959.91 2065,-35959.91 2065,-35959.91 33,-35959.91 33,-35959.91 27,-35959.91 21,-35953.91 21,-35947.91 21,-35947.91 21,-33771.3 21,-33771.3 21,-33765.3 27,-33759.3 33,-33759.3"/>
<text text-anchor="middle" x="1049" y="-35944.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_mha_0</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="690,-34919.48 690,-35815.44 1416,-35815.44 1416,-34919.48 690,-34919.48"/>
<text text-anchor="middle" x="1053" y="-35800.24" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_moe_0</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="29,-33767.3 29,-34900.48 2069,-34900.48 2069,-33767.3 29,-33767.3"/>
<text text-anchor="middle" x="1049" y="-34885.28" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_expert_0_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="37,-34274.98 37,-34598.93 283,-34598.93 283,-34274.98 37,-34274.98"/>
<text text-anchor="middle" x="160" y="-34583.73" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_expert_0_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="291,-34274.98 291,-34598.93 537,-34598.93 537,-34274.98 291,-34274.98"/>
<text text-anchor="middle" x="414" y="-34583.73" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_expert_0_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="545,-34274.98 545,-34598.93 791,-34598.93 791,-34274.98 545,-34274.98"/>
<text text-anchor="middle" x="668" y="-34583.73" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_expert_0_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="799,-34274.98 799,-34598.93 1045,-34598.93 1045,-34274.98 799,-34274.98"/>
<text text-anchor="middle" x="922" y="-34583.73" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_expert_0_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1053,-34274.98 1053,-34598.93 1299,-34598.93 1299,-34274.98 1053,-34274.98"/>
<text text-anchor="middle" x="1176" y="-34583.73" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_expert_0_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1307,-34274.98 1307,-34598.93 1553,-34598.93 1553,-34274.98 1307,-34274.98"/>
<text text-anchor="middle" x="1430" y="-34583.73" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_expert_0_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1561,-34274.98 1561,-34598.93 1807,-34598.93 1807,-34274.98 1561,-34274.98"/>
<text text-anchor="middle" x="1684" y="-34583.73" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_expert_0_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1815,-34274.98 1815,-34598.93 2061,-34598.93 2061,-34274.98 1815,-34274.98"/>
<text text-anchor="middle" x="1938" y="-34583.73" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_1</title>
<path fill="lightblue" stroke="blue" d="M33,-31509.22C33,-31509.22 2065,-31509.22 2065,-31509.22 2071,-31509.22 2077,-31515.22 2077,-31521.22 2077,-31521.22 2077,-33686.3 2077,-33686.3 2077,-33692.3 2071,-33698.3 2065,-33698.3 2065,-33698.3 33,-33698.3 33,-33698.3 27,-33698.3 21,-33692.3 21,-33686.3 21,-33686.3 21,-31521.22 21,-31521.22 21,-31515.22 27,-31509.22 33,-31509.22"/>
<text text-anchor="middle" x="1049" y="-33683.1" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_mha_1</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="601,-32669.4 601,-33565.35 1327,-33565.35 1327,-32669.4 601,-32669.4"/>
<text text-anchor="middle" x="964" y="-33550.15" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_moe_1</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="29,-31517.22 29,-32650.4 2069,-32650.4 2069,-31517.22 29,-31517.22"/>
<text text-anchor="middle" x="1049" y="-32635.2" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_expert_1_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="37,-32024.89 37,-32348.85 283,-32348.85 283,-32024.89 37,-32024.89"/>
<text text-anchor="middle" x="160" y="-32333.65" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_expert_1_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="291,-32024.89 291,-32348.85 537,-32348.85 537,-32024.89 291,-32024.89"/>
<text text-anchor="middle" x="414" y="-32333.65" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_expert_1_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="545,-32024.89 545,-32348.85 791,-32348.85 791,-32024.89 545,-32024.89"/>
<text text-anchor="middle" x="668" y="-32333.65" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_expert_1_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="799,-32024.89 799,-32348.85 1045,-32348.85 1045,-32024.89 799,-32024.89"/>
<text text-anchor="middle" x="922" y="-32333.65" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_expert_1_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1053,-32024.89 1053,-32348.85 1299,-32348.85 1299,-32024.89 1053,-32024.89"/>
<text text-anchor="middle" x="1176" y="-32333.65" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_expert_1_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1307,-32024.89 1307,-32348.85 1553,-32348.85 1553,-32024.89 1307,-32024.89"/>
<text text-anchor="middle" x="1430" y="-32333.65" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_expert_1_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1561,-32024.89 1561,-32348.85 1807,-32348.85 1807,-32024.89 1561,-32024.89"/>
<text text-anchor="middle" x="1684" y="-32333.65" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_expert_1_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1815,-32024.89 1815,-32348.85 2061,-32348.85 2061,-32024.89 1815,-32024.89"/>
<text text-anchor="middle" x="1938" y="-32333.65" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_gpu_2</title>
<path fill="lightblue" stroke="blue" d="M31,-29259.13C31,-29259.13 2063,-29259.13 2063,-29259.13 2069,-29259.13 2075,-29265.13 2075,-29271.13 2075,-29271.13 2075,-31436.22 2075,-31436.22 2075,-31442.22 2069,-31448.22 2063,-31448.22 2063,-31448.22 31,-31448.22 31,-31448.22 25,-31448.22 19,-31442.22 19,-31436.22 19,-31436.22 19,-29271.13 19,-29271.13 19,-29265.13 25,-29259.13 31,-29259.13"/>
<text text-anchor="middle" x="1047" y="-31433.02" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_mha_2</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="568,-30419.31 568,-31315.26 1294,-31315.26 1294,-30419.31 568,-30419.31"/>
<text text-anchor="middle" x="931" y="-31300.06" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_moe_2</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="27,-29267.13 27,-30400.31 2067,-30400.31 2067,-29267.13 27,-29267.13"/>
<text text-anchor="middle" x="1047" y="-30385.11" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_expert_2_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="35,-29774.81 35,-30098.76 281,-30098.76 281,-29774.81 35,-29774.81"/>
<text text-anchor="middle" x="158" y="-30083.56" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_expert_2_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="289,-29774.81 289,-30098.76 535,-30098.76 535,-29774.81 289,-29774.81"/>
<text text-anchor="middle" x="412" y="-30083.56" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_expert_2_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="543,-29774.81 543,-30098.76 789,-30098.76 789,-29774.81 543,-29774.81"/>
<text text-anchor="middle" x="666" y="-30083.56" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_expert_2_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="797,-29774.81 797,-30098.76 1043,-30098.76 1043,-29774.81 797,-29774.81"/>
<text text-anchor="middle" x="920" y="-30083.56" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_expert_2_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1051,-29774.81 1051,-30098.76 1297,-30098.76 1297,-29774.81 1051,-29774.81"/>
<text text-anchor="middle" x="1174" y="-30083.56" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_expert_2_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1305,-29774.81 1305,-30098.76 1551,-30098.76 1551,-29774.81 1305,-29774.81"/>
<text text-anchor="middle" x="1428" y="-30083.56" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_expert_2_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1559,-29774.81 1559,-30098.76 1805,-30098.76 1805,-29774.81 1559,-29774.81"/>
<text text-anchor="middle" x="1682" y="-30083.56" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_expert_2_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1813,-29774.81 1813,-30098.76 2059,-30098.76 2059,-29774.81 1813,-29774.81"/>
<text text-anchor="middle" x="1936" y="-30083.56" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_gpu_3</title>
<path fill="lightblue" stroke="blue" d="M33,-27009.04C33,-27009.04 2065,-27009.04 2065,-27009.04 2071,-27009.04 2077,-27015.04 2077,-27021.04 2077,-27021.04 2077,-29186.13 2077,-29186.13 2077,-29192.13 2071,-29198.13 2065,-29198.13 2065,-29198.13 33,-29198.13 33,-29198.13 27,-29198.13 21,-29192.13 21,-29186.13 21,-29186.13 21,-27021.04 21,-27021.04 21,-27015.04 27,-27009.04 33,-27009.04"/>
<text text-anchor="middle" x="1049" y="-29182.93" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_mha_3</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="686,-28169.22 686,-29065.18 1412,-29065.18 1412,-28169.22 686,-28169.22"/>
<text text-anchor="middle" x="1049" y="-29049.98" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_moe_3</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="29,-27017.04 29,-28150.22 2069,-28150.22 2069,-27017.04 29,-27017.04"/>
<text text-anchor="middle" x="1049" y="-28135.02" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_expert_3_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="37,-27524.72 37,-27848.67 283,-27848.67 283,-27524.72 37,-27524.72"/>
<text text-anchor="middle" x="160" y="-27833.47" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_expert_3_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="291,-27524.72 291,-27848.67 537,-27848.67 537,-27524.72 291,-27524.72"/>
<text text-anchor="middle" x="414" y="-27833.47" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_expert_3_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="545,-27524.72 545,-27848.67 791,-27848.67 791,-27524.72 545,-27524.72"/>
<text text-anchor="middle" x="668" y="-27833.47" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_expert_3_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="799,-27524.72 799,-27848.67 1045,-27848.67 1045,-27524.72 799,-27524.72"/>
<text text-anchor="middle" x="922" y="-27833.47" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_expert_3_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1053,-27524.72 1053,-27848.67 1299,-27848.67 1299,-27524.72 1053,-27524.72"/>
<text text-anchor="middle" x="1176" y="-27833.47" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_expert_3_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1307,-27524.72 1307,-27848.67 1553,-27848.67 1553,-27524.72 1307,-27524.72"/>
<text text-anchor="middle" x="1430" y="-27833.47" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_expert_3_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1561,-27524.72 1561,-27848.67 1807,-27848.67 1807,-27524.72 1561,-27524.72"/>
<text text-anchor="middle" x="1684" y="-27833.47" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_expert_3_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1815,-27524.72 1815,-27848.67 2061,-27848.67 2061,-27524.72 1815,-27524.72"/>
<text text-anchor="middle" x="1938" y="-27833.47" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_gpu_4</title>
<path fill="lightblue" stroke="blue" d="M27,-24758.96C27,-24758.96 2059,-24758.96 2059,-24758.96 2065,-24758.96 2071,-24764.96 2071,-24770.96 2071,-24770.96 2071,-26936.04 2071,-26936.04 2071,-26942.04 2065,-26948.04 2059,-26948.04 2059,-26948.04 27,-26948.04 27,-26948.04 21,-26948.04 15,-26942.04 15,-26936.04 15,-26936.04 15,-24770.96 15,-24770.96 15,-24764.96 21,-24758.96 27,-24758.96"/>
<text text-anchor="middle" x="1043" y="-26932.84" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_mha_4</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="760,-25919.14 760,-26815.09 1486,-26815.09 1486,-25919.14 760,-25919.14"/>
<text text-anchor="middle" x="1123" y="-26799.89" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_moe_4</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="23,-24766.96 23,-25900.14 2063,-25900.14 2063,-24766.96 23,-24766.96"/>
<text text-anchor="middle" x="1043" y="-25884.94" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_expert_4_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="31,-25274.63 31,-25598.59 277,-25598.59 277,-25274.63 31,-25274.63"/>
<text text-anchor="middle" x="154" y="-25583.39" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_expert_4_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="285,-25274.63 285,-25598.59 531,-25598.59 531,-25274.63 285,-25274.63"/>
<text text-anchor="middle" x="408" y="-25583.39" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_expert_4_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="539,-25274.63 539,-25598.59 785,-25598.59 785,-25274.63 539,-25274.63"/>
<text text-anchor="middle" x="662" y="-25583.39" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_expert_4_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="793,-25274.63 793,-25598.59 1039,-25598.59 1039,-25274.63 793,-25274.63"/>
<text text-anchor="middle" x="916" y="-25583.39" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_expert_4_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1047,-25274.63 1047,-25598.59 1293,-25598.59 1293,-25274.63 1047,-25274.63"/>
<text text-anchor="middle" x="1170" y="-25583.39" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_expert_4_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1301,-25274.63 1301,-25598.59 1547,-25598.59 1547,-25274.63 1301,-25274.63"/>
<text text-anchor="middle" x="1424" y="-25583.39" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_expert_4_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1555,-25274.63 1555,-25598.59 1801,-25598.59 1801,-25274.63 1555,-25274.63"/>
<text text-anchor="middle" x="1678" y="-25583.39" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_expert_4_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1809,-25274.63 1809,-25598.59 2055,-25598.59 2055,-25274.63 1809,-25274.63"/>
<text text-anchor="middle" x="1932" y="-25583.39" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_gpu_5</title>
<path fill="lightblue" stroke="blue" d="M23,-22508.87C23,-22508.87 2055,-22508.87 2055,-22508.87 2061,-22508.87 2067,-22514.87 2067,-22520.87 2067,-22520.87 2067,-24685.96 2067,-24685.96 2067,-24691.96 2061,-24697.96 2055,-24697.96 2055,-24697.96 23,-24697.96 23,-24697.96 17,-24697.96 11,-24691.96 11,-24685.96 11,-24685.96 11,-22520.87 11,-22520.87 11,-22514.87 17,-22508.87 23,-22508.87"/>
<text text-anchor="middle" x="1039" y="-24682.76" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_mha_5</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="611,-23669.05 611,-24565 1337,-24565 1337,-23669.05 611,-23669.05"/>
<text text-anchor="middle" x="974" y="-24549.8" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_moe_5</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="19,-22516.87 19,-23650.05 2059,-23650.05 2059,-22516.87 19,-22516.87"/>
<text text-anchor="middle" x="1039" y="-23634.85" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_expert_5_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="27,-23024.55 27,-23348.5 273,-23348.5 273,-23024.55 27,-23024.55"/>
<text text-anchor="middle" x="150" y="-23333.3" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_expert_5_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="281,-23024.55 281,-23348.5 527,-23348.5 527,-23024.55 281,-23024.55"/>
<text text-anchor="middle" x="404" y="-23333.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_expert_5_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="535,-23024.55 535,-23348.5 781,-23348.5 781,-23024.55 535,-23024.55"/>
<text text-anchor="middle" x="658" y="-23333.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_expert_5_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="789,-23024.55 789,-23348.5 1035,-23348.5 1035,-23024.55 789,-23024.55"/>
<text text-anchor="middle" x="912" y="-23333.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_expert_5_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1043,-23024.55 1043,-23348.5 1289,-23348.5 1289,-23024.55 1043,-23024.55"/>
<text text-anchor="middle" x="1166" y="-23333.3" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_expert_5_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1297,-23024.55 1297,-23348.5 1543,-23348.5 1543,-23024.55 1297,-23024.55"/>
<text text-anchor="middle" x="1420" y="-23333.3" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_expert_5_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1551,-23024.55 1551,-23348.5 1797,-23348.5 1797,-23024.55 1551,-23024.55"/>
<text text-anchor="middle" x="1674" y="-23333.3" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_expert_5_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1805,-23024.55 1805,-23348.5 2051,-23348.5 2051,-23024.55 1805,-23024.55"/>
<text text-anchor="middle" x="1928" y="-23333.3" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust67" class="cluster">
<title>cluster_gpu_6</title>
<path fill="lightblue" stroke="blue" d="M20,-20258.78C20,-20258.78 2052,-20258.78 2052,-20258.78 2058,-20258.78 2064,-20264.78 2064,-20270.78 2064,-20270.78 2064,-22435.87 2064,-22435.87 2064,-22441.87 2058,-22447.87 2052,-22447.87 2052,-22447.87 20,-22447.87 20,-22447.87 14,-22447.87 8,-22441.87 8,-22435.87 8,-22435.87 8,-20270.78 8,-20270.78 8,-20264.78 14,-20258.78 20,-20258.78"/>
<text text-anchor="middle" x="1036" y="-22432.67" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<g id="clust68" class="cluster">
<title>cluster_mha_6</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="619,-21418.96 619,-22314.92 1345,-22314.92 1345,-21418.96 619,-21418.96"/>
<text text-anchor="middle" x="982" y="-22299.72" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust69" class="cluster">
<title>cluster_moe_6</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="16,-20266.78 16,-21399.96 2056,-21399.96 2056,-20266.78 16,-20266.78"/>
<text text-anchor="middle" x="1036" y="-21384.76" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust70" class="cluster">
<title>cluster_expert_6_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="24,-20774.46 24,-21098.41 270,-21098.41 270,-20774.46 24,-20774.46"/>
<text text-anchor="middle" x="147" y="-21083.21" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust71" class="cluster">
<title>cluster_expert_6_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="278,-20774.46 278,-21098.41 524,-21098.41 524,-20774.46 278,-20774.46"/>
<text text-anchor="middle" x="401" y="-21083.21" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust72" class="cluster">
<title>cluster_expert_6_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="532,-20774.46 532,-21098.41 778,-21098.41 778,-20774.46 532,-20774.46"/>
<text text-anchor="middle" x="655" y="-21083.21" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust73" class="cluster">
<title>cluster_expert_6_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="786,-20774.46 786,-21098.41 1032,-21098.41 1032,-20774.46 786,-20774.46"/>
<text text-anchor="middle" x="909" y="-21083.21" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust74" class="cluster">
<title>cluster_expert_6_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1040,-20774.46 1040,-21098.41 1286,-21098.41 1286,-20774.46 1040,-20774.46"/>
<text text-anchor="middle" x="1163" y="-21083.21" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust75" class="cluster">
<title>cluster_expert_6_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1294,-20774.46 1294,-21098.41 1540,-21098.41 1540,-20774.46 1294,-20774.46"/>
<text text-anchor="middle" x="1417" y="-21083.21" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust76" class="cluster">
<title>cluster_expert_6_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1548,-20774.46 1548,-21098.41 1794,-21098.41 1794,-20774.46 1548,-20774.46"/>
<text text-anchor="middle" x="1671" y="-21083.21" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust77" class="cluster">
<title>cluster_expert_6_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1802,-20774.46 1802,-21098.41 2048,-21098.41 2048,-20774.46 1802,-20774.46"/>
<text text-anchor="middle" x="1925" y="-21083.21" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust78" class="cluster">
<title>cluster_gpu_7</title>
<path fill="lightblue" stroke="blue" d="M26,-18008.7C26,-18008.7 2058,-18008.7 2058,-18008.7 2064,-18008.7 2070,-18014.7 2070,-18020.7 2070,-18020.7 2070,-20185.78 2070,-20185.78 2070,-20191.78 2064,-20197.78 2058,-20197.78 2058,-20197.78 26,-20197.78 26,-20197.78 20,-20197.78 14,-20191.78 14,-20185.78 14,-20185.78 14,-18020.7 14,-18020.7 14,-18014.7 20,-18008.7 26,-18008.7"/>
<text text-anchor="middle" x="1042" y="-20182.58" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<g id="clust79" class="cluster">
<title>cluster_mha_7</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="552,-19168.88 552,-20064.83 1278,-20064.83 1278,-19168.88 552,-19168.88"/>
<text text-anchor="middle" x="915" y="-20049.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust80" class="cluster">
<title>cluster_moe_7</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="22,-18016.7 22,-19149.88 2062,-19149.88 2062,-18016.7 22,-18016.7"/>
<text text-anchor="middle" x="1042" y="-19134.68" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust81" class="cluster">
<title>cluster_expert_7_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="30,-18524.37 30,-18848.33 276,-18848.33 276,-18524.37 30,-18524.37"/>
<text text-anchor="middle" x="153" y="-18833.13" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust82" class="cluster">
<title>cluster_expert_7_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="284,-18524.37 284,-18848.33 530,-18848.33 530,-18524.37 284,-18524.37"/>
<text text-anchor="middle" x="407" y="-18833.13" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust83" class="cluster">
<title>cluster_expert_7_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="538,-18524.37 538,-18848.33 784,-18848.33 784,-18524.37 538,-18524.37"/>
<text text-anchor="middle" x="661" y="-18833.13" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust84" class="cluster">
<title>cluster_expert_7_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="792,-18524.37 792,-18848.33 1038,-18848.33 1038,-18524.37 792,-18524.37"/>
<text text-anchor="middle" x="915" y="-18833.13" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust85" class="cluster">
<title>cluster_expert_7_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1046,-18524.37 1046,-18848.33 1292,-18848.33 1292,-18524.37 1046,-18524.37"/>
<text text-anchor="middle" x="1169" y="-18833.13" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust86" class="cluster">
<title>cluster_expert_7_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1300,-18524.37 1300,-18848.33 1546,-18848.33 1546,-18524.37 1300,-18524.37"/>
<text text-anchor="middle" x="1423" y="-18833.13" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust87" class="cluster">
<title>cluster_expert_7_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1554,-18524.37 1554,-18848.33 1800,-18848.33 1800,-18524.37 1554,-18524.37"/>
<text text-anchor="middle" x="1677" y="-18833.13" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust88" class="cluster">
<title>cluster_expert_7_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1808,-18524.37 1808,-18848.33 2054,-18848.33 2054,-18524.37 1808,-18524.37"/>
<text text-anchor="middle" x="1931" y="-18833.13" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust89" class="cluster">
<title>cluster_gpu_8</title>
<path fill="lightblue" stroke="blue" d="M20,-15758.61C20,-15758.61 2052,-15758.61 2052,-15758.61 2058,-15758.61 2064,-15764.61 2064,-15770.61 2064,-15770.61 2064,-17935.7 2064,-17935.7 2064,-17941.7 2058,-17947.7 2052,-17947.7 2052,-17947.7 20,-17947.7 20,-17947.7 14,-17947.7 8,-17941.7 8,-17935.7 8,-17935.7 8,-15770.61 8,-15770.61 8,-15764.61 14,-15758.61 20,-15758.61"/>
<text text-anchor="middle" x="1036" y="-17932.5" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<g id="clust90" class="cluster">
<title>cluster_mha_8</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="683,-16918.79 683,-17814.74 1409,-17814.74 1409,-16918.79 683,-16918.79"/>
<text text-anchor="middle" x="1046" y="-17799.54" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust91" class="cluster">
<title>cluster_moe_8</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="16,-15766.61 16,-16899.79 2056,-16899.79 2056,-15766.61 16,-15766.61"/>
<text text-anchor="middle" x="1036" y="-16884.59" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust92" class="cluster">
<title>cluster_expert_8_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="24,-16274.29 24,-16598.24 270,-16598.24 270,-16274.29 24,-16274.29"/>
<text text-anchor="middle" x="147" y="-16583.04" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust93" class="cluster">
<title>cluster_expert_8_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="278,-16274.29 278,-16598.24 524,-16598.24 524,-16274.29 278,-16274.29"/>
<text text-anchor="middle" x="401" y="-16583.04" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust94" class="cluster">
<title>cluster_expert_8_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="532,-16274.29 532,-16598.24 778,-16598.24 778,-16274.29 532,-16274.29"/>
<text text-anchor="middle" x="655" y="-16583.04" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust95" class="cluster">
<title>cluster_expert_8_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="786,-16274.29 786,-16598.24 1032,-16598.24 1032,-16274.29 786,-16274.29"/>
<text text-anchor="middle" x="909" y="-16583.04" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust96" class="cluster">
<title>cluster_expert_8_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1040,-16274.29 1040,-16598.24 1286,-16598.24 1286,-16274.29 1040,-16274.29"/>
<text text-anchor="middle" x="1163" y="-16583.04" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust97" class="cluster">
<title>cluster_expert_8_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1294,-16274.29 1294,-16598.24 1540,-16598.24 1540,-16274.29 1294,-16274.29"/>
<text text-anchor="middle" x="1417" y="-16583.04" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust98" class="cluster">
<title>cluster_expert_8_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1548,-16274.29 1548,-16598.24 1794,-16598.24 1794,-16274.29 1548,-16274.29"/>
<text text-anchor="middle" x="1671" y="-16583.04" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust99" class="cluster">
<title>cluster_expert_8_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1802,-16274.29 1802,-16598.24 2048,-16598.24 2048,-16274.29 1802,-16274.29"/>
<text text-anchor="middle" x="1925" y="-16583.04" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust100" class="cluster">
<title>cluster_gpu_9</title>
<path fill="lightblue" stroke="blue" d="M33,-13508.52C33,-13508.52 2065,-13508.52 2065,-13508.52 2071,-13508.52 2077,-13514.52 2077,-13520.52 2077,-13520.52 2077,-15685.61 2077,-15685.61 2077,-15691.61 2071,-15697.61 2065,-15697.61 2065,-15697.61 33,-15697.61 33,-15697.61 27,-15697.61 21,-15691.61 21,-15685.61 21,-15685.61 21,-13520.52 21,-13520.52 21,-13514.52 27,-13508.52 33,-13508.52"/>
<text text-anchor="middle" x="1049" y="-15682.41" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<g id="clust101" class="cluster">
<title>cluster_mha_9</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="584,-14668.7 584,-15564.65 1310,-15564.65 1310,-14668.7 584,-14668.7"/>
<text text-anchor="middle" x="947" y="-15549.45" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust102" class="cluster">
<title>cluster_moe_9</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="29,-13516.52 29,-14649.7 2069,-14649.7 2069,-13516.52 29,-13516.52"/>
<text text-anchor="middle" x="1049" y="-14634.5" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust103" class="cluster">
<title>cluster_expert_9_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="37,-14024.2 37,-14348.15 283,-14348.15 283,-14024.2 37,-14024.2"/>
<text text-anchor="middle" x="160" y="-14332.95" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust104" class="cluster">
<title>cluster_expert_9_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="291,-14024.2 291,-14348.15 537,-14348.15 537,-14024.2 291,-14024.2"/>
<text text-anchor="middle" x="414" y="-14332.95" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust105" class="cluster">
<title>cluster_expert_9_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="545,-14024.2 545,-14348.15 791,-14348.15 791,-14024.2 545,-14024.2"/>
<text text-anchor="middle" x="668" y="-14332.95" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust106" class="cluster">
<title>cluster_expert_9_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="799,-14024.2 799,-14348.15 1045,-14348.15 1045,-14024.2 799,-14024.2"/>
<text text-anchor="middle" x="922" y="-14332.95" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust107" class="cluster">
<title>cluster_expert_9_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1053,-14024.2 1053,-14348.15 1299,-14348.15 1299,-14024.2 1053,-14024.2"/>
<text text-anchor="middle" x="1176" y="-14332.95" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust108" class="cluster">
<title>cluster_expert_9_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1307,-14024.2 1307,-14348.15 1553,-14348.15 1553,-14024.2 1307,-14024.2"/>
<text text-anchor="middle" x="1430" y="-14332.95" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust109" class="cluster">
<title>cluster_expert_9_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1561,-14024.2 1561,-14348.15 1807,-14348.15 1807,-14024.2 1561,-14024.2"/>
<text text-anchor="middle" x="1684" y="-14332.95" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust110" class="cluster">
<title>cluster_expert_9_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1815,-14024.2 1815,-14348.15 2061,-14348.15 2061,-14024.2 1815,-14024.2"/>
<text text-anchor="middle" x="1938" y="-14332.95" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust111" class="cluster">
<title>cluster_gpu_10</title>
<path fill="lightblue" stroke="blue" d="M20,-11258.43C20,-11258.43 2052,-11258.43 2052,-11258.43 2058,-11258.43 2064,-11264.43 2064,-11270.43 2064,-11270.43 2064,-13435.52 2064,-13435.52 2064,-13441.52 2058,-13447.52 2052,-13447.52 2052,-13447.52 20,-13447.52 20,-13447.52 14,-13447.52 8,-13441.52 8,-13435.52 8,-13435.52 8,-11270.43 8,-11270.43 8,-11264.43 14,-11258.43 20,-11258.43"/>
<text text-anchor="middle" x="1036" y="-13432.32" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<g id="clust112" class="cluster">
<title>cluster_mha_10</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="630,-12418.61 630,-13314.57 1356,-13314.57 1356,-12418.61 630,-12418.61"/>
<text text-anchor="middle" x="993" y="-13299.37" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust113" class="cluster">
<title>cluster_moe_10</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="16,-11266.43 16,-12399.61 2056,-12399.61 2056,-11266.43 16,-11266.43"/>
<text text-anchor="middle" x="1036" y="-12384.41" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust114" class="cluster">
<title>cluster_expert_10_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="24,-11774.11 24,-12098.07 270,-12098.07 270,-11774.11 24,-11774.11"/>
<text text-anchor="middle" x="147" y="-12082.87" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust115" class="cluster">
<title>cluster_expert_10_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="278,-11774.11 278,-12098.07 524,-12098.07 524,-11774.11 278,-11774.11"/>
<text text-anchor="middle" x="401" y="-12082.87" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust116" class="cluster">
<title>cluster_expert_10_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="532,-11774.11 532,-12098.07 778,-12098.07 778,-11774.11 532,-11774.11"/>
<text text-anchor="middle" x="655" y="-12082.87" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust117" class="cluster">
<title>cluster_expert_10_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="786,-11774.11 786,-12098.07 1032,-12098.07 1032,-11774.11 786,-11774.11"/>
<text text-anchor="middle" x="909" y="-12082.87" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust118" class="cluster">
<title>cluster_expert_10_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1040,-11774.11 1040,-12098.07 1286,-12098.07 1286,-11774.11 1040,-11774.11"/>
<text text-anchor="middle" x="1163" y="-12082.87" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust119" class="cluster">
<title>cluster_expert_10_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1294,-11774.11 1294,-12098.07 1540,-12098.07 1540,-11774.11 1294,-11774.11"/>
<text text-anchor="middle" x="1417" y="-12082.87" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust120" class="cluster">
<title>cluster_expert_10_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1548,-11774.11 1548,-12098.07 1794,-12098.07 1794,-11774.11 1548,-11774.11"/>
<text text-anchor="middle" x="1671" y="-12082.87" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust121" class="cluster">
<title>cluster_expert_10_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1802,-11774.11 1802,-12098.07 2048,-12098.07 2048,-11774.11 1802,-11774.11"/>
<text text-anchor="middle" x="1925" y="-12082.87" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust122" class="cluster">
<title>cluster_gpu_11</title>
<path fill="lightblue" stroke="blue" d="M20,-9008.35C20,-9008.35 2052,-9008.35 2052,-9008.35 2058,-9008.35 2064,-9014.35 2064,-9020.35 2064,-9020.35 2064,-11185.43 2064,-11185.43 2064,-11191.43 2058,-11197.43 2052,-11197.43 2052,-11197.43 20,-11197.43 20,-11197.43 14,-11197.43 8,-11191.43 8,-11185.43 8,-11185.43 8,-9020.35 8,-9020.35 8,-9014.35 14,-9008.35 20,-9008.35"/>
<text text-anchor="middle" x="1036" y="-11182.23" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<g id="clust123" class="cluster">
<title>cluster_mha_11</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="638,-10168.53 638,-11064.48 1364,-11064.48 1364,-10168.53 638,-10168.53"/>
<text text-anchor="middle" x="1001" y="-11049.28" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust124" class="cluster">
<title>cluster_moe_11</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="16,-9016.35 16,-10149.53 2056,-10149.53 2056,-9016.35 16,-9016.35"/>
<text text-anchor="middle" x="1036" y="-10134.33" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust125" class="cluster">
<title>cluster_expert_11_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="24,-9524.03 24,-9847.98 270,-9847.98 270,-9524.03 24,-9524.03"/>
<text text-anchor="middle" x="147" y="-9832.78" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust126" class="cluster">
<title>cluster_expert_11_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="278,-9524.03 278,-9847.98 524,-9847.98 524,-9524.03 278,-9524.03"/>
<text text-anchor="middle" x="401" y="-9832.78" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust127" class="cluster">
<title>cluster_expert_11_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="532,-9524.03 532,-9847.98 778,-9847.98 778,-9524.03 532,-9524.03"/>
<text text-anchor="middle" x="655" y="-9832.78" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust128" class="cluster">
<title>cluster_expert_11_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="786,-9524.03 786,-9847.98 1032,-9847.98 1032,-9524.03 786,-9524.03"/>
<text text-anchor="middle" x="909" y="-9832.78" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust129" class="cluster">
<title>cluster_expert_11_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1040,-9524.03 1040,-9847.98 1286,-9847.98 1286,-9524.03 1040,-9524.03"/>
<text text-anchor="middle" x="1163" y="-9832.78" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust130" class="cluster">
<title>cluster_expert_11_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1294,-9524.03 1294,-9847.98 1540,-9847.98 1540,-9524.03 1294,-9524.03"/>
<text text-anchor="middle" x="1417" y="-9832.78" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust131" class="cluster">
<title>cluster_expert_11_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1548,-9524.03 1548,-9847.98 1794,-9847.98 1794,-9524.03 1548,-9524.03"/>
<text text-anchor="middle" x="1671" y="-9832.78" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust132" class="cluster">
<title>cluster_expert_11_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1802,-9524.03 1802,-9847.98 2048,-9847.98 2048,-9524.03 1802,-9524.03"/>
<text text-anchor="middle" x="1925" y="-9832.78" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust133" class="cluster">
<title>cluster_gpu_12</title>
<path fill="lightblue" stroke="blue" d="M21,-6758.26C21,-6758.26 2053,-6758.26 2053,-6758.26 2059,-6758.26 2065,-6764.26 2065,-6770.26 2065,-6770.26 2065,-8935.35 2065,-8935.35 2065,-8941.35 2059,-8947.35 2053,-8947.35 2053,-8947.35 21,-8947.35 21,-8947.35 15,-8947.35 9,-8941.35 9,-8935.35 9,-8935.35 9,-6770.26 9,-6770.26 9,-6764.26 15,-6758.26 21,-6758.26"/>
<text text-anchor="middle" x="1037" y="-8932.15" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<g id="clust134" class="cluster">
<title>cluster_mha_12</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="589,-7918.44 589,-8814.39 1315,-8814.39 1315,-7918.44 589,-7918.44"/>
<text text-anchor="middle" x="952" y="-8799.19" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust135" class="cluster">
<title>cluster_moe_12</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="17,-6766.26 17,-7899.44 2057,-7899.44 2057,-6766.26 17,-6766.26"/>
<text text-anchor="middle" x="1037" y="-7884.24" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust136" class="cluster">
<title>cluster_expert_12_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="25,-7273.94 25,-7597.89 271,-7597.89 271,-7273.94 25,-7273.94"/>
<text text-anchor="middle" x="148" y="-7582.69" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust137" class="cluster">
<title>cluster_expert_12_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="279,-7273.94 279,-7597.89 525,-7597.89 525,-7273.94 279,-7273.94"/>
<text text-anchor="middle" x="402" y="-7582.69" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust138" class="cluster">
<title>cluster_expert_12_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="533,-7273.94 533,-7597.89 779,-7597.89 779,-7273.94 533,-7273.94"/>
<text text-anchor="middle" x="656" y="-7582.69" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust139" class="cluster">
<title>cluster_expert_12_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="787,-7273.94 787,-7597.89 1033,-7597.89 1033,-7273.94 787,-7273.94"/>
<text text-anchor="middle" x="910" y="-7582.69" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust140" class="cluster">
<title>cluster_expert_12_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1041,-7273.94 1041,-7597.89 1287,-7597.89 1287,-7273.94 1041,-7273.94"/>
<text text-anchor="middle" x="1164" y="-7582.69" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust141" class="cluster">
<title>cluster_expert_12_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1295,-7273.94 1295,-7597.89 1541,-7597.89 1541,-7273.94 1295,-7273.94"/>
<text text-anchor="middle" x="1418" y="-7582.69" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust142" class="cluster">
<title>cluster_expert_12_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1549,-7273.94 1549,-7597.89 1795,-7597.89 1795,-7273.94 1549,-7273.94"/>
<text text-anchor="middle" x="1672" y="-7582.69" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust143" class="cluster">
<title>cluster_expert_12_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1803,-7273.94 1803,-7597.89 2049,-7597.89 2049,-7273.94 1803,-7273.94"/>
<text text-anchor="middle" x="1926" y="-7582.69" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust144" class="cluster">
<title>cluster_gpu_13</title>
<path fill="lightblue" stroke="blue" d="M23,-4508.17C23,-4508.17 2055,-4508.17 2055,-4508.17 2061,-4508.17 2067,-4514.17 2067,-4520.17 2067,-4520.17 2067,-6685.26 2067,-6685.26 2067,-6691.26 2061,-6697.26 2055,-6697.26 2055,-6697.26 23,-6697.26 23,-6697.26 17,-6697.26 11,-6691.26 11,-6685.26 11,-6685.26 11,-4520.17 11,-4520.17 11,-4514.17 17,-4508.17 23,-4508.17"/>
<text text-anchor="middle" x="1039" y="-6682.06" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<g id="clust145" class="cluster">
<title>cluster_mha_13</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="552,-5668.35 552,-6564.31 1278,-6564.31 1278,-5668.35 552,-5668.35"/>
<text text-anchor="middle" x="915" y="-6549.11" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust146" class="cluster">
<title>cluster_moe_13</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="19,-4516.17 19,-5649.35 2059,-5649.35 2059,-4516.17 19,-4516.17"/>
<text text-anchor="middle" x="1039" y="-5634.15" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust147" class="cluster">
<title>cluster_expert_13_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="27,-5023.85 27,-5347.81 273,-5347.81 273,-5023.85 27,-5023.85"/>
<text text-anchor="middle" x="150" y="-5332.61" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust148" class="cluster">
<title>cluster_expert_13_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="281,-5023.85 281,-5347.81 527,-5347.81 527,-5023.85 281,-5023.85"/>
<text text-anchor="middle" x="404" y="-5332.61" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust149" class="cluster">
<title>cluster_expert_13_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="535,-5023.85 535,-5347.81 781,-5347.81 781,-5023.85 535,-5023.85"/>
<text text-anchor="middle" x="658" y="-5332.61" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust150" class="cluster">
<title>cluster_expert_13_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="789,-5023.85 789,-5347.81 1035,-5347.81 1035,-5023.85 789,-5023.85"/>
<text text-anchor="middle" x="912" y="-5332.61" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust151" class="cluster">
<title>cluster_expert_13_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1043,-5023.85 1043,-5347.81 1289,-5347.81 1289,-5023.85 1043,-5023.85"/>
<text text-anchor="middle" x="1166" y="-5332.61" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust152" class="cluster">
<title>cluster_expert_13_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1297,-5023.85 1297,-5347.81 1543,-5347.81 1543,-5023.85 1297,-5023.85"/>
<text text-anchor="middle" x="1420" y="-5332.61" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust153" class="cluster">
<title>cluster_expert_13_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1551,-5023.85 1551,-5347.81 1797,-5347.81 1797,-5023.85 1551,-5023.85"/>
<text text-anchor="middle" x="1674" y="-5332.61" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust154" class="cluster">
<title>cluster_expert_13_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1805,-5023.85 1805,-5347.81 2051,-5347.81 2051,-5023.85 1805,-5023.85"/>
<text text-anchor="middle" x="1928" y="-5332.61" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust155" class="cluster">
<title>cluster_gpu_14</title>
<path fill="lightblue" stroke="blue" d="M27,-2258.09C27,-2258.09 2059,-2258.09 2059,-2258.09 2065,-2258.09 2071,-2264.09 2071,-2270.09 2071,-2270.09 2071,-4435.17 2071,-4435.17 2071,-4441.17 2065,-4447.17 2059,-4447.17 2059,-4447.17 27,-4447.17 27,-4447.17 21,-4447.17 15,-4441.17 15,-4435.17 15,-4435.17 15,-2270.09 15,-2270.09 15,-2264.09 21,-2258.09 27,-2258.09"/>
<text text-anchor="middle" x="1043" y="-4431.97" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<g id="clust156" class="cluster">
<title>cluster_mha_14</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="684,-3418.27 684,-4314.22 1410,-4314.22 1410,-3418.27 684,-3418.27"/>
<text text-anchor="middle" x="1047" y="-4299.02" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust157" class="cluster">
<title>cluster_moe_14</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="23,-2266.09 23,-3399.27 2063,-3399.27 2063,-2266.09 23,-2266.09"/>
<text text-anchor="middle" x="1043" y="-3384.07" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust158" class="cluster">
<title>cluster_expert_14_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="31,-2773.77 31,-3097.72 277,-3097.72 277,-2773.77 31,-2773.77"/>
<text text-anchor="middle" x="154" y="-3082.52" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust159" class="cluster">
<title>cluster_expert_14_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="285,-2773.77 285,-3097.72 531,-3097.72 531,-2773.77 285,-2773.77"/>
<text text-anchor="middle" x="408" y="-3082.52" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust160" class="cluster">
<title>cluster_expert_14_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="539,-2773.77 539,-3097.72 785,-3097.72 785,-2773.77 539,-2773.77"/>
<text text-anchor="middle" x="662" y="-3082.52" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust161" class="cluster">
<title>cluster_expert_14_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="793,-2773.77 793,-3097.72 1039,-3097.72 1039,-2773.77 793,-2773.77"/>
<text text-anchor="middle" x="916" y="-3082.52" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust162" class="cluster">
<title>cluster_expert_14_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1047,-2773.77 1047,-3097.72 1293,-3097.72 1293,-2773.77 1047,-2773.77"/>
<text text-anchor="middle" x="1170" y="-3082.52" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust163" class="cluster">
<title>cluster_expert_14_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1301,-2773.77 1301,-3097.72 1547,-3097.72 1547,-2773.77 1301,-2773.77"/>
<text text-anchor="middle" x="1424" y="-3082.52" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust164" class="cluster">
<title>cluster_expert_14_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1555,-2773.77 1555,-3097.72 1801,-3097.72 1801,-2773.77 1555,-2773.77"/>
<text text-anchor="middle" x="1678" y="-3082.52" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust165" class="cluster">
<title>cluster_expert_14_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1809,-2773.77 1809,-3097.72 2055,-3097.72 2055,-2773.77 1809,-2773.77"/>
<text text-anchor="middle" x="1932" y="-3082.52" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<g id="clust166" class="cluster">
<title>cluster_gpu_15</title>
<path fill="lightblue" stroke="blue" d="M20,-8C20,-8 2052,-8 2052,-8 2058,-8 2064,-14 2064,-20 2064,-20 2064,-2185.09 2064,-2185.09 2064,-2191.09 2058,-2197.09 2052,-2197.09 2052,-2197.09 20,-2197.09 20,-2197.09 14,-2197.09 8,-2191.09 8,-2185.09 8,-2185.09 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="1036" y="-2181.89" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<g id="clust167" class="cluster">
<title>cluster_mha_15</title>
<polygon fill="lightblue" stroke="red" stroke-dasharray="5,2" points="586,-1168.18 586,-2064.13 1312,-2064.13 1312,-1168.18 586,-1168.18"/>
<text text-anchor="middle" x="949" y="-2048.93" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust168" class="cluster">
<title>cluster_moe_15</title>
<polygon fill="lightblue" stroke="purple" stroke-dasharray="5,2" points="16,-16 16,-1149.18 2056,-1149.18 2056,-16 16,-16"/>
<text text-anchor="middle" x="1036" y="-1133.98" font-family="Times,serif" font-size="14.00">Mixture of Experts (8 Experts)</text>
</g>
<g id="clust169" class="cluster">
<title>cluster_expert_15_0</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="24,-523.68 24,-847.63 270,-847.63 270,-523.68 24,-523.68"/>
<text text-anchor="middle" x="147" y="-832.43" font-family="Times,serif" font-size="14.00">Expert 0</text>
</g>
<g id="clust170" class="cluster">
<title>cluster_expert_15_1</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="278,-523.68 278,-847.63 524,-847.63 524,-523.68 278,-523.68"/>
<text text-anchor="middle" x="401" y="-832.43" font-family="Times,serif" font-size="14.00">Expert 1</text>
</g>
<g id="clust171" class="cluster">
<title>cluster_expert_15_2</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="532,-523.68 532,-847.63 778,-847.63 778,-523.68 532,-523.68"/>
<text text-anchor="middle" x="655" y="-832.43" font-family="Times,serif" font-size="14.00">Expert 2</text>
</g>
<g id="clust172" class="cluster">
<title>cluster_expert_15_3</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="786,-523.68 786,-847.63 1032,-847.63 1032,-523.68 786,-523.68"/>
<text text-anchor="middle" x="909" y="-832.43" font-family="Times,serif" font-size="14.00">Expert 3</text>
</g>
<g id="clust173" class="cluster">
<title>cluster_expert_15_4</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1040,-523.68 1040,-847.63 1286,-847.63 1286,-523.68 1040,-523.68"/>
<text text-anchor="middle" x="1163" y="-832.43" font-family="Times,serif" font-size="14.00">Expert 4</text>
</g>
<g id="clust174" class="cluster">
<title>cluster_expert_15_5</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1294,-523.68 1294,-847.63 1540,-847.63 1540,-523.68 1294,-523.68"/>
<text text-anchor="middle" x="1417" y="-832.43" font-family="Times,serif" font-size="14.00">Expert 5</text>
</g>
<g id="clust175" class="cluster">
<title>cluster_expert_15_6</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1548,-523.68 1548,-847.63 1794,-847.63 1794,-523.68 1548,-523.68"/>
<text text-anchor="middle" x="1671" y="-832.43" font-family="Times,serif" font-size="14.00">Expert 6</text>
</g>
<g id="clust176" class="cluster">
<title>cluster_expert_15_7</title>
<polygon fill="lightblue" stroke="green" stroke-dasharray="1,5" points="1802,-523.68 1802,-847.63 2048,-847.63 2048,-523.68 1802,-523.68"/>
<text text-anchor="middle" x="1925" y="-832.43" font-family="Times,serif" font-size="14.00">Expert 7</text>
</g>
<!-- input_0 -->
<g id="node1" class="node">
<title>input_0</title>
<ellipse fill="none" stroke="black" cx="1053" cy="-35891.44" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1053" y="-35902.74" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1053" y="-35887.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1053" y="-35872.74" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- qkv_proj_0 -->
<g id="node2" class="node">
<title>qkv_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1215,-35784.44 891,-35784.44 891,-35716.44 1215,-35716.44 1215,-35784.44"/>
<text text-anchor="middle" x="1053" y="-35769.24" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1053" y="-35754.24" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1053" y="-35739.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="1053" y="-35724.24" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input_0&#45;&gt;qkv_proj_0 -->
<g id="edge1" class="edge">
<title>input_0&#45;&gt;qkv_proj_0</title>
<path fill="none" stroke="black" d="M1053,-35853.92C1053,-35835.86 1053,-35813.95 1053,-35795.02"/>
<polygon fill="black" stroke="black" points="1056.5,-35794.86 1053,-35784.86 1049.5,-35794.86 1056.5,-35794.86"/>
</g>
<!-- reshape_qkv_0 -->
<g id="node3" class="node">
<title>reshape_qkv_0</title>
<polygon fill="none" stroke="black" points="1407.64,-35679.44 843.49,-35679.44 698.36,-35573.44 1262.51,-35573.44 1407.64,-35679.44"/>
<text text-anchor="middle" x="1053" y="-35637.74" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="1053" y="-35622.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1053" y="-35607.74" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- qkv_proj_0&#45;&gt;reshape_qkv_0 -->
<g id="edge2" class="edge">
<title>qkv_proj_0&#45;&gt;reshape_qkv_0</title>
<path fill="none" stroke="black" d="M1053,-35716.42C1053,-35708.22 1053,-35699.15 1053,-35690.04"/>
<polygon fill="black" stroke="black" points="1056.5,-35689.77 1053,-35679.77 1049.5,-35689.77 1056.5,-35689.77"/>
</g>
<!-- attn_scores_0 -->
<g id="node4" class="node">
<title>attn_scores_0</title>
<polygon fill="none" stroke="black" points="1053,-35536.44 873,-35483.44 1053,-35430.44 1233,-35483.44 1053,-35536.44"/>
<text text-anchor="middle" x="1053" y="-35494.74" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1053" y="-35479.74" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1053" y="-35464.74" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- reshape_qkv_0&#45;&gt;attn_scores_0 -->
<g id="edge3" class="edge">
<title>reshape_qkv_0&#45;&gt;attn_scores_0</title>
<path fill="none" stroke="black" d="M1053,-35573.33C1053,-35564.76 1053,-35555.8 1053,-35547.01"/>
<polygon fill="black" stroke="black" points="1056.5,-35546.8 1053,-35536.8 1049.5,-35546.8 1056.5,-35546.8"/>
</g>
<!-- attn_weights_0 -->
<g id="node5" class="node">
<title>attn_weights_0</title>
<polygon fill="none" stroke="black" points="1053,-35393.44 873,-35340.44 1053,-35287.44 1233,-35340.44 1053,-35393.44"/>
<text text-anchor="middle" x="1053" y="-35351.74" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1053" y="-35336.74" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1053" y="-35321.74" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- attn_scores_0&#45;&gt;attn_weights_0 -->
<g id="edge4" class="edge">
<title>attn_scores_0&#45;&gt;attn_weights_0</title>
<path fill="none" stroke="black" d="M1053,-35430.33C1053,-35421.76 1053,-35412.8 1053,-35404.01"/>
<polygon fill="black" stroke="black" points="1056.5,-35403.8 1053,-35393.8 1049.5,-35403.8 1056.5,-35403.8"/>
</g>
<!-- attn_output_0 -->
<g id="node6" class="node">
<title>attn_output_0</title>
<polygon fill="none" stroke="black" points="1053,-35250.44 882,-35197.44 1053,-35144.44 1224,-35197.44 1053,-35250.44"/>
<text text-anchor="middle" x="1053" y="-35208.74" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="1053" y="-35193.74" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1053" y="-35178.74" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- attn_weights_0&#45;&gt;attn_output_0 -->
<g id="edge5" class="edge">
<title>attn_weights_0&#45;&gt;attn_output_0</title>
<path fill="none" stroke="black" d="M1053,-35287.33C1053,-35278.76 1053,-35269.8 1053,-35261.01"/>
<polygon fill="black" stroke="black" points="1056.5,-35260.8 1053,-35250.8 1049.5,-35260.8 1056.5,-35260.8"/>
</g>
<!-- out_proj_0 -->
<g id="node7" class="node">
<title>out_proj_0</title>
<polygon fill="lightcoral" stroke="black" points="1129.5,-35107.44 976.5,-35107.44 976.5,-35039.44 1129.5,-35039.44 1129.5,-35107.44"/>
<text text-anchor="middle" x="1053" y="-35092.24" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1053" y="-35077.24" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1053" y="-35062.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1053" y="-35047.24" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- attn_output_0&#45;&gt;out_proj_0 -->
<g id="edge6" class="edge">
<title>attn_output_0&#45;&gt;out_proj_0</title>
<path fill="none" stroke="black" d="M1053,-35144.34C1053,-35135.5 1053,-35126.41 1053,-35117.82"/>
<polygon fill="black" stroke="black" points="1056.5,-35117.65 1053,-35107.65 1049.5,-35117.65 1056.5,-35117.65"/>
</g>
<!-- residual_1_0 -->
<g id="node8" class="node">
<title>residual_1_0</title>
<ellipse fill="none" stroke="black" cx="1053" cy="-34964.96" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1053" y="-34976.26" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1053" y="-34961.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1053" y="-34946.26" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- out_proj_0&#45;&gt;residual_1_0 -->
<g id="edge7" class="edge">
<title>out_proj_0&#45;&gt;residual_1_0</title>
<path fill="none" stroke="black" d="M1053,-35039.33C1053,-35030.99 1053,-35021.88 1053,-35013.01"/>
<polygon fill="black" stroke="black" points="1056.5,-35012.75 1053,-35002.75 1049.5,-35012.75 1056.5,-35012.75"/>
</g>
<!-- gate_0 -->
<g id="node9" class="node">
<title>gate_0</title>
<polygon fill="lightpink" stroke="black" points="1288.3,-34826.21 1170.65,-34869.26 935.35,-34869.26 817.7,-34826.21 935.35,-34783.16 1170.65,-34783.16 1288.3,-34826.21"/>
<text text-anchor="middle" x="1053" y="-34837.51" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1053" y="-34822.51" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="1053" y="-34807.51" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- residual_1_0&#45;&gt;gate_0 -->
<g id="edge8" class="edge">
<title>residual_1_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M1053,-34927.31C1053,-34912.65 1053,-34895.48 1053,-34879.54"/>
<polygon fill="black" stroke="black" points="1056.5,-34879.28 1053,-34869.28 1049.5,-34879.28 1056.5,-34879.28"/>
</g>
<!-- selection_0 -->
<g id="node10" class="node">
<title>selection_0</title>
<polygon fill="none" stroke="black" points="1053,-34745.93 851,-34692.93 1053,-34639.93 1255,-34692.93 1053,-34745.93"/>
<text text-anchor="middle" x="1053" y="-34704.23" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="1053" y="-34689.23" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="1053" y="-34674.23" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- gate_0&#45;&gt;selection_0 -->
<g id="edge9" class="edge">
<title>gate_0&#45;&gt;selection_0</title>
<path fill="none" stroke="black" d="M1053,-34782.95C1053,-34774.46 1053,-34765.36 1053,-34756.34"/>
<polygon fill="black" stroke="black" points="1056.5,-34756.24 1053,-34746.24 1049.5,-34756.24 1056.5,-34756.24"/>
</g>
<!-- expert_0_0_up -->
<g id="node11" class="node">
<title>expert_0_0_up</title>
<polygon fill="lightgreen" stroke="black" points="266,-34567.93 104,-34567.93 104,-34499.93 266,-34499.93 266,-34567.93"/>
<text text-anchor="middle" x="185" y="-34552.73" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="185" y="-34537.73" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="185" y="-34522.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="185" y="-34507.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- selection_0&#45;&gt;expert_0_0_up -->
<g id="edge10" class="edge">
<title>selection_0&#45;&gt;expert_0_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M894.56,-34681.5C703.6,-34667.39 394.91,-34639.28 287,-34598.93 270.06,-34592.6 252.92,-34583.24 237.65,-34573.62"/>
<polygon fill="red" stroke="red" points="239.18,-34570.44 228.89,-34567.94 235.38,-34576.32 239.18,-34570.44"/>
<text text-anchor="middle" x="426.5" y="-34610.73" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_0_1_up -->
<g id="node14" class="node">
<title>expert_0_1_up</title>
<polygon fill="lightgreen" stroke="black" points="520,-34567.93 358,-34567.93 358,-34499.93 520,-34499.93 520,-34567.93"/>
<text text-anchor="middle" x="439" y="-34552.73" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="439" y="-34537.73" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="439" y="-34522.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="439" y="-34507.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- selection_0&#45;&gt;expert_0_1_up -->
<g id="edge14" class="edge">
<title>selection_0&#45;&gt;expert_0_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M901.31,-34679.64C797.19,-34667.57 657.34,-34644.06 541,-34598.93 524.3,-34592.46 507.35,-34583.15 492.19,-34573.62"/>
<polygon fill="red" stroke="red" points="493.79,-34570.49 483.49,-34568.01 490,-34576.37 493.79,-34570.49"/>
<text text-anchor="middle" x="671.5" y="-34610.73" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_0_2_up -->
<g id="node17" class="node">
<title>expert_0_2_up</title>
<polygon fill="lightgreen" stroke="black" points="775,-34567.93 613,-34567.93 613,-34499.93 775,-34499.93 775,-34567.93"/>
<text text-anchor="middle" x="694" y="-34552.73" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="694" y="-34537.73" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="694" y="-34522.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="694" y="-34507.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- selection_0&#45;&gt;expert_0_2_up -->
<g id="edge18" class="edge">
<title>selection_0&#45;&gt;expert_0_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M959.31,-34664.43C909.28,-34648.21 847.39,-34625.63 795,-34598.93 780.3,-34591.44 764.98,-34582.43 750.86,-34573.57"/>
<polygon fill="red" stroke="red" points="752.55,-34570.5 742.23,-34568.08 748.79,-34576.4 752.55,-34570.5"/>
<text text-anchor="middle" x="906.5" y="-34610.73" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_0_3_up -->
<g id="node20" class="node">
<title>expert_0_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1028,-34567.93 866,-34567.93 866,-34499.93 1028,-34499.93 1028,-34567.93"/>
<text text-anchor="middle" x="947" y="-34552.73" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="947" y="-34537.73" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="947" y="-34522.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="947" y="-34507.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- selection_0&#45;&gt;expert_0_3_up -->
<g id="edge22" class="edge">
<title>selection_0&#45;&gt;expert_0_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1015.79,-34649.61C1008.58,-34640.7 1001.31,-34631.2 995,-34621.93 985.35,-34607.77 975.96,-34591.49 968.08,-34576.87"/>
<polygon fill="red" stroke="red" points="971.16,-34575.21 963.38,-34568.02 964.98,-34578.5 971.16,-34575.21"/>
<text text-anchor="middle" x="1059.5" y="-34610.73" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_0_4_up -->
<g id="node23" class="node">
<title>expert_0_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1240,-34567.93 1078,-34567.93 1078,-34499.93 1240,-34499.93 1240,-34567.93"/>
<text text-anchor="middle" x="1159" y="-34552.73" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1159" y="-34537.73" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1159" y="-34522.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1159" y="-34507.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- selection_0&#45;&gt;expert_0_4_up -->
<g id="edge26" class="edge">
<title>selection_0&#45;&gt;expert_0_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1099.24,-34651.89C1108.21,-34642.66 1117,-34632.45 1124,-34621.93 1132.87,-34608.61 1140.09,-34592.69 1145.62,-34578.13"/>
<polygon fill="red" stroke="red" points="1149.06,-34578.91 1149.18,-34568.32 1142.48,-34576.53 1149.06,-34578.91"/>
<text text-anchor="middle" x="1195.5" y="-34610.73" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_0_5_up -->
<g id="node26" class="node">
<title>expert_0_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1494,-34567.93 1332,-34567.93 1332,-34499.93 1494,-34499.93 1494,-34567.93"/>
<text text-anchor="middle" x="1413" y="-34552.73" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1413" y="-34537.73" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1413" y="-34522.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1413" y="-34507.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- selection_0&#45;&gt;expert_0_5_up -->
<g id="edge30" class="edge">
<title>selection_0&#45;&gt;expert_0_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1148.35,-34664.94C1185.14,-34653.33 1227.16,-34638.58 1264,-34621.93 1294.53,-34608.14 1326.83,-34589.79 1353.52,-34573.5"/>
<polygon fill="red" stroke="red" points="1355.67,-34576.29 1362.35,-34568.06 1352,-34570.33 1355.67,-34576.29"/>
<text text-anchor="middle" x="1357.5" y="-34610.73" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_0_6_up -->
<g id="node29" class="node">
<title>expert_0_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1748,-34567.93 1586,-34567.93 1586,-34499.93 1748,-34499.93 1748,-34567.93"/>
<text text-anchor="middle" x="1667" y="-34552.73" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1667" y="-34537.73" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1667" y="-34522.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1667" y="-34507.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- selection_0&#45;&gt;expert_0_6_up -->
<g id="edge34" class="edge">
<title>selection_0&#45;&gt;expert_0_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1199.64,-34678.37C1302.15,-34665.66 1440.92,-34641.93 1557,-34598.93 1574.83,-34592.33 1593.11,-34582.93 1609.51,-34573.37"/>
<polygon fill="red" stroke="red" points="1611.62,-34576.18 1618.42,-34568.05 1608.03,-34570.17 1611.62,-34576.18"/>
<text text-anchor="middle" x="1595.5" y="-34610.73" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_0_7_up -->
<g id="node32" class="node">
<title>expert_0_7_up</title>
<polygon fill="lightgreen" stroke="black" points="2002,-34567.93 1840,-34567.93 1840,-34499.93 2002,-34499.93 2002,-34567.93"/>
<text text-anchor="middle" x="1921" y="-34552.73" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1921" y="-34537.73" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1921" y="-34522.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1921" y="-34507.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- selection_0&#45;&gt;expert_0_7_up -->
<g id="edge38" class="edge">
<title>selection_0&#45;&gt;expert_0_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1209.16,-34680.82C1397.87,-34665.99 1703.47,-34637.1 1811,-34598.93 1829.1,-34592.51 1847.58,-34583.07 1864.11,-34573.41"/>
<polygon fill="red" stroke="red" points="1866.3,-34576.18 1873.07,-34568.03 1862.7,-34570.17 1866.3,-34576.18"/>
<text text-anchor="middle" x="1841.5" y="-34610.73" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_0_0_gelu -->
<g id="node12" class="node">
<title>expert_0_0_gelu</title>
<ellipse fill="none" stroke="black" cx="160" cy="-34425.46" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="160" y="-34436.76" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="160" y="-34421.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="160" y="-34406.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_0_up&#45;&gt;expert_0_0_gelu -->
<g id="edge11" class="edge">
<title>expert_0_0_up&#45;&gt;expert_0_0_gelu</title>
<path fill="none" stroke="black" d="M177.23,-34499.83C175.21,-34491.22 172.99,-34481.79 170.84,-34472.64"/>
<polygon fill="black" stroke="black" points="174.24,-34471.81 168.55,-34462.88 167.43,-34473.41 174.24,-34471.81"/>
</g>
<!-- expert_0_0_down -->
<g id="node13" class="node">
<title>expert_0_0_down</title>
<polygon fill="lightgreen" stroke="black" points="264.5,-34350.98 111.5,-34350.98 111.5,-34282.98 264.5,-34282.98 264.5,-34350.98"/>
<text text-anchor="middle" x="188" y="-34335.78" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="188" y="-34320.78" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="188" y="-34305.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="188" y="-34290.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_0_gelu&#45;&gt;expert_0_0_down -->
<g id="edge12" class="edge">
<title>expert_0_0_gelu&#45;&gt;expert_0_0_down</title>
<path fill="none" stroke="black" d="M169.64,-34387.81C171.91,-34379.16 174.36,-34369.86 176.7,-34360.95"/>
<polygon fill="black" stroke="black" points="180.13,-34361.68 179.29,-34351.12 173.36,-34359.9 180.13,-34361.68"/>
</g>
<!-- aggregate_0 -->
<g id="node35" class="node">
<title>aggregate_0</title>
<ellipse fill="lightyellow" stroke="black" cx="964" cy="-34066.62" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="964" cy="-34066.62" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="964" y="-34077.92" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="964" y="-34062.92" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="964" y="-34047.92" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_0_down&#45;&gt;aggregate_0 -->
<g id="edge13" class="edge">
<title>expert_0_0_down&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M264.74,-34283.36C272.22,-34280.43 279.73,-34277.59 287,-34274.98 452.51,-34215.52 644.46,-34157.75 781.62,-34118.36"/>
<polygon fill="black" stroke="black" points="782.75,-34121.68 791.4,-34115.56 780.82,-34114.95 782.75,-34121.68"/>
</g>
<!-- expert_0_1_gelu -->
<g id="node15" class="node">
<title>expert_0_1_gelu</title>
<ellipse fill="none" stroke="black" cx="414" cy="-34425.46" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="414" y="-34436.76" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="414" y="-34421.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="414" y="-34406.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_1_up&#45;&gt;expert_0_1_gelu -->
<g id="edge15" class="edge">
<title>expert_0_1_up&#45;&gt;expert_0_1_gelu</title>
<path fill="none" stroke="black" d="M431.23,-34499.83C429.21,-34491.22 426.99,-34481.79 424.84,-34472.64"/>
<polygon fill="black" stroke="black" points="428.24,-34471.81 422.55,-34462.88 421.43,-34473.41 428.24,-34471.81"/>
</g>
<!-- expert_0_1_down -->
<g id="node16" class="node">
<title>expert_0_1_down</title>
<polygon fill="lightgreen" stroke="black" points="518.5,-34350.98 365.5,-34350.98 365.5,-34282.98 518.5,-34282.98 518.5,-34350.98"/>
<text text-anchor="middle" x="442" y="-34335.78" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="442" y="-34320.78" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="442" y="-34305.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="442" y="-34290.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_1_gelu&#45;&gt;expert_0_1_down -->
<g id="edge16" class="edge">
<title>expert_0_1_gelu&#45;&gt;expert_0_1_down</title>
<path fill="none" stroke="black" d="M423.64,-34387.81C425.91,-34379.16 428.36,-34369.86 430.7,-34360.95"/>
<polygon fill="black" stroke="black" points="434.13,-34361.68 433.29,-34351.12 427.36,-34359.9 434.13,-34361.68"/>
</g>
<!-- expert_0_1_down&#45;&gt;aggregate_0 -->
<g id="edge17" class="edge">
<title>expert_0_1_down&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M511.59,-34282.87C583.11,-34248.84 697.24,-34194.54 792.97,-34148.99"/>
<polygon fill="black" stroke="black" points="794.65,-34152.07 802.18,-34144.61 791.64,-34145.75 794.65,-34152.07"/>
</g>
<!-- expert_0_2_gelu -->
<g id="node18" class="node">
<title>expert_0_2_gelu</title>
<ellipse fill="none" stroke="black" cx="668" cy="-34425.46" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="668" y="-34436.76" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="668" y="-34421.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="668" y="-34406.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_2_up&#45;&gt;expert_0_2_gelu -->
<g id="edge19" class="edge">
<title>expert_0_2_up&#45;&gt;expert_0_2_gelu</title>
<path fill="none" stroke="black" d="M685.92,-34499.83C683.81,-34491.22 681.51,-34481.79 679.28,-34472.64"/>
<polygon fill="black" stroke="black" points="682.67,-34471.76 676.89,-34462.88 675.87,-34473.42 682.67,-34471.76"/>
</g>
<!-- expert_0_2_down -->
<g id="node19" class="node">
<title>expert_0_2_down</title>
<polygon fill="lightgreen" stroke="black" points="772.5,-34350.98 619.5,-34350.98 619.5,-34282.98 772.5,-34282.98 772.5,-34350.98"/>
<text text-anchor="middle" x="696" y="-34335.78" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="696" y="-34320.78" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="696" y="-34305.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="696" y="-34290.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_2_gelu&#45;&gt;expert_0_2_down -->
<g id="edge20" class="edge">
<title>expert_0_2_gelu&#45;&gt;expert_0_2_down</title>
<path fill="none" stroke="black" d="M677.64,-34387.81C679.91,-34379.16 682.36,-34369.86 684.7,-34360.95"/>
<polygon fill="black" stroke="black" points="688.13,-34361.68 687.29,-34351.12 681.36,-34359.9 688.13,-34361.68"/>
</g>
<!-- expert_0_2_down&#45;&gt;aggregate_0 -->
<g id="edge21" class="edge">
<title>expert_0_2_down&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M731.87,-34282.74C756.43,-34259.98 790.74,-34228.18 825.46,-34196.01"/>
<polygon fill="black" stroke="black" points="827.92,-34198.5 832.87,-34189.14 823.16,-34193.37 827.92,-34198.5"/>
</g>
<!-- expert_0_3_gelu -->
<g id="node21" class="node">
<title>expert_0_3_gelu</title>
<ellipse fill="none" stroke="black" cx="922" cy="-34425.46" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="922" y="-34436.76" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="922" y="-34421.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="922" y="-34406.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_3_up&#45;&gt;expert_0_3_gelu -->
<g id="edge23" class="edge">
<title>expert_0_3_up&#45;&gt;expert_0_3_gelu</title>
<path fill="none" stroke="black" d="M939.23,-34499.83C937.21,-34491.22 934.99,-34481.79 932.84,-34472.64"/>
<polygon fill="black" stroke="black" points="936.24,-34471.81 930.55,-34462.88 929.43,-34473.41 936.24,-34471.81"/>
</g>
<!-- expert_0_3_down -->
<g id="node22" class="node">
<title>expert_0_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1022.5,-34350.98 869.5,-34350.98 869.5,-34282.98 1022.5,-34282.98 1022.5,-34350.98"/>
<text text-anchor="middle" x="946" y="-34335.78" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="946" y="-34320.78" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="946" y="-34305.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="946" y="-34290.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_3_gelu&#45;&gt;expert_0_3_down -->
<g id="edge24" class="edge">
<title>expert_0_3_gelu&#45;&gt;expert_0_3_down</title>
<path fill="none" stroke="black" d="M930.26,-34387.81C932.21,-34379.16 934.31,-34369.86 936.31,-34360.95"/>
<polygon fill="black" stroke="black" points="939.75,-34361.65 938.53,-34351.12 932.92,-34360.11 939.75,-34361.65"/>
</g>
<!-- expert_0_3_down&#45;&gt;aggregate_0 -->
<g id="edge25" class="edge">
<title>expert_0_3_down&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M948.41,-34282.74C948.99,-34274.71 949.65,-34265.56 950.37,-34255.66"/>
<polygon fill="black" stroke="black" points="953.87,-34255.76 951.11,-34245.53 946.89,-34255.25 953.87,-34255.76"/>
</g>
<!-- expert_0_4_gelu -->
<g id="node24" class="node">
<title>expert_0_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1176" cy="-34425.46" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1176" y="-34436.76" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1176" y="-34421.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1176" y="-34406.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_4_up&#45;&gt;expert_0_4_gelu -->
<g id="edge27" class="edge">
<title>expert_0_4_up&#45;&gt;expert_0_4_gelu</title>
<path fill="none" stroke="black" d="M1164.29,-34499.83C1165.63,-34491.4 1167.1,-34482.18 1168.53,-34473.22"/>
<polygon fill="black" stroke="black" points="1172,-34473.68 1170.13,-34463.25 1165.09,-34472.58 1172,-34473.68"/>
</g>
<!-- expert_0_4_down -->
<g id="node25" class="node">
<title>expert_0_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1233.5,-34350.98 1080.5,-34350.98 1080.5,-34282.98 1233.5,-34282.98 1233.5,-34350.98"/>
<text text-anchor="middle" x="1157" y="-34335.78" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1157" y="-34320.78" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1157" y="-34305.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1157" y="-34290.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_4_gelu&#45;&gt;expert_0_4_down -->
<g id="edge28" class="edge">
<title>expert_0_4_gelu&#45;&gt;expert_0_4_down</title>
<path fill="none" stroke="black" d="M1169.46,-34387.81C1167.93,-34379.25 1166.29,-34370.06 1164.72,-34361.24"/>
<polygon fill="black" stroke="black" points="1168.12,-34360.35 1162.91,-34351.12 1161.22,-34361.58 1168.12,-34360.35"/>
</g>
<!-- expert_0_4_down&#45;&gt;aggregate_0 -->
<g id="edge29" class="edge">
<title>expert_0_4_down&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M1131.17,-34282.74C1117.31,-34264.91 1099.16,-34241.54 1079.92,-34216.79"/>
<polygon fill="black" stroke="black" points="1082.54,-34214.46 1073.64,-34208.71 1077.02,-34218.76 1082.54,-34214.46"/>
</g>
<!-- expert_0_5_gelu -->
<g id="node27" class="node">
<title>expert_0_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1430" cy="-34425.46" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1430" y="-34436.76" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1430" y="-34421.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1430" y="-34406.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_5_up&#45;&gt;expert_0_5_gelu -->
<g id="edge31" class="edge">
<title>expert_0_5_up&#45;&gt;expert_0_5_gelu</title>
<path fill="none" stroke="black" d="M1418.29,-34499.83C1419.63,-34491.4 1421.1,-34482.18 1422.53,-34473.22"/>
<polygon fill="black" stroke="black" points="1426,-34473.68 1424.13,-34463.25 1419.09,-34472.58 1426,-34473.68"/>
</g>
<!-- expert_0_5_down -->
<g id="node28" class="node">
<title>expert_0_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1487.5,-34350.98 1334.5,-34350.98 1334.5,-34282.98 1487.5,-34282.98 1487.5,-34350.98"/>
<text text-anchor="middle" x="1411" y="-34335.78" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1411" y="-34320.78" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1411" y="-34305.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1411" y="-34290.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_5_gelu&#45;&gt;expert_0_5_down -->
<g id="edge32" class="edge">
<title>expert_0_5_gelu&#45;&gt;expert_0_5_down</title>
<path fill="none" stroke="black" d="M1423.46,-34387.81C1421.93,-34379.25 1420.29,-34370.06 1418.72,-34361.24"/>
<polygon fill="black" stroke="black" points="1422.12,-34360.35 1416.91,-34351.12 1415.22,-34361.58 1422.12,-34360.35"/>
</g>
<!-- expert_0_5_down&#45;&gt;aggregate_0 -->
<g id="edge33" class="edge">
<title>expert_0_5_down&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M1351.18,-34282.74C1294.6,-34251.31 1207.04,-34202.66 1129.49,-34159.57"/>
<polygon fill="black" stroke="black" points="1131.01,-34156.41 1120.57,-34154.61 1127.61,-34162.53 1131.01,-34156.41"/>
</g>
<!-- expert_0_6_gelu -->
<g id="node30" class="node">
<title>expert_0_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1684" cy="-34425.46" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1684" y="-34436.76" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1684" y="-34421.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1684" y="-34406.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_6_up&#45;&gt;expert_0_6_gelu -->
<g id="edge35" class="edge">
<title>expert_0_6_up&#45;&gt;expert_0_6_gelu</title>
<path fill="none" stroke="black" d="M1672.29,-34499.83C1673.63,-34491.4 1675.1,-34482.18 1676.53,-34473.22"/>
<polygon fill="black" stroke="black" points="1680,-34473.68 1678.13,-34463.25 1673.09,-34472.58 1680,-34473.68"/>
</g>
<!-- expert_0_6_down -->
<g id="node31" class="node">
<title>expert_0_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1741.5,-34350.98 1588.5,-34350.98 1588.5,-34282.98 1741.5,-34282.98 1741.5,-34350.98"/>
<text text-anchor="middle" x="1665" y="-34335.78" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1665" y="-34320.78" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1665" y="-34305.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1665" y="-34290.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_6_gelu&#45;&gt;expert_0_6_down -->
<g id="edge36" class="edge">
<title>expert_0_6_gelu&#45;&gt;expert_0_6_down</title>
<path fill="none" stroke="black" d="M1677.46,-34387.81C1675.93,-34379.25 1674.29,-34370.06 1672.72,-34361.24"/>
<polygon fill="black" stroke="black" points="1676.12,-34360.35 1670.91,-34351.12 1669.22,-34361.58 1676.12,-34360.35"/>
</g>
<!-- expert_0_6_down&#45;&gt;aggregate_0 -->
<g id="edge37" class="edge">
<title>expert_0_6_down&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M1588.39,-34286.61C1577.86,-34282.66 1567.17,-34278.69 1557,-34274.98 1418.45,-34224.47 1260.83,-34169.47 1142.93,-34128.81"/>
<polygon fill="black" stroke="black" points="1144.04,-34125.49 1133.44,-34125.54 1141.76,-34132.11 1144.04,-34125.49"/>
</g>
<!-- expert_0_7_gelu -->
<g id="node33" class="node">
<title>expert_0_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1938" cy="-34425.46" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1938" y="-34436.76" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1938" y="-34421.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1938" y="-34406.76" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_7_up&#45;&gt;expert_0_7_gelu -->
<g id="edge39" class="edge">
<title>expert_0_7_up&#45;&gt;expert_0_7_gelu</title>
<path fill="none" stroke="black" d="M1926.29,-34499.83C1927.63,-34491.4 1929.1,-34482.18 1930.53,-34473.22"/>
<polygon fill="black" stroke="black" points="1934,-34473.68 1932.13,-34463.25 1927.09,-34472.58 1934,-34473.68"/>
</g>
<!-- expert_0_7_down -->
<g id="node34" class="node">
<title>expert_0_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1995.5,-34350.98 1842.5,-34350.98 1842.5,-34282.98 1995.5,-34282.98 1995.5,-34350.98"/>
<text text-anchor="middle" x="1919" y="-34335.78" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1919" y="-34320.78" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1919" y="-34305.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1919" y="-34290.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_0_7_gelu&#45;&gt;expert_0_7_down -->
<g id="edge40" class="edge">
<title>expert_0_7_gelu&#45;&gt;expert_0_7_down</title>
<path fill="none" stroke="black" d="M1931.46,-34387.81C1929.93,-34379.25 1928.29,-34370.06 1926.72,-34361.24"/>
<polygon fill="black" stroke="black" points="1930.12,-34360.35 1924.91,-34351.12 1923.22,-34361.58 1930.12,-34360.35"/>
</g>
<!-- expert_0_7_down&#45;&gt;aggregate_0 -->
<g id="edge41" class="edge">
<title>expert_0_7_down&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M1842.41,-34285.59C1831.93,-34281.81 1821.25,-34278.17 1811,-34274.98 1586.41,-34205.15 1322.47,-34143.7 1149.65,-34106.19"/>
<polygon fill="black" stroke="black" points="1150.21,-34102.72 1139.69,-34104.03 1148.73,-34109.57 1150.21,-34102.72"/>
</g>
<!-- residual_2_0 -->
<g id="node36" class="node">
<title>residual_2_0</title>
<ellipse fill="none" stroke="black" cx="964" cy="-33812.78" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="964" y="-33824.08" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="964" y="-33809.08" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="964" y="-33794.08" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- aggregate_0&#45;&gt;residual_2_0 -->
<g id="edge42" class="edge">
<title>aggregate_0&#45;&gt;residual_2_0</title>
<path fill="none" stroke="black" d="M964,-33886.96C964,-33877.68 964,-33868.86 964,-33860.77"/>
<polygon fill="black" stroke="black" points="967.5,-33860.58 964,-33850.58 960.5,-33860.58 967.5,-33860.58"/>
</g>
<!-- input_1 -->
<g id="node37" class="node">
<title>input_1</title>
<ellipse fill="none" stroke="black" cx="964" cy="-33629.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="964" y="-33641.13" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="964" y="-33626.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="964" y="-33611.13" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_0&#45;&gt;input_1 -->
<g id="edge673" class="edge">
<title>residual_2_0&#45;&gt;input_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M964,-33775.16C964,-33747.08 964,-33708.11 964,-33677.74"/>
<polygon fill="blue" stroke="blue" points="967.5,-33677.39 964,-33667.39 960.5,-33677.39 967.5,-33677.39"/>
<text text-anchor="middle" x="1044.5" y="-33740.1" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1044.5" y="-33725.1" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1044.5" y="-33710.1" font-family="Times,serif" font-size="14.00">GPU 0 &#45;&gt; GPU 1</text>
</g>
<!-- qkv_proj_1 -->
<g id="node38" class="node">
<title>qkv_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="1126,-33534.35 802,-33534.35 802,-33466.35 1126,-33466.35 1126,-33534.35"/>
<text text-anchor="middle" x="964" y="-33519.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="964" y="-33504.15" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="964" y="-33489.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="964" y="-33474.15" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- input_1&#45;&gt;qkv_proj_1 -->
<g id="edge43" class="edge">
<title>input_1&#45;&gt;qkv_proj_1</title>
<path fill="none" stroke="black" d="M964,-33592.3C964,-33577.47 964,-33560.23 964,-33544.77"/>
<polygon fill="black" stroke="black" points="967.5,-33544.4 964,-33534.4 960.5,-33544.4 967.5,-33544.4"/>
</g>
<!-- reshape_qkv_1 -->
<g id="node39" class="node">
<title>reshape_qkv_1</title>
<polygon fill="none" stroke="black" points="1318.64,-33429.35 754.49,-33429.35 609.36,-33323.35 1173.51,-33323.35 1318.64,-33429.35"/>
<text text-anchor="middle" x="964" y="-33387.65" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="964" y="-33372.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="964" y="-33357.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- qkv_proj_1&#45;&gt;reshape_qkv_1 -->
<g id="edge44" class="edge">
<title>qkv_proj_1&#45;&gt;reshape_qkv_1</title>
<path fill="none" stroke="black" d="M964,-33466.33C964,-33458.13 964,-33449.07 964,-33439.95"/>
<polygon fill="black" stroke="black" points="967.5,-33439.69 964,-33429.69 960.5,-33439.69 967.5,-33439.69"/>
</g>
<!-- attn_scores_1 -->
<g id="node40" class="node">
<title>attn_scores_1</title>
<polygon fill="none" stroke="black" points="964,-33286.35 784,-33233.35 964,-33180.35 1144,-33233.35 964,-33286.35"/>
<text text-anchor="middle" x="964" y="-33244.65" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="964" y="-33229.65" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="964" y="-33214.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- reshape_qkv_1&#45;&gt;attn_scores_1 -->
<g id="edge45" class="edge">
<title>reshape_qkv_1&#45;&gt;attn_scores_1</title>
<path fill="none" stroke="black" d="M964,-33323.25C964,-33314.68 964,-33305.72 964,-33296.92"/>
<polygon fill="black" stroke="black" points="967.5,-33296.71 964,-33286.71 960.5,-33296.71 967.5,-33296.71"/>
</g>
<!-- attn_weights_1 -->
<g id="node41" class="node">
<title>attn_weights_1</title>
<polygon fill="none" stroke="black" points="964,-33143.35 784,-33090.35 964,-33037.35 1144,-33090.35 964,-33143.35"/>
<text text-anchor="middle" x="964" y="-33101.65" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="964" y="-33086.65" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="964" y="-33071.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- attn_scores_1&#45;&gt;attn_weights_1 -->
<g id="edge46" class="edge">
<title>attn_scores_1&#45;&gt;attn_weights_1</title>
<path fill="none" stroke="black" d="M964,-33180.25C964,-33171.68 964,-33162.72 964,-33153.92"/>
<polygon fill="black" stroke="black" points="967.5,-33153.71 964,-33143.71 960.5,-33153.71 967.5,-33153.71"/>
</g>
<!-- attn_output_1 -->
<g id="node42" class="node">
<title>attn_output_1</title>
<polygon fill="none" stroke="black" points="964,-33000.35 793,-32947.35 964,-32894.35 1135,-32947.35 964,-33000.35"/>
<text text-anchor="middle" x="964" y="-32958.65" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="964" y="-32943.65" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="964" y="-32928.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- attn_weights_1&#45;&gt;attn_output_1 -->
<g id="edge47" class="edge">
<title>attn_weights_1&#45;&gt;attn_output_1</title>
<path fill="none" stroke="black" d="M964,-33037.25C964,-33028.68 964,-33019.72 964,-33010.92"/>
<polygon fill="black" stroke="black" points="967.5,-33010.71 964,-33000.71 960.5,-33010.71 967.5,-33010.71"/>
</g>
<!-- out_proj_1 -->
<g id="node43" class="node">
<title>out_proj_1</title>
<polygon fill="lightcoral" stroke="black" points="1040.5,-32857.35 887.5,-32857.35 887.5,-32789.35 1040.5,-32789.35 1040.5,-32857.35"/>
<text text-anchor="middle" x="964" y="-32842.15" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="964" y="-32827.15" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="964" y="-32812.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="964" y="-32797.15" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- attn_output_1&#45;&gt;out_proj_1 -->
<g id="edge48" class="edge">
<title>attn_output_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M964,-32894.26C964,-32885.42 964,-32876.32 964,-32867.74"/>
<polygon fill="black" stroke="black" points="967.5,-32867.57 964,-32857.57 960.5,-32867.57 967.5,-32867.57"/>
</g>
<!-- residual_1_1 -->
<g id="node44" class="node">
<title>residual_1_1</title>
<ellipse fill="none" stroke="black" cx="964" cy="-32714.87" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="964" y="-32726.17" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="964" y="-32711.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="964" y="-32696.17" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- out_proj_1&#45;&gt;residual_1_1 -->
<g id="edge49" class="edge">
<title>out_proj_1&#45;&gt;residual_1_1</title>
<path fill="none" stroke="black" d="M964,-32789.24C964,-32780.91 964,-32771.8 964,-32762.92"/>
<polygon fill="black" stroke="black" points="967.5,-32762.67 964,-32752.67 960.5,-32762.67 967.5,-32762.67"/>
</g>
<!-- gate_1 -->
<g id="node45" class="node">
<title>gate_1</title>
<polygon fill="lightpink" stroke="black" points="1199.3,-32576.12 1081.65,-32619.17 846.35,-32619.17 728.7,-32576.12 846.35,-32533.07 1081.65,-32533.07 1199.3,-32576.12"/>
<text text-anchor="middle" x="964" y="-32587.42" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="964" y="-32572.42" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="964" y="-32557.42" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- residual_1_1&#45;&gt;gate_1 -->
<g id="edge50" class="edge">
<title>residual_1_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M964,-32677.23C964,-32662.56 964,-32645.39 964,-32629.45"/>
<polygon fill="black" stroke="black" points="967.5,-32629.19 964,-32619.19 960.5,-32629.19 967.5,-32629.19"/>
</g>
<!-- selection_1 -->
<g id="node46" class="node">
<title>selection_1</title>
<polygon fill="none" stroke="black" points="964,-32495.85 762,-32442.85 964,-32389.85 1166,-32442.85 964,-32495.85"/>
<text text-anchor="middle" x="964" y="-32454.15" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="964" y="-32439.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="964" y="-32424.15" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- gate_1&#45;&gt;selection_1 -->
<g id="edge51" class="edge">
<title>gate_1&#45;&gt;selection_1</title>
<path fill="none" stroke="black" d="M964,-32532.86C964,-32524.37 964,-32515.27 964,-32506.26"/>
<polygon fill="black" stroke="black" points="967.5,-32506.15 964,-32496.15 960.5,-32506.15 967.5,-32506.15"/>
</g>
<!-- expert_1_0_up -->
<g id="node47" class="node">
<title>expert_1_0_up</title>
<polygon fill="lightgreen" stroke="black" points="266,-32317.85 104,-32317.85 104,-32249.85 266,-32249.85 266,-32317.85"/>
<text text-anchor="middle" x="185" y="-32302.65" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="185" y="-32287.65" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="185" y="-32272.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="185" y="-32257.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- selection_1&#45;&gt;expert_1_0_up -->
<g id="edge52" class="edge">
<title>selection_1&#45;&gt;expert_1_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M778.25,-32438.5C639.06,-32430.77 446.03,-32408.79 287,-32348.85 270.16,-32342.5 253.11,-32333.18 237.89,-32323.61"/>
<polygon fill="red" stroke="red" points="239.46,-32320.46 229.16,-32317.97 235.66,-32326.33 239.46,-32320.46"/>
<text text-anchor="middle" x="403.5" y="-32360.65" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_1_1_up -->
<g id="node50" class="node">
<title>expert_1_1_up</title>
<polygon fill="lightgreen" stroke="black" points="520,-32317.85 358,-32317.85 358,-32249.85 520,-32249.85 520,-32317.85"/>
<text text-anchor="middle" x="439" y="-32302.65" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="439" y="-32287.65" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="439" y="-32272.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="439" y="-32257.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- selection_1&#45;&gt;expert_1_1_up -->
<g id="edge56" class="edge">
<title>selection_1&#45;&gt;expert_1_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M830.9,-32424.61C745.78,-32410.7 634.25,-32387 541,-32348.85 524.58,-32342.13 507.84,-32332.84 492.8,-32323.41"/>
<polygon fill="red" stroke="red" points="494.46,-32320.32 484.15,-32317.86 490.68,-32326.21 494.46,-32320.32"/>
<text text-anchor="middle" x="660.5" y="-32360.65" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_1_2_up -->
<g id="node53" class="node">
<title>expert_1_2_up</title>
<polygon fill="lightgreen" stroke="black" points="775,-32317.85 613,-32317.85 613,-32249.85 775,-32249.85 775,-32317.85"/>
<text text-anchor="middle" x="694" y="-32302.65" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="694" y="-32287.65" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="694" y="-32272.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="694" y="-32257.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- selection_1&#45;&gt;expert_1_2_up -->
<g id="edge60" class="edge">
<title>selection_1&#45;&gt;expert_1_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M892.93,-32408.48C870.56,-32397.4 845.96,-32384.62 824,-32371.85 798.71,-32357.14 771.68,-32339.4 748.86,-32323.79"/>
<polygon fill="red" stroke="red" points="750.55,-32320.71 740.33,-32317.92 746.58,-32326.47 750.55,-32320.71"/>
<text text-anchor="middle" x="888.5" y="-32360.65" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_1_3_up -->
<g id="node56" class="node">
<title>expert_1_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1033,-32317.85 871,-32317.85 871,-32249.85 1033,-32249.85 1033,-32317.85"/>
<text text-anchor="middle" x="952" y="-32302.65" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="952" y="-32287.65" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="952" y="-32272.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="952" y="-32257.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- selection_1&#45;&gt;expert_1_3_up -->
<g id="edge64" class="edge">
<title>selection_1&#45;&gt;expert_1_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M960.07,-32390.44C958.53,-32370.28 956.78,-32347.39 955.31,-32328.1"/>
<polygon fill="red" stroke="red" points="958.79,-32327.78 954.54,-32318.08 951.81,-32328.32 958.79,-32327.78"/>
<text text-anchor="middle" x="1022.5" y="-32360.65" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_1_4_up -->
<g id="node59" class="node">
<title>expert_1_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1240,-32317.85 1078,-32317.85 1078,-32249.85 1240,-32249.85 1240,-32317.85"/>
<text text-anchor="middle" x="1159" y="-32302.65" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1159" y="-32287.65" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1159" y="-32272.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1159" y="-32257.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- selection_1&#45;&gt;expert_1_4_up -->
<g id="edge68" class="edge">
<title>selection_1&#45;&gt;expert_1_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1036.16,-32408.63C1055.01,-32398.25 1074.61,-32385.81 1091,-32371.85 1106.27,-32358.84 1120.41,-32341.93 1131.81,-32326.49"/>
<polygon fill="red" stroke="red" points="1134.85,-32328.25 1137.84,-32318.09 1129.16,-32324.17 1134.85,-32328.25"/>
<text text-anchor="middle" x="1170.5" y="-32360.65" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_1_5_up -->
<g id="node62" class="node">
<title>expert_1_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1494,-32317.85 1332,-32317.85 1332,-32249.85 1494,-32249.85 1494,-32317.85"/>
<text text-anchor="middle" x="1413" y="-32302.65" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1413" y="-32287.65" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1413" y="-32272.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1413" y="-32257.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- selection_1&#45;&gt;expert_1_5_up -->
<g id="edge72" class="edge">
<title>selection_1&#45;&gt;expert_1_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1080,-32420.18C1147.11,-32405.18 1232.05,-32381.9 1303,-32348.85 1319.16,-32341.32 1336.05,-32332.18 1351.62,-32323.2"/>
<polygon fill="red" stroke="red" points="1353.75,-32326.01 1360.61,-32317.94 1350.22,-32319.96 1353.75,-32326.01"/>
<text text-anchor="middle" x="1340.5" y="-32360.65" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_1_6_up -->
<g id="node65" class="node">
<title>expert_1_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1748,-32317.85 1586,-32317.85 1586,-32249.85 1748,-32249.85 1748,-32317.85"/>
<text text-anchor="middle" x="1667" y="-32302.65" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1667" y="-32287.65" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1667" y="-32272.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1667" y="-32257.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- selection_1&#45;&gt;expert_1_6_up -->
<g id="edge76" class="edge">
<title>selection_1&#45;&gt;expert_1_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1127.17,-32432.58C1248.59,-32421.81 1416.82,-32398.63 1557,-32348.85 1575.09,-32342.42 1593.58,-32332.98 1610.11,-32323.32"/>
<polygon fill="red" stroke="red" points="1612.29,-32326.09 1619.07,-32317.94 1608.7,-32320.08 1612.29,-32326.09"/>
<text text-anchor="middle" x="1590.5" y="-32360.65" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_1_7_up -->
<g id="node68" class="node">
<title>expert_1_7_up</title>
<polygon fill="lightgreen" stroke="black" points="2002,-32317.85 1840,-32317.85 1840,-32249.85 2002,-32249.85 2002,-32317.85"/>
<text text-anchor="middle" x="1921" y="-32302.65" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1921" y="-32287.65" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1921" y="-32272.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1921" y="-32257.65" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- selection_1&#45;&gt;expert_1_7_up -->
<g id="edge80" class="edge">
<title>selection_1&#45;&gt;expert_1_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1113.37,-32428.97C1254.28,-32416.31 1471.3,-32395.49 1659,-32371.85 1726.79,-32363.31 1746.55,-32371.54 1811,-32348.85 1829.11,-32342.47 1847.6,-32333.05 1864.13,-32323.38"/>
<polygon fill="red" stroke="red" points="1866.32,-32326.15 1873.09,-32318 1862.72,-32320.15 1866.32,-32326.15"/>
<text text-anchor="middle" x="1847.5" y="-32360.65" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_1_0_gelu -->
<g id="node48" class="node">
<title>expert_1_0_gelu</title>
<ellipse fill="none" stroke="black" cx="160" cy="-32175.37" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="160" y="-32186.67" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="160" y="-32171.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="160" y="-32156.67" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_0_up&#45;&gt;expert_1_0_gelu -->
<g id="edge53" class="edge">
<title>expert_1_0_up&#45;&gt;expert_1_0_gelu</title>
<path fill="none" stroke="black" d="M177.23,-32249.74C175.21,-32241.13 172.99,-32231.7 170.84,-32222.55"/>
<polygon fill="black" stroke="black" points="174.24,-32221.73 168.55,-32212.79 167.43,-32223.33 174.24,-32221.73"/>
</g>
<!-- expert_1_0_down -->
<g id="node49" class="node">
<title>expert_1_0_down</title>
<polygon fill="lightgreen" stroke="black" points="255.5,-32100.89 102.5,-32100.89 102.5,-32032.89 255.5,-32032.89 255.5,-32100.89"/>
<text text-anchor="middle" x="179" y="-32085.69" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="179" y="-32070.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="179" y="-32055.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="179" y="-32040.69" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_0_gelu&#45;&gt;expert_1_0_down -->
<g id="edge54" class="edge">
<title>expert_1_0_gelu&#45;&gt;expert_1_0_down</title>
<path fill="none" stroke="black" d="M166.54,-32137.73C168.07,-32129.17 169.71,-32119.97 171.28,-32111.15"/>
<polygon fill="black" stroke="black" points="174.78,-32111.49 173.09,-32101.03 167.88,-32110.26 174.78,-32111.49"/>
</g>
<!-- aggregate_1 -->
<g id="node71" class="node">
<title>aggregate_1</title>
<ellipse fill="lightyellow" stroke="black" cx="931" cy="-31816.53" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="931" cy="-31816.53" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="931" y="-31827.83" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="931" y="-31812.83" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="931" y="-31797.83" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_0_down&#45;&gt;aggregate_1 -->
<g id="edge55" class="edge">
<title>expert_1_0_down&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M255.52,-32036.29C266.07,-32032.37 276.78,-32028.48 287,-32024.89 442.31,-31970.45 620.54,-31913.48 750.07,-31873.06"/>
<polygon fill="black" stroke="black" points="751.19,-31876.38 759.7,-31870.06 749.11,-31869.7 751.19,-31876.38"/>
</g>
<!-- expert_1_1_gelu -->
<g id="node51" class="node">
<title>expert_1_1_gelu</title>
<ellipse fill="none" stroke="black" cx="414" cy="-32175.37" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="414" y="-32186.67" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="414" y="-32171.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="414" y="-32156.67" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_1_up&#45;&gt;expert_1_1_gelu -->
<g id="edge57" class="edge">
<title>expert_1_1_up&#45;&gt;expert_1_1_gelu</title>
<path fill="none" stroke="black" d="M431.23,-32249.74C429.21,-32241.13 426.99,-32231.7 424.84,-32222.55"/>
<polygon fill="black" stroke="black" points="428.24,-32221.73 422.55,-32212.79 421.43,-32223.33 428.24,-32221.73"/>
</g>
<!-- expert_1_1_down -->
<g id="node52" class="node">
<title>expert_1_1_down</title>
<polygon fill="lightgreen" stroke="black" points="509.5,-32100.89 356.5,-32100.89 356.5,-32032.89 509.5,-32032.89 509.5,-32100.89"/>
<text text-anchor="middle" x="433" y="-32085.69" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="433" y="-32070.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="433" y="-32055.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="433" y="-32040.69" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_1_gelu&#45;&gt;expert_1_1_down -->
<g id="edge58" class="edge">
<title>expert_1_1_gelu&#45;&gt;expert_1_1_down</title>
<path fill="none" stroke="black" d="M420.54,-32137.73C422.07,-32129.17 423.71,-32119.97 425.28,-32111.15"/>
<polygon fill="black" stroke="black" points="428.78,-32111.49 427.09,-32101.03 421.88,-32110.26 428.78,-32111.49"/>
</g>
<!-- expert_1_1_down&#45;&gt;aggregate_1 -->
<g id="edge59" class="edge">
<title>expert_1_1_down&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M499.39,-32032.79C566.08,-31999.52 671.6,-31946.9 761.6,-31902.01"/>
<polygon fill="black" stroke="black" points="763.43,-31905.01 770.82,-31897.42 760.31,-31898.75 763.43,-31905.01"/>
</g>
<!-- expert_1_2_gelu -->
<g id="node54" class="node">
<title>expert_1_2_gelu</title>
<ellipse fill="none" stroke="black" cx="668" cy="-32175.37" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="668" y="-32186.67" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="668" y="-32171.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="668" y="-32156.67" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_2_up&#45;&gt;expert_1_2_gelu -->
<g id="edge61" class="edge">
<title>expert_1_2_up&#45;&gt;expert_1_2_gelu</title>
<path fill="none" stroke="black" d="M685.92,-32249.74C683.81,-32241.13 681.51,-32231.7 679.28,-32222.55"/>
<polygon fill="black" stroke="black" points="682.67,-32221.68 676.89,-32212.79 675.87,-32223.34 682.67,-32221.68"/>
</g>
<!-- expert_1_2_down -->
<g id="node55" class="node">
<title>expert_1_2_down</title>
<polygon fill="lightgreen" stroke="black" points="772.5,-32100.89 619.5,-32100.89 619.5,-32032.89 772.5,-32032.89 772.5,-32100.89"/>
<text text-anchor="middle" x="696" y="-32085.69" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="696" y="-32070.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="696" y="-32055.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="696" y="-32040.69" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_2_gelu&#45;&gt;expert_1_2_down -->
<g id="edge62" class="edge">
<title>expert_1_2_gelu&#45;&gt;expert_1_2_down</title>
<path fill="none" stroke="black" d="M677.64,-32137.73C679.91,-32129.07 682.36,-32119.77 684.7,-32110.86"/>
<polygon fill="black" stroke="black" points="688.13,-32111.6 687.29,-32101.03 681.36,-32109.82 688.13,-32111.6"/>
</g>
<!-- expert_1_2_down&#45;&gt;aggregate_1 -->
<g id="edge63" class="edge">
<title>expert_1_2_down&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M727.45,-32032.66C746.99,-32012 773.57,-31983.92 801.06,-31954.86"/>
<polygon fill="black" stroke="black" points="803.73,-31957.13 808.06,-31947.46 798.65,-31952.32 803.73,-31957.13"/>
</g>
<!-- expert_1_3_gelu -->
<g id="node57" class="node">
<title>expert_1_3_gelu</title>
<ellipse fill="none" stroke="black" cx="922" cy="-32175.37" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="922" y="-32186.67" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="922" y="-32171.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="922" y="-32156.67" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_3_up&#45;&gt;expert_1_3_gelu -->
<g id="edge65" class="edge">
<title>expert_1_3_up&#45;&gt;expert_1_3_gelu</title>
<path fill="none" stroke="black" d="M942.67,-32249.74C940.25,-32241.13 937.59,-32231.7 935.01,-32222.55"/>
<polygon fill="black" stroke="black" points="938.34,-32221.47 932.26,-32212.79 931.6,-32223.37 938.34,-32221.47"/>
</g>
<!-- expert_1_3_down -->
<g id="node58" class="node">
<title>expert_1_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1001.5,-32100.89 848.5,-32100.89 848.5,-32032.89 1001.5,-32032.89 1001.5,-32100.89"/>
<text text-anchor="middle" x="925" y="-32085.69" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="925" y="-32070.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="925" y="-32055.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="925" y="-32040.69" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_3_gelu&#45;&gt;expert_1_3_down -->
<g id="edge66" class="edge">
<title>expert_1_3_gelu&#45;&gt;expert_1_3_down</title>
<path fill="none" stroke="black" d="M923.03,-32137.73C923.27,-32129.17 923.53,-32119.97 923.78,-32111.15"/>
<polygon fill="black" stroke="black" points="927.28,-32111.13 924.07,-32101.03 920.29,-32110.93 927.28,-32111.13"/>
</g>
<!-- expert_1_3_down&#45;&gt;aggregate_1 -->
<g id="edge67" class="edge">
<title>expert_1_3_down&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M925.8,-32032.66C925.99,-32024.81 926.21,-32015.89 926.44,-32006.25"/>
<polygon fill="black" stroke="black" points="929.95,-32006.04 926.69,-31995.96 922.95,-32005.87 929.95,-32006.04"/>
</g>
<!-- expert_1_4_gelu -->
<g id="node60" class="node">
<title>expert_1_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1176" cy="-32175.37" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1176" y="-32186.67" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1176" y="-32171.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1176" y="-32156.67" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_4_up&#45;&gt;expert_1_4_gelu -->
<g id="edge69" class="edge">
<title>expert_1_4_up&#45;&gt;expert_1_4_gelu</title>
<path fill="none" stroke="black" d="M1164.29,-32249.74C1165.63,-32241.31 1167.1,-32232.1 1168.53,-32223.13"/>
<polygon fill="black" stroke="black" points="1172,-32223.59 1170.13,-32213.17 1165.09,-32222.49 1172,-32223.59"/>
</g>
<!-- expert_1_4_down -->
<g id="node61" class="node">
<title>expert_1_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1233.5,-32100.89 1080.5,-32100.89 1080.5,-32032.89 1233.5,-32032.89 1233.5,-32100.89"/>
<text text-anchor="middle" x="1157" y="-32085.69" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1157" y="-32070.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1157" y="-32055.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1157" y="-32040.69" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_4_gelu&#45;&gt;expert_1_4_down -->
<g id="edge70" class="edge">
<title>expert_1_4_gelu&#45;&gt;expert_1_4_down</title>
<path fill="none" stroke="black" d="M1169.46,-32137.73C1167.93,-32129.17 1166.29,-32119.97 1164.72,-32111.15"/>
<polygon fill="black" stroke="black" points="1168.12,-32110.26 1162.91,-32101.03 1161.22,-32111.49 1168.12,-32110.26"/>
</g>
<!-- expert_1_4_down&#45;&gt;aggregate_1 -->
<g id="edge71" class="edge">
<title>expert_1_4_down&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1126.76,-32032.66C1108.48,-32012.58 1083.82,-31985.47 1058.16,-31957.28"/>
<polygon fill="black" stroke="black" points="1060.59,-31954.74 1051.27,-31949.7 1055.41,-31959.45 1060.59,-31954.74"/>
</g>
<!-- expert_1_5_gelu -->
<g id="node63" class="node">
<title>expert_1_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1430" cy="-32175.37" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1430" y="-32186.67" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1430" y="-32171.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1430" y="-32156.67" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_5_up&#45;&gt;expert_1_5_gelu -->
<g id="edge73" class="edge">
<title>expert_1_5_up&#45;&gt;expert_1_5_gelu</title>
<path fill="none" stroke="black" d="M1418.29,-32249.74C1419.63,-32241.31 1421.1,-32232.1 1422.53,-32223.13"/>
<polygon fill="black" stroke="black" points="1426,-32223.59 1424.13,-32213.17 1419.09,-32222.49 1426,-32223.59"/>
</g>
<!-- expert_1_5_down -->
<g id="node64" class="node">
<title>expert_1_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1487.5,-32100.89 1334.5,-32100.89 1334.5,-32032.89 1487.5,-32032.89 1487.5,-32100.89"/>
<text text-anchor="middle" x="1411" y="-32085.69" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1411" y="-32070.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1411" y="-32055.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1411" y="-32040.69" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_5_gelu&#45;&gt;expert_1_5_down -->
<g id="edge74" class="edge">
<title>expert_1_5_gelu&#45;&gt;expert_1_5_down</title>
<path fill="none" stroke="black" d="M1423.46,-32137.73C1421.93,-32129.17 1420.29,-32119.97 1418.72,-32111.15"/>
<polygon fill="black" stroke="black" points="1422.12,-32110.26 1416.91,-32101.03 1415.22,-32111.49 1422.12,-32110.26"/>
</g>
<!-- expert_1_5_down&#45;&gt;aggregate_1 -->
<g id="edge75" class="edge">
<title>expert_1_5_down&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1346.76,-32032.66C1283.66,-32000.01 1184.68,-31948.79 1099.12,-31904.52"/>
<polygon fill="black" stroke="black" points="1100.58,-31901.34 1090.09,-31899.85 1097.36,-31907.55 1100.58,-31901.34"/>
</g>
<!-- expert_1_6_gelu -->
<g id="node66" class="node">
<title>expert_1_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1684" cy="-32175.37" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1684" y="-32186.67" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1684" y="-32171.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1684" y="-32156.67" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_6_up&#45;&gt;expert_1_6_gelu -->
<g id="edge77" class="edge">
<title>expert_1_6_up&#45;&gt;expert_1_6_gelu</title>
<path fill="none" stroke="black" d="M1672.29,-32249.74C1673.63,-32241.31 1675.1,-32232.1 1676.53,-32223.13"/>
<polygon fill="black" stroke="black" points="1680,-32223.59 1678.13,-32213.17 1673.09,-32222.49 1680,-32223.59"/>
</g>
<!-- expert_1_6_down -->
<g id="node67" class="node">
<title>expert_1_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1741.5,-32100.89 1588.5,-32100.89 1588.5,-32032.89 1741.5,-32032.89 1741.5,-32100.89"/>
<text text-anchor="middle" x="1665" y="-32085.69" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1665" y="-32070.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1665" y="-32055.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1665" y="-32040.69" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_6_gelu&#45;&gt;expert_1_6_down -->
<g id="edge78" class="edge">
<title>expert_1_6_gelu&#45;&gt;expert_1_6_down</title>
<path fill="none" stroke="black" d="M1677.46,-32137.73C1675.93,-32129.17 1674.29,-32119.97 1672.72,-32111.15"/>
<polygon fill="black" stroke="black" points="1676.12,-32110.26 1670.91,-32101.03 1669.22,-32111.49 1676.12,-32110.26"/>
</g>
<!-- expert_1_6_down&#45;&gt;aggregate_1 -->
<g id="edge79" class="edge">
<title>expert_1_6_down&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1588.45,-32036.37C1577.91,-32032.44 1567.21,-32028.52 1557,-32024.89 1407.7,-31971.85 1236.87,-31915.56 1111.43,-31875.03"/>
<polygon fill="black" stroke="black" points="1112.31,-31871.64 1101.72,-31871.89 1110.16,-31878.3 1112.31,-31871.64"/>
</g>
<!-- expert_1_7_gelu -->
<g id="node69" class="node">
<title>expert_1_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1938" cy="-32175.37" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1938" y="-32186.67" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1938" y="-32171.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1938" y="-32156.67" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_7_up&#45;&gt;expert_1_7_gelu -->
<g id="edge81" class="edge">
<title>expert_1_7_up&#45;&gt;expert_1_7_gelu</title>
<path fill="none" stroke="black" d="M1926.29,-32249.74C1927.63,-32241.31 1929.1,-32232.1 1930.53,-32223.13"/>
<polygon fill="black" stroke="black" points="1934,-32223.59 1932.13,-32213.17 1927.09,-32222.49 1934,-32223.59"/>
</g>
<!-- expert_1_7_down -->
<g id="node70" class="node">
<title>expert_1_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1995.5,-32100.89 1842.5,-32100.89 1842.5,-32032.89 1995.5,-32032.89 1995.5,-32100.89"/>
<text text-anchor="middle" x="1919" y="-32085.69" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1919" y="-32070.69" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1919" y="-32055.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1919" y="-32040.69" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_1_7_gelu&#45;&gt;expert_1_7_down -->
<g id="edge82" class="edge">
<title>expert_1_7_gelu&#45;&gt;expert_1_7_down</title>
<path fill="none" stroke="black" d="M1931.46,-32137.73C1929.93,-32129.17 1928.29,-32119.97 1926.72,-32111.15"/>
<polygon fill="black" stroke="black" points="1930.12,-32110.26 1924.91,-32101.03 1923.22,-32111.49 1930.12,-32110.26"/>
</g>
<!-- expert_1_7_down&#45;&gt;aggregate_1 -->
<g id="edge83" class="edge">
<title>expert_1_7_down&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1842.44,-32035.41C1831.95,-32031.65 1821.26,-32028.04 1811,-32024.89 1574.65,-31952.53 1296.08,-31890.73 1116.67,-31853.88"/>
<polygon fill="black" stroke="black" points="1117.37,-31850.45 1106.87,-31851.87 1115.97,-31857.3 1117.37,-31850.45"/>
</g>
<!-- residual_2_1 -->
<g id="node72" class="node">
<title>residual_2_1</title>
<ellipse fill="none" stroke="black" cx="931" cy="-31562.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="931" y="-31573.99" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="931" y="-31558.99" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="931" y="-31543.99" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- aggregate_1&#45;&gt;residual_2_1 -->
<g id="edge84" class="edge">
<title>aggregate_1&#45;&gt;residual_2_1</title>
<path fill="none" stroke="black" d="M931,-31636.87C931,-31627.59 931,-31618.77 931,-31610.68"/>
<polygon fill="black" stroke="black" points="934.5,-31610.49 931,-31600.49 927.5,-31610.49 934.5,-31610.49"/>
</g>
<!-- input_2 -->
<g id="node73" class="node">
<title>input_2</title>
<ellipse fill="none" stroke="black" cx="931" cy="-31379.74" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="931" y="-31391.04" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="931" y="-31376.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="931" y="-31361.04" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_1&#45;&gt;input_2 -->
<g id="edge674" class="edge">
<title>residual_2_1&#45;&gt;input_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M931,-31525.07C931,-31496.99 931,-31458.02 931,-31427.65"/>
<polygon fill="blue" stroke="blue" points="934.5,-31427.3 931,-31417.3 927.5,-31427.3 934.5,-31427.3"/>
<text text-anchor="middle" x="1011.5" y="-31490.02" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1011.5" y="-31475.02" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1011.5" y="-31460.02" font-family="Times,serif" font-size="14.00">GPU 1 &#45;&gt; GPU 2</text>
</g>
<!-- qkv_proj_2 -->
<g id="node74" class="node">
<title>qkv_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="1093,-31284.26 769,-31284.26 769,-31216.26 1093,-31216.26 1093,-31284.26"/>
<text text-anchor="middle" x="931" y="-31269.06" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="931" y="-31254.06" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="931" y="-31239.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="931" y="-31224.06" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- input_2&#45;&gt;qkv_proj_2 -->
<g id="edge85" class="edge">
<title>input_2&#45;&gt;qkv_proj_2</title>
<path fill="none" stroke="black" d="M931,-31342.21C931,-31327.39 931,-31310.14 931,-31294.68"/>
<polygon fill="black" stroke="black" points="934.5,-31294.31 931,-31284.31 927.5,-31294.31 934.5,-31294.31"/>
</g>
<!-- reshape_qkv_2 -->
<g id="node75" class="node">
<title>reshape_qkv_2</title>
<polygon fill="none" stroke="black" points="1285.64,-31179.26 721.49,-31179.26 576.36,-31073.26 1140.51,-31073.26 1285.64,-31179.26"/>
<text text-anchor="middle" x="931" y="-31137.56" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="931" y="-31122.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="931" y="-31107.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- qkv_proj_2&#45;&gt;reshape_qkv_2 -->
<g id="edge86" class="edge">
<title>qkv_proj_2&#45;&gt;reshape_qkv_2</title>
<path fill="none" stroke="black" d="M931,-31216.25C931,-31208.04 931,-31198.98 931,-31189.87"/>
<polygon fill="black" stroke="black" points="934.5,-31189.6 931,-31179.6 927.5,-31189.6 934.5,-31189.6"/>
</g>
<!-- attn_scores_2 -->
<g id="node76" class="node">
<title>attn_scores_2</title>
<polygon fill="none" stroke="black" points="931,-31036.26 751,-30983.26 931,-30930.26 1111,-30983.26 931,-31036.26"/>
<text text-anchor="middle" x="931" y="-30994.56" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="931" y="-30979.56" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="931" y="-30964.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- reshape_qkv_2&#45;&gt;attn_scores_2 -->
<g id="edge87" class="edge">
<title>reshape_qkv_2&#45;&gt;attn_scores_2</title>
<path fill="none" stroke="black" d="M931,-31073.16C931,-31064.59 931,-31055.63 931,-31046.84"/>
<polygon fill="black" stroke="black" points="934.5,-31046.62 931,-31036.62 927.5,-31046.62 934.5,-31046.62"/>
</g>
<!-- attn_weights_2 -->
<g id="node77" class="node">
<title>attn_weights_2</title>
<polygon fill="none" stroke="black" points="931,-30893.26 751,-30840.26 931,-30787.26 1111,-30840.26 931,-30893.26"/>
<text text-anchor="middle" x="931" y="-30851.56" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="931" y="-30836.56" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="931" y="-30821.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- attn_scores_2&#45;&gt;attn_weights_2 -->
<g id="edge88" class="edge">
<title>attn_scores_2&#45;&gt;attn_weights_2</title>
<path fill="none" stroke="black" d="M931,-30930.16C931,-30921.59 931,-30912.63 931,-30903.84"/>
<polygon fill="black" stroke="black" points="934.5,-30903.62 931,-30893.62 927.5,-30903.62 934.5,-30903.62"/>
</g>
<!-- attn_output_2 -->
<g id="node78" class="node">
<title>attn_output_2</title>
<polygon fill="none" stroke="black" points="931,-30750.26 760,-30697.26 931,-30644.26 1102,-30697.26 931,-30750.26"/>
<text text-anchor="middle" x="931" y="-30708.56" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="931" y="-30693.56" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="931" y="-30678.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- attn_weights_2&#45;&gt;attn_output_2 -->
<g id="edge89" class="edge">
<title>attn_weights_2&#45;&gt;attn_output_2</title>
<path fill="none" stroke="black" d="M931,-30787.16C931,-30778.59 931,-30769.63 931,-30760.84"/>
<polygon fill="black" stroke="black" points="934.5,-30760.62 931,-30750.62 927.5,-30760.62 934.5,-30760.62"/>
</g>
<!-- out_proj_2 -->
<g id="node79" class="node">
<title>out_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="1007.5,-30607.26 854.5,-30607.26 854.5,-30539.26 1007.5,-30539.26 1007.5,-30607.26"/>
<text text-anchor="middle" x="931" y="-30592.06" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="931" y="-30577.06" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="931" y="-30562.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="931" y="-30547.06" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- attn_output_2&#45;&gt;out_proj_2 -->
<g id="edge90" class="edge">
<title>attn_output_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M931,-30644.17C931,-30635.33 931,-30626.23 931,-30617.65"/>
<polygon fill="black" stroke="black" points="934.5,-30617.48 931,-30607.48 927.5,-30617.48 934.5,-30617.48"/>
</g>
<!-- residual_1_2 -->
<g id="node80" class="node">
<title>residual_1_2</title>
<ellipse fill="none" stroke="black" cx="931" cy="-30464.79" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="931" y="-30476.09" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="931" y="-30461.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="931" y="-30446.09" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- out_proj_2&#45;&gt;residual_1_2 -->
<g id="edge91" class="edge">
<title>out_proj_2&#45;&gt;residual_1_2</title>
<path fill="none" stroke="black" d="M931,-30539.16C931,-30530.82 931,-30521.71 931,-30512.83"/>
<polygon fill="black" stroke="black" points="934.5,-30512.58 931,-30502.58 927.5,-30512.58 934.5,-30512.58"/>
</g>
<!-- gate_2 -->
<g id="node81" class="node">
<title>gate_2</title>
<polygon fill="lightpink" stroke="black" points="1166.3,-30326.04 1048.65,-30369.09 813.35,-30369.09 695.7,-30326.04 813.35,-30282.99 1048.65,-30282.99 1166.3,-30326.04"/>
<text text-anchor="middle" x="931" y="-30337.34" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="931" y="-30322.34" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="931" y="-30307.34" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- residual_1_2&#45;&gt;gate_2 -->
<g id="edge92" class="edge">
<title>residual_1_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M931,-30427.14C931,-30412.47 931,-30395.3 931,-30379.36"/>
<polygon fill="black" stroke="black" points="934.5,-30379.11 931,-30369.11 927.5,-30379.11 934.5,-30379.11"/>
</g>
<!-- selection_2 -->
<g id="node82" class="node">
<title>selection_2</title>
<polygon fill="none" stroke="black" points="931,-30245.76 729,-30192.76 931,-30139.76 1133,-30192.76 931,-30245.76"/>
<text text-anchor="middle" x="931" y="-30204.06" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="931" y="-30189.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="931" y="-30174.06" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- gate_2&#45;&gt;selection_2 -->
<g id="edge93" class="edge">
<title>gate_2&#45;&gt;selection_2</title>
<path fill="none" stroke="black" d="M931,-30282.78C931,-30274.28 931,-30265.18 931,-30256.17"/>
<polygon fill="black" stroke="black" points="934.5,-30256.06 931,-30246.06 927.5,-30256.06 934.5,-30256.06"/>
</g>
<!-- expert_2_0_up -->
<g id="node83" class="node">
<title>expert_2_0_up</title>
<polygon fill="lightgreen" stroke="black" points="264,-30067.76 102,-30067.76 102,-29999.76 264,-29999.76 264,-30067.76"/>
<text text-anchor="middle" x="183" y="-30052.56" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="183" y="-30037.56" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="183" y="-30022.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="183" y="-30007.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- selection_2&#45;&gt;expert_2_0_up -->
<g id="edge94" class="edge">
<title>selection_2&#45;&gt;expert_2_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M751.73,-30186.76C619.11,-30178.15 436.06,-30155.8 285,-30098.76 268.16,-30092.4 251.11,-30083.08 235.9,-30073.51"/>
<polygon fill="red" stroke="red" points="237.46,-30070.36 227.16,-30067.87 233.66,-30076.23 237.46,-30070.36"/>
<text text-anchor="middle" x="415.5" y="-30110.56" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_2_1_up -->
<g id="node86" class="node">
<title>expert_2_1_up</title>
<polygon fill="lightgreen" stroke="black" points="518,-30067.76 356,-30067.76 356,-29999.76 518,-29999.76 518,-30067.76"/>
<text text-anchor="middle" x="437" y="-30052.56" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="437" y="-30037.56" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="437" y="-30022.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="437" y="-30007.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- selection_2&#45;&gt;expert_2_1_up -->
<g id="edge98" class="edge">
<title>selection_2&#45;&gt;expert_2_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M805.01,-30172.71C726.49,-30158.22 624.48,-30134.56 539,-30098.76 522.72,-30091.94 506.08,-30082.66 491.1,-30073.28"/>
<polygon fill="red" stroke="red" points="492.79,-30070.21 482.48,-30067.76 489.01,-30076.1 492.79,-30070.21"/>
<text text-anchor="middle" x="664.5" y="-30110.56" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_2_2_up -->
<g id="node89" class="node">
<title>expert_2_2_up</title>
<polygon fill="lightgreen" stroke="black" points="773,-30067.76 611,-30067.76 611,-29999.76 773,-29999.76 773,-30067.76"/>
<text text-anchor="middle" x="692" y="-30052.56" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="692" y="-30037.56" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="692" y="-30022.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="692" y="-30007.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- selection_2&#45;&gt;expert_2_2_up -->
<g id="edge102" class="edge">
<title>selection_2&#45;&gt;expert_2_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M859.04,-30158.54C837.84,-30147.75 814.99,-30135.1 795,-30121.76 774.23,-30107.9 752.89,-30090.49 735.05,-30074.89"/>
<polygon fill="red" stroke="red" points="736.93,-30071.88 727.12,-30067.87 732.29,-30077.12 736.93,-30071.88"/>
<text text-anchor="middle" x="859.5" y="-30110.56" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_2_3_up -->
<g id="node92" class="node">
<title>expert_2_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1007,-30067.76 845,-30067.76 845,-29999.76 1007,-29999.76 1007,-30067.76"/>
<text text-anchor="middle" x="926" y="-30052.56" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="926" y="-30037.56" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="926" y="-30022.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="926" y="-30007.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- selection_2&#45;&gt;expert_2_3_up -->
<g id="edge106" class="edge">
<title>selection_2&#45;&gt;expert_2_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M929.35,-30139.92C928.71,-30119.87 927.99,-30097.19 927.38,-30078.04"/>
<polygon fill="red" stroke="red" points="930.87,-30077.69 927.05,-30067.81 923.87,-30077.91 930.87,-30077.69"/>
<text text-anchor="middle" x="992.5" y="-30110.56" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_2_4_up -->
<g id="node95" class="node">
<title>expert_2_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1238,-30067.76 1076,-30067.76 1076,-29999.76 1238,-29999.76 1238,-30067.76"/>
<text text-anchor="middle" x="1157" y="-30052.56" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1157" y="-30037.56" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1157" y="-30022.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1157" y="-30007.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- selection_2&#45;&gt;expert_2_4_up -->
<g id="edge110" class="edge">
<title>selection_2&#45;&gt;expert_2_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1001,-30158.07C1020.98,-30147.4 1042.37,-30134.93 1061,-30121.76 1080.59,-30107.92 1100.53,-30090.51 1117.11,-30074.9"/>
<polygon fill="red" stroke="red" points="1119.66,-30077.31 1124.49,-30067.88 1114.83,-30072.24 1119.66,-30077.31"/>
<text text-anchor="middle" x="1144.5" y="-30110.56" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_2_5_up -->
<g id="node98" class="node">
<title>expert_2_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1492,-30067.76 1330,-30067.76 1330,-29999.76 1492,-29999.76 1492,-30067.76"/>
<text text-anchor="middle" x="1411" y="-30052.56" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1411" y="-30037.56" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1411" y="-30022.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1411" y="-30007.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- selection_2&#45;&gt;expert_2_5_up -->
<g id="edge114" class="edge">
<title>selection_2&#45;&gt;expert_2_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1050.44,-30170.91C1124.33,-30155.79 1220.18,-30132.11 1301,-30098.76 1318.15,-30091.69 1335.88,-30082.37 1351.96,-30073.04"/>
<polygon fill="red" stroke="red" points="1353.89,-30075.97 1360.72,-30067.87 1350.33,-30069.94 1353.89,-30075.97"/>
<text text-anchor="middle" x="1336.5" y="-30110.56" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_2_6_up -->
<g id="node101" class="node">
<title>expert_2_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1746,-30067.76 1584,-30067.76 1584,-29999.76 1746,-29999.76 1746,-30067.76"/>
<text text-anchor="middle" x="1665" y="-30052.56" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1665" y="-30037.56" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1665" y="-30022.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1665" y="-30007.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- selection_2&#45;&gt;expert_2_6_up -->
<g id="edge118" class="edge">
<title>selection_2&#45;&gt;expert_2_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1100.08,-30184.05C1228.06,-30174.07 1406.54,-30151.2 1555,-30098.76 1573.11,-30092.37 1591.59,-30082.94 1608.12,-30073.27"/>
<polygon fill="red" stroke="red" points="1610.31,-30076.04 1617.09,-30067.89 1606.71,-30070.04 1610.31,-30076.04"/>
<text text-anchor="middle" x="1586.5" y="-30110.56" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_2_7_up -->
<g id="node104" class="node">
<title>expert_2_7_up</title>
<polygon fill="lightgreen" stroke="black" points="2000,-30067.76 1838,-30067.76 1838,-29999.76 2000,-29999.76 2000,-30067.76"/>
<text text-anchor="middle" x="1919" y="-30052.56" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1919" y="-30037.56" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1919" y="-30022.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1919" y="-30007.56" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- selection_2&#45;&gt;expert_2_7_up -->
<g id="edge122" class="edge">
<title>selection_2&#45;&gt;expert_2_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1082.4,-30179.42C1229.05,-30166.93 1457.59,-30146.03 1655,-30121.76 1723.69,-30113.32 1743.7,-30121.68 1809,-30098.76 1827.21,-30092.37 1845.79,-30082.89 1862.38,-30073.18"/>
<polygon fill="red" stroke="red" points="1864.6,-30075.92 1871.37,-30067.77 1861,-30069.92 1864.6,-30075.92"/>
<text text-anchor="middle" x="1844.5" y="-30110.56" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_2_0_gelu -->
<g id="node84" class="node">
<title>expert_2_0_gelu</title>
<ellipse fill="none" stroke="black" cx="158" cy="-29925.28" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="158" y="-29936.58" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="158" y="-29921.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="158" y="-29906.58" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_0_up&#45;&gt;expert_2_0_gelu -->
<g id="edge95" class="edge">
<title>expert_2_0_up&#45;&gt;expert_2_0_gelu</title>
<path fill="none" stroke="black" d="M175.23,-29999.65C173.21,-29991.05 170.99,-29981.62 168.84,-29972.47"/>
<polygon fill="black" stroke="black" points="172.24,-29971.64 166.55,-29962.7 165.43,-29973.24 172.24,-29971.64"/>
</g>
<!-- expert_2_0_down -->
<g id="node85" class="node">
<title>expert_2_0_down</title>
<polygon fill="lightgreen" stroke="black" points="253.5,-29850.81 100.5,-29850.81 100.5,-29782.81 253.5,-29782.81 253.5,-29850.81"/>
<text text-anchor="middle" x="177" y="-29835.61" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="177" y="-29820.61" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="177" y="-29805.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="177" y="-29790.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_0_gelu&#45;&gt;expert_2_0_down -->
<g id="edge96" class="edge">
<title>expert_2_0_gelu&#45;&gt;expert_2_0_down</title>
<path fill="none" stroke="black" d="M164.54,-29887.64C166.07,-29879.08 167.71,-29869.88 169.28,-29861.06"/>
<polygon fill="black" stroke="black" points="172.78,-29861.41 171.09,-29850.95 165.88,-29860.18 172.78,-29861.41"/>
</g>
<!-- aggregate_2 -->
<g id="node107" class="node">
<title>aggregate_2</title>
<ellipse fill="lightyellow" stroke="black" cx="1049" cy="-29566.45" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="1049" cy="-29566.45" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="1049" y="-29577.75" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="1049" y="-29562.75" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1049" y="-29547.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_0_down&#45;&gt;aggregate_2 -->
<g id="edge97" class="edge">
<title>expert_2_0_down&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M253.66,-29785.65C264.14,-29781.84 274.79,-29778.12 285,-29774.81 480.71,-29711.27 708.8,-29651.13 864.47,-29612.14"/>
<polygon fill="black" stroke="black" points="865.77,-29615.42 874.62,-29609.6 864.07,-29608.63 865.77,-29615.42"/>
</g>
<!-- expert_2_1_gelu -->
<g id="node87" class="node">
<title>expert_2_1_gelu</title>
<ellipse fill="none" stroke="black" cx="412" cy="-29925.28" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="412" y="-29936.58" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="412" y="-29921.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="412" y="-29906.58" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_1_up&#45;&gt;expert_2_1_gelu -->
<g id="edge99" class="edge">
<title>expert_2_1_up&#45;&gt;expert_2_1_gelu</title>
<path fill="none" stroke="black" d="M429.23,-29999.65C427.21,-29991.05 424.99,-29981.62 422.84,-29972.47"/>
<polygon fill="black" stroke="black" points="426.24,-29971.64 420.55,-29962.7 419.43,-29973.24 426.24,-29971.64"/>
</g>
<!-- expert_2_1_down -->
<g id="node88" class="node">
<title>expert_2_1_down</title>
<polygon fill="lightgreen" stroke="black" points="507.5,-29850.81 354.5,-29850.81 354.5,-29782.81 507.5,-29782.81 507.5,-29850.81"/>
<text text-anchor="middle" x="431" y="-29835.61" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="431" y="-29820.61" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="431" y="-29805.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="431" y="-29790.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_1_gelu&#45;&gt;expert_2_1_down -->
<g id="edge100" class="edge">
<title>expert_2_1_gelu&#45;&gt;expert_2_1_down</title>
<path fill="none" stroke="black" d="M418.54,-29887.64C420.07,-29879.08 421.71,-29869.88 423.28,-29861.06"/>
<polygon fill="black" stroke="black" points="426.78,-29861.41 425.09,-29850.95 419.88,-29860.18 426.78,-29861.41"/>
</g>
<!-- expert_2_1_down&#45;&gt;aggregate_2 -->
<g id="edge101" class="edge">
<title>expert_2_1_down&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M507.71,-29784.98C598.52,-29748.48 752.64,-29686.55 873.26,-29638.07"/>
<polygon fill="black" stroke="black" points="874.64,-29641.29 882.61,-29634.31 872.03,-29634.79 874.64,-29641.29"/>
</g>
<!-- expert_2_2_gelu -->
<g id="node90" class="node">
<title>expert_2_2_gelu</title>
<ellipse fill="none" stroke="black" cx="666" cy="-29925.28" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="666" y="-29936.58" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="666" y="-29921.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="666" y="-29906.58" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_2_up&#45;&gt;expert_2_2_gelu -->
<g id="edge103" class="edge">
<title>expert_2_2_up&#45;&gt;expert_2_2_gelu</title>
<path fill="none" stroke="black" d="M683.92,-29999.65C681.81,-29991.05 679.51,-29981.62 677.28,-29972.47"/>
<polygon fill="black" stroke="black" points="680.67,-29971.59 674.89,-29962.7 673.87,-29973.25 680.67,-29971.59"/>
</g>
<!-- expert_2_2_down -->
<g id="node91" class="node">
<title>expert_2_2_down</title>
<polygon fill="lightgreen" stroke="black" points="770.5,-29850.81 617.5,-29850.81 617.5,-29782.81 770.5,-29782.81 770.5,-29850.81"/>
<text text-anchor="middle" x="694" y="-29835.61" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="694" y="-29820.61" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="694" y="-29805.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="694" y="-29790.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_2_gelu&#45;&gt;expert_2_2_down -->
<g id="edge104" class="edge">
<title>expert_2_2_gelu&#45;&gt;expert_2_2_down</title>
<path fill="none" stroke="black" d="M675.64,-29887.64C677.91,-29878.99 680.36,-29869.68 682.7,-29860.78"/>
<polygon fill="black" stroke="black" points="686.13,-29861.51 685.29,-29850.95 679.36,-29859.73 686.13,-29861.51"/>
</g>
<!-- expert_2_2_down&#45;&gt;aggregate_2 -->
<g id="edge105" class="edge">
<title>expert_2_2_down&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M741.51,-29782.57C780.77,-29755.1 838.83,-29714.48 893.95,-29675.92"/>
<polygon fill="black" stroke="black" points="896.22,-29678.6 902.41,-29670 892.21,-29672.87 896.22,-29678.6"/>
</g>
<!-- expert_2_3_gelu -->
<g id="node93" class="node">
<title>expert_2_3_gelu</title>
<ellipse fill="none" stroke="black" cx="920" cy="-29925.28" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="920" y="-29936.58" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="920" y="-29921.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="920" y="-29906.58" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_3_up&#45;&gt;expert_2_3_gelu -->
<g id="edge107" class="edge">
<title>expert_2_3_up&#45;&gt;expert_2_3_gelu</title>
<path fill="none" stroke="black" d="M924.13,-29999.65C923.66,-29991.32 923.15,-29982.21 922.65,-29973.33"/>
<polygon fill="black" stroke="black" points="926.13,-29972.87 922.07,-29963.08 919.14,-29973.26 926.13,-29972.87"/>
</g>
<!-- expert_2_3_down -->
<g id="node94" class="node">
<title>expert_2_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1018.5,-29850.81 865.5,-29850.81 865.5,-29782.81 1018.5,-29782.81 1018.5,-29850.81"/>
<text text-anchor="middle" x="942" y="-29835.61" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="942" y="-29820.61" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="942" y="-29805.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="942" y="-29790.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_3_gelu&#45;&gt;expert_2_3_down -->
<g id="edge108" class="edge">
<title>expert_2_3_gelu&#45;&gt;expert_2_3_down</title>
<path fill="none" stroke="black" d="M927.57,-29887.64C929.36,-29878.99 931.28,-29869.68 933.12,-29860.78"/>
<polygon fill="black" stroke="black" points="936.56,-29861.45 935.15,-29850.95 929.7,-29860.03 936.56,-29861.45"/>
</g>
<!-- expert_2_3_down&#45;&gt;aggregate_2 -->
<g id="edge109" class="edge">
<title>expert_2_3_down&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M956.32,-29782.57C961.44,-29770.69 967.61,-29756.36 974.32,-29740.79"/>
<polygon fill="black" stroke="black" points="977.58,-29742.06 978.32,-29731.5 971.15,-29739.29 977.58,-29742.06"/>
</g>
<!-- expert_2_4_gelu -->
<g id="node96" class="node">
<title>expert_2_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1174" cy="-29925.28" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1174" y="-29936.58" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1174" y="-29921.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1174" y="-29906.58" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_4_up&#45;&gt;expert_2_4_gelu -->
<g id="edge111" class="edge">
<title>expert_2_4_up&#45;&gt;expert_2_4_gelu</title>
<path fill="none" stroke="black" d="M1162.29,-29999.65C1163.63,-29991.23 1165.1,-29982.01 1166.53,-29973.04"/>
<polygon fill="black" stroke="black" points="1170,-29973.51 1168.13,-29963.08 1163.09,-29972.4 1170,-29973.51"/>
</g>
<!-- expert_2_4_down -->
<g id="node97" class="node">
<title>expert_2_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1231.5,-29850.81 1078.5,-29850.81 1078.5,-29782.81 1231.5,-29782.81 1231.5,-29850.81"/>
<text text-anchor="middle" x="1155" y="-29835.61" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1155" y="-29820.61" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1155" y="-29805.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1155" y="-29790.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_4_gelu&#45;&gt;expert_2_4_down -->
<g id="edge112" class="edge">
<title>expert_2_4_gelu&#45;&gt;expert_2_4_down</title>
<path fill="none" stroke="black" d="M1167.46,-29887.64C1165.93,-29879.08 1164.29,-29869.88 1162.72,-29861.06"/>
<polygon fill="black" stroke="black" points="1166.12,-29860.18 1160.91,-29850.95 1159.22,-29861.41 1166.12,-29860.18"/>
</g>
<!-- expert_2_4_down&#45;&gt;aggregate_2 -->
<g id="edge113" class="edge">
<title>expert_2_4_down&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1140.81,-29782.57C1135.77,-29770.75 1129.68,-29756.49 1123.08,-29741.01"/>
<polygon fill="black" stroke="black" points="1126.27,-29739.59 1119.13,-29731.76 1119.84,-29742.33 1126.27,-29739.59"/>
</g>
<!-- expert_2_5_gelu -->
<g id="node99" class="node">
<title>expert_2_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1428" cy="-29925.28" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1428" y="-29936.58" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1428" y="-29921.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1428" y="-29906.58" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_5_up&#45;&gt;expert_2_5_gelu -->
<g id="edge115" class="edge">
<title>expert_2_5_up&#45;&gt;expert_2_5_gelu</title>
<path fill="none" stroke="black" d="M1416.29,-29999.65C1417.63,-29991.23 1419.1,-29982.01 1420.53,-29973.04"/>
<polygon fill="black" stroke="black" points="1424,-29973.51 1422.13,-29963.08 1417.09,-29972.4 1424,-29973.51"/>
</g>
<!-- expert_2_5_down -->
<g id="node100" class="node">
<title>expert_2_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1485.5,-29850.81 1332.5,-29850.81 1332.5,-29782.81 1485.5,-29782.81 1485.5,-29850.81"/>
<text text-anchor="middle" x="1409" y="-29835.61" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1409" y="-29820.61" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1409" y="-29805.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1409" y="-29790.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_5_gelu&#45;&gt;expert_2_5_down -->
<g id="edge116" class="edge">
<title>expert_2_5_gelu&#45;&gt;expert_2_5_down</title>
<path fill="none" stroke="black" d="M1421.46,-29887.64C1419.93,-29879.08 1418.29,-29869.88 1416.72,-29861.06"/>
<polygon fill="black" stroke="black" points="1420.12,-29860.18 1414.91,-29850.95 1413.22,-29861.41 1420.12,-29860.18"/>
</g>
<!-- expert_2_5_down&#45;&gt;aggregate_2 -->
<g id="edge117" class="edge">
<title>expert_2_5_down&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1360.82,-29782.57C1320.65,-29754.85 1261.08,-29713.76 1204.74,-29674.89"/>
<polygon fill="black" stroke="black" points="1206.67,-29671.97 1196.45,-29669.17 1202.7,-29677.73 1206.67,-29671.97"/>
</g>
<!-- expert_2_6_gelu -->
<g id="node102" class="node">
<title>expert_2_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1682" cy="-29925.28" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1682" y="-29936.58" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1682" y="-29921.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1682" y="-29906.58" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_6_up&#45;&gt;expert_2_6_gelu -->
<g id="edge119" class="edge">
<title>expert_2_6_up&#45;&gt;expert_2_6_gelu</title>
<path fill="none" stroke="black" d="M1670.29,-29999.65C1671.63,-29991.23 1673.1,-29982.01 1674.53,-29973.04"/>
<polygon fill="black" stroke="black" points="1678,-29973.51 1676.13,-29963.08 1671.09,-29972.4 1678,-29973.51"/>
</g>
<!-- expert_2_6_down -->
<g id="node103" class="node">
<title>expert_2_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1739.5,-29850.81 1586.5,-29850.81 1586.5,-29782.81 1739.5,-29782.81 1739.5,-29850.81"/>
<text text-anchor="middle" x="1663" y="-29835.61" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1663" y="-29820.61" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1663" y="-29805.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1663" y="-29790.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_6_gelu&#45;&gt;expert_2_6_down -->
<g id="edge120" class="edge">
<title>expert_2_6_gelu&#45;&gt;expert_2_6_down</title>
<path fill="none" stroke="black" d="M1675.46,-29887.64C1673.93,-29879.08 1672.29,-29869.88 1670.72,-29861.06"/>
<polygon fill="black" stroke="black" points="1674.12,-29860.18 1668.91,-29850.95 1667.22,-29861.41 1674.12,-29860.18"/>
</g>
<!-- expert_2_6_down&#45;&gt;aggregate_2 -->
<g id="edge121" class="edge">
<title>expert_2_6_down&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1586.48,-29784.85C1496.4,-29748.42 1343.94,-29686.75 1224.36,-29638.38"/>
<polygon fill="black" stroke="black" points="1225.66,-29635.13 1215.08,-29634.62 1223.04,-29641.62 1225.66,-29635.13"/>
</g>
<!-- expert_2_7_gelu -->
<g id="node105" class="node">
<title>expert_2_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1936" cy="-29925.28" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1936" y="-29936.58" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1936" y="-29921.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1936" y="-29906.58" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_7_up&#45;&gt;expert_2_7_gelu -->
<g id="edge123" class="edge">
<title>expert_2_7_up&#45;&gt;expert_2_7_gelu</title>
<path fill="none" stroke="black" d="M1924.29,-29999.65C1925.63,-29991.23 1927.1,-29982.01 1928.53,-29973.04"/>
<polygon fill="black" stroke="black" points="1932,-29973.51 1930.13,-29963.08 1925.09,-29972.4 1932,-29973.51"/>
</g>
<!-- expert_2_7_down -->
<g id="node106" class="node">
<title>expert_2_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1993.5,-29850.81 1840.5,-29850.81 1840.5,-29782.81 1993.5,-29782.81 1993.5,-29850.81"/>
<text text-anchor="middle" x="1917" y="-29835.61" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1917" y="-29820.61" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1917" y="-29805.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1917" y="-29790.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_2_7_gelu&#45;&gt;expert_2_7_down -->
<g id="edge124" class="edge">
<title>expert_2_7_gelu&#45;&gt;expert_2_7_down</title>
<path fill="none" stroke="black" d="M1929.46,-29887.64C1927.93,-29879.08 1926.29,-29869.88 1924.72,-29861.06"/>
<polygon fill="black" stroke="black" points="1928.12,-29860.18 1922.91,-29850.95 1921.22,-29861.41 1928.12,-29860.18"/>
</g>
<!-- expert_2_7_down&#45;&gt;aggregate_2 -->
<g id="edge125" class="edge">
<title>expert_2_7_down&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1840.33,-29785.66C1829.86,-29781.85 1819.2,-29778.13 1809,-29774.81 1614.61,-29711.55 1388.13,-29651.47 1233.31,-29612.42"/>
<polygon fill="black" stroke="black" points="1233.76,-29608.93 1223.21,-29609.88 1232.06,-29615.72 1233.76,-29608.93"/>
</g>
<!-- residual_2_2 -->
<g id="node108" class="node">
<title>residual_2_2</title>
<ellipse fill="none" stroke="black" cx="1049" cy="-29312.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1049" y="-29323.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1049" y="-29308.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1049" y="-29293.91" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- aggregate_2&#45;&gt;residual_2_2 -->
<g id="edge126" class="edge">
<title>aggregate_2&#45;&gt;residual_2_2</title>
<path fill="none" stroke="black" d="M1049,-29386.79C1049,-29377.5 1049,-29368.69 1049,-29360.6"/>
<polygon fill="black" stroke="black" points="1052.5,-29360.4 1049,-29350.4 1045.5,-29360.4 1052.5,-29360.4"/>
</g>
<!-- input_3 -->
<g id="node109" class="node">
<title>input_3</title>
<ellipse fill="none" stroke="black" cx="1049" cy="-29129.65" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1049" y="-29140.95" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1049" y="-29125.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1049" y="-29110.95" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_2&#45;&gt;input_3 -->
<g id="edge675" class="edge">
<title>residual_2_2&#45;&gt;input_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1049,-29274.99C1049,-29246.9 1049,-29207.94 1049,-29177.57"/>
<polygon fill="blue" stroke="blue" points="1052.5,-29177.22 1049,-29167.22 1045.5,-29177.22 1052.5,-29177.22"/>
<text text-anchor="middle" x="1129.5" y="-29239.93" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1129.5" y="-29224.93" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1129.5" y="-29209.93" font-family="Times,serif" font-size="14.00">GPU 2 &#45;&gt; GPU 3</text>
</g>
<!-- qkv_proj_3 -->
<g id="node110" class="node">
<title>qkv_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="1211,-29034.18 887,-29034.18 887,-28966.18 1211,-28966.18 1211,-29034.18"/>
<text text-anchor="middle" x="1049" y="-29018.98" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1049" y="-29003.98" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1049" y="-28988.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="1049" y="-28973.98" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- input_3&#45;&gt;qkv_proj_3 -->
<g id="edge127" class="edge">
<title>input_3&#45;&gt;qkv_proj_3</title>
<path fill="none" stroke="black" d="M1049,-29092.12C1049,-29077.3 1049,-29060.06 1049,-29044.59"/>
<polygon fill="black" stroke="black" points="1052.5,-29044.23 1049,-29034.23 1045.5,-29044.23 1052.5,-29044.23"/>
</g>
<!-- reshape_qkv_3 -->
<g id="node111" class="node">
<title>reshape_qkv_3</title>
<polygon fill="none" stroke="black" points="1403.64,-28929.18 839.49,-28929.18 694.36,-28823.18 1258.51,-28823.18 1403.64,-28929.18"/>
<text text-anchor="middle" x="1049" y="-28887.48" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="1049" y="-28872.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1049" y="-28857.48" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- qkv_proj_3&#45;&gt;reshape_qkv_3 -->
<g id="edge128" class="edge">
<title>qkv_proj_3&#45;&gt;reshape_qkv_3</title>
<path fill="none" stroke="black" d="M1049,-28966.16C1049,-28957.96 1049,-28948.89 1049,-28939.78"/>
<polygon fill="black" stroke="black" points="1052.5,-28939.51 1049,-28929.51 1045.5,-28939.51 1052.5,-28939.51"/>
</g>
<!-- attn_scores_3 -->
<g id="node112" class="node">
<title>attn_scores_3</title>
<polygon fill="none" stroke="black" points="1049,-28786.18 869,-28733.18 1049,-28680.18 1229,-28733.18 1049,-28786.18"/>
<text text-anchor="middle" x="1049" y="-28744.48" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1049" y="-28729.48" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1049" y="-28714.48" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- reshape_qkv_3&#45;&gt;attn_scores_3 -->
<g id="edge129" class="edge">
<title>reshape_qkv_3&#45;&gt;attn_scores_3</title>
<path fill="none" stroke="black" d="M1049,-28823.07C1049,-28814.5 1049,-28805.54 1049,-28796.75"/>
<polygon fill="black" stroke="black" points="1052.5,-28796.54 1049,-28786.54 1045.5,-28796.54 1052.5,-28796.54"/>
</g>
<!-- attn_weights_3 -->
<g id="node113" class="node">
<title>attn_weights_3</title>
<polygon fill="none" stroke="black" points="1049,-28643.18 869,-28590.18 1049,-28537.18 1229,-28590.18 1049,-28643.18"/>
<text text-anchor="middle" x="1049" y="-28601.48" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1049" y="-28586.48" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1049" y="-28571.48" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- attn_scores_3&#45;&gt;attn_weights_3 -->
<g id="edge130" class="edge">
<title>attn_scores_3&#45;&gt;attn_weights_3</title>
<path fill="none" stroke="black" d="M1049,-28680.07C1049,-28671.5 1049,-28662.54 1049,-28653.75"/>
<polygon fill="black" stroke="black" points="1052.5,-28653.54 1049,-28643.54 1045.5,-28653.54 1052.5,-28653.54"/>
</g>
<!-- attn_output_3 -->
<g id="node114" class="node">
<title>attn_output_3</title>
<polygon fill="none" stroke="black" points="1049,-28500.18 878,-28447.18 1049,-28394.18 1220,-28447.18 1049,-28500.18"/>
<text text-anchor="middle" x="1049" y="-28458.48" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="1049" y="-28443.48" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1049" y="-28428.48" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- attn_weights_3&#45;&gt;attn_output_3 -->
<g id="edge131" class="edge">
<title>attn_weights_3&#45;&gt;attn_output_3</title>
<path fill="none" stroke="black" d="M1049,-28537.07C1049,-28528.5 1049,-28519.54 1049,-28510.75"/>
<polygon fill="black" stroke="black" points="1052.5,-28510.54 1049,-28500.54 1045.5,-28510.54 1052.5,-28510.54"/>
</g>
<!-- out_proj_3 -->
<g id="node115" class="node">
<title>out_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="1125.5,-28357.18 972.5,-28357.18 972.5,-28289.18 1125.5,-28289.18 1125.5,-28357.18"/>
<text text-anchor="middle" x="1049" y="-28341.98" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1049" y="-28326.98" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1049" y="-28311.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1049" y="-28296.98" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- attn_output_3&#45;&gt;out_proj_3 -->
<g id="edge132" class="edge">
<title>attn_output_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M1049,-28394.08C1049,-28385.24 1049,-28376.15 1049,-28367.56"/>
<polygon fill="black" stroke="black" points="1052.5,-28367.39 1049,-28357.39 1045.5,-28367.39 1052.5,-28367.39"/>
</g>
<!-- residual_1_3 -->
<g id="node116" class="node">
<title>residual_1_3</title>
<ellipse fill="none" stroke="black" cx="1049" cy="-28214.7" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1049" y="-28226" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1049" y="-28211" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1049" y="-28196" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- out_proj_3&#45;&gt;residual_1_3 -->
<g id="edge133" class="edge">
<title>out_proj_3&#45;&gt;residual_1_3</title>
<path fill="none" stroke="black" d="M1049,-28289.07C1049,-28280.73 1049,-28271.62 1049,-28262.75"/>
<polygon fill="black" stroke="black" points="1052.5,-28262.49 1049,-28252.49 1045.5,-28262.49 1052.5,-28262.49"/>
</g>
<!-- gate_3 -->
<g id="node117" class="node">
<title>gate_3</title>
<polygon fill="lightpink" stroke="black" points="1284.3,-28075.95 1166.65,-28119 931.35,-28119 813.7,-28075.95 931.35,-28032.9 1166.65,-28032.9 1284.3,-28075.95"/>
<text text-anchor="middle" x="1049" y="-28087.25" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1049" y="-28072.25" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="1049" y="-28057.25" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- residual_1_3&#45;&gt;gate_3 -->
<g id="edge134" class="edge">
<title>residual_1_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M1049,-28177.05C1049,-28162.39 1049,-28145.22 1049,-28129.28"/>
<polygon fill="black" stroke="black" points="1052.5,-28129.02 1049,-28119.02 1045.5,-28129.02 1052.5,-28129.02"/>
</g>
<!-- selection_3 -->
<g id="node118" class="node">
<title>selection_3</title>
<polygon fill="none" stroke="black" points="1049,-27995.67 847,-27942.67 1049,-27889.67 1251,-27942.67 1049,-27995.67"/>
<text text-anchor="middle" x="1049" y="-27953.97" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="1049" y="-27938.97" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="1049" y="-27923.97" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- gate_3&#45;&gt;selection_3 -->
<g id="edge135" class="edge">
<title>gate_3&#45;&gt;selection_3</title>
<path fill="none" stroke="black" d="M1049,-28032.69C1049,-28024.19 1049,-28015.1 1049,-28006.08"/>
<polygon fill="black" stroke="black" points="1052.5,-28005.98 1049,-27995.98 1045.5,-28005.98 1052.5,-28005.98"/>
</g>
<!-- expert_3_0_up -->
<g id="node119" class="node">
<title>expert_3_0_up</title>
<polygon fill="lightgreen" stroke="black" points="266,-27817.67 104,-27817.67 104,-27749.67 266,-27749.67 266,-27817.67"/>
<text text-anchor="middle" x="185" y="-27802.47" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="185" y="-27787.47" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="185" y="-27772.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="185" y="-27757.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- selection_3&#45;&gt;expert_3_0_up -->
<g id="edge136" class="edge">
<title>selection_3&#45;&gt;expert_3_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M890.56,-27931.11C700.54,-27916.91 394.2,-27888.75 287,-27848.67 270.06,-27842.34 252.92,-27832.98 237.65,-27823.36"/>
<polygon fill="red" stroke="red" points="239.18,-27820.18 228.89,-27817.68 235.38,-27826.06 239.18,-27820.18"/>
<text text-anchor="middle" x="425.5" y="-27860.47" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_3_1_up -->
<g id="node122" class="node">
<title>expert_3_1_up</title>
<polygon fill="lightgreen" stroke="black" points="520,-27817.67 358,-27817.67 358,-27749.67 520,-27749.67 520,-27817.67"/>
<text text-anchor="middle" x="439" y="-27802.47" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="439" y="-27787.47" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="439" y="-27772.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="439" y="-27757.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- selection_3&#45;&gt;expert_3_1_up -->
<g id="edge140" class="edge">
<title>selection_3&#45;&gt;expert_3_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M898.21,-27929.18C794.93,-27917.02 656.33,-27893.5 541,-27848.67 524.3,-27842.18 507.36,-27832.87 492.2,-27823.35"/>
<polygon fill="red" stroke="red" points="493.8,-27820.21 483.5,-27817.74 490,-27826.1 493.8,-27820.21"/>
<text text-anchor="middle" x="671.5" y="-27860.47" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_3_2_up -->
<g id="node125" class="node">
<title>expert_3_2_up</title>
<polygon fill="lightgreen" stroke="black" points="774,-27817.67 612,-27817.67 612,-27749.67 774,-27749.67 774,-27817.67"/>
<text text-anchor="middle" x="693" y="-27802.47" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="693" y="-27787.47" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="693" y="-27772.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="693" y="-27757.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- selection_3&#45;&gt;expert_3_2_up -->
<g id="edge144" class="edge">
<title>selection_3&#45;&gt;expert_3_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M953.62,-27914.61C904.61,-27898.77 844.86,-27876.41 795,-27848.67 780.85,-27840.8 765.94,-27831.84 752,-27823.16"/>
<polygon fill="red" stroke="red" points="753.8,-27820.16 743.47,-27817.81 750.08,-27826.09 753.8,-27820.16"/>
<text text-anchor="middle" x="898.5" y="-27860.47" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_3_3_up -->
<g id="node128" class="node">
<title>expert_3_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1029,-27817.67 867,-27817.67 867,-27749.67 1029,-27749.67 1029,-27817.67"/>
<text text-anchor="middle" x="948" y="-27802.47" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="948" y="-27787.47" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="948" y="-27772.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="948" y="-27757.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- selection_3&#45;&gt;expert_3_3_up -->
<g id="edge148" class="edge">
<title>selection_3&#45;&gt;expert_3_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1005.77,-27900.87C997.54,-27891.77 989.48,-27881.8 983,-27871.67 974.37,-27858.19 967.21,-27842.23 961.66,-27827.69"/>
<polygon fill="red" stroke="red" points="964.8,-27826.08 958.08,-27817.9 958.22,-27828.49 964.8,-27826.08"/>
<text text-anchor="middle" x="1047.5" y="-27860.47" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_3_4_up -->
<g id="node131" class="node">
<title>expert_3_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1240,-27817.67 1078,-27817.67 1078,-27749.67 1240,-27749.67 1240,-27817.67"/>
<text text-anchor="middle" x="1159" y="-27802.47" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1159" y="-27787.47" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1159" y="-27772.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1159" y="-27757.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- selection_3&#45;&gt;expert_3_4_up -->
<g id="edge152" class="edge">
<title>selection_3&#45;&gt;expert_3_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1089.34,-27900.08C1097.27,-27891.04 1105.22,-27881.3 1112,-27871.67 1121.74,-27857.86 1130.94,-27841.81 1138.57,-27827.28"/>
<polygon fill="red" stroke="red" points="1141.89,-27828.48 1143.35,-27817.99 1135.66,-27825.28 1141.89,-27828.48"/>
<text text-anchor="middle" x="1184.5" y="-27860.47" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_3_5_up -->
<g id="node134" class="node">
<title>expert_3_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1494,-27817.67 1332,-27817.67 1332,-27749.67 1494,-27749.67 1494,-27817.67"/>
<text text-anchor="middle" x="1413" y="-27802.47" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1413" y="-27787.47" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1413" y="-27772.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1413" y="-27757.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- selection_3&#45;&gt;expert_3_5_up -->
<g id="edge156" class="edge">
<title>selection_3&#45;&gt;expert_3_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1141.93,-27914.01C1191.1,-27897.81 1251.74,-27875.3 1303,-27848.67 1318.33,-27840.71 1334.55,-27831.65 1349.69,-27822.9"/>
<polygon fill="red" stroke="red" points="1351.58,-27825.84 1358.46,-27817.79 1348.06,-27819.79 1351.58,-27825.84"/>
<text text-anchor="middle" x="1347.5" y="-27860.47" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_3_6_up -->
<g id="node137" class="node">
<title>expert_3_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1748,-27817.67 1586,-27817.67 1586,-27749.67 1748,-27749.67 1748,-27817.67"/>
<text text-anchor="middle" x="1667" y="-27802.47" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1667" y="-27787.47" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1667" y="-27772.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1667" y="-27757.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- selection_3&#45;&gt;expert_3_6_up -->
<g id="edge160" class="edge">
<title>selection_3&#45;&gt;expert_3_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1196.53,-27928.29C1299.88,-27915.67 1439.89,-27891.95 1557,-27848.67 1574.84,-27842.08 1593.11,-27832.69 1609.52,-27823.12"/>
<polygon fill="red" stroke="red" points="1611.63,-27825.94 1618.42,-27817.81 1608.04,-27819.93 1611.63,-27825.94"/>
<text text-anchor="middle" x="1594.5" y="-27860.47" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_3_7_up -->
<g id="node140" class="node">
<title>expert_3_7_up</title>
<polygon fill="lightgreen" stroke="black" points="2002,-27817.67 1840,-27817.67 1840,-27749.67 2002,-27749.67 2002,-27817.67"/>
<text text-anchor="middle" x="1921" y="-27802.47" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1921" y="-27787.47" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1921" y="-27772.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1921" y="-27757.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- selection_3&#45;&gt;expert_3_7_up -->
<g id="edge164" class="edge">
<title>selection_3&#45;&gt;expert_3_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1205.56,-27930.64C1395.23,-27915.86 1702.81,-27887.01 1811,-27848.67 1829.1,-27842.26 1847.59,-27832.83 1864.11,-27823.16"/>
<polygon fill="red" stroke="red" points="1866.3,-27825.93 1873.08,-27817.78 1862.7,-27819.93 1866.3,-27825.93"/>
<text text-anchor="middle" x="1841.5" y="-27860.47" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_3_0_gelu -->
<g id="node120" class="node">
<title>expert_3_0_gelu</title>
<ellipse fill="none" stroke="black" cx="160" cy="-27675.2" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="160" y="-27686.5" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="160" y="-27671.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="160" y="-27656.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_0_up&#45;&gt;expert_3_0_gelu -->
<g id="edge137" class="edge">
<title>expert_3_0_up&#45;&gt;expert_3_0_gelu</title>
<path fill="none" stroke="black" d="M177.23,-27749.57C175.21,-27740.96 172.99,-27731.53 170.84,-27722.38"/>
<polygon fill="black" stroke="black" points="174.24,-27721.55 168.55,-27712.62 167.43,-27723.15 174.24,-27721.55"/>
</g>
<!-- expert_3_0_down -->
<g id="node121" class="node">
<title>expert_3_0_down</title>
<polygon fill="lightgreen" stroke="black" points="264.5,-27600.72 111.5,-27600.72 111.5,-27532.72 264.5,-27532.72 264.5,-27600.72"/>
<text text-anchor="middle" x="188" y="-27585.52" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="188" y="-27570.52" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="188" y="-27555.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="188" y="-27540.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_0_gelu&#45;&gt;expert_3_0_down -->
<g id="edge138" class="edge">
<title>expert_3_0_gelu&#45;&gt;expert_3_0_down</title>
<path fill="none" stroke="black" d="M169.64,-27637.55C171.91,-27628.9 174.36,-27619.6 176.7,-27610.69"/>
<polygon fill="black" stroke="black" points="180.13,-27611.42 179.29,-27600.86 173.36,-27609.64 180.13,-27611.42"/>
</g>
<!-- aggregate_3 -->
<g id="node143" class="node">
<title>aggregate_3</title>
<ellipse fill="lightyellow" stroke="black" cx="1123" cy="-27316.36" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="1123" cy="-27316.36" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="1123" y="-27327.66" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="1123" y="-27312.66" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1123" y="-27297.66" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_0_down&#45;&gt;aggregate_3 -->
<g id="edge139" class="edge">
<title>expert_3_0_down&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M264.59,-27532.69C272.11,-27529.84 279.67,-27527.13 287,-27524.72 506.81,-27452.39 766.35,-27391.74 937.27,-27355.07"/>
<polygon fill="black" stroke="black" points="938.07,-27358.48 947.12,-27352.96 936.61,-27351.63 938.07,-27358.48"/>
</g>
<!-- expert_3_1_gelu -->
<g id="node123" class="node">
<title>expert_3_1_gelu</title>
<ellipse fill="none" stroke="black" cx="414" cy="-27675.2" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="414" y="-27686.5" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="414" y="-27671.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="414" y="-27656.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_1_up&#45;&gt;expert_3_1_gelu -->
<g id="edge141" class="edge">
<title>expert_3_1_up&#45;&gt;expert_3_1_gelu</title>
<path fill="none" stroke="black" d="M431.23,-27749.57C429.21,-27740.96 426.99,-27731.53 424.84,-27722.38"/>
<polygon fill="black" stroke="black" points="428.24,-27721.55 422.55,-27712.62 421.43,-27723.15 428.24,-27721.55"/>
</g>
<!-- expert_3_1_down -->
<g id="node124" class="node">
<title>expert_3_1_down</title>
<polygon fill="lightgreen" stroke="black" points="509.5,-27600.72 356.5,-27600.72 356.5,-27532.72 509.5,-27532.72 509.5,-27600.72"/>
<text text-anchor="middle" x="433" y="-27585.52" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="433" y="-27570.52" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="433" y="-27555.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="433" y="-27540.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_1_gelu&#45;&gt;expert_3_1_down -->
<g id="edge142" class="edge">
<title>expert_3_1_gelu&#45;&gt;expert_3_1_down</title>
<path fill="none" stroke="black" d="M420.54,-27637.55C422.07,-27628.99 423.71,-27619.8 425.28,-27610.98"/>
<polygon fill="black" stroke="black" points="428.78,-27611.32 427.09,-27600.86 421.88,-27610.09 428.78,-27611.32"/>
</g>
<!-- expert_3_1_down&#45;&gt;aggregate_3 -->
<g id="edge143" class="edge">
<title>expert_3_1_down&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M509.63,-27536.41C520.15,-27532.45 530.84,-27528.46 541,-27524.72 675.88,-27475.1 828.99,-27420.62 944.31,-27379.96"/>
<polygon fill="black" stroke="black" points="945.68,-27383.18 953.95,-27376.56 943.35,-27376.58 945.68,-27383.18"/>
</g>
<!-- expert_3_2_gelu -->
<g id="node126" class="node">
<title>expert_3_2_gelu</title>
<ellipse fill="none" stroke="black" cx="668" cy="-27675.2" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="668" y="-27686.5" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="668" y="-27671.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="668" y="-27656.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_2_up&#45;&gt;expert_3_2_gelu -->
<g id="edge145" class="edge">
<title>expert_3_2_up&#45;&gt;expert_3_2_gelu</title>
<path fill="none" stroke="black" d="M685.23,-27749.57C683.21,-27740.96 680.99,-27731.53 678.84,-27722.38"/>
<polygon fill="black" stroke="black" points="682.24,-27721.55 676.55,-27712.62 675.43,-27723.15 682.24,-27721.55"/>
</g>
<!-- expert_3_2_down -->
<g id="node127" class="node">
<title>expert_3_2_down</title>
<polygon fill="lightgreen" stroke="black" points="772.5,-27600.72 619.5,-27600.72 619.5,-27532.72 772.5,-27532.72 772.5,-27600.72"/>
<text text-anchor="middle" x="696" y="-27585.52" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="696" y="-27570.52" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="696" y="-27555.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="696" y="-27540.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_2_gelu&#45;&gt;expert_3_2_down -->
<g id="edge146" class="edge">
<title>expert_3_2_gelu&#45;&gt;expert_3_2_down</title>
<path fill="none" stroke="black" d="M677.64,-27637.55C679.91,-27628.9 682.36,-27619.6 684.7,-27610.69"/>
<polygon fill="black" stroke="black" points="688.13,-27611.42 687.29,-27600.86 681.36,-27609.64 688.13,-27611.42"/>
</g>
<!-- expert_3_2_down&#45;&gt;aggregate_3 -->
<g id="edge147" class="edge">
<title>expert_3_2_down&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M753.14,-27532.48C805.88,-27501.81 886.8,-27454.75 959.51,-27412.45"/>
<polygon fill="black" stroke="black" points="961.45,-27415.37 968.33,-27407.32 957.93,-27409.32 961.45,-27415.37"/>
</g>
<!-- expert_3_3_gelu -->
<g id="node129" class="node">
<title>expert_3_3_gelu</title>
<ellipse fill="none" stroke="black" cx="922" cy="-27675.2" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="922" y="-27686.5" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="922" y="-27671.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="922" y="-27656.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_3_up&#45;&gt;expert_3_3_gelu -->
<g id="edge149" class="edge">
<title>expert_3_3_up&#45;&gt;expert_3_3_gelu</title>
<path fill="none" stroke="black" d="M939.92,-27749.57C937.81,-27740.96 935.51,-27731.53 933.28,-27722.38"/>
<polygon fill="black" stroke="black" points="936.67,-27721.5 930.89,-27712.62 929.87,-27723.16 936.67,-27721.5"/>
</g>
<!-- expert_3_3_down -->
<g id="node130" class="node">
<title>expert_3_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1017.5,-27600.72 864.5,-27600.72 864.5,-27532.72 1017.5,-27532.72 1017.5,-27600.72"/>
<text text-anchor="middle" x="941" y="-27585.52" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="941" y="-27570.52" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="941" y="-27555.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="941" y="-27540.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_3_gelu&#45;&gt;expert_3_3_down -->
<g id="edge150" class="edge">
<title>expert_3_3_gelu&#45;&gt;expert_3_3_down</title>
<path fill="none" stroke="black" d="M928.54,-27637.55C930.07,-27628.99 931.71,-27619.8 933.28,-27610.98"/>
<polygon fill="black" stroke="black" points="936.78,-27611.32 935.09,-27600.86 929.88,-27610.09 936.78,-27611.32"/>
</g>
<!-- expert_3_3_down&#45;&gt;aggregate_3 -->
<g id="edge151" class="edge">
<title>expert_3_3_down&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M965.36,-27532.48C977.83,-27515.46 994.01,-27493.38 1011.24,-27469.87"/>
<polygon fill="black" stroke="black" points="1014.28,-27471.64 1017.37,-27461.51 1008.63,-27467.5 1014.28,-27471.64"/>
</g>
<!-- expert_3_4_gelu -->
<g id="node132" class="node">
<title>expert_3_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1176" cy="-27675.2" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1176" y="-27686.5" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1176" y="-27671.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1176" y="-27656.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_4_up&#45;&gt;expert_3_4_gelu -->
<g id="edge153" class="edge">
<title>expert_3_4_up&#45;&gt;expert_3_4_gelu</title>
<path fill="none" stroke="black" d="M1164.29,-27749.57C1165.63,-27741.14 1167.1,-27731.92 1168.53,-27722.96"/>
<polygon fill="black" stroke="black" points="1172,-27723.42 1170.13,-27712.99 1165.09,-27722.32 1172,-27723.42"/>
</g>
<!-- expert_3_4_down -->
<g id="node133" class="node">
<title>expert_3_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1216.5,-27600.72 1063.5,-27600.72 1063.5,-27532.72 1216.5,-27532.72 1216.5,-27600.72"/>
<text text-anchor="middle" x="1140" y="-27585.52" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1140" y="-27570.52" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1140" y="-27555.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1140" y="-27540.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_4_gelu&#45;&gt;expert_3_4_down -->
<g id="edge154" class="edge">
<title>expert_3_4_gelu&#45;&gt;expert_3_4_down</title>
<path fill="none" stroke="black" d="M1163.71,-27637.85C1160.75,-27629.09 1157.56,-27619.65 1154.51,-27610.62"/>
<polygon fill="black" stroke="black" points="1157.78,-27609.39 1151.27,-27601.04 1151.15,-27611.63 1157.78,-27609.39"/>
</g>
<!-- expert_3_4_down&#45;&gt;aggregate_3 -->
<g id="edge155" class="edge">
<title>expert_3_4_down&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1137.72,-27532.48C1137.18,-27524.5 1136.56,-27515.41 1135.88,-27505.59"/>
<polygon fill="black" stroke="black" points="1139.37,-27505.27 1135.2,-27495.53 1132.39,-27505.74 1139.37,-27505.27"/>
</g>
<!-- expert_3_5_gelu -->
<g id="node135" class="node">
<title>expert_3_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1430" cy="-27675.2" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1430" y="-27686.5" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1430" y="-27671.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1430" y="-27656.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_5_up&#45;&gt;expert_3_5_gelu -->
<g id="edge157" class="edge">
<title>expert_3_5_up&#45;&gt;expert_3_5_gelu</title>
<path fill="none" stroke="black" d="M1418.29,-27749.57C1419.63,-27741.14 1421.1,-27731.92 1422.53,-27722.96"/>
<polygon fill="black" stroke="black" points="1426,-27723.42 1424.13,-27712.99 1419.09,-27722.32 1426,-27723.42"/>
</g>
<!-- expert_3_5_down -->
<g id="node136" class="node">
<title>expert_3_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1487.5,-27600.72 1334.5,-27600.72 1334.5,-27532.72 1487.5,-27532.72 1487.5,-27600.72"/>
<text text-anchor="middle" x="1411" y="-27585.52" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1411" y="-27570.52" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1411" y="-27555.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1411" y="-27540.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_5_gelu&#45;&gt;expert_3_5_down -->
<g id="edge158" class="edge">
<title>expert_3_5_gelu&#45;&gt;expert_3_5_down</title>
<path fill="none" stroke="black" d="M1423.46,-27637.55C1421.93,-27628.99 1420.29,-27619.8 1418.72,-27610.98"/>
<polygon fill="black" stroke="black" points="1422.12,-27610.09 1416.91,-27600.86 1415.22,-27611.32 1422.12,-27610.09"/>
</g>
<!-- expert_3_5_down&#45;&gt;aggregate_3 -->
<g id="edge159" class="edge">
<title>expert_3_5_down&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1372.46,-27532.48C1344.72,-27508.57 1305.44,-27474.69 1266.23,-27440.87"/>
<polygon fill="black" stroke="black" points="1268.25,-27438 1258.39,-27434.12 1263.68,-27443.3 1268.25,-27438"/>
</g>
<!-- expert_3_6_gelu -->
<g id="node138" class="node">
<title>expert_3_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1684" cy="-27675.2" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1684" y="-27686.5" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1684" y="-27671.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1684" y="-27656.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_6_up&#45;&gt;expert_3_6_gelu -->
<g id="edge161" class="edge">
<title>expert_3_6_up&#45;&gt;expert_3_6_gelu</title>
<path fill="none" stroke="black" d="M1672.29,-27749.57C1673.63,-27741.14 1675.1,-27731.92 1676.53,-27722.96"/>
<polygon fill="black" stroke="black" points="1680,-27723.42 1678.13,-27712.99 1673.09,-27722.32 1680,-27723.42"/>
</g>
<!-- expert_3_6_down -->
<g id="node139" class="node">
<title>expert_3_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1741.5,-27600.72 1588.5,-27600.72 1588.5,-27532.72 1741.5,-27532.72 1741.5,-27600.72"/>
<text text-anchor="middle" x="1665" y="-27585.52" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1665" y="-27570.52" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1665" y="-27555.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1665" y="-27540.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_6_gelu&#45;&gt;expert_3_6_down -->
<g id="edge162" class="edge">
<title>expert_3_6_gelu&#45;&gt;expert_3_6_down</title>
<path fill="none" stroke="black" d="M1677.46,-27637.55C1675.93,-27628.99 1674.29,-27619.8 1672.72,-27610.98"/>
<polygon fill="black" stroke="black" points="1676.12,-27610.09 1670.91,-27600.86 1669.22,-27611.32 1676.12,-27610.09"/>
</g>
<!-- expert_3_6_down&#45;&gt;aggregate_3 -->
<g id="edge163" class="edge">
<title>expert_3_6_down&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1592.75,-27532.61C1517.15,-27497.97 1395.71,-27442.32 1295.25,-27396.29"/>
<polygon fill="black" stroke="black" points="1296.45,-27392.99 1285.91,-27392.01 1293.54,-27399.35 1296.45,-27392.99"/>
</g>
<!-- expert_3_7_gelu -->
<g id="node141" class="node">
<title>expert_3_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1938" cy="-27675.2" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1938" y="-27686.5" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1938" y="-27671.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1938" y="-27656.5" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_7_up&#45;&gt;expert_3_7_gelu -->
<g id="edge165" class="edge">
<title>expert_3_7_up&#45;&gt;expert_3_7_gelu</title>
<path fill="none" stroke="black" d="M1926.29,-27749.57C1927.63,-27741.14 1929.1,-27731.92 1930.53,-27722.96"/>
<polygon fill="black" stroke="black" points="1934,-27723.42 1932.13,-27712.99 1927.09,-27722.32 1934,-27723.42"/>
</g>
<!-- expert_3_7_down -->
<g id="node142" class="node">
<title>expert_3_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1995.5,-27600.72 1842.5,-27600.72 1842.5,-27532.72 1995.5,-27532.72 1995.5,-27600.72"/>
<text text-anchor="middle" x="1919" y="-27585.52" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1919" y="-27570.52" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1919" y="-27555.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1919" y="-27540.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_3_7_gelu&#45;&gt;expert_3_7_down -->
<g id="edge166" class="edge">
<title>expert_3_7_gelu&#45;&gt;expert_3_7_down</title>
<path fill="none" stroke="black" d="M1931.46,-27637.55C1929.93,-27628.99 1928.29,-27619.8 1926.72,-27610.98"/>
<polygon fill="black" stroke="black" points="1930.12,-27610.09 1924.91,-27600.86 1923.22,-27611.32 1930.12,-27610.09"/>
</g>
<!-- expert_3_7_down&#45;&gt;aggregate_3 -->
<g id="edge167" class="edge">
<title>expert_3_7_down&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1842.25,-27535.83C1831.79,-27531.98 1821.16,-27528.18 1811,-27524.72 1641.02,-27466.92 1444.71,-27408.57 1305.4,-27368.56"/>
<polygon fill="black" stroke="black" points="1306.05,-27365.1 1295.47,-27365.71 1304.12,-27371.83 1306.05,-27365.1"/>
</g>
<!-- residual_2_3 -->
<g id="node144" class="node">
<title>residual_2_3</title>
<ellipse fill="none" stroke="black" cx="1123" cy="-27062.52" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1123" y="-27073.82" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1123" y="-27058.82" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1123" y="-27043.82" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- aggregate_3&#45;&gt;residual_2_3 -->
<g id="edge168" class="edge">
<title>aggregate_3&#45;&gt;residual_2_3</title>
<path fill="none" stroke="black" d="M1123,-27136.7C1123,-27127.42 1123,-27118.6 1123,-27110.51"/>
<polygon fill="black" stroke="black" points="1126.5,-27110.32 1123,-27100.32 1119.5,-27110.32 1126.5,-27110.32"/>
</g>
<!-- input_4 -->
<g id="node145" class="node">
<title>input_4</title>
<ellipse fill="none" stroke="black" cx="1123" cy="-26879.57" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1123" y="-26890.87" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1123" y="-26875.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1123" y="-26860.87" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_3&#45;&gt;input_4 -->
<g id="edge676" class="edge">
<title>residual_2_3&#45;&gt;input_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1123,-27024.9C1123,-26996.82 1123,-26957.85 1123,-26927.48"/>
<polygon fill="blue" stroke="blue" points="1126.5,-26927.13 1123,-26917.13 1119.5,-26927.13 1126.5,-26927.13"/>
<text text-anchor="middle" x="1203.5" y="-26989.84" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1203.5" y="-26974.84" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1203.5" y="-26959.84" font-family="Times,serif" font-size="14.00">GPU 3 &#45;&gt; GPU 4</text>
</g>
<!-- qkv_proj_4 -->
<g id="node146" class="node">
<title>qkv_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="1285,-26784.09 961,-26784.09 961,-26716.09 1285,-26716.09 1285,-26784.09"/>
<text text-anchor="middle" x="1123" y="-26768.89" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1123" y="-26753.89" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1123" y="-26738.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="1123" y="-26723.89" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- input_4&#45;&gt;qkv_proj_4 -->
<g id="edge169" class="edge">
<title>input_4&#45;&gt;qkv_proj_4</title>
<path fill="none" stroke="black" d="M1123,-26842.04C1123,-26827.21 1123,-26809.97 1123,-26794.51"/>
<polygon fill="black" stroke="black" points="1126.5,-26794.14 1123,-26784.14 1119.5,-26794.14 1126.5,-26794.14"/>
</g>
<!-- reshape_qkv_4 -->
<g id="node147" class="node">
<title>reshape_qkv_4</title>
<polygon fill="none" stroke="black" points="1477.64,-26679.09 913.49,-26679.09 768.36,-26573.09 1332.51,-26573.09 1477.64,-26679.09"/>
<text text-anchor="middle" x="1123" y="-26637.39" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="1123" y="-26622.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1123" y="-26607.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- qkv_proj_4&#45;&gt;reshape_qkv_4 -->
<g id="edge170" class="edge">
<title>qkv_proj_4&#45;&gt;reshape_qkv_4</title>
<path fill="none" stroke="black" d="M1123,-26716.07C1123,-26707.87 1123,-26698.81 1123,-26689.69"/>
<polygon fill="black" stroke="black" points="1126.5,-26689.43 1123,-26679.43 1119.5,-26689.43 1126.5,-26689.43"/>
</g>
<!-- attn_scores_4 -->
<g id="node148" class="node">
<title>attn_scores_4</title>
<polygon fill="none" stroke="black" points="1123,-26536.09 943,-26483.09 1123,-26430.09 1303,-26483.09 1123,-26536.09"/>
<text text-anchor="middle" x="1123" y="-26494.39" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1123" y="-26479.39" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1123" y="-26464.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- reshape_qkv_4&#45;&gt;attn_scores_4 -->
<g id="edge171" class="edge">
<title>reshape_qkv_4&#45;&gt;attn_scores_4</title>
<path fill="none" stroke="black" d="M1123,-26572.99C1123,-26564.42 1123,-26555.46 1123,-26546.66"/>
<polygon fill="black" stroke="black" points="1126.5,-26546.45 1123,-26536.45 1119.5,-26546.45 1126.5,-26546.45"/>
</g>
<!-- attn_weights_4 -->
<g id="node149" class="node">
<title>attn_weights_4</title>
<polygon fill="none" stroke="black" points="1123,-26393.09 943,-26340.09 1123,-26287.09 1303,-26340.09 1123,-26393.09"/>
<text text-anchor="middle" x="1123" y="-26351.39" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1123" y="-26336.39" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1123" y="-26321.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- attn_scores_4&#45;&gt;attn_weights_4 -->
<g id="edge172" class="edge">
<title>attn_scores_4&#45;&gt;attn_weights_4</title>
<path fill="none" stroke="black" d="M1123,-26429.99C1123,-26421.42 1123,-26412.46 1123,-26403.66"/>
<polygon fill="black" stroke="black" points="1126.5,-26403.45 1123,-26393.45 1119.5,-26403.45 1126.5,-26403.45"/>
</g>
<!-- attn_output_4 -->
<g id="node150" class="node">
<title>attn_output_4</title>
<polygon fill="none" stroke="black" points="1123,-26250.09 952,-26197.09 1123,-26144.09 1294,-26197.09 1123,-26250.09"/>
<text text-anchor="middle" x="1123" y="-26208.39" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="1123" y="-26193.39" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1123" y="-26178.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- attn_weights_4&#45;&gt;attn_output_4 -->
<g id="edge173" class="edge">
<title>attn_weights_4&#45;&gt;attn_output_4</title>
<path fill="none" stroke="black" d="M1123,-26286.99C1123,-26278.42 1123,-26269.46 1123,-26260.66"/>
<polygon fill="black" stroke="black" points="1126.5,-26260.45 1123,-26250.45 1119.5,-26260.45 1126.5,-26260.45"/>
</g>
<!-- out_proj_4 -->
<g id="node151" class="node">
<title>out_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="1199.5,-26107.09 1046.5,-26107.09 1046.5,-26039.09 1199.5,-26039.09 1199.5,-26107.09"/>
<text text-anchor="middle" x="1123" y="-26091.89" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1123" y="-26076.89" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1123" y="-26061.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1123" y="-26046.89" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- attn_output_4&#45;&gt;out_proj_4 -->
<g id="edge174" class="edge">
<title>attn_output_4&#45;&gt;out_proj_4</title>
<path fill="none" stroke="black" d="M1123,-26144C1123,-26135.16 1123,-26126.06 1123,-26117.47"/>
<polygon fill="black" stroke="black" points="1126.5,-26117.31 1123,-26107.31 1119.5,-26117.31 1126.5,-26117.31"/>
</g>
<!-- residual_1_4 -->
<g id="node152" class="node">
<title>residual_1_4</title>
<ellipse fill="none" stroke="black" cx="1123" cy="-25964.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1123" y="-25975.91" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1123" y="-25960.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1123" y="-25945.91" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- out_proj_4&#45;&gt;residual_1_4 -->
<g id="edge175" class="edge">
<title>out_proj_4&#45;&gt;residual_1_4</title>
<path fill="none" stroke="black" d="M1123,-26038.98C1123,-26030.65 1123,-26021.54 1123,-26012.66"/>
<polygon fill="black" stroke="black" points="1126.5,-26012.41 1123,-26002.41 1119.5,-26012.41 1126.5,-26012.41"/>
</g>
<!-- gate_4 -->
<g id="node153" class="node">
<title>gate_4</title>
<polygon fill="lightpink" stroke="black" points="1358.3,-25825.86 1240.65,-25868.91 1005.35,-25868.91 887.7,-25825.86 1005.35,-25782.81 1240.65,-25782.81 1358.3,-25825.86"/>
<text text-anchor="middle" x="1123" y="-25837.16" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1123" y="-25822.16" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="1123" y="-25807.16" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- residual_1_4&#45;&gt;gate_4 -->
<g id="edge176" class="edge">
<title>residual_1_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M1123,-25926.97C1123,-25912.3 1123,-25895.13 1123,-25879.19"/>
<polygon fill="black" stroke="black" points="1126.5,-25878.93 1123,-25868.93 1119.5,-25878.93 1126.5,-25878.93"/>
</g>
<!-- selection_4 -->
<g id="node154" class="node">
<title>selection_4</title>
<polygon fill="none" stroke="black" points="1123,-25745.59 921,-25692.59 1123,-25639.59 1325,-25692.59 1123,-25745.59"/>
<text text-anchor="middle" x="1123" y="-25703.89" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="1123" y="-25688.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="1123" y="-25673.89" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- gate_4&#45;&gt;selection_4 -->
<g id="edge177" class="edge">
<title>gate_4&#45;&gt;selection_4</title>
<path fill="none" stroke="black" d="M1123,-25782.6C1123,-25774.11 1123,-25765.01 1123,-25756"/>
<polygon fill="black" stroke="black" points="1126.5,-25755.89 1123,-25745.89 1119.5,-25755.89 1126.5,-25755.89"/>
</g>
<!-- expert_4_0_up -->
<g id="node155" class="node">
<title>expert_4_0_up</title>
<polygon fill="lightgreen" stroke="black" points="260,-25567.59 98,-25567.59 98,-25499.59 260,-25499.59 260,-25567.59"/>
<text text-anchor="middle" x="179" y="-25552.39" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="179" y="-25537.39" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="179" y="-25522.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="179" y="-25507.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- selection_4&#45;&gt;expert_4_0_up -->
<g id="edge178" class="edge">
<title>selection_4&#45;&gt;expert_4_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M973.81,-25678.65C833.69,-25665.99 618.31,-25645.2 432,-25621.59 364.65,-25613.05 344.63,-25622.23 281,-25598.59 264.05,-25592.29 246.9,-25582.94 231.63,-25573.31"/>
<polygon fill="red" stroke="red" points="233.17,-25570.14 222.87,-25567.64 229.36,-25576.01 233.17,-25570.14"/>
<text text-anchor="middle" x="496.5" y="-25610.39" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_4_1_up -->
<g id="node158" class="node">
<title>expert_4_1_up</title>
<polygon fill="lightgreen" stroke="black" points="514,-25567.59 352,-25567.59 352,-25499.59 514,-25499.59 514,-25567.59"/>
<text text-anchor="middle" x="433" y="-25552.39" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="433" y="-25537.39" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="433" y="-25522.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="433" y="-25507.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- selection_4&#45;&gt;expert_4_1_up -->
<g id="edge182" class="edge">
<title>selection_4&#45;&gt;expert_4_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M956.88,-25683.17C836.56,-25672.83 671.7,-25649.82 535,-25598.59 518.15,-25592.27 501.09,-25582.96 485.88,-25573.39"/>
<polygon fill="red" stroke="red" points="487.44,-25570.24 477.15,-25567.74 483.64,-25576.11 487.44,-25570.24"/>
<text text-anchor="middle" x="660.5" y="-25610.39" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_4_2_up -->
<g id="node161" class="node">
<title>expert_4_2_up</title>
<polygon fill="lightgreen" stroke="black" points="768,-25567.59 606,-25567.59 606,-25499.59 768,-25499.59 768,-25567.59"/>
<text text-anchor="middle" x="687" y="-25552.39" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="687" y="-25537.39" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="687" y="-25522.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="687" y="-25507.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- selection_4&#45;&gt;expert_4_2_up -->
<g id="edge186" class="edge">
<title>selection_4&#45;&gt;expert_4_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1007.37,-25669.81C941.37,-25654.86 858.25,-25631.66 789,-25598.59 773.77,-25591.31 758,-25582.26 743.54,-25573.28"/>
<polygon fill="red" stroke="red" points="745.05,-25570.09 734.73,-25567.71 741.31,-25576.01 745.05,-25570.09"/>
<text text-anchor="middle" x="905.5" y="-25610.39" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_4_3_up -->
<g id="node164" class="node">
<title>expert_4_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1023,-25567.59 861,-25567.59 861,-25499.59 1023,-25499.59 1023,-25567.59"/>
<text text-anchor="middle" x="942" y="-25552.39" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="942" y="-25537.39" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="942" y="-25522.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="942" y="-25507.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- selection_4&#45;&gt;expert_4_3_up -->
<g id="edge190" class="edge">
<title>selection_4&#45;&gt;expert_4_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1053.82,-25657.49C1036.55,-25647.25 1018.76,-25635.11 1004,-25621.59 989.69,-25608.48 976.72,-25591.55 966.39,-25576.12"/>
<polygon fill="red" stroke="red" points="969.32,-25574.2 960.93,-25567.73 963.45,-25578.02 969.32,-25574.2"/>
<text text-anchor="middle" x="1068.5" y="-25610.39" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_4_4_up -->
<g id="node167" class="node">
<title>expert_4_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1234,-25567.59 1072,-25567.59 1072,-25499.59 1234,-25499.59 1234,-25567.59"/>
<text text-anchor="middle" x="1153" y="-25552.39" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1153" y="-25537.39" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1153" y="-25522.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1153" y="-25507.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- selection_4&#45;&gt;expert_4_4_up -->
<g id="edge194" class="edge">
<title>selection_4&#45;&gt;expert_4_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1132.49,-25641.91C1136.44,-25621.26 1140.98,-25597.51 1144.78,-25577.61"/>
<polygon fill="red" stroke="red" points="1148.25,-25578.07 1146.69,-25567.6 1141.38,-25576.76 1148.25,-25578.07"/>
<text text-anchor="middle" x="1202.5" y="-25610.39" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_4_5_up -->
<g id="node170" class="node">
<title>expert_4_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1488,-25567.59 1326,-25567.59 1326,-25499.59 1488,-25499.59 1488,-25567.59"/>
<text text-anchor="middle" x="1407" y="-25552.39" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1407" y="-25537.39" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1407" y="-25522.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1407" y="-25507.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- selection_4&#45;&gt;expert_4_5_up -->
<g id="edge198" class="edge">
<title>selection_4&#45;&gt;expert_4_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1196.95,-25658.87C1220.9,-25647.67 1247.37,-25634.66 1271,-25621.59 1297.54,-25606.9 1325.94,-25589.09 1349.89,-25573.41"/>
<polygon fill="red" stroke="red" points="1352.07,-25576.16 1358.5,-25567.74 1348.22,-25570.32 1352.07,-25576.16"/>
<text text-anchor="middle" x="1357.5" y="-25610.39" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_4_6_up -->
<g id="node173" class="node">
<title>expert_4_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1742,-25567.59 1580,-25567.59 1580,-25499.59 1742,-25499.59 1742,-25567.59"/>
<text text-anchor="middle" x="1661" y="-25552.39" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1661" y="-25537.39" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1661" y="-25522.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1661" y="-25507.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- selection_4&#45;&gt;expert_4_6_up -->
<g id="edge202" class="edge">
<title>selection_4&#45;&gt;expert_4_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1254.37,-25673.96C1340.68,-25659.76 1454.96,-25635.89 1551,-25598.59 1568.55,-25591.77 1586.61,-25582.4 1602.89,-25572.93"/>
<polygon fill="red" stroke="red" points="1604.92,-25575.79 1611.73,-25567.68 1601.35,-25569.77 1604.92,-25575.79"/>
<text text-anchor="middle" x="1592.5" y="-25610.39" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_4_7_up -->
<g id="node176" class="node">
<title>expert_4_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1996,-25567.59 1834,-25567.59 1834,-25499.59 1996,-25499.59 1996,-25567.59"/>
<text text-anchor="middle" x="1915" y="-25552.39" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1915" y="-25537.39" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1915" y="-25522.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1915" y="-25507.39" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- selection_4&#45;&gt;expert_4_7_up -->
<g id="edge206" class="edge">
<title>selection_4&#45;&gt;expert_4_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1304.42,-25687.13C1444.68,-25678.91 1641.8,-25656.81 1805,-25598.59 1823.09,-25592.14 1841.57,-25582.69 1858.09,-25573.02"/>
<polygon fill="red" stroke="red" points="1860.28,-25575.79 1867.06,-25567.65 1856.68,-25569.79 1860.28,-25575.79"/>
<text text-anchor="middle" x="1833.5" y="-25610.39" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_4_0_gelu -->
<g id="node156" class="node">
<title>expert_4_0_gelu</title>
<ellipse fill="none" stroke="black" cx="154" cy="-25425.11" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="154" y="-25436.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="154" y="-25421.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="154" y="-25406.41" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_0_up&#45;&gt;expert_4_0_gelu -->
<g id="edge179" class="edge">
<title>expert_4_0_up&#45;&gt;expert_4_0_gelu</title>
<path fill="none" stroke="black" d="M171.23,-25499.48C169.21,-25490.87 166.99,-25481.44 164.84,-25472.29"/>
<polygon fill="black" stroke="black" points="168.24,-25471.47 162.55,-25462.53 161.43,-25473.07 168.24,-25471.47"/>
</g>
<!-- expert_4_0_down -->
<g id="node157" class="node">
<title>expert_4_0_down</title>
<polygon fill="lightgreen" stroke="black" points="258.5,-25350.63 105.5,-25350.63 105.5,-25282.63 258.5,-25282.63 258.5,-25350.63"/>
<text text-anchor="middle" x="182" y="-25335.43" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="182" y="-25320.43" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="182" y="-25305.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="182" y="-25290.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_0_gelu&#45;&gt;expert_4_0_down -->
<g id="edge180" class="edge">
<title>expert_4_0_gelu&#45;&gt;expert_4_0_down</title>
<path fill="none" stroke="black" d="M163.64,-25387.47C165.91,-25378.81 168.36,-25369.51 170.7,-25360.6"/>
<polygon fill="black" stroke="black" points="174.13,-25361.34 173.29,-25350.77 167.36,-25359.56 174.13,-25361.34"/>
</g>
<!-- aggregate_4 -->
<g id="node179" class="node">
<title>aggregate_4</title>
<ellipse fill="lightyellow" stroke="black" cx="974" cy="-25066.27" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="974" cy="-25066.27" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="974" y="-25077.57" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="974" y="-25062.57" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="974" y="-25047.57" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_0_down&#45;&gt;aggregate_4 -->
<g id="edge181" class="edge">
<title>expert_4_0_down&#45;&gt;aggregate_4</title>
<path fill="none" stroke="black" d="M258.72,-25282.97C266.21,-25280.05 273.73,-25277.22 281,-25274.63 451.72,-25213.92 650.15,-25155.77 790.81,-25116.58"/>
<polygon fill="black" stroke="black" points="792.14,-25119.85 800.84,-25113.8 790.26,-25113.1 792.14,-25119.85"/>
</g>
<!-- expert_4_1_gelu -->
<g id="node159" class="node">
<title>expert_4_1_gelu</title>
<ellipse fill="none" stroke="black" cx="408" cy="-25425.11" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="408" y="-25436.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="408" y="-25421.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="408" y="-25406.41" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_1_up&#45;&gt;expert_4_1_gelu -->
<g id="edge183" class="edge">
<title>expert_4_1_up&#45;&gt;expert_4_1_gelu</title>
<path fill="none" stroke="black" d="M425.23,-25499.48C423.21,-25490.87 420.99,-25481.44 418.84,-25472.29"/>
<polygon fill="black" stroke="black" points="422.24,-25471.47 416.55,-25462.53 415.43,-25473.07 422.24,-25471.47"/>
</g>
<!-- expert_4_1_down -->
<g id="node160" class="node">
<title>expert_4_1_down</title>
<polygon fill="lightgreen" stroke="black" points="503.5,-25350.63 350.5,-25350.63 350.5,-25282.63 503.5,-25282.63 503.5,-25350.63"/>
<text text-anchor="middle" x="427" y="-25335.43" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="427" y="-25320.43" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="427" y="-25305.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="427" y="-25290.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_1_gelu&#45;&gt;expert_4_1_down -->
<g id="edge184" class="edge">
<title>expert_4_1_gelu&#45;&gt;expert_4_1_down</title>
<path fill="none" stroke="black" d="M414.54,-25387.47C416.07,-25378.91 417.71,-25369.71 419.28,-25360.89"/>
<polygon fill="black" stroke="black" points="422.78,-25361.23 421.09,-25350.77 415.88,-25360 422.78,-25361.23"/>
</g>
<!-- expert_4_1_down&#45;&gt;aggregate_4 -->
<g id="edge185" class="edge">
<title>expert_4_1_down&#45;&gt;aggregate_4</title>
<path fill="none" stroke="black" d="M499.92,-25282.52C576.65,-25247.69 700.15,-25191.61 801.87,-25145.43"/>
<polygon fill="black" stroke="black" points="803.36,-25148.59 811.02,-25141.27 800.47,-25142.22 803.36,-25148.59"/>
</g>
<!-- expert_4_2_gelu -->
<g id="node162" class="node">
<title>expert_4_2_gelu</title>
<ellipse fill="none" stroke="black" cx="662" cy="-25425.11" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="662" y="-25436.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="662" y="-25421.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="662" y="-25406.41" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_2_up&#45;&gt;expert_4_2_gelu -->
<g id="edge187" class="edge">
<title>expert_4_2_up&#45;&gt;expert_4_2_gelu</title>
<path fill="none" stroke="black" d="M679.23,-25499.48C677.21,-25490.87 674.99,-25481.44 672.84,-25472.29"/>
<polygon fill="black" stroke="black" points="676.24,-25471.47 670.55,-25462.53 669.43,-25473.07 676.24,-25471.47"/>
</g>
<!-- expert_4_2_down -->
<g id="node163" class="node">
<title>expert_4_2_down</title>
<polygon fill="lightgreen" stroke="black" points="767.5,-25350.63 614.5,-25350.63 614.5,-25282.63 767.5,-25282.63 767.5,-25350.63"/>
<text text-anchor="middle" x="691" y="-25335.43" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="691" y="-25320.43" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="691" y="-25305.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="691" y="-25290.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_2_gelu&#45;&gt;expert_4_2_down -->
<g id="edge188" class="edge">
<title>expert_4_2_gelu&#45;&gt;expert_4_2_down</title>
<path fill="none" stroke="black" d="M671.9,-25387.77C674.26,-25379.1 676.8,-25369.77 679.24,-25360.82"/>
<polygon fill="black" stroke="black" points="682.67,-25361.52 681.93,-25350.95 675.92,-25359.68 682.67,-25361.52"/>
</g>
<!-- expert_4_2_down&#45;&gt;aggregate_4 -->
<g id="edge189" class="edge">
<title>expert_4_2_down&#45;&gt;aggregate_4</title>
<path fill="none" stroke="black" d="M728.87,-25282.4C755.84,-25258.73 793.93,-25225.3 832.06,-25191.84"/>
<polygon fill="black" stroke="black" points="834.48,-25194.38 839.68,-25185.15 829.86,-25189.11 834.48,-25194.38"/>
</g>
<!-- expert_4_3_gelu -->
<g id="node165" class="node">
<title>expert_4_3_gelu</title>
<ellipse fill="none" stroke="black" cx="916" cy="-25425.11" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="916" y="-25436.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="916" y="-25421.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="916" y="-25406.41" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_3_up&#45;&gt;expert_4_3_gelu -->
<g id="edge191" class="edge">
<title>expert_4_3_up&#45;&gt;expert_4_3_gelu</title>
<path fill="none" stroke="black" d="M933.92,-25499.48C931.81,-25490.87 929.51,-25481.44 927.28,-25472.29"/>
<polygon fill="black" stroke="black" points="930.67,-25471.41 924.89,-25462.53 923.87,-25473.08 930.67,-25471.41"/>
</g>
<!-- expert_4_3_down -->
<g id="node166" class="node">
<title>expert_4_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1021.5,-25350.63 868.5,-25350.63 868.5,-25282.63 1021.5,-25282.63 1021.5,-25350.63"/>
<text text-anchor="middle" x="945" y="-25335.43" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="945" y="-25320.43" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="945" y="-25305.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="945" y="-25290.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_3_gelu&#45;&gt;expert_4_3_down -->
<g id="edge192" class="edge">
<title>expert_4_3_gelu&#45;&gt;expert_4_3_down</title>
<path fill="none" stroke="black" d="M925.9,-25387.77C928.26,-25379.1 930.8,-25369.77 933.24,-25360.82"/>
<polygon fill="black" stroke="black" points="936.67,-25361.52 935.93,-25350.95 929.92,-25359.68 936.67,-25361.52"/>
</g>
<!-- expert_4_3_down&#45;&gt;aggregate_4 -->
<g id="edge193" class="edge">
<title>expert_4_3_down&#45;&gt;aggregate_4</title>
<path fill="none" stroke="black" d="M948.88,-25282.4C949.84,-25274.18 950.94,-25264.79 952.12,-25254.64"/>
<polygon fill="black" stroke="black" points="955.6,-25255.01 953.29,-25244.67 948.65,-25254.2 955.6,-25255.01"/>
</g>
<!-- expert_4_4_gelu -->
<g id="node168" class="node">
<title>expert_4_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1170" cy="-25425.11" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1170" y="-25436.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1170" y="-25421.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1170" y="-25406.41" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_4_up&#45;&gt;expert_4_4_gelu -->
<g id="edge195" class="edge">
<title>expert_4_4_up&#45;&gt;expert_4_4_gelu</title>
<path fill="none" stroke="black" d="M1158.29,-25499.48C1159.63,-25491.05 1161.1,-25481.84 1162.53,-25472.87"/>
<polygon fill="black" stroke="black" points="1166,-25473.33 1164.13,-25462.91 1159.09,-25472.23 1166,-25473.33"/>
</g>
<!-- expert_4_4_down -->
<g id="node169" class="node">
<title>expert_4_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1227.5,-25350.63 1074.5,-25350.63 1074.5,-25282.63 1227.5,-25282.63 1227.5,-25350.63"/>
<text text-anchor="middle" x="1151" y="-25335.43" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1151" y="-25320.43" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1151" y="-25305.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1151" y="-25290.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_4_gelu&#45;&gt;expert_4_4_down -->
<g id="edge196" class="edge">
<title>expert_4_4_gelu&#45;&gt;expert_4_4_down</title>
<path fill="none" stroke="black" d="M1163.46,-25387.47C1161.93,-25378.91 1160.29,-25369.71 1158.72,-25360.89"/>
<polygon fill="black" stroke="black" points="1162.12,-25360 1156.91,-25350.77 1155.22,-25361.23 1162.12,-25360"/>
</g>
<!-- expert_4_4_down&#45;&gt;aggregate_4 -->
<g id="edge197" class="edge">
<title>expert_4_4_down&#45;&gt;aggregate_4</title>
<path fill="none" stroke="black" d="M1127.31,-25282.4C1115.39,-25265.67 1099.99,-25244.06 1083.56,-25221.01"/>
<polygon fill="black" stroke="black" points="1086.37,-25218.92 1077.72,-25212.8 1080.67,-25222.98 1086.37,-25218.92"/>
</g>
<!-- expert_4_5_gelu -->
<g id="node171" class="node">
<title>expert_4_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1424" cy="-25425.11" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1424" y="-25436.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1424" y="-25421.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1424" y="-25406.41" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_5_up&#45;&gt;expert_4_5_gelu -->
<g id="edge199" class="edge">
<title>expert_4_5_up&#45;&gt;expert_4_5_gelu</title>
<path fill="none" stroke="black" d="M1412.29,-25499.48C1413.63,-25491.05 1415.1,-25481.84 1416.53,-25472.87"/>
<polygon fill="black" stroke="black" points="1420,-25473.33 1418.13,-25462.91 1413.09,-25472.23 1420,-25473.33"/>
</g>
<!-- expert_4_5_down -->
<g id="node172" class="node">
<title>expert_4_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1481.5,-25350.63 1328.5,-25350.63 1328.5,-25282.63 1481.5,-25282.63 1481.5,-25350.63"/>
<text text-anchor="middle" x="1405" y="-25335.43" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1405" y="-25320.43" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1405" y="-25305.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1405" y="-25290.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_5_gelu&#45;&gt;expert_4_5_down -->
<g id="edge200" class="edge">
<title>expert_4_5_gelu&#45;&gt;expert_4_5_down</title>
<path fill="none" stroke="black" d="M1417.46,-25387.47C1415.93,-25378.91 1414.29,-25369.71 1412.72,-25360.89"/>
<polygon fill="black" stroke="black" points="1416.12,-25360 1410.91,-25350.77 1409.22,-25361.23 1416.12,-25360"/>
</g>
<!-- expert_4_5_down&#45;&gt;aggregate_4 -->
<g id="edge201" class="edge">
<title>expert_4_5_down&#45;&gt;aggregate_4</title>
<path fill="none" stroke="black" d="M1347.32,-25282.4C1293.87,-25251.59 1211.74,-25204.27 1138.11,-25161.84"/>
<polygon fill="black" stroke="black" points="1139.59,-25158.65 1129.18,-25156.69 1136.09,-25164.72 1139.59,-25158.65"/>
</g>
<!-- expert_4_6_gelu -->
<g id="node174" class="node">
<title>expert_4_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1678" cy="-25425.11" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1678" y="-25436.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1678" y="-25421.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1678" y="-25406.41" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_6_up&#45;&gt;expert_4_6_gelu -->
<g id="edge203" class="edge">
<title>expert_4_6_up&#45;&gt;expert_4_6_gelu</title>
<path fill="none" stroke="black" d="M1666.29,-25499.48C1667.63,-25491.05 1669.1,-25481.84 1670.53,-25472.87"/>
<polygon fill="black" stroke="black" points="1674,-25473.33 1672.13,-25462.91 1667.09,-25472.23 1674,-25473.33"/>
</g>
<!-- expert_4_6_down -->
<g id="node175" class="node">
<title>expert_4_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1735.5,-25350.63 1582.5,-25350.63 1582.5,-25282.63 1735.5,-25282.63 1735.5,-25350.63"/>
<text text-anchor="middle" x="1659" y="-25335.43" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1659" y="-25320.43" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1659" y="-25305.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1659" y="-25290.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_6_gelu&#45;&gt;expert_4_6_down -->
<g id="edge204" class="edge">
<title>expert_4_6_gelu&#45;&gt;expert_4_6_down</title>
<path fill="none" stroke="black" d="M1671.46,-25387.47C1669.93,-25378.91 1668.29,-25369.71 1666.72,-25360.89"/>
<polygon fill="black" stroke="black" points="1670.12,-25360 1664.91,-25350.77 1663.22,-25361.23 1670.12,-25360"/>
</g>
<!-- expert_4_6_down&#45;&gt;aggregate_4 -->
<g id="edge205" class="edge">
<title>expert_4_6_down&#45;&gt;aggregate_4</title>
<path fill="none" stroke="black" d="M1582.36,-25286.35C1571.84,-25282.38 1561.16,-25278.39 1551,-25274.63 1417.7,-25225.39 1266.52,-25171.11 1152.36,-25130.45"/>
<polygon fill="black" stroke="black" points="1153.41,-25127.11 1142.82,-25127.05 1151.06,-25133.7 1153.41,-25127.11"/>
</g>
<!-- expert_4_7_gelu -->
<g id="node177" class="node">
<title>expert_4_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1932" cy="-25425.11" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1932" y="-25436.41" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1932" y="-25421.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1932" y="-25406.41" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_7_up&#45;&gt;expert_4_7_gelu -->
<g id="edge207" class="edge">
<title>expert_4_7_up&#45;&gt;expert_4_7_gelu</title>
<path fill="none" stroke="black" d="M1920.29,-25499.48C1921.63,-25491.05 1923.1,-25481.84 1924.53,-25472.87"/>
<polygon fill="black" stroke="black" points="1928,-25473.33 1926.13,-25462.91 1921.09,-25472.23 1928,-25473.33"/>
</g>
<!-- expert_4_7_down -->
<g id="node178" class="node">
<title>expert_4_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1989.5,-25350.63 1836.5,-25350.63 1836.5,-25282.63 1989.5,-25282.63 1989.5,-25350.63"/>
<text text-anchor="middle" x="1913" y="-25335.43" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1913" y="-25320.43" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1913" y="-25305.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1913" y="-25290.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_4_7_gelu&#45;&gt;expert_4_7_down -->
<g id="edge208" class="edge">
<title>expert_4_7_gelu&#45;&gt;expert_4_7_down</title>
<path fill="none" stroke="black" d="M1925.46,-25387.47C1923.93,-25378.91 1922.29,-25369.71 1920.72,-25360.89"/>
<polygon fill="black" stroke="black" points="1924.12,-25360 1918.91,-25350.77 1917.22,-25361.23 1924.12,-25360"/>
</g>
<!-- expert_4_7_down&#45;&gt;aggregate_4 -->
<g id="edge209" class="edge">
<title>expert_4_7_down&#45;&gt;aggregate_4</title>
<path fill="none" stroke="black" d="M1836.4,-25285.28C1825.91,-25281.5 1815.24,-25277.84 1805,-25274.63 1585.95,-25205.99 1328.89,-25144.73 1159.33,-25106.91"/>
<polygon fill="black" stroke="black" points="1160.07,-25103.49 1149.55,-25104.73 1158.55,-25110.32 1160.07,-25103.49"/>
</g>
<!-- residual_2_4 -->
<g id="node180" class="node">
<title>residual_2_4</title>
<ellipse fill="none" stroke="black" cx="974" cy="-24812.43" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="974" y="-24823.73" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="974" y="-24808.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="974" y="-24793.73" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- aggregate_4&#45;&gt;residual_2_4 -->
<g id="edge210" class="edge">
<title>aggregate_4&#45;&gt;residual_2_4</title>
<path fill="none" stroke="black" d="M974,-24886.61C974,-24877.33 974,-24868.51 974,-24860.42"/>
<polygon fill="black" stroke="black" points="977.5,-24860.23 974,-24850.23 970.5,-24860.23 977.5,-24860.23"/>
</g>
<!-- input_5 -->
<g id="node181" class="node">
<title>input_5</title>
<ellipse fill="none" stroke="black" cx="974" cy="-24629.48" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="974" y="-24640.78" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="974" y="-24625.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="974" y="-24610.78" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_4&#45;&gt;input_5 -->
<g id="edge677" class="edge">
<title>residual_2_4&#45;&gt;input_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M974,-24774.81C974,-24746.73 974,-24707.76 974,-24677.39"/>
<polygon fill="blue" stroke="blue" points="977.5,-24677.04 974,-24667.04 970.5,-24677.04 977.5,-24677.04"/>
<text text-anchor="middle" x="1054.5" y="-24739.76" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1054.5" y="-24724.76" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1054.5" y="-24709.76" font-family="Times,serif" font-size="14.00">GPU 4 &#45;&gt; GPU 5</text>
</g>
<!-- qkv_proj_5 -->
<g id="node182" class="node">
<title>qkv_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="1136,-24534 812,-24534 812,-24466 1136,-24466 1136,-24534"/>
<text text-anchor="middle" x="974" y="-24518.8" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="974" y="-24503.8" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="974" y="-24488.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="974" y="-24473.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- input_5&#45;&gt;qkv_proj_5 -->
<g id="edge211" class="edge">
<title>input_5&#45;&gt;qkv_proj_5</title>
<path fill="none" stroke="black" d="M974,-24591.95C974,-24577.12 974,-24559.88 974,-24544.42"/>
<polygon fill="black" stroke="black" points="977.5,-24544.05 974,-24534.05 970.5,-24544.05 977.5,-24544.05"/>
</g>
<!-- reshape_qkv_5 -->
<g id="node183" class="node">
<title>reshape_qkv_5</title>
<polygon fill="none" stroke="black" points="1328.64,-24429 764.49,-24429 619.36,-24323 1183.51,-24323 1328.64,-24429"/>
<text text-anchor="middle" x="974" y="-24387.3" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="974" y="-24372.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="974" y="-24357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- qkv_proj_5&#45;&gt;reshape_qkv_5 -->
<g id="edge212" class="edge">
<title>qkv_proj_5&#45;&gt;reshape_qkv_5</title>
<path fill="none" stroke="black" d="M974,-24465.99C974,-24457.78 974,-24448.72 974,-24439.6"/>
<polygon fill="black" stroke="black" points="977.5,-24439.34 974,-24429.34 970.5,-24439.34 977.5,-24439.34"/>
</g>
<!-- attn_scores_5 -->
<g id="node184" class="node">
<title>attn_scores_5</title>
<polygon fill="none" stroke="black" points="974,-24286 794,-24233 974,-24180 1154,-24233 974,-24286"/>
<text text-anchor="middle" x="974" y="-24244.3" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="974" y="-24229.3" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="974" y="-24214.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- reshape_qkv_5&#45;&gt;attn_scores_5 -->
<g id="edge213" class="edge">
<title>reshape_qkv_5&#45;&gt;attn_scores_5</title>
<path fill="none" stroke="black" d="M974,-24322.9C974,-24314.33 974,-24305.37 974,-24296.57"/>
<polygon fill="black" stroke="black" points="977.5,-24296.36 974,-24286.36 970.5,-24296.36 977.5,-24296.36"/>
</g>
<!-- attn_weights_5 -->
<g id="node185" class="node">
<title>attn_weights_5</title>
<polygon fill="none" stroke="black" points="974,-24143 794,-24090 974,-24037 1154,-24090 974,-24143"/>
<text text-anchor="middle" x="974" y="-24101.3" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="974" y="-24086.3" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="974" y="-24071.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- attn_scores_5&#45;&gt;attn_weights_5 -->
<g id="edge214" class="edge">
<title>attn_scores_5&#45;&gt;attn_weights_5</title>
<path fill="none" stroke="black" d="M974,-24179.9C974,-24171.33 974,-24162.37 974,-24153.57"/>
<polygon fill="black" stroke="black" points="977.5,-24153.36 974,-24143.36 970.5,-24153.36 977.5,-24153.36"/>
</g>
<!-- attn_output_5 -->
<g id="node186" class="node">
<title>attn_output_5</title>
<polygon fill="none" stroke="black" points="974,-24000 803,-23947 974,-23894 1145,-23947 974,-24000"/>
<text text-anchor="middle" x="974" y="-23958.3" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="974" y="-23943.3" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="974" y="-23928.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- attn_weights_5&#45;&gt;attn_output_5 -->
<g id="edge215" class="edge">
<title>attn_weights_5&#45;&gt;attn_output_5</title>
<path fill="none" stroke="black" d="M974,-24036.9C974,-24028.33 974,-24019.37 974,-24010.57"/>
<polygon fill="black" stroke="black" points="977.5,-24010.36 974,-24000.36 970.5,-24010.36 977.5,-24010.36"/>
</g>
<!-- out_proj_5 -->
<g id="node187" class="node">
<title>out_proj_5</title>
<polygon fill="lightcoral" stroke="black" points="1050.5,-23857 897.5,-23857 897.5,-23789 1050.5,-23789 1050.5,-23857"/>
<text text-anchor="middle" x="974" y="-23841.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="974" y="-23826.8" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="974" y="-23811.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="974" y="-23796.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- attn_output_5&#45;&gt;out_proj_5 -->
<g id="edge216" class="edge">
<title>attn_output_5&#45;&gt;out_proj_5</title>
<path fill="none" stroke="black" d="M974,-23893.91C974,-23885.07 974,-23875.97 974,-23867.39"/>
<polygon fill="black" stroke="black" points="977.5,-23867.22 974,-23857.22 970.5,-23867.22 977.5,-23867.22"/>
</g>
<!-- residual_1_5 -->
<g id="node188" class="node">
<title>residual_1_5</title>
<ellipse fill="none" stroke="black" cx="974" cy="-23714.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="974" y="-23725.83" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="974" y="-23710.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="974" y="-23695.83" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- out_proj_5&#45;&gt;residual_1_5 -->
<g id="edge217" class="edge">
<title>out_proj_5&#45;&gt;residual_1_5</title>
<path fill="none" stroke="black" d="M974,-23788.9C974,-23780.56 974,-23771.45 974,-23762.57"/>
<polygon fill="black" stroke="black" points="977.5,-23762.32 974,-23752.32 970.5,-23762.32 977.5,-23762.32"/>
</g>
<!-- gate_5 -->
<g id="node189" class="node">
<title>gate_5</title>
<polygon fill="lightpink" stroke="black" points="1209.3,-23575.77 1091.65,-23618.82 856.35,-23618.82 738.7,-23575.77 856.35,-23532.72 1091.65,-23532.72 1209.3,-23575.77"/>
<text text-anchor="middle" x="974" y="-23587.07" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="974" y="-23572.07" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="974" y="-23557.07" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- residual_1_5&#45;&gt;gate_5 -->
<g id="edge218" class="edge">
<title>residual_1_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M974,-23676.88C974,-23662.21 974,-23645.04 974,-23629.1"/>
<polygon fill="black" stroke="black" points="977.5,-23628.85 974,-23618.85 970.5,-23628.85 977.5,-23628.85"/>
</g>
<!-- selection_5 -->
<g id="node190" class="node">
<title>selection_5</title>
<polygon fill="none" stroke="black" points="974,-23495.5 772,-23442.5 974,-23389.5 1176,-23442.5 974,-23495.5"/>
<text text-anchor="middle" x="974" y="-23453.8" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="974" y="-23438.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="974" y="-23423.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- gate_5&#45;&gt;selection_5 -->
<g id="edge219" class="edge">
<title>gate_5&#45;&gt;selection_5</title>
<path fill="none" stroke="black" d="M974,-23532.52C974,-23524.02 974,-23514.92 974,-23505.91"/>
<polygon fill="black" stroke="black" points="977.5,-23505.8 974,-23495.8 970.5,-23505.8 977.5,-23505.8"/>
</g>
<!-- expert_5_0_up -->
<g id="node191" class="node">
<title>expert_5_0_up</title>
<polygon fill="lightgreen" stroke="black" points="256,-23317.5 94,-23317.5 94,-23249.5 256,-23249.5 256,-23317.5"/>
<text text-anchor="middle" x="175" y="-23302.3" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="175" y="-23287.3" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="175" y="-23272.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="175" y="-23257.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- selection_5&#45;&gt;expert_5_0_up -->
<g id="edge220" class="edge">
<title>selection_5&#45;&gt;expert_5_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M784.23,-23439.19C640.81,-23432.03 441.24,-23410.31 277,-23348.5 260.15,-23342.16 243.1,-23332.85 227.89,-23323.27"/>
<polygon fill="red" stroke="red" points="229.45,-23320.12 219.16,-23317.63 225.65,-23326 229.45,-23320.12"/>
<text text-anchor="middle" x="394.5" y="-23360.3" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_5_1_up -->
<g id="node194" class="node">
<title>expert_5_1_up</title>
<polygon fill="lightgreen" stroke="black" points="510,-23317.5 348,-23317.5 348,-23249.5 510,-23249.5 510,-23317.5"/>
<text text-anchor="middle" x="429" y="-23302.3" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="429" y="-23287.3" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="429" y="-23272.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="429" y="-23257.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- selection_5&#45;&gt;expert_5_1_up -->
<g id="edge224" class="edge">
<title>selection_5&#45;&gt;expert_5_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M836.59,-23425.43C747.19,-23411.9 629.38,-23388.21 531,-23348.5 514.55,-23341.86 497.8,-23332.59 482.76,-23323.17"/>
<polygon fill="red" stroke="red" points="484.42,-23320.07 474.11,-23317.62 480.64,-23325.96 484.42,-23320.07"/>
<text text-anchor="middle" x="652.5" y="-23360.3" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_5_2_up -->
<g id="node197" class="node">
<title>expert_5_2_up</title>
<polygon fill="lightgreen" stroke="black" points="765,-23317.5 603,-23317.5 603,-23249.5 765,-23249.5 765,-23317.5"/>
<text text-anchor="middle" x="684" y="-23302.3" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="684" y="-23287.3" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="684" y="-23272.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="684" y="-23257.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- selection_5&#45;&gt;expert_5_2_up -->
<g id="edge228" class="edge">
<title>selection_5&#45;&gt;expert_5_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M896.15,-23409.73C870.52,-23398.49 842.15,-23385.22 817,-23371.5 790.57,-23357.09 762.51,-23339.16 739.02,-23323.33"/>
<polygon fill="red" stroke="red" points="740.82,-23320.32 730.58,-23317.6 736.88,-23326.11 740.82,-23320.32"/>
<text text-anchor="middle" x="881.5" y="-23360.3" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_5_3_up -->
<g id="node200" class="node">
<title>expert_5_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1010,-23317.5 848,-23317.5 848,-23249.5 1010,-23249.5 1010,-23317.5"/>
<text text-anchor="middle" x="929" y="-23302.3" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="929" y="-23287.3" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="929" y="-23272.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="929" y="-23257.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- selection_5&#45;&gt;expert_5_3_up -->
<g id="edge232" class="edge">
<title>selection_5&#45;&gt;expert_5_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M960.13,-23393.11C954.09,-23372.05 947.08,-23347.58 941.24,-23327.21"/>
<polygon fill="red" stroke="red" points="944.6,-23326.22 938.48,-23317.57 937.87,-23328.15 944.6,-23326.22"/>
<text text-anchor="middle" x="1016.5" y="-23360.3" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_5_4_up -->
<g id="node203" class="node">
<title>expert_5_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1230,-23317.5 1068,-23317.5 1068,-23249.5 1230,-23249.5 1230,-23317.5"/>
<text text-anchor="middle" x="1149" y="-23302.3" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1149" y="-23287.3" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1149" y="-23272.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1149" y="-23257.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- selection_5&#45;&gt;expert_5_4_up -->
<g id="edge236" class="edge">
<title>selection_5&#45;&gt;expert_5_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1038.89,-23406.27C1054.82,-23396.13 1071.24,-23384.31 1085,-23371.5 1099.24,-23358.24 1112.46,-23341.43 1123.13,-23326.14"/>
<polygon fill="red" stroke="red" points="1126.06,-23328.06 1128.8,-23317.82 1120.27,-23324.12 1126.06,-23328.06"/>
<text text-anchor="middle" x="1163.5" y="-23360.3" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_5_5_up -->
<g id="node206" class="node">
<title>expert_5_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1484,-23317.5 1322,-23317.5 1322,-23249.5 1484,-23249.5 1484,-23317.5"/>
<text text-anchor="middle" x="1403" y="-23302.3" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1403" y="-23287.3" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1403" y="-23272.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1403" y="-23257.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- selection_5&#45;&gt;expert_5_5_up -->
<g id="edge240" class="edge">
<title>selection_5&#45;&gt;expert_5_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1084.59,-23418.51C1147.5,-23403.18 1226.7,-23380.02 1293,-23348.5 1309.01,-23340.89 1325.8,-23331.76 1341.29,-23322.81"/>
<polygon fill="red" stroke="red" points="1343.38,-23325.64 1350.25,-23317.58 1339.85,-23319.6 1343.38,-23325.64"/>
<text text-anchor="middle" x="1332.5" y="-23360.3" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_5_6_up -->
<g id="node209" class="node">
<title>expert_5_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1738,-23317.5 1576,-23317.5 1576,-23249.5 1738,-23249.5 1738,-23317.5"/>
<text text-anchor="middle" x="1657" y="-23302.3" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1657" y="-23287.3" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1657" y="-23272.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1657" y="-23257.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- selection_5&#45;&gt;expert_5_6_up -->
<g id="edge244" class="edge">
<title>selection_5&#45;&gt;expert_5_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1133.53,-23431.31C1250.71,-23420.09 1412.27,-23396.75 1547,-23348.5 1565.08,-23342.03 1583.56,-23332.57 1600.08,-23322.91"/>
<polygon fill="red" stroke="red" points="1602.27,-23325.68 1609.05,-23317.53 1598.67,-23319.67 1602.27,-23325.68"/>
<text text-anchor="middle" x="1581.5" y="-23360.3" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_5_7_up -->
<g id="node212" class="node">
<title>expert_5_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1992,-23317.5 1830,-23317.5 1830,-23249.5 1992,-23249.5 1992,-23317.5"/>
<text text-anchor="middle" x="1911" y="-23302.3" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1911" y="-23287.3" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1911" y="-23272.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1911" y="-23257.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- selection_5&#45;&gt;expert_5_7_up -->
<g id="edge248" class="edge">
<title>selection_5&#45;&gt;expert_5_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1121.93,-23428.24C1259.04,-23415.46 1468.59,-23394.69 1650,-23371.5 1717.34,-23362.89 1736.98,-23371.08 1801,-23348.5 1819.11,-23342.11 1837.6,-23332.69 1854.13,-23323.02"/>
<polygon fill="red" stroke="red" points="1856.31,-23325.79 1863.09,-23317.65 1852.71,-23319.79 1856.31,-23325.79"/>
<text text-anchor="middle" x="1837.5" y="-23360.3" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_5_0_gelu -->
<g id="node192" class="node">
<title>expert_5_0_gelu</title>
<ellipse fill="none" stroke="black" cx="150" cy="-23175.02" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="150" y="-23186.32" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="150" y="-23171.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="150" y="-23156.32" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_0_up&#45;&gt;expert_5_0_gelu -->
<g id="edge221" class="edge">
<title>expert_5_0_up&#45;&gt;expert_5_0_gelu</title>
<path fill="none" stroke="black" d="M167.23,-23249.39C165.21,-23240.79 162.99,-23231.36 160.84,-23222.21"/>
<polygon fill="black" stroke="black" points="164.24,-23221.38 158.55,-23212.44 157.43,-23222.98 164.24,-23221.38"/>
</g>
<!-- expert_5_0_down -->
<g id="node193" class="node">
<title>expert_5_0_down</title>
<polygon fill="lightgreen" stroke="black" points="254.5,-23100.55 101.5,-23100.55 101.5,-23032.55 254.5,-23032.55 254.5,-23100.55"/>
<text text-anchor="middle" x="178" y="-23085.35" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="178" y="-23070.35" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="178" y="-23055.35" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="178" y="-23040.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_0_gelu&#45;&gt;expert_5_0_down -->
<g id="edge222" class="edge">
<title>expert_5_0_gelu&#45;&gt;expert_5_0_down</title>
<path fill="none" stroke="black" d="M159.64,-23137.38C161.91,-23128.73 164.36,-23119.42 166.7,-23110.52"/>
<polygon fill="black" stroke="black" points="170.13,-23111.25 169.29,-23100.69 163.36,-23109.47 170.13,-23111.25"/>
</g>
<!-- aggregate_5 -->
<g id="node215" class="node">
<title>aggregate_5</title>
<ellipse fill="lightyellow" stroke="black" cx="982" cy="-22816.18" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="982" cy="-22816.18" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="982" y="-22827.48" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="982" y="-22812.48" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="982" y="-22797.48" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_0_down&#45;&gt;aggregate_5 -->
<g id="edge223" class="edge">
<title>expert_5_0_down&#45;&gt;aggregate_5</title>
<path fill="none" stroke="black" d="M254.71,-23032.84C262.2,-23029.93 269.72,-23027.12 277,-23024.55 451.93,-22962.79 655.59,-22904.29 798.91,-22865.27"/>
<polygon fill="black" stroke="black" points="799.96,-22868.61 808.69,-22862.61 798.12,-22861.86 799.96,-22868.61"/>
</g>
<!-- expert_5_1_gelu -->
<g id="node195" class="node">
<title>expert_5_1_gelu</title>
<ellipse fill="none" stroke="black" cx="404" cy="-23175.02" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="404" y="-23186.32" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="404" y="-23171.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="404" y="-23156.32" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_1_up&#45;&gt;expert_5_1_gelu -->
<g id="edge225" class="edge">
<title>expert_5_1_up&#45;&gt;expert_5_1_gelu</title>
<path fill="none" stroke="black" d="M421.23,-23249.39C419.21,-23240.79 416.99,-23231.36 414.84,-23222.21"/>
<polygon fill="black" stroke="black" points="418.24,-23221.38 412.55,-23212.44 411.43,-23222.98 418.24,-23221.38"/>
</g>
<!-- expert_5_1_down -->
<g id="node196" class="node">
<title>expert_5_1_down</title>
<polygon fill="lightgreen" stroke="black" points="508.5,-23100.55 355.5,-23100.55 355.5,-23032.55 508.5,-23032.55 508.5,-23100.55"/>
<text text-anchor="middle" x="432" y="-23085.35" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="432" y="-23070.35" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="432" y="-23055.35" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="432" y="-23040.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_1_gelu&#45;&gt;expert_5_1_down -->
<g id="edge226" class="edge">
<title>expert_5_1_gelu&#45;&gt;expert_5_1_down</title>
<path fill="none" stroke="black" d="M413.64,-23137.38C415.91,-23128.73 418.36,-23119.42 420.7,-23110.52"/>
<polygon fill="black" stroke="black" points="424.13,-23111.25 423.29,-23100.69 417.36,-23109.47 424.13,-23111.25"/>
</g>
<!-- expert_5_1_down&#45;&gt;aggregate_5 -->
<g id="edge227" class="edge">
<title>expert_5_1_down&#45;&gt;aggregate_5</title>
<path fill="none" stroke="black" d="M505.32,-23032.44C582.61,-22997.54 707.11,-22941.32 809.49,-22895.08"/>
<polygon fill="black" stroke="black" points="811.03,-22898.23 818.7,-22890.93 808.15,-22891.85 811.03,-22898.23"/>
</g>
<!-- expert_5_2_gelu -->
<g id="node198" class="node">
<title>expert_5_2_gelu</title>
<ellipse fill="none" stroke="black" cx="658" cy="-23175.02" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="658" y="-23186.32" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="658" y="-23171.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="658" y="-23156.32" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_2_up&#45;&gt;expert_5_2_gelu -->
<g id="edge229" class="edge">
<title>expert_5_2_up&#45;&gt;expert_5_2_gelu</title>
<path fill="none" stroke="black" d="M675.92,-23249.39C673.81,-23240.79 671.51,-23231.36 669.28,-23222.21"/>
<polygon fill="black" stroke="black" points="672.67,-23221.33 666.89,-23212.44 665.87,-23222.99 672.67,-23221.33"/>
</g>
<!-- expert_5_2_down -->
<g id="node199" class="node">
<title>expert_5_2_down</title>
<polygon fill="lightgreen" stroke="black" points="762.5,-23100.55 609.5,-23100.55 609.5,-23032.55 762.5,-23032.55 762.5,-23100.55"/>
<text text-anchor="middle" x="686" y="-23085.35" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="686" y="-23070.35" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="686" y="-23055.35" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="686" y="-23040.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_2_gelu&#45;&gt;expert_5_2_down -->
<g id="edge230" class="edge">
<title>expert_5_2_gelu&#45;&gt;expert_5_2_down</title>
<path fill="none" stroke="black" d="M667.64,-23137.38C669.91,-23128.73 672.36,-23119.42 674.7,-23110.52"/>
<polygon fill="black" stroke="black" points="678.13,-23111.25 677.29,-23100.69 671.36,-23109.47 678.13,-23111.25"/>
</g>
<!-- expert_5_2_down&#45;&gt;aggregate_5 -->
<g id="edge231" class="edge">
<title>expert_5_2_down&#45;&gt;aggregate_5</title>
<path fill="none" stroke="black" d="M725.61,-23032.31C754.68,-23007.92 796.1,-22973.17 837.18,-22938.7"/>
<polygon fill="black" stroke="black" points="839.44,-22941.37 844.85,-22932.26 834.94,-22936.01 839.44,-22941.37"/>
</g>
<!-- expert_5_3_gelu -->
<g id="node201" class="node">
<title>expert_5_3_gelu</title>
<ellipse fill="none" stroke="black" cx="912" cy="-23175.02" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="912" y="-23186.32" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="912" y="-23171.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="912" y="-23156.32" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_3_up&#45;&gt;expert_5_3_gelu -->
<g id="edge233" class="edge">
<title>expert_5_3_up&#45;&gt;expert_5_3_gelu</title>
<path fill="none" stroke="black" d="M923.71,-23249.39C922.37,-23240.97 920.9,-23231.75 919.47,-23222.78"/>
<polygon fill="black" stroke="black" points="922.91,-23222.14 917.87,-23212.82 916,-23223.25 922.91,-23222.14"/>
</g>
<!-- expert_5_3_down -->
<g id="node202" class="node">
<title>expert_5_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1024.5,-23100.55 871.5,-23100.55 871.5,-23032.55 1024.5,-23032.55 1024.5,-23100.55"/>
<text text-anchor="middle" x="948" y="-23085.35" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="948" y="-23070.35" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="948" y="-23055.35" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="948" y="-23040.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_3_gelu&#45;&gt;expert_5_3_down -->
<g id="edge234" class="edge">
<title>expert_5_3_gelu&#45;&gt;expert_5_3_down</title>
<path fill="none" stroke="black" d="M924.29,-23137.68C927.25,-23128.92 930.44,-23119.48 933.49,-23110.45"/>
<polygon fill="black" stroke="black" points="936.85,-23111.46 936.73,-23100.87 930.22,-23109.22 936.85,-23111.46"/>
</g>
<!-- expert_5_3_down&#45;&gt;aggregate_5 -->
<g id="edge235" class="edge">
<title>expert_5_3_down&#45;&gt;aggregate_5</title>
<path fill="none" stroke="black" d="M952.55,-23032.31C953.69,-23024 954.99,-23014.48 956.4,-23004.18"/>
<polygon fill="black" stroke="black" points="959.9,-23004.46 957.78,-22994.08 952.96,-23003.51 959.9,-23004.46"/>
</g>
<!-- expert_5_4_gelu -->
<g id="node204" class="node">
<title>expert_5_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1166" cy="-23175.02" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1166" y="-23186.32" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1166" y="-23171.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1166" y="-23156.32" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_4_up&#45;&gt;expert_5_4_gelu -->
<g id="edge237" class="edge">
<title>expert_5_4_up&#45;&gt;expert_5_4_gelu</title>
<path fill="none" stroke="black" d="M1154.29,-23249.39C1155.63,-23240.97 1157.1,-23231.75 1158.53,-23222.78"/>
<polygon fill="black" stroke="black" points="1162,-23223.25 1160.13,-23212.82 1155.09,-23222.14 1162,-23223.25"/>
</g>
<!-- expert_5_4_down -->
<g id="node205" class="node">
<title>expert_5_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1223.5,-23100.55 1070.5,-23100.55 1070.5,-23032.55 1223.5,-23032.55 1223.5,-23100.55"/>
<text text-anchor="middle" x="1147" y="-23085.35" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1147" y="-23070.35" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1147" y="-23055.35" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1147" y="-23040.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_4_gelu&#45;&gt;expert_5_4_down -->
<g id="edge238" class="edge">
<title>expert_5_4_gelu&#45;&gt;expert_5_4_down</title>
<path fill="none" stroke="black" d="M1159.46,-23137.38C1157.93,-23128.82 1156.29,-23119.62 1154.72,-23110.8"/>
<polygon fill="black" stroke="black" points="1158.12,-23109.92 1152.91,-23100.69 1151.22,-23111.15 1158.12,-23109.92"/>
</g>
<!-- expert_5_4_down&#45;&gt;aggregate_5 -->
<g id="edge239" class="edge">
<title>expert_5_4_down&#45;&gt;aggregate_5</title>
<path fill="none" stroke="black" d="M1124.92,-23032.31C1114.37,-23016.43 1100.9,-22996.15 1086.46,-22974.42"/>
<polygon fill="black" stroke="black" points="1089.33,-22972.42 1080.88,-22966.03 1083.5,-22976.29 1089.33,-22972.42"/>
</g>
<!-- expert_5_5_gelu -->
<g id="node207" class="node">
<title>expert_5_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1420" cy="-23175.02" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1420" y="-23186.32" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1420" y="-23171.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1420" y="-23156.32" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_5_up&#45;&gt;expert_5_5_gelu -->
<g id="edge241" class="edge">
<title>expert_5_5_up&#45;&gt;expert_5_5_gelu</title>
<path fill="none" stroke="black" d="M1408.29,-23249.39C1409.63,-23240.97 1411.1,-23231.75 1412.53,-23222.78"/>
<polygon fill="black" stroke="black" points="1416,-23223.25 1414.13,-23212.82 1409.09,-23222.14 1416,-23223.25"/>
</g>
<!-- expert_5_5_down -->
<g id="node208" class="node">
<title>expert_5_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1477.5,-23100.55 1324.5,-23100.55 1324.5,-23032.55 1477.5,-23032.55 1477.5,-23100.55"/>
<text text-anchor="middle" x="1401" y="-23085.35" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1401" y="-23070.35" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1401" y="-23055.35" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1401" y="-23040.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_5_gelu&#45;&gt;expert_5_5_down -->
<g id="edge242" class="edge">
<title>expert_5_5_gelu&#45;&gt;expert_5_5_down</title>
<path fill="none" stroke="black" d="M1413.46,-23137.38C1411.93,-23128.82 1410.29,-23119.62 1408.72,-23110.8"/>
<polygon fill="black" stroke="black" points="1412.12,-23109.92 1406.91,-23100.69 1405.22,-23111.15 1412.12,-23109.92"/>
</g>
<!-- expert_5_5_down&#45;&gt;aggregate_5 -->
<g id="edge243" class="edge">
<title>expert_5_5_down&#45;&gt;aggregate_5</title>
<path fill="none" stroke="black" d="M1344.93,-23032.31C1293.82,-23002.01 1215.74,-22955.73 1145.08,-22913.85"/>
<polygon fill="black" stroke="black" points="1146.44,-22910.59 1136.06,-22908.5 1142.87,-22916.61 1146.44,-22910.59"/>
</g>
<!-- expert_5_6_gelu -->
<g id="node210" class="node">
<title>expert_5_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1674" cy="-23175.02" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1674" y="-23186.32" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1674" y="-23171.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1674" y="-23156.32" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_6_up&#45;&gt;expert_5_6_gelu -->
<g id="edge245" class="edge">
<title>expert_5_6_up&#45;&gt;expert_5_6_gelu</title>
<path fill="none" stroke="black" d="M1662.29,-23249.39C1663.63,-23240.97 1665.1,-23231.75 1666.53,-23222.78"/>
<polygon fill="black" stroke="black" points="1670,-23223.25 1668.13,-23212.82 1663.09,-23222.14 1670,-23223.25"/>
</g>
<!-- expert_5_6_down -->
<g id="node211" class="node">
<title>expert_5_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1731.5,-23100.55 1578.5,-23100.55 1578.5,-23032.55 1731.5,-23032.55 1731.5,-23100.55"/>
<text text-anchor="middle" x="1655" y="-23085.35" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1655" y="-23070.35" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1655" y="-23055.35" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1655" y="-23040.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_6_gelu&#45;&gt;expert_5_6_down -->
<g id="edge246" class="edge">
<title>expert_5_6_gelu&#45;&gt;expert_5_6_down</title>
<path fill="none" stroke="black" d="M1667.46,-23137.38C1665.93,-23128.82 1664.29,-23119.62 1662.72,-23110.8"/>
<polygon fill="black" stroke="black" points="1666.12,-23109.92 1660.91,-23100.69 1659.22,-23111.15 1666.12,-23109.92"/>
</g>
<!-- expert_5_6_down&#45;&gt;aggregate_5 -->
<g id="edge247" class="edge">
<title>expert_5_6_down&#45;&gt;aggregate_5</title>
<path fill="none" stroke="black" d="M1578.34,-23036.33C1567.82,-23032.35 1557.15,-23028.33 1547,-23024.55 1417.64,-22976.26 1271.28,-22922.57 1159.94,-22881.92"/>
<polygon fill="black" stroke="black" points="1160.89,-22878.54 1150.29,-22878.4 1158.49,-22885.11 1160.89,-22878.54"/>
</g>
<!-- expert_5_7_gelu -->
<g id="node213" class="node">
<title>expert_5_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1928" cy="-23175.02" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1928" y="-23186.32" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1928" y="-23171.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1928" y="-23156.32" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_7_up&#45;&gt;expert_5_7_gelu -->
<g id="edge249" class="edge">
<title>expert_5_7_up&#45;&gt;expert_5_7_gelu</title>
<path fill="none" stroke="black" d="M1916.29,-23249.39C1917.63,-23240.97 1919.1,-23231.75 1920.53,-23222.78"/>
<polygon fill="black" stroke="black" points="1924,-23223.25 1922.13,-23212.82 1917.09,-23222.14 1924,-23223.25"/>
</g>
<!-- expert_5_7_down -->
<g id="node214" class="node">
<title>expert_5_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1985.5,-23100.55 1832.5,-23100.55 1832.5,-23032.55 1985.5,-23032.55 1985.5,-23100.55"/>
<text text-anchor="middle" x="1909" y="-23085.35" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1909" y="-23070.35" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1909" y="-23055.35" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1909" y="-23040.35" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_5_7_gelu&#45;&gt;expert_5_7_down -->
<g id="edge250" class="edge">
<title>expert_5_7_gelu&#45;&gt;expert_5_7_down</title>
<path fill="none" stroke="black" d="M1921.46,-23137.38C1919.93,-23128.82 1918.29,-23119.62 1916.72,-23110.8"/>
<polygon fill="black" stroke="black" points="1920.12,-23109.92 1914.91,-23100.69 1913.22,-23111.15 1920.12,-23109.92"/>
</g>
<!-- expert_5_7_down&#45;&gt;aggregate_5 -->
<g id="edge251" class="edge">
<title>expert_5_7_down&#45;&gt;aggregate_5</title>
<path fill="none" stroke="black" d="M1832.39,-23035.23C1821.91,-23031.44 1811.23,-23027.77 1801,-23024.55 1586.18,-22956.82 1334.38,-22895.73 1167.26,-22857.69"/>
<polygon fill="black" stroke="black" points="1167.91,-22854.24 1157.38,-22855.44 1166.35,-22861.07 1167.91,-22854.24"/>
</g>
<!-- residual_2_5 -->
<g id="node216" class="node">
<title>residual_2_5</title>
<ellipse fill="none" stroke="black" cx="982" cy="-22562.35" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="982" y="-22573.65" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="982" y="-22558.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="982" y="-22543.65" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- aggregate_5&#45;&gt;residual_2_5 -->
<g id="edge252" class="edge">
<title>aggregate_5&#45;&gt;residual_2_5</title>
<path fill="none" stroke="black" d="M982,-22636.53C982,-22627.24 982,-22618.42 982,-22610.34"/>
<polygon fill="black" stroke="black" points="985.5,-22610.14 982,-22600.14 978.5,-22610.14 985.5,-22610.14"/>
</g>
<!-- input_6 -->
<g id="node217" class="node">
<title>input_6</title>
<ellipse fill="none" stroke="black" cx="982" cy="-22379.39" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="982" y="-22390.69" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="982" y="-22375.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="982" y="-22360.69" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_5&#45;&gt;input_6 -->
<g id="edge678" class="edge">
<title>residual_2_5&#45;&gt;input_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M982,-22524.73C982,-22496.64 982,-22457.68 982,-22427.31"/>
<polygon fill="blue" stroke="blue" points="985.5,-22426.96 982,-22416.96 978.5,-22426.96 985.5,-22426.96"/>
<text text-anchor="middle" x="1062.5" y="-22489.67" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1062.5" y="-22474.67" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1062.5" y="-22459.67" font-family="Times,serif" font-size="14.00">GPU 5 &#45;&gt; GPU 6</text>
</g>
<!-- qkv_proj_6 -->
<g id="node218" class="node">
<title>qkv_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="1144,-22283.92 820,-22283.92 820,-22215.92 1144,-22215.92 1144,-22283.92"/>
<text text-anchor="middle" x="982" y="-22268.72" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="982" y="-22253.72" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="982" y="-22238.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="982" y="-22223.72" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- input_6&#45;&gt;qkv_proj_6 -->
<g id="edge253" class="edge">
<title>input_6&#45;&gt;qkv_proj_6</title>
<path fill="none" stroke="black" d="M982,-22341.86C982,-22327.04 982,-22309.8 982,-22294.33"/>
<polygon fill="black" stroke="black" points="985.5,-22293.97 982,-22283.97 978.5,-22293.97 985.5,-22293.97"/>
</g>
<!-- reshape_qkv_6 -->
<g id="node219" class="node">
<title>reshape_qkv_6</title>
<polygon fill="none" stroke="black" points="1336.64,-22178.92 772.49,-22178.92 627.36,-22072.92 1191.51,-22072.92 1336.64,-22178.92"/>
<text text-anchor="middle" x="982" y="-22137.22" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="982" y="-22122.22" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="982" y="-22107.22" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- qkv_proj_6&#45;&gt;reshape_qkv_6 -->
<g id="edge254" class="edge">
<title>qkv_proj_6&#45;&gt;reshape_qkv_6</title>
<path fill="none" stroke="black" d="M982,-22215.9C982,-22207.7 982,-22198.63 982,-22189.52"/>
<polygon fill="black" stroke="black" points="985.5,-22189.25 982,-22179.25 978.5,-22189.25 985.5,-22189.25"/>
</g>
<!-- attn_scores_6 -->
<g id="node220" class="node">
<title>attn_scores_6</title>
<polygon fill="none" stroke="black" points="982,-22035.92 802,-21982.92 982,-21929.92 1162,-21982.92 982,-22035.92"/>
<text text-anchor="middle" x="982" y="-21994.22" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="982" y="-21979.22" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="982" y="-21964.22" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- reshape_qkv_6&#45;&gt;attn_scores_6 -->
<g id="edge255" class="edge">
<title>reshape_qkv_6&#45;&gt;attn_scores_6</title>
<path fill="none" stroke="black" d="M982,-22072.81C982,-22064.24 982,-22055.28 982,-22046.49"/>
<polygon fill="black" stroke="black" points="985.5,-22046.27 982,-22036.27 978.5,-22046.27 985.5,-22046.27"/>
</g>
<!-- attn_weights_6 -->
<g id="node221" class="node">
<title>attn_weights_6</title>
<polygon fill="none" stroke="black" points="982,-21892.92 802,-21839.92 982,-21786.92 1162,-21839.92 982,-21892.92"/>
<text text-anchor="middle" x="982" y="-21851.22" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="982" y="-21836.22" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="982" y="-21821.22" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- attn_scores_6&#45;&gt;attn_weights_6 -->
<g id="edge256" class="edge">
<title>attn_scores_6&#45;&gt;attn_weights_6</title>
<path fill="none" stroke="black" d="M982,-21929.81C982,-21921.24 982,-21912.28 982,-21903.49"/>
<polygon fill="black" stroke="black" points="985.5,-21903.27 982,-21893.27 978.5,-21903.27 985.5,-21903.27"/>
</g>
<!-- attn_output_6 -->
<g id="node222" class="node">
<title>attn_output_6</title>
<polygon fill="none" stroke="black" points="982,-21749.92 811,-21696.92 982,-21643.92 1153,-21696.92 982,-21749.92"/>
<text text-anchor="middle" x="982" y="-21708.22" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="982" y="-21693.22" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="982" y="-21678.22" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- attn_weights_6&#45;&gt;attn_output_6 -->
<g id="edge257" class="edge">
<title>attn_weights_6&#45;&gt;attn_output_6</title>
<path fill="none" stroke="black" d="M982,-21786.81C982,-21778.24 982,-21769.28 982,-21760.49"/>
<polygon fill="black" stroke="black" points="985.5,-21760.27 982,-21750.27 978.5,-21760.27 985.5,-21760.27"/>
</g>
<!-- out_proj_6 -->
<g id="node223" class="node">
<title>out_proj_6</title>
<polygon fill="lightcoral" stroke="black" points="1058.5,-21606.92 905.5,-21606.92 905.5,-21538.92 1058.5,-21538.92 1058.5,-21606.92"/>
<text text-anchor="middle" x="982" y="-21591.72" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="982" y="-21576.72" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="982" y="-21561.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="982" y="-21546.72" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- attn_output_6&#45;&gt;out_proj_6 -->
<g id="edge258" class="edge">
<title>attn_output_6&#45;&gt;out_proj_6</title>
<path fill="none" stroke="black" d="M982,-21643.82C982,-21634.98 982,-21625.89 982,-21617.3"/>
<polygon fill="black" stroke="black" points="985.5,-21617.13 982,-21607.13 978.5,-21617.13 985.5,-21617.13"/>
</g>
<!-- residual_1_6 -->
<g id="node224" class="node">
<title>residual_1_6</title>
<ellipse fill="none" stroke="black" cx="982" cy="-21464.44" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="982" y="-21475.74" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="982" y="-21460.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="982" y="-21445.74" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- out_proj_6&#45;&gt;residual_1_6 -->
<g id="edge259" class="edge">
<title>out_proj_6&#45;&gt;residual_1_6</title>
<path fill="none" stroke="black" d="M982,-21538.81C982,-21530.47 982,-21521.36 982,-21512.49"/>
<polygon fill="black" stroke="black" points="985.5,-21512.23 982,-21502.23 978.5,-21512.23 985.5,-21512.23"/>
</g>
<!-- gate_6 -->
<g id="node225" class="node">
<title>gate_6</title>
<polygon fill="lightpink" stroke="black" points="1217.3,-21325.69 1099.65,-21368.74 864.35,-21368.74 746.7,-21325.69 864.35,-21282.64 1099.65,-21282.64 1217.3,-21325.69"/>
<text text-anchor="middle" x="982" y="-21336.99" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="982" y="-21321.99" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="982" y="-21306.99" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- residual_1_6&#45;&gt;gate_6 -->
<g id="edge260" class="edge">
<title>residual_1_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M982,-21426.79C982,-21412.12 982,-21394.95 982,-21379.02"/>
<polygon fill="black" stroke="black" points="985.5,-21378.76 982,-21368.76 978.5,-21378.76 985.5,-21378.76"/>
</g>
<!-- selection_6 -->
<g id="node226" class="node">
<title>selection_6</title>
<polygon fill="none" stroke="black" points="982,-21245.41 780,-21192.41 982,-21139.41 1184,-21192.41 982,-21245.41"/>
<text text-anchor="middle" x="982" y="-21203.71" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="982" y="-21188.71" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="982" y="-21173.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- gate_6&#45;&gt;selection_6 -->
<g id="edge261" class="edge">
<title>gate_6&#45;&gt;selection_6</title>
<path fill="none" stroke="black" d="M982,-21282.43C982,-21273.93 982,-21264.84 982,-21255.82"/>
<polygon fill="black" stroke="black" points="985.5,-21255.72 982,-21245.72 978.5,-21255.72 985.5,-21255.72"/>
</g>
<!-- expert_6_0_up -->
<g id="node227" class="node">
<title>expert_6_0_up</title>
<polygon fill="lightgreen" stroke="black" points="253,-21067.41 91,-21067.41 91,-20999.41 253,-20999.41 253,-21067.41"/>
<text text-anchor="middle" x="172" y="-21052.21" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="172" y="-21037.21" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="172" y="-21022.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="172" y="-21007.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- selection_6&#45;&gt;expert_6_0_up -->
<g id="edge262" class="edge">
<title>selection_6&#45;&gt;expert_6_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M828.99,-21179.49C652.08,-21164.28 372.57,-21135.45 274,-21098.41 257.15,-21092.08 240.1,-21082.77 224.88,-21073.2"/>
<polygon fill="red" stroke="red" points="226.45,-21070.05 216.15,-21067.55 222.65,-21075.92 226.45,-21070.05"/>
<text text-anchor="middle" x="421.5" y="-21110.21" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_6_1_up -->
<g id="node230" class="node">
<title>expert_6_1_up</title>
<polygon fill="lightgreen" stroke="black" points="507,-21067.41 345,-21067.41 345,-20999.41 507,-20999.41 507,-21067.41"/>
<text text-anchor="middle" x="426" y="-21052.21" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="426" y="-21037.21" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="426" y="-21022.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="426" y="-21007.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- selection_6&#45;&gt;expert_6_1_up -->
<g id="edge266" class="edge">
<title>selection_6&#45;&gt;expert_6_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M842.44,-21175.99C750.68,-21162.69 629.29,-21139.01 528,-21098.41 511.45,-21091.78 494.61,-21082.47 479.51,-21072.99"/>
<polygon fill="red" stroke="red" points="481.14,-21069.88 470.84,-21067.42 477.36,-21075.77 481.14,-21069.88"/>
<text text-anchor="middle" x="651.5" y="-21110.21" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_6_2_up -->
<g id="node233" class="node">
<title>expert_6_2_up</title>
<polygon fill="lightgreen" stroke="black" points="762,-21067.41 600,-21067.41 600,-20999.41 762,-20999.41 762,-21067.41"/>
<text text-anchor="middle" x="681" y="-21052.21" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="681" y="-21037.21" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="681" y="-21022.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="681" y="-21007.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- selection_6&#45;&gt;expert_6_2_up -->
<g id="edge270" class="edge">
<title>selection_6&#45;&gt;expert_6_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M904.23,-21159.49C866.45,-21142.92 820.92,-21121.37 782,-21098.41 768.43,-21090.41 754.03,-21081.53 740.49,-21072.99"/>
<polygon fill="red" stroke="red" points="742.05,-21069.84 731.73,-21067.45 738.31,-21075.75 742.05,-21069.84"/>
<text text-anchor="middle" x="882.5" y="-21110.21" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_6_3_up -->
<g id="node236" class="node">
<title>expert_6_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1016,-21067.41 854,-21067.41 854,-20999.41 1016,-20999.41 1016,-21067.41"/>
<text text-anchor="middle" x="935" y="-21052.21" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="935" y="-21037.21" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="935" y="-21022.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="935" y="-21007.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- selection_6&#45;&gt;expert_6_3_up -->
<g id="edge274" class="edge">
<title>selection_6&#45;&gt;expert_6_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M967.51,-21143.03C961.21,-21121.97 953.89,-21097.5 947.79,-21077.12"/>
<polygon fill="red" stroke="red" points="951.12,-21076.06 944.9,-21067.48 944.41,-21078.07 951.12,-21076.06"/>
<text text-anchor="middle" x="1023.5" y="-21110.21" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_6_4_up -->
<g id="node239" class="node">
<title>expert_6_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1227,-21067.41 1065,-21067.41 1065,-20999.41 1227,-20999.41 1227,-21067.41"/>
<text text-anchor="middle" x="1146" y="-21052.21" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1146" y="-21037.21" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1146" y="-21022.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1146" y="-21007.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- selection_6&#45;&gt;expert_6_4_up -->
<g id="edge278" class="edge">
<title>selection_6&#45;&gt;expert_6_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1047.57,-21156.47C1063.17,-21146.39 1079.03,-21134.53 1092,-21121.41 1104.96,-21108.31 1116.27,-21091.55 1125.16,-21076.25"/>
<polygon fill="red" stroke="red" points="1128.25,-21077.88 1130.1,-21067.45 1122.15,-21074.46 1128.25,-21077.88"/>
<text text-anchor="middle" x="1168.5" y="-21110.21" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_6_5_up -->
<g id="node242" class="node">
<title>expert_6_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1481,-21067.41 1319,-21067.41 1319,-20999.41 1481,-20999.41 1481,-21067.41"/>
<text text-anchor="middle" x="1400" y="-21052.21" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1400" y="-21037.21" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1400" y="-21022.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1400" y="-21007.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- selection_6&#45;&gt;expert_6_5_up -->
<g id="edge282" class="edge">
<title>selection_6&#45;&gt;expert_6_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1092.1,-21168.12C1152.5,-21152.92 1227.57,-21129.98 1290,-21098.41 1305.58,-21090.54 1322.01,-21081.43 1337.3,-21072.6"/>
<polygon fill="red" stroke="red" points="1339.27,-21075.5 1346.15,-21067.44 1335.74,-21069.45 1339.27,-21075.5"/>
<text text-anchor="middle" x="1330.5" y="-21110.21" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_6_6_up -->
<g id="node245" class="node">
<title>expert_6_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1735,-21067.41 1573,-21067.41 1573,-20999.41 1735,-20999.41 1735,-21067.41"/>
<text text-anchor="middle" x="1654" y="-21052.21" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1654" y="-21037.21" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1654" y="-21022.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1654" y="-21007.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- selection_6&#45;&gt;expert_6_6_up -->
<g id="edge286" class="edge">
<title>selection_6&#45;&gt;expert_6_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1139.69,-21180.68C1254.52,-21169.22 1412.33,-21145.8 1544,-21098.41 1561.98,-21091.94 1580.36,-21082.54 1596.83,-21072.92"/>
<polygon fill="red" stroke="red" points="1598.98,-21075.72 1605.77,-21067.58 1595.39,-21069.71 1598.98,-21075.72"/>
<text text-anchor="middle" x="1579.5" y="-21110.21" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_6_7_up -->
<g id="node248" class="node">
<title>expert_6_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1989,-21067.41 1827,-21067.41 1827,-20999.41 1989,-20999.41 1989,-21067.41"/>
<text text-anchor="middle" x="1908" y="-21052.21" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1908" y="-21037.21" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1908" y="-21022.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1908" y="-21007.21" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- selection_6&#45;&gt;expert_6_7_up -->
<g id="edge290" class="edge">
<title>selection_6&#45;&gt;expert_6_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1129.05,-21177.98C1264.16,-21165.15 1469.85,-21144.42 1648,-21121.41 1714.89,-21112.77 1734.4,-21120.88 1798,-21098.41 1816.11,-21092.02 1834.59,-21082.59 1851.12,-21072.92"/>
<polygon fill="red" stroke="red" points="1853.31,-21075.69 1860.09,-21067.55 1849.71,-21069.69 1853.31,-21075.69"/>
<text text-anchor="middle" x="1834.5" y="-21110.21" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_6_0_gelu -->
<g id="node228" class="node">
<title>expert_6_0_gelu</title>
<ellipse fill="none" stroke="black" cx="147" cy="-20924.94" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="147" y="-20936.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="147" y="-20921.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="147" y="-20906.24" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_0_up&#45;&gt;expert_6_0_gelu -->
<g id="edge263" class="edge">
<title>expert_6_0_up&#45;&gt;expert_6_0_gelu</title>
<path fill="none" stroke="black" d="M164.23,-20999.31C162.21,-20990.7 159.99,-20981.27 157.84,-20972.12"/>
<polygon fill="black" stroke="black" points="161.24,-20971.29 155.55,-20962.36 154.43,-20972.89 161.24,-20971.29"/>
</g>
<!-- expert_6_0_down -->
<g id="node229" class="node">
<title>expert_6_0_down</title>
<polygon fill="lightgreen" stroke="black" points="242.5,-20850.46 89.5,-20850.46 89.5,-20782.46 242.5,-20782.46 242.5,-20850.46"/>
<text text-anchor="middle" x="166" y="-20835.26" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="166" y="-20820.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="166" y="-20805.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="166" y="-20790.26" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_0_gelu&#45;&gt;expert_6_0_down -->
<g id="edge264" class="edge">
<title>expert_6_0_gelu&#45;&gt;expert_6_0_down</title>
<path fill="none" stroke="black" d="M153.54,-20887.29C155.07,-20878.73 156.71,-20869.54 158.28,-20860.72"/>
<polygon fill="black" stroke="black" points="161.78,-20861.06 160.09,-20850.6 154.88,-20859.83 161.78,-20861.06"/>
</g>
<!-- aggregate_6 -->
<g id="node251" class="node">
<title>aggregate_6</title>
<ellipse fill="lightyellow" stroke="black" cx="915" cy="-20566.1" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="915" cy="-20566.1" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="915" y="-20577.4" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="915" y="-20562.4" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-20547.4" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_0_down&#45;&gt;aggregate_6 -->
<g id="edge265" class="edge">
<title>expert_6_0_down&#45;&gt;aggregate_6</title>
<path fill="none" stroke="black" d="M242.53,-20785.87C253.07,-20781.95 263.78,-20778.05 274,-20774.46 428.35,-20720.23 605.4,-20663.36 734.25,-20622.92"/>
<polygon fill="black" stroke="black" points="735.34,-20626.25 743.84,-20619.91 733.25,-20619.57 735.34,-20626.25"/>
</g>
<!-- expert_6_1_gelu -->
<g id="node231" class="node">
<title>expert_6_1_gelu</title>
<ellipse fill="none" stroke="black" cx="401" cy="-20924.94" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="401" y="-20936.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="401" y="-20921.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="401" y="-20906.24" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_1_up&#45;&gt;expert_6_1_gelu -->
<g id="edge267" class="edge">
<title>expert_6_1_up&#45;&gt;expert_6_1_gelu</title>
<path fill="none" stroke="black" d="M418.23,-20999.31C416.21,-20990.7 413.99,-20981.27 411.84,-20972.12"/>
<polygon fill="black" stroke="black" points="415.24,-20971.29 409.55,-20962.36 408.43,-20972.89 415.24,-20971.29"/>
</g>
<!-- expert_6_1_down -->
<g id="node232" class="node">
<title>expert_6_1_down</title>
<polygon fill="lightgreen" stroke="black" points="496.5,-20850.46 343.5,-20850.46 343.5,-20782.46 496.5,-20782.46 496.5,-20850.46"/>
<text text-anchor="middle" x="420" y="-20835.26" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="420" y="-20820.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="420" y="-20805.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="420" y="-20790.26" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_1_gelu&#45;&gt;expert_6_1_down -->
<g id="edge268" class="edge">
<title>expert_6_1_gelu&#45;&gt;expert_6_1_down</title>
<path fill="none" stroke="black" d="M407.54,-20887.29C409.07,-20878.73 410.71,-20869.54 412.28,-20860.72"/>
<polygon fill="black" stroke="black" points="415.78,-20861.06 414.09,-20850.6 408.88,-20859.83 415.78,-20861.06"/>
</g>
<!-- expert_6_1_down&#45;&gt;aggregate_6 -->
<g id="edge269" class="edge">
<title>expert_6_1_down&#45;&gt;aggregate_6</title>
<path fill="none" stroke="black" d="M485.99,-20782.35C552.09,-20749.19 656.55,-20696.77 745.85,-20651.97"/>
<polygon fill="black" stroke="black" points="747.63,-20654.99 754.99,-20647.38 744.49,-20648.74 747.63,-20654.99"/>
</g>
<!-- expert_6_2_gelu -->
<g id="node234" class="node">
<title>expert_6_2_gelu</title>
<ellipse fill="none" stroke="black" cx="655" cy="-20924.94" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="655" y="-20936.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="655" y="-20921.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="655" y="-20906.24" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_2_up&#45;&gt;expert_6_2_gelu -->
<g id="edge271" class="edge">
<title>expert_6_2_up&#45;&gt;expert_6_2_gelu</title>
<path fill="none" stroke="black" d="M672.92,-20999.31C670.81,-20990.7 668.51,-20981.27 666.28,-20972.12"/>
<polygon fill="black" stroke="black" points="669.67,-20971.24 663.89,-20962.36 662.87,-20972.9 669.67,-20971.24"/>
</g>
<!-- expert_6_2_down -->
<g id="node235" class="node">
<title>expert_6_2_down</title>
<polygon fill="lightgreen" stroke="black" points="759.5,-20850.46 606.5,-20850.46 606.5,-20782.46 759.5,-20782.46 759.5,-20850.46"/>
<text text-anchor="middle" x="683" y="-20835.26" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="683" y="-20820.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="683" y="-20805.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="683" y="-20790.26" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_2_gelu&#45;&gt;expert_6_2_down -->
<g id="edge272" class="edge">
<title>expert_6_2_gelu&#45;&gt;expert_6_2_down</title>
<path fill="none" stroke="black" d="M664.64,-20887.29C666.91,-20878.64 669.36,-20869.34 671.7,-20860.43"/>
<polygon fill="black" stroke="black" points="675.13,-20861.16 674.29,-20850.6 668.36,-20859.38 675.13,-20861.16"/>
</g>
<!-- expert_6_2_down&#45;&gt;aggregate_6 -->
<g id="edge273" class="edge">
<title>expert_6_2_down&#45;&gt;aggregate_6</title>
<path fill="none" stroke="black" d="M714.05,-20782.22C733.17,-20761.75 759.11,-20733.98 786,-20705.2"/>
<polygon fill="black" stroke="black" points="788.58,-20707.56 792.85,-20697.86 783.46,-20702.78 788.58,-20707.56"/>
</g>
<!-- expert_6_3_gelu -->
<g id="node237" class="node">
<title>expert_6_3_gelu</title>
<ellipse fill="none" stroke="black" cx="909" cy="-20924.94" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="909" y="-20936.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="909" y="-20921.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="909" y="-20906.24" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_3_up&#45;&gt;expert_6_3_gelu -->
<g id="edge275" class="edge">
<title>expert_6_3_up&#45;&gt;expert_6_3_gelu</title>
<path fill="none" stroke="black" d="M926.92,-20999.31C924.81,-20990.7 922.51,-20981.27 920.28,-20972.12"/>
<polygon fill="black" stroke="black" points="923.67,-20971.24 917.89,-20962.36 916.87,-20972.9 923.67,-20971.24"/>
</g>
<!-- expert_6_3_down -->
<g id="node238" class="node">
<title>expert_6_3_down</title>
<polygon fill="lightgreen" stroke="black" points="987.5,-20850.46 834.5,-20850.46 834.5,-20782.46 987.5,-20782.46 987.5,-20850.46"/>
<text text-anchor="middle" x="911" y="-20835.26" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="911" y="-20820.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="911" y="-20805.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="911" y="-20790.26" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_3_gelu&#45;&gt;expert_6_3_down -->
<g id="edge276" class="edge">
<title>expert_6_3_gelu&#45;&gt;expert_6_3_down</title>
<path fill="none" stroke="black" d="M909.69,-20887.29C909.85,-20878.73 910.02,-20869.54 910.19,-20860.72"/>
<polygon fill="black" stroke="black" points="913.69,-20860.66 910.38,-20850.6 906.69,-20860.53 913.69,-20860.66"/>
</g>
<!-- expert_6_3_down&#45;&gt;aggregate_6 -->
<g id="edge277" class="edge">
<title>expert_6_3_down&#45;&gt;aggregate_6</title>
<path fill="none" stroke="black" d="M911.54,-20782.22C911.66,-20774.37 911.81,-20765.45 911.96,-20755.81"/>
<polygon fill="black" stroke="black" points="915.46,-20755.58 912.13,-20745.52 908.47,-20755.47 915.46,-20755.58"/>
</g>
<!-- expert_6_4_gelu -->
<g id="node240" class="node">
<title>expert_6_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1163" cy="-20924.94" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1163" y="-20936.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1163" y="-20921.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1163" y="-20906.24" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_4_up&#45;&gt;expert_6_4_gelu -->
<g id="edge279" class="edge">
<title>expert_6_4_up&#45;&gt;expert_6_4_gelu</title>
<path fill="none" stroke="black" d="M1151.29,-20999.31C1152.63,-20990.88 1154.1,-20981.66 1155.53,-20972.7"/>
<polygon fill="black" stroke="black" points="1159,-20973.16 1157.13,-20962.73 1152.09,-20972.05 1159,-20973.16"/>
</g>
<!-- expert_6_4_down -->
<g id="node241" class="node">
<title>expert_6_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1220.5,-20850.46 1067.5,-20850.46 1067.5,-20782.46 1220.5,-20782.46 1220.5,-20850.46"/>
<text text-anchor="middle" x="1144" y="-20835.26" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1144" y="-20820.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1144" y="-20805.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1144" y="-20790.26" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_4_gelu&#45;&gt;expert_6_4_down -->
<g id="edge280" class="edge">
<title>expert_6_4_gelu&#45;&gt;expert_6_4_down</title>
<path fill="none" stroke="black" d="M1156.46,-20887.29C1154.93,-20878.73 1153.29,-20869.54 1151.72,-20860.72"/>
<polygon fill="black" stroke="black" points="1155.12,-20859.83 1149.91,-20850.6 1148.22,-20861.06 1155.12,-20859.83"/>
</g>
<!-- expert_6_4_down&#45;&gt;aggregate_6 -->
<g id="edge281" class="edge">
<title>expert_6_4_down&#45;&gt;aggregate_6</title>
<path fill="none" stroke="black" d="M1113.35,-20782.22C1094.67,-20761.96 1069.39,-20734.54 1043.14,-20706.08"/>
<polygon fill="black" stroke="black" points="1045.44,-20703.4 1036.09,-20698.42 1040.29,-20708.15 1045.44,-20703.4"/>
</g>
<!-- expert_6_5_gelu -->
<g id="node243" class="node">
<title>expert_6_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1417" cy="-20924.94" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1417" y="-20936.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1417" y="-20921.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1417" y="-20906.24" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_5_up&#45;&gt;expert_6_5_gelu -->
<g id="edge283" class="edge">
<title>expert_6_5_up&#45;&gt;expert_6_5_gelu</title>
<path fill="none" stroke="black" d="M1405.29,-20999.31C1406.63,-20990.88 1408.1,-20981.66 1409.53,-20972.7"/>
<polygon fill="black" stroke="black" points="1413,-20973.16 1411.13,-20962.73 1406.09,-20972.05 1413,-20973.16"/>
</g>
<!-- expert_6_5_down -->
<g id="node244" class="node">
<title>expert_6_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1474.5,-20850.46 1321.5,-20850.46 1321.5,-20782.46 1474.5,-20782.46 1474.5,-20850.46"/>
<text text-anchor="middle" x="1398" y="-20835.26" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1398" y="-20820.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1398" y="-20805.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1398" y="-20790.26" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_5_gelu&#45;&gt;expert_6_5_down -->
<g id="edge284" class="edge">
<title>expert_6_5_gelu&#45;&gt;expert_6_5_down</title>
<path fill="none" stroke="black" d="M1410.46,-20887.29C1408.93,-20878.73 1407.29,-20869.54 1405.72,-20860.72"/>
<polygon fill="black" stroke="black" points="1409.12,-20859.83 1403.91,-20850.6 1402.22,-20861.06 1409.12,-20859.83"/>
</g>
<!-- expert_6_5_down&#45;&gt;aggregate_6 -->
<g id="edge285" class="edge">
<title>expert_6_5_down&#45;&gt;aggregate_6</title>
<path fill="none" stroke="black" d="M1333.36,-20782.22C1269.68,-20749.48 1169.68,-20698.06 1083.41,-20653.7"/>
<polygon fill="black" stroke="black" points="1084.8,-20650.48 1074.31,-20649.02 1081.6,-20656.7 1084.8,-20650.48"/>
</g>
<!-- expert_6_6_gelu -->
<g id="node246" class="node">
<title>expert_6_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1671" cy="-20924.94" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1671" y="-20936.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1671" y="-20921.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1671" y="-20906.24" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_6_up&#45;&gt;expert_6_6_gelu -->
<g id="edge287" class="edge">
<title>expert_6_6_up&#45;&gt;expert_6_6_gelu</title>
<path fill="none" stroke="black" d="M1659.29,-20999.31C1660.63,-20990.88 1662.1,-20981.66 1663.53,-20972.7"/>
<polygon fill="black" stroke="black" points="1667,-20973.16 1665.13,-20962.73 1660.09,-20972.05 1667,-20973.16"/>
</g>
<!-- expert_6_6_down -->
<g id="node247" class="node">
<title>expert_6_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1728.5,-20850.46 1575.5,-20850.46 1575.5,-20782.46 1728.5,-20782.46 1728.5,-20850.46"/>
<text text-anchor="middle" x="1652" y="-20835.26" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1652" y="-20820.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1652" y="-20805.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1652" y="-20790.26" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_6_gelu&#45;&gt;expert_6_6_down -->
<g id="edge288" class="edge">
<title>expert_6_6_gelu&#45;&gt;expert_6_6_down</title>
<path fill="none" stroke="black" d="M1664.46,-20887.29C1662.93,-20878.73 1661.29,-20869.54 1659.72,-20860.72"/>
<polygon fill="black" stroke="black" points="1663.12,-20859.83 1657.91,-20850.6 1656.22,-20861.06 1663.12,-20859.83"/>
</g>
<!-- expert_6_6_down&#45;&gt;aggregate_6 -->
<g id="edge289" class="edge">
<title>expert_6_6_down&#45;&gt;aggregate_6</title>
<path fill="none" stroke="black" d="M1575.46,-20785.92C1564.91,-20781.99 1554.21,-20778.08 1544,-20774.46 1393.75,-20721.2 1221.76,-20664.81 1095.65,-20624.3"/>
<polygon fill="black" stroke="black" points="1096.48,-20620.89 1085.89,-20621.17 1094.34,-20627.56 1096.48,-20620.89"/>
</g>
<!-- expert_6_7_gelu -->
<g id="node249" class="node">
<title>expert_6_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1925" cy="-20924.94" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1925" y="-20936.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1925" y="-20921.24" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1925" y="-20906.24" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_7_up&#45;&gt;expert_6_7_gelu -->
<g id="edge291" class="edge">
<title>expert_6_7_up&#45;&gt;expert_6_7_gelu</title>
<path fill="none" stroke="black" d="M1913.29,-20999.31C1914.63,-20990.88 1916.1,-20981.66 1917.53,-20972.7"/>
<polygon fill="black" stroke="black" points="1921,-20973.16 1919.13,-20962.73 1914.09,-20972.05 1921,-20973.16"/>
</g>
<!-- expert_6_7_down -->
<g id="node250" class="node">
<title>expert_6_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1982.5,-20850.46 1829.5,-20850.46 1829.5,-20782.46 1982.5,-20782.46 1982.5,-20850.46"/>
<text text-anchor="middle" x="1906" y="-20835.26" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1906" y="-20820.26" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1906" y="-20805.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1906" y="-20790.26" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_6_7_gelu&#45;&gt;expert_6_7_down -->
<g id="edge292" class="edge">
<title>expert_6_7_gelu&#45;&gt;expert_6_7_down</title>
<path fill="none" stroke="black" d="M1918.46,-20887.29C1916.93,-20878.73 1915.29,-20869.54 1913.72,-20860.72"/>
<polygon fill="black" stroke="black" points="1917.12,-20859.83 1911.91,-20850.6 1910.22,-20861.06 1917.12,-20859.83"/>
</g>
<!-- expert_6_7_down&#45;&gt;aggregate_6 -->
<g id="edge293" class="edge">
<title>expert_6_7_down&#45;&gt;aggregate_6</title>
<path fill="none" stroke="black" d="M1829.44,-20784.97C1818.95,-20781.21 1808.26,-20777.6 1798,-20774.46 1560.67,-20701.89 1280.9,-20640.09 1100.89,-20603.29"/>
<polygon fill="black" stroke="black" points="1101.56,-20599.85 1091.06,-20601.29 1100.16,-20606.71 1101.56,-20599.85"/>
</g>
<!-- residual_2_6 -->
<g id="node252" class="node">
<title>residual_2_6</title>
<ellipse fill="none" stroke="black" cx="915" cy="-20312.26" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="915" y="-20323.56" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="915" y="-20308.56" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-20293.56" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- aggregate_6&#45;&gt;residual_2_6 -->
<g id="edge294" class="edge">
<title>aggregate_6&#45;&gt;residual_2_6</title>
<path fill="none" stroke="black" d="M915,-20386.44C915,-20377.15 915,-20368.34 915,-20360.25"/>
<polygon fill="black" stroke="black" points="918.5,-20360.06 915,-20350.06 911.5,-20360.06 918.5,-20360.06"/>
</g>
<!-- input_7 -->
<g id="node253" class="node">
<title>input_7</title>
<ellipse fill="none" stroke="black" cx="915" cy="-20129.31" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="915" y="-20140.61" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="915" y="-20125.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-20110.61" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_6&#45;&gt;input_7 -->
<g id="edge679" class="edge">
<title>residual_2_6&#45;&gt;input_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M915,-20274.64C915,-20246.56 915,-20207.59 915,-20177.22"/>
<polygon fill="blue" stroke="blue" points="918.5,-20176.87 915,-20166.87 911.5,-20176.87 918.5,-20176.87"/>
<text text-anchor="middle" x="995.5" y="-20239.58" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="995.5" y="-20224.58" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="995.5" y="-20209.58" font-family="Times,serif" font-size="14.00">GPU 6 &#45;&gt; GPU 7</text>
</g>
<!-- qkv_proj_7 -->
<g id="node254" class="node">
<title>qkv_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="1077,-20033.83 753,-20033.83 753,-19965.83 1077,-19965.83 1077,-20033.83"/>
<text text-anchor="middle" x="915" y="-20018.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="915" y="-20003.63" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="915" y="-19988.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="915" y="-19973.63" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- input_7&#45;&gt;qkv_proj_7 -->
<g id="edge295" class="edge">
<title>input_7&#45;&gt;qkv_proj_7</title>
<path fill="none" stroke="black" d="M915,-20091.78C915,-20076.95 915,-20059.71 915,-20044.25"/>
<polygon fill="black" stroke="black" points="918.5,-20043.88 915,-20033.88 911.5,-20043.88 918.5,-20043.88"/>
</g>
<!-- reshape_qkv_7 -->
<g id="node255" class="node">
<title>reshape_qkv_7</title>
<polygon fill="none" stroke="black" points="1269.64,-19928.83 705.49,-19928.83 560.36,-19822.83 1124.51,-19822.83 1269.64,-19928.83"/>
<text text-anchor="middle" x="915" y="-19887.13" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="915" y="-19872.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="915" y="-19857.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- qkv_proj_7&#45;&gt;reshape_qkv_7 -->
<g id="edge296" class="edge">
<title>qkv_proj_7&#45;&gt;reshape_qkv_7</title>
<path fill="none" stroke="black" d="M915,-19965.81C915,-19957.61 915,-19948.54 915,-19939.43"/>
<polygon fill="black" stroke="black" points="918.5,-19939.16 915,-19929.16 911.5,-19939.16 918.5,-19939.16"/>
</g>
<!-- attn_scores_7 -->
<g id="node256" class="node">
<title>attn_scores_7</title>
<polygon fill="none" stroke="black" points="915,-19785.83 735,-19732.83 915,-19679.83 1095,-19732.83 915,-19785.83"/>
<text text-anchor="middle" x="915" y="-19744.13" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="915" y="-19729.13" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="915" y="-19714.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- reshape_qkv_7&#45;&gt;attn_scores_7 -->
<g id="edge297" class="edge">
<title>reshape_qkv_7&#45;&gt;attn_scores_7</title>
<path fill="none" stroke="black" d="M915,-19822.73C915,-19814.16 915,-19805.19 915,-19796.4"/>
<polygon fill="black" stroke="black" points="918.5,-19796.19 915,-19786.19 911.5,-19796.19 918.5,-19796.19"/>
</g>
<!-- attn_weights_7 -->
<g id="node257" class="node">
<title>attn_weights_7</title>
<polygon fill="none" stroke="black" points="915,-19642.83 735,-19589.83 915,-19536.83 1095,-19589.83 915,-19642.83"/>
<text text-anchor="middle" x="915" y="-19601.13" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="915" y="-19586.13" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="915" y="-19571.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- attn_scores_7&#45;&gt;attn_weights_7 -->
<g id="edge298" class="edge">
<title>attn_scores_7&#45;&gt;attn_weights_7</title>
<path fill="none" stroke="black" d="M915,-19679.73C915,-19671.16 915,-19662.19 915,-19653.4"/>
<polygon fill="black" stroke="black" points="918.5,-19653.19 915,-19643.19 911.5,-19653.19 918.5,-19653.19"/>
</g>
<!-- attn_output_7 -->
<g id="node258" class="node">
<title>attn_output_7</title>
<polygon fill="none" stroke="black" points="915,-19499.83 744,-19446.83 915,-19393.83 1086,-19446.83 915,-19499.83"/>
<text text-anchor="middle" x="915" y="-19458.13" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="915" y="-19443.13" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="915" y="-19428.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- attn_weights_7&#45;&gt;attn_output_7 -->
<g id="edge299" class="edge">
<title>attn_weights_7&#45;&gt;attn_output_7</title>
<path fill="none" stroke="black" d="M915,-19536.73C915,-19528.16 915,-19519.19 915,-19510.4"/>
<polygon fill="black" stroke="black" points="918.5,-19510.19 915,-19500.19 911.5,-19510.19 918.5,-19510.19"/>
</g>
<!-- out_proj_7 -->
<g id="node259" class="node">
<title>out_proj_7</title>
<polygon fill="lightcoral" stroke="black" points="991.5,-19356.83 838.5,-19356.83 838.5,-19288.83 991.5,-19288.83 991.5,-19356.83"/>
<text text-anchor="middle" x="915" y="-19341.63" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="915" y="-19326.63" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="915" y="-19311.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-19296.63" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- attn_output_7&#45;&gt;out_proj_7 -->
<g id="edge300" class="edge">
<title>attn_output_7&#45;&gt;out_proj_7</title>
<path fill="none" stroke="black" d="M915,-19393.74C915,-19384.9 915,-19375.8 915,-19367.21"/>
<polygon fill="black" stroke="black" points="918.5,-19367.04 915,-19357.04 911.5,-19367.04 918.5,-19367.04"/>
</g>
<!-- residual_1_7 -->
<g id="node260" class="node">
<title>residual_1_7</title>
<ellipse fill="none" stroke="black" cx="915" cy="-19214.35" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="915" y="-19225.65" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="915" y="-19210.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-19195.65" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- out_proj_7&#45;&gt;residual_1_7 -->
<g id="edge301" class="edge">
<title>out_proj_7&#45;&gt;residual_1_7</title>
<path fill="none" stroke="black" d="M915,-19288.72C915,-19280.39 915,-19271.28 915,-19262.4"/>
<polygon fill="black" stroke="black" points="918.5,-19262.15 915,-19252.15 911.5,-19262.15 918.5,-19262.15"/>
</g>
<!-- gate_7 -->
<g id="node261" class="node">
<title>gate_7</title>
<polygon fill="lightpink" stroke="black" points="1150.3,-19075.6 1032.65,-19118.65 797.35,-19118.65 679.7,-19075.6 797.35,-19032.55 1032.65,-19032.55 1150.3,-19075.6"/>
<text text-anchor="middle" x="915" y="-19086.9" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="915" y="-19071.9" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="915" y="-19056.9" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- residual_1_7&#45;&gt;gate_7 -->
<g id="edge302" class="edge">
<title>residual_1_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M915,-19176.71C915,-19162.04 915,-19144.87 915,-19128.93"/>
<polygon fill="black" stroke="black" points="918.5,-19128.67 915,-19118.67 911.5,-19128.67 918.5,-19128.67"/>
</g>
<!-- selection_7 -->
<g id="node262" class="node">
<title>selection_7</title>
<polygon fill="none" stroke="black" points="915,-18995.33 713,-18942.33 915,-18889.33 1117,-18942.33 915,-18995.33"/>
<text text-anchor="middle" x="915" y="-18953.63" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="915" y="-18938.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="915" y="-18923.63" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- gate_7&#45;&gt;selection_7 -->
<g id="edge303" class="edge">
<title>gate_7&#45;&gt;selection_7</title>
<path fill="none" stroke="black" d="M915,-19032.34C915,-19023.85 915,-19014.75 915,-19005.74"/>
<polygon fill="black" stroke="black" points="918.5,-19005.63 915,-18995.63 911.5,-19005.63 918.5,-19005.63"/>
</g>
<!-- expert_7_0_up -->
<g id="node263" class="node">
<title>expert_7_0_up</title>
<polygon fill="lightgreen" stroke="black" points="259,-18817.33 97,-18817.33 97,-18749.33 259,-18749.33 259,-18817.33"/>
<text text-anchor="middle" x="178" y="-18802.13" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="178" y="-18787.13" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="178" y="-18772.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="178" y="-18757.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- selection_7&#45;&gt;expert_7_0_up -->
<g id="edge304" class="edge">
<title>selection_7&#45;&gt;expert_7_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M739.31,-18935.37C609.02,-18926.28 428.93,-18903.75 280,-18848.33 263.05,-18842.02 245.9,-18832.66 230.63,-18823.04"/>
<polygon fill="red" stroke="red" points="232.17,-18819.87 221.88,-18817.37 228.36,-18825.74 232.17,-18819.87"/>
<text text-anchor="middle" x="409.5" y="-18860.13" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_7_1_up -->
<g id="node266" class="node">
<title>expert_7_1_up</title>
<polygon fill="lightgreen" stroke="black" points="513,-18817.33 351,-18817.33 351,-18749.33 513,-18749.33 513,-18817.33"/>
<text text-anchor="middle" x="432" y="-18802.13" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="432" y="-18787.13" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="432" y="-18772.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="432" y="-18757.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- selection_7&#45;&gt;expert_7_1_up -->
<g id="edge308" class="edge">
<title>selection_7&#45;&gt;expert_7_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M791.7,-18921.63C715.49,-18906.95 616.79,-18883.32 534,-18848.33 517.82,-18841.49 501.28,-18832.25 486.35,-18822.91"/>
<polygon fill="red" stroke="red" points="488.07,-18819.86 477.76,-18817.43 484.3,-18825.76 488.07,-18819.86"/>
<text text-anchor="middle" x="657.5" y="-18860.13" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_7_2_up -->
<g id="node269" class="node">
<title>expert_7_2_up</title>
<polygon fill="lightgreen" stroke="black" points="767,-18817.33 605,-18817.33 605,-18749.33 767,-18749.33 767,-18817.33"/>
<text text-anchor="middle" x="686" y="-18802.13" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="686" y="-18787.13" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="686" y="-18772.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="686" y="-18757.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- selection_7&#45;&gt;expert_7_2_up -->
<g id="edge312" class="edge">
<title>selection_7&#45;&gt;expert_7_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M843.69,-18908C823.15,-18897.29 801.14,-18884.71 782,-18871.33 762.34,-18857.58 742.4,-18840.18 725.82,-18824.56"/>
<polygon fill="red" stroke="red" points="728.1,-18821.91 718.45,-18817.53 723.27,-18826.97 728.1,-18821.91"/>
<text text-anchor="middle" x="846.5" y="-18860.13" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_7_3_up -->
<g id="node272" class="node">
<title>expert_7_3_up</title>
<polygon fill="lightgreen" stroke="black" points="996,-18817.33 834,-18817.33 834,-18749.33 996,-18749.33 996,-18817.33"/>
<text text-anchor="middle" x="915" y="-18802.13" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="915" y="-18787.13" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="915" y="-18772.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="915" y="-18757.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- selection_7&#45;&gt;expert_7_3_up -->
<g id="edge316" class="edge">
<title>selection_7&#45;&gt;expert_7_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M915,-18889.05C915,-18869.18 915,-18846.78 915,-18827.81"/>
<polygon fill="red" stroke="red" points="918.5,-18827.66 915,-18817.66 911.5,-18827.66 918.5,-18827.66"/>
<text text-anchor="middle" x="979.5" y="-18860.13" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_7_4_up -->
<g id="node275" class="node">
<title>expert_7_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1233,-18817.33 1071,-18817.33 1071,-18749.33 1233,-18749.33 1233,-18817.33"/>
<text text-anchor="middle" x="1152" y="-18802.13" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1152" y="-18787.13" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1152" y="-18772.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1152" y="-18757.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- selection_7&#45;&gt;expert_7_4_up -->
<g id="edge320" class="edge">
<title>selection_7&#45;&gt;expert_7_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M985.64,-18907.69C1006.26,-18896.94 1028.49,-18884.4 1048,-18871.33 1068.69,-18857.46 1090.04,-18840.19 1107.97,-18824.71"/>
<polygon fill="red" stroke="red" points="1110.72,-18826.95 1115.95,-18817.74 1106.12,-18821.68 1110.72,-18826.95"/>
<text text-anchor="middle" x="1130.5" y="-18860.13" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_7_5_up -->
<g id="node278" class="node">
<title>expert_7_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1487,-18817.33 1325,-18817.33 1325,-18749.33 1487,-18749.33 1487,-18817.33"/>
<text text-anchor="middle" x="1406" y="-18802.13" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1406" y="-18787.13" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1406" y="-18772.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1406" y="-18757.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- selection_7&#45;&gt;expert_7_5_up -->
<g id="edge324" class="edge">
<title>selection_7&#45;&gt;expert_7_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1036.18,-18921C1112.45,-18905.96 1212.01,-18882.18 1296,-18848.33 1313.29,-18841.36 1331.13,-18832.03 1347.28,-18822.65"/>
<polygon fill="red" stroke="red" points="1349.25,-18825.56 1356.07,-18817.46 1345.68,-18819.54 1349.25,-18825.56"/>
<text text-anchor="middle" x="1330.5" y="-18860.13" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_7_6_up -->
<g id="node281" class="node">
<title>expert_7_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1741,-18817.33 1579,-18817.33 1579,-18749.33 1741,-18749.33 1741,-18817.33"/>
<text text-anchor="middle" x="1660" y="-18802.13" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1660" y="-18787.13" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1660" y="-18772.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1660" y="-18757.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- selection_7&#45;&gt;expert_7_6_up -->
<g id="edge328" class="edge">
<title>selection_7&#45;&gt;expert_7_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1086.05,-18934.17C1216.37,-18924.48 1398.56,-18901.74 1550,-18848.33 1568.11,-18841.94 1586.6,-18832.51 1603.13,-18822.85"/>
<polygon fill="red" stroke="red" points="1605.31,-18825.62 1612.09,-18817.47 1601.71,-18819.61 1605.31,-18825.62"/>
<text text-anchor="middle" x="1581.5" y="-18860.13" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_7_7_up -->
<g id="node284" class="node">
<title>expert_7_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1995,-18817.33 1833,-18817.33 1833,-18749.33 1995,-18749.33 1995,-18817.33"/>
<text text-anchor="middle" x="1914" y="-18802.13" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1914" y="-18787.13" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1914" y="-18772.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1914" y="-18757.13" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- selection_7&#45;&gt;expert_7_7_up -->
<g id="edge332" class="edge">
<title>selection_7&#45;&gt;expert_7_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1067.29,-18929.21C1216.11,-18916.8 1448.97,-18895.89 1650,-18871.33 1718.69,-18862.93 1738.7,-18871.25 1804,-18848.33 1822.21,-18841.94 1840.79,-18832.46 1857.38,-18822.74"/>
<polygon fill="red" stroke="red" points="1859.6,-18825.49 1866.37,-18817.34 1856,-18819.49 1859.6,-18825.49"/>
<text text-anchor="middle" x="1839.5" y="-18860.13" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_7_0_gelu -->
<g id="node264" class="node">
<title>expert_7_0_gelu</title>
<ellipse fill="none" stroke="black" cx="153" cy="-18674.85" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="153" y="-18686.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="153" y="-18671.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="153" y="-18656.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_0_up&#45;&gt;expert_7_0_gelu -->
<g id="edge305" class="edge">
<title>expert_7_0_up&#45;&gt;expert_7_0_gelu</title>
<path fill="none" stroke="black" d="M170.23,-18749.22C168.21,-18740.61 165.99,-18731.18 163.84,-18722.03"/>
<polygon fill="black" stroke="black" points="167.24,-18721.2 161.55,-18712.27 160.43,-18722.81 167.24,-18721.2"/>
</g>
<!-- expert_7_0_down -->
<g id="node265" class="node">
<title>expert_7_0_down</title>
<polygon fill="lightgreen" stroke="black" points="257.5,-18600.37 104.5,-18600.37 104.5,-18532.37 257.5,-18532.37 257.5,-18600.37"/>
<text text-anchor="middle" x="181" y="-18585.17" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="181" y="-18570.17" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="181" y="-18555.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="181" y="-18540.17" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_0_gelu&#45;&gt;expert_7_0_down -->
<g id="edge306" class="edge">
<title>expert_7_0_gelu&#45;&gt;expert_7_0_down</title>
<path fill="none" stroke="black" d="M162.64,-18637.21C164.91,-18628.55 167.36,-18619.25 169.7,-18610.34"/>
<polygon fill="black" stroke="black" points="173.13,-18611.07 172.29,-18600.51 166.36,-18609.29 173.13,-18611.07"/>
</g>
<!-- aggregate_7 -->
<g id="node287" class="node">
<title>aggregate_7</title>
<ellipse fill="lightyellow" stroke="black" cx="1046" cy="-18316.01" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="1046" cy="-18316.01" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="1046" y="-18327.31" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="1046" y="-18312.31" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1046" y="-18297.31" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_0_down&#45;&gt;aggregate_7 -->
<g id="edge307" class="edge">
<title>expert_7_0_down&#45;&gt;aggregate_7</title>
<path fill="none" stroke="black" d="M257.65,-18532.5C265.15,-18529.62 272.69,-18526.86 280,-18524.37 475.75,-18457.65 705.3,-18397.88 861.71,-18359.85"/>
<polygon fill="black" stroke="black" points="862.55,-18363.25 871.44,-18357.49 860.9,-18356.45 862.55,-18363.25"/>
</g>
<!-- expert_7_1_gelu -->
<g id="node267" class="node">
<title>expert_7_1_gelu</title>
<ellipse fill="none" stroke="black" cx="407" cy="-18674.85" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="407" y="-18686.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="407" y="-18671.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="407" y="-18656.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_1_up&#45;&gt;expert_7_1_gelu -->
<g id="edge309" class="edge">
<title>expert_7_1_up&#45;&gt;expert_7_1_gelu</title>
<path fill="none" stroke="black" d="M424.23,-18749.22C422.21,-18740.61 419.99,-18731.18 417.84,-18722.03"/>
<polygon fill="black" stroke="black" points="421.24,-18721.2 415.55,-18712.27 414.43,-18722.81 421.24,-18721.2"/>
</g>
<!-- expert_7_1_down -->
<g id="node268" class="node">
<title>expert_7_1_down</title>
<polygon fill="lightgreen" stroke="black" points="502.5,-18600.37 349.5,-18600.37 349.5,-18532.37 502.5,-18532.37 502.5,-18600.37"/>
<text text-anchor="middle" x="426" y="-18585.17" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="426" y="-18570.17" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="426" y="-18555.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="426" y="-18540.17" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_1_gelu&#45;&gt;expert_7_1_down -->
<g id="edge310" class="edge">
<title>expert_7_1_gelu&#45;&gt;expert_7_1_down</title>
<path fill="none" stroke="black" d="M413.54,-18637.21C415.07,-18628.65 416.71,-18619.45 418.28,-18610.63"/>
<polygon fill="black" stroke="black" points="421.78,-18610.97 420.09,-18600.51 414.88,-18609.74 421.78,-18610.97"/>
</g>
<!-- expert_7_1_down&#45;&gt;aggregate_7 -->
<g id="edge311" class="edge">
<title>expert_7_1_down&#45;&gt;aggregate_7</title>
<path fill="none" stroke="black" d="M502.65,-18534.67C593.82,-18498.15 748.92,-18436.02 870.13,-18387.46"/>
<polygon fill="black" stroke="black" points="871.55,-18390.66 879.53,-18383.7 868.95,-18384.17 871.55,-18390.66"/>
</g>
<!-- expert_7_2_gelu -->
<g id="node270" class="node">
<title>expert_7_2_gelu</title>
<ellipse fill="none" stroke="black" cx="661" cy="-18674.85" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="661" y="-18686.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="661" y="-18671.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="661" y="-18656.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_2_up&#45;&gt;expert_7_2_gelu -->
<g id="edge313" class="edge">
<title>expert_7_2_up&#45;&gt;expert_7_2_gelu</title>
<path fill="none" stroke="black" d="M678.23,-18749.22C676.21,-18740.61 673.99,-18731.18 671.84,-18722.03"/>
<polygon fill="black" stroke="black" points="675.24,-18721.2 669.55,-18712.27 668.43,-18722.81 675.24,-18721.2"/>
</g>
<!-- expert_7_2_down -->
<g id="node271" class="node">
<title>expert_7_2_down</title>
<polygon fill="lightgreen" stroke="black" points="765.5,-18600.37 612.5,-18600.37 612.5,-18532.37 765.5,-18532.37 765.5,-18600.37"/>
<text text-anchor="middle" x="689" y="-18585.17" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="689" y="-18570.17" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="689" y="-18555.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="689" y="-18540.17" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_2_gelu&#45;&gt;expert_7_2_down -->
<g id="edge314" class="edge">
<title>expert_7_2_gelu&#45;&gt;expert_7_2_down</title>
<path fill="none" stroke="black" d="M670.64,-18637.21C672.91,-18628.55 675.36,-18619.25 677.7,-18610.34"/>
<polygon fill="black" stroke="black" points="681.13,-18611.07 680.29,-18600.51 674.36,-18609.29 681.13,-18611.07"/>
</g>
<!-- expert_7_2_down&#45;&gt;aggregate_7 -->
<g id="edge315" class="edge">
<title>expert_7_2_down&#45;&gt;aggregate_7</title>
<path fill="none" stroke="black" d="M736.78,-18532.14C776.35,-18504.6 834.91,-18463.86 890.46,-18425.22"/>
<polygon fill="black" stroke="black" points="892.77,-18427.87 898.98,-18419.29 888.77,-18422.13 892.77,-18427.87"/>
</g>
<!-- expert_7_3_gelu -->
<g id="node273" class="node">
<title>expert_7_3_gelu</title>
<ellipse fill="none" stroke="black" cx="915" cy="-18674.85" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="915" y="-18686.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="915" y="-18671.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="915" y="-18656.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_3_up&#45;&gt;expert_7_3_gelu -->
<g id="edge317" class="edge">
<title>expert_7_3_up&#45;&gt;expert_7_3_gelu</title>
<path fill="none" stroke="black" d="M915,-18749.22C915,-18740.88 915,-18731.77 915,-18722.9"/>
<polygon fill="black" stroke="black" points="918.5,-18722.64 915,-18712.64 911.5,-18722.64 918.5,-18722.64"/>
</g>
<!-- expert_7_3_down -->
<g id="node274" class="node">
<title>expert_7_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1019.5,-18600.37 866.5,-18600.37 866.5,-18532.37 1019.5,-18532.37 1019.5,-18600.37"/>
<text text-anchor="middle" x="943" y="-18585.17" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="943" y="-18570.17" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="943" y="-18555.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="943" y="-18540.17" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_3_gelu&#45;&gt;expert_7_3_down -->
<g id="edge318" class="edge">
<title>expert_7_3_gelu&#45;&gt;expert_7_3_down</title>
<path fill="none" stroke="black" d="M924.64,-18637.21C926.91,-18628.55 929.36,-18619.25 931.7,-18610.34"/>
<polygon fill="black" stroke="black" points="935.13,-18611.07 934.29,-18600.51 928.36,-18609.29 935.13,-18611.07"/>
</g>
<!-- expert_7_3_down&#45;&gt;aggregate_7 -->
<g id="edge319" class="edge">
<title>expert_7_3_down&#45;&gt;aggregate_7</title>
<path fill="none" stroke="black" d="M956.78,-18532.14C961.6,-18520.53 967.38,-18506.58 973.66,-18491.44"/>
<polygon fill="black" stroke="black" points="977.04,-18492.44 977.63,-18481.86 970.57,-18489.76 977.04,-18492.44"/>
</g>
<!-- expert_7_4_gelu -->
<g id="node276" class="node">
<title>expert_7_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1169" cy="-18674.85" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1169" y="-18686.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1169" y="-18671.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1169" y="-18656.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_4_up&#45;&gt;expert_7_4_gelu -->
<g id="edge321" class="edge">
<title>expert_7_4_up&#45;&gt;expert_7_4_gelu</title>
<path fill="none" stroke="black" d="M1157.29,-18749.22C1158.63,-18740.79 1160.1,-18731.58 1161.53,-18722.61"/>
<polygon fill="black" stroke="black" points="1165,-18723.07 1163.13,-18712.64 1158.09,-18721.97 1165,-18723.07"/>
</g>
<!-- expert_7_4_down -->
<g id="node277" class="node">
<title>expert_7_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1226.5,-18600.37 1073.5,-18600.37 1073.5,-18532.37 1226.5,-18532.37 1226.5,-18600.37"/>
<text text-anchor="middle" x="1150" y="-18585.17" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1150" y="-18570.17" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1150" y="-18555.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1150" y="-18540.17" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_4_gelu&#45;&gt;expert_7_4_down -->
<g id="edge322" class="edge">
<title>expert_7_4_gelu&#45;&gt;expert_7_4_down</title>
<path fill="none" stroke="black" d="M1162.46,-18637.21C1160.93,-18628.65 1159.29,-18619.45 1157.72,-18610.63"/>
<polygon fill="black" stroke="black" points="1161.12,-18609.74 1155.91,-18600.51 1154.22,-18610.97 1161.12,-18609.74"/>
</g>
<!-- expert_7_4_down&#45;&gt;aggregate_7 -->
<g id="edge323" class="edge">
<title>expert_7_4_down&#45;&gt;aggregate_7</title>
<path fill="none" stroke="black" d="M1136.08,-18532.14C1131.22,-18520.53 1125.38,-18506.58 1119.04,-18491.44"/>
<polygon fill="black" stroke="black" points="1122.12,-18489.73 1115.03,-18481.86 1115.66,-18492.44 1122.12,-18489.73"/>
</g>
<!-- expert_7_5_gelu -->
<g id="node279" class="node">
<title>expert_7_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1423" cy="-18674.85" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1423" y="-18686.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1423" y="-18671.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1423" y="-18656.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_5_up&#45;&gt;expert_7_5_gelu -->
<g id="edge325" class="edge">
<title>expert_7_5_up&#45;&gt;expert_7_5_gelu</title>
<path fill="none" stroke="black" d="M1411.29,-18749.22C1412.63,-18740.79 1414.1,-18731.58 1415.53,-18722.61"/>
<polygon fill="black" stroke="black" points="1419,-18723.07 1417.13,-18712.64 1412.09,-18721.97 1419,-18723.07"/>
</g>
<!-- expert_7_5_down -->
<g id="node280" class="node">
<title>expert_7_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1480.5,-18600.37 1327.5,-18600.37 1327.5,-18532.37 1480.5,-18532.37 1480.5,-18600.37"/>
<text text-anchor="middle" x="1404" y="-18585.17" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1404" y="-18570.17" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1404" y="-18555.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1404" y="-18540.17" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_5_gelu&#45;&gt;expert_7_5_down -->
<g id="edge326" class="edge">
<title>expert_7_5_gelu&#45;&gt;expert_7_5_down</title>
<path fill="none" stroke="black" d="M1416.46,-18637.21C1414.93,-18628.65 1413.29,-18619.45 1411.72,-18610.63"/>
<polygon fill="black" stroke="black" points="1415.12,-18609.74 1409.91,-18600.51 1408.22,-18610.97 1415.12,-18609.74"/>
</g>
<!-- expert_7_5_down&#45;&gt;aggregate_7 -->
<g id="edge327" class="edge">
<title>expert_7_5_down&#45;&gt;aggregate_7</title>
<path fill="none" stroke="black" d="M1356.09,-18532.14C1316.23,-18504.48 1257.17,-18463.51 1201.26,-18424.72"/>
<polygon fill="black" stroke="black" points="1203.24,-18421.84 1193.03,-18419.01 1199.25,-18427.59 1203.24,-18421.84"/>
</g>
<!-- expert_7_6_gelu -->
<g id="node282" class="node">
<title>expert_7_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1677" cy="-18674.85" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1677" y="-18686.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1677" y="-18671.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1677" y="-18656.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_6_up&#45;&gt;expert_7_6_gelu -->
<g id="edge329" class="edge">
<title>expert_7_6_up&#45;&gt;expert_7_6_gelu</title>
<path fill="none" stroke="black" d="M1665.29,-18749.22C1666.63,-18740.79 1668.1,-18731.58 1669.53,-18722.61"/>
<polygon fill="black" stroke="black" points="1673,-18723.07 1671.13,-18712.64 1666.09,-18721.97 1673,-18723.07"/>
</g>
<!-- expert_7_6_down -->
<g id="node283" class="node">
<title>expert_7_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1734.5,-18600.37 1581.5,-18600.37 1581.5,-18532.37 1734.5,-18532.37 1734.5,-18600.37"/>
<text text-anchor="middle" x="1658" y="-18585.17" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1658" y="-18570.17" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1658" y="-18555.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1658" y="-18540.17" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_6_gelu&#45;&gt;expert_7_6_down -->
<g id="edge330" class="edge">
<title>expert_7_6_gelu&#45;&gt;expert_7_6_down</title>
<path fill="none" stroke="black" d="M1670.46,-18637.21C1668.93,-18628.65 1667.29,-18619.45 1665.72,-18610.63"/>
<polygon fill="black" stroke="black" points="1669.12,-18609.74 1663.91,-18600.51 1662.22,-18610.97 1669.12,-18609.74"/>
</g>
<!-- expert_7_6_down&#45;&gt;aggregate_7 -->
<g id="edge331" class="edge">
<title>expert_7_6_down&#45;&gt;aggregate_7</title>
<path fill="none" stroke="black" d="M1581.42,-18534.29C1491.8,-18497.92 1340.52,-18436.53 1221.58,-18388.27"/>
<polygon fill="black" stroke="black" points="1222.57,-18384.89 1211.99,-18384.37 1219.94,-18391.38 1222.57,-18384.89"/>
</g>
<!-- expert_7_7_gelu -->
<g id="node285" class="node">
<title>expert_7_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1931" cy="-18674.85" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1931" y="-18686.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1931" y="-18671.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1931" y="-18656.15" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_7_up&#45;&gt;expert_7_7_gelu -->
<g id="edge333" class="edge">
<title>expert_7_7_up&#45;&gt;expert_7_7_gelu</title>
<path fill="none" stroke="black" d="M1919.29,-18749.22C1920.63,-18740.79 1922.1,-18731.58 1923.53,-18722.61"/>
<polygon fill="black" stroke="black" points="1927,-18723.07 1925.13,-18712.64 1920.09,-18721.97 1927,-18723.07"/>
</g>
<!-- expert_7_7_down -->
<g id="node286" class="node">
<title>expert_7_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1988.5,-18600.37 1835.5,-18600.37 1835.5,-18532.37 1988.5,-18532.37 1988.5,-18600.37"/>
<text text-anchor="middle" x="1912" y="-18585.17" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1912" y="-18570.17" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1912" y="-18555.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1912" y="-18540.17" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_7_7_gelu&#45;&gt;expert_7_7_down -->
<g id="edge334" class="edge">
<title>expert_7_7_gelu&#45;&gt;expert_7_7_down</title>
<path fill="none" stroke="black" d="M1924.46,-18637.21C1922.93,-18628.65 1921.29,-18619.45 1919.72,-18610.63"/>
<polygon fill="black" stroke="black" points="1923.12,-18609.74 1917.91,-18600.51 1916.22,-18610.97 1923.12,-18609.74"/>
</g>
<!-- expert_7_7_down&#45;&gt;aggregate_7 -->
<g id="edge335" class="edge">
<title>expert_7_7_down&#45;&gt;aggregate_7</title>
<path fill="none" stroke="black" d="M1835.33,-18535.24C1824.86,-18531.42 1814.2,-18527.7 1804,-18524.37 1610.26,-18461.26 1384.6,-18401.21 1230.19,-18362.13"/>
<polygon fill="black" stroke="black" points="1230.68,-18358.65 1220.13,-18359.59 1228.96,-18365.43 1230.68,-18358.65"/>
</g>
<!-- residual_2_7 -->
<g id="node288" class="node">
<title>residual_2_7</title>
<ellipse fill="none" stroke="black" cx="1046" cy="-18062.17" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1046" y="-18073.47" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1046" y="-18058.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1046" y="-18043.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- aggregate_7&#45;&gt;residual_2_7 -->
<g id="edge336" class="edge">
<title>aggregate_7&#45;&gt;residual_2_7</title>
<path fill="none" stroke="black" d="M1046,-18136.35C1046,-18127.07 1046,-18118.25 1046,-18110.16"/>
<polygon fill="black" stroke="black" points="1049.5,-18109.97 1046,-18099.97 1042.5,-18109.97 1049.5,-18109.97"/>
</g>
<!-- input_8 -->
<g id="node289" class="node">
<title>input_8</title>
<ellipse fill="none" stroke="black" cx="1046" cy="-17879.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1046" y="-17890.52" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1046" y="-17875.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1046" y="-17860.52" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_7&#45;&gt;input_8 -->
<g id="edge680" class="edge">
<title>residual_2_7&#45;&gt;input_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1046,-18024.55C1046,-17996.47 1046,-17957.5 1046,-17927.13"/>
<polygon fill="blue" stroke="blue" points="1049.5,-17926.78 1046,-17916.78 1042.5,-17926.78 1049.5,-17926.78"/>
<text text-anchor="middle" x="1126.5" y="-17989.5" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1126.5" y="-17974.5" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1126.5" y="-17959.5" font-family="Times,serif" font-size="14.00">GPU 7 &#45;&gt; GPU 8</text>
</g>
<!-- qkv_proj_8 -->
<g id="node290" class="node">
<title>qkv_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="1208,-17783.74 884,-17783.74 884,-17715.74 1208,-17715.74 1208,-17783.74"/>
<text text-anchor="middle" x="1046" y="-17768.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1046" y="-17753.54" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1046" y="-17738.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="1046" y="-17723.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- input_8&#45;&gt;qkv_proj_8 -->
<g id="edge337" class="edge">
<title>input_8&#45;&gt;qkv_proj_8</title>
<path fill="none" stroke="black" d="M1046,-17841.69C1046,-17826.86 1046,-17809.62 1046,-17794.16"/>
<polygon fill="black" stroke="black" points="1049.5,-17793.79 1046,-17783.79 1042.5,-17793.79 1049.5,-17793.79"/>
</g>
<!-- reshape_qkv_8 -->
<g id="node291" class="node">
<title>reshape_qkv_8</title>
<polygon fill="none" stroke="black" points="1400.64,-17678.74 836.49,-17678.74 691.36,-17572.74 1255.51,-17572.74 1400.64,-17678.74"/>
<text text-anchor="middle" x="1046" y="-17637.04" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="1046" y="-17622.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1046" y="-17607.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- qkv_proj_8&#45;&gt;reshape_qkv_8 -->
<g id="edge338" class="edge">
<title>qkv_proj_8&#45;&gt;reshape_qkv_8</title>
<path fill="none" stroke="black" d="M1046,-17715.73C1046,-17707.52 1046,-17698.46 1046,-17689.34"/>
<polygon fill="black" stroke="black" points="1049.5,-17689.08 1046,-17679.08 1042.5,-17689.08 1049.5,-17689.08"/>
</g>
<!-- attn_scores_8 -->
<g id="node292" class="node">
<title>attn_scores_8</title>
<polygon fill="none" stroke="black" points="1046,-17535.74 866,-17482.74 1046,-17429.74 1226,-17482.74 1046,-17535.74"/>
<text text-anchor="middle" x="1046" y="-17494.04" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1046" y="-17479.04" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1046" y="-17464.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- reshape_qkv_8&#45;&gt;attn_scores_8 -->
<g id="edge339" class="edge">
<title>reshape_qkv_8&#45;&gt;attn_scores_8</title>
<path fill="none" stroke="black" d="M1046,-17572.64C1046,-17564.07 1046,-17555.11 1046,-17546.31"/>
<polygon fill="black" stroke="black" points="1049.5,-17546.1 1046,-17536.1 1042.5,-17546.1 1049.5,-17546.1"/>
</g>
<!-- attn_weights_8 -->
<g id="node293" class="node">
<title>attn_weights_8</title>
<polygon fill="none" stroke="black" points="1046,-17392.74 866,-17339.74 1046,-17286.74 1226,-17339.74 1046,-17392.74"/>
<text text-anchor="middle" x="1046" y="-17351.04" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1046" y="-17336.04" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1046" y="-17321.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- attn_scores_8&#45;&gt;attn_weights_8 -->
<g id="edge340" class="edge">
<title>attn_scores_8&#45;&gt;attn_weights_8</title>
<path fill="none" stroke="black" d="M1046,-17429.64C1046,-17421.07 1046,-17412.11 1046,-17403.31"/>
<polygon fill="black" stroke="black" points="1049.5,-17403.1 1046,-17393.1 1042.5,-17403.1 1049.5,-17403.1"/>
</g>
<!-- attn_output_8 -->
<g id="node294" class="node">
<title>attn_output_8</title>
<polygon fill="none" stroke="black" points="1046,-17249.74 875,-17196.74 1046,-17143.74 1217,-17196.74 1046,-17249.74"/>
<text text-anchor="middle" x="1046" y="-17208.04" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="1046" y="-17193.04" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1046" y="-17178.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- attn_weights_8&#45;&gt;attn_output_8 -->
<g id="edge341" class="edge">
<title>attn_weights_8&#45;&gt;attn_output_8</title>
<path fill="none" stroke="black" d="M1046,-17286.64C1046,-17278.07 1046,-17269.11 1046,-17260.31"/>
<polygon fill="black" stroke="black" points="1049.5,-17260.1 1046,-17250.1 1042.5,-17260.1 1049.5,-17260.1"/>
</g>
<!-- out_proj_8 -->
<g id="node295" class="node">
<title>out_proj_8</title>
<polygon fill="lightcoral" stroke="black" points="1122.5,-17106.74 969.5,-17106.74 969.5,-17038.74 1122.5,-17038.74 1122.5,-17106.74"/>
<text text-anchor="middle" x="1046" y="-17091.54" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1046" y="-17076.54" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1046" y="-17061.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1046" y="-17046.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- attn_output_8&#45;&gt;out_proj_8 -->
<g id="edge342" class="edge">
<title>attn_output_8&#45;&gt;out_proj_8</title>
<path fill="none" stroke="black" d="M1046,-17143.65C1046,-17134.81 1046,-17125.71 1046,-17117.13"/>
<polygon fill="black" stroke="black" points="1049.5,-17116.96 1046,-17106.96 1042.5,-17116.96 1049.5,-17116.96"/>
</g>
<!-- residual_1_8 -->
<g id="node296" class="node">
<title>residual_1_8</title>
<ellipse fill="none" stroke="black" cx="1046" cy="-16964.27" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1046" y="-16975.57" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1046" y="-16960.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1046" y="-16945.57" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- out_proj_8&#45;&gt;residual_1_8 -->
<g id="edge343" class="edge">
<title>out_proj_8&#45;&gt;residual_1_8</title>
<path fill="none" stroke="black" d="M1046,-17038.64C1046,-17030.3 1046,-17021.19 1046,-17012.31"/>
<polygon fill="black" stroke="black" points="1049.5,-17012.06 1046,-17002.06 1042.5,-17012.06 1049.5,-17012.06"/>
</g>
<!-- gate_8 -->
<g id="node297" class="node">
<title>gate_8</title>
<polygon fill="lightpink" stroke="black" points="1281.3,-16825.51 1163.65,-16868.56 928.35,-16868.56 810.7,-16825.51 928.35,-16782.46 1163.65,-16782.46 1281.3,-16825.51"/>
<text text-anchor="middle" x="1046" y="-16836.81" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1046" y="-16821.81" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="1046" y="-16806.81" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- residual_1_8&#45;&gt;gate_8 -->
<g id="edge344" class="edge">
<title>residual_1_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M1046,-16926.62C1046,-16911.95 1046,-16894.78 1046,-16878.84"/>
<polygon fill="black" stroke="black" points="1049.5,-16878.59 1046,-16868.59 1042.5,-16878.59 1049.5,-16878.59"/>
</g>
<!-- selection_8 -->
<g id="node298" class="node">
<title>selection_8</title>
<polygon fill="none" stroke="black" points="1046,-16745.24 844,-16692.24 1046,-16639.24 1248,-16692.24 1046,-16745.24"/>
<text text-anchor="middle" x="1046" y="-16703.54" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="1046" y="-16688.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="1046" y="-16673.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- gate_8&#45;&gt;selection_8 -->
<g id="edge345" class="edge">
<title>gate_8&#45;&gt;selection_8</title>
<path fill="none" stroke="black" d="M1046,-16782.26C1046,-16773.76 1046,-16764.66 1046,-16755.65"/>
<polygon fill="black" stroke="black" points="1049.5,-16755.54 1046,-16745.54 1042.5,-16755.54 1049.5,-16755.54"/>
</g>
<!-- expert_8_0_up -->
<g id="node299" class="node">
<title>expert_8_0_up</title>
<polygon fill="lightgreen" stroke="black" points="253,-16567.24 91,-16567.24 91,-16499.24 253,-16499.24 253,-16567.24"/>
<text text-anchor="middle" x="172" y="-16552.04" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="172" y="-16537.04" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="172" y="-16522.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="172" y="-16507.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- selection_8&#45;&gt;expert_8_0_up -->
<g id="edge346" class="edge">
<title>selection_8&#45;&gt;expert_8_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M886.74,-16680.93C694.31,-16666.94 382.82,-16638.93 274,-16598.24 257.06,-16591.91 239.92,-16582.54 224.65,-16572.92"/>
<polygon fill="red" stroke="red" points="226.18,-16569.75 215.89,-16567.25 222.38,-16575.62 226.18,-16569.75"/>
<text text-anchor="middle" x="413.5" y="-16610.04" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_8_1_up -->
<g id="node302" class="node">
<title>expert_8_1_up</title>
<polygon fill="lightgreen" stroke="black" points="507,-16567.24 345,-16567.24 345,-16499.24 507,-16499.24 507,-16567.24"/>
<text text-anchor="middle" x="426" y="-16552.04" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="426" y="-16537.04" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="426" y="-16522.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="426" y="-16507.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- selection_8&#45;&gt;expert_8_1_up -->
<g id="edge350" class="edge">
<title>selection_8&#45;&gt;expert_8_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M893.11,-16679.26C787.71,-16667.32 645.92,-16643.84 528,-16598.24 511.29,-16591.78 494.34,-16582.47 479.18,-16572.95"/>
<polygon fill="red" stroke="red" points="480.78,-16569.82 470.48,-16567.34 476.99,-16575.7 480.78,-16569.82"/>
<text text-anchor="middle" x="645.5" y="-16610.04" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_8_2_up -->
<g id="node305" class="node">
<title>expert_8_2_up</title>
<polygon fill="lightgreen" stroke="black" points="762,-16567.24 600,-16567.24 600,-16499.24 762,-16499.24 762,-16567.24"/>
<text text-anchor="middle" x="681" y="-16552.04" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="681" y="-16537.04" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="681" y="-16522.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="681" y="-16507.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- selection_8&#45;&gt;expert_8_2_up -->
<g id="edge354" class="edge">
<title>selection_8&#45;&gt;expert_8_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M944.21,-16665.9C904.32,-16654.42 858.68,-16639.33 819,-16621.24 801.38,-16613.21 798.4,-16608.53 782,-16598.24 768.95,-16590.05 754.97,-16581.22 741.7,-16572.83"/>
<polygon fill="red" stroke="red" points="743.43,-16569.77 733.11,-16567.38 739.68,-16575.69 743.43,-16569.77"/>
<text text-anchor="middle" x="883.5" y="-16610.04" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_8_3_up -->
<g id="node308" class="node">
<title>expert_8_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1015,-16567.24 853,-16567.24 853,-16499.24 1015,-16499.24 1015,-16567.24"/>
<text text-anchor="middle" x="934" y="-16552.04" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="934" y="-16537.04" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="934" y="-16522.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="934" y="-16507.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- selection_8&#45;&gt;expert_8_3_up -->
<g id="edge358" class="edge">
<title>selection_8&#45;&gt;expert_8_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M989.85,-16653.75C978.72,-16644.22 968.02,-16633.25 960,-16621.24 951.32,-16608.25 945.46,-16592.27 941.54,-16577.57"/>
<polygon fill="red" stroke="red" points="944.9,-16576.54 939.13,-16567.65 938.09,-16578.2 944.9,-16576.54"/>
<text text-anchor="middle" x="1024.5" y="-16610.04" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_8_4_up -->
<g id="node311" class="node">
<title>expert_8_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1227,-16567.24 1065,-16567.24 1065,-16499.24 1227,-16499.24 1227,-16567.24"/>
<text text-anchor="middle" x="1146" y="-16552.04" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1146" y="-16537.04" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1146" y="-16522.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1146" y="-16507.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- selection_8&#45;&gt;expert_8_4_up -->
<g id="edge362" class="edge">
<title>selection_8&#45;&gt;expert_8_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1074.39,-16646.67C1088.5,-16624.52 1105.45,-16597.91 1119.32,-16576.13"/>
<polygon fill="red" stroke="red" points="1122.44,-16577.75 1124.86,-16567.43 1116.53,-16573.99 1122.44,-16577.75"/>
<text text-anchor="middle" x="1162.5" y="-16610.04" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_8_5_up -->
<g id="node314" class="node">
<title>expert_8_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1481,-16567.24 1319,-16567.24 1319,-16499.24 1481,-16499.24 1481,-16567.24"/>
<text text-anchor="middle" x="1400" y="-16552.04" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1400" y="-16537.04" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1400" y="-16522.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1400" y="-16507.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- selection_8&#45;&gt;expert_8_5_up -->
<g id="edge366" class="edge">
<title>selection_8&#45;&gt;expert_8_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1133.33,-16662.04C1180.54,-16645.24 1239.37,-16622.66 1290,-16598.24 1305.89,-16590.58 1322.56,-16581.47 1337.99,-16572.57"/>
<polygon fill="red" stroke="red" points="1340.04,-16575.42 1346.91,-16567.36 1336.51,-16569.38 1340.04,-16575.42"/>
<text text-anchor="middle" x="1334.5" y="-16610.04" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_8_6_up -->
<g id="node317" class="node">
<title>expert_8_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1735,-16567.24 1573,-16567.24 1573,-16499.24 1735,-16499.24 1735,-16567.24"/>
<text text-anchor="middle" x="1654" y="-16552.04" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1654" y="-16537.04" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1654" y="-16522.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1654" y="-16507.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- selection_8&#45;&gt;expert_8_6_up -->
<g id="edge370" class="edge">
<title>selection_8&#45;&gt;expert_8_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1191.44,-16677.37C1292.68,-16664.54 1429.5,-16640.79 1544,-16598.24 1561.82,-16591.62 1580.1,-16582.21 1596.5,-16572.65"/>
<polygon fill="red" stroke="red" points="1598.61,-16575.46 1605.41,-16567.33 1595.03,-16569.45 1598.61,-16575.46"/>
<text text-anchor="middle" x="1582.5" y="-16610.04" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_8_7_up -->
<g id="node320" class="node">
<title>expert_8_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1989,-16567.24 1827,-16567.24 1827,-16499.24 1989,-16499.24 1989,-16567.24"/>
<text text-anchor="middle" x="1908" y="-16552.04" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1908" y="-16537.04" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1908" y="-16522.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1908" y="-16507.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- selection_8&#45;&gt;expert_8_7_up -->
<g id="edge374" class="edge">
<title>selection_8&#45;&gt;expert_8_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1201.73,-16679.96C1389.01,-16665.01 1691.46,-16636.06 1798,-16598.24 1816.1,-16591.82 1834.58,-16582.38 1851.11,-16572.71"/>
<polygon fill="red" stroke="red" points="1853.3,-16575.48 1860.07,-16567.34 1849.7,-16569.48 1853.3,-16575.48"/>
<text text-anchor="middle" x="1828.5" y="-16610.04" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_8_0_gelu -->
<g id="node300" class="node">
<title>expert_8_0_gelu</title>
<ellipse fill="none" stroke="black" cx="147" cy="-16424.76" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="147" y="-16436.06" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="147" y="-16421.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="147" y="-16406.06" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_0_up&#45;&gt;expert_8_0_gelu -->
<g id="edge347" class="edge">
<title>expert_8_0_up&#45;&gt;expert_8_0_gelu</title>
<path fill="none" stroke="black" d="M164.23,-16499.13C162.21,-16490.53 159.99,-16481.09 157.84,-16471.95"/>
<polygon fill="black" stroke="black" points="161.24,-16471.12 155.55,-16462.18 154.43,-16472.72 161.24,-16471.12"/>
</g>
<!-- expert_8_0_down -->
<g id="node301" class="node">
<title>expert_8_0_down</title>
<polygon fill="lightgreen" stroke="black" points="251.5,-16350.29 98.5,-16350.29 98.5,-16282.29 251.5,-16282.29 251.5,-16350.29"/>
<text text-anchor="middle" x="175" y="-16335.09" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="175" y="-16320.09" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="175" y="-16305.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="175" y="-16290.09" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_0_gelu&#45;&gt;expert_8_0_down -->
<g id="edge348" class="edge">
<title>expert_8_0_gelu&#45;&gt;expert_8_0_down</title>
<path fill="none" stroke="black" d="M156.64,-16387.12C158.91,-16378.47 161.36,-16369.16 163.7,-16360.26"/>
<polygon fill="black" stroke="black" points="167.13,-16360.99 166.29,-16350.43 160.36,-16359.21 167.13,-16360.99"/>
</g>
<!-- aggregate_8 -->
<g id="node323" class="node">
<title>aggregate_8</title>
<ellipse fill="lightyellow" stroke="black" cx="947" cy="-16065.92" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="947" cy="-16065.92" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="947" y="-16077.22" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="947" y="-16062.22" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="947" y="-16047.22" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_0_down&#45;&gt;aggregate_8 -->
<g id="edge349" class="edge">
<title>expert_8_0_down&#45;&gt;aggregate_8</title>
<path fill="none" stroke="black" d="M251.74,-16282.68C259.23,-16279.75 266.74,-16276.9 274,-16274.29 438.14,-16215.16 628.4,-16157.52 764.67,-16118.08"/>
<polygon fill="black" stroke="black" points="765.75,-16121.41 774.38,-16115.27 763.8,-16114.68 765.75,-16121.41"/>
</g>
<!-- expert_8_1_gelu -->
<g id="node303" class="node">
<title>expert_8_1_gelu</title>
<ellipse fill="none" stroke="black" cx="401" cy="-16424.76" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="401" y="-16436.06" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="401" y="-16421.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="401" y="-16406.06" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_1_up&#45;&gt;expert_8_1_gelu -->
<g id="edge351" class="edge">
<title>expert_8_1_up&#45;&gt;expert_8_1_gelu</title>
<path fill="none" stroke="black" d="M418.23,-16499.13C416.21,-16490.53 413.99,-16481.09 411.84,-16471.95"/>
<polygon fill="black" stroke="black" points="415.24,-16471.12 409.55,-16462.18 408.43,-16472.72 415.24,-16471.12"/>
</g>
<!-- expert_8_1_down -->
<g id="node304" class="node">
<title>expert_8_1_down</title>
<polygon fill="lightgreen" stroke="black" points="496.5,-16350.29 343.5,-16350.29 343.5,-16282.29 496.5,-16282.29 496.5,-16350.29"/>
<text text-anchor="middle" x="420" y="-16335.09" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="420" y="-16320.09" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="420" y="-16305.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="420" y="-16290.09" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_1_gelu&#45;&gt;expert_8_1_down -->
<g id="edge352" class="edge">
<title>expert_8_1_gelu&#45;&gt;expert_8_1_down</title>
<path fill="none" stroke="black" d="M407.54,-16387.12C409.07,-16378.56 410.71,-16369.36 412.28,-16360.54"/>
<polygon fill="black" stroke="black" points="415.78,-16360.89 414.09,-16350.43 408.88,-16359.66 415.78,-16360.89"/>
</g>
<!-- expert_8_1_down&#45;&gt;aggregate_8 -->
<g id="edge353" class="edge">
<title>expert_8_1_down&#45;&gt;aggregate_8</title>
<path fill="none" stroke="black" d="M490.25,-16282.18C562.81,-16247.99 678.77,-16193.33 775.69,-16147.66"/>
<polygon fill="black" stroke="black" points="777.46,-16150.69 785.01,-16143.27 774.47,-16144.36 777.46,-16150.69"/>
</g>
<!-- expert_8_2_gelu -->
<g id="node306" class="node">
<title>expert_8_2_gelu</title>
<ellipse fill="none" stroke="black" cx="655" cy="-16424.76" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="655" y="-16436.06" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="655" y="-16421.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="655" y="-16406.06" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_2_up&#45;&gt;expert_8_2_gelu -->
<g id="edge355" class="edge">
<title>expert_8_2_up&#45;&gt;expert_8_2_gelu</title>
<path fill="none" stroke="black" d="M672.92,-16499.13C670.81,-16490.53 668.51,-16481.09 666.28,-16471.95"/>
<polygon fill="black" stroke="black" points="669.67,-16471.07 663.89,-16462.18 662.87,-16472.73 669.67,-16471.07"/>
</g>
<!-- expert_8_2_down -->
<g id="node307" class="node">
<title>expert_8_2_down</title>
<polygon fill="lightgreen" stroke="black" points="759.5,-16350.29 606.5,-16350.29 606.5,-16282.29 759.5,-16282.29 759.5,-16350.29"/>
<text text-anchor="middle" x="683" y="-16335.09" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="683" y="-16320.09" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="683" y="-16305.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="683" y="-16290.09" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_2_gelu&#45;&gt;expert_8_2_down -->
<g id="edge356" class="edge">
<title>expert_8_2_gelu&#45;&gt;expert_8_2_down</title>
<path fill="none" stroke="black" d="M664.64,-16387.12C666.91,-16378.47 669.36,-16369.16 671.7,-16360.26"/>
<polygon fill="black" stroke="black" points="675.13,-16360.99 674.29,-16350.43 668.36,-16359.21 675.13,-16360.99"/>
</g>
<!-- expert_8_2_down&#45;&gt;aggregate_8 -->
<g id="edge357" class="edge">
<title>expert_8_2_down&#45;&gt;aggregate_8</title>
<path fill="none" stroke="black" d="M718.33,-16282.05C742.17,-16259.62 775.32,-16228.44 808.99,-16196.76"/>
<polygon fill="black" stroke="black" points="811.75,-16198.97 816.64,-16189.56 806.96,-16193.87 811.75,-16198.97"/>
</g>
<!-- expert_8_3_gelu -->
<g id="node309" class="node">
<title>expert_8_3_gelu</title>
<ellipse fill="none" stroke="black" cx="909" cy="-16424.76" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="909" y="-16436.06" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="909" y="-16421.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="909" y="-16406.06" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_3_up&#45;&gt;expert_8_3_gelu -->
<g id="edge359" class="edge">
<title>expert_8_3_up&#45;&gt;expert_8_3_gelu</title>
<path fill="none" stroke="black" d="M926.23,-16499.13C924.21,-16490.53 921.99,-16481.09 919.84,-16471.95"/>
<polygon fill="black" stroke="black" points="923.24,-16471.12 917.55,-16462.18 916.43,-16472.72 923.24,-16471.12"/>
</g>
<!-- expert_8_3_down -->
<g id="node310" class="node">
<title>expert_8_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1001.5,-16350.29 848.5,-16350.29 848.5,-16282.29 1001.5,-16282.29 1001.5,-16350.29"/>
<text text-anchor="middle" x="925" y="-16335.09" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="925" y="-16320.09" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="925" y="-16305.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="925" y="-16290.09" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_3_gelu&#45;&gt;expert_8_3_down -->
<g id="edge360" class="edge">
<title>expert_8_3_gelu&#45;&gt;expert_8_3_down</title>
<path fill="none" stroke="black" d="M914.51,-16387.12C915.79,-16378.56 917.17,-16369.36 918.5,-16360.54"/>
<polygon fill="black" stroke="black" points="922,-16360.84 920.02,-16350.43 915.07,-16359.8 922,-16360.84"/>
</g>
<!-- expert_8_3_down&#45;&gt;aggregate_8 -->
<g id="edge361" class="edge">
<title>expert_8_3_down&#45;&gt;aggregate_8</title>
<path fill="none" stroke="black" d="M927.94,-16282.05C928.66,-16274.02 929.47,-16264.87 930.34,-16254.97"/>
<polygon fill="black" stroke="black" points="933.84,-16255.11 931.24,-16244.84 926.87,-16254.49 933.84,-16255.11"/>
</g>
<!-- expert_8_4_gelu -->
<g id="node312" class="node">
<title>expert_8_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1163" cy="-16424.76" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1163" y="-16436.06" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1163" y="-16421.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1163" y="-16406.06" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_4_up&#45;&gt;expert_8_4_gelu -->
<g id="edge363" class="edge">
<title>expert_8_4_up&#45;&gt;expert_8_4_gelu</title>
<path fill="none" stroke="black" d="M1151.29,-16499.13C1152.63,-16490.71 1154.1,-16481.49 1155.53,-16472.52"/>
<polygon fill="black" stroke="black" points="1159,-16472.98 1157.13,-16462.56 1152.09,-16471.88 1159,-16472.98"/>
</g>
<!-- expert_8_4_down -->
<g id="node313" class="node">
<title>expert_8_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1220.5,-16350.29 1067.5,-16350.29 1067.5,-16282.29 1220.5,-16282.29 1220.5,-16350.29"/>
<text text-anchor="middle" x="1144" y="-16335.09" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1144" y="-16320.09" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1144" y="-16305.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1144" y="-16290.09" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_4_gelu&#45;&gt;expert_8_4_down -->
<g id="edge364" class="edge">
<title>expert_8_4_gelu&#45;&gt;expert_8_4_down</title>
<path fill="none" stroke="black" d="M1156.46,-16387.12C1154.93,-16378.56 1153.29,-16369.36 1151.72,-16360.54"/>
<polygon fill="black" stroke="black" points="1155.12,-16359.66 1149.91,-16350.43 1148.22,-16360.89 1155.12,-16359.66"/>
</g>
<!-- expert_8_4_down&#45;&gt;aggregate_8 -->
<g id="edge365" class="edge">
<title>expert_8_4_down&#45;&gt;aggregate_8</title>
<path fill="none" stroke="black" d="M1117.64,-16282.05C1103.24,-16263.9 1084.3,-16240.02 1064.28,-16214.78"/>
<polygon fill="black" stroke="black" points="1066.99,-16212.57 1058.03,-16206.91 1061.51,-16216.92 1066.99,-16212.57"/>
</g>
<!-- expert_8_5_gelu -->
<g id="node315" class="node">
<title>expert_8_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1417" cy="-16424.76" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1417" y="-16436.06" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1417" y="-16421.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1417" y="-16406.06" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_5_up&#45;&gt;expert_8_5_gelu -->
<g id="edge367" class="edge">
<title>expert_8_5_up&#45;&gt;expert_8_5_gelu</title>
<path fill="none" stroke="black" d="M1405.29,-16499.13C1406.63,-16490.71 1408.1,-16481.49 1409.53,-16472.52"/>
<polygon fill="black" stroke="black" points="1413,-16472.98 1411.13,-16462.56 1406.09,-16471.88 1413,-16472.98"/>
</g>
<!-- expert_8_5_down -->
<g id="node316" class="node">
<title>expert_8_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1474.5,-16350.29 1321.5,-16350.29 1321.5,-16282.29 1474.5,-16282.29 1474.5,-16350.29"/>
<text text-anchor="middle" x="1398" y="-16335.09" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1398" y="-16320.09" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1398" y="-16305.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1398" y="-16290.09" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_5_gelu&#45;&gt;expert_8_5_down -->
<g id="edge368" class="edge">
<title>expert_8_5_gelu&#45;&gt;expert_8_5_down</title>
<path fill="none" stroke="black" d="M1410.46,-16387.12C1408.93,-16378.56 1407.29,-16369.36 1405.72,-16360.54"/>
<polygon fill="black" stroke="black" points="1409.12,-16359.66 1403.91,-16350.43 1402.22,-16360.89 1409.12,-16359.66"/>
</g>
<!-- expert_8_5_down&#45;&gt;aggregate_8 -->
<g id="edge369" class="edge">
<title>expert_8_5_down&#45;&gt;aggregate_8</title>
<path fill="none" stroke="black" d="M1337.64,-16282.05C1280.33,-16250.48 1191.5,-16201.57 1113.02,-16158.35"/>
<polygon fill="black" stroke="black" points="1114.44,-16155.14 1104,-16153.38 1111.07,-16161.27 1114.44,-16155.14"/>
</g>
<!-- expert_8_6_gelu -->
<g id="node318" class="node">
<title>expert_8_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1671" cy="-16424.76" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1671" y="-16436.06" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1671" y="-16421.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1671" y="-16406.06" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_6_up&#45;&gt;expert_8_6_gelu -->
<g id="edge371" class="edge">
<title>expert_8_6_up&#45;&gt;expert_8_6_gelu</title>
<path fill="none" stroke="black" d="M1659.29,-16499.13C1660.63,-16490.71 1662.1,-16481.49 1663.53,-16472.52"/>
<polygon fill="black" stroke="black" points="1667,-16472.98 1665.13,-16462.56 1660.09,-16471.88 1667,-16472.98"/>
</g>
<!-- expert_8_6_down -->
<g id="node319" class="node">
<title>expert_8_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1728.5,-16350.29 1575.5,-16350.29 1575.5,-16282.29 1728.5,-16282.29 1728.5,-16350.29"/>
<text text-anchor="middle" x="1652" y="-16335.09" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1652" y="-16320.09" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1652" y="-16305.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1652" y="-16290.09" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_6_gelu&#45;&gt;expert_8_6_down -->
<g id="edge372" class="edge">
<title>expert_8_6_gelu&#45;&gt;expert_8_6_down</title>
<path fill="none" stroke="black" d="M1664.46,-16387.12C1662.93,-16378.56 1661.29,-16369.36 1659.72,-16360.54"/>
<polygon fill="black" stroke="black" points="1663.12,-16359.66 1657.91,-16350.43 1656.22,-16360.89 1663.12,-16359.66"/>
</g>
<!-- expert_8_6_down&#45;&gt;aggregate_8 -->
<g id="edge373" class="edge">
<title>expert_8_6_down&#45;&gt;aggregate_8</title>
<path fill="none" stroke="black" d="M1575.4,-16285.9C1564.87,-16281.95 1554.18,-16277.99 1544,-16274.29 1404.19,-16223.48 1245.02,-16168.33 1126.21,-16127.68"/>
<polygon fill="black" stroke="black" points="1127.24,-16124.34 1116.65,-16124.41 1124.98,-16130.96 1127.24,-16124.34"/>
</g>
<!-- expert_8_7_gelu -->
<g id="node321" class="node">
<title>expert_8_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1925" cy="-16424.76" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1925" y="-16436.06" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1925" y="-16421.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1925" y="-16406.06" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_7_up&#45;&gt;expert_8_7_gelu -->
<g id="edge375" class="edge">
<title>expert_8_7_up&#45;&gt;expert_8_7_gelu</title>
<path fill="none" stroke="black" d="M1913.29,-16499.13C1914.63,-16490.71 1916.1,-16481.49 1917.53,-16472.52"/>
<polygon fill="black" stroke="black" points="1921,-16472.98 1919.13,-16462.56 1914.09,-16471.88 1921,-16472.98"/>
</g>
<!-- expert_8_7_down -->
<g id="node322" class="node">
<title>expert_8_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1982.5,-16350.29 1829.5,-16350.29 1829.5,-16282.29 1982.5,-16282.29 1982.5,-16350.29"/>
<text text-anchor="middle" x="1906" y="-16335.09" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1906" y="-16320.09" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1906" y="-16305.09" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1906" y="-16290.09" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_8_7_gelu&#45;&gt;expert_8_7_down -->
<g id="edge376" class="edge">
<title>expert_8_7_gelu&#45;&gt;expert_8_7_down</title>
<path fill="none" stroke="black" d="M1918.46,-16387.12C1916.93,-16378.56 1915.29,-16369.36 1913.72,-16360.54"/>
<polygon fill="black" stroke="black" points="1917.12,-16359.66 1911.91,-16350.43 1910.22,-16360.89 1917.12,-16359.66"/>
</g>
<!-- expert_8_7_down&#45;&gt;aggregate_8 -->
<g id="edge377" class="edge">
<title>expert_8_7_down&#45;&gt;aggregate_8</title>
<path fill="none" stroke="black" d="M1829.42,-16284.88C1818.93,-16281.11 1808.25,-16277.47 1798,-16274.29 1572.01,-16204.15 1306.34,-16142.67 1132.72,-16105.23"/>
<polygon fill="black" stroke="black" points="1133.23,-16101.76 1122.71,-16103.07 1131.75,-16108.6 1133.23,-16101.76"/>
</g>
<!-- residual_2_8 -->
<g id="node324" class="node">
<title>residual_2_8</title>
<ellipse fill="none" stroke="black" cx="947" cy="-15812.08" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="947" y="-15823.38" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="947" y="-15808.38" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="947" y="-15793.38" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- aggregate_8&#45;&gt;residual_2_8 -->
<g id="edge378" class="edge">
<title>aggregate_8&#45;&gt;residual_2_8</title>
<path fill="none" stroke="black" d="M947,-15886.27C947,-15876.98 947,-15868.16 947,-15860.07"/>
<polygon fill="black" stroke="black" points="950.5,-15859.88 947,-15849.88 943.5,-15859.88 950.5,-15859.88"/>
</g>
<!-- input_9 -->
<g id="node325" class="node">
<title>input_9</title>
<ellipse fill="none" stroke="black" cx="947" cy="-15629.13" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="947" y="-15640.43" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="947" y="-15625.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="947" y="-15610.43" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_8&#45;&gt;input_9 -->
<g id="edge681" class="edge">
<title>residual_2_8&#45;&gt;input_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M947,-15774.47C947,-15746.38 947,-15707.41 947,-15677.05"/>
<polygon fill="blue" stroke="blue" points="950.5,-15676.7 947,-15666.7 943.5,-15676.7 950.5,-15676.7"/>
<text text-anchor="middle" x="1027.5" y="-15739.41" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1027.5" y="-15724.41" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1027.5" y="-15709.41" font-family="Times,serif" font-size="14.00">GPU 8 &#45;&gt; GPU 9</text>
</g>
<!-- qkv_proj_9 -->
<g id="node326" class="node">
<title>qkv_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="1109,-15533.65 785,-15533.65 785,-15465.65 1109,-15465.65 1109,-15533.65"/>
<text text-anchor="middle" x="947" y="-15518.45" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="947" y="-15503.45" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="947" y="-15488.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="947" y="-15473.45" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- input_9&#45;&gt;qkv_proj_9 -->
<g id="edge379" class="edge">
<title>input_9&#45;&gt;qkv_proj_9</title>
<path fill="none" stroke="black" d="M947,-15591.6C947,-15576.78 947,-15559.53 947,-15544.07"/>
<polygon fill="black" stroke="black" points="950.5,-15543.71 947,-15533.71 943.5,-15543.71 950.5,-15543.71"/>
</g>
<!-- reshape_qkv_9 -->
<g id="node327" class="node">
<title>reshape_qkv_9</title>
<polygon fill="none" stroke="black" points="1301.64,-15428.65 737.49,-15428.65 592.36,-15322.65 1156.51,-15322.65 1301.64,-15428.65"/>
<text text-anchor="middle" x="947" y="-15386.95" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="947" y="-15371.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="947" y="-15356.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- qkv_proj_9&#45;&gt;reshape_qkv_9 -->
<g id="edge380" class="edge">
<title>qkv_proj_9&#45;&gt;reshape_qkv_9</title>
<path fill="none" stroke="black" d="M947,-15465.64C947,-15457.44 947,-15448.37 947,-15439.26"/>
<polygon fill="black" stroke="black" points="950.5,-15438.99 947,-15428.99 943.5,-15438.99 950.5,-15438.99"/>
</g>
<!-- attn_scores_9 -->
<g id="node328" class="node">
<title>attn_scores_9</title>
<polygon fill="none" stroke="black" points="947,-15285.65 767,-15232.65 947,-15179.65 1127,-15232.65 947,-15285.65"/>
<text text-anchor="middle" x="947" y="-15243.95" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="947" y="-15228.95" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="947" y="-15213.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- reshape_qkv_9&#45;&gt;attn_scores_9 -->
<g id="edge381" class="edge">
<title>reshape_qkv_9&#45;&gt;attn_scores_9</title>
<path fill="none" stroke="black" d="M947,-15322.55C947,-15313.98 947,-15305.02 947,-15296.23"/>
<polygon fill="black" stroke="black" points="950.5,-15296.01 947,-15286.01 943.5,-15296.01 950.5,-15296.01"/>
</g>
<!-- attn_weights_9 -->
<g id="node329" class="node">
<title>attn_weights_9</title>
<polygon fill="none" stroke="black" points="947,-15142.65 767,-15089.65 947,-15036.65 1127,-15089.65 947,-15142.65"/>
<text text-anchor="middle" x="947" y="-15100.95" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="947" y="-15085.95" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="947" y="-15070.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- attn_scores_9&#45;&gt;attn_weights_9 -->
<g id="edge382" class="edge">
<title>attn_scores_9&#45;&gt;attn_weights_9</title>
<path fill="none" stroke="black" d="M947,-15179.55C947,-15170.98 947,-15162.02 947,-15153.23"/>
<polygon fill="black" stroke="black" points="950.5,-15153.01 947,-15143.01 943.5,-15153.01 950.5,-15153.01"/>
</g>
<!-- attn_output_9 -->
<g id="node330" class="node">
<title>attn_output_9</title>
<polygon fill="none" stroke="black" points="947,-14999.65 776,-14946.65 947,-14893.65 1118,-14946.65 947,-14999.65"/>
<text text-anchor="middle" x="947" y="-14957.95" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="947" y="-14942.95" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="947" y="-14927.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- attn_weights_9&#45;&gt;attn_output_9 -->
<g id="edge383" class="edge">
<title>attn_weights_9&#45;&gt;attn_output_9</title>
<path fill="none" stroke="black" d="M947,-15036.55C947,-15027.98 947,-15019.02 947,-15010.23"/>
<polygon fill="black" stroke="black" points="950.5,-15010.01 947,-15000.01 943.5,-15010.01 950.5,-15010.01"/>
</g>
<!-- out_proj_9 -->
<g id="node331" class="node">
<title>out_proj_9</title>
<polygon fill="lightcoral" stroke="black" points="1023.5,-14856.65 870.5,-14856.65 870.5,-14788.65 1023.5,-14788.65 1023.5,-14856.65"/>
<text text-anchor="middle" x="947" y="-14841.45" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="947" y="-14826.45" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="947" y="-14811.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="947" y="-14796.45" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- attn_output_9&#45;&gt;out_proj_9 -->
<g id="edge384" class="edge">
<title>attn_output_9&#45;&gt;out_proj_9</title>
<path fill="none" stroke="black" d="M947,-14893.56C947,-14884.72 947,-14875.63 947,-14867.04"/>
<polygon fill="black" stroke="black" points="950.5,-14866.87 947,-14856.87 943.5,-14866.87 950.5,-14866.87"/>
</g>
<!-- residual_1_9 -->
<g id="node332" class="node">
<title>residual_1_9</title>
<ellipse fill="none" stroke="black" cx="947" cy="-14714.18" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="947" y="-14725.48" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="947" y="-14710.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="947" y="-14695.48" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- out_proj_9&#45;&gt;residual_1_9 -->
<g id="edge385" class="edge">
<title>out_proj_9&#45;&gt;residual_1_9</title>
<path fill="none" stroke="black" d="M947,-14788.55C947,-14780.21 947,-14771.1 947,-14762.23"/>
<polygon fill="black" stroke="black" points="950.5,-14761.97 947,-14751.97 943.5,-14761.97 950.5,-14761.97"/>
</g>
<!-- gate_9 -->
<g id="node333" class="node">
<title>gate_9</title>
<polygon fill="lightpink" stroke="black" points="1182.3,-14575.43 1064.65,-14618.48 829.35,-14618.48 711.7,-14575.43 829.35,-14532.38 1064.65,-14532.38 1182.3,-14575.43"/>
<text text-anchor="middle" x="947" y="-14586.73" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="947" y="-14571.73" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="947" y="-14556.73" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- residual_1_9&#45;&gt;gate_9 -->
<g id="edge386" class="edge">
<title>residual_1_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M947,-14676.53C947,-14661.86 947,-14644.69 947,-14628.76"/>
<polygon fill="black" stroke="black" points="950.5,-14628.5 947,-14618.5 943.5,-14628.5 950.5,-14628.5"/>
</g>
<!-- selection_9 -->
<g id="node334" class="node">
<title>selection_9</title>
<polygon fill="none" stroke="black" points="947,-14495.15 745,-14442.15 947,-14389.15 1149,-14442.15 947,-14495.15"/>
<text text-anchor="middle" x="947" y="-14453.45" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="947" y="-14438.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="947" y="-14423.45" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- gate_9&#45;&gt;selection_9 -->
<g id="edge387" class="edge">
<title>gate_9&#45;&gt;selection_9</title>
<path fill="none" stroke="black" d="M947,-14532.17C947,-14523.67 947,-14514.58 947,-14505.56"/>
<polygon fill="black" stroke="black" points="950.5,-14505.45 947,-14495.45 943.5,-14505.45 950.5,-14505.45"/>
</g>
<!-- expert_9_0_up -->
<g id="node335" class="node">
<title>expert_9_0_up</title>
<polygon fill="lightgreen" stroke="black" points="266,-14317.15 104,-14317.15 104,-14249.15 266,-14249.15 266,-14317.15"/>
<text text-anchor="middle" x="185" y="-14301.95" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="185" y="-14286.95" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="185" y="-14271.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="185" y="-14256.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- selection_9&#45;&gt;expert_9_0_up -->
<g id="edge388" class="edge">
<title>selection_9&#45;&gt;expert_9_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M766.49,-14436.5C630.88,-14428.1 442.55,-14405.86 287,-14348.15 270.04,-14341.86 252.9,-14332.51 237.63,-14322.89"/>
<polygon fill="red" stroke="red" points="239.16,-14319.72 228.87,-14317.22 235.36,-14325.59 239.16,-14319.72"/>
<text text-anchor="middle" x="419.5" y="-14359.95" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_9_1_up -->
<g id="node338" class="node">
<title>expert_9_1_up</title>
<polygon fill="lightgreen" stroke="black" points="512,-14317.15 350,-14317.15 350,-14249.15 512,-14249.15 512,-14317.15"/>
<text text-anchor="middle" x="431" y="-14301.95" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="431" y="-14286.95" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="431" y="-14271.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="431" y="-14256.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- selection_9&#45;&gt;expert_9_1_up -->
<g id="edge392" class="edge">
<title>selection_9&#45;&gt;expert_9_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M820.13,-14422.25C738.54,-14407.64 631.29,-14383.81 541,-14348.15 523.57,-14341.27 505.62,-14331.93 489.41,-14322.51"/>
<polygon fill="red" stroke="red" points="490.98,-14319.37 480.59,-14317.28 487.41,-14325.39 490.98,-14319.37"/>
<text text-anchor="middle" x="669.5" y="-14359.95" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_9_2_up -->
<g id="node341" class="node">
<title>expert_9_2_up</title>
<polygon fill="lightgreen" stroke="black" points="774,-14317.15 612,-14317.15 612,-14249.15 774,-14249.15 774,-14317.15"/>
<text text-anchor="middle" x="693" y="-14301.95" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="693" y="-14286.95" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="693" y="-14271.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="693" y="-14256.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- selection_9&#45;&gt;expert_9_2_up -->
<g id="edge396" class="edge">
<title>selection_9&#45;&gt;expert_9_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M876.28,-14407.46C854.91,-14396.56 831.65,-14383.96 811,-14371.15 787.71,-14356.7 763.13,-14339.01 742.47,-14323.36"/>
<polygon fill="red" stroke="red" points="744.53,-14320.54 734.46,-14317.25 740.28,-14326.1 744.53,-14320.54"/>
<text text-anchor="middle" x="875.5" y="-14359.95" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_9_3_up -->
<g id="node344" class="node">
<title>expert_9_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1023,-14317.15 861,-14317.15 861,-14249.15 1023,-14249.15 1023,-14317.15"/>
<text text-anchor="middle" x="942" y="-14301.95" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="942" y="-14286.95" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="942" y="-14271.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="942" y="-14256.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- selection_9&#45;&gt;expert_9_3_up -->
<g id="edge400" class="edge">
<title>selection_9&#45;&gt;expert_9_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M945.35,-14389.31C944.71,-14369.26 943.99,-14346.59 943.38,-14327.44"/>
<polygon fill="red" stroke="red" points="946.87,-14327.08 943.05,-14317.2 939.87,-14327.3 946.87,-14327.08"/>
<text text-anchor="middle" x="1008.5" y="-14359.95" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_9_4_up -->
<g id="node347" class="node">
<title>expert_9_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1240,-14317.15 1078,-14317.15 1078,-14249.15 1240,-14249.15 1240,-14317.15"/>
<text text-anchor="middle" x="1159" y="-14301.95" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1159" y="-14286.95" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1159" y="-14271.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1159" y="-14256.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- selection_9&#45;&gt;expert_9_4_up -->
<g id="edge404" class="edge">
<title>selection_9&#45;&gt;expert_9_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1018.69,-14407.84C1038.39,-14397.3 1059.21,-14384.81 1077,-14371.15 1094.55,-14357.69 1111.7,-14340.36 1125.73,-14324.72"/>
<polygon fill="red" stroke="red" points="1128.38,-14327.01 1132.37,-14317.2 1123.13,-14322.38 1128.38,-14327.01"/>
<text text-anchor="middle" x="1158.5" y="-14359.95" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_9_5_up -->
<g id="node350" class="node">
<title>expert_9_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1494,-14317.15 1332,-14317.15 1332,-14249.15 1494,-14249.15 1494,-14317.15"/>
<text text-anchor="middle" x="1413" y="-14301.95" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1413" y="-14286.95" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1413" y="-14271.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1413" y="-14256.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- selection_9&#45;&gt;expert_9_5_up -->
<g id="edge408" class="edge">
<title>selection_9&#45;&gt;expert_9_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1064.67,-14420C1135.54,-14404.93 1226.56,-14381.41 1303,-14348.15 1319.84,-14340.83 1337.34,-14331.51 1353.29,-14322.27"/>
<polygon fill="red" stroke="red" points="1355.14,-14325.25 1361.98,-14317.16 1351.59,-14319.21 1355.14,-14325.25"/>
<text text-anchor="middle" x="1339.5" y="-14359.95" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_9_6_up -->
<g id="node353" class="node">
<title>expert_9_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1748,-14317.15 1586,-14317.15 1586,-14249.15 1748,-14249.15 1748,-14317.15"/>
<text text-anchor="middle" x="1667" y="-14301.95" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1667" y="-14286.95" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1667" y="-14271.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1667" y="-14256.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- selection_9&#45;&gt;expert_9_6_up -->
<g id="edge412" class="edge">
<title>selection_9&#45;&gt;expert_9_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1113.23,-14432.74C1238.26,-14422.4 1412.2,-14399.38 1557,-14348.15 1575.1,-14341.75 1593.59,-14332.32 1610.12,-14322.65"/>
<polygon fill="red" stroke="red" points="1612.31,-14325.42 1619.08,-14317.28 1608.71,-14319.42 1612.31,-14325.42"/>
<text text-anchor="middle" x="1589.5" y="-14359.95" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_9_7_up -->
<g id="node356" class="node">
<title>expert_9_7_up</title>
<polygon fill="lightgreen" stroke="black" points="2002,-14317.15 1840,-14317.15 1840,-14249.15 2002,-14249.15 2002,-14317.15"/>
<text text-anchor="middle" x="1921" y="-14301.95" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1921" y="-14286.95" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1921" y="-14271.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1921" y="-14256.95" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- selection_9&#45;&gt;expert_9_7_up -->
<g id="edge416" class="edge">
<title>selection_9&#45;&gt;expert_9_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1097.4,-14428.59C1241.48,-14416.03 1464.91,-14395.16 1658,-14371.15 1726.24,-14362.67 1746.13,-14370.96 1811,-14348.15 1829.2,-14341.75 1847.79,-14332.27 1864.37,-14322.56"/>
<polygon fill="red" stroke="red" points="1866.6,-14325.3 1873.37,-14317.15 1862.99,-14319.3 1866.6,-14325.3"/>
<text text-anchor="middle" x="1846.5" y="-14359.95" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_9_0_gelu -->
<g id="node336" class="node">
<title>expert_9_0_gelu</title>
<ellipse fill="none" stroke="black" cx="160" cy="-14174.68" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="160" y="-14185.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="160" y="-14170.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="160" y="-14155.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_0_up&#45;&gt;expert_9_0_gelu -->
<g id="edge389" class="edge">
<title>expert_9_0_up&#45;&gt;expert_9_0_gelu</title>
<path fill="none" stroke="black" d="M177.23,-14249.05C175.21,-14240.44 172.99,-14231.01 170.84,-14221.86"/>
<polygon fill="black" stroke="black" points="174.24,-14221.03 168.55,-14212.1 167.43,-14222.63 174.24,-14221.03"/>
</g>
<!-- expert_9_0_down -->
<g id="node337" class="node">
<title>expert_9_0_down</title>
<polygon fill="lightgreen" stroke="black" points="255.5,-14100.2 102.5,-14100.2 102.5,-14032.2 255.5,-14032.2 255.5,-14100.2"/>
<text text-anchor="middle" x="179" y="-14085" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="179" y="-14070" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="179" y="-14055" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="179" y="-14040" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_0_gelu&#45;&gt;expert_9_0_down -->
<g id="edge390" class="edge">
<title>expert_9_0_gelu&#45;&gt;expert_9_0_down</title>
<path fill="none" stroke="black" d="M166.54,-14137.03C168.07,-14128.47 169.71,-14119.27 171.28,-14110.46"/>
<polygon fill="black" stroke="black" points="174.78,-14110.8 173.09,-14100.34 167.88,-14109.57 174.78,-14110.8"/>
</g>
<!-- aggregate_9 -->
<g id="node359" class="node">
<title>aggregate_9</title>
<ellipse fill="lightyellow" stroke="black" cx="993" cy="-13815.84" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="993" cy="-13815.84" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="993" y="-13827.14" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="993" y="-13812.14" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="993" y="-13797.14" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_0_down&#45;&gt;aggregate_9 -->
<g id="edge391" class="edge">
<title>expert_9_0_down&#45;&gt;aggregate_9</title>
<path fill="none" stroke="black" d="M255.73,-14035.24C266.19,-14031.4 276.83,-14027.62 287,-14024.2 463.08,-13965.02 666.9,-13906.17 810.15,-13866.36"/>
<polygon fill="black" stroke="black" points="811.23,-13869.7 819.93,-13863.65 809.36,-13862.95 811.23,-13869.7"/>
</g>
<!-- expert_9_1_gelu -->
<g id="node339" class="node">
<title>expert_9_1_gelu</title>
<ellipse fill="none" stroke="black" cx="414" cy="-14174.68" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="414" y="-14185.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="414" y="-14170.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="414" y="-14155.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_1_up&#45;&gt;expert_9_1_gelu -->
<g id="edge393" class="edge">
<title>expert_9_1_up&#45;&gt;expert_9_1_gelu</title>
<path fill="none" stroke="black" d="M425.71,-14249.05C424.37,-14240.62 422.9,-14231.4 421.47,-14222.43"/>
<polygon fill="black" stroke="black" points="424.91,-14221.79 419.87,-14212.47 418,-14222.9 424.91,-14221.79"/>
</g>
<!-- expert_9_1_down -->
<g id="node340" class="node">
<title>expert_9_1_down</title>
<polygon fill="lightgreen" stroke="black" points="509.5,-14100.2 356.5,-14100.2 356.5,-14032.2 509.5,-14032.2 509.5,-14100.2"/>
<text text-anchor="middle" x="433" y="-14085" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="433" y="-14070" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="433" y="-14055" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="433" y="-14040" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_1_gelu&#45;&gt;expert_9_1_down -->
<g id="edge394" class="edge">
<title>expert_9_1_gelu&#45;&gt;expert_9_1_down</title>
<path fill="none" stroke="black" d="M420.54,-14137.03C422.07,-14128.47 423.71,-14119.27 425.28,-14110.46"/>
<polygon fill="black" stroke="black" points="428.78,-14110.8 427.09,-14100.34 421.88,-14109.57 428.78,-14110.8"/>
</g>
<!-- expert_9_1_down&#45;&gt;aggregate_9 -->
<g id="edge395" class="edge">
<title>expert_9_1_down&#45;&gt;aggregate_9</title>
<path fill="none" stroke="black" d="M507.65,-14032.09C587,-13996.9 715.21,-13940.04 819.94,-13893.59"/>
<polygon fill="black" stroke="black" points="821.63,-13896.67 829.35,-13889.42 818.79,-13890.27 821.63,-13896.67"/>
</g>
<!-- expert_9_2_gelu -->
<g id="node342" class="node">
<title>expert_9_2_gelu</title>
<ellipse fill="none" stroke="black" cx="668" cy="-14174.68" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="668" y="-14185.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="668" y="-14170.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="668" y="-14155.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_2_up&#45;&gt;expert_9_2_gelu -->
<g id="edge397" class="edge">
<title>expert_9_2_up&#45;&gt;expert_9_2_gelu</title>
<path fill="none" stroke="black" d="M685.23,-14249.05C683.21,-14240.44 680.99,-14231.01 678.84,-14221.86"/>
<polygon fill="black" stroke="black" points="682.24,-14221.03 676.55,-14212.1 675.43,-14222.63 682.24,-14221.03"/>
</g>
<!-- expert_9_2_down -->
<g id="node343" class="node">
<title>expert_9_2_down</title>
<polygon fill="lightgreen" stroke="black" points="772.5,-14100.2 619.5,-14100.2 619.5,-14032.2 772.5,-14032.2 772.5,-14100.2"/>
<text text-anchor="middle" x="696" y="-14085" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="696" y="-14070" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="696" y="-14055" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="696" y="-14040" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_2_gelu&#45;&gt;expert_9_2_down -->
<g id="edge398" class="edge">
<title>expert_9_2_gelu&#45;&gt;expert_9_2_down</title>
<path fill="none" stroke="black" d="M677.64,-14137.03C679.91,-14128.38 682.36,-14119.07 684.7,-14110.17"/>
<polygon fill="black" stroke="black" points="688.13,-14110.9 687.29,-14100.34 681.36,-14109.12 688.13,-14110.9"/>
</g>
<!-- expert_9_2_down&#45;&gt;aggregate_9 -->
<g id="edge399" class="edge">
<title>expert_9_2_down&#45;&gt;aggregate_9</title>
<path fill="none" stroke="black" d="M735.75,-14031.96C764.99,-14007.51 806.68,-13972.65 848.01,-13938.08"/>
<polygon fill="black" stroke="black" points="850.29,-13940.74 855.72,-13931.64 845.8,-13935.37 850.29,-13940.74"/>
</g>
<!-- expert_9_3_gelu -->
<g id="node345" class="node">
<title>expert_9_3_gelu</title>
<ellipse fill="none" stroke="black" cx="922" cy="-14174.68" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="922" y="-14185.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="922" y="-14170.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="922" y="-14155.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_3_up&#45;&gt;expert_9_3_gelu -->
<g id="edge401" class="edge">
<title>expert_9_3_up&#45;&gt;expert_9_3_gelu</title>
<path fill="none" stroke="black" d="M935.78,-14249.05C934.18,-14240.53 932.43,-14231.21 930.73,-14222.15"/>
<polygon fill="black" stroke="black" points="934.13,-14221.28 928.84,-14212.1 927.25,-14222.57 934.13,-14221.28"/>
</g>
<!-- expert_9_3_down -->
<g id="node346" class="node">
<title>expert_9_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1017.5,-14100.2 864.5,-14100.2 864.5,-14032.2 1017.5,-14032.2 1017.5,-14100.2"/>
<text text-anchor="middle" x="941" y="-14085" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="941" y="-14070" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="941" y="-14055" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="941" y="-14040" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_3_gelu&#45;&gt;expert_9_3_down -->
<g id="edge402" class="edge">
<title>expert_9_3_gelu&#45;&gt;expert_9_3_down</title>
<path fill="none" stroke="black" d="M928.54,-14137.03C930.07,-14128.47 931.71,-14119.27 933.28,-14110.46"/>
<polygon fill="black" stroke="black" points="936.78,-14110.8 935.09,-14100.34 929.88,-14109.57 936.78,-14110.8"/>
</g>
<!-- expert_9_3_down&#45;&gt;aggregate_9 -->
<g id="edge403" class="edge">
<title>expert_9_3_down&#45;&gt;aggregate_9</title>
<path fill="none" stroke="black" d="M947.96,-14031.96C949.82,-14023.07 951.97,-14012.8 954.3,-14001.66"/>
<polygon fill="black" stroke="black" points="957.77,-14002.17 956.4,-13991.67 950.92,-14000.74 957.77,-14002.17"/>
</g>
<!-- expert_9_4_gelu -->
<g id="node348" class="node">
<title>expert_9_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1176" cy="-14174.68" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1176" y="-14185.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1176" y="-14170.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1176" y="-14155.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_4_up&#45;&gt;expert_9_4_gelu -->
<g id="edge405" class="edge">
<title>expert_9_4_up&#45;&gt;expert_9_4_gelu</title>
<path fill="none" stroke="black" d="M1164.29,-14249.05C1165.63,-14240.62 1167.1,-14231.4 1168.53,-14222.43"/>
<polygon fill="black" stroke="black" points="1172,-14222.9 1170.13,-14212.47 1165.09,-14221.79 1172,-14222.9"/>
</g>
<!-- expert_9_4_down -->
<g id="node349" class="node">
<title>expert_9_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1233.5,-14100.2 1080.5,-14100.2 1080.5,-14032.2 1233.5,-14032.2 1233.5,-14100.2"/>
<text text-anchor="middle" x="1157" y="-14085" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1157" y="-14070" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1157" y="-14055" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1157" y="-14040" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_4_gelu&#45;&gt;expert_9_4_down -->
<g id="edge406" class="edge">
<title>expert_9_4_gelu&#45;&gt;expert_9_4_down</title>
<path fill="none" stroke="black" d="M1169.46,-14137.03C1167.93,-14128.47 1166.29,-14119.27 1164.72,-14110.46"/>
<polygon fill="black" stroke="black" points="1168.12,-14109.57 1162.91,-14100.34 1161.22,-14110.8 1168.12,-14109.57"/>
</g>
<!-- expert_9_4_down&#45;&gt;aggregate_9 -->
<g id="edge407" class="edge">
<title>expert_9_4_down&#45;&gt;aggregate_9</title>
<path fill="none" stroke="black" d="M1135.05,-14031.96C1124.6,-14016.14 1111.28,-13995.96 1096.99,-13974.32"/>
<polygon fill="black" stroke="black" points="1099.9,-13972.37 1091.47,-13965.96 1094.06,-13976.23 1099.9,-13972.37"/>
</g>
<!-- expert_9_5_gelu -->
<g id="node351" class="node">
<title>expert_9_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1430" cy="-14174.68" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1430" y="-14185.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1430" y="-14170.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1430" y="-14155.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_5_up&#45;&gt;expert_9_5_gelu -->
<g id="edge409" class="edge">
<title>expert_9_5_up&#45;&gt;expert_9_5_gelu</title>
<path fill="none" stroke="black" d="M1418.29,-14249.05C1419.63,-14240.62 1421.1,-14231.4 1422.53,-14222.43"/>
<polygon fill="black" stroke="black" points="1426,-14222.9 1424.13,-14212.47 1419.09,-14221.79 1426,-14222.9"/>
</g>
<!-- expert_9_5_down -->
<g id="node352" class="node">
<title>expert_9_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1487.5,-14100.2 1334.5,-14100.2 1334.5,-14032.2 1487.5,-14032.2 1487.5,-14100.2"/>
<text text-anchor="middle" x="1411" y="-14085" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1411" y="-14070" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1411" y="-14055" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1411" y="-14040" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_5_gelu&#45;&gt;expert_9_5_down -->
<g id="edge410" class="edge">
<title>expert_9_5_gelu&#45;&gt;expert_9_5_down</title>
<path fill="none" stroke="black" d="M1423.46,-14137.03C1421.93,-14128.47 1420.29,-14119.27 1418.72,-14110.46"/>
<polygon fill="black" stroke="black" points="1422.12,-14109.57 1416.91,-14100.34 1415.22,-14110.8 1422.12,-14109.57"/>
</g>
<!-- expert_9_5_down&#45;&gt;aggregate_9 -->
<g id="edge411" class="edge">
<title>expert_9_5_down&#45;&gt;aggregate_9</title>
<path fill="none" stroke="black" d="M1355.06,-14031.96C1304.18,-14001.73 1226.51,-13955.58 1156.13,-13913.76"/>
<polygon fill="black" stroke="black" points="1157.53,-13910.52 1147.14,-13908.42 1153.95,-13916.54 1157.53,-13910.52"/>
</g>
<!-- expert_9_6_gelu -->
<g id="node354" class="node">
<title>expert_9_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1684" cy="-14174.68" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1684" y="-14185.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1684" y="-14170.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1684" y="-14155.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_6_up&#45;&gt;expert_9_6_gelu -->
<g id="edge413" class="edge">
<title>expert_9_6_up&#45;&gt;expert_9_6_gelu</title>
<path fill="none" stroke="black" d="M1672.29,-14249.05C1673.63,-14240.62 1675.1,-14231.4 1676.53,-14222.43"/>
<polygon fill="black" stroke="black" points="1680,-14222.9 1678.13,-14212.47 1673.09,-14221.79 1680,-14222.9"/>
</g>
<!-- expert_9_6_down -->
<g id="node355" class="node">
<title>expert_9_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1741.5,-14100.2 1588.5,-14100.2 1588.5,-14032.2 1741.5,-14032.2 1741.5,-14100.2"/>
<text text-anchor="middle" x="1665" y="-14085" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1665" y="-14070" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1665" y="-14055" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1665" y="-14040" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_6_gelu&#45;&gt;expert_9_6_down -->
<g id="edge414" class="edge">
<title>expert_9_6_gelu&#45;&gt;expert_9_6_down</title>
<path fill="none" stroke="black" d="M1677.46,-14137.03C1675.93,-14128.47 1674.29,-14119.27 1672.72,-14110.46"/>
<polygon fill="black" stroke="black" points="1676.12,-14109.57 1670.91,-14100.34 1669.22,-14110.8 1676.12,-14109.57"/>
</g>
<!-- expert_9_6_down&#45;&gt;aggregate_9 -->
<g id="edge415" class="edge">
<title>expert_9_6_down&#45;&gt;aggregate_9</title>
<path fill="none" stroke="black" d="M1588.34,-14035.98C1577.82,-14032.01 1567.15,-14027.99 1557,-14024.2 1427.97,-13975.99 1282.02,-13922.35 1170.92,-13881.71"/>
<polygon fill="black" stroke="black" points="1171.89,-13878.34 1161.3,-13878.19 1169.49,-13884.91 1171.89,-13878.34"/>
</g>
<!-- expert_9_7_gelu -->
<g id="node357" class="node">
<title>expert_9_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1938" cy="-14174.68" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1938" y="-14185.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1938" y="-14170.98" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1938" y="-14155.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_7_up&#45;&gt;expert_9_7_gelu -->
<g id="edge417" class="edge">
<title>expert_9_7_up&#45;&gt;expert_9_7_gelu</title>
<path fill="none" stroke="black" d="M1926.29,-14249.05C1927.63,-14240.62 1929.1,-14231.4 1930.53,-14222.43"/>
<polygon fill="black" stroke="black" points="1934,-14222.9 1932.13,-14212.47 1927.09,-14221.79 1934,-14222.9"/>
</g>
<!-- expert_9_7_down -->
<g id="node358" class="node">
<title>expert_9_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1995.5,-14100.2 1842.5,-14100.2 1842.5,-14032.2 1995.5,-14032.2 1995.5,-14100.2"/>
<text text-anchor="middle" x="1919" y="-14085" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1919" y="-14070" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1919" y="-14055" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1919" y="-14040" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_9_7_gelu&#45;&gt;expert_9_7_down -->
<g id="edge418" class="edge">
<title>expert_9_7_gelu&#45;&gt;expert_9_7_down</title>
<path fill="none" stroke="black" d="M1931.46,-14137.03C1929.93,-14128.47 1928.29,-14119.27 1926.72,-14110.46"/>
<polygon fill="black" stroke="black" points="1930.12,-14109.57 1924.91,-14100.34 1923.22,-14110.8 1930.12,-14109.57"/>
</g>
<!-- expert_9_7_down&#45;&gt;aggregate_9 -->
<g id="edge419" class="edge">
<title>expert_9_7_down&#45;&gt;aggregate_9</title>
<path fill="none" stroke="black" d="M1842.39,-14034.88C1831.91,-14031.1 1821.23,-14027.43 1811,-14024.2 1596.44,-13956.52 1344.94,-13895.42 1178.03,-13857.36"/>
<polygon fill="black" stroke="black" points="1178.69,-13853.92 1168.16,-13855.11 1177.14,-13860.75 1178.69,-13853.92"/>
</g>
<!-- residual_2_9 -->
<g id="node360" class="node">
<title>residual_2_9</title>
<ellipse fill="none" stroke="black" cx="993" cy="-13562" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="993" y="-13573.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="993" y="-13558.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="993" y="-13543.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- aggregate_9&#45;&gt;residual_2_9 -->
<g id="edge420" class="edge">
<title>aggregate_9&#45;&gt;residual_2_9</title>
<path fill="none" stroke="black" d="M993,-13636.18C993,-13626.89 993,-13618.08 993,-13609.99"/>
<polygon fill="black" stroke="black" points="996.5,-13609.8 993,-13599.8 989.5,-13609.8 996.5,-13609.8"/>
</g>
<!-- input_10 -->
<g id="node361" class="node">
<title>input_10</title>
<ellipse fill="none" stroke="black" cx="993" cy="-13379.04" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="993" y="-13390.34" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="993" y="-13375.34" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="993" y="-13360.34" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_9&#45;&gt;input_10 -->
<g id="edge682" class="edge">
<title>residual_2_9&#45;&gt;input_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M993,-13524.38C993,-13496.3 993,-13457.33 993,-13426.96"/>
<polygon fill="blue" stroke="blue" points="996.5,-13426.61 993,-13416.61 989.5,-13426.61 996.5,-13426.61"/>
<text text-anchor="middle" x="1073.5" y="-13489.32" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1073.5" y="-13474.32" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1073.5" y="-13459.32" font-family="Times,serif" font-size="14.00">GPU 9 &#45;&gt; GPU 10</text>
</g>
<!-- qkv_proj_10 -->
<g id="node362" class="node">
<title>qkv_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="1155,-13283.57 831,-13283.57 831,-13215.57 1155,-13215.57 1155,-13283.57"/>
<text text-anchor="middle" x="993" y="-13268.37" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="993" y="-13253.37" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="993" y="-13238.37" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="993" y="-13223.37" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- input_10&#45;&gt;qkv_proj_10 -->
<g id="edge421" class="edge">
<title>input_10&#45;&gt;qkv_proj_10</title>
<path fill="none" stroke="black" d="M993,-13341.51C993,-13326.69 993,-13309.45 993,-13293.99"/>
<polygon fill="black" stroke="black" points="996.5,-13293.62 993,-13283.62 989.5,-13293.62 996.5,-13293.62"/>
</g>
<!-- reshape_qkv_10 -->
<g id="node363" class="node">
<title>reshape_qkv_10</title>
<polygon fill="none" stroke="black" points="1347.64,-13178.57 783.49,-13178.57 638.36,-13072.57 1202.51,-13072.57 1347.64,-13178.57"/>
<text text-anchor="middle" x="993" y="-13136.87" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="993" y="-13121.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="993" y="-13106.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- qkv_proj_10&#45;&gt;reshape_qkv_10 -->
<g id="edge422" class="edge">
<title>qkv_proj_10&#45;&gt;reshape_qkv_10</title>
<path fill="none" stroke="black" d="M993,-13215.55C993,-13207.35 993,-13198.28 993,-13189.17"/>
<polygon fill="black" stroke="black" points="996.5,-13188.9 993,-13178.9 989.5,-13188.9 996.5,-13188.9"/>
</g>
<!-- attn_scores_10 -->
<g id="node364" class="node">
<title>attn_scores_10</title>
<polygon fill="none" stroke="black" points="993,-13035.57 813,-12982.57 993,-12929.57 1173,-12982.57 993,-13035.57"/>
<text text-anchor="middle" x="993" y="-12993.87" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="993" y="-12978.87" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="993" y="-12963.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- reshape_qkv_10&#45;&gt;attn_scores_10 -->
<g id="edge423" class="edge">
<title>reshape_qkv_10&#45;&gt;attn_scores_10</title>
<path fill="none" stroke="black" d="M993,-13072.47C993,-13063.89 993,-13054.93 993,-13046.14"/>
<polygon fill="black" stroke="black" points="996.5,-13045.93 993,-13035.93 989.5,-13045.93 996.5,-13045.93"/>
</g>
<!-- attn_weights_10 -->
<g id="node365" class="node">
<title>attn_weights_10</title>
<polygon fill="none" stroke="black" points="993,-12892.57 813,-12839.57 993,-12786.57 1173,-12839.57 993,-12892.57"/>
<text text-anchor="middle" x="993" y="-12850.87" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="993" y="-12835.87" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="993" y="-12820.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- attn_scores_10&#45;&gt;attn_weights_10 -->
<g id="edge424" class="edge">
<title>attn_scores_10&#45;&gt;attn_weights_10</title>
<path fill="none" stroke="black" d="M993,-12929.47C993,-12920.89 993,-12911.93 993,-12903.14"/>
<polygon fill="black" stroke="black" points="996.5,-12902.93 993,-12892.93 989.5,-12902.93 996.5,-12902.93"/>
</g>
<!-- attn_output_10 -->
<g id="node366" class="node">
<title>attn_output_10</title>
<polygon fill="none" stroke="black" points="993,-12749.57 822,-12696.57 993,-12643.57 1164,-12696.57 993,-12749.57"/>
<text text-anchor="middle" x="993" y="-12707.87" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="993" y="-12692.87" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="993" y="-12677.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- attn_weights_10&#45;&gt;attn_output_10 -->
<g id="edge425" class="edge">
<title>attn_weights_10&#45;&gt;attn_output_10</title>
<path fill="none" stroke="black" d="M993,-12786.47C993,-12777.89 993,-12768.93 993,-12760.14"/>
<polygon fill="black" stroke="black" points="996.5,-12759.93 993,-12749.93 989.5,-12759.93 996.5,-12759.93"/>
</g>
<!-- out_proj_10 -->
<g id="node367" class="node">
<title>out_proj_10</title>
<polygon fill="lightcoral" stroke="black" points="1069.5,-12606.57 916.5,-12606.57 916.5,-12538.57 1069.5,-12538.57 1069.5,-12606.57"/>
<text text-anchor="middle" x="993" y="-12591.37" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="993" y="-12576.37" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="993" y="-12561.37" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="993" y="-12546.37" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- attn_output_10&#45;&gt;out_proj_10 -->
<g id="edge426" class="edge">
<title>attn_output_10&#45;&gt;out_proj_10</title>
<path fill="none" stroke="black" d="M993,-12643.48C993,-12634.63 993,-12625.54 993,-12616.95"/>
<polygon fill="black" stroke="black" points="996.5,-12616.78 993,-12606.78 989.5,-12616.78 996.5,-12616.78"/>
</g>
<!-- residual_1_10 -->
<g id="node368" class="node">
<title>residual_1_10</title>
<ellipse fill="none" stroke="black" cx="993" cy="-12464.09" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="993" y="-12475.39" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="993" y="-12460.39" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="993" y="-12445.39" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- out_proj_10&#45;&gt;residual_1_10 -->
<g id="edge427" class="edge">
<title>out_proj_10&#45;&gt;residual_1_10</title>
<path fill="none" stroke="black" d="M993,-12538.46C993,-12530.12 993,-12521.02 993,-12512.14"/>
<polygon fill="black" stroke="black" points="996.5,-12511.89 993,-12501.89 989.5,-12511.89 996.5,-12511.89"/>
</g>
<!-- gate_10 -->
<g id="node369" class="node">
<title>gate_10</title>
<polygon fill="lightpink" stroke="black" points="1228.3,-12325.34 1110.65,-12368.39 875.35,-12368.39 757.7,-12325.34 875.35,-12282.29 1110.65,-12282.29 1228.3,-12325.34"/>
<text text-anchor="middle" x="993" y="-12336.64" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="993" y="-12321.64" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="993" y="-12306.64" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- residual_1_10&#45;&gt;gate_10 -->
<g id="edge428" class="edge">
<title>residual_1_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M993,-12426.44C993,-12411.78 993,-12394.61 993,-12378.67"/>
<polygon fill="black" stroke="black" points="996.5,-12378.41 993,-12368.41 989.5,-12378.41 996.5,-12378.41"/>
</g>
<!-- selection_10 -->
<g id="node370" class="node">
<title>selection_10</title>
<polygon fill="none" stroke="black" points="993,-12245.07 791,-12192.07 993,-12139.07 1195,-12192.07 993,-12245.07"/>
<text text-anchor="middle" x="993" y="-12203.37" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="993" y="-12188.37" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="993" y="-12173.37" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- gate_10&#45;&gt;selection_10 -->
<g id="edge429" class="edge">
<title>gate_10&#45;&gt;selection_10</title>
<path fill="none" stroke="black" d="M993,-12282.08C993,-12273.59 993,-12264.49 993,-12255.47"/>
<polygon fill="black" stroke="black" points="996.5,-12255.37 993,-12245.37 989.5,-12255.37 996.5,-12255.37"/>
</g>
<!-- expert_10_0_up -->
<g id="node371" class="node">
<title>expert_10_0_up</title>
<polygon fill="lightgreen" stroke="black" points="245,-12067.07 83,-12067.07 83,-11999.07 245,-11999.07 245,-12067.07"/>
<text text-anchor="middle" x="164" y="-12051.87" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="164" y="-12036.87" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="164" y="-12021.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="164" y="-12006.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- selection_10&#45;&gt;expert_10_0_up -->
<g id="edge430" class="edge">
<title>selection_10&#45;&gt;expert_10_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M804.32,-12188.49C656.24,-12181.34 446.93,-12159.76 274,-12098.07 255.91,-12091.61 237.43,-12082.17 220.91,-12072.5"/>
<polygon fill="red" stroke="red" points="222.32,-12069.27 211.94,-12067.13 218.72,-12075.27 222.32,-12069.27"/>
<text text-anchor="middle" x="393.5" y="-12109.87" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_10_1_up -->
<g id="node374" class="node">
<title>expert_10_1_up</title>
<polygon fill="lightgreen" stroke="black" points="499,-12067.07 337,-12067.07 337,-11999.07 499,-11999.07 499,-12067.07"/>
<text text-anchor="middle" x="418" y="-12051.87" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="418" y="-12036.87" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="418" y="-12021.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="418" y="-12006.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- selection_10&#45;&gt;expert_10_1_up -->
<g id="edge434" class="edge">
<title>selection_10&#45;&gt;expert_10_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M854.12,-12175.48C759.92,-12161.98 633.76,-12138.14 528,-12098.07 510.31,-12091.36 492.14,-12081.98 475.8,-12072.46"/>
<polygon fill="red" stroke="red" points="477.3,-12069.29 466.92,-12067.18 473.72,-12075.3 477.3,-12069.29"/>
<text text-anchor="middle" x="652.5" y="-12109.87" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_10_2_up -->
<g id="node377" class="node">
<title>expert_10_2_up</title>
<polygon fill="lightgreen" stroke="black" points="762,-12067.07 600,-12067.07 600,-11999.07 762,-11999.07 762,-12067.07"/>
<text text-anchor="middle" x="681" y="-12051.87" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="681" y="-12036.87" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="681" y="-12021.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="681" y="-12006.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- selection_10&#45;&gt;expert_10_2_up -->
<g id="edge438" class="edge">
<title>selection_10&#45;&gt;expert_10_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M912.53,-12160.01C872.39,-12143.42 823.65,-12121.6 782,-12098.07 768.01,-12090.16 753.24,-12081.18 739.44,-12072.5"/>
<polygon fill="red" stroke="red" points="741.32,-12069.55 731,-12067.15 737.57,-12075.46 741.32,-12069.55"/>
<text text-anchor="middle" x="884.5" y="-12109.87" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_10_3_up -->
<g id="node380" class="node">
<title>expert_10_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1015,-12067.07 853,-12067.07 853,-11999.07 1015,-11999.07 1015,-12067.07"/>
<text text-anchor="middle" x="934" y="-12051.87" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="934" y="-12036.87" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="934" y="-12021.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="934" y="-12006.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- selection_10&#45;&gt;expert_10_3_up -->
<g id="edge442" class="edge">
<title>selection_10&#45;&gt;expert_10_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M975.14,-12143.53C967.17,-12122.34 957.86,-12097.56 950.11,-12076.95"/>
<polygon fill="red" stroke="red" points="953.36,-12075.62 946.56,-12067.49 946.8,-12078.09 953.36,-12075.62"/>
<text text-anchor="middle" x="1029.5" y="-12109.87" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_10_4_up -->
<g id="node383" class="node">
<title>expert_10_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1227,-12067.07 1065,-12067.07 1065,-11999.07 1227,-11999.07 1227,-12067.07"/>
<text text-anchor="middle" x="1146" y="-12051.87" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1146" y="-12036.87" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1146" y="-12021.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1146" y="-12006.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- selection_10&#45;&gt;expert_10_4_up -->
<g id="edge446" class="edge">
<title>selection_10&#45;&gt;expert_10_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1056.83,-12155.6C1071.43,-12145.64 1086.14,-12133.97 1098,-12121.07 1109.89,-12108.13 1119.92,-12091.72 1127.69,-12076.64"/>
<polygon fill="red" stroke="red" points="1130.93,-12077.98 1132.22,-12067.47 1124.65,-12074.88 1130.93,-12077.98"/>
<text text-anchor="middle" x="1173.5" y="-12109.87" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_10_5_up -->
<g id="node386" class="node">
<title>expert_10_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1481,-12067.07 1319,-12067.07 1319,-11999.07 1481,-11999.07 1481,-12067.07"/>
<text text-anchor="middle" x="1400" y="-12051.87" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1400" y="-12036.87" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1400" y="-12021.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1400" y="-12006.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- selection_10&#45;&gt;expert_10_5_up -->
<g id="edge450" class="edge">
<title>selection_10&#45;&gt;expert_10_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1096.66,-12166.21C1141.87,-12154.28 1195.15,-12138.72 1242,-12121.07 1264.14,-12112.72 1269.09,-12109.13 1290,-12098.07 1305.18,-12090.03 1321.29,-12080.97 1336.35,-12072.25"/>
<polygon fill="red" stroke="red" points="1338.21,-12075.23 1345.09,-12067.17 1334.69,-12069.17 1338.21,-12075.23"/>
<text text-anchor="middle" x="1338.5" y="-12109.87" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_10_6_up -->
<g id="node389" class="node">
<title>expert_10_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1735,-12067.07 1573,-12067.07 1573,-11999.07 1735,-11999.07 1735,-12067.07"/>
<text text-anchor="middle" x="1654" y="-12051.87" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1654" y="-12036.87" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1654" y="-12021.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1654" y="-12006.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- selection_10&#45;&gt;expert_10_6_up -->
<g id="edge454" class="edge">
<title>selection_10&#45;&gt;expert_10_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1148.5,-12179.82C1261.01,-12168.12 1415.25,-12144.64 1544,-12098.07 1561.97,-12091.57 1580.35,-12082.15 1596.82,-12072.54"/>
<polygon fill="red" stroke="red" points="1598.97,-12075.33 1605.75,-12067.19 1595.37,-12069.32 1598.97,-12075.33"/>
<text text-anchor="middle" x="1579.5" y="-12109.87" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_10_7_up -->
<g id="node392" class="node">
<title>expert_10_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1989,-12067.07 1827,-12067.07 1827,-11999.07 1989,-11999.07 1989,-12067.07"/>
<text text-anchor="middle" x="1908" y="-12051.87" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1908" y="-12036.87" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1908" y="-12021.87" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1908" y="-12006.87" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- selection_10&#45;&gt;expert_10_7_up -->
<g id="edge458" class="edge">
<title>selection_10&#45;&gt;expert_10_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1153.21,-12181.04C1353.13,-12167.06 1682.76,-12138.77 1798,-12098.07 1816.11,-12091.67 1834.59,-12082.24 1851.12,-12072.58"/>
<polygon fill="red" stroke="red" points="1853.31,-12075.34 1860.09,-12067.2 1849.71,-12069.34 1853.31,-12075.34"/>
<text text-anchor="middle" x="1826.5" y="-12109.87" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_10_0_gelu -->
<g id="node372" class="node">
<title>expert_10_0_gelu</title>
<ellipse fill="none" stroke="black" cx="147" cy="-11924.59" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="147" y="-11935.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="147" y="-11920.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="147" y="-11905.89" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_0_up&#45;&gt;expert_10_0_gelu -->
<g id="edge431" class="edge">
<title>expert_10_0_up&#45;&gt;expert_10_0_gelu</title>
<path fill="none" stroke="black" d="M158.71,-11998.96C157.37,-11990.53 155.9,-11981.32 154.47,-11972.35"/>
<polygon fill="black" stroke="black" points="157.91,-11971.71 152.87,-11962.38 151,-11972.81 157.91,-11971.71"/>
</g>
<!-- expert_10_0_down -->
<g id="node373" class="node">
<title>expert_10_0_down</title>
<polygon fill="lightgreen" stroke="black" points="251.5,-11850.11 98.5,-11850.11 98.5,-11782.11 251.5,-11782.11 251.5,-11850.11"/>
<text text-anchor="middle" x="175" y="-11834.91" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="175" y="-11819.91" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="175" y="-11804.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="175" y="-11789.91" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_0_gelu&#45;&gt;expert_10_0_down -->
<g id="edge432" class="edge">
<title>expert_10_0_gelu&#45;&gt;expert_10_0_down</title>
<path fill="none" stroke="black" d="M156.64,-11886.95C158.91,-11878.29 161.36,-11868.99 163.7,-11860.08"/>
<polygon fill="black" stroke="black" points="167.13,-11860.81 166.29,-11850.25 160.36,-11859.03 167.13,-11860.81"/>
</g>
<!-- aggregate_10 -->
<g id="node395" class="node">
<title>aggregate_10</title>
<ellipse fill="lightyellow" stroke="black" cx="1001" cy="-11565.75" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="1001" cy="-11565.75" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="1001" y="-11577.05" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="1001" y="-11562.05" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1001" y="-11547.05" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_0_down&#45;&gt;aggregate_10 -->
<g id="edge433" class="edge">
<title>expert_10_0_down&#45;&gt;aggregate_10</title>
<path fill="none" stroke="black" d="M251.68,-11782.35C259.18,-11779.45 266.71,-11776.65 274,-11774.11 456.19,-11710.64 668.85,-11651.69 816.92,-11613"/>
<polygon fill="black" stroke="black" points="818.23,-11616.27 827.03,-11610.36 816.47,-11609.5 818.23,-11616.27"/>
</g>
<!-- expert_10_1_gelu -->
<g id="node375" class="node">
<title>expert_10_1_gelu</title>
<ellipse fill="none" stroke="black" cx="401" cy="-11924.59" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="401" y="-11935.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="401" y="-11920.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="401" y="-11905.89" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_1_up&#45;&gt;expert_10_1_gelu -->
<g id="edge435" class="edge">
<title>expert_10_1_up&#45;&gt;expert_10_1_gelu</title>
<path fill="none" stroke="black" d="M412.71,-11998.96C411.37,-11990.53 409.9,-11981.32 408.47,-11972.35"/>
<polygon fill="black" stroke="black" points="411.91,-11971.71 406.87,-11962.38 405,-11972.81 411.91,-11971.71"/>
</g>
<!-- expert_10_1_down -->
<g id="node376" class="node">
<title>expert_10_1_down</title>
<polygon fill="lightgreen" stroke="black" points="505.5,-11850.11 352.5,-11850.11 352.5,-11782.11 505.5,-11782.11 505.5,-11850.11"/>
<text text-anchor="middle" x="429" y="-11834.91" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="429" y="-11819.91" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="429" y="-11804.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="429" y="-11789.91" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_1_gelu&#45;&gt;expert_10_1_down -->
<g id="edge436" class="edge">
<title>expert_10_1_gelu&#45;&gt;expert_10_1_down</title>
<path fill="none" stroke="black" d="M410.64,-11886.95C412.91,-11878.29 415.36,-11868.99 417.7,-11860.08"/>
<polygon fill="black" stroke="black" points="421.13,-11860.81 420.29,-11850.25 414.36,-11859.03 421.13,-11860.81"/>
</g>
<!-- expert_10_1_down&#45;&gt;aggregate_10 -->
<g id="edge437" class="edge">
<title>expert_10_1_down&#45;&gt;aggregate_10</title>
<path fill="none" stroke="black" d="M505.25,-11782C587.12,-11746.46 719.91,-11688.8 827.47,-11642.1"/>
<polygon fill="black" stroke="black" points="829.03,-11645.24 836.81,-11638.04 826.24,-11638.82 829.03,-11645.24"/>
</g>
<!-- expert_10_2_gelu -->
<g id="node378" class="node">
<title>expert_10_2_gelu</title>
<ellipse fill="none" stroke="black" cx="655" cy="-11924.59" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="655" y="-11935.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="655" y="-11920.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="655" y="-11905.89" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_2_up&#45;&gt;expert_10_2_gelu -->
<g id="edge439" class="edge">
<title>expert_10_2_up&#45;&gt;expert_10_2_gelu</title>
<path fill="none" stroke="black" d="M672.92,-11998.96C670.81,-11990.35 668.51,-11980.92 666.28,-11971.77"/>
<polygon fill="black" stroke="black" points="669.67,-11970.89 663.89,-11962.01 662.87,-11972.55 669.67,-11970.89"/>
</g>
<!-- expert_10_2_down -->
<g id="node379" class="node">
<title>expert_10_2_down</title>
<polygon fill="lightgreen" stroke="black" points="759.5,-11850.11 606.5,-11850.11 606.5,-11782.11 759.5,-11782.11 759.5,-11850.11"/>
<text text-anchor="middle" x="683" y="-11834.91" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="683" y="-11819.91" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="683" y="-11804.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="683" y="-11789.91" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_2_gelu&#45;&gt;expert_10_2_down -->
<g id="edge440" class="edge">
<title>expert_10_2_gelu&#45;&gt;expert_10_2_down</title>
<path fill="none" stroke="black" d="M664.64,-11886.95C666.91,-11878.29 669.36,-11868.99 671.7,-11860.08"/>
<polygon fill="black" stroke="black" points="675.13,-11860.81 674.29,-11850.25 668.36,-11859.03 675.13,-11860.81"/>
</g>
<!-- expert_10_2_down&#45;&gt;aggregate_10 -->
<g id="edge441" class="edge">
<title>expert_10_2_down&#45;&gt;aggregate_10</title>
<path fill="none" stroke="black" d="M725.56,-11781.88C758.35,-11756.26 805.78,-11719.22 852.07,-11683.07"/>
<polygon fill="black" stroke="black" points="854.36,-11685.72 860.09,-11676.8 850.05,-11680.2 854.36,-11685.72"/>
</g>
<!-- expert_10_3_gelu -->
<g id="node381" class="node">
<title>expert_10_3_gelu</title>
<ellipse fill="none" stroke="black" cx="909" cy="-11924.59" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="909" y="-11935.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="909" y="-11920.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="909" y="-11905.89" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_3_up&#45;&gt;expert_10_3_gelu -->
<g id="edge443" class="edge">
<title>expert_10_3_up&#45;&gt;expert_10_3_gelu</title>
<path fill="none" stroke="black" d="M926.23,-11998.96C924.21,-11990.35 921.99,-11980.92 919.84,-11971.77"/>
<polygon fill="black" stroke="black" points="923.24,-11970.94 917.55,-11962.01 916.43,-11972.54 923.24,-11970.94"/>
</g>
<!-- expert_10_3_down -->
<g id="node382" class="node">
<title>expert_10_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1013.5,-11850.11 860.5,-11850.11 860.5,-11782.11 1013.5,-11782.11 1013.5,-11850.11"/>
<text text-anchor="middle" x="937" y="-11834.91" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="937" y="-11819.91" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="937" y="-11804.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="937" y="-11789.91" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_3_gelu&#45;&gt;expert_10_3_down -->
<g id="edge444" class="edge">
<title>expert_10_3_gelu&#45;&gt;expert_10_3_down</title>
<path fill="none" stroke="black" d="M918.64,-11886.95C920.91,-11878.29 923.36,-11868.99 925.7,-11860.08"/>
<polygon fill="black" stroke="black" points="929.13,-11860.81 928.29,-11850.25 922.36,-11859.03 929.13,-11860.81"/>
</g>
<!-- expert_10_3_down&#45;&gt;aggregate_10 -->
<g id="edge445" class="edge">
<title>expert_10_3_down&#45;&gt;aggregate_10</title>
<path fill="none" stroke="black" d="M945.56,-11781.88C948.01,-11772.38 950.86,-11761.32 953.95,-11749.32"/>
<polygon fill="black" stroke="black" points="957.38,-11750.06 956.48,-11739.51 950.6,-11748.32 957.38,-11750.06"/>
</g>
<!-- expert_10_4_gelu -->
<g id="node384" class="node">
<title>expert_10_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1163" cy="-11924.59" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1163" y="-11935.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1163" y="-11920.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1163" y="-11905.89" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_4_up&#45;&gt;expert_10_4_gelu -->
<g id="edge447" class="edge">
<title>expert_10_4_up&#45;&gt;expert_10_4_gelu</title>
<path fill="none" stroke="black" d="M1151.29,-11998.96C1152.63,-11990.53 1154.1,-11981.32 1155.53,-11972.35"/>
<polygon fill="black" stroke="black" points="1159,-11972.81 1157.13,-11962.38 1152.09,-11971.71 1159,-11972.81"/>
</g>
<!-- expert_10_4_down -->
<g id="node385" class="node">
<title>expert_10_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1220.5,-11850.11 1067.5,-11850.11 1067.5,-11782.11 1220.5,-11782.11 1220.5,-11850.11"/>
<text text-anchor="middle" x="1144" y="-11834.91" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1144" y="-11819.91" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1144" y="-11804.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1144" y="-11789.91" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_4_gelu&#45;&gt;expert_10_4_down -->
<g id="edge448" class="edge">
<title>expert_10_4_gelu&#45;&gt;expert_10_4_down</title>
<path fill="none" stroke="black" d="M1156.46,-11886.95C1154.93,-11878.39 1153.29,-11869.19 1151.72,-11860.37"/>
<polygon fill="black" stroke="black" points="1155.12,-11859.48 1149.91,-11850.25 1148.22,-11860.71 1155.12,-11859.48"/>
</g>
<!-- expert_10_4_down&#45;&gt;aggregate_10 -->
<g id="edge449" class="edge">
<title>expert_10_4_down&#45;&gt;aggregate_10</title>
<path fill="none" stroke="black" d="M1124.86,-11781.88C1116.61,-11767.54 1106.29,-11749.63 1095.16,-11730.29"/>
<polygon fill="black" stroke="black" points="1098.19,-11728.54 1090.17,-11721.62 1092.13,-11732.03 1098.19,-11728.54"/>
</g>
<!-- expert_10_5_gelu -->
<g id="node387" class="node">
<title>expert_10_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1417" cy="-11924.59" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1417" y="-11935.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1417" y="-11920.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1417" y="-11905.89" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_5_up&#45;&gt;expert_10_5_gelu -->
<g id="edge451" class="edge">
<title>expert_10_5_up&#45;&gt;expert_10_5_gelu</title>
<path fill="none" stroke="black" d="M1405.29,-11998.96C1406.63,-11990.53 1408.1,-11981.32 1409.53,-11972.35"/>
<polygon fill="black" stroke="black" points="1413,-11972.81 1411.13,-11962.38 1406.09,-11971.71 1413,-11972.81"/>
</g>
<!-- expert_10_5_down -->
<g id="node388" class="node">
<title>expert_10_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1474.5,-11850.11 1321.5,-11850.11 1321.5,-11782.11 1474.5,-11782.11 1474.5,-11850.11"/>
<text text-anchor="middle" x="1398" y="-11834.91" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1398" y="-11819.91" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1398" y="-11804.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1398" y="-11789.91" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_5_gelu&#45;&gt;expert_10_5_down -->
<g id="edge452" class="edge">
<title>expert_10_5_gelu&#45;&gt;expert_10_5_down</title>
<path fill="none" stroke="black" d="M1410.46,-11886.95C1408.93,-11878.39 1407.29,-11869.19 1405.72,-11860.37"/>
<polygon fill="black" stroke="black" points="1409.12,-11859.48 1403.91,-11850.25 1402.22,-11860.71 1409.12,-11859.48"/>
</g>
<!-- expert_10_5_down&#45;&gt;aggregate_10 -->
<g id="edge453" class="edge">
<title>expert_10_5_down&#45;&gt;aggregate_10</title>
<path fill="none" stroke="black" d="M1344.87,-11781.88C1297.86,-11752.46 1226.76,-11707.99 1161.39,-11667.09"/>
<polygon fill="black" stroke="black" points="1162.96,-11663.94 1152.63,-11661.61 1159.25,-11669.88 1162.96,-11663.94"/>
</g>
<!-- expert_10_6_gelu -->
<g id="node390" class="node">
<title>expert_10_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1671" cy="-11924.59" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1671" y="-11935.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1671" y="-11920.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1671" y="-11905.89" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_6_up&#45;&gt;expert_10_6_gelu -->
<g id="edge455" class="edge">
<title>expert_10_6_up&#45;&gt;expert_10_6_gelu</title>
<path fill="none" stroke="black" d="M1659.29,-11998.96C1660.63,-11990.53 1662.1,-11981.32 1663.53,-11972.35"/>
<polygon fill="black" stroke="black" points="1667,-11972.81 1665.13,-11962.38 1660.09,-11971.71 1667,-11972.81"/>
</g>
<!-- expert_10_6_down -->
<g id="node391" class="node">
<title>expert_10_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1728.5,-11850.11 1575.5,-11850.11 1575.5,-11782.11 1728.5,-11782.11 1728.5,-11850.11"/>
<text text-anchor="middle" x="1652" y="-11834.91" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1652" y="-11819.91" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1652" y="-11804.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1652" y="-11789.91" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_6_gelu&#45;&gt;expert_10_6_down -->
<g id="edge456" class="edge">
<title>expert_10_6_gelu&#45;&gt;expert_10_6_down</title>
<path fill="none" stroke="black" d="M1664.46,-11886.95C1662.93,-11878.39 1661.29,-11869.19 1659.72,-11860.37"/>
<polygon fill="black" stroke="black" points="1663.12,-11859.48 1657.91,-11850.25 1656.22,-11860.71 1663.12,-11859.48"/>
</g>
<!-- expert_10_6_down&#45;&gt;aggregate_10 -->
<g id="edge457" class="edge">
<title>expert_10_6_down&#45;&gt;aggregate_10</title>
<path fill="none" stroke="black" d="M1575.41,-11785.89C1478.35,-11748.86 1308.05,-11683.89 1178,-11634.28"/>
<polygon fill="black" stroke="black" points="1178.91,-11630.88 1168.32,-11630.58 1176.41,-11637.42 1178.91,-11630.88"/>
</g>
<!-- expert_10_7_gelu -->
<g id="node393" class="node">
<title>expert_10_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1925" cy="-11924.59" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1925" y="-11935.89" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1925" y="-11920.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1925" y="-11905.89" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_7_up&#45;&gt;expert_10_7_gelu -->
<g id="edge459" class="edge">
<title>expert_10_7_up&#45;&gt;expert_10_7_gelu</title>
<path fill="none" stroke="black" d="M1913.29,-11998.96C1914.63,-11990.53 1916.1,-11981.32 1917.53,-11972.35"/>
<polygon fill="black" stroke="black" points="1921,-11972.81 1919.13,-11962.38 1914.09,-11971.71 1921,-11972.81"/>
</g>
<!-- expert_10_7_down -->
<g id="node394" class="node">
<title>expert_10_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1982.5,-11850.11 1829.5,-11850.11 1829.5,-11782.11 1982.5,-11782.11 1982.5,-11850.11"/>
<text text-anchor="middle" x="1906" y="-11834.91" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1906" y="-11819.91" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1906" y="-11804.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1906" y="-11789.91" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_10_7_gelu&#45;&gt;expert_10_7_down -->
<g id="edge460" class="edge">
<title>expert_10_7_gelu&#45;&gt;expert_10_7_down</title>
<path fill="none" stroke="black" d="M1918.46,-11886.95C1916.93,-11878.39 1915.29,-11869.19 1913.72,-11860.37"/>
<polygon fill="black" stroke="black" points="1917.12,-11859.48 1911.91,-11850.25 1910.22,-11860.71 1917.12,-11859.48"/>
</g>
<!-- expert_10_7_down&#45;&gt;aggregate_10 -->
<g id="edge461" class="edge">
<title>expert_10_7_down&#45;&gt;aggregate_10</title>
<path fill="none" stroke="black" d="M1829.37,-11784.86C1818.89,-11781.06 1808.22,-11777.37 1798,-11774.11 1590.86,-11708.06 1348.59,-11647.31 1186.01,-11608.87"/>
<polygon fill="black" stroke="black" points="1186.44,-11605.38 1175.9,-11606.49 1184.83,-11612.19 1186.44,-11605.38"/>
</g>
<!-- residual_2_10 -->
<g id="node396" class="node">
<title>residual_2_10</title>
<ellipse fill="none" stroke="black" cx="1001" cy="-11311.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1001" y="-11323.21" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1001" y="-11308.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1001" y="-11293.21" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- aggregate_10&#45;&gt;residual_2_10 -->
<g id="edge462" class="edge">
<title>aggregate_10&#45;&gt;residual_2_10</title>
<path fill="none" stroke="black" d="M1001,-11386.09C1001,-11376.81 1001,-11367.99 1001,-11359.9"/>
<polygon fill="black" stroke="black" points="1004.5,-11359.71 1001,-11349.71 997.5,-11359.71 1004.5,-11359.71"/>
</g>
<!-- input_11 -->
<g id="node397" class="node">
<title>input_11</title>
<ellipse fill="none" stroke="black" cx="1001" cy="-11128.96" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1001" y="-11140.26" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1001" y="-11125.26" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1001" y="-11110.26" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_10&#45;&gt;input_11 -->
<g id="edge683" class="edge">
<title>residual_2_10&#45;&gt;input_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1001,-11274.29C1001,-11246.21 1001,-11207.24 1001,-11176.87"/>
<polygon fill="blue" stroke="blue" points="1004.5,-11176.52 1001,-11166.52 997.5,-11176.52 1004.5,-11176.52"/>
<text text-anchor="middle" x="1081.5" y="-11239.23" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1081.5" y="-11224.23" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1081.5" y="-11209.23" font-family="Times,serif" font-size="14.00">GPU 10 &#45;&gt; GPU 11</text>
</g>
<!-- qkv_proj_11 -->
<g id="node398" class="node">
<title>qkv_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="1163,-11033.48 839,-11033.48 839,-10965.48 1163,-10965.48 1163,-11033.48"/>
<text text-anchor="middle" x="1001" y="-11018.28" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1001" y="-11003.28" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1001" y="-10988.28" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="1001" y="-10973.28" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- input_11&#45;&gt;qkv_proj_11 -->
<g id="edge463" class="edge">
<title>input_11&#45;&gt;qkv_proj_11</title>
<path fill="none" stroke="black" d="M1001,-11091.43C1001,-11076.6 1001,-11059.36 1001,-11043.9"/>
<polygon fill="black" stroke="black" points="1004.5,-11043.53 1001,-11033.53 997.5,-11043.53 1004.5,-11043.53"/>
</g>
<!-- reshape_qkv_11 -->
<g id="node399" class="node">
<title>reshape_qkv_11</title>
<polygon fill="none" stroke="black" points="1355.64,-10928.48 791.49,-10928.48 646.36,-10822.48 1210.51,-10822.48 1355.64,-10928.48"/>
<text text-anchor="middle" x="1001" y="-10886.78" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="1001" y="-10871.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1001" y="-10856.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- qkv_proj_11&#45;&gt;reshape_qkv_11 -->
<g id="edge464" class="edge">
<title>qkv_proj_11&#45;&gt;reshape_qkv_11</title>
<path fill="none" stroke="black" d="M1001,-10965.47C1001,-10957.26 1001,-10948.2 1001,-10939.08"/>
<polygon fill="black" stroke="black" points="1004.5,-10938.82 1001,-10928.82 997.5,-10938.82 1004.5,-10938.82"/>
</g>
<!-- attn_scores_11 -->
<g id="node400" class="node">
<title>attn_scores_11</title>
<polygon fill="none" stroke="black" points="1001,-10785.48 821,-10732.48 1001,-10679.48 1181,-10732.48 1001,-10785.48"/>
<text text-anchor="middle" x="1001" y="-10743.78" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1001" y="-10728.78" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1001" y="-10713.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- reshape_qkv_11&#45;&gt;attn_scores_11 -->
<g id="edge465" class="edge">
<title>reshape_qkv_11&#45;&gt;attn_scores_11</title>
<path fill="none" stroke="black" d="M1001,-10822.38C1001,-10813.81 1001,-10804.85 1001,-10796.05"/>
<polygon fill="black" stroke="black" points="1004.5,-10795.84 1001,-10785.84 997.5,-10795.84 1004.5,-10795.84"/>
</g>
<!-- attn_weights_11 -->
<g id="node401" class="node">
<title>attn_weights_11</title>
<polygon fill="none" stroke="black" points="1001,-10642.48 821,-10589.48 1001,-10536.48 1181,-10589.48 1001,-10642.48"/>
<text text-anchor="middle" x="1001" y="-10600.78" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1001" y="-10585.78" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1001" y="-10570.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- attn_scores_11&#45;&gt;attn_weights_11 -->
<g id="edge466" class="edge">
<title>attn_scores_11&#45;&gt;attn_weights_11</title>
<path fill="none" stroke="black" d="M1001,-10679.38C1001,-10670.81 1001,-10661.85 1001,-10653.05"/>
<polygon fill="black" stroke="black" points="1004.5,-10652.84 1001,-10642.84 997.5,-10652.84 1004.5,-10652.84"/>
</g>
<!-- attn_output_11 -->
<g id="node402" class="node">
<title>attn_output_11</title>
<polygon fill="none" stroke="black" points="1001,-10499.48 830,-10446.48 1001,-10393.48 1172,-10446.48 1001,-10499.48"/>
<text text-anchor="middle" x="1001" y="-10457.78" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="1001" y="-10442.78" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1001" y="-10427.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- attn_weights_11&#45;&gt;attn_output_11 -->
<g id="edge467" class="edge">
<title>attn_weights_11&#45;&gt;attn_output_11</title>
<path fill="none" stroke="black" d="M1001,-10536.38C1001,-10527.81 1001,-10518.85 1001,-10510.05"/>
<polygon fill="black" stroke="black" points="1004.5,-10509.84 1001,-10499.84 997.5,-10509.84 1004.5,-10509.84"/>
</g>
<!-- out_proj_11 -->
<g id="node403" class="node">
<title>out_proj_11</title>
<polygon fill="lightcoral" stroke="black" points="1077.5,-10356.48 924.5,-10356.48 924.5,-10288.48 1077.5,-10288.48 1077.5,-10356.48"/>
<text text-anchor="middle" x="1001" y="-10341.28" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1001" y="-10326.28" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1001" y="-10311.28" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1001" y="-10296.28" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- attn_output_11&#45;&gt;out_proj_11 -->
<g id="edge468" class="edge">
<title>attn_output_11&#45;&gt;out_proj_11</title>
<path fill="none" stroke="black" d="M1001,-10393.39C1001,-10384.55 1001,-10375.45 1001,-10366.87"/>
<polygon fill="black" stroke="black" points="1004.5,-10366.7 1001,-10356.7 997.5,-10366.7 1004.5,-10366.7"/>
</g>
<!-- residual_1_11 -->
<g id="node404" class="node">
<title>residual_1_11</title>
<ellipse fill="none" stroke="black" cx="1001" cy="-10214" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1001" y="-10225.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1001" y="-10210.3" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1001" y="-10195.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- out_proj_11&#45;&gt;residual_1_11 -->
<g id="edge469" class="edge">
<title>out_proj_11&#45;&gt;residual_1_11</title>
<path fill="none" stroke="black" d="M1001,-10288.37C1001,-10280.04 1001,-10270.93 1001,-10262.05"/>
<polygon fill="black" stroke="black" points="1004.5,-10261.8 1001,-10251.8 997.5,-10261.8 1004.5,-10261.8"/>
</g>
<!-- gate_11 -->
<g id="node405" class="node">
<title>gate_11</title>
<polygon fill="lightpink" stroke="black" points="1236.3,-10075.25 1118.65,-10118.3 883.35,-10118.3 765.7,-10075.25 883.35,-10032.2 1118.65,-10032.2 1236.3,-10075.25"/>
<text text-anchor="middle" x="1001" y="-10086.55" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1001" y="-10071.55" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="1001" y="-10056.55" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- residual_1_11&#45;&gt;gate_11 -->
<g id="edge470" class="edge">
<title>residual_1_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M1001,-10176.36C1001,-10161.69 1001,-10144.52 1001,-10128.58"/>
<polygon fill="black" stroke="black" points="1004.5,-10128.33 1001,-10118.33 997.5,-10128.33 1004.5,-10128.33"/>
</g>
<!-- selection_11 -->
<g id="node406" class="node">
<title>selection_11</title>
<polygon fill="none" stroke="black" points="1001,-9994.98 799,-9941.98 1001,-9888.98 1203,-9941.98 1001,-9994.98"/>
<text text-anchor="middle" x="1001" y="-9953.28" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="1001" y="-9938.28" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="1001" y="-9923.28" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- gate_11&#45;&gt;selection_11 -->
<g id="edge471" class="edge">
<title>gate_11&#45;&gt;selection_11</title>
<path fill="none" stroke="black" d="M1001,-10031.99C1001,-10023.5 1001,-10014.4 1001,-10005.39"/>
<polygon fill="black" stroke="black" points="1004.5,-10005.28 1001,-9995.28 997.5,-10005.28 1004.5,-10005.28"/>
</g>
<!-- expert_11_0_up -->
<g id="node407" class="node">
<title>expert_11_0_up</title>
<polygon fill="lightgreen" stroke="black" points="253,-9816.98 91,-9816.98 91,-9748.98 253,-9748.98 253,-9816.98"/>
<text text-anchor="middle" x="172" y="-9801.78" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="172" y="-9786.78" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="172" y="-9771.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="172" y="-9756.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- selection_11&#45;&gt;expert_11_0_up -->
<g id="edge472" class="edge">
<title>selection_11&#45;&gt;expert_11_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M846.27,-9929.57C664.75,-9914.72 375.64,-9886.1 274,-9847.98 257.15,-9841.66 240.09,-9832.35 224.88,-9822.78"/>
<polygon fill="red" stroke="red" points="226.44,-9819.62 216.15,-9817.13 222.64,-9825.5 226.44,-9819.62"/>
<text text-anchor="middle" x="424.5" y="-9859.78" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_11_1_up -->
<g id="node410" class="node">
<title>expert_11_1_up</title>
<polygon fill="lightgreen" stroke="black" points="499,-9816.98 337,-9816.98 337,-9748.98 499,-9748.98 499,-9816.98"/>
<text text-anchor="middle" x="418" y="-9801.78" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="418" y="-9786.78" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="418" y="-9771.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="418" y="-9756.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- selection_11&#45;&gt;expert_11_1_up -->
<g id="edge476" class="edge">
<title>selection_11&#45;&gt;expert_11_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M860.52,-9925.81C764.61,-9912.48 635.87,-9888.65 528,-9847.98 510.29,-9841.3 492.13,-9831.93 475.78,-9822.42"/>
<polygon fill="red" stroke="red" points="477.29,-9819.24 466.91,-9817.13 473.71,-9825.25 477.29,-9819.24"/>
<text text-anchor="middle" x="653.5" y="-9859.78" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_11_2_up -->
<g id="node413" class="node">
<title>expert_11_2_up</title>
<polygon fill="lightgreen" stroke="black" points="762,-9816.98 600,-9816.98 600,-9748.98 762,-9748.98 762,-9816.98"/>
<text text-anchor="middle" x="681" y="-9801.78" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="681" y="-9786.78" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="681" y="-9771.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="681" y="-9756.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- selection_11&#45;&gt;expert_11_2_up -->
<g id="edge480" class="edge">
<title>selection_11&#45;&gt;expert_11_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M918.97,-9910.34C877.12,-9893.67 825.91,-9871.64 782,-9847.98 767.62,-9840.23 752.54,-9831.2 738.55,-9822.41"/>
<polygon fill="red" stroke="red" points="740.32,-9819.38 730,-9816.98 736.56,-9825.29 740.32,-9819.38"/>
<text text-anchor="middle" x="886.5" y="-9859.78" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_11_3_up -->
<g id="node416" class="node">
<title>expert_11_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1016,-9816.98 854,-9816.98 854,-9748.98 1016,-9748.98 1016,-9816.98"/>
<text text-anchor="middle" x="935" y="-9801.78" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="935" y="-9786.78" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="935" y="-9771.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="935" y="-9756.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- selection_11&#45;&gt;expert_11_3_up -->
<g id="edge484" class="edge">
<title>selection_11&#45;&gt;expert_11_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M981.2,-9893.87C972.18,-9872.41 961.58,-9847.2 952.81,-9826.35"/>
<polygon fill="red" stroke="red" points="956.02,-9824.96 948.92,-9817.1 949.57,-9827.67 956.02,-9824.96"/>
<text text-anchor="middle" x="1033.5" y="-9859.78" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_11_4_up -->
<g id="node419" class="node">
<title>expert_11_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1227,-9816.98 1065,-9816.98 1065,-9748.98 1227,-9748.98 1227,-9816.98"/>
<text text-anchor="middle" x="1146" y="-9801.78" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1146" y="-9786.78" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1146" y="-9771.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1146" y="-9756.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- selection_11&#45;&gt;expert_11_4_up -->
<g id="edge488" class="edge">
<title>selection_11&#45;&gt;expert_11_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1063.21,-9905.09C1077.08,-9895.22 1090.93,-9883.69 1102,-9870.98 1113.32,-9857.98 1122.6,-9841.55 1129.67,-9826.48"/>
<polygon fill="red" stroke="red" points="1132.88,-9827.87 1133.78,-9817.31 1126.49,-9825 1132.88,-9827.87"/>
<text text-anchor="middle" x="1177.5" y="-9859.78" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_11_5_up -->
<g id="node422" class="node">
<title>expert_11_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1481,-9816.98 1319,-9816.98 1319,-9748.98 1481,-9748.98 1481,-9816.98"/>
<text text-anchor="middle" x="1400" y="-9801.78" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1400" y="-9786.78" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1400" y="-9771.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1400" y="-9756.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- selection_11&#45;&gt;expert_11_5_up -->
<g id="edge492" class="edge">
<title>selection_11&#45;&gt;expert_11_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1105.07,-9916.26C1149.22,-9904.49 1200.81,-9889.03 1246,-9870.98 1266.49,-9862.79 1270.68,-9858.64 1290,-9847.98 1304.88,-9839.77 1320.74,-9830.72 1335.66,-9822.07"/>
<polygon fill="red" stroke="red" points="1337.43,-9825.08 1344.32,-9817.03 1333.92,-9819.03 1337.43,-9825.08"/>
<text text-anchor="middle" x="1339.5" y="-9859.78" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_11_6_up -->
<g id="node425" class="node">
<title>expert_11_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1735,-9816.98 1573,-9816.98 1573,-9748.98 1735,-9748.98 1735,-9816.98"/>
<text text-anchor="middle" x="1654" y="-9801.78" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1654" y="-9786.78" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1654" y="-9771.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1654" y="-9756.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- selection_11&#45;&gt;expert_11_6_up -->
<g id="edge496" class="edge">
<title>selection_11&#45;&gt;expert_11_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1155.13,-9929.34C1265.93,-9917.46 1417.46,-9893.92 1544,-9847.98 1561.96,-9841.46 1580.34,-9832.04 1596.81,-9822.42"/>
<polygon fill="red" stroke="red" points="1598.96,-9825.22 1605.74,-9817.08 1595.36,-9819.21 1598.96,-9825.22"/>
<text text-anchor="middle" x="1580.5" y="-9859.78" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_11_7_up -->
<g id="node428" class="node">
<title>expert_11_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1989,-9816.98 1827,-9816.98 1827,-9748.98 1989,-9748.98 1989,-9816.98"/>
<text text-anchor="middle" x="1908" y="-9801.78" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1908" y="-9786.78" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1908" y="-9771.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1908" y="-9756.78" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- selection_11&#45;&gt;expert_11_7_up -->
<g id="edge500" class="edge">
<title>selection_11&#45;&gt;expert_11_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1160.47,-9930.79C1358.49,-9916.68 1684.07,-9888.29 1798,-9847.98 1816.1,-9841.57 1834.59,-9832.14 1851.12,-9822.48"/>
<polygon fill="red" stroke="red" points="1853.31,-9825.25 1860.08,-9817.1 1849.71,-9819.24 1853.31,-9825.25"/>
<text text-anchor="middle" x="1827.5" y="-9859.78" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_11_0_gelu -->
<g id="node408" class="node">
<title>expert_11_0_gelu</title>
<ellipse fill="none" stroke="black" cx="147" cy="-9674.5" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="147" y="-9685.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="147" y="-9670.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="147" y="-9655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_0_up&#45;&gt;expert_11_0_gelu -->
<g id="edge473" class="edge">
<title>expert_11_0_up&#45;&gt;expert_11_0_gelu</title>
<path fill="none" stroke="black" d="M164.23,-9748.87C162.21,-9740.27 159.99,-9730.83 157.84,-9721.69"/>
<polygon fill="black" stroke="black" points="161.24,-9720.86 155.55,-9711.92 154.43,-9722.46 161.24,-9720.86"/>
</g>
<!-- expert_11_0_down -->
<g id="node409" class="node">
<title>expert_11_0_down</title>
<polygon fill="lightgreen" stroke="black" points="251.5,-9600.03 98.5,-9600.03 98.5,-9532.03 251.5,-9532.03 251.5,-9600.03"/>
<text text-anchor="middle" x="175" y="-9584.83" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="175" y="-9569.83" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="175" y="-9554.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="175" y="-9539.83" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_0_gelu&#45;&gt;expert_11_0_down -->
<g id="edge474" class="edge">
<title>expert_11_0_gelu&#45;&gt;expert_11_0_down</title>
<path fill="none" stroke="black" d="M156.64,-9636.86C158.91,-9628.21 161.36,-9618.9 163.7,-9610"/>
<polygon fill="black" stroke="black" points="167.13,-9610.73 166.29,-9600.17 160.36,-9608.95 167.13,-9610.73"/>
</g>
<!-- aggregate_11 -->
<g id="node431" class="node">
<title>aggregate_11</title>
<ellipse fill="lightyellow" stroke="black" cx="952" cy="-9315.66" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="952" cy="-9315.66" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="952" y="-9326.96" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="952" y="-9311.96" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="952" y="-9296.96" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_0_down&#45;&gt;aggregate_11 -->
<g id="edge475" class="edge">
<title>expert_11_0_down&#45;&gt;aggregate_11</title>
<path fill="none" stroke="black" d="M251.73,-9532.4C259.22,-9529.48 266.73,-9526.63 274,-9524.03 439.74,-9464.51 631.98,-9406.76 769.34,-9367.38"/>
<polygon fill="black" stroke="black" points="770.49,-9370.69 779.14,-9364.58 768.56,-9363.96 770.49,-9370.69"/>
</g>
<!-- expert_11_1_gelu -->
<g id="node411" class="node">
<title>expert_11_1_gelu</title>
<ellipse fill="none" stroke="black" cx="401" cy="-9674.5" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="401" y="-9685.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="401" y="-9670.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="401" y="-9655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_1_up&#45;&gt;expert_11_1_gelu -->
<g id="edge477" class="edge">
<title>expert_11_1_up&#45;&gt;expert_11_1_gelu</title>
<path fill="none" stroke="black" d="M412.71,-9748.87C411.37,-9740.45 409.9,-9731.23 408.47,-9722.26"/>
<polygon fill="black" stroke="black" points="411.91,-9721.62 406.87,-9712.3 405,-9722.72 411.91,-9721.62"/>
</g>
<!-- expert_11_1_down -->
<g id="node412" class="node">
<title>expert_11_1_down</title>
<polygon fill="lightgreen" stroke="black" points="496.5,-9600.03 343.5,-9600.03 343.5,-9532.03 496.5,-9532.03 496.5,-9600.03"/>
<text text-anchor="middle" x="420" y="-9584.83" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="420" y="-9569.83" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="420" y="-9554.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="420" y="-9539.83" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_1_gelu&#45;&gt;expert_11_1_down -->
<g id="edge478" class="edge">
<title>expert_11_1_gelu&#45;&gt;expert_11_1_down</title>
<path fill="none" stroke="black" d="M407.54,-9636.86C409.07,-9628.3 410.71,-9619.1 412.28,-9610.28"/>
<polygon fill="black" stroke="black" points="415.78,-9610.63 414.09,-9600.17 408.88,-9609.4 415.78,-9610.63"/>
</g>
<!-- expert_11_1_down&#45;&gt;aggregate_11 -->
<g id="edge479" class="edge">
<title>expert_11_1_down&#45;&gt;aggregate_11</title>
<path fill="none" stroke="black" d="M490.92,-9531.92C564.51,-9497.56 682.34,-9442.55 780.46,-9396.75"/>
<polygon fill="black" stroke="black" points="782.01,-9399.88 789.59,-9392.48 779.05,-9393.54 782.01,-9399.88"/>
</g>
<!-- expert_11_2_gelu -->
<g id="node414" class="node">
<title>expert_11_2_gelu</title>
<ellipse fill="none" stroke="black" cx="655" cy="-9674.5" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="655" y="-9685.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="655" y="-9670.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="655" y="-9655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_2_up&#45;&gt;expert_11_2_gelu -->
<g id="edge481" class="edge">
<title>expert_11_2_up&#45;&gt;expert_11_2_gelu</title>
<path fill="none" stroke="black" d="M672.92,-9748.87C670.81,-9740.27 668.51,-9730.83 666.28,-9721.69"/>
<polygon fill="black" stroke="black" points="669.67,-9720.81 663.89,-9711.92 662.87,-9722.47 669.67,-9720.81"/>
</g>
<!-- expert_11_2_down -->
<g id="node415" class="node">
<title>expert_11_2_down</title>
<polygon fill="lightgreen" stroke="black" points="759.5,-9600.03 606.5,-9600.03 606.5,-9532.03 759.5,-9532.03 759.5,-9600.03"/>
<text text-anchor="middle" x="683" y="-9584.83" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="683" y="-9569.83" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="683" y="-9554.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="683" y="-9539.83" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_2_gelu&#45;&gt;expert_11_2_down -->
<g id="edge482" class="edge">
<title>expert_11_2_gelu&#45;&gt;expert_11_2_down</title>
<path fill="none" stroke="black" d="M664.64,-9636.86C666.91,-9628.21 669.36,-9618.9 671.7,-9610"/>
<polygon fill="black" stroke="black" points="675.13,-9610.73 674.29,-9600.17 668.36,-9608.95 675.13,-9610.73"/>
</g>
<!-- expert_11_2_down&#45;&gt;aggregate_11 -->
<g id="edge483" class="edge">
<title>expert_11_2_down&#45;&gt;aggregate_11</title>
<path fill="none" stroke="black" d="M719,-9531.79C743.73,-9508.96 778.28,-9477.05 813.23,-9444.79"/>
<polygon fill="black" stroke="black" points="815.71,-9447.26 820.69,-9437.9 810.97,-9442.11 815.71,-9447.26"/>
</g>
<!-- expert_11_3_gelu -->
<g id="node417" class="node">
<title>expert_11_3_gelu</title>
<ellipse fill="none" stroke="black" cx="909" cy="-9674.5" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="909" y="-9685.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="909" y="-9670.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="909" y="-9655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_3_up&#45;&gt;expert_11_3_gelu -->
<g id="edge485" class="edge">
<title>expert_11_3_up&#45;&gt;expert_11_3_gelu</title>
<path fill="none" stroke="black" d="M926.92,-9748.87C924.81,-9740.27 922.51,-9730.83 920.28,-9721.69"/>
<polygon fill="black" stroke="black" points="923.67,-9720.81 917.89,-9711.92 916.87,-9722.47 923.67,-9720.81"/>
</g>
<!-- expert_11_3_down -->
<g id="node418" class="node">
<title>expert_11_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1012.5,-9600.03 859.5,-9600.03 859.5,-9532.03 1012.5,-9532.03 1012.5,-9600.03"/>
<text text-anchor="middle" x="936" y="-9584.83" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="936" y="-9569.83" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="936" y="-9554.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="936" y="-9539.83" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_3_gelu&#45;&gt;expert_11_3_down -->
<g id="edge486" class="edge">
<title>expert_11_3_gelu&#45;&gt;expert_11_3_down</title>
<path fill="none" stroke="black" d="M918.29,-9636.86C920.49,-9628.21 922.85,-9618.9 925.1,-9610"/>
<polygon fill="black" stroke="black" points="928.53,-9610.72 927.6,-9600.17 921.75,-9609 928.53,-9610.72"/>
</g>
<!-- expert_11_3_down&#45;&gt;aggregate_11 -->
<g id="edge487" class="edge">
<title>expert_11_3_down&#45;&gt;aggregate_11</title>
<path fill="none" stroke="black" d="M938.14,-9531.79C938.66,-9523.81 939.24,-9514.72 939.87,-9504.89"/>
<polygon fill="black" stroke="black" points="943.37,-9505.04 940.52,-9494.83 936.39,-9504.59 943.37,-9505.04"/>
</g>
<!-- expert_11_4_gelu -->
<g id="node420" class="node">
<title>expert_11_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1163" cy="-9674.5" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1163" y="-9685.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1163" y="-9670.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1163" y="-9655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_4_up&#45;&gt;expert_11_4_gelu -->
<g id="edge489" class="edge">
<title>expert_11_4_up&#45;&gt;expert_11_4_gelu</title>
<path fill="none" stroke="black" d="M1151.29,-9748.87C1152.63,-9740.45 1154.1,-9731.23 1155.53,-9722.26"/>
<polygon fill="black" stroke="black" points="1159,-9722.72 1157.13,-9712.3 1152.09,-9721.62 1159,-9722.72"/>
</g>
<!-- expert_11_4_down -->
<g id="node421" class="node">
<title>expert_11_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1220.5,-9600.03 1067.5,-9600.03 1067.5,-9532.03 1220.5,-9532.03 1220.5,-9600.03"/>
<text text-anchor="middle" x="1144" y="-9584.83" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1144" y="-9569.83" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1144" y="-9554.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1144" y="-9539.83" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_4_gelu&#45;&gt;expert_11_4_down -->
<g id="edge490" class="edge">
<title>expert_11_4_gelu&#45;&gt;expert_11_4_down</title>
<path fill="none" stroke="black" d="M1156.46,-9636.86C1154.93,-9628.3 1153.29,-9619.1 1151.72,-9610.28"/>
<polygon fill="black" stroke="black" points="1155.12,-9609.4 1149.91,-9600.17 1148.22,-9610.63 1155.12,-9609.4"/>
</g>
<!-- expert_11_4_down&#45;&gt;aggregate_11 -->
<g id="edge491" class="edge">
<title>expert_11_4_down&#45;&gt;aggregate_11</title>
<path fill="none" stroke="black" d="M1118.31,-9531.79C1104.57,-9514.02 1086.58,-9490.74 1067.51,-9466.09"/>
<polygon fill="black" stroke="black" points="1070.18,-9463.81 1061.29,-9458.04 1064.64,-9468.09 1070.18,-9463.81"/>
</g>
<!-- expert_11_5_gelu -->
<g id="node423" class="node">
<title>expert_11_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1417" cy="-9674.5" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1417" y="-9685.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1417" y="-9670.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1417" y="-9655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_5_up&#45;&gt;expert_11_5_gelu -->
<g id="edge493" class="edge">
<title>expert_11_5_up&#45;&gt;expert_11_5_gelu</title>
<path fill="none" stroke="black" d="M1405.29,-9748.87C1406.63,-9740.45 1408.1,-9731.23 1409.53,-9722.26"/>
<polygon fill="black" stroke="black" points="1413,-9722.72 1411.13,-9712.3 1406.09,-9721.62 1413,-9722.72"/>
</g>
<!-- expert_11_5_down -->
<g id="node424" class="node">
<title>expert_11_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1474.5,-9600.03 1321.5,-9600.03 1321.5,-9532.03 1474.5,-9532.03 1474.5,-9600.03"/>
<text text-anchor="middle" x="1398" y="-9584.83" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1398" y="-9569.83" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1398" y="-9554.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1398" y="-9539.83" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_5_gelu&#45;&gt;expert_11_5_down -->
<g id="edge494" class="edge">
<title>expert_11_5_gelu&#45;&gt;expert_11_5_down</title>
<path fill="none" stroke="black" d="M1410.46,-9636.86C1408.93,-9628.3 1407.29,-9619.1 1405.72,-9610.28"/>
<polygon fill="black" stroke="black" points="1409.12,-9609.4 1403.91,-9600.17 1402.22,-9610.63 1409.12,-9609.4"/>
</g>
<!-- expert_11_5_down&#45;&gt;aggregate_11 -->
<g id="edge495" class="edge">
<title>expert_11_5_down&#45;&gt;aggregate_11</title>
<path fill="none" stroke="black" d="M1338.31,-9531.79C1281.97,-9500.41 1194.85,-9451.9 1117.59,-9408.87"/>
<polygon fill="black" stroke="black" points="1119.14,-9405.73 1108.7,-9403.93 1115.74,-9411.85 1119.14,-9405.73"/>
</g>
<!-- expert_11_6_gelu -->
<g id="node426" class="node">
<title>expert_11_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1671" cy="-9674.5" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1671" y="-9685.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1671" y="-9670.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1671" y="-9655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_6_up&#45;&gt;expert_11_6_gelu -->
<g id="edge497" class="edge">
<title>expert_11_6_up&#45;&gt;expert_11_6_gelu</title>
<path fill="none" stroke="black" d="M1659.29,-9748.87C1660.63,-9740.45 1662.1,-9731.23 1663.53,-9722.26"/>
<polygon fill="black" stroke="black" points="1667,-9722.72 1665.13,-9712.3 1660.09,-9721.62 1667,-9722.72"/>
</g>
<!-- expert_11_6_down -->
<g id="node427" class="node">
<title>expert_11_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1728.5,-9600.03 1575.5,-9600.03 1575.5,-9532.03 1728.5,-9532.03 1728.5,-9600.03"/>
<text text-anchor="middle" x="1652" y="-9584.83" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1652" y="-9569.83" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1652" y="-9554.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1652" y="-9539.83" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_6_gelu&#45;&gt;expert_11_6_down -->
<g id="edge498" class="edge">
<title>expert_11_6_gelu&#45;&gt;expert_11_6_down</title>
<path fill="none" stroke="black" d="M1664.46,-9636.86C1662.93,-9628.3 1661.29,-9619.1 1659.72,-9610.28"/>
<polygon fill="black" stroke="black" points="1663.12,-9609.4 1657.91,-9600.17 1656.22,-9610.63 1663.12,-9609.4"/>
</g>
<!-- expert_11_6_down&#45;&gt;aggregate_11 -->
<g id="edge499" class="edge">
<title>expert_11_6_down&#45;&gt;aggregate_11</title>
<path fill="none" stroke="black" d="M1575.39,-9535.66C1564.86,-9531.71 1554.17,-9527.74 1544,-9524.03 1405.8,-9473.6 1248.6,-9418.65 1130.94,-9377.99"/>
<polygon fill="black" stroke="black" points="1132.07,-9374.68 1121.47,-9374.72 1129.78,-9381.29 1132.07,-9374.68"/>
</g>
<!-- expert_11_7_gelu -->
<g id="node429" class="node">
<title>expert_11_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1925" cy="-9674.5" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1925" y="-9685.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1925" y="-9670.8" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1925" y="-9655.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_7_up&#45;&gt;expert_11_7_gelu -->
<g id="edge501" class="edge">
<title>expert_11_7_up&#45;&gt;expert_11_7_gelu</title>
<path fill="none" stroke="black" d="M1913.29,-9748.87C1914.63,-9740.45 1916.1,-9731.23 1917.53,-9722.26"/>
<polygon fill="black" stroke="black" points="1921,-9722.72 1919.13,-9712.3 1914.09,-9721.62 1921,-9722.72"/>
</g>
<!-- expert_11_7_down -->
<g id="node430" class="node">
<title>expert_11_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1982.5,-9600.03 1829.5,-9600.03 1829.5,-9532.03 1982.5,-9532.03 1982.5,-9600.03"/>
<text text-anchor="middle" x="1906" y="-9584.83" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1906" y="-9569.83" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1906" y="-9554.83" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1906" y="-9539.83" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_11_7_gelu&#45;&gt;expert_11_7_down -->
<g id="edge502" class="edge">
<title>expert_11_7_gelu&#45;&gt;expert_11_7_down</title>
<path fill="none" stroke="black" d="M1918.46,-9636.86C1916.93,-9628.3 1915.29,-9619.1 1913.72,-9610.28"/>
<polygon fill="black" stroke="black" points="1917.12,-9609.4 1911.91,-9600.17 1910.22,-9610.63 1917.12,-9609.4"/>
</g>
<!-- expert_11_7_down&#45;&gt;aggregate_11 -->
<g id="edge503" class="edge">
<title>expert_11_7_down&#45;&gt;aggregate_11</title>
<path fill="none" stroke="black" d="M1829.41,-9534.63C1818.93,-9530.86 1808.25,-9527.21 1798,-9524.03 1573.67,-9454.24 1310.04,-9392.78 1137.43,-9355.25"/>
<polygon fill="black" stroke="black" points="1138,-9351.79 1127.48,-9353.09 1136.52,-9358.63 1138,-9351.79"/>
</g>
<!-- residual_2_11 -->
<g id="node432" class="node">
<title>residual_2_11</title>
<ellipse fill="none" stroke="black" cx="952" cy="-9061.82" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="952" y="-9073.12" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="952" y="-9058.12" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="952" y="-9043.12" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- aggregate_11&#45;&gt;residual_2_11 -->
<g id="edge504" class="edge">
<title>aggregate_11&#45;&gt;residual_2_11</title>
<path fill="none" stroke="black" d="M952,-9136C952,-9126.72 952,-9117.9 952,-9109.81"/>
<polygon fill="black" stroke="black" points="955.5,-9109.62 952,-9099.62 948.5,-9109.62 955.5,-9109.62"/>
</g>
<!-- input_12 -->
<g id="node433" class="node">
<title>input_12</title>
<ellipse fill="none" stroke="black" cx="952" cy="-8878.87" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="952" y="-8890.17" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="952" y="-8875.17" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="952" y="-8860.17" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_11&#45;&gt;input_12 -->
<g id="edge684" class="edge">
<title>residual_2_11&#45;&gt;input_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M952,-9024.21C952,-8996.12 952,-8957.15 952,-8926.79"/>
<polygon fill="blue" stroke="blue" points="955.5,-8926.43 952,-8916.43 948.5,-8926.44 955.5,-8926.43"/>
<text text-anchor="middle" x="1032.5" y="-8989.15" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1032.5" y="-8974.15" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1032.5" y="-8959.15" font-family="Times,serif" font-size="14.00">GPU 11 &#45;&gt; GPU 12</text>
</g>
<!-- qkv_proj_12 -->
<g id="node434" class="node">
<title>qkv_proj_12</title>
<polygon fill="lightcoral" stroke="black" points="1114,-8783.39 790,-8783.39 790,-8715.39 1114,-8715.39 1114,-8783.39"/>
<text text-anchor="middle" x="952" y="-8768.19" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="952" y="-8753.19" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="952" y="-8738.19" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="952" y="-8723.19" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- input_12&#45;&gt;qkv_proj_12 -->
<g id="edge505" class="edge">
<title>input_12&#45;&gt;qkv_proj_12</title>
<path fill="none" stroke="black" d="M952,-8841.34C952,-8826.52 952,-8809.27 952,-8793.81"/>
<polygon fill="black" stroke="black" points="955.5,-8793.45 952,-8783.45 948.5,-8793.45 955.5,-8793.45"/>
</g>
<!-- reshape_qkv_12 -->
<g id="node435" class="node">
<title>reshape_qkv_12</title>
<polygon fill="none" stroke="black" points="1306.64,-8678.39 742.49,-8678.39 597.36,-8572.39 1161.51,-8572.39 1306.64,-8678.39"/>
<text text-anchor="middle" x="952" y="-8636.69" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="952" y="-8621.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="952" y="-8606.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- qkv_proj_12&#45;&gt;reshape_qkv_12 -->
<g id="edge506" class="edge">
<title>qkv_proj_12&#45;&gt;reshape_qkv_12</title>
<path fill="none" stroke="black" d="M952,-8715.38C952,-8707.18 952,-8698.11 952,-8689"/>
<polygon fill="black" stroke="black" points="955.5,-8688.73 952,-8678.73 948.5,-8688.73 955.5,-8688.73"/>
</g>
<!-- attn_scores_12 -->
<g id="node436" class="node">
<title>attn_scores_12</title>
<polygon fill="none" stroke="black" points="952,-8535.39 772,-8482.39 952,-8429.39 1132,-8482.39 952,-8535.39"/>
<text text-anchor="middle" x="952" y="-8493.69" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="952" y="-8478.69" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="952" y="-8463.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- reshape_qkv_12&#45;&gt;attn_scores_12 -->
<g id="edge507" class="edge">
<title>reshape_qkv_12&#45;&gt;attn_scores_12</title>
<path fill="none" stroke="black" d="M952,-8572.29C952,-8563.72 952,-8554.76 952,-8545.97"/>
<polygon fill="black" stroke="black" points="955.5,-8545.75 952,-8535.75 948.5,-8545.75 955.5,-8545.75"/>
</g>
<!-- attn_weights_12 -->
<g id="node437" class="node">
<title>attn_weights_12</title>
<polygon fill="none" stroke="black" points="952,-8392.39 772,-8339.39 952,-8286.39 1132,-8339.39 952,-8392.39"/>
<text text-anchor="middle" x="952" y="-8350.69" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="952" y="-8335.69" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="952" y="-8320.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- attn_scores_12&#45;&gt;attn_weights_12 -->
<g id="edge508" class="edge">
<title>attn_scores_12&#45;&gt;attn_weights_12</title>
<path fill="none" stroke="black" d="M952,-8429.29C952,-8420.72 952,-8411.76 952,-8402.97"/>
<polygon fill="black" stroke="black" points="955.5,-8402.75 952,-8392.75 948.5,-8402.75 955.5,-8402.75"/>
</g>
<!-- attn_output_12 -->
<g id="node438" class="node">
<title>attn_output_12</title>
<polygon fill="none" stroke="black" points="952,-8249.39 781,-8196.39 952,-8143.39 1123,-8196.39 952,-8249.39"/>
<text text-anchor="middle" x="952" y="-8207.69" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="952" y="-8192.69" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="952" y="-8177.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- attn_weights_12&#45;&gt;attn_output_12 -->
<g id="edge509" class="edge">
<title>attn_weights_12&#45;&gt;attn_output_12</title>
<path fill="none" stroke="black" d="M952,-8286.29C952,-8277.72 952,-8268.76 952,-8259.97"/>
<polygon fill="black" stroke="black" points="955.5,-8259.75 952,-8249.75 948.5,-8259.75 955.5,-8259.75"/>
</g>
<!-- out_proj_12 -->
<g id="node439" class="node">
<title>out_proj_12</title>
<polygon fill="lightcoral" stroke="black" points="1028.5,-8106.39 875.5,-8106.39 875.5,-8038.39 1028.5,-8038.39 1028.5,-8106.39"/>
<text text-anchor="middle" x="952" y="-8091.19" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="952" y="-8076.19" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="952" y="-8061.19" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="952" y="-8046.19" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- attn_output_12&#45;&gt;out_proj_12 -->
<g id="edge510" class="edge">
<title>attn_output_12&#45;&gt;out_proj_12</title>
<path fill="none" stroke="black" d="M952,-8143.3C952,-8134.46 952,-8125.37 952,-8116.78"/>
<polygon fill="black" stroke="black" points="955.5,-8116.61 952,-8106.61 948.5,-8116.61 955.5,-8116.61"/>
</g>
<!-- residual_1_12 -->
<g id="node440" class="node">
<title>residual_1_12</title>
<ellipse fill="none" stroke="black" cx="952" cy="-7963.92" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="952" y="-7975.22" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="952" y="-7960.22" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="952" y="-7945.22" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- out_proj_12&#45;&gt;residual_1_12 -->
<g id="edge511" class="edge">
<title>out_proj_12&#45;&gt;residual_1_12</title>
<path fill="none" stroke="black" d="M952,-8038.29C952,-8029.95 952,-8020.84 952,-8011.97"/>
<polygon fill="black" stroke="black" points="955.5,-8011.71 952,-8001.71 948.5,-8011.71 955.5,-8011.71"/>
</g>
<!-- gate_12 -->
<g id="node441" class="node">
<title>gate_12</title>
<polygon fill="lightpink" stroke="black" points="1187.3,-7825.17 1069.65,-7868.22 834.35,-7868.22 716.7,-7825.17 834.35,-7782.12 1069.65,-7782.12 1187.3,-7825.17"/>
<text text-anchor="middle" x="952" y="-7836.47" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="952" y="-7821.47" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="952" y="-7806.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- residual_1_12&#45;&gt;gate_12 -->
<g id="edge512" class="edge">
<title>residual_1_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M952,-7926.27C952,-7911.6 952,-7894.43 952,-7878.5"/>
<polygon fill="black" stroke="black" points="955.5,-7878.24 952,-7868.24 948.5,-7878.24 955.5,-7878.24"/>
</g>
<!-- selection_12 -->
<g id="node442" class="node">
<title>selection_12</title>
<polygon fill="none" stroke="black" points="952,-7744.89 750,-7691.89 952,-7638.89 1154,-7691.89 952,-7744.89"/>
<text text-anchor="middle" x="952" y="-7703.19" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="952" y="-7688.19" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="952" y="-7673.19" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- gate_12&#45;&gt;selection_12 -->
<g id="edge513" class="edge">
<title>gate_12&#45;&gt;selection_12</title>
<path fill="none" stroke="black" d="M952,-7781.91C952,-7773.41 952,-7764.32 952,-7755.3"/>
<polygon fill="black" stroke="black" points="955.5,-7755.19 952,-7745.19 948.5,-7755.19 955.5,-7755.19"/>
</g>
<!-- expert_12_0_up -->
<g id="node443" class="node">
<title>expert_12_0_up</title>
<polygon fill="lightgreen" stroke="black" points="254,-7566.89 92,-7566.89 92,-7498.89 254,-7498.89 254,-7566.89"/>
<text text-anchor="middle" x="173" y="-7551.69" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="173" y="-7536.69" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="173" y="-7521.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="173" y="-7506.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- selection_12&#45;&gt;expert_12_0_up -->
<g id="edge514" class="edge">
<title>selection_12&#45;&gt;expert_12_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M766.25,-7687.55C627.06,-7679.81 434.03,-7657.84 275,-7597.89 258.16,-7591.54 241.11,-7582.23 225.89,-7572.65"/>
<polygon fill="red" stroke="red" points="227.46,-7569.5 217.16,-7567.01 223.66,-7575.38 227.46,-7569.5"/>
<text text-anchor="middle" x="391.5" y="-7609.69" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_12_1_up -->
<g id="node446" class="node">
<title>expert_12_1_up</title>
<polygon fill="lightgreen" stroke="black" points="508,-7566.89 346,-7566.89 346,-7498.89 508,-7498.89 508,-7566.89"/>
<text text-anchor="middle" x="427" y="-7551.69" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="427" y="-7536.69" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="427" y="-7521.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="427" y="-7506.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- selection_12&#45;&gt;expert_12_1_up -->
<g id="edge518" class="edge">
<title>selection_12&#45;&gt;expert_12_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M818.9,-7673.66C733.78,-7659.74 622.25,-7636.05 529,-7597.89 512.58,-7591.17 495.84,-7581.88 480.8,-7572.45"/>
<polygon fill="red" stroke="red" points="482.46,-7569.36 472.15,-7566.91 478.68,-7575.25 482.46,-7569.36"/>
<text text-anchor="middle" x="648.5" y="-7609.69" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_12_2_up -->
<g id="node449" class="node">
<title>expert_12_2_up</title>
<polygon fill="lightgreen" stroke="black" points="762,-7566.89 600,-7566.89 600,-7498.89 762,-7498.89 762,-7566.89"/>
<text text-anchor="middle" x="681" y="-7551.69" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="681" y="-7536.69" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="681" y="-7521.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="681" y="-7506.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- selection_12&#45;&gt;expert_12_2_up -->
<g id="edge522" class="edge">
<title>selection_12&#45;&gt;expert_12_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M880.41,-7657.57C857.88,-7646.5 833.11,-7633.71 811,-7620.89 785.69,-7606.22 758.65,-7588.49 735.83,-7572.87"/>
<polygon fill="red" stroke="red" points="737.53,-7569.79 727.31,-7567 733.56,-7575.55 737.53,-7569.79"/>
<text text-anchor="middle" x="875.5" y="-7609.69" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_12_3_up -->
<g id="node452" class="node">
<title>expert_12_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1019,-7566.89 857,-7566.89 857,-7498.89 1019,-7498.89 1019,-7566.89"/>
<text text-anchor="middle" x="938" y="-7551.69" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="938" y="-7536.69" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="938" y="-7521.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="938" y="-7506.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- selection_12&#45;&gt;expert_12_3_up -->
<g id="edge526" class="edge">
<title>selection_12&#45;&gt;expert_12_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M947.45,-7639.92C945.65,-7619.73 943.61,-7596.76 941.88,-7577.37"/>
<polygon fill="red" stroke="red" points="945.35,-7576.96 940.98,-7567.31 938.38,-7577.58 945.35,-7576.96"/>
<text text-anchor="middle" x="1009.5" y="-7609.69" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_12_4_up -->
<g id="node455" class="node">
<title>expert_12_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1228,-7566.89 1066,-7566.89 1066,-7498.89 1228,-7498.89 1228,-7566.89"/>
<text text-anchor="middle" x="1147" y="-7551.69" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1147" y="-7536.69" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1147" y="-7521.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1147" y="-7506.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- selection_12&#45;&gt;expert_12_4_up -->
<g id="edge530" class="edge">
<title>selection_12&#45;&gt;expert_12_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1023.52,-7657.52C1042.22,-7647.14 1061.69,-7634.74 1078,-7620.89 1093.38,-7607.84 1107.71,-7590.93 1119.29,-7575.49"/>
<polygon fill="red" stroke="red" points="1122.34,-7577.23 1125.42,-7567.09 1116.69,-7573.1 1122.34,-7577.23"/>
<text text-anchor="middle" x="1157.5" y="-7609.69" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_12_5_up -->
<g id="node458" class="node">
<title>expert_12_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1482,-7566.89 1320,-7566.89 1320,-7498.89 1482,-7498.89 1482,-7566.89"/>
<text text-anchor="middle" x="1401" y="-7551.69" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1401" y="-7536.69" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1401" y="-7521.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1401" y="-7506.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- selection_12&#45;&gt;expert_12_5_up -->
<g id="edge534" class="edge">
<title>selection_12&#45;&gt;expert_12_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1067.55,-7669.18C1134.7,-7654.14 1219.83,-7630.83 1291,-7597.89 1307.17,-7590.41 1324.08,-7581.28 1339.64,-7572.3"/>
<polygon fill="red" stroke="red" points="1341.77,-7575.11 1348.64,-7567.04 1338.24,-7569.06 1341.77,-7575.11"/>
<text text-anchor="middle" x="1328.5" y="-7609.69" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_12_6_up -->
<g id="node461" class="node">
<title>expert_12_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1736,-7566.89 1574,-7566.89 1574,-7498.89 1736,-7498.89 1736,-7566.89"/>
<text text-anchor="middle" x="1655" y="-7551.69" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1655" y="-7536.69" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1655" y="-7521.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1655" y="-7506.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- selection_12&#45;&gt;expert_12_6_up -->
<g id="edge538" class="edge">
<title>selection_12&#45;&gt;expert_12_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1115.17,-7681.62C1236.59,-7670.86 1404.82,-7647.68 1545,-7597.89 1563.09,-7591.47 1581.58,-7582.03 1598.11,-7572.36"/>
<polygon fill="red" stroke="red" points="1600.29,-7575.13 1607.07,-7566.99 1596.7,-7569.13 1600.29,-7575.13"/>
<text text-anchor="middle" x="1578.5" y="-7609.69" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_12_7_up -->
<g id="node464" class="node">
<title>expert_12_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1990,-7566.89 1828,-7566.89 1828,-7498.89 1990,-7498.89 1990,-7566.89"/>
<text text-anchor="middle" x="1909" y="-7551.69" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1909" y="-7536.69" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1909" y="-7521.69" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1909" y="-7506.69" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- selection_12&#45;&gt;expert_12_7_up -->
<g id="edge542" class="edge">
<title>selection_12&#45;&gt;expert_12_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1101.37,-7678.01C1242.28,-7665.35 1459.3,-7644.53 1647,-7620.89 1714.79,-7612.35 1734.55,-7620.58 1799,-7597.89 1817.11,-7591.51 1835.6,-7582.09 1852.13,-7572.43"/>
<polygon fill="red" stroke="red" points="1854.32,-7575.19 1861.09,-7567.05 1850.72,-7569.19 1854.32,-7575.19"/>
<text text-anchor="middle" x="1835.5" y="-7609.69" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_12_0_gelu -->
<g id="node444" class="node">
<title>expert_12_0_gelu</title>
<ellipse fill="none" stroke="black" cx="148" cy="-7424.42" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="148" y="-7435.72" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="148" y="-7420.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="148" y="-7405.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_0_up&#45;&gt;expert_12_0_gelu -->
<g id="edge515" class="edge">
<title>expert_12_0_up&#45;&gt;expert_12_0_gelu</title>
<path fill="none" stroke="black" d="M165.23,-7498.79C163.21,-7490.18 160.99,-7480.75 158.84,-7471.6"/>
<polygon fill="black" stroke="black" points="162.24,-7470.77 156.55,-7461.84 155.43,-7472.37 162.24,-7470.77"/>
</g>
<!-- expert_12_0_down -->
<g id="node445" class="node">
<title>expert_12_0_down</title>
<polygon fill="lightgreen" stroke="black" points="243.5,-7349.94 90.5,-7349.94 90.5,-7281.94 243.5,-7281.94 243.5,-7349.94"/>
<text text-anchor="middle" x="167" y="-7334.74" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="167" y="-7319.74" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="167" y="-7304.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="167" y="-7289.74" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_0_gelu&#45;&gt;expert_12_0_down -->
<g id="edge516" class="edge">
<title>expert_12_0_gelu&#45;&gt;expert_12_0_down</title>
<path fill="none" stroke="black" d="M154.54,-7386.77C156.07,-7378.21 157.71,-7369.01 159.28,-7360.2"/>
<polygon fill="black" stroke="black" points="162.78,-7360.54 161.09,-7350.08 155.88,-7359.31 162.78,-7360.54"/>
</g>
<!-- aggregate_12 -->
<g id="node467" class="node">
<title>aggregate_12</title>
<ellipse fill="lightyellow" stroke="black" cx="915" cy="-7065.58" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="915" cy="-7065.58" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="915" y="-7076.88" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="915" y="-7061.88" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-7046.88" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_0_down&#45;&gt;aggregate_12 -->
<g id="edge517" class="edge">
<title>expert_12_0_down&#45;&gt;aggregate_12</title>
<path fill="none" stroke="black" d="M243.53,-7285.35C254.07,-7281.43 264.78,-7277.53 275,-7273.94 428.99,-7219.8 605.58,-7162.97 734.21,-7122.53"/>
<polygon fill="black" stroke="black" points="735.28,-7125.86 743.77,-7119.52 733.18,-7119.18 735.28,-7125.86"/>
</g>
<!-- expert_12_1_gelu -->
<g id="node447" class="node">
<title>expert_12_1_gelu</title>
<ellipse fill="none" stroke="black" cx="402" cy="-7424.42" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="402" y="-7435.72" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="402" y="-7420.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="402" y="-7405.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_1_up&#45;&gt;expert_12_1_gelu -->
<g id="edge519" class="edge">
<title>expert_12_1_up&#45;&gt;expert_12_1_gelu</title>
<path fill="none" stroke="black" d="M419.23,-7498.79C417.21,-7490.18 414.99,-7480.75 412.84,-7471.6"/>
<polygon fill="black" stroke="black" points="416.24,-7470.77 410.55,-7461.84 409.43,-7472.37 416.24,-7470.77"/>
</g>
<!-- expert_12_1_down -->
<g id="node448" class="node">
<title>expert_12_1_down</title>
<polygon fill="lightgreen" stroke="black" points="497.5,-7349.94 344.5,-7349.94 344.5,-7281.94 497.5,-7281.94 497.5,-7349.94"/>
<text text-anchor="middle" x="421" y="-7334.74" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="421" y="-7319.74" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="421" y="-7304.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="421" y="-7289.74" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_1_gelu&#45;&gt;expert_12_1_down -->
<g id="edge520" class="edge">
<title>expert_12_1_gelu&#45;&gt;expert_12_1_down</title>
<path fill="none" stroke="black" d="M408.54,-7386.77C410.07,-7378.21 411.71,-7369.01 413.28,-7360.2"/>
<polygon fill="black" stroke="black" points="416.78,-7360.54 415.09,-7350.08 409.88,-7359.31 416.78,-7360.54"/>
</g>
<!-- expert_12_1_down&#45;&gt;aggregate_12 -->
<g id="edge521" class="edge">
<title>expert_12_1_down&#45;&gt;aggregate_12</title>
<path fill="none" stroke="black" d="M486.85,-7281.83C552.76,-7248.7 656.88,-7196.35 745.93,-7151.58"/>
<polygon fill="black" stroke="black" points="747.69,-7154.61 755.05,-7146.99 744.55,-7148.36 747.69,-7154.61"/>
</g>
<!-- expert_12_2_gelu -->
<g id="node450" class="node">
<title>expert_12_2_gelu</title>
<ellipse fill="none" stroke="black" cx="656" cy="-7424.42" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="656" y="-7435.72" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="656" y="-7420.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="656" y="-7405.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_2_up&#45;&gt;expert_12_2_gelu -->
<g id="edge523" class="edge">
<title>expert_12_2_up&#45;&gt;expert_12_2_gelu</title>
<path fill="none" stroke="black" d="M673.23,-7498.79C671.21,-7490.18 668.99,-7480.75 666.84,-7471.6"/>
<polygon fill="black" stroke="black" points="670.24,-7470.77 664.55,-7461.84 663.43,-7472.37 670.24,-7470.77"/>
</g>
<!-- expert_12_2_down -->
<g id="node451" class="node">
<title>expert_12_2_down</title>
<polygon fill="lightgreen" stroke="black" points="760.5,-7349.94 607.5,-7349.94 607.5,-7281.94 760.5,-7281.94 760.5,-7349.94"/>
<text text-anchor="middle" x="684" y="-7334.74" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="684" y="-7319.74" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="684" y="-7304.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="684" y="-7289.74" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_2_gelu&#45;&gt;expert_12_2_down -->
<g id="edge524" class="edge">
<title>expert_12_2_gelu&#45;&gt;expert_12_2_down</title>
<path fill="none" stroke="black" d="M665.64,-7386.77C667.91,-7378.12 670.36,-7368.81 672.7,-7359.91"/>
<polygon fill="black" stroke="black" points="676.13,-7360.64 675.29,-7350.08 669.36,-7358.86 676.13,-7360.64"/>
</g>
<!-- expert_12_2_down&#45;&gt;aggregate_12 -->
<g id="edge525" class="edge">
<title>expert_12_2_down&#45;&gt;aggregate_12</title>
<path fill="none" stroke="black" d="M714.91,-7281.7C733.82,-7261.38 759.41,-7233.86 785.97,-7205.3"/>
<polygon fill="black" stroke="black" points="788.87,-7207.33 793.11,-7197.62 783.74,-7202.56 788.87,-7207.33"/>
</g>
<!-- expert_12_3_gelu -->
<g id="node453" class="node">
<title>expert_12_3_gelu</title>
<ellipse fill="none" stroke="black" cx="910" cy="-7424.42" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="910" y="-7435.72" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="910" y="-7420.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="910" y="-7405.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_3_up&#45;&gt;expert_12_3_gelu -->
<g id="edge527" class="edge">
<title>expert_12_3_up&#45;&gt;expert_12_3_gelu</title>
<path fill="none" stroke="black" d="M929.29,-7498.79C927.03,-7490.18 924.55,-7480.75 922.14,-7471.6"/>
<polygon fill="black" stroke="black" points="925.51,-7470.62 919.58,-7461.84 918.74,-7472.4 925.51,-7470.62"/>
</g>
<!-- expert_12_3_down -->
<g id="node454" class="node">
<title>expert_12_3_down</title>
<polygon fill="lightgreen" stroke="black" points="987.5,-7349.94 834.5,-7349.94 834.5,-7281.94 987.5,-7281.94 987.5,-7349.94"/>
<text text-anchor="middle" x="911" y="-7334.74" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="911" y="-7319.74" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="911" y="-7304.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="911" y="-7289.74" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_3_gelu&#45;&gt;expert_12_3_down -->
<g id="edge528" class="edge">
<title>expert_12_3_gelu&#45;&gt;expert_12_3_down</title>
<path fill="none" stroke="black" d="M910.34,-7386.77C910.42,-7378.21 910.51,-7369.01 910.59,-7360.2"/>
<polygon fill="black" stroke="black" points="914.09,-7360.11 910.69,-7350.08 907.09,-7360.05 914.09,-7360.11"/>
</g>
<!-- expert_12_3_down&#45;&gt;aggregate_12 -->
<g id="edge529" class="edge">
<title>expert_12_3_down&#45;&gt;aggregate_12</title>
<path fill="none" stroke="black" d="M911.54,-7281.7C911.66,-7273.85 911.81,-7264.93 911.96,-7255.29"/>
<polygon fill="black" stroke="black" points="915.46,-7255.06 912.13,-7245 908.47,-7254.94 915.46,-7255.06"/>
</g>
<!-- expert_12_4_gelu -->
<g id="node456" class="node">
<title>expert_12_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1164" cy="-7424.42" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1164" y="-7435.72" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1164" y="-7420.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1164" y="-7405.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_4_up&#45;&gt;expert_12_4_gelu -->
<g id="edge531" class="edge">
<title>expert_12_4_up&#45;&gt;expert_12_4_gelu</title>
<path fill="none" stroke="black" d="M1152.29,-7498.79C1153.63,-7490.36 1155.1,-7481.14 1156.53,-7472.17"/>
<polygon fill="black" stroke="black" points="1160,-7472.64 1158.13,-7462.21 1153.09,-7471.53 1160,-7472.64"/>
</g>
<!-- expert_12_4_down -->
<g id="node457" class="node">
<title>expert_12_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1221.5,-7349.94 1068.5,-7349.94 1068.5,-7281.94 1221.5,-7281.94 1221.5,-7349.94"/>
<text text-anchor="middle" x="1145" y="-7334.74" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1145" y="-7319.74" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1145" y="-7304.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1145" y="-7289.74" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_4_gelu&#45;&gt;expert_12_4_down -->
<g id="edge532" class="edge">
<title>expert_12_4_gelu&#45;&gt;expert_12_4_down</title>
<path fill="none" stroke="black" d="M1157.46,-7386.77C1155.93,-7378.21 1154.29,-7369.01 1152.72,-7360.2"/>
<polygon fill="black" stroke="black" points="1156.12,-7359.31 1150.91,-7350.08 1149.22,-7360.54 1156.12,-7359.31"/>
</g>
<!-- expert_12_4_down&#45;&gt;aggregate_12 -->
<g id="edge533" class="edge">
<title>expert_12_4_down&#45;&gt;aggregate_12</title>
<path fill="none" stroke="black" d="M1114.22,-7281.7C1095.45,-7261.44 1070.07,-7234.02 1043.7,-7205.56"/>
<polygon fill="black" stroke="black" points="1045.98,-7202.86 1036.62,-7197.9 1040.84,-7207.62 1045.98,-7202.86"/>
</g>
<!-- expert_12_5_gelu -->
<g id="node459" class="node">
<title>expert_12_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1418" cy="-7424.42" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1418" y="-7435.72" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1418" y="-7420.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1418" y="-7405.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_5_up&#45;&gt;expert_12_5_gelu -->
<g id="edge535" class="edge">
<title>expert_12_5_up&#45;&gt;expert_12_5_gelu</title>
<path fill="none" stroke="black" d="M1406.29,-7498.79C1407.63,-7490.36 1409.1,-7481.14 1410.53,-7472.17"/>
<polygon fill="black" stroke="black" points="1414,-7472.64 1412.13,-7462.21 1407.09,-7471.53 1414,-7472.64"/>
</g>
<!-- expert_12_5_down -->
<g id="node460" class="node">
<title>expert_12_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1475.5,-7349.94 1322.5,-7349.94 1322.5,-7281.94 1475.5,-7281.94 1475.5,-7349.94"/>
<text text-anchor="middle" x="1399" y="-7334.74" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1399" y="-7319.74" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1399" y="-7304.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1399" y="-7289.74" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_5_gelu&#45;&gt;expert_12_5_down -->
<g id="edge536" class="edge">
<title>expert_12_5_gelu&#45;&gt;expert_12_5_down</title>
<path fill="none" stroke="black" d="M1411.46,-7386.77C1409.93,-7378.21 1408.29,-7369.01 1406.72,-7360.2"/>
<polygon fill="black" stroke="black" points="1410.12,-7359.31 1404.91,-7350.08 1403.22,-7360.54 1410.12,-7359.31"/>
</g>
<!-- expert_12_5_down&#45;&gt;aggregate_12 -->
<g id="edge537" class="edge">
<title>expert_12_5_down&#45;&gt;aggregate_12</title>
<path fill="none" stroke="black" d="M1334.48,-7281.83C1270.6,-7249.05 1170.06,-7197.46 1083.43,-7153.01"/>
<polygon fill="black" stroke="black" points="1084.78,-7149.77 1074.29,-7148.32 1081.59,-7155.99 1084.78,-7149.77"/>
</g>
<!-- expert_12_6_gelu -->
<g id="node462" class="node">
<title>expert_12_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1672" cy="-7424.42" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1672" y="-7435.72" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1672" y="-7420.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1672" y="-7405.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_6_up&#45;&gt;expert_12_6_gelu -->
<g id="edge539" class="edge">
<title>expert_12_6_up&#45;&gt;expert_12_6_gelu</title>
<path fill="none" stroke="black" d="M1660.29,-7498.79C1661.63,-7490.36 1663.1,-7481.14 1664.53,-7472.17"/>
<polygon fill="black" stroke="black" points="1668,-7472.64 1666.13,-7462.21 1661.09,-7471.53 1668,-7472.64"/>
</g>
<!-- expert_12_6_down -->
<g id="node463" class="node">
<title>expert_12_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1729.5,-7349.94 1576.5,-7349.94 1576.5,-7281.94 1729.5,-7281.94 1729.5,-7349.94"/>
<text text-anchor="middle" x="1653" y="-7334.74" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1653" y="-7319.74" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1653" y="-7304.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1653" y="-7289.74" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_6_gelu&#45;&gt;expert_12_6_down -->
<g id="edge540" class="edge">
<title>expert_12_6_gelu&#45;&gt;expert_12_6_down</title>
<path fill="none" stroke="black" d="M1665.46,-7386.77C1663.93,-7378.21 1662.29,-7369.01 1660.72,-7360.2"/>
<polygon fill="black" stroke="black" points="1664.12,-7359.31 1658.91,-7350.08 1657.22,-7360.54 1664.12,-7359.31"/>
</g>
<!-- expert_12_6_down&#45;&gt;aggregate_12 -->
<g id="edge541" class="edge">
<title>expert_12_6_down&#45;&gt;aggregate_12</title>
<path fill="none" stroke="black" d="M1576.46,-7285.4C1565.92,-7281.47 1555.21,-7277.55 1545,-7273.94 1394.39,-7220.59 1221.96,-7164.16 1095.61,-7123.65"/>
<polygon fill="black" stroke="black" points="1096.42,-7120.23 1085.83,-7120.52 1094.28,-7126.9 1096.42,-7120.23"/>
</g>
<!-- expert_12_7_gelu -->
<g id="node465" class="node">
<title>expert_12_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1926" cy="-7424.42" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1926" y="-7435.72" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1926" y="-7420.72" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1926" y="-7405.72" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_7_up&#45;&gt;expert_12_7_gelu -->
<g id="edge543" class="edge">
<title>expert_12_7_up&#45;&gt;expert_12_7_gelu</title>
<path fill="none" stroke="black" d="M1914.29,-7498.79C1915.63,-7490.36 1917.1,-7481.14 1918.53,-7472.17"/>
<polygon fill="black" stroke="black" points="1922,-7472.64 1920.13,-7462.21 1915.09,-7471.53 1922,-7472.64"/>
</g>
<!-- expert_12_7_down -->
<g id="node466" class="node">
<title>expert_12_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1983.5,-7349.94 1830.5,-7349.94 1830.5,-7281.94 1983.5,-7281.94 1983.5,-7349.94"/>
<text text-anchor="middle" x="1907" y="-7334.74" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1907" y="-7319.74" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1907" y="-7304.74" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1907" y="-7289.74" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_12_7_gelu&#45;&gt;expert_12_7_down -->
<g id="edge544" class="edge">
<title>expert_12_7_gelu&#45;&gt;expert_12_7_down</title>
<path fill="none" stroke="black" d="M1919.46,-7386.77C1917.93,-7378.21 1916.29,-7369.01 1914.72,-7360.2"/>
<polygon fill="black" stroke="black" points="1918.12,-7359.31 1912.91,-7350.08 1911.22,-7360.54 1918.12,-7359.31"/>
</g>
<!-- expert_12_7_down&#45;&gt;aggregate_12 -->
<g id="edge545" class="edge">
<title>expert_12_7_down&#45;&gt;aggregate_12</title>
<path fill="none" stroke="black" d="M1830.44,-7284.45C1819.95,-7280.69 1809.26,-7277.08 1799,-7273.94 1561.41,-7201.32 1281.32,-7139.53 1101.11,-7102.75"/>
<polygon fill="black" stroke="black" points="1101.76,-7099.31 1091.26,-7100.74 1100.36,-7106.17 1101.76,-7099.31"/>
</g>
<!-- residual_2_12 -->
<g id="node468" class="node">
<title>residual_2_12</title>
<ellipse fill="none" stroke="black" cx="915" cy="-6811.74" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="915" y="-6823.04" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="915" y="-6808.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-6793.04" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- aggregate_12&#45;&gt;residual_2_12 -->
<g id="edge546" class="edge">
<title>aggregate_12&#45;&gt;residual_2_12</title>
<path fill="none" stroke="black" d="M915,-6885.92C915,-6876.63 915,-6867.82 915,-6859.73"/>
<polygon fill="black" stroke="black" points="918.5,-6859.53 915,-6849.53 911.5,-6859.53 918.5,-6859.53"/>
</g>
<!-- input_13 -->
<g id="node469" class="node">
<title>input_13</title>
<ellipse fill="none" stroke="black" cx="915" cy="-6628.78" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="915" y="-6640.08" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="915" y="-6625.08" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-6610.08" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_12&#45;&gt;input_13 -->
<g id="edge685" class="edge">
<title>residual_2_12&#45;&gt;input_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M915,-6774.12C915,-6746.04 915,-6707.07 915,-6676.7"/>
<polygon fill="blue" stroke="blue" points="918.5,-6676.35 915,-6666.35 911.5,-6676.35 918.5,-6676.35"/>
<text text-anchor="middle" x="995.5" y="-6739.06" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="995.5" y="-6724.06" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="995.5" y="-6709.06" font-family="Times,serif" font-size="14.00">GPU 12 &#45;&gt; GPU 13</text>
</g>
<!-- qkv_proj_13 -->
<g id="node470" class="node">
<title>qkv_proj_13</title>
<polygon fill="lightcoral" stroke="black" points="1077,-6533.31 753,-6533.31 753,-6465.31 1077,-6465.31 1077,-6533.31"/>
<text text-anchor="middle" x="915" y="-6518.11" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="915" y="-6503.11" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="915" y="-6488.11" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="915" y="-6473.11" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- input_13&#45;&gt;qkv_proj_13 -->
<g id="edge547" class="edge">
<title>input_13&#45;&gt;qkv_proj_13</title>
<path fill="none" stroke="black" d="M915,-6591.25C915,-6576.43 915,-6559.19 915,-6543.73"/>
<polygon fill="black" stroke="black" points="918.5,-6543.36 915,-6533.36 911.5,-6543.36 918.5,-6543.36"/>
</g>
<!-- reshape_qkv_13 -->
<g id="node471" class="node">
<title>reshape_qkv_13</title>
<polygon fill="none" stroke="black" points="1269.64,-6428.31 705.49,-6428.31 560.36,-6322.31 1124.51,-6322.31 1269.64,-6428.31"/>
<text text-anchor="middle" x="915" y="-6386.61" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="915" y="-6371.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="915" y="-6356.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- qkv_proj_13&#45;&gt;reshape_qkv_13 -->
<g id="edge548" class="edge">
<title>qkv_proj_13&#45;&gt;reshape_qkv_13</title>
<path fill="none" stroke="black" d="M915,-6465.29C915,-6457.09 915,-6448.02 915,-6438.91"/>
<polygon fill="black" stroke="black" points="918.5,-6438.64 915,-6428.64 911.5,-6438.64 918.5,-6438.64"/>
</g>
<!-- attn_scores_13 -->
<g id="node472" class="node">
<title>attn_scores_13</title>
<polygon fill="none" stroke="black" points="915,-6285.31 735,-6232.31 915,-6179.31 1095,-6232.31 915,-6285.31"/>
<text text-anchor="middle" x="915" y="-6243.61" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="915" y="-6228.61" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="915" y="-6213.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- reshape_qkv_13&#45;&gt;attn_scores_13 -->
<g id="edge549" class="edge">
<title>reshape_qkv_13&#45;&gt;attn_scores_13</title>
<path fill="none" stroke="black" d="M915,-6322.2C915,-6313.63 915,-6304.67 915,-6295.88"/>
<polygon fill="black" stroke="black" points="918.5,-6295.67 915,-6285.67 911.5,-6295.67 918.5,-6295.67"/>
</g>
<!-- attn_weights_13 -->
<g id="node473" class="node">
<title>attn_weights_13</title>
<polygon fill="none" stroke="black" points="915,-6142.31 735,-6089.31 915,-6036.31 1095,-6089.31 915,-6142.31"/>
<text text-anchor="middle" x="915" y="-6100.61" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="915" y="-6085.61" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="915" y="-6070.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- attn_scores_13&#45;&gt;attn_weights_13 -->
<g id="edge550" class="edge">
<title>attn_scores_13&#45;&gt;attn_weights_13</title>
<path fill="none" stroke="black" d="M915,-6179.2C915,-6170.63 915,-6161.67 915,-6152.88"/>
<polygon fill="black" stroke="black" points="918.5,-6152.67 915,-6142.67 911.5,-6152.67 918.5,-6152.67"/>
</g>
<!-- attn_output_13 -->
<g id="node474" class="node">
<title>attn_output_13</title>
<polygon fill="none" stroke="black" points="915,-5999.31 744,-5946.31 915,-5893.31 1086,-5946.31 915,-5999.31"/>
<text text-anchor="middle" x="915" y="-5957.61" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="915" y="-5942.61" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="915" y="-5927.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- attn_weights_13&#45;&gt;attn_output_13 -->
<g id="edge551" class="edge">
<title>attn_weights_13&#45;&gt;attn_output_13</title>
<path fill="none" stroke="black" d="M915,-6036.2C915,-6027.63 915,-6018.67 915,-6009.88"/>
<polygon fill="black" stroke="black" points="918.5,-6009.67 915,-5999.67 911.5,-6009.67 918.5,-6009.67"/>
</g>
<!-- out_proj_13 -->
<g id="node475" class="node">
<title>out_proj_13</title>
<polygon fill="lightcoral" stroke="black" points="991.5,-5856.31 838.5,-5856.31 838.5,-5788.31 991.5,-5788.31 991.5,-5856.31"/>
<text text-anchor="middle" x="915" y="-5841.11" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="915" y="-5826.11" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="915" y="-5811.11" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-5796.11" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- attn_output_13&#45;&gt;out_proj_13 -->
<g id="edge552" class="edge">
<title>attn_output_13&#45;&gt;out_proj_13</title>
<path fill="none" stroke="black" d="M915,-5893.21C915,-5884.37 915,-5875.28 915,-5866.69"/>
<polygon fill="black" stroke="black" points="918.5,-5866.52 915,-5856.52 911.5,-5866.52 918.5,-5866.52"/>
</g>
<!-- residual_1_13 -->
<g id="node476" class="node">
<title>residual_1_13</title>
<ellipse fill="none" stroke="black" cx="915" cy="-5713.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="915" y="-5725.13" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="915" y="-5710.13" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="915" y="-5695.13" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- out_proj_13&#45;&gt;residual_1_13 -->
<g id="edge553" class="edge">
<title>out_proj_13&#45;&gt;residual_1_13</title>
<path fill="none" stroke="black" d="M915,-5788.2C915,-5779.86 915,-5770.75 915,-5761.88"/>
<polygon fill="black" stroke="black" points="918.5,-5761.63 915,-5751.63 911.5,-5761.63 918.5,-5761.63"/>
</g>
<!-- gate_13 -->
<g id="node477" class="node">
<title>gate_13</title>
<polygon fill="lightpink" stroke="black" points="1150.3,-5575.08 1032.65,-5618.13 797.35,-5618.13 679.7,-5575.08 797.35,-5532.03 1032.65,-5532.03 1150.3,-5575.08"/>
<text text-anchor="middle" x="915" y="-5586.38" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="915" y="-5571.38" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="915" y="-5556.38" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- residual_1_13&#45;&gt;gate_13 -->
<g id="edge554" class="edge">
<title>residual_1_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M915,-5676.18C915,-5661.52 915,-5644.35 915,-5628.41"/>
<polygon fill="black" stroke="black" points="918.5,-5628.15 915,-5618.15 911.5,-5628.15 918.5,-5628.15"/>
</g>
<!-- selection_13 -->
<g id="node478" class="node">
<title>selection_13</title>
<polygon fill="none" stroke="black" points="915,-5494.81 713,-5441.81 915,-5388.81 1117,-5441.81 915,-5494.81"/>
<text text-anchor="middle" x="915" y="-5453.11" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="915" y="-5438.11" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="915" y="-5423.11" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- gate_13&#45;&gt;selection_13 -->
<g id="edge555" class="edge">
<title>gate_13&#45;&gt;selection_13</title>
<path fill="none" stroke="black" d="M915,-5531.82C915,-5523.33 915,-5514.23 915,-5505.21"/>
<polygon fill="black" stroke="black" points="918.5,-5505.11 915,-5495.11 911.5,-5505.11 918.5,-5505.11"/>
</g>
<!-- expert_13_0_up -->
<g id="node479" class="node">
<title>expert_13_0_up</title>
<polygon fill="lightgreen" stroke="black" points="256,-5316.81 94,-5316.81 94,-5248.81 256,-5248.81 256,-5316.81"/>
<text text-anchor="middle" x="175" y="-5301.61" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="175" y="-5286.61" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="175" y="-5271.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="175" y="-5256.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- selection_13&#45;&gt;expert_13_0_up -->
<g id="edge556" class="edge">
<title>selection_13&#45;&gt;expert_13_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M738.82,-5435.03C607.87,-5426.03 426.75,-5403.53 277,-5347.81 260.05,-5341.5 242.9,-5332.14 227.63,-5322.52"/>
<polygon fill="red" stroke="red" points="229.17,-5319.35 218.88,-5316.85 225.36,-5325.22 229.17,-5319.35"/>
<text text-anchor="middle" x="407.5" y="-5359.61" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_13_1_up -->
<g id="node482" class="node">
<title>expert_13_1_up</title>
<polygon fill="lightgreen" stroke="black" points="510,-5316.81 348,-5316.81 348,-5248.81 510,-5248.81 510,-5316.81"/>
<text text-anchor="middle" x="429" y="-5301.61" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="429" y="-5286.61" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="429" y="-5271.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="429" y="-5256.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- selection_13&#45;&gt;expert_13_1_up -->
<g id="edge560" class="edge">
<title>selection_13&#45;&gt;expert_13_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M790.72,-5421.24C713.92,-5406.61 614.43,-5382.98 531,-5347.81 514.82,-5340.98 498.27,-5331.75 483.34,-5322.41"/>
<polygon fill="red" stroke="red" points="485.06,-5319.36 474.75,-5316.92 481.3,-5325.26 485.06,-5319.36"/>
<text text-anchor="middle" x="655.5" y="-5359.61" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_13_2_up -->
<g id="node485" class="node">
<title>expert_13_2_up</title>
<polygon fill="lightgreen" stroke="black" points="764,-5316.81 602,-5316.81 602,-5248.81 764,-5248.81 764,-5316.81"/>
<text text-anchor="middle" x="683" y="-5301.61" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="683" y="-5286.61" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="683" y="-5271.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="683" y="-5256.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- selection_13&#45;&gt;expert_13_2_up -->
<g id="edge564" class="edge">
<title>selection_13&#45;&gt;expert_13_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M843.82,-5407.29C823.28,-5396.58 801.24,-5384.04 782,-5370.81 761.89,-5356.97 741.36,-5339.56 724.24,-5323.96"/>
<polygon fill="red" stroke="red" points="726.35,-5321.14 716.63,-5316.93 721.6,-5326.29 726.35,-5321.14"/>
<text text-anchor="middle" x="846.5" y="-5359.61" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_13_3_up -->
<g id="node488" class="node">
<title>expert_13_3_up</title>
<polygon fill="lightgreen" stroke="black" points="996,-5316.81 834,-5316.81 834,-5248.81 996,-5248.81 996,-5316.81"/>
<text text-anchor="middle" x="915" y="-5301.61" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="915" y="-5286.61" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="915" y="-5271.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="915" y="-5256.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- selection_13&#45;&gt;expert_13_3_up -->
<g id="edge568" class="edge">
<title>selection_13&#45;&gt;expert_13_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M915,-5388.53C915,-5368.66 915,-5346.25 915,-5327.28"/>
<polygon fill="red" stroke="red" points="918.5,-5327.14 915,-5317.14 911.5,-5327.14 918.5,-5327.14"/>
<text text-anchor="middle" x="979.5" y="-5359.61" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_13_4_up -->
<g id="node491" class="node">
<title>expert_13_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1230,-5316.81 1068,-5316.81 1068,-5248.81 1230,-5248.81 1230,-5316.81"/>
<text text-anchor="middle" x="1149" y="-5301.61" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1149" y="-5286.61" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1149" y="-5271.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1149" y="-5256.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- selection_13&#45;&gt;expert_13_4_up -->
<g id="edge572" class="edge">
<title>selection_13&#45;&gt;expert_13_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M985.76,-5407.35C1006.39,-5396.6 1028.59,-5384.02 1048,-5370.81 1068.4,-5356.91 1089.34,-5339.49 1106.82,-5323.9"/>
<polygon fill="red" stroke="red" points="1109.52,-5326.18 1114.6,-5316.88 1104.83,-5320.98 1109.52,-5326.18"/>
<text text-anchor="middle" x="1132.5" y="-5359.61" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_13_5_up -->
<g id="node494" class="node">
<title>expert_13_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1484,-5316.81 1322,-5316.81 1322,-5248.81 1484,-5248.81 1484,-5316.81"/>
<text text-anchor="middle" x="1403" y="-5301.61" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1403" y="-5286.61" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1403" y="-5271.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1403" y="-5256.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- selection_13&#45;&gt;expert_13_5_up -->
<g id="edge576" class="edge">
<title>selection_13&#45;&gt;expert_13_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1035.69,-5420.38C1111.33,-5405.33 1209.88,-5381.58 1293,-5347.81 1310.27,-5340.79 1328.11,-5331.44 1344.26,-5322.07"/>
<polygon fill="red" stroke="red" points="1346.22,-5324.98 1353.04,-5316.87 1342.65,-5318.95 1346.22,-5324.98"/>
<text text-anchor="middle" x="1327.5" y="-5359.61" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_13_6_up -->
<g id="node497" class="node">
<title>expert_13_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1738,-5316.81 1576,-5316.81 1576,-5248.81 1738,-5248.81 1738,-5316.81"/>
<text text-anchor="middle" x="1657" y="-5301.61" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1657" y="-5286.61" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1657" y="-5271.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1657" y="-5256.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- selection_13&#45;&gt;expert_13_6_up -->
<g id="edge580" class="edge">
<title>selection_13&#45;&gt;expert_13_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1085.58,-5433.48C1215.25,-5423.71 1396.39,-5400.92 1547,-5347.81 1565.11,-5341.42 1583.6,-5331.99 1600.13,-5322.33"/>
<polygon fill="red" stroke="red" points="1602.31,-5325.1 1609.09,-5316.95 1598.71,-5319.09 1602.31,-5325.1"/>
<text text-anchor="middle" x="1578.5" y="-5359.61" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_13_7_up -->
<g id="node500" class="node">
<title>expert_13_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1992,-5316.81 1830,-5316.81 1830,-5248.81 1992,-5248.81 1992,-5316.81"/>
<text text-anchor="middle" x="1911" y="-5301.61" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1911" y="-5286.61" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1911" y="-5271.61" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1911" y="-5256.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- selection_13&#45;&gt;expert_13_7_up -->
<g id="edge584" class="edge">
<title>selection_13&#45;&gt;expert_13_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1067.02,-5428.63C1215.24,-5416.2 1446.94,-5395.29 1647,-5370.81 1715.69,-5362.4 1735.7,-5370.73 1801,-5347.81 1819.21,-5341.41 1837.79,-5331.94 1854.38,-5322.22"/>
<polygon fill="red" stroke="red" points="1856.6,-5324.97 1863.37,-5316.82 1853,-5318.97 1856.6,-5324.97"/>
<text text-anchor="middle" x="1836.5" y="-5359.61" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_13_0_gelu -->
<g id="node480" class="node">
<title>expert_13_0_gelu</title>
<ellipse fill="none" stroke="black" cx="150" cy="-5174.33" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="150" y="-5185.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="150" y="-5170.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="150" y="-5155.63" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_0_up&#45;&gt;expert_13_0_gelu -->
<g id="edge557" class="edge">
<title>expert_13_0_up&#45;&gt;expert_13_0_gelu</title>
<path fill="none" stroke="black" d="M167.23,-5248.7C165.21,-5240.09 162.99,-5230.66 160.84,-5221.51"/>
<polygon fill="black" stroke="black" points="164.24,-5220.68 158.55,-5211.75 157.43,-5222.28 164.24,-5220.68"/>
</g>
<!-- expert_13_0_down -->
<g id="node481" class="node">
<title>expert_13_0_down</title>
<polygon fill="lightgreen" stroke="black" points="254.5,-5099.85 101.5,-5099.85 101.5,-5031.85 254.5,-5031.85 254.5,-5099.85"/>
<text text-anchor="middle" x="178" y="-5084.65" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="178" y="-5069.65" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="178" y="-5054.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="178" y="-5039.65" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_0_gelu&#45;&gt;expert_13_0_down -->
<g id="edge558" class="edge">
<title>expert_13_0_gelu&#45;&gt;expert_13_0_down</title>
<path fill="none" stroke="black" d="M159.64,-5136.69C161.91,-5128.03 164.36,-5118.73 166.7,-5109.82"/>
<polygon fill="black" stroke="black" points="170.13,-5110.55 169.29,-5099.99 163.36,-5108.77 170.13,-5110.55"/>
</g>
<!-- aggregate_13 -->
<g id="node503" class="node">
<title>aggregate_13</title>
<ellipse fill="lightyellow" stroke="black" cx="1047" cy="-4815.49" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="1047" cy="-4815.49" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="1047" y="-4826.79" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="1047" y="-4811.79" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1047" y="-4796.79" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_0_down&#45;&gt;aggregate_13 -->
<g id="edge559" class="edge">
<title>expert_13_0_down&#45;&gt;aggregate_13</title>
<path fill="none" stroke="black" d="M254.64,-5031.97C262.15,-5029.1 269.69,-5026.34 277,-5023.85 474.07,-4956.83 705.25,-4897 862.51,-4859.04"/>
<polygon fill="black" stroke="black" points="863.39,-4862.43 872.29,-4856.69 861.75,-4855.63 863.39,-4862.43"/>
</g>
<!-- expert_13_1_gelu -->
<g id="node483" class="node">
<title>expert_13_1_gelu</title>
<ellipse fill="none" stroke="black" cx="404" cy="-5174.33" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="404" y="-5185.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="404" y="-5170.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="404" y="-5155.63" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_1_up&#45;&gt;expert_13_1_gelu -->
<g id="edge561" class="edge">
<title>expert_13_1_up&#45;&gt;expert_13_1_gelu</title>
<path fill="none" stroke="black" d="M421.23,-5248.7C419.21,-5240.09 416.99,-5230.66 414.84,-5221.51"/>
<polygon fill="black" stroke="black" points="418.24,-5220.68 412.55,-5211.75 411.43,-5222.28 418.24,-5220.68"/>
</g>
<!-- expert_13_1_down -->
<g id="node484" class="node">
<title>expert_13_1_down</title>
<polygon fill="lightgreen" stroke="black" points="499.5,-5099.85 346.5,-5099.85 346.5,-5031.85 499.5,-5031.85 499.5,-5099.85"/>
<text text-anchor="middle" x="423" y="-5084.65" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="423" y="-5069.65" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="423" y="-5054.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="423" y="-5039.65" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_1_gelu&#45;&gt;expert_13_1_down -->
<g id="edge562" class="edge">
<title>expert_13_1_gelu&#45;&gt;expert_13_1_down</title>
<path fill="none" stroke="black" d="M410.54,-5136.69C412.07,-5128.12 413.71,-5118.93 415.28,-5110.11"/>
<polygon fill="black" stroke="black" points="418.78,-5110.45 417.09,-5099.99 411.88,-5109.22 418.78,-5110.45"/>
</g>
<!-- expert_13_1_down&#45;&gt;aggregate_13 -->
<g id="edge563" class="edge">
<title>expert_13_1_down&#45;&gt;aggregate_13</title>
<path fill="none" stroke="black" d="M499.51,-5034.4C591.42,-4997.82 748.49,-4935.3 870.89,-4886.59"/>
<polygon fill="black" stroke="black" points="872.38,-4889.76 880.38,-4882.81 869.8,-4883.25 872.38,-4889.76"/>
</g>
<!-- expert_13_2_gelu -->
<g id="node486" class="node">
<title>expert_13_2_gelu</title>
<ellipse fill="none" stroke="black" cx="658" cy="-5174.33" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="658" y="-5185.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="658" y="-5170.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="658" y="-5155.63" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_2_up&#45;&gt;expert_13_2_gelu -->
<g id="edge565" class="edge">
<title>expert_13_2_up&#45;&gt;expert_13_2_gelu</title>
<path fill="none" stroke="black" d="M675.23,-5248.7C673.21,-5240.09 670.99,-5230.66 668.84,-5221.51"/>
<polygon fill="black" stroke="black" points="672.24,-5220.68 666.55,-5211.75 665.43,-5222.28 672.24,-5220.68"/>
</g>
<!-- expert_13_2_down -->
<g id="node487" class="node">
<title>expert_13_2_down</title>
<polygon fill="lightgreen" stroke="black" points="762.5,-5099.85 609.5,-5099.85 609.5,-5031.85 762.5,-5031.85 762.5,-5099.85"/>
<text text-anchor="middle" x="686" y="-5084.65" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="686" y="-5069.65" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="686" y="-5054.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="686" y="-5039.65" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_2_gelu&#45;&gt;expert_13_2_down -->
<g id="edge566" class="edge">
<title>expert_13_2_gelu&#45;&gt;expert_13_2_down</title>
<path fill="none" stroke="black" d="M667.64,-5136.69C669.91,-5128.03 672.36,-5118.73 674.7,-5109.82"/>
<polygon fill="black" stroke="black" points="678.13,-5110.55 677.29,-5099.99 671.36,-5108.77 678.13,-5110.55"/>
</g>
<!-- expert_13_2_down&#45;&gt;aggregate_13 -->
<g id="edge567" class="edge">
<title>expert_13_2_down&#45;&gt;aggregate_13</title>
<path fill="none" stroke="black" d="M734.31,-5031.61C774.69,-5003.83 834.6,-4962.61 891.21,-4923.67"/>
<polygon fill="black" stroke="black" points="893.28,-4926.49 899.54,-4917.94 889.32,-4920.72 893.28,-4926.49"/>
</g>
<!-- expert_13_3_gelu -->
<g id="node489" class="node">
<title>expert_13_3_gelu</title>
<ellipse fill="none" stroke="black" cx="912" cy="-5174.33" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="912" y="-5185.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="912" y="-5170.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="912" y="-5155.63" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_3_up&#45;&gt;expert_13_3_gelu -->
<g id="edge569" class="edge">
<title>expert_13_3_up&#45;&gt;expert_13_3_gelu</title>
<path fill="none" stroke="black" d="M914.07,-5248.7C913.83,-5240.36 913.58,-5231.25 913.33,-5222.38"/>
<polygon fill="black" stroke="black" points="916.82,-5222.02 913.04,-5212.12 909.82,-5222.22 916.82,-5222.02"/>
</g>
<!-- expert_13_3_down -->
<g id="node490" class="node">
<title>expert_13_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1008.5,-5099.85 855.5,-5099.85 855.5,-5031.85 1008.5,-5031.85 1008.5,-5099.85"/>
<text text-anchor="middle" x="932" y="-5084.65" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="932" y="-5069.65" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="932" y="-5054.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="932" y="-5039.65" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_3_gelu&#45;&gt;expert_13_3_down -->
<g id="edge570" class="edge">
<title>expert_13_3_gelu&#45;&gt;expert_13_3_down</title>
<path fill="none" stroke="black" d="M918.88,-5136.69C920.51,-5128.03 922.26,-5118.73 923.93,-5109.82"/>
<polygon fill="black" stroke="black" points="927.37,-5110.47 925.78,-5099.99 920.49,-5109.17 927.37,-5110.47"/>
</g>
<!-- expert_13_3_down&#45;&gt;aggregate_13 -->
<g id="edge571" class="edge">
<title>expert_13_3_down&#45;&gt;aggregate_13</title>
<path fill="none" stroke="black" d="M947.39,-5031.61C953.12,-5019.23 960.09,-5004.19 967.65,-4987.86"/>
<polygon fill="black" stroke="black" points="970.88,-4989.21 971.91,-4978.67 964.53,-4986.27 970.88,-4989.21"/>
</g>
<!-- expert_13_4_gelu -->
<g id="node492" class="node">
<title>expert_13_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1166" cy="-5174.33" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1166" y="-5185.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1166" y="-5170.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1166" y="-5155.63" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_4_up&#45;&gt;expert_13_4_gelu -->
<g id="edge573" class="edge">
<title>expert_13_4_up&#45;&gt;expert_13_4_gelu</title>
<path fill="none" stroke="black" d="M1154.29,-5248.7C1155.63,-5240.27 1157.1,-5231.05 1158.53,-5222.09"/>
<polygon fill="black" stroke="black" points="1162,-5222.55 1160.13,-5212.12 1155.09,-5221.45 1162,-5222.55"/>
</g>
<!-- expert_13_4_down -->
<g id="node493" class="node">
<title>expert_13_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1223.5,-5099.85 1070.5,-5099.85 1070.5,-5031.85 1223.5,-5031.85 1223.5,-5099.85"/>
<text text-anchor="middle" x="1147" y="-5084.65" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1147" y="-5069.65" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1147" y="-5054.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1147" y="-5039.65" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_4_gelu&#45;&gt;expert_13_4_down -->
<g id="edge574" class="edge">
<title>expert_13_4_gelu&#45;&gt;expert_13_4_down</title>
<path fill="none" stroke="black" d="M1159.46,-5136.69C1157.93,-5128.12 1156.29,-5118.93 1154.72,-5110.11"/>
<polygon fill="black" stroke="black" points="1158.12,-5109.22 1152.91,-5099.99 1151.22,-5110.45 1158.12,-5109.22"/>
</g>
<!-- expert_13_4_down&#45;&gt;aggregate_13 -->
<g id="edge575" class="edge">
<title>expert_13_4_down&#45;&gt;aggregate_13</title>
<path fill="none" stroke="black" d="M1133.62,-5031.61C1129.01,-5020.18 1123.49,-5006.46 1117.49,-4991.56"/>
<polygon fill="black" stroke="black" points="1120.68,-4990.11 1113.7,-4982.14 1114.18,-4992.72 1120.68,-4990.11"/>
</g>
<!-- expert_13_5_gelu -->
<g id="node495" class="node">
<title>expert_13_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1420" cy="-5174.33" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1420" y="-5185.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1420" y="-5170.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1420" y="-5155.63" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_5_up&#45;&gt;expert_13_5_gelu -->
<g id="edge577" class="edge">
<title>expert_13_5_up&#45;&gt;expert_13_5_gelu</title>
<path fill="none" stroke="black" d="M1408.29,-5248.7C1409.63,-5240.27 1411.1,-5231.05 1412.53,-5222.09"/>
<polygon fill="black" stroke="black" points="1416,-5222.55 1414.13,-5212.12 1409.09,-5221.45 1416,-5222.55"/>
</g>
<!-- expert_13_5_down -->
<g id="node496" class="node">
<title>expert_13_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1477.5,-5099.85 1324.5,-5099.85 1324.5,-5031.85 1477.5,-5031.85 1477.5,-5099.85"/>
<text text-anchor="middle" x="1401" y="-5084.65" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1401" y="-5069.65" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1401" y="-5054.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1401" y="-5039.65" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_5_gelu&#45;&gt;expert_13_5_down -->
<g id="edge578" class="edge">
<title>expert_13_5_gelu&#45;&gt;expert_13_5_down</title>
<path fill="none" stroke="black" d="M1413.46,-5136.69C1411.93,-5128.12 1410.29,-5118.93 1408.72,-5110.11"/>
<polygon fill="black" stroke="black" points="1412.12,-5109.22 1406.91,-5099.99 1405.22,-5110.45 1412.12,-5109.22"/>
</g>
<!-- expert_13_5_down&#45;&gt;aggregate_13 -->
<g id="edge579" class="edge">
<title>expert_13_5_down&#45;&gt;aggregate_13</title>
<path fill="none" stroke="black" d="M1353.63,-5031.61C1314.56,-5004.21 1256.84,-4963.71 1201.99,-4925.23"/>
<polygon fill="black" stroke="black" points="1203.77,-4922.2 1193.57,-4919.32 1199.75,-4927.93 1203.77,-4922.2"/>
</g>
<!-- expert_13_6_gelu -->
<g id="node498" class="node">
<title>expert_13_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1674" cy="-5174.33" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1674" y="-5185.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1674" y="-5170.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1674" y="-5155.63" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_6_up&#45;&gt;expert_13_6_gelu -->
<g id="edge581" class="edge">
<title>expert_13_6_up&#45;&gt;expert_13_6_gelu</title>
<path fill="none" stroke="black" d="M1662.29,-5248.7C1663.63,-5240.27 1665.1,-5231.05 1666.53,-5222.09"/>
<polygon fill="black" stroke="black" points="1670,-5222.55 1668.13,-5212.12 1663.09,-5221.45 1670,-5222.55"/>
</g>
<!-- expert_13_6_down -->
<g id="node499" class="node">
<title>expert_13_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1731.5,-5099.85 1578.5,-5099.85 1578.5,-5031.85 1731.5,-5031.85 1731.5,-5099.85"/>
<text text-anchor="middle" x="1655" y="-5084.65" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1655" y="-5069.65" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1655" y="-5054.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1655" y="-5039.65" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_6_gelu&#45;&gt;expert_13_6_down -->
<g id="edge582" class="edge">
<title>expert_13_6_gelu&#45;&gt;expert_13_6_down</title>
<path fill="none" stroke="black" d="M1667.46,-5136.69C1665.93,-5128.12 1664.29,-5118.93 1662.72,-5110.11"/>
<polygon fill="black" stroke="black" points="1666.12,-5109.22 1660.91,-5099.99 1659.22,-5110.45 1666.12,-5109.22"/>
</g>
<!-- expert_13_6_down&#45;&gt;aggregate_13 -->
<g id="edge583" class="edge">
<title>expert_13_6_down&#45;&gt;aggregate_13</title>
<path fill="none" stroke="black" d="M1578.3,-5033.52C1489.41,-4997.21 1340.05,-4936.2 1222.3,-4888.1"/>
<polygon fill="black" stroke="black" points="1223.38,-4884.76 1212.8,-4884.22 1220.74,-4891.24 1223.38,-4884.76"/>
</g>
<!-- expert_13_7_gelu -->
<g id="node501" class="node">
<title>expert_13_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1928" cy="-5174.33" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1928" y="-5185.63" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1928" y="-5170.63" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1928" y="-5155.63" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_7_up&#45;&gt;expert_13_7_gelu -->
<g id="edge585" class="edge">
<title>expert_13_7_up&#45;&gt;expert_13_7_gelu</title>
<path fill="none" stroke="black" d="M1916.29,-5248.7C1917.63,-5240.27 1919.1,-5231.05 1920.53,-5222.09"/>
<polygon fill="black" stroke="black" points="1924,-5222.55 1922.13,-5212.12 1917.09,-5221.45 1924,-5222.55"/>
</g>
<!-- expert_13_7_down -->
<g id="node502" class="node">
<title>expert_13_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1985.5,-5099.85 1832.5,-5099.85 1832.5,-5031.85 1985.5,-5031.85 1985.5,-5099.85"/>
<text text-anchor="middle" x="1909" y="-5084.65" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1909" y="-5069.65" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1909" y="-5054.65" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1909" y="-5039.65" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_13_7_gelu&#45;&gt;expert_13_7_down -->
<g id="edge586" class="edge">
<title>expert_13_7_gelu&#45;&gt;expert_13_7_down</title>
<path fill="none" stroke="black" d="M1921.46,-5136.69C1919.93,-5128.12 1918.29,-5118.93 1916.72,-5110.11"/>
<polygon fill="black" stroke="black" points="1920.12,-5109.22 1914.91,-5099.99 1913.22,-5110.45 1920.12,-5109.22"/>
</g>
<!-- expert_13_7_down&#45;&gt;aggregate_13 -->
<g id="edge587" class="edge">
<title>expert_13_7_down&#45;&gt;aggregate_13</title>
<path fill="none" stroke="black" d="M1832.33,-5034.73C1821.85,-5030.91 1811.2,-5027.18 1801,-5023.85 1608.57,-4961.02 1384.52,-4901.04 1230.96,-4861.9"/>
<polygon fill="black" stroke="black" points="1231.5,-4858.42 1220.95,-4859.35 1229.78,-4865.21 1231.5,-4858.42"/>
</g>
<!-- residual_2_13 -->
<g id="node504" class="node">
<title>residual_2_13</title>
<ellipse fill="none" stroke="black" cx="1047" cy="-4561.65" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1047" y="-4572.95" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1047" y="-4557.95" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1047" y="-4542.95" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- aggregate_13&#45;&gt;residual_2_13 -->
<g id="edge588" class="edge">
<title>aggregate_13&#45;&gt;residual_2_13</title>
<path fill="none" stroke="black" d="M1047,-4635.83C1047,-4626.55 1047,-4617.73 1047,-4609.64"/>
<polygon fill="black" stroke="black" points="1050.5,-4609.45 1047,-4599.45 1043.5,-4609.45 1050.5,-4609.45"/>
</g>
<!-- input_14 -->
<g id="node505" class="node">
<title>input_14</title>
<ellipse fill="none" stroke="black" cx="1047" cy="-4378.7" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1047" y="-4390" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1047" y="-4375" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1047" y="-4360" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_13&#45;&gt;input_14 -->
<g id="edge686" class="edge">
<title>residual_2_13&#45;&gt;input_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1047,-4524.03C1047,-4495.95 1047,-4456.98 1047,-4426.61"/>
<polygon fill="blue" stroke="blue" points="1050.5,-4426.26 1047,-4416.26 1043.5,-4426.26 1050.5,-4426.26"/>
<text text-anchor="middle" x="1127.5" y="-4488.97" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1127.5" y="-4473.97" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1127.5" y="-4458.97" font-family="Times,serif" font-size="14.00">GPU 13 &#45;&gt; GPU 14</text>
</g>
<!-- qkv_proj_14 -->
<g id="node506" class="node">
<title>qkv_proj_14</title>
<polygon fill="lightcoral" stroke="black" points="1209,-4283.22 885,-4283.22 885,-4215.22 1209,-4215.22 1209,-4283.22"/>
<text text-anchor="middle" x="1047" y="-4268.02" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1047" y="-4253.02" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1047" y="-4238.02" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="1047" y="-4223.02" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- input_14&#45;&gt;qkv_proj_14 -->
<g id="edge589" class="edge">
<title>input_14&#45;&gt;qkv_proj_14</title>
<path fill="none" stroke="black" d="M1047,-4341.17C1047,-4326.34 1047,-4309.1 1047,-4293.64"/>
<polygon fill="black" stroke="black" points="1050.5,-4293.27 1047,-4283.27 1043.5,-4293.27 1050.5,-4293.27"/>
</g>
<!-- reshape_qkv_14 -->
<g id="node507" class="node">
<title>reshape_qkv_14</title>
<polygon fill="none" stroke="black" points="1401.64,-4178.22 837.49,-4178.22 692.36,-4072.22 1256.51,-4072.22 1401.64,-4178.22"/>
<text text-anchor="middle" x="1047" y="-4136.52" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="1047" y="-4121.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1047" y="-4106.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- qkv_proj_14&#45;&gt;reshape_qkv_14 -->
<g id="edge590" class="edge">
<title>qkv_proj_14&#45;&gt;reshape_qkv_14</title>
<path fill="none" stroke="black" d="M1047,-4215.21C1047,-4207 1047,-4197.94 1047,-4188.82"/>
<polygon fill="black" stroke="black" points="1050.5,-4188.56 1047,-4178.56 1043.5,-4188.56 1050.5,-4188.56"/>
</g>
<!-- attn_scores_14 -->
<g id="node508" class="node">
<title>attn_scores_14</title>
<polygon fill="none" stroke="black" points="1047,-4035.22 867,-3982.22 1047,-3929.22 1227,-3982.22 1047,-4035.22"/>
<text text-anchor="middle" x="1047" y="-3993.52" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1047" y="-3978.52" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1047" y="-3963.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- reshape_qkv_14&#45;&gt;attn_scores_14 -->
<g id="edge591" class="edge">
<title>reshape_qkv_14&#45;&gt;attn_scores_14</title>
<path fill="none" stroke="black" d="M1047,-4072.12C1047,-4063.55 1047,-4054.59 1047,-4045.79"/>
<polygon fill="black" stroke="black" points="1050.5,-4045.58 1047,-4035.58 1043.5,-4045.58 1050.5,-4045.58"/>
</g>
<!-- attn_weights_14 -->
<g id="node509" class="node">
<title>attn_weights_14</title>
<polygon fill="none" stroke="black" points="1047,-3892.22 867,-3839.22 1047,-3786.22 1227,-3839.22 1047,-3892.22"/>
<text text-anchor="middle" x="1047" y="-3850.52" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1047" y="-3835.52" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1047" y="-3820.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- attn_scores_14&#45;&gt;attn_weights_14 -->
<g id="edge592" class="edge">
<title>attn_scores_14&#45;&gt;attn_weights_14</title>
<path fill="none" stroke="black" d="M1047,-3929.12C1047,-3920.55 1047,-3911.59 1047,-3902.79"/>
<polygon fill="black" stroke="black" points="1050.5,-3902.58 1047,-3892.58 1043.5,-3902.58 1050.5,-3902.58"/>
</g>
<!-- attn_output_14 -->
<g id="node510" class="node">
<title>attn_output_14</title>
<polygon fill="none" stroke="black" points="1047,-3749.22 876,-3696.22 1047,-3643.22 1218,-3696.22 1047,-3749.22"/>
<text text-anchor="middle" x="1047" y="-3707.52" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="1047" y="-3692.52" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1047" y="-3677.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- attn_weights_14&#45;&gt;attn_output_14 -->
<g id="edge593" class="edge">
<title>attn_weights_14&#45;&gt;attn_output_14</title>
<path fill="none" stroke="black" d="M1047,-3786.12C1047,-3777.55 1047,-3768.59 1047,-3759.79"/>
<polygon fill="black" stroke="black" points="1050.5,-3759.58 1047,-3749.58 1043.5,-3759.58 1050.5,-3759.58"/>
</g>
<!-- out_proj_14 -->
<g id="node511" class="node">
<title>out_proj_14</title>
<polygon fill="lightcoral" stroke="black" points="1123.5,-3606.22 970.5,-3606.22 970.5,-3538.22 1123.5,-3538.22 1123.5,-3606.22"/>
<text text-anchor="middle" x="1047" y="-3591.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1047" y="-3576.02" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1047" y="-3561.02" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1047" y="-3546.02" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- attn_output_14&#45;&gt;out_proj_14 -->
<g id="edge594" class="edge">
<title>attn_output_14&#45;&gt;out_proj_14</title>
<path fill="none" stroke="black" d="M1047,-3643.13C1047,-3634.29 1047,-3625.19 1047,-3616.61"/>
<polygon fill="black" stroke="black" points="1050.5,-3616.44 1047,-3606.44 1043.5,-3616.44 1050.5,-3616.44"/>
</g>
<!-- residual_1_14 -->
<g id="node512" class="node">
<title>residual_1_14</title>
<ellipse fill="none" stroke="black" cx="1047" cy="-3463.74" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1047" y="-3475.04" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1047" y="-3460.04" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1047" y="-3445.04" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- out_proj_14&#45;&gt;residual_1_14 -->
<g id="edge595" class="edge">
<title>out_proj_14&#45;&gt;residual_1_14</title>
<path fill="none" stroke="black" d="M1047,-3538.11C1047,-3529.78 1047,-3520.67 1047,-3511.79"/>
<polygon fill="black" stroke="black" points="1050.5,-3511.54 1047,-3501.54 1043.5,-3511.54 1050.5,-3511.54"/>
</g>
<!-- gate_14 -->
<g id="node513" class="node">
<title>gate_14</title>
<polygon fill="lightpink" stroke="black" points="1282.3,-3324.99 1164.65,-3368.04 929.35,-3368.04 811.7,-3324.99 929.35,-3281.94 1164.65,-3281.94 1282.3,-3324.99"/>
<text text-anchor="middle" x="1047" y="-3336.29" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="1047" y="-3321.29" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="1047" y="-3306.29" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- residual_1_14&#45;&gt;gate_14 -->
<g id="edge596" class="edge">
<title>residual_1_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M1047,-3426.1C1047,-3411.43 1047,-3394.26 1047,-3378.32"/>
<polygon fill="black" stroke="black" points="1050.5,-3378.07 1047,-3368.07 1043.5,-3378.07 1050.5,-3378.07"/>
</g>
<!-- selection_14 -->
<g id="node514" class="node">
<title>selection_14</title>
<polygon fill="none" stroke="black" points="1047,-3244.72 845,-3191.72 1047,-3138.72 1249,-3191.72 1047,-3244.72"/>
<text text-anchor="middle" x="1047" y="-3203.02" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="1047" y="-3188.02" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="1047" y="-3173.02" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- gate_14&#45;&gt;selection_14 -->
<g id="edge597" class="edge">
<title>gate_14&#45;&gt;selection_14</title>
<path fill="none" stroke="black" d="M1047,-3281.73C1047,-3273.24 1047,-3264.14 1047,-3255.13"/>
<polygon fill="black" stroke="black" points="1050.5,-3255.02 1047,-3245.02 1043.5,-3255.02 1050.5,-3255.02"/>
</g>
<!-- expert_14_0_up -->
<g id="node515" class="node">
<title>expert_14_0_up</title>
<polygon fill="lightgreen" stroke="black" points="260,-3066.72 98,-3066.72 98,-2998.72 260,-2998.72 260,-3066.72"/>
<text text-anchor="middle" x="179" y="-3051.52" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="179" y="-3036.52" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="179" y="-3021.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="179" y="-3006.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- selection_14&#45;&gt;expert_14_0_up -->
<g id="edge598" class="edge">
<title>selection_14&#45;&gt;expert_14_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M888.56,-3180.28C697.6,-3166.18 388.91,-3138.06 281,-3097.72 264.06,-3091.38 246.92,-3082.02 231.65,-3072.4"/>
<polygon fill="red" stroke="red" points="233.18,-3069.23 222.89,-3066.73 229.38,-3075.1 233.18,-3069.23"/>
<text text-anchor="middle" x="420.5" y="-3109.52" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_14_1_up -->
<g id="node518" class="node">
<title>expert_14_1_up</title>
<polygon fill="lightgreen" stroke="black" points="514,-3066.72 352,-3066.72 352,-2998.72 514,-2998.72 514,-3066.72"/>
<text text-anchor="middle" x="433" y="-3051.52" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="433" y="-3036.52" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="433" y="-3021.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="433" y="-3006.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- selection_14&#45;&gt;expert_14_1_up -->
<g id="edge602" class="edge">
<title>selection_14&#45;&gt;expert_14_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M895.31,-3178.43C791.19,-3166.35 651.34,-3142.85 535,-3097.72 518.3,-3091.24 501.35,-3081.93 486.19,-3072.41"/>
<polygon fill="red" stroke="red" points="487.79,-3069.27 477.49,-3066.8 484,-3075.16 487.79,-3069.27"/>
<text text-anchor="middle" x="665.5" y="-3109.52" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_14_2_up -->
<g id="node521" class="node">
<title>expert_14_2_up</title>
<polygon fill="lightgreen" stroke="black" points="768,-3066.72 606,-3066.72 606,-2998.72 768,-2998.72 768,-3066.72"/>
<text text-anchor="middle" x="687" y="-3051.52" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="687" y="-3036.52" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="687" y="-3021.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="687" y="-3006.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- selection_14&#45;&gt;expert_14_2_up -->
<g id="edge606" class="edge">
<title>selection_14&#45;&gt;expert_14_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M953.36,-3163.12C903.34,-3146.87 841.45,-3124.29 789,-3097.72 774.17,-3090.21 758.72,-3081.19 744.46,-3072.32"/>
<polygon fill="red" stroke="red" points="746.07,-3069.21 735.75,-3066.84 742.34,-3075.13 746.07,-3069.21"/>
<text text-anchor="middle" x="900.5" y="-3109.52" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_14_3_up -->
<g id="node524" class="node">
<title>expert_14_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1022,-3066.72 860,-3066.72 860,-2998.72 1022,-2998.72 1022,-3066.72"/>
<text text-anchor="middle" x="941" y="-3051.52" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="941" y="-3036.52" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="941" y="-3021.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="941" y="-3006.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- selection_14&#45;&gt;expert_14_3_up -->
<g id="edge610" class="edge">
<title>selection_14&#45;&gt;expert_14_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1009.79,-3148.39C1002.58,-3139.49 995.31,-3129.98 989,-3120.72 979.35,-3106.55 969.96,-3090.27 962.08,-3075.66"/>
<polygon fill="red" stroke="red" points="965.16,-3074 957.38,-3066.81 958.98,-3077.28 965.16,-3074"/>
<text text-anchor="middle" x="1053.5" y="-3109.52" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_14_4_up -->
<g id="node527" class="node">
<title>expert_14_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1234,-3066.72 1072,-3066.72 1072,-2998.72 1234,-2998.72 1234,-3066.72"/>
<text text-anchor="middle" x="1153" y="-3051.52" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1153" y="-3036.52" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1153" y="-3021.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1153" y="-3006.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- selection_14&#45;&gt;expert_14_4_up -->
<g id="edge614" class="edge">
<title>selection_14&#45;&gt;expert_14_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1093.24,-3150.67C1102.21,-3141.45 1111,-3131.24 1118,-3120.72 1126.87,-3107.4 1134.09,-3091.48 1139.62,-3076.92"/>
<polygon fill="red" stroke="red" points="1143.06,-3077.7 1143.18,-3067.1 1136.48,-3075.31 1143.06,-3077.7"/>
<text text-anchor="middle" x="1189.5" y="-3109.52" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_14_5_up -->
<g id="node530" class="node">
<title>expert_14_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1488,-3066.72 1326,-3066.72 1326,-2998.72 1488,-2998.72 1488,-3066.72"/>
<text text-anchor="middle" x="1407" y="-3051.52" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1407" y="-3036.52" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1407" y="-3021.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1407" y="-3006.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- selection_14&#45;&gt;expert_14_5_up -->
<g id="edge618" class="edge">
<title>selection_14&#45;&gt;expert_14_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1142.35,-3163.72C1179.14,-3152.11 1221.16,-3137.37 1258,-3120.72 1288.53,-3106.92 1320.83,-3088.57 1347.52,-3072.28"/>
<polygon fill="red" stroke="red" points="1349.67,-3075.07 1356.35,-3066.85 1346,-3069.11 1349.67,-3075.07"/>
<text text-anchor="middle" x="1351.5" y="-3109.52" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_14_6_up -->
<g id="node533" class="node">
<title>expert_14_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1742,-3066.72 1580,-3066.72 1580,-2998.72 1742,-2998.72 1742,-3066.72"/>
<text text-anchor="middle" x="1661" y="-3051.52" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1661" y="-3036.52" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1661" y="-3021.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1661" y="-3006.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- selection_14&#45;&gt;expert_14_6_up -->
<g id="edge622" class="edge">
<title>selection_14&#45;&gt;expert_14_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1193.64,-3177.15C1296.15,-3164.44 1434.92,-3140.71 1551,-3097.72 1568.83,-3091.11 1587.11,-3081.72 1603.51,-3072.15"/>
<polygon fill="red" stroke="red" points="1605.62,-3074.97 1612.42,-3066.84 1602.03,-3068.96 1605.62,-3074.97"/>
<text text-anchor="middle" x="1589.5" y="-3109.52" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_14_7_up -->
<g id="node536" class="node">
<title>expert_14_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1996,-3066.72 1834,-3066.72 1834,-2998.72 1996,-2998.72 1996,-3066.72"/>
<text text-anchor="middle" x="1915" y="-3051.52" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1915" y="-3036.52" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1915" y="-3021.52" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1915" y="-3006.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- selection_14&#45;&gt;expert_14_7_up -->
<g id="edge626" class="edge">
<title>selection_14&#45;&gt;expert_14_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1203.16,-3179.6C1391.87,-3164.77 1697.47,-3135.89 1805,-3097.72 1823.1,-3091.3 1841.58,-3081.86 1858.11,-3072.19"/>
<polygon fill="red" stroke="red" points="1860.3,-3074.96 1867.07,-3066.82 1856.7,-3068.96 1860.3,-3074.96"/>
<text text-anchor="middle" x="1835.5" y="-3109.52" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_14_0_gelu -->
<g id="node516" class="node">
<title>expert_14_0_gelu</title>
<ellipse fill="none" stroke="black" cx="154" cy="-2924.24" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="154" y="-2935.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="154" y="-2920.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="154" y="-2905.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_0_up&#45;&gt;expert_14_0_gelu -->
<g id="edge599" class="edge">
<title>expert_14_0_up&#45;&gt;expert_14_0_gelu</title>
<path fill="none" stroke="black" d="M171.23,-2998.61C169.21,-2990 166.99,-2980.57 164.84,-2971.43"/>
<polygon fill="black" stroke="black" points="168.24,-2970.6 162.55,-2961.66 161.43,-2972.2 168.24,-2970.6"/>
</g>
<!-- expert_14_0_down -->
<g id="node517" class="node">
<title>expert_14_0_down</title>
<polygon fill="lightgreen" stroke="black" points="258.5,-2849.77 105.5,-2849.77 105.5,-2781.77 258.5,-2781.77 258.5,-2849.77"/>
<text text-anchor="middle" x="182" y="-2834.57" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="182" y="-2819.57" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="182" y="-2804.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="182" y="-2789.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_0_gelu&#45;&gt;expert_14_0_down -->
<g id="edge600" class="edge">
<title>expert_14_0_gelu&#45;&gt;expert_14_0_down</title>
<path fill="none" stroke="black" d="M163.64,-2886.6C165.91,-2877.94 168.36,-2868.64 170.7,-2859.73"/>
<polygon fill="black" stroke="black" points="174.13,-2860.47 173.29,-2849.91 167.36,-2858.69 174.13,-2860.47"/>
</g>
<!-- aggregate_14 -->
<g id="node539" class="node">
<title>aggregate_14</title>
<ellipse fill="lightyellow" stroke="black" cx="949" cy="-2565.4" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="949" cy="-2565.4" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="949" y="-2576.7" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="949" y="-2561.7" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="949" y="-2546.7" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_0_down&#45;&gt;aggregate_14 -->
<g id="edge601" class="edge">
<title>expert_14_0_down&#45;&gt;aggregate_14</title>
<path fill="none" stroke="black" d="M258.75,-2782.18C266.23,-2779.24 273.74,-2776.39 281,-2773.77 443.55,-2715.02 631.84,-2657.49 767,-2618"/>
<polygon fill="black" stroke="black" points="768.02,-2621.34 776.64,-2615.18 766.06,-2614.62 768.02,-2621.34"/>
</g>
<!-- expert_14_1_gelu -->
<g id="node519" class="node">
<title>expert_14_1_gelu</title>
<ellipse fill="none" stroke="black" cx="408" cy="-2924.24" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="408" y="-2935.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="408" y="-2920.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="408" y="-2905.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_1_up&#45;&gt;expert_14_1_gelu -->
<g id="edge603" class="edge">
<title>expert_14_1_up&#45;&gt;expert_14_1_gelu</title>
<path fill="none" stroke="black" d="M425.23,-2998.61C423.21,-2990 420.99,-2980.57 418.84,-2971.43"/>
<polygon fill="black" stroke="black" points="422.24,-2970.6 416.55,-2961.66 415.43,-2972.2 422.24,-2970.6"/>
</g>
<!-- expert_14_1_down -->
<g id="node520" class="node">
<title>expert_14_1_down</title>
<polygon fill="lightgreen" stroke="black" points="503.5,-2849.77 350.5,-2849.77 350.5,-2781.77 503.5,-2781.77 503.5,-2849.77"/>
<text text-anchor="middle" x="427" y="-2834.57" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="427" y="-2819.57" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="427" y="-2804.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="427" y="-2789.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_1_gelu&#45;&gt;expert_14_1_down -->
<g id="edge604" class="edge">
<title>expert_14_1_gelu&#45;&gt;expert_14_1_down</title>
<path fill="none" stroke="black" d="M414.54,-2886.6C416.07,-2878.04 417.71,-2868.84 419.28,-2860.02"/>
<polygon fill="black" stroke="black" points="422.78,-2860.36 421.09,-2849.91 415.88,-2859.14 422.78,-2860.36"/>
</g>
<!-- expert_14_1_down&#45;&gt;aggregate_14 -->
<g id="edge605" class="edge">
<title>expert_14_1_down&#45;&gt;aggregate_14</title>
<path fill="none" stroke="black" d="M496.59,-2781.66C568.11,-2747.62 682.24,-2693.32 777.97,-2647.78"/>
<polygon fill="black" stroke="black" points="779.65,-2650.85 787.18,-2643.4 776.64,-2644.53 779.65,-2650.85"/>
</g>
<!-- expert_14_2_gelu -->
<g id="node522" class="node">
<title>expert_14_2_gelu</title>
<ellipse fill="none" stroke="black" cx="662" cy="-2924.24" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="662" y="-2935.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="662" y="-2920.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="662" y="-2905.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_2_up&#45;&gt;expert_14_2_gelu -->
<g id="edge607" class="edge">
<title>expert_14_2_up&#45;&gt;expert_14_2_gelu</title>
<path fill="none" stroke="black" d="M679.23,-2998.61C677.21,-2990 674.99,-2980.57 672.84,-2971.43"/>
<polygon fill="black" stroke="black" points="676.24,-2970.6 670.55,-2961.66 669.43,-2972.2 676.24,-2970.6"/>
</g>
<!-- expert_14_2_down -->
<g id="node523" class="node">
<title>expert_14_2_down</title>
<polygon fill="lightgreen" stroke="black" points="766.5,-2849.77 613.5,-2849.77 613.5,-2781.77 766.5,-2781.77 766.5,-2849.77"/>
<text text-anchor="middle" x="690" y="-2834.57" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="690" y="-2819.57" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="690" y="-2804.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="690" y="-2789.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_2_gelu&#45;&gt;expert_14_2_down -->
<g id="edge608" class="edge">
<title>expert_14_2_gelu&#45;&gt;expert_14_2_down</title>
<path fill="none" stroke="black" d="M671.64,-2886.6C673.91,-2877.94 676.36,-2868.64 678.7,-2859.73"/>
<polygon fill="black" stroke="black" points="682.13,-2860.47 681.29,-2849.91 675.36,-2858.69 682.13,-2860.47"/>
</g>
<!-- expert_14_2_down&#45;&gt;aggregate_14 -->
<g id="edge609" class="edge">
<title>expert_14_2_down&#45;&gt;aggregate_14</title>
<path fill="none" stroke="black" d="M724.66,-2781.53C747.79,-2759.35 779.86,-2728.6 812.52,-2697.28"/>
<polygon fill="black" stroke="black" points="815.14,-2699.61 819.94,-2690.16 810.3,-2694.56 815.14,-2699.61"/>
</g>
<!-- expert_14_3_gelu -->
<g id="node525" class="node">
<title>expert_14_3_gelu</title>
<ellipse fill="none" stroke="black" cx="916" cy="-2924.24" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="916" y="-2935.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="916" y="-2920.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="916" y="-2905.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_3_up&#45;&gt;expert_14_3_gelu -->
<g id="edge611" class="edge">
<title>expert_14_3_up&#45;&gt;expert_14_3_gelu</title>
<path fill="none" stroke="black" d="M933.23,-2998.61C931.21,-2990 928.99,-2980.57 926.84,-2971.43"/>
<polygon fill="black" stroke="black" points="930.24,-2970.6 924.55,-2961.66 923.43,-2972.2 930.24,-2970.6"/>
</g>
<!-- expert_14_3_down -->
<g id="node526" class="node">
<title>expert_14_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1003.5,-2849.77 850.5,-2849.77 850.5,-2781.77 1003.5,-2781.77 1003.5,-2849.77"/>
<text text-anchor="middle" x="927" y="-2834.57" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="927" y="-2819.57" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="927" y="-2804.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="927" y="-2789.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_3_gelu&#45;&gt;expert_14_3_down -->
<g id="edge612" class="edge">
<title>expert_14_3_gelu&#45;&gt;expert_14_3_down</title>
<path fill="none" stroke="black" d="M919.79,-2886.6C920.67,-2878.04 921.62,-2868.84 922.53,-2860.02"/>
<polygon fill="black" stroke="black" points="926.03,-2860.21 923.58,-2849.91 919.07,-2859.49 926.03,-2860.21"/>
</g>
<!-- expert_14_3_down&#45;&gt;aggregate_14 -->
<g id="edge613" class="edge">
<title>expert_14_3_down&#45;&gt;aggregate_14</title>
<path fill="none" stroke="black" d="M929.94,-2781.53C930.66,-2773.5 931.47,-2764.34 932.34,-2754.45"/>
<polygon fill="black" stroke="black" points="935.84,-2754.59 933.24,-2744.32 928.87,-2753.97 935.84,-2754.59"/>
</g>
<!-- expert_14_4_gelu -->
<g id="node528" class="node">
<title>expert_14_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1170" cy="-2924.24" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1170" y="-2935.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1170" y="-2920.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1170" y="-2905.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_4_up&#45;&gt;expert_14_4_gelu -->
<g id="edge615" class="edge">
<title>expert_14_4_up&#45;&gt;expert_14_4_gelu</title>
<path fill="none" stroke="black" d="M1158.29,-2998.61C1159.63,-2990.18 1161.1,-2980.97 1162.53,-2972"/>
<polygon fill="black" stroke="black" points="1166,-2972.46 1164.13,-2962.04 1159.09,-2971.36 1166,-2972.46"/>
</g>
<!-- expert_14_4_down -->
<g id="node529" class="node">
<title>expert_14_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1227.5,-2849.77 1074.5,-2849.77 1074.5,-2781.77 1227.5,-2781.77 1227.5,-2849.77"/>
<text text-anchor="middle" x="1151" y="-2834.57" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1151" y="-2819.57" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1151" y="-2804.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1151" y="-2789.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_4_gelu&#45;&gt;expert_14_4_down -->
<g id="edge616" class="edge">
<title>expert_14_4_gelu&#45;&gt;expert_14_4_down</title>
<path fill="none" stroke="black" d="M1163.46,-2886.6C1161.93,-2878.04 1160.29,-2868.84 1158.72,-2860.02"/>
<polygon fill="black" stroke="black" points="1162.12,-2859.14 1156.91,-2849.91 1155.22,-2860.36 1162.12,-2859.14"/>
</g>
<!-- expert_14_4_down&#45;&gt;aggregate_14 -->
<g id="edge617" class="edge">
<title>expert_14_4_down&#45;&gt;aggregate_14</title>
<path fill="none" stroke="black" d="M1123.97,-2781.53C1108.96,-2763.08 1089.14,-2738.71 1068.24,-2713.01"/>
<polygon fill="black" stroke="black" points="1070.74,-2710.54 1061.72,-2704.99 1065.31,-2714.96 1070.74,-2710.54"/>
</g>
<!-- expert_14_5_gelu -->
<g id="node531" class="node">
<title>expert_14_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1424" cy="-2924.24" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1424" y="-2935.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1424" y="-2920.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1424" y="-2905.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_5_up&#45;&gt;expert_14_5_gelu -->
<g id="edge619" class="edge">
<title>expert_14_5_up&#45;&gt;expert_14_5_gelu</title>
<path fill="none" stroke="black" d="M1412.29,-2998.61C1413.63,-2990.18 1415.1,-2980.97 1416.53,-2972"/>
<polygon fill="black" stroke="black" points="1420,-2972.46 1418.13,-2962.04 1413.09,-2971.36 1420,-2972.46"/>
</g>
<!-- expert_14_5_down -->
<g id="node532" class="node">
<title>expert_14_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1481.5,-2849.77 1328.5,-2849.77 1328.5,-2781.77 1481.5,-2781.77 1481.5,-2849.77"/>
<text text-anchor="middle" x="1405" y="-2834.57" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1405" y="-2819.57" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1405" y="-2804.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1405" y="-2789.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_5_gelu&#45;&gt;expert_14_5_down -->
<g id="edge620" class="edge">
<title>expert_14_5_gelu&#45;&gt;expert_14_5_down</title>
<path fill="none" stroke="black" d="M1417.46,-2886.6C1415.93,-2878.04 1414.29,-2868.84 1412.72,-2860.02"/>
<polygon fill="black" stroke="black" points="1416.12,-2859.14 1410.91,-2849.91 1409.22,-2860.36 1416.12,-2859.14"/>
</g>
<!-- expert_14_5_down&#45;&gt;aggregate_14 -->
<g id="edge621" class="edge">
<title>expert_14_5_down&#45;&gt;aggregate_14</title>
<path fill="none" stroke="black" d="M1343.97,-2781.53C1285.67,-2749.77 1195.12,-2700.45 1115.42,-2657.05"/>
<polygon fill="black" stroke="black" points="1116.72,-2653.76 1106.26,-2652.05 1113.37,-2659.91 1116.72,-2653.76"/>
</g>
<!-- expert_14_6_gelu -->
<g id="node534" class="node">
<title>expert_14_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1678" cy="-2924.24" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1678" y="-2935.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1678" y="-2920.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1678" y="-2905.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_6_up&#45;&gt;expert_14_6_gelu -->
<g id="edge623" class="edge">
<title>expert_14_6_up&#45;&gt;expert_14_6_gelu</title>
<path fill="none" stroke="black" d="M1666.29,-2998.61C1667.63,-2990.18 1669.1,-2980.97 1670.53,-2972"/>
<polygon fill="black" stroke="black" points="1674,-2972.46 1672.13,-2962.04 1667.09,-2971.36 1674,-2972.46"/>
</g>
<!-- expert_14_6_down -->
<g id="node535" class="node">
<title>expert_14_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1735.5,-2849.77 1582.5,-2849.77 1582.5,-2781.77 1735.5,-2781.77 1735.5,-2849.77"/>
<text text-anchor="middle" x="1659" y="-2834.57" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1659" y="-2819.57" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1659" y="-2804.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1659" y="-2789.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_6_gelu&#45;&gt;expert_14_6_down -->
<g id="edge624" class="edge">
<title>expert_14_6_gelu&#45;&gt;expert_14_6_down</title>
<path fill="none" stroke="black" d="M1671.46,-2886.6C1669.93,-2878.04 1668.29,-2868.84 1666.72,-2860.02"/>
<polygon fill="black" stroke="black" points="1670.12,-2859.14 1664.91,-2849.91 1663.22,-2860.36 1670.12,-2859.14"/>
</g>
<!-- expert_14_6_down&#45;&gt;aggregate_14 -->
<g id="edge625" class="edge">
<title>expert_14_6_down&#45;&gt;aggregate_14</title>
<path fill="none" stroke="black" d="M1582.41,-2785.35C1571.88,-2781.41 1561.18,-2777.45 1551,-2773.77 1409.57,-2722.58 1248.42,-2667.22 1128.46,-2626.59"/>
<polygon fill="black" stroke="black" points="1129.4,-2623.21 1118.81,-2623.32 1127.16,-2629.85 1129.4,-2623.21"/>
</g>
<!-- expert_14_7_gelu -->
<g id="node537" class="node">
<title>expert_14_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1932" cy="-2924.24" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1932" y="-2935.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1932" y="-2920.54" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1932" y="-2905.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_7_up&#45;&gt;expert_14_7_gelu -->
<g id="edge627" class="edge">
<title>expert_14_7_up&#45;&gt;expert_14_7_gelu</title>
<path fill="none" stroke="black" d="M1920.29,-2998.61C1921.63,-2990.18 1923.1,-2980.97 1924.53,-2972"/>
<polygon fill="black" stroke="black" points="1928,-2972.46 1926.13,-2962.04 1921.09,-2971.36 1928,-2972.46"/>
</g>
<!-- expert_14_7_down -->
<g id="node538" class="node">
<title>expert_14_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1989.5,-2849.77 1836.5,-2849.77 1836.5,-2781.77 1989.5,-2781.77 1989.5,-2849.77"/>
<text text-anchor="middle" x="1913" y="-2834.57" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1913" y="-2819.57" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1913" y="-2804.57" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1913" y="-2789.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_14_7_gelu&#45;&gt;expert_14_7_down -->
<g id="edge628" class="edge">
<title>expert_14_7_gelu&#45;&gt;expert_14_7_down</title>
<path fill="none" stroke="black" d="M1925.46,-2886.6C1923.93,-2878.04 1922.29,-2868.84 1920.72,-2860.02"/>
<polygon fill="black" stroke="black" points="1924.12,-2859.14 1918.91,-2849.91 1917.22,-2860.36 1924.12,-2859.14"/>
</g>
<!-- expert_14_7_down&#45;&gt;aggregate_14 -->
<g id="edge629" class="edge">
<title>expert_14_7_down&#45;&gt;aggregate_14</title>
<path fill="none" stroke="black" d="M1836.42,-2784.35C1825.93,-2780.58 1815.25,-2776.94 1805,-2773.77 1577.24,-2703.25 1309.36,-2641.7 1134.74,-2604.36"/>
<polygon fill="black" stroke="black" points="1135.44,-2600.94 1124.93,-2602.27 1133.98,-2607.78 1135.44,-2600.94"/>
</g>
<!-- residual_2_14 -->
<g id="node540" class="node">
<title>residual_2_14</title>
<ellipse fill="none" stroke="black" cx="949" cy="-2311.56" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="949" y="-2322.86" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="949" y="-2307.86" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="949" y="-2292.86" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- aggregate_14&#45;&gt;residual_2_14 -->
<g id="edge630" class="edge">
<title>aggregate_14&#45;&gt;residual_2_14</title>
<path fill="none" stroke="black" d="M949,-2385.74C949,-2376.46 949,-2367.64 949,-2359.55"/>
<polygon fill="black" stroke="black" points="952.5,-2359.36 949,-2349.36 945.5,-2359.36 952.5,-2359.36"/>
</g>
<!-- input_15 -->
<g id="node541" class="node">
<title>input_15</title>
<ellipse fill="none" stroke="black" cx="949" cy="-2128.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="949" y="-2139.91" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="949" y="-2124.91" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="949" y="-2109.91" font-family="Times,serif" font-size="14.00">LayerNorm</text>
</g>
<!-- residual_2_14&#45;&gt;input_15 -->
<g id="edge687" class="edge">
<title>residual_2_14&#45;&gt;input_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M949,-2273.94C949,-2245.86 949,-2206.89 949,-2176.53"/>
<polygon fill="blue" stroke="blue" points="952.5,-2176.17 949,-2166.17 945.5,-2176.17 952.5,-2176.17"/>
<text text-anchor="middle" x="1029.5" y="-2238.89" font-family="Times,serif" font-size="14.00">Layer Output Transfer</text>
<text text-anchor="middle" x="1029.5" y="-2223.89" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1029.5" y="-2208.89" font-family="Times,serif" font-size="14.00">GPU 14 &#45;&gt; GPU 15</text>
</g>
<!-- qkv_proj_15 -->
<g id="node542" class="node">
<title>qkv_proj_15</title>
<polygon fill="lightcoral" stroke="black" points="1111,-2033.13 787,-2033.13 787,-1965.13 1111,-1965.13 1111,-2033.13"/>
<text text-anchor="middle" x="949" y="-2017.93" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="949" y="-2002.93" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="949" y="-1987.93" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 24576]</text>
<text text-anchor="middle" x="949" y="-1972.93" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- input_15&#45;&gt;qkv_proj_15 -->
<g id="edge631" class="edge">
<title>input_15&#45;&gt;qkv_proj_15</title>
<path fill="none" stroke="black" d="M949,-2091.08C949,-2076.26 949,-2059.01 949,-2043.55"/>
<polygon fill="black" stroke="black" points="952.5,-2043.18 949,-2033.18 945.5,-2043.18 952.5,-2043.18"/>
</g>
<!-- reshape_qkv_15 -->
<g id="node543" class="node">
<title>reshape_qkv_15</title>
<polygon fill="none" stroke="black" points="1303.64,-1928.13 739.49,-1928.13 594.36,-1822.13 1158.51,-1822.13 1303.64,-1928.13"/>
<text text-anchor="middle" x="949" y="-1886.43" font-family="Times,serif" font-size="14.00">Reshape &amp; Split</text>
<text text-anchor="middle" x="949" y="-1871.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 24576] &#45;&gt; [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="949" y="-1856.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- qkv_proj_15&#45;&gt;reshape_qkv_15 -->
<g id="edge632" class="edge">
<title>qkv_proj_15&#45;&gt;reshape_qkv_15</title>
<path fill="none" stroke="black" d="M949,-1965.12C949,-1956.92 949,-1947.85 949,-1938.74"/>
<polygon fill="black" stroke="black" points="952.5,-1938.47 949,-1928.47 945.5,-1938.47 952.5,-1938.47"/>
</g>
<!-- attn_scores_15 -->
<g id="node544" class="node">
<title>attn_scores_15</title>
<polygon fill="none" stroke="black" points="949,-1785.13 769,-1732.13 949,-1679.13 1129,-1732.13 949,-1785.13"/>
<text text-anchor="middle" x="949" y="-1743.43" font-family="Times,serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="949" y="-1728.43" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="949" y="-1713.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- reshape_qkv_15&#45;&gt;attn_scores_15 -->
<g id="edge633" class="edge">
<title>reshape_qkv_15&#45;&gt;attn_scores_15</title>
<path fill="none" stroke="black" d="M949,-1822.03C949,-1813.46 949,-1804.5 949,-1795.71"/>
<polygon fill="black" stroke="black" points="952.5,-1795.49 949,-1785.49 945.5,-1795.49 952.5,-1795.49"/>
</g>
<!-- attn_weights_15 -->
<g id="node545" class="node">
<title>attn_weights_15</title>
<polygon fill="none" stroke="black" points="949,-1642.13 769,-1589.13 949,-1536.13 1129,-1589.13 949,-1642.13"/>
<text text-anchor="middle" x="949" y="-1600.43" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="949" y="-1585.43" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="949" y="-1570.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- attn_scores_15&#45;&gt;attn_weights_15 -->
<g id="edge634" class="edge">
<title>attn_scores_15&#45;&gt;attn_weights_15</title>
<path fill="none" stroke="black" d="M949,-1679.03C949,-1670.46 949,-1661.5 949,-1652.71"/>
<polygon fill="black" stroke="black" points="952.5,-1652.49 949,-1642.49 945.5,-1652.49 952.5,-1652.49"/>
</g>
<!-- attn_output_15 -->
<g id="node546" class="node">
<title>attn_output_15</title>
<polygon fill="none" stroke="black" points="949,-1499.13 778,-1446.13 949,-1393.13 1120,-1446.13 949,-1499.13"/>
<text text-anchor="middle" x="949" y="-1457.43" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="949" y="-1442.43" font-family="Times,serif" font-size="14.00">[1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="949" y="-1427.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- attn_weights_15&#45;&gt;attn_output_15 -->
<g id="edge635" class="edge">
<title>attn_weights_15&#45;&gt;attn_output_15</title>
<path fill="none" stroke="black" d="M949,-1536.03C949,-1527.46 949,-1518.5 949,-1509.71"/>
<polygon fill="black" stroke="black" points="952.5,-1509.49 949,-1499.49 945.5,-1509.49 952.5,-1509.49"/>
</g>
<!-- out_proj_15 -->
<g id="node547" class="node">
<title>out_proj_15</title>
<polygon fill="lightcoral" stroke="black" points="1025.5,-1356.13 872.5,-1356.13 872.5,-1288.13 1025.5,-1288.13 1025.5,-1356.13"/>
<text text-anchor="middle" x="949" y="-1340.93" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="949" y="-1325.93" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="949" y="-1310.93" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="949" y="-1295.93" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- attn_output_15&#45;&gt;out_proj_15 -->
<g id="edge636" class="edge">
<title>attn_output_15&#45;&gt;out_proj_15</title>
<path fill="none" stroke="black" d="M949,-1393.04C949,-1384.2 949,-1375.11 949,-1366.52"/>
<polygon fill="black" stroke="black" points="952.5,-1366.35 949,-1356.35 945.5,-1366.35 952.5,-1366.35"/>
</g>
<!-- residual_1_15 -->
<g id="node548" class="node">
<title>residual_1_15</title>
<ellipse fill="none" stroke="black" cx="949" cy="-1213.66" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="949" y="-1224.96" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="949" y="-1209.96" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="949" y="-1194.96" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- out_proj_15&#45;&gt;residual_1_15 -->
<g id="edge637" class="edge">
<title>out_proj_15&#45;&gt;residual_1_15</title>
<path fill="none" stroke="black" d="M949,-1288.03C949,-1279.69 949,-1270.58 949,-1261.7"/>
<polygon fill="black" stroke="black" points="952.5,-1261.45 949,-1251.45 945.5,-1261.45 952.5,-1261.45"/>
</g>
<!-- gate_15 -->
<g id="node549" class="node">
<title>gate_15</title>
<polygon fill="lightpink" stroke="black" points="1184.3,-1074.91 1066.65,-1117.96 831.35,-1117.96 713.7,-1074.91 831.35,-1031.86 1066.65,-1031.86 1184.3,-1074.91"/>
<text text-anchor="middle" x="949" y="-1086.21" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="949" y="-1071.21" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192] &#45;&gt; [1024, 2048, 8]</text>
<text text-anchor="middle" x="949" y="-1056.21" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- residual_1_15&#45;&gt;gate_15 -->
<g id="edge638" class="edge">
<title>residual_1_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M949,-1176.01C949,-1161.34 949,-1144.17 949,-1128.24"/>
<polygon fill="black" stroke="black" points="952.5,-1127.98 949,-1117.98 945.5,-1127.98 952.5,-1127.98"/>
</g>
<!-- selection_15 -->
<g id="node550" class="node">
<title>selection_15</title>
<polygon fill="none" stroke="black" points="949,-994.63 747,-941.63 949,-888.63 1151,-941.63 949,-994.63"/>
<text text-anchor="middle" x="949" y="-952.93" font-family="Times,serif" font-size="14.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="949" y="-937.93" font-family="Times,serif" font-size="14.00">[1024, 2048, 8] &#45;&gt; indices</text>
<text text-anchor="middle" x="949" y="-922.93" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- gate_15&#45;&gt;selection_15 -->
<g id="edge639" class="edge">
<title>gate_15&#45;&gt;selection_15</title>
<path fill="none" stroke="black" d="M949,-1031.65C949,-1023.15 949,-1014.06 949,-1005.04"/>
<polygon fill="black" stroke="black" points="952.5,-1004.93 949,-994.93 945.5,-1004.93 952.5,-1004.93"/>
</g>
<!-- expert_15_0_up -->
<g id="node551" class="node">
<title>expert_15_0_up</title>
<polygon fill="lightgreen" stroke="black" points="253,-816.63 91,-816.63 91,-748.63 253,-748.63 253,-816.63"/>
<text text-anchor="middle" x="172" y="-801.43" font-family="Times,serif" font-size="14.00">Expert 0 Up</text>
<text text-anchor="middle" x="172" y="-786.43" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="172" y="-771.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="172" y="-756.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- selection_15&#45;&gt;expert_15_0_up -->
<g id="edge640" class="edge">
<title>selection_15&#45;&gt;expert_15_0_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M763.8,-937.18C625.03,-929.4 432.57,-907.4 274,-847.63 257.16,-841.28 240.11,-831.96 224.89,-822.39"/>
<polygon fill="red" stroke="red" points="226.46,-819.24 216.16,-816.75 222.66,-825.12 226.46,-819.24"/>
<text text-anchor="middle" x="390.5" y="-859.43" font-family="Times,serif" font-size="14.00">Expert 0 Selected</text>
</g>
<!-- expert_15_1_up -->
<g id="node554" class="node">
<title>expert_15_1_up</title>
<polygon fill="lightgreen" stroke="black" points="507,-816.63 345,-816.63 345,-748.63 507,-748.63 507,-816.63"/>
<text text-anchor="middle" x="426" y="-801.43" font-family="Times,serif" font-size="14.00">Expert 1 Up</text>
<text text-anchor="middle" x="426" y="-786.43" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="426" y="-771.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="426" y="-756.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- selection_15&#45;&gt;expert_15_1_up -->
<g id="edge644" class="edge">
<title>selection_15&#45;&gt;expert_15_1_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M816.53,-923.31C731.81,-909.36 620.81,-885.66 528,-847.63 511.59,-840.91 494.85,-831.61 479.8,-822.18"/>
<polygon fill="red" stroke="red" points="481.46,-819.09 471.16,-816.64 477.68,-824.98 481.46,-819.09"/>
<text text-anchor="middle" x="646.5" y="-859.43" font-family="Times,serif" font-size="14.00">Expert 1 Selected</text>
</g>
<!-- expert_15_2_up -->
<g id="node557" class="node">
<title>expert_15_2_up</title>
<polygon fill="lightgreen" stroke="black" points="761,-816.63 599,-816.63 599,-748.63 761,-748.63 761,-816.63"/>
<text text-anchor="middle" x="680" y="-801.43" font-family="Times,serif" font-size="14.00">Expert 2 Up</text>
<text text-anchor="middle" x="680" y="-786.43" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="680" y="-771.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="680" y="-756.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- selection_15&#45;&gt;expert_15_2_up -->
<g id="edge648" class="edge">
<title>selection_15&#45;&gt;expert_15_2_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M875.14,-907.82C851.96,-896.77 826.54,-883.86 804,-870.63 779.47,-856.23 753.52,-838.46 731.74,-822.75"/>
<polygon fill="red" stroke="red" points="733.76,-819.89 723.61,-816.84 729.64,-825.55 733.76,-819.89"/>
<text text-anchor="middle" x="868.5" y="-859.43" font-family="Times,serif" font-size="14.00">Expert 2 Selected</text>
</g>
<!-- expert_15_3_up -->
<g id="node560" class="node">
<title>expert_15_3_up</title>
<polygon fill="lightgreen" stroke="black" points="1009,-816.63 847,-816.63 847,-748.63 1009,-748.63 1009,-816.63"/>
<text text-anchor="middle" x="928" y="-801.43" font-family="Times,serif" font-size="14.00">Expert 3 Up</text>
<text text-anchor="middle" x="928" y="-786.43" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="928" y="-771.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="928" y="-756.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- selection_15&#45;&gt;expert_15_3_up -->
<g id="edge652" class="edge">
<title>selection_15&#45;&gt;expert_15_3_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M942.24,-890.09C939.52,-869.73 936.41,-846.48 933.79,-826.91"/>
<polygon fill="red" stroke="red" points="937.23,-826.2 932.43,-816.75 930.29,-827.13 937.23,-826.2"/>
<text text-anchor="middle" x="1003.5" y="-859.43" font-family="Times,serif" font-size="14.00">Expert 3 Selected</text>
</g>
<!-- expert_15_4_up -->
<g id="node563" class="node">
<title>expert_15_4_up</title>
<polygon fill="lightgreen" stroke="black" points="1227,-816.63 1065,-816.63 1065,-748.63 1227,-748.63 1227,-816.63"/>
<text text-anchor="middle" x="1146" y="-801.43" font-family="Times,serif" font-size="14.00">Expert 4 Up</text>
<text text-anchor="middle" x="1146" y="-786.43" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1146" y="-771.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1146" y="-756.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- selection_15&#45;&gt;expert_15_4_up -->
<g id="edge656" class="edge">
<title>selection_15&#45;&gt;expert_15_4_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1018.47,-906.67C1036.73,-896.29 1055.82,-884.03 1072,-870.63 1088.13,-857.28 1103.54,-840.14 1116.08,-824.61"/>
<polygon fill="red" stroke="red" points="1118.91,-826.68 1122.37,-816.66 1113.42,-822.33 1118.91,-826.68"/>
<text text-anchor="middle" x="1152.5" y="-859.43" font-family="Times,serif" font-size="14.00">Expert 4 Selected</text>
</g>
<!-- expert_15_5_up -->
<g id="node566" class="node">
<title>expert_15_5_up</title>
<polygon fill="lightgreen" stroke="black" points="1481,-816.63 1319,-816.63 1319,-748.63 1481,-748.63 1481,-816.63"/>
<text text-anchor="middle" x="1400" y="-801.43" font-family="Times,serif" font-size="14.00">Expert 5 Up</text>
<text text-anchor="middle" x="1400" y="-786.43" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1400" y="-771.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1400" y="-756.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- selection_15&#45;&gt;expert_15_5_up -->
<g id="edge660" class="edge">
<title>selection_15&#45;&gt;expert_15_5_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1064.24,-918.74C1131.84,-903.58 1217.86,-880.22 1290,-847.63 1306.56,-840.15 1323.84,-830.87 1339.66,-821.71"/>
<polygon fill="red" stroke="red" points="1341.43,-824.73 1348.29,-816.65 1337.89,-818.69 1341.43,-824.73"/>
<text text-anchor="middle" x="1327.5" y="-859.43" font-family="Times,serif" font-size="14.00">Expert 5 Selected</text>
</g>
<!-- expert_15_6_up -->
<g id="node569" class="node">
<title>expert_15_6_up</title>
<polygon fill="lightgreen" stroke="black" points="1735,-816.63 1573,-816.63 1573,-748.63 1735,-748.63 1735,-816.63"/>
<text text-anchor="middle" x="1654" y="-801.43" font-family="Times,serif" font-size="14.00">Expert 6 Up</text>
<text text-anchor="middle" x="1654" y="-786.43" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1654" y="-771.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1654" y="-756.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- selection_15&#45;&gt;expert_15_6_up -->
<g id="edge664" class="edge">
<title>selection_15&#45;&gt;expert_15_6_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1112.4,-931.47C1234.25,-920.75 1403.22,-897.59 1544,-847.63 1562.1,-841.21 1580.58,-831.77 1597.11,-822.11"/>
<polygon fill="red" stroke="red" points="1599.3,-824.88 1606.07,-816.73 1595.7,-818.87 1599.3,-824.88"/>
<text text-anchor="middle" x="1577.5" y="-859.43" font-family="Times,serif" font-size="14.00">Expert 6 Selected</text>
</g>
<!-- expert_15_7_up -->
<g id="node572" class="node">
<title>expert_15_7_up</title>
<polygon fill="lightgreen" stroke="black" points="1989,-816.63 1827,-816.63 1827,-748.63 1989,-748.63 1989,-816.63"/>
<text text-anchor="middle" x="1908" y="-801.43" font-family="Times,serif" font-size="14.00">Expert 7 Up</text>
<text text-anchor="middle" x="1908" y="-786.43" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="1908" y="-771.43" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1908" y="-756.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- selection_15&#45;&gt;expert_15_7_up -->
<g id="edge668" class="edge">
<title>selection_15&#45;&gt;expert_15_7_up</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1098.46,-927.8C1239.77,-915.16 1457.61,-894.33 1646,-870.63 1713.79,-862.1 1733.55,-870.32 1798,-847.63 1816.11,-841.25 1834.6,-831.83 1851.13,-822.17"/>
<polygon fill="red" stroke="red" points="1853.32,-824.93 1860.09,-816.79 1849.72,-818.93 1853.32,-824.93"/>
<text text-anchor="middle" x="1834.5" y="-859.43" font-family="Times,serif" font-size="14.00">Expert 7 Selected</text>
</g>
<!-- expert_15_0_gelu -->
<g id="node552" class="node">
<title>expert_15_0_gelu</title>
<ellipse fill="none" stroke="black" cx="147" cy="-674.15" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="147" y="-685.45" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="147" y="-670.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="147" y="-655.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_0_up&#45;&gt;expert_15_0_gelu -->
<g id="edge641" class="edge">
<title>expert_15_0_up&#45;&gt;expert_15_0_gelu</title>
<path fill="none" stroke="black" d="M164.23,-748.53C162.21,-739.92 159.99,-730.49 157.84,-721.34"/>
<polygon fill="black" stroke="black" points="161.24,-720.51 155.55,-711.57 154.43,-722.11 161.24,-720.51"/>
</g>
<!-- expert_15_0_down -->
<g id="node553" class="node">
<title>expert_15_0_down</title>
<polygon fill="lightgreen" stroke="black" points="242.5,-599.68 89.5,-599.68 89.5,-531.68 242.5,-531.68 242.5,-599.68"/>
<text text-anchor="middle" x="166" y="-584.48" font-family="Times,serif" font-size="14.00">Expert 0 Down</text>
<text text-anchor="middle" x="166" y="-569.48" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="166" y="-554.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="166" y="-539.48" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_0_gelu&#45;&gt;expert_15_0_down -->
<g id="edge642" class="edge">
<title>expert_15_0_gelu&#45;&gt;expert_15_0_down</title>
<path fill="none" stroke="black" d="M153.54,-636.51C155.07,-627.95 156.71,-618.75 158.28,-609.94"/>
<polygon fill="black" stroke="black" points="161.78,-610.28 160.09,-599.82 154.88,-609.05 161.78,-610.28"/>
</g>
<!-- aggregate_15 -->
<g id="node575" class="node">
<title>aggregate_15</title>
<ellipse fill="lightyellow" stroke="black" cx="1045" cy="-315.32" rx="175.23" ry="175.23"/>
<ellipse fill="none" stroke="black" cx="1045" cy="-315.32" rx="179.23" ry="179.23"/>
<text text-anchor="middle" x="1045" y="-326.62" font-family="Times,serif" font-size="14.00">Weighted Aggregation</text>
<text text-anchor="middle" x="1045" y="-311.62" font-family="Times,serif" font-size="14.00">8 Experts &#45;&gt; [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1045" y="-296.62" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_0_down&#45;&gt;aggregate_15 -->
<g id="edge643" class="edge">
<title>expert_15_0_down&#45;&gt;aggregate_15</title>
<path fill="none" stroke="black" d="M242.66,-534.5C253.13,-530.69 263.79,-526.98 274,-523.68 472.29,-459.55 703.61,-399.22 860.77,-360.35"/>
<polygon fill="black" stroke="black" points="861.67,-363.73 870.54,-357.94 859.99,-356.94 861.67,-363.73"/>
</g>
<!-- expert_15_1_gelu -->
<g id="node555" class="node">
<title>expert_15_1_gelu</title>
<ellipse fill="none" stroke="black" cx="401" cy="-674.15" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="401" y="-685.45" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="401" y="-670.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="401" y="-655.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_1_up&#45;&gt;expert_15_1_gelu -->
<g id="edge645" class="edge">
<title>expert_15_1_up&#45;&gt;expert_15_1_gelu</title>
<path fill="none" stroke="black" d="M418.23,-748.53C416.21,-739.92 413.99,-730.49 411.84,-721.34"/>
<polygon fill="black" stroke="black" points="415.24,-720.51 409.55,-711.57 408.43,-722.11 415.24,-720.51"/>
</g>
<!-- expert_15_1_down -->
<g id="node556" class="node">
<title>expert_15_1_down</title>
<polygon fill="lightgreen" stroke="black" points="496.5,-599.68 343.5,-599.68 343.5,-531.68 496.5,-531.68 496.5,-599.68"/>
<text text-anchor="middle" x="420" y="-584.48" font-family="Times,serif" font-size="14.00">Expert 1 Down</text>
<text text-anchor="middle" x="420" y="-569.48" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="420" y="-554.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="420" y="-539.48" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_1_gelu&#45;&gt;expert_15_1_down -->
<g id="edge646" class="edge">
<title>expert_15_1_gelu&#45;&gt;expert_15_1_down</title>
<path fill="none" stroke="black" d="M407.54,-636.51C409.07,-627.95 410.71,-618.75 412.28,-609.94"/>
<polygon fill="black" stroke="black" points="415.78,-610.28 414.09,-599.82 408.88,-609.05 415.78,-610.28"/>
</g>
<!-- expert_15_1_down&#45;&gt;aggregate_15 -->
<g id="edge647" class="edge">
<title>expert_15_1_down&#45;&gt;aggregate_15</title>
<path fill="none" stroke="black" d="M496.64,-534.22C588.77,-497.61 746.28,-435.02 868.92,-386.29"/>
<polygon fill="black" stroke="black" points="870.43,-389.45 878.44,-382.51 867.85,-382.95 870.43,-389.45"/>
</g>
<!-- expert_15_2_gelu -->
<g id="node558" class="node">
<title>expert_15_2_gelu</title>
<ellipse fill="none" stroke="black" cx="655" cy="-674.15" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="655" y="-685.45" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="655" y="-670.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="655" y="-655.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_2_up&#45;&gt;expert_15_2_gelu -->
<g id="edge649" class="edge">
<title>expert_15_2_up&#45;&gt;expert_15_2_gelu</title>
<path fill="none" stroke="black" d="M672.23,-748.53C670.21,-739.92 667.99,-730.49 665.84,-721.34"/>
<polygon fill="black" stroke="black" points="669.24,-720.51 663.55,-711.57 662.43,-722.11 669.24,-720.51"/>
</g>
<!-- expert_15_2_down -->
<g id="node559" class="node">
<title>expert_15_2_down</title>
<polygon fill="lightgreen" stroke="black" points="759.5,-599.68 606.5,-599.68 606.5,-531.68 759.5,-531.68 759.5,-599.68"/>
<text text-anchor="middle" x="683" y="-584.48" font-family="Times,serif" font-size="14.00">Expert 2 Down</text>
<text text-anchor="middle" x="683" y="-569.48" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="683" y="-554.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="683" y="-539.48" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_2_gelu&#45;&gt;expert_15_2_down -->
<g id="edge650" class="edge">
<title>expert_15_2_gelu&#45;&gt;expert_15_2_down</title>
<path fill="none" stroke="black" d="M664.64,-636.51C666.91,-627.86 669.36,-618.55 671.7,-609.65"/>
<polygon fill="black" stroke="black" points="675.13,-610.38 674.29,-599.82 668.36,-608.6 675.13,-610.38"/>
</g>
<!-- expert_15_2_down&#45;&gt;aggregate_15 -->
<g id="edge651" class="edge">
<title>expert_15_2_down&#45;&gt;aggregate_15</title>
<path fill="none" stroke="black" d="M731.45,-531.44C772.03,-503.6 832.29,-462.25 889.17,-423.23"/>
<polygon fill="black" stroke="black" points="891.27,-426.03 897.53,-417.49 887.31,-420.26 891.27,-426.03"/>
</g>
<!-- expert_15_3_gelu -->
<g id="node561" class="node">
<title>expert_15_3_gelu</title>
<ellipse fill="none" stroke="black" cx="909" cy="-674.15" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="909" y="-685.45" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="909" y="-670.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="909" y="-655.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_3_up&#45;&gt;expert_15_3_gelu -->
<g id="edge653" class="edge">
<title>expert_15_3_up&#45;&gt;expert_15_3_gelu</title>
<path fill="none" stroke="black" d="M922.09,-748.53C920.57,-740.01 918.91,-730.69 917.29,-721.63"/>
<polygon fill="black" stroke="black" points="920.7,-720.8 915.5,-711.57 913.81,-722.03 920.7,-720.8"/>
</g>
<!-- expert_15_3_down -->
<g id="node562" class="node">
<title>expert_15_3_down</title>
<polygon fill="lightgreen" stroke="black" points="1013.5,-599.68 860.5,-599.68 860.5,-531.68 1013.5,-531.68 1013.5,-599.68"/>
<text text-anchor="middle" x="937" y="-584.48" font-family="Times,serif" font-size="14.00">Expert 3 Down</text>
<text text-anchor="middle" x="937" y="-569.48" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="937" y="-554.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="937" y="-539.48" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_3_gelu&#45;&gt;expert_15_3_down -->
<g id="edge654" class="edge">
<title>expert_15_3_gelu&#45;&gt;expert_15_3_down</title>
<path fill="none" stroke="black" d="M918.64,-636.51C920.91,-627.86 923.36,-618.55 925.7,-609.65"/>
<polygon fill="black" stroke="black" points="929.13,-610.38 928.29,-599.82 922.36,-608.6 929.13,-610.38"/>
</g>
<!-- expert_15_3_down&#45;&gt;aggregate_15 -->
<g id="edge655" class="edge">
<title>expert_15_3_down&#45;&gt;aggregate_15</title>
<path fill="none" stroke="black" d="M951.45,-531.44C956.64,-519.51 962.91,-505.09 969.71,-489.45"/>
<polygon fill="black" stroke="black" points="973,-490.66 973.78,-480.1 966.58,-487.87 973,-490.66"/>
</g>
<!-- expert_15_4_gelu -->
<g id="node564" class="node">
<title>expert_15_4_gelu</title>
<ellipse fill="none" stroke="black" cx="1163" cy="-674.15" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1163" y="-685.45" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1163" y="-670.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1163" y="-655.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_4_up&#45;&gt;expert_15_4_gelu -->
<g id="edge657" class="edge">
<title>expert_15_4_up&#45;&gt;expert_15_4_gelu</title>
<path fill="none" stroke="black" d="M1151.29,-748.53C1152.63,-740.1 1154.1,-730.88 1155.53,-721.91"/>
<polygon fill="black" stroke="black" points="1159,-722.38 1157.13,-711.95 1152.09,-721.27 1159,-722.38"/>
</g>
<!-- expert_15_4_down -->
<g id="node565" class="node">
<title>expert_15_4_down</title>
<polygon fill="lightgreen" stroke="black" points="1220.5,-599.68 1067.5,-599.68 1067.5,-531.68 1220.5,-531.68 1220.5,-599.68"/>
<text text-anchor="middle" x="1144" y="-584.48" font-family="Times,serif" font-size="14.00">Expert 4 Down</text>
<text text-anchor="middle" x="1144" y="-569.48" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1144" y="-554.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1144" y="-539.48" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_4_gelu&#45;&gt;expert_15_4_down -->
<g id="edge658" class="edge">
<title>expert_15_4_gelu&#45;&gt;expert_15_4_down</title>
<path fill="none" stroke="black" d="M1156.46,-636.51C1154.93,-627.95 1153.29,-618.75 1151.72,-609.94"/>
<polygon fill="black" stroke="black" points="1155.12,-609.05 1149.91,-599.82 1148.22,-610.28 1155.12,-609.05"/>
</g>
<!-- expert_15_4_down&#45;&gt;aggregate_15 -->
<g id="edge659" class="edge">
<title>expert_15_4_down&#45;&gt;aggregate_15</title>
<path fill="none" stroke="black" d="M1130.75,-531.44C1126.21,-520.06 1120.78,-506.42 1114.87,-491.6"/>
<polygon fill="black" stroke="black" points="1118.09,-490.22 1111.14,-482.23 1111.59,-492.82 1118.09,-490.22"/>
</g>
<!-- expert_15_5_gelu -->
<g id="node567" class="node">
<title>expert_15_5_gelu</title>
<ellipse fill="none" stroke="black" cx="1417" cy="-674.15" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1417" y="-685.45" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1417" y="-670.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1417" y="-655.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_5_up&#45;&gt;expert_15_5_gelu -->
<g id="edge661" class="edge">
<title>expert_15_5_up&#45;&gt;expert_15_5_gelu</title>
<path fill="none" stroke="black" d="M1405.29,-748.53C1406.63,-740.1 1408.1,-730.88 1409.53,-721.91"/>
<polygon fill="black" stroke="black" points="1413,-722.38 1411.13,-711.95 1406.09,-721.27 1413,-722.38"/>
</g>
<!-- expert_15_5_down -->
<g id="node568" class="node">
<title>expert_15_5_down</title>
<polygon fill="lightgreen" stroke="black" points="1474.5,-599.68 1321.5,-599.68 1321.5,-531.68 1474.5,-531.68 1474.5,-599.68"/>
<text text-anchor="middle" x="1398" y="-584.48" font-family="Times,serif" font-size="14.00">Expert 5 Down</text>
<text text-anchor="middle" x="1398" y="-569.48" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1398" y="-554.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1398" y="-539.48" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_5_gelu&#45;&gt;expert_15_5_down -->
<g id="edge662" class="edge">
<title>expert_15_5_gelu&#45;&gt;expert_15_5_down</title>
<path fill="none" stroke="black" d="M1410.46,-636.51C1408.93,-627.95 1407.29,-618.75 1405.72,-609.94"/>
<polygon fill="black" stroke="black" points="1409.12,-609.05 1403.91,-599.82 1402.22,-610.28 1409.12,-609.05"/>
</g>
<!-- expert_15_5_down&#45;&gt;aggregate_15 -->
<g id="edge663" class="edge">
<title>expert_15_5_down&#45;&gt;aggregate_15</title>
<path fill="none" stroke="black" d="M1350.76,-531.44C1311.89,-504.1 1254.51,-463.73 1199.93,-425.32"/>
<polygon fill="black" stroke="black" points="1201.74,-422.32 1191.55,-419.42 1197.71,-428.04 1201.74,-422.32"/>
</g>
<!-- expert_15_6_gelu -->
<g id="node570" class="node">
<title>expert_15_6_gelu</title>
<ellipse fill="none" stroke="black" cx="1671" cy="-674.15" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1671" y="-685.45" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1671" y="-670.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1671" y="-655.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_6_up&#45;&gt;expert_15_6_gelu -->
<g id="edge665" class="edge">
<title>expert_15_6_up&#45;&gt;expert_15_6_gelu</title>
<path fill="none" stroke="black" d="M1659.29,-748.53C1660.63,-740.1 1662.1,-730.88 1663.53,-721.91"/>
<polygon fill="black" stroke="black" points="1667,-722.38 1665.13,-711.95 1660.09,-721.27 1667,-722.38"/>
</g>
<!-- expert_15_6_down -->
<g id="node571" class="node">
<title>expert_15_6_down</title>
<polygon fill="lightgreen" stroke="black" points="1728.5,-599.68 1575.5,-599.68 1575.5,-531.68 1728.5,-531.68 1728.5,-599.68"/>
<text text-anchor="middle" x="1652" y="-584.48" font-family="Times,serif" font-size="14.00">Expert 6 Down</text>
<text text-anchor="middle" x="1652" y="-569.48" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1652" y="-554.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1652" y="-539.48" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_6_gelu&#45;&gt;expert_15_6_down -->
<g id="edge666" class="edge">
<title>expert_15_6_gelu&#45;&gt;expert_15_6_down</title>
<path fill="none" stroke="black" d="M1664.46,-636.51C1662.93,-627.95 1661.29,-618.75 1659.72,-609.94"/>
<polygon fill="black" stroke="black" points="1663.12,-609.05 1657.91,-599.82 1656.22,-610.28 1663.12,-609.05"/>
</g>
<!-- expert_15_6_down&#45;&gt;aggregate_15 -->
<g id="edge667" class="edge">
<title>expert_15_6_down&#45;&gt;aggregate_15</title>
<path fill="none" stroke="black" d="M1575.43,-533.35C1486.76,-497.07 1337.83,-436.13 1220.32,-388.05"/>
<polygon fill="black" stroke="black" points="1221.42,-384.72 1210.84,-384.17 1218.77,-391.2 1221.42,-384.72"/>
</g>
<!-- expert_15_7_gelu -->
<g id="node573" class="node">
<title>expert_15_7_gelu</title>
<ellipse fill="none" stroke="black" cx="1925" cy="-674.15" rx="114.6" ry="37.45"/>
<text text-anchor="middle" x="1925" y="-685.45" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1925" y="-670.45" font-family="Times,serif" font-size="14.00">[1024, 2048, 32768]</text>
<text text-anchor="middle" x="1925" y="-655.45" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_7_up&#45;&gt;expert_15_7_gelu -->
<g id="edge669" class="edge">
<title>expert_15_7_up&#45;&gt;expert_15_7_gelu</title>
<path fill="none" stroke="black" d="M1913.29,-748.53C1914.63,-740.1 1916.1,-730.88 1917.53,-721.91"/>
<polygon fill="black" stroke="black" points="1921,-722.38 1919.13,-711.95 1914.09,-721.27 1921,-722.38"/>
</g>
<!-- expert_15_7_down -->
<g id="node574" class="node">
<title>expert_15_7_down</title>
<polygon fill="lightgreen" stroke="black" points="1982.5,-599.68 1829.5,-599.68 1829.5,-531.68 1982.5,-531.68 1982.5,-599.68"/>
<text text-anchor="middle" x="1906" y="-584.48" font-family="Times,serif" font-size="14.00">Expert 7 Down</text>
<text text-anchor="middle" x="1906" y="-569.48" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="1906" y="-554.48" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1906" y="-539.48" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_15_7_gelu&#45;&gt;expert_15_7_down -->
<g id="edge670" class="edge">
<title>expert_15_7_gelu&#45;&gt;expert_15_7_down</title>
<path fill="none" stroke="black" d="M1918.46,-636.51C1916.93,-627.95 1915.29,-618.75 1913.72,-609.94"/>
<polygon fill="black" stroke="black" points="1917.12,-609.05 1911.91,-599.82 1910.22,-610.28 1917.12,-609.05"/>
</g>
<!-- expert_15_7_down&#45;&gt;aggregate_15 -->
<g id="edge671" class="edge">
<title>expert_15_7_down&#45;&gt;aggregate_15</title>
<path fill="none" stroke="black" d="M1829.32,-534.56C1818.85,-530.74 1808.2,-527.01 1798,-523.68 1605.98,-460.94 1382.44,-401 1229.09,-361.84"/>
<polygon fill="black" stroke="black" points="1229.65,-358.37 1219.09,-359.3 1227.92,-365.16 1229.65,-358.37"/>
</g>
<!-- residual_2_15 -->
<g id="node576" class="node">
<title>residual_2_15</title>
<ellipse fill="none" stroke="black" cx="1045" cy="-61.48" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1045" y="-72.78" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1045" y="-57.78" font-family="Times,serif" font-size="14.00">[1024, 2048, 8192]</text>
<text text-anchor="middle" x="1045" y="-42.78" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- aggregate_15&#45;&gt;residual_2_15 -->
<g id="edge672" class="edge">
<title>aggregate_15&#45;&gt;residual_2_15</title>
<path fill="none" stroke="black" d="M1045,-135.66C1045,-126.37 1045,-117.56 1045,-109.47"/>
<polygon fill="black" stroke="black" points="1048.5,-109.27 1045,-99.27 1041.5,-109.27 1048.5,-109.27"/>
</g>
<!-- moe_legend -->
<g id="node577" class="node">
<title>moe_legend</title>
<polygon fill="lightyellow" stroke="black" points="2436.5,-35940.44 2085.5,-35940.44 2085.5,-35842.44 2442.5,-35842.44 2442.5,-35934.44 2436.5,-35940.44"/>
<polyline fill="none" stroke="black" points="2436.5,-35940.44 2436.5,-35934.44 "/>
<polyline fill="none" stroke="black" points="2442.5,-35934.44 2436.5,-35934.44 "/>
<text text-anchor="middle" x="2264" y="-35925.24" font-family="Times,serif" font-size="14.00">MoE Components:</text>
<text text-anchor="middle" x="2264" y="-35910.24" font-family="Times,serif" font-size="14.00">&#45; Gate Network: Routes tokens to experts</text>
<text text-anchor="middle" x="2264" y="-35895.24" font-family="Times,serif" font-size="14.00">&#45; Expert Selection: Top&#45;k routing (k=2)</text>
<text text-anchor="middle" x="2264" y="-35880.24" font-family="Times,serif" font-size="14.00">&#45; Expert FFN: Individual feed&#45;forward networks</text>
<text text-anchor="middle" x="2264" y="-35865.24" font-family="Times,serif" font-size="14.00">&#45; Aggregation: Weighted sum of expert outputs</text>
<text text-anchor="middle" x="2264" y="-35850.24" font-family="Times,serif" font-size="14.00">&#45; Dashed lines: Dynamic routing decisions</text>
</g>
</g>
</svg>
