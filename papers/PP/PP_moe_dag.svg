<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Model_DAG Pages: 1 -->
<svg width="943pt" height="1800pt"
 viewBox="0.00 0.00 942.70 1800.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.05 0.05) rotate(0) translate(4 35352.15)">
<title>MoE_Model_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-35352.15 18512.77,-35352.15 18512.77,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="18128.77" cy="-35310.68" rx="218.49" ry="37.45"/>
<text text-anchor="middle" x="18128.77" y="-35321.98" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="18128.77" y="-35306.98" font-family="Times,serif" font-size="14.00">[Batch=1024, Seq=2048, Hidden=8192]</text>
<text text-anchor="middle" x="18128.77" y="-35291.98" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="lightblue" stroke="black" points="18132.77,-35236.2 17988.77,-35236.2 17988.77,-35183.2 18132.77,-35183.2 18132.77,-35236.2"/>
<text text-anchor="middle" x="18060.77" y="-35221" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="18060.77" y="-35206" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="18060.77" y="-35191" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M18103.83,-35273.38C18097.46,-35264.1 18090.62,-35254.15 18084.32,-35244.97"/>
<polygon fill="black" stroke="black" points="18087.01,-35242.72 18078.47,-35236.46 18081.24,-35246.68 18087.01,-35242.72"/>
</g>
<!-- residual1_1 -->
<g id="node6" class="node">
<title>residual1_1</title>
<polygon fill="lightblue" stroke="black" points="18136.77,-34638.15 17843.77,-34585.15 18136.77,-34532.15 18429.77,-34585.15 18136.77,-34638.15"/>
<text text-anchor="middle" x="18136.77" y="-34596.45" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="18136.77" y="-34581.45" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="18136.77" y="-34566.45" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18183.71,-35274.29C18202.45,-35257.72 18218.77,-35236.01 18218.77,-35210.7 18218.77,-35210.7 18218.77,-35210.7 18218.77,-34742.15 18218.77,-34705.12 18200.43,-34668.23 18181.1,-34639.62"/>
<polygon fill="black" stroke="black" points="18183.96,-34637.6 18175.37,-34631.4 18178.22,-34641.61 18183.96,-34637.6"/>
<text text-anchor="middle" x="18247.77" y="-34981" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_1 -->
<g id="node3" class="node">
<title>qkv_proj_1</title>
<polygon fill="lightblue" stroke="black" points="18190.31,-35146.2 17707.45,-35146.2 17583.23,-35010.2 18066.09,-35010.2 18190.31,-35146.2"/>
<text text-anchor="middle" x="17886.77" y="-35097" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17886.77" y="-35082" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="17886.77" y="-35067" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="17886.77" y="-35052" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_1&#45;&gt;qkv_proj_1 -->
<g id="edge2" class="edge">
<title>ln1_1&#45;&gt;qkv_proj_1</title>
<path fill="none" stroke="black" d="M18026.39,-35183.11C18014.27,-35174.1 17999.98,-35163.45 17985.23,-35152.48"/>
<polygon fill="black" stroke="black" points="17987.12,-35149.52 17977,-35146.36 17982.94,-35155.13 17987.12,-35149.52"/>
</g>
<!-- mha_1 -->
<g id="node4" class="node">
<title>mha_1</title>
<polygon fill="lightblue" stroke="black" points="18129.24,-34903.68 18009.5,-34959.22 17770.04,-34959.22 17650.3,-34903.68 17770.04,-34848.13 18009.5,-34848.13 18129.24,-34903.68"/>
<text text-anchor="middle" x="17889.77" y="-34922.48" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17889.77" y="-34907.48" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="17889.77" y="-34892.48" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="17889.77" y="-34877.48" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- qkv_proj_1&#45;&gt;mha_1 -->
<g id="edge3" class="edge">
<title>qkv_proj_1&#45;&gt;mha_1</title>
<path fill="none" stroke="black" d="M17887.94,-35010C17888.17,-34996.79 17888.41,-34982.95 17888.64,-34969.8"/>
<polygon fill="black" stroke="black" points="17892.14,-34969.5 17888.82,-34959.44 17885.14,-34969.37 17892.14,-34969.5"/>
</g>
<!-- out_proj_1 -->
<g id="node5" class="node">
<title>out_proj_1</title>
<polygon fill="lightblue" stroke="black" points="18190.14,-34811.15 17721.86,-34811.15 17601.39,-34675.15 18069.68,-34675.15 18190.14,-34811.15"/>
<text text-anchor="middle" x="17895.77" y="-34761.95" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17895.77" y="-34746.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="17895.77" y="-34731.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="17895.77" y="-34716.95" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_1&#45;&gt;out_proj_1 -->
<g id="edge4" class="edge">
<title>mha_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M17891.83,-34848.12C17892.16,-34839.53 17892.5,-34830.51 17892.84,-34821.53"/>
<polygon fill="black" stroke="black" points="17896.34,-34821.54 17893.22,-34811.42 17889.35,-34821.28 17896.34,-34821.54"/>
</g>
<!-- out_proj_1&#45;&gt;residual1_1 -->
<g id="edge5" class="edge">
<title>out_proj_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M17999.37,-34675.09C18021.69,-34660.65 18044.79,-34645.69 18065.54,-34632.26"/>
<polygon fill="black" stroke="black" points="18067.48,-34635.18 18073.97,-34626.8 18063.67,-34629.3 18067.48,-34635.18"/>
</g>
<!-- ln2_1 -->
<g id="node7" class="node">
<title>ln2_1</title>
<polygon fill="lightblue" stroke="black" points="17895.77,-34495.15 17751.77,-34495.15 17751.77,-34442.15 17895.77,-34442.15 17895.77,-34495.15"/>
<text text-anchor="middle" x="17823.77" y="-34479.95" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="17823.77" y="-34464.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="17823.77" y="-34449.95" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge7" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M18041.58,-34549.33C17997.37,-34533.16 17945.39,-34514.15 17903.3,-34498.75"/>
<polygon fill="black" stroke="black" points="17904.25,-34495.37 17893.66,-34495.22 17901.85,-34501.94 17904.25,-34495.37"/>
</g>
<!-- residual2_1 -->
<g id="node34" class="node">
<title>residual2_1</title>
<polygon fill="lightblue" stroke="black" points="17345.77,-33299.87 17052.77,-33246.87 17345.77,-33193.87 17638.77,-33246.87 17345.77,-33299.87"/>
<text text-anchor="middle" x="17345.77" y="-33258.17" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="17345.77" y="-33243.17" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="17345.77" y="-33228.17" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge42" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M18279.99,-34558.06C18362.8,-34538.74 18450.77,-34508.97 18450.77,-34469.65 18450.77,-34469.65 18450.77,-34469.65 18450.77,-33555.53 18450.77,-33372.69 17882.21,-33293.86 17560.76,-33263.89"/>
<polygon fill="black" stroke="black" points="17560.65,-33260.37 17550.38,-33262.93 17560.01,-33267.34 17560.65,-33260.37"/>
<text text-anchor="middle" x="18479.77" y="-34082.95" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_1 -->
<g id="node8" class="node">
<title>gate_1</title>
<polygon fill="lightblue" stroke="black" points="16390.86,-34405.15 16090.68,-34405.15 15983.77,-34299.15 16497.77,-34299.15 16390.86,-34405.15"/>
<text text-anchor="middle" x="16240.77" y="-34363.45" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="16240.77" y="-34348.45" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="16240.77" y="-34333.45" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- ln2_1&#45;&gt;gate_1 -->
<g id="edge8" class="edge">
<title>ln2_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M17751.64,-34462.44C17520.84,-34445.74 16794.86,-34393.23 16439.99,-34367.57"/>
<polygon fill="black" stroke="black" points="16440.09,-34364.06 16429.86,-34366.83 16439.59,-34371.04 16440.09,-34364.06"/>
</g>
<!-- expert0_fc1_1 -->
<g id="node9" class="node">
<title>expert0_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="14040.31,-34248.15 13557.45,-34248.15 13433.23,-34112.15 13916.09,-34112.15 14040.31,-34248.15"/>
<text text-anchor="middle" x="13736.77" y="-34198.95" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="13736.77" y="-34183.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="13736.77" y="-34168.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13736.77" y="-34153.95" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_1&#45;&gt;expert0_fc1_1 -->
<g id="edge9" class="edge">
<title>gate_1&#45;&gt;expert0_fc1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16030.31,-34345.67C15558.6,-34332.65 14428.47,-34297.28 14049.77,-34248.15 14049.66,-34248.14 14049.55,-34248.13 14049.45,-34248.11"/>
<polygon fill="black" stroke="black" points="14049.76,-34244.62 14039.38,-34246.76 14048.83,-34251.56 14049.76,-34244.62"/>
<text text-anchor="middle" x="14458.27" y="-34269.95" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_1 -->
<g id="node12" class="node">
<title>expert1_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="14666.31,-34248.15 14183.45,-34248.15 14059.23,-34112.15 14542.09,-34112.15 14666.31,-34248.15"/>
<text text-anchor="middle" x="14362.77" y="-34198.95" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="14362.77" y="-34183.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14362.77" y="-34168.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="14362.77" y="-34153.95" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_1&#45;&gt;expert1_fc1_1 -->
<g id="edge13" class="edge">
<title>gate_1&#45;&gt;expert1_fc1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16031.89,-34347.03C15730.91,-34338.92 15158.34,-34315.32 14675.77,-34248.15 14675.55,-34248.12 14675.32,-34248.09 14675.1,-34248.06"/>
<polygon fill="black" stroke="black" points="14675.37,-34244.57 14664.98,-34246.61 14674.38,-34251.49 14675.37,-34244.57"/>
<text text-anchor="middle" x="14976.27" y="-34269.95" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_1 -->
<g id="node15" class="node">
<title>expert2_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="15292.31,-34248.15 14809.45,-34248.15 14685.23,-34112.15 15168.09,-34112.15 15292.31,-34248.15"/>
<text text-anchor="middle" x="14988.77" y="-34198.95" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="14988.77" y="-34183.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14988.77" y="-34168.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="14988.77" y="-34153.95" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_1&#45;&gt;expert2_fc1_1 -->
<g id="edge17" class="edge">
<title>gate_1&#45;&gt;expert2_fc1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16017.93,-34333.14C15827.13,-34316.18 15545.43,-34287.49 15301.77,-34248.15 15301.55,-34248.12 15301.32,-34248.08 15301.1,-34248.05"/>
<polygon fill="black" stroke="black" points="15301.45,-34244.56 15291.01,-34246.39 15300.31,-34251.46 15301.45,-34244.56"/>
<text text-anchor="middle" x="15552.27" y="-34269.95" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_1 -->
<g id="node18" class="node">
<title>expert3_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="15918.31,-34248.15 15435.45,-34248.15 15311.23,-34112.15 15794.09,-34112.15 15918.31,-34248.15"/>
<text text-anchor="middle" x="15614.77" y="-34198.95" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="15614.77" y="-34183.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="15614.77" y="-34168.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="15614.77" y="-34153.95" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_1&#45;&gt;expert3_fc1_1 -->
<g id="edge21" class="edge">
<title>gate_1&#45;&gt;expert3_fc1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16049.12,-34299.11C15993.1,-34283.9 15930.95,-34267.02 15871.59,-34250.9"/>
<polygon fill="black" stroke="black" points="15872.27,-34247.46 15861.7,-34248.21 15870.43,-34254.21 15872.27,-34247.46"/>
<text text-anchor="middle" x="16011.27" y="-34269.95" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_1 -->
<g id="node21" class="node">
<title>expert4_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="16544.31,-34248.15 16061.45,-34248.15 15937.23,-34112.15 16420.09,-34112.15 16544.31,-34248.15"/>
<text text-anchor="middle" x="16240.77" y="-34198.95" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="16240.77" y="-34183.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="16240.77" y="-34168.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="16240.77" y="-34153.95" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_1&#45;&gt;expert4_fc1_1 -->
<g id="edge25" class="edge">
<title>gate_1&#45;&gt;expert4_fc1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16240.77,-34298.76C16240.77,-34286.09 16240.77,-34272.28 16240.77,-34258.72"/>
<polygon fill="black" stroke="black" points="16244.27,-34258.43 16240.77,-34248.43 16237.27,-34258.43 16244.27,-34258.43"/>
<text text-anchor="middle" x="16286.27" y="-34269.95" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_1 -->
<g id="node24" class="node">
<title>expert5_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="17170.31,-34248.15 16687.45,-34248.15 16563.23,-34112.15 17046.09,-34112.15 17170.31,-34248.15"/>
<text text-anchor="middle" x="16866.77" y="-34198.95" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="16866.77" y="-34183.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="16866.77" y="-34168.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="16866.77" y="-34153.95" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_1&#45;&gt;expert5_fc1_1 -->
<g id="edge29" class="edge">
<title>gate_1&#45;&gt;expert5_fc1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16432.42,-34299.11C16505.78,-34279.19 16589.67,-34256.4 16664.04,-34236.21"/>
<polygon fill="black" stroke="black" points="16665.27,-34239.5 16674,-34233.5 16663.43,-34232.75 16665.27,-34239.5"/>
<text text-anchor="middle" x="16599.27" y="-34269.95" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_1 -->
<g id="node27" class="node">
<title>expert6_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="17796.31,-34248.15 17313.45,-34248.15 17189.23,-34112.15 17672.09,-34112.15 17796.31,-34248.15"/>
<text text-anchor="middle" x="17492.77" y="-34198.95" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="17492.77" y="-34183.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="17492.77" y="-34168.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="17492.77" y="-34153.95" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_1&#45;&gt;expert6_fc1_1 -->
<g id="edge33" class="edge">
<title>gate_1&#45;&gt;expert6_fc1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16463.6,-34333.14C16654.4,-34316.18 16936.11,-34287.49 17179.77,-34248.15 17213.47,-34242.71 17249.03,-34236.03 17283.6,-34229"/>
<polygon fill="black" stroke="black" points="17284.71,-34232.35 17293.81,-34226.91 17283.31,-34225.49 17284.71,-34232.35"/>
<text text-anchor="middle" x="17098.27" y="-34269.95" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_1 -->
<g id="node30" class="node">
<title>expert7_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="18422.31,-34248.15 17939.45,-34248.15 17815.23,-34112.15 18298.09,-34112.15 18422.31,-34248.15"/>
<text text-anchor="middle" x="18118.77" y="-34198.95" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="18118.77" y="-34183.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="18118.77" y="-34168.95" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="18118.77" y="-34153.95" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_1&#45;&gt;expert7_fc1_1 -->
<g id="edge37" class="edge">
<title>gate_1&#45;&gt;expert7_fc1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16449.65,-34347.03C16750.63,-34338.92 17323.19,-34315.32 17805.77,-34248.15 17839.98,-34243.39 17876.03,-34236.99 17911.01,-34230.03"/>
<polygon fill="black" stroke="black" points="17911.73,-34233.46 17920.84,-34228.06 17910.35,-34226.6 17911.73,-34233.46"/>
<text text-anchor="middle" x="17683.27" y="-34269.95" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_1 -->
<g id="node10" class="node">
<title>expert0_gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="13736.77" cy="-34023.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="13736.77" y="-34034.98" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="13736.77" y="-34019.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="13736.77" y="-34004.98" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert0_fc1_1&#45;&gt;expert0_gelu_1 -->
<g id="edge10" class="edge">
<title>expert0_fc1_1&#45;&gt;expert0_gelu_1</title>
<path fill="none" stroke="black" d="M13736.77,-34111.85C13736.77,-34098.26 13736.77,-34084.24 13736.77,-34071.54"/>
<polygon fill="black" stroke="black" points="13740.27,-34071.21 13736.77,-34061.21 13733.27,-34071.21 13740.27,-34071.21"/>
</g>
<!-- expert0_fc2_1 -->
<g id="node11" class="node">
<title>expert0_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="14040.31,-33949.2 13557.45,-33949.2 13433.23,-33813.2 13916.09,-33813.2 14040.31,-33949.2"/>
<text text-anchor="middle" x="13736.77" y="-33900" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="13736.77" y="-33885" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13736.77" y="-33870" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="13736.77" y="-33855" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_1&#45;&gt;expert0_fc2_1 -->
<g id="edge11" class="edge">
<title>expert0_gelu_1&#45;&gt;expert0_fc2_1</title>
<path fill="none" stroke="black" d="M13736.77,-33986.14C13736.77,-33977.84 13736.77,-33968.72 13736.77,-33959.43"/>
<polygon fill="black" stroke="black" points="13740.27,-33959.32 13736.77,-33949.32 13733.27,-33959.32 13740.27,-33959.32"/>
</g>
<!-- expert_agg_1 -->
<g id="node33" class="node">
<title>expert_agg_1</title>
<ellipse fill="lightblue" stroke="black" cx="16240.77" cy="-33556.53" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="16240.77" cy="-33556.53" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="16240.77" y="-33567.83" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="16240.77" y="-33552.83" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="16240.77" y="-33537.83" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert0_fc2_1&#45;&gt;expert_agg_1 -->
<g id="edge12" class="edge">
<title>expert0_fc2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M13935.76,-33834.65C13973.5,-33826.85 14012.76,-33819.31 14049.77,-33813.2 14761.32,-33695.8 15611.61,-33612.78 16011.5,-33577.08"/>
<polygon fill="black" stroke="black" points="16012.08,-33580.54 16021.73,-33576.17 16011.46,-33573.57 16012.08,-33580.54"/>
</g>
<!-- expert1_gelu_1 -->
<g id="node13" class="node">
<title>expert1_gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="14362.77" cy="-34023.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14362.77" y="-34034.98" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="14362.77" y="-34019.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14362.77" y="-34004.98" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert1_fc1_1&#45;&gt;expert1_gelu_1 -->
<g id="edge14" class="edge">
<title>expert1_fc1_1&#45;&gt;expert1_gelu_1</title>
<path fill="none" stroke="black" d="M14362.77,-34111.85C14362.77,-34098.26 14362.77,-34084.24 14362.77,-34071.54"/>
<polygon fill="black" stroke="black" points="14366.27,-34071.21 14362.77,-34061.21 14359.27,-34071.21 14366.27,-34071.21"/>
</g>
<!-- expert1_fc2_1 -->
<g id="node14" class="node">
<title>expert1_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="14666.31,-33949.2 14183.45,-33949.2 14059.23,-33813.2 14542.09,-33813.2 14666.31,-33949.2"/>
<text text-anchor="middle" x="14362.77" y="-33900" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="14362.77" y="-33885" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14362.77" y="-33870" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="14362.77" y="-33855" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_1&#45;&gt;expert1_fc2_1 -->
<g id="edge15" class="edge">
<title>expert1_gelu_1&#45;&gt;expert1_fc2_1</title>
<path fill="none" stroke="black" d="M14362.77,-33986.14C14362.77,-33977.84 14362.77,-33968.72 14362.77,-33959.43"/>
<polygon fill="black" stroke="black" points="14366.27,-33959.32 14362.77,-33949.32 14359.27,-33959.32 14366.27,-33959.32"/>
</g>
<!-- expert1_fc2_1&#45;&gt;expert_agg_1 -->
<g id="edge16" class="edge">
<title>expert1_fc2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M14562.84,-33835.85C14600.31,-33827.98 14639.18,-33820.1 14675.77,-33813.2 15149.74,-33723.81 15707.95,-33637.03 16013.11,-33591.15"/>
<polygon fill="black" stroke="black" points="16014.04,-33594.55 16023.41,-33589.6 16013,-33587.63 16014.04,-33594.55"/>
</g>
<!-- expert2_gelu_1 -->
<g id="node16" class="node">
<title>expert2_gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="14988.77" cy="-34023.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14988.77" y="-34034.98" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="14988.77" y="-34019.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14988.77" y="-34004.98" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert2_fc1_1&#45;&gt;expert2_gelu_1 -->
<g id="edge18" class="edge">
<title>expert2_fc1_1&#45;&gt;expert2_gelu_1</title>
<path fill="none" stroke="black" d="M14988.77,-34111.85C14988.77,-34098.26 14988.77,-34084.24 14988.77,-34071.54"/>
<polygon fill="black" stroke="black" points="14992.27,-34071.21 14988.77,-34061.21 14985.27,-34071.21 14992.27,-34071.21"/>
</g>
<!-- expert2_fc2_1 -->
<g id="node17" class="node">
<title>expert2_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="15292.31,-33949.2 14809.45,-33949.2 14685.23,-33813.2 15168.09,-33813.2 15292.31,-33949.2"/>
<text text-anchor="middle" x="14988.77" y="-33900" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="14988.77" y="-33885" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14988.77" y="-33870" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="14988.77" y="-33855" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_1&#45;&gt;expert2_fc2_1 -->
<g id="edge19" class="edge">
<title>expert2_gelu_1&#45;&gt;expert2_fc2_1</title>
<path fill="none" stroke="black" d="M14988.77,-33986.14C14988.77,-33977.84 14988.77,-33968.72 14988.77,-33959.43"/>
<polygon fill="black" stroke="black" points="14992.27,-33959.32 14988.77,-33949.32 14985.27,-33959.32 14992.27,-33959.32"/>
</g>
<!-- expert2_fc2_1&#45;&gt;expert_agg_1 -->
<g id="edge20" class="edge">
<title>expert2_fc2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M15183.71,-33829.96C15409.7,-33771.72 15781.4,-33675.92 16018.45,-33614.83"/>
<polygon fill="black" stroke="black" points="16019.42,-33618.2 16028.23,-33612.31 16017.67,-33611.42 16019.42,-33618.2"/>
</g>
<!-- expert3_gelu_1 -->
<g id="node19" class="node">
<title>expert3_gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="15614.77" cy="-34023.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="15614.77" y="-34034.98" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="15614.77" y="-34019.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="15614.77" y="-34004.98" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert3_fc1_1&#45;&gt;expert3_gelu_1 -->
<g id="edge22" class="edge">
<title>expert3_fc1_1&#45;&gt;expert3_gelu_1</title>
<path fill="none" stroke="black" d="M15614.77,-34111.85C15614.77,-34098.26 15614.77,-34084.24 15614.77,-34071.54"/>
<polygon fill="black" stroke="black" points="15618.27,-34071.21 15614.77,-34061.21 15611.27,-34071.21 15618.27,-34071.21"/>
</g>
<!-- expert3_fc2_1 -->
<g id="node20" class="node">
<title>expert3_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="15918.31,-33949.2 15435.45,-33949.2 15311.23,-33813.2 15794.09,-33813.2 15918.31,-33949.2"/>
<text text-anchor="middle" x="15614.77" y="-33900" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="15614.77" y="-33885" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="15614.77" y="-33870" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="15614.77" y="-33855" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_1&#45;&gt;expert3_fc2_1 -->
<g id="edge23" class="edge">
<title>expert3_gelu_1&#45;&gt;expert3_fc2_1</title>
<path fill="none" stroke="black" d="M15614.77,-33986.14C15614.77,-33977.84 15614.77,-33968.72 15614.77,-33959.43"/>
<polygon fill="black" stroke="black" points="15618.27,-33959.32 15614.77,-33949.32 15611.27,-33959.32 15618.27,-33959.32"/>
</g>
<!-- expert3_fc2_1&#45;&gt;expert_agg_1 -->
<g id="edge24" class="edge">
<title>expert3_fc2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M15744.86,-33813.15C15829.18,-33769.68 15940.8,-33712.15 16036.78,-33662.68"/>
<polygon fill="black" stroke="black" points="16038.44,-33665.76 16045.72,-33658.07 16035.23,-33659.54 16038.44,-33665.76"/>
</g>
<!-- expert4_gelu_1 -->
<g id="node22" class="node">
<title>expert4_gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="16240.77" cy="-34023.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="16240.77" y="-34034.98" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="16240.77" y="-34019.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="16240.77" y="-34004.98" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert4_fc1_1&#45;&gt;expert4_gelu_1 -->
<g id="edge26" class="edge">
<title>expert4_fc1_1&#45;&gt;expert4_gelu_1</title>
<path fill="none" stroke="black" d="M16240.77,-34111.85C16240.77,-34098.26 16240.77,-34084.24 16240.77,-34071.54"/>
<polygon fill="black" stroke="black" points="16244.27,-34071.21 16240.77,-34061.21 16237.27,-34071.21 16244.27,-34071.21"/>
</g>
<!-- expert4_fc2_1 -->
<g id="node23" class="node">
<title>expert4_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="16544.31,-33949.2 16061.45,-33949.2 15937.23,-33813.2 16420.09,-33813.2 16544.31,-33949.2"/>
<text text-anchor="middle" x="16240.77" y="-33900" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="16240.77" y="-33885" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="16240.77" y="-33870" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="16240.77" y="-33855" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_1&#45;&gt;expert4_fc2_1 -->
<g id="edge27" class="edge">
<title>expert4_gelu_1&#45;&gt;expert4_fc2_1</title>
<path fill="none" stroke="black" d="M16240.77,-33986.14C16240.77,-33977.84 16240.77,-33968.72 16240.77,-33959.43"/>
<polygon fill="black" stroke="black" points="16244.27,-33959.32 16240.77,-33949.32 16237.27,-33959.32 16244.27,-33959.32"/>
</g>
<!-- expert4_fc2_1&#45;&gt;expert_agg_1 -->
<g id="edge28" class="edge">
<title>expert4_fc2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M16240.77,-33812.95C16240.77,-33804.61 16240.77,-33795.75 16240.77,-33786.54"/>
<polygon fill="black" stroke="black" points="16244.27,-33786.4 16240.77,-33776.4 16237.27,-33786.4 16244.27,-33786.4"/>
</g>
<!-- expert5_gelu_1 -->
<g id="node25" class="node">
<title>expert5_gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="16866.77" cy="-34023.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="16866.77" y="-34034.98" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="16866.77" y="-34019.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="16866.77" y="-34004.98" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert5_fc1_1&#45;&gt;expert5_gelu_1 -->
<g id="edge30" class="edge">
<title>expert5_fc1_1&#45;&gt;expert5_gelu_1</title>
<path fill="none" stroke="black" d="M16866.77,-34111.85C16866.77,-34098.26 16866.77,-34084.24 16866.77,-34071.54"/>
<polygon fill="black" stroke="black" points="16870.27,-34071.21 16866.77,-34061.21 16863.27,-34071.21 16870.27,-34071.21"/>
</g>
<!-- expert5_fc2_1 -->
<g id="node26" class="node">
<title>expert5_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="17170.31,-33949.2 16687.45,-33949.2 16563.23,-33813.2 17046.09,-33813.2 17170.31,-33949.2"/>
<text text-anchor="middle" x="16866.77" y="-33900" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="16866.77" y="-33885" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="16866.77" y="-33870" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="16866.77" y="-33855" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_1&#45;&gt;expert5_fc2_1 -->
<g id="edge31" class="edge">
<title>expert5_gelu_1&#45;&gt;expert5_fc2_1</title>
<path fill="none" stroke="black" d="M16866.77,-33986.14C16866.77,-33977.84 16866.77,-33968.72 16866.77,-33959.43"/>
<polygon fill="black" stroke="black" points="16870.27,-33959.32 16866.77,-33949.32 16863.27,-33959.32 16870.27,-33959.32"/>
</g>
<!-- expert5_fc2_1&#45;&gt;expert_agg_1 -->
<g id="edge32" class="edge">
<title>expert5_fc2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M16736.68,-33813.15C16652.35,-33769.68 16540.74,-33712.15 16444.76,-33662.68"/>
<polygon fill="black" stroke="black" points="16446.31,-33659.54 16435.81,-33658.07 16443.1,-33665.76 16446.31,-33659.54"/>
</g>
<!-- expert6_gelu_1 -->
<g id="node28" class="node">
<title>expert6_gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="17492.77" cy="-34023.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="17492.77" y="-34034.98" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="17492.77" y="-34019.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="17492.77" y="-34004.98" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert6_fc1_1&#45;&gt;expert6_gelu_1 -->
<g id="edge34" class="edge">
<title>expert6_fc1_1&#45;&gt;expert6_gelu_1</title>
<path fill="none" stroke="black" d="M17492.77,-34111.85C17492.77,-34098.26 17492.77,-34084.24 17492.77,-34071.54"/>
<polygon fill="black" stroke="black" points="17496.27,-34071.21 17492.77,-34061.21 17489.27,-34071.21 17496.27,-34071.21"/>
</g>
<!-- expert6_fc2_1 -->
<g id="node29" class="node">
<title>expert6_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="17796.31,-33949.2 17313.45,-33949.2 17189.23,-33813.2 17672.09,-33813.2 17796.31,-33949.2"/>
<text text-anchor="middle" x="17492.77" y="-33900" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="17492.77" y="-33885" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="17492.77" y="-33870" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="17492.77" y="-33855" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_1&#45;&gt;expert6_fc2_1 -->
<g id="edge35" class="edge">
<title>expert6_gelu_1&#45;&gt;expert6_fc2_1</title>
<path fill="none" stroke="black" d="M17492.77,-33986.14C17492.77,-33977.84 17492.77,-33968.72 17492.77,-33959.43"/>
<polygon fill="black" stroke="black" points="17496.27,-33959.32 17492.77,-33949.32 17489.27,-33959.32 17496.27,-33959.32"/>
</g>
<!-- expert6_fc2_1&#45;&gt;expert_agg_1 -->
<g id="edge36" class="edge">
<title>expert6_fc2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M17232.59,-33813.15C17005.21,-33754.55 16678.63,-33670.38 16463.2,-33614.86"/>
<polygon fill="black" stroke="black" points="16463.9,-33611.43 16453.34,-33612.32 16462.15,-33618.2 16463.9,-33611.43"/>
</g>
<!-- expert7_gelu_1 -->
<g id="node31" class="node">
<title>expert7_gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="18118.77" cy="-34023.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="18118.77" y="-34034.98" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="18118.77" y="-34019.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="18118.77" y="-34004.98" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- expert7_fc1_1&#45;&gt;expert7_gelu_1 -->
<g id="edge38" class="edge">
<title>expert7_fc1_1&#45;&gt;expert7_gelu_1</title>
<path fill="none" stroke="black" d="M18118.77,-34111.85C18118.77,-34098.26 18118.77,-34084.24 18118.77,-34071.54"/>
<polygon fill="black" stroke="black" points="18122.27,-34071.21 18118.77,-34061.21 18115.27,-34071.21 18122.27,-34071.21"/>
</g>
<!-- expert7_fc2_1 -->
<g id="node32" class="node">
<title>expert7_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="18422.31,-33949.2 17939.45,-33949.2 17815.23,-33813.2 18298.09,-33813.2 18422.31,-33949.2"/>
<text text-anchor="middle" x="18118.77" y="-33900" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="18118.77" y="-33885" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="18118.77" y="-33870" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="18118.77" y="-33855" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_1&#45;&gt;expert7_fc2_1 -->
<g id="edge39" class="edge">
<title>expert7_gelu_1&#45;&gt;expert7_fc2_1</title>
<path fill="none" stroke="black" d="M18118.77,-33986.14C18118.77,-33977.84 18118.77,-33968.72 18118.77,-33959.43"/>
<polygon fill="black" stroke="black" points="18122.27,-33959.32 18118.77,-33949.32 18115.27,-33959.32 18122.27,-33959.32"/>
</g>
<!-- expert7_fc2_1&#45;&gt;expert_agg_1 -->
<g id="edge40" class="edge">
<title>expert7_fc2_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M17816.89,-33815.32C17813.16,-33814.6 17809.45,-33813.9 17805.77,-33813.2 17331.8,-33723.81 16773.59,-33637.03 16468.43,-33591.15"/>
<polygon fill="black" stroke="black" points="16468.54,-33587.63 16458.13,-33589.6 16467.5,-33594.55 16468.54,-33587.63"/>
</g>
<!-- expert_agg_1&#45;&gt;residual2_1 -->
<g id="edge41" class="edge">
<title>expert_agg_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M16452.19,-33496.67C16680.4,-33433.13 17036.14,-33334.08 17222.47,-33282.2"/>
<polygon fill="black" stroke="black" points="17223.61,-33285.51 17232.3,-33279.46 17221.73,-33278.77 17223.61,-33285.51"/>
</g>
<!-- comm_1 -->
<g id="node35" class="node">
<title>comm_1</title>
<polygon fill="yellow" stroke="black" points="17463.51,-33095.48 17463.51,-33129.13 17394.54,-33152.93 17297,-33152.93 17228.03,-33129.13 17228.03,-33095.48 17297,-33071.68 17394.54,-33071.68 17463.51,-33095.48"/>
<polygon fill="none" stroke="black" points="17467.5,-33092.62 17467.5,-33131.99 17395.21,-33156.93 17296.33,-33156.93 17224.04,-33131.99 17224.04,-33092.62 17296.33,-33067.67 17395.21,-33067.67 17467.5,-33092.62"/>
<text text-anchor="middle" x="17345.77" y="-33123.6" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="17345.77" y="-33108.6" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="17345.77" y="-33093.6" font-family="Times,serif" font-size="14.00">GPU0→GPU1</text>
</g>
<!-- residual2_1&#45;&gt;comm_1 -->
<g id="edge43" class="edge">
<title>residual2_1&#45;&gt;comm_1</title>
<path fill="none" stroke="black" d="M17345.77,-33193.85C17345.77,-33185.1 17345.77,-33175.99 17345.77,-33167.18"/>
<polygon fill="black" stroke="black" points="17349.27,-33167.02 17345.77,-33157.02 17342.27,-33167.02 17349.27,-33167.02"/>
</g>
<!-- ln1_2 -->
<g id="node36" class="node">
<title>ln1_2</title>
<polygon fill="lightcoral" stroke="black" points="17338.77,-33030.74 17194.77,-33030.74 17194.77,-32977.74 17338.77,-32977.74 17338.77,-33030.74"/>
<text text-anchor="middle" x="17266.77" y="-33015.54" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="17266.77" y="-33000.54" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="17266.77" y="-32985.54" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- comm_1&#45;&gt;ln1_2 -->
<g id="edge44" class="edge">
<title>comm_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M17313.18,-33067.55C17306.09,-33058.02 17298.69,-33048.09 17291.93,-33039.02"/>
<polygon fill="black" stroke="black" points="17294.72,-33036.9 17285.94,-33030.97 17289.1,-33041.08 17294.72,-33036.9"/>
</g>
<!-- residual1_2 -->
<g id="node40" class="node">
<title>residual1_2</title>
<polygon fill="lightcoral" stroke="black" points="17263.77,-32432.69 16970.77,-32379.69 17263.77,-32326.69 17556.77,-32379.69 17263.77,-32432.69"/>
<text text-anchor="middle" x="17263.77" y="-32390.99" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="17263.77" y="-32375.99" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="17263.77" y="-32360.99" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- comm_1&#45;&gt;residual1_2 -->
<g id="edge49" class="edge">
<title>comm_1&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17396.92,-33068.02C17412.1,-33050.46 17424.77,-33028.77 17424.77,-33005.24 17424.77,-33005.24 17424.77,-33005.24 17424.77,-32536.69 17424.77,-32505.62 17423.55,-32494.45 17404.77,-32469.69 17391.05,-32451.61 17372.52,-32436.26 17353.39,-32423.66"/>
<polygon fill="black" stroke="black" points="17355.2,-32420.66 17344.88,-32418.24 17351.44,-32426.56 17355.2,-32420.66"/>
<text text-anchor="middle" x="17453.77" y="-32775.54" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_2 -->
<g id="node37" class="node">
<title>qkv_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="17396.31,-32940.74 16913.45,-32940.74 16789.23,-32804.74 17272.09,-32804.74 17396.31,-32940.74"/>
<text text-anchor="middle" x="17092.77" y="-32891.54" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="17092.77" y="-32876.54" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="17092.77" y="-32861.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="17092.77" y="-32846.54" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_2&#45;&gt;qkv_proj_2 -->
<g id="edge45" class="edge">
<title>ln1_2&#45;&gt;qkv_proj_2</title>
<path fill="none" stroke="black" d="M17232.39,-32977.65C17220.27,-32968.63 17205.98,-32957.99 17191.23,-32947.02"/>
<polygon fill="black" stroke="black" points="17193.12,-32944.06 17183,-32940.9 17188.94,-32949.67 17193.12,-32944.06"/>
</g>
<!-- mha_2 -->
<g id="node38" class="node">
<title>mha_2</title>
<polygon fill="lightcoral" stroke="black" points="17338.24,-32698.22 17218.5,-32753.76 16979.04,-32753.76 16859.3,-32698.22 16979.04,-32642.67 17218.5,-32642.67 17338.24,-32698.22"/>
<text text-anchor="middle" x="17098.77" y="-32717.02" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17098.77" y="-32702.02" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="17098.77" y="-32687.02" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="17098.77" y="-32672.02" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- qkv_proj_2&#45;&gt;mha_2 -->
<g id="edge46" class="edge">
<title>qkv_proj_2&#45;&gt;mha_2</title>
<path fill="none" stroke="black" d="M17095.11,-32804.54C17095.57,-32791.33 17096.05,-32777.49 17096.5,-32764.34"/>
<polygon fill="black" stroke="black" points="17100.01,-32764.09 17096.86,-32753.98 17093.02,-32763.85 17100.01,-32764.09"/>
</g>
<!-- out_proj_2 -->
<g id="node39" class="node">
<title>out_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="17396.14,-32605.69 16927.86,-32605.69 16807.39,-32469.69 17275.68,-32469.69 17396.14,-32605.69"/>
<text text-anchor="middle" x="17101.77" y="-32556.49" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="17101.77" y="-32541.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="17101.77" y="-32526.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="17101.77" y="-32511.49" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_2&#45;&gt;out_proj_2 -->
<g id="edge47" class="edge">
<title>mha_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M17099.8,-32642.66C17099.96,-32634.07 17100.13,-32625.05 17100.3,-32616.07"/>
<polygon fill="black" stroke="black" points="17103.81,-32616.02 17100.5,-32605.96 17096.81,-32615.89 17103.81,-32616.02"/>
</g>
<!-- out_proj_2&#45;&gt;residual1_2 -->
<g id="edge48" class="edge">
<title>out_proj_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M17171.41,-32469.63C17184.6,-32456.93 17198.2,-32443.83 17210.78,-32431.72"/>
<polygon fill="black" stroke="black" points="17213.27,-32434.18 17218.05,-32424.72 17208.42,-32429.14 17213.27,-32434.18"/>
</g>
<!-- ln2_2 -->
<g id="node41" class="node">
<title>ln2_2</title>
<polygon fill="lightcoral" stroke="black" points="17022.77,-32289.69 16878.77,-32289.69 16878.77,-32236.69 17022.77,-32236.69 17022.77,-32289.69"/>
<text text-anchor="middle" x="16950.77" y="-32274.49" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="16950.77" y="-32259.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="16950.77" y="-32244.49" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge50" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M17168.58,-32343.87C17124.37,-32327.7 17072.39,-32308.69 17030.3,-32293.29"/>
<polygon fill="black" stroke="black" points="17031.25,-32289.91 17020.66,-32289.76 17028.85,-32296.48 17031.25,-32289.91"/>
</g>
<!-- residual2_2 -->
<g id="node68" class="node">
<title>residual2_2</title>
<polygon fill="lightcoral" stroke="black" points="16472.77,-31094.41 16179.77,-31041.41 16472.77,-30988.41 16765.77,-31041.41 16472.77,-31094.41"/>
<text text-anchor="middle" x="16472.77" y="-31052.71" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="16472.77" y="-31037.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="16472.77" y="-31022.71" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge85" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17406.99,-32352.6C17489.8,-32333.28 17577.77,-32303.51 17577.77,-32264.19 17577.77,-32264.19 17577.77,-32264.19 17577.77,-31350.07 17577.77,-31167.23 17009.21,-31088.39 16687.76,-31058.43"/>
<polygon fill="black" stroke="black" points="16687.65,-31054.91 16677.38,-31057.47 16687.01,-31061.88 16687.65,-31054.91"/>
<text text-anchor="middle" x="17606.77" y="-31877.49" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_2 -->
<g id="node42" class="node">
<title>gate_2</title>
<polygon fill="lightcoral" stroke="black" points="15517.86,-32199.69 15217.68,-32199.69 15110.77,-32093.69 15624.77,-32093.69 15517.86,-32199.69"/>
<text text-anchor="middle" x="15367.77" y="-32157.99" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="15367.77" y="-32142.99" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="15367.77" y="-32127.99" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- ln2_2&#45;&gt;gate_2 -->
<g id="edge51" class="edge">
<title>ln2_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M16878.64,-32256.98C16647.84,-32240.28 15921.86,-32187.77 15566.99,-32162.1"/>
<polygon fill="black" stroke="black" points="15567.09,-32158.6 15556.86,-32161.37 15566.59,-32165.58 15567.09,-32158.6"/>
</g>
<!-- expert0_fc1_2 -->
<g id="node43" class="node">
<title>expert0_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="13167.31,-32042.69 12684.45,-32042.69 12560.23,-31906.69 13043.09,-31906.69 13167.31,-32042.69"/>
<text text-anchor="middle" x="12863.77" y="-31993.49" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="12863.77" y="-31978.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12863.77" y="-31963.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12863.77" y="-31948.49" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_2&#45;&gt;expert0_fc1_2 -->
<g id="edge52" class="edge">
<title>gate_2&#45;&gt;expert0_fc1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15157.31,-32140.21C14685.6,-32127.19 13555.47,-32091.82 13176.77,-32042.69 13176.66,-32042.68 13176.55,-32042.67 13176.45,-32042.65"/>
<polygon fill="black" stroke="black" points="13176.76,-32039.16 13166.38,-32041.3 13175.83,-32046.1 13176.76,-32039.16"/>
<text text-anchor="middle" x="13585.27" y="-32064.49" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_2 -->
<g id="node46" class="node">
<title>expert1_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="13793.31,-32042.69 13310.45,-32042.69 13186.23,-31906.69 13669.09,-31906.69 13793.31,-32042.69"/>
<text text-anchor="middle" x="13489.77" y="-31993.49" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="13489.77" y="-31978.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="13489.77" y="-31963.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13489.77" y="-31948.49" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_2&#45;&gt;expert1_fc1_2 -->
<g id="edge56" class="edge">
<title>gate_2&#45;&gt;expert1_fc1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15158.89,-32141.57C14857.91,-32133.45 14285.34,-32109.86 13802.77,-32042.69 13802.55,-32042.66 13802.32,-32042.63 13802.1,-32042.6"/>
<polygon fill="black" stroke="black" points="13802.37,-32039.1 13791.98,-32041.15 13801.38,-32046.03 13802.37,-32039.1"/>
<text text-anchor="middle" x="14103.27" y="-32064.49" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_2 -->
<g id="node49" class="node">
<title>expert2_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="14419.31,-32042.69 13936.45,-32042.69 13812.23,-31906.69 14295.09,-31906.69 14419.31,-32042.69"/>
<text text-anchor="middle" x="14115.77" y="-31993.49" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="14115.77" y="-31978.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14115.77" y="-31963.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14115.77" y="-31948.49" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_2&#45;&gt;expert2_fc1_2 -->
<g id="edge60" class="edge">
<title>gate_2&#45;&gt;expert2_fc1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15144.93,-32127.68C14954.13,-32110.72 14672.43,-32082.03 14428.77,-32042.69 14428.55,-32042.66 14428.32,-32042.62 14428.1,-32042.59"/>
<polygon fill="black" stroke="black" points="14428.45,-32039.1 14418.01,-32040.93 14427.31,-32046 14428.45,-32039.1"/>
<text text-anchor="middle" x="14679.27" y="-32064.49" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_2 -->
<g id="node52" class="node">
<title>expert3_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="15045.31,-32042.69 14562.45,-32042.69 14438.23,-31906.69 14921.09,-31906.69 15045.31,-32042.69"/>
<text text-anchor="middle" x="14741.77" y="-31993.49" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="14741.77" y="-31978.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14741.77" y="-31963.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14741.77" y="-31948.49" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_2&#45;&gt;expert3_fc1_2 -->
<g id="edge64" class="edge">
<title>gate_2&#45;&gt;expert3_fc1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15176.12,-32093.65C15120.1,-32078.44 15057.95,-32061.56 14998.59,-32045.44"/>
<polygon fill="black" stroke="black" points="14999.27,-32042 14988.7,-32042.75 14997.43,-32048.75 14999.27,-32042"/>
<text text-anchor="middle" x="15138.27" y="-32064.49" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_2 -->
<g id="node55" class="node">
<title>expert4_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="15671.31,-32042.69 15188.45,-32042.69 15064.23,-31906.69 15547.09,-31906.69 15671.31,-32042.69"/>
<text text-anchor="middle" x="15367.77" y="-31993.49" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="15367.77" y="-31978.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="15367.77" y="-31963.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="15367.77" y="-31948.49" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_2&#45;&gt;expert4_fc1_2 -->
<g id="edge68" class="edge">
<title>gate_2&#45;&gt;expert4_fc1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15367.77,-32093.3C15367.77,-32080.63 15367.77,-32066.82 15367.77,-32053.26"/>
<polygon fill="black" stroke="black" points="15371.27,-32052.97 15367.77,-32042.97 15364.27,-32052.97 15371.27,-32052.97"/>
<text text-anchor="middle" x="15413.27" y="-32064.49" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_2 -->
<g id="node58" class="node">
<title>expert5_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="16297.31,-32042.69 15814.45,-32042.69 15690.23,-31906.69 16173.09,-31906.69 16297.31,-32042.69"/>
<text text-anchor="middle" x="15993.77" y="-31993.49" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="15993.77" y="-31978.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="15993.77" y="-31963.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="15993.77" y="-31948.49" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_2&#45;&gt;expert5_fc1_2 -->
<g id="edge72" class="edge">
<title>gate_2&#45;&gt;expert5_fc1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15559.42,-32093.65C15632.78,-32073.73 15716.67,-32050.94 15791.04,-32030.75"/>
<polygon fill="black" stroke="black" points="15792.27,-32034.04 15801,-32028.04 15790.43,-32027.29 15792.27,-32034.04"/>
<text text-anchor="middle" x="15726.27" y="-32064.49" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_2 -->
<g id="node61" class="node">
<title>expert6_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="16923.31,-32042.69 16440.45,-32042.69 16316.23,-31906.69 16799.09,-31906.69 16923.31,-32042.69"/>
<text text-anchor="middle" x="16619.77" y="-31993.49" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="16619.77" y="-31978.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="16619.77" y="-31963.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="16619.77" y="-31948.49" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_2&#45;&gt;expert6_fc1_2 -->
<g id="edge76" class="edge">
<title>gate_2&#45;&gt;expert6_fc1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15590.6,-32127.68C15781.4,-32110.72 16063.11,-32082.03 16306.77,-32042.69 16340.47,-32037.25 16376.03,-32030.56 16410.6,-32023.54"/>
<polygon fill="black" stroke="black" points="16411.71,-32026.89 16420.81,-32021.45 16410.31,-32020.03 16411.71,-32026.89"/>
<text text-anchor="middle" x="16225.27" y="-32064.49" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_2 -->
<g id="node64" class="node">
<title>expert7_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="17549.31,-32042.69 17066.45,-32042.69 16942.23,-31906.69 17425.09,-31906.69 17549.31,-32042.69"/>
<text text-anchor="middle" x="17245.77" y="-31993.49" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="17245.77" y="-31978.49" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="17245.77" y="-31963.49" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="17245.77" y="-31948.49" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_2&#45;&gt;expert7_fc1_2 -->
<g id="edge80" class="edge">
<title>gate_2&#45;&gt;expert7_fc1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15576.65,-32141.57C15877.63,-32133.45 16450.19,-32109.86 16932.77,-32042.69 16966.98,-32037.93 17003.03,-32031.53 17038.01,-32024.57"/>
<polygon fill="black" stroke="black" points="17038.73,-32028 17047.84,-32022.6 17037.35,-32021.13 17038.73,-32028"/>
<text text-anchor="middle" x="16810.27" y="-32064.49" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_2 -->
<g id="node44" class="node">
<title>expert0_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="12863.77" cy="-31818.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12863.77" y="-31829.52" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="12863.77" y="-31814.52" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12863.77" y="-31799.52" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert0_fc1_2&#45;&gt;expert0_gelu_2 -->
<g id="edge53" class="edge">
<title>expert0_fc1_2&#45;&gt;expert0_gelu_2</title>
<path fill="none" stroke="black" d="M12863.77,-31906.39C12863.77,-31892.79 12863.77,-31878.78 12863.77,-31866.08"/>
<polygon fill="black" stroke="black" points="12867.27,-31865.75 12863.77,-31855.75 12860.27,-31865.75 12867.27,-31865.75"/>
</g>
<!-- expert0_fc2_2 -->
<g id="node45" class="node">
<title>expert0_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="13167.31,-31743.74 12684.45,-31743.74 12560.23,-31607.74 13043.09,-31607.74 13167.31,-31743.74"/>
<text text-anchor="middle" x="12863.77" y="-31694.54" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="12863.77" y="-31679.54" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12863.77" y="-31664.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="12863.77" y="-31649.54" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_2&#45;&gt;expert0_fc2_2 -->
<g id="edge54" class="edge">
<title>expert0_gelu_2&#45;&gt;expert0_fc2_2</title>
<path fill="none" stroke="black" d="M12863.77,-31780.68C12863.77,-31772.38 12863.77,-31763.26 12863.77,-31753.97"/>
<polygon fill="black" stroke="black" points="12867.27,-31753.86 12863.77,-31743.86 12860.27,-31753.86 12867.27,-31753.86"/>
</g>
<!-- expert_agg_2 -->
<g id="node67" class="node">
<title>expert_agg_2</title>
<ellipse fill="lightcoral" stroke="black" cx="15367.77" cy="-31351.07" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="15367.77" cy="-31351.07" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="15367.77" y="-31362.37" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="15367.77" y="-31347.37" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="15367.77" y="-31332.37" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert0_fc2_2&#45;&gt;expert_agg_2 -->
<g id="edge55" class="edge">
<title>expert0_fc2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M13062.76,-31629.19C13100.5,-31621.39 13139.76,-31613.85 13176.77,-31607.74 13888.32,-31490.34 14738.61,-31407.31 15138.5,-31371.62"/>
<polygon fill="black" stroke="black" points="15139.08,-31375.08 15148.73,-31370.71 15138.46,-31368.11 15139.08,-31375.08"/>
</g>
<!-- expert1_gelu_2 -->
<g id="node47" class="node">
<title>expert1_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="13489.77" cy="-31818.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="13489.77" y="-31829.52" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="13489.77" y="-31814.52" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="13489.77" y="-31799.52" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert1_fc1_2&#45;&gt;expert1_gelu_2 -->
<g id="edge57" class="edge">
<title>expert1_fc1_2&#45;&gt;expert1_gelu_2</title>
<path fill="none" stroke="black" d="M13489.77,-31906.39C13489.77,-31892.79 13489.77,-31878.78 13489.77,-31866.08"/>
<polygon fill="black" stroke="black" points="13493.27,-31865.75 13489.77,-31855.75 13486.27,-31865.75 13493.27,-31865.75"/>
</g>
<!-- expert1_fc2_2 -->
<g id="node48" class="node">
<title>expert1_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="13793.31,-31743.74 13310.45,-31743.74 13186.23,-31607.74 13669.09,-31607.74 13793.31,-31743.74"/>
<text text-anchor="middle" x="13489.77" y="-31694.54" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="13489.77" y="-31679.54" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13489.77" y="-31664.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="13489.77" y="-31649.54" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_2&#45;&gt;expert1_fc2_2 -->
<g id="edge58" class="edge">
<title>expert1_gelu_2&#45;&gt;expert1_fc2_2</title>
<path fill="none" stroke="black" d="M13489.77,-31780.68C13489.77,-31772.38 13489.77,-31763.26 13489.77,-31753.97"/>
<polygon fill="black" stroke="black" points="13493.27,-31753.86 13489.77,-31743.86 13486.27,-31753.86 13493.27,-31753.86"/>
</g>
<!-- expert1_fc2_2&#45;&gt;expert_agg_2 -->
<g id="edge59" class="edge">
<title>expert1_fc2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M13689.84,-31630.39C13727.31,-31622.52 13766.18,-31614.64 13802.77,-31607.74 14276.74,-31518.35 14834.95,-31431.57 15140.11,-31385.69"/>
<polygon fill="black" stroke="black" points="15141.04,-31389.09 15150.41,-31384.14 15140,-31382.17 15141.04,-31389.09"/>
</g>
<!-- expert2_gelu_2 -->
<g id="node50" class="node">
<title>expert2_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14115.77" cy="-31818.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14115.77" y="-31829.52" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="14115.77" y="-31814.52" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14115.77" y="-31799.52" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert2_fc1_2&#45;&gt;expert2_gelu_2 -->
<g id="edge61" class="edge">
<title>expert2_fc1_2&#45;&gt;expert2_gelu_2</title>
<path fill="none" stroke="black" d="M14115.77,-31906.39C14115.77,-31892.79 14115.77,-31878.78 14115.77,-31866.08"/>
<polygon fill="black" stroke="black" points="14119.27,-31865.75 14115.77,-31855.75 14112.27,-31865.75 14119.27,-31865.75"/>
</g>
<!-- expert2_fc2_2 -->
<g id="node51" class="node">
<title>expert2_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="14419.31,-31743.74 13936.45,-31743.74 13812.23,-31607.74 14295.09,-31607.74 14419.31,-31743.74"/>
<text text-anchor="middle" x="14115.77" y="-31694.54" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="14115.77" y="-31679.54" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14115.77" y="-31664.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14115.77" y="-31649.54" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_2&#45;&gt;expert2_fc2_2 -->
<g id="edge62" class="edge">
<title>expert2_gelu_2&#45;&gt;expert2_fc2_2</title>
<path fill="none" stroke="black" d="M14115.77,-31780.68C14115.77,-31772.38 14115.77,-31763.26 14115.77,-31753.97"/>
<polygon fill="black" stroke="black" points="14119.27,-31753.86 14115.77,-31743.86 14112.27,-31753.86 14119.27,-31753.86"/>
</g>
<!-- expert2_fc2_2&#45;&gt;expert_agg_2 -->
<g id="edge63" class="edge">
<title>expert2_fc2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M14310.71,-31624.5C14536.7,-31566.26 14908.4,-31470.46 15145.45,-31409.37"/>
<polygon fill="black" stroke="black" points="15146.42,-31412.74 15155.23,-31406.85 15144.67,-31405.96 15146.42,-31412.74"/>
</g>
<!-- expert3_gelu_2 -->
<g id="node53" class="node">
<title>expert3_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="14741.77" cy="-31818.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14741.77" y="-31829.52" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="14741.77" y="-31814.52" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14741.77" y="-31799.52" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert3_fc1_2&#45;&gt;expert3_gelu_2 -->
<g id="edge65" class="edge">
<title>expert3_fc1_2&#45;&gt;expert3_gelu_2</title>
<path fill="none" stroke="black" d="M14741.77,-31906.39C14741.77,-31892.79 14741.77,-31878.78 14741.77,-31866.08"/>
<polygon fill="black" stroke="black" points="14745.27,-31865.75 14741.77,-31855.75 14738.27,-31865.75 14745.27,-31865.75"/>
</g>
<!-- expert3_fc2_2 -->
<g id="node54" class="node">
<title>expert3_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="15045.31,-31743.74 14562.45,-31743.74 14438.23,-31607.74 14921.09,-31607.74 15045.31,-31743.74"/>
<text text-anchor="middle" x="14741.77" y="-31694.54" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="14741.77" y="-31679.54" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14741.77" y="-31664.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="14741.77" y="-31649.54" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_2&#45;&gt;expert3_fc2_2 -->
<g id="edge66" class="edge">
<title>expert3_gelu_2&#45;&gt;expert3_fc2_2</title>
<path fill="none" stroke="black" d="M14741.77,-31780.68C14741.77,-31772.38 14741.77,-31763.26 14741.77,-31753.97"/>
<polygon fill="black" stroke="black" points="14745.27,-31753.86 14741.77,-31743.86 14738.27,-31753.86 14745.27,-31753.86"/>
</g>
<!-- expert3_fc2_2&#45;&gt;expert_agg_2 -->
<g id="edge67" class="edge">
<title>expert3_fc2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M14871.86,-31607.69C14956.18,-31564.22 15067.8,-31506.69 15163.78,-31457.22"/>
<polygon fill="black" stroke="black" points="15165.44,-31460.3 15172.72,-31452.61 15162.23,-31454.08 15165.44,-31460.3"/>
</g>
<!-- expert4_gelu_2 -->
<g id="node56" class="node">
<title>expert4_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="15367.77" cy="-31818.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="15367.77" y="-31829.52" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="15367.77" y="-31814.52" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="15367.77" y="-31799.52" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert4_fc1_2&#45;&gt;expert4_gelu_2 -->
<g id="edge69" class="edge">
<title>expert4_fc1_2&#45;&gt;expert4_gelu_2</title>
<path fill="none" stroke="black" d="M15367.77,-31906.39C15367.77,-31892.79 15367.77,-31878.78 15367.77,-31866.08"/>
<polygon fill="black" stroke="black" points="15371.27,-31865.75 15367.77,-31855.75 15364.27,-31865.75 15371.27,-31865.75"/>
</g>
<!-- expert4_fc2_2 -->
<g id="node57" class="node">
<title>expert4_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="15671.31,-31743.74 15188.45,-31743.74 15064.23,-31607.74 15547.09,-31607.74 15671.31,-31743.74"/>
<text text-anchor="middle" x="15367.77" y="-31694.54" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="15367.77" y="-31679.54" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="15367.77" y="-31664.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="15367.77" y="-31649.54" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_2&#45;&gt;expert4_fc2_2 -->
<g id="edge70" class="edge">
<title>expert4_gelu_2&#45;&gt;expert4_fc2_2</title>
<path fill="none" stroke="black" d="M15367.77,-31780.68C15367.77,-31772.38 15367.77,-31763.26 15367.77,-31753.97"/>
<polygon fill="black" stroke="black" points="15371.27,-31753.86 15367.77,-31743.86 15364.27,-31753.86 15371.27,-31753.86"/>
</g>
<!-- expert4_fc2_2&#45;&gt;expert_agg_2 -->
<g id="edge71" class="edge">
<title>expert4_fc2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M15367.77,-31607.49C15367.77,-31599.15 15367.77,-31590.29 15367.77,-31581.08"/>
<polygon fill="black" stroke="black" points="15371.27,-31580.94 15367.77,-31570.94 15364.27,-31580.94 15371.27,-31580.94"/>
</g>
<!-- expert5_gelu_2 -->
<g id="node59" class="node">
<title>expert5_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="15993.77" cy="-31818.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="15993.77" y="-31829.52" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="15993.77" y="-31814.52" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="15993.77" y="-31799.52" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert5_fc1_2&#45;&gt;expert5_gelu_2 -->
<g id="edge73" class="edge">
<title>expert5_fc1_2&#45;&gt;expert5_gelu_2</title>
<path fill="none" stroke="black" d="M15993.77,-31906.39C15993.77,-31892.79 15993.77,-31878.78 15993.77,-31866.08"/>
<polygon fill="black" stroke="black" points="15997.27,-31865.75 15993.77,-31855.75 15990.27,-31865.75 15997.27,-31865.75"/>
</g>
<!-- expert5_fc2_2 -->
<g id="node60" class="node">
<title>expert5_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="16297.31,-31743.74 15814.45,-31743.74 15690.23,-31607.74 16173.09,-31607.74 16297.31,-31743.74"/>
<text text-anchor="middle" x="15993.77" y="-31694.54" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="15993.77" y="-31679.54" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="15993.77" y="-31664.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="15993.77" y="-31649.54" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_2&#45;&gt;expert5_fc2_2 -->
<g id="edge74" class="edge">
<title>expert5_gelu_2&#45;&gt;expert5_fc2_2</title>
<path fill="none" stroke="black" d="M15993.77,-31780.68C15993.77,-31772.38 15993.77,-31763.26 15993.77,-31753.97"/>
<polygon fill="black" stroke="black" points="15997.27,-31753.86 15993.77,-31743.86 15990.27,-31753.86 15997.27,-31753.86"/>
</g>
<!-- expert5_fc2_2&#45;&gt;expert_agg_2 -->
<g id="edge75" class="edge">
<title>expert5_fc2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M15863.68,-31607.69C15779.35,-31564.22 15667.74,-31506.69 15571.76,-31457.22"/>
<polygon fill="black" stroke="black" points="15573.31,-31454.08 15562.81,-31452.61 15570.1,-31460.3 15573.31,-31454.08"/>
</g>
<!-- expert6_gelu_2 -->
<g id="node62" class="node">
<title>expert6_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="16619.77" cy="-31818.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="16619.77" y="-31829.52" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="16619.77" y="-31814.52" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="16619.77" y="-31799.52" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert6_fc1_2&#45;&gt;expert6_gelu_2 -->
<g id="edge77" class="edge">
<title>expert6_fc1_2&#45;&gt;expert6_gelu_2</title>
<path fill="none" stroke="black" d="M16619.77,-31906.39C16619.77,-31892.79 16619.77,-31878.78 16619.77,-31866.08"/>
<polygon fill="black" stroke="black" points="16623.27,-31865.75 16619.77,-31855.75 16616.27,-31865.75 16623.27,-31865.75"/>
</g>
<!-- expert6_fc2_2 -->
<g id="node63" class="node">
<title>expert6_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="16923.31,-31743.74 16440.45,-31743.74 16316.23,-31607.74 16799.09,-31607.74 16923.31,-31743.74"/>
<text text-anchor="middle" x="16619.77" y="-31694.54" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="16619.77" y="-31679.54" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="16619.77" y="-31664.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="16619.77" y="-31649.54" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_2&#45;&gt;expert6_fc2_2 -->
<g id="edge78" class="edge">
<title>expert6_gelu_2&#45;&gt;expert6_fc2_2</title>
<path fill="none" stroke="black" d="M16619.77,-31780.68C16619.77,-31772.38 16619.77,-31763.26 16619.77,-31753.97"/>
<polygon fill="black" stroke="black" points="16623.27,-31753.86 16619.77,-31743.86 16616.27,-31753.86 16623.27,-31753.86"/>
</g>
<!-- expert6_fc2_2&#45;&gt;expert_agg_2 -->
<g id="edge79" class="edge">
<title>expert6_fc2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M16359.59,-31607.69C16132.21,-31549.09 15805.63,-31464.92 15590.2,-31409.4"/>
<polygon fill="black" stroke="black" points="15590.9,-31405.96 15580.34,-31406.86 15589.15,-31412.74 15590.9,-31405.96"/>
</g>
<!-- expert7_gelu_2 -->
<g id="node65" class="node">
<title>expert7_gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="17245.77" cy="-31818.22" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="17245.77" y="-31829.52" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="17245.77" y="-31814.52" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="17245.77" y="-31799.52" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- expert7_fc1_2&#45;&gt;expert7_gelu_2 -->
<g id="edge81" class="edge">
<title>expert7_fc1_2&#45;&gt;expert7_gelu_2</title>
<path fill="none" stroke="black" d="M17245.77,-31906.39C17245.77,-31892.79 17245.77,-31878.78 17245.77,-31866.08"/>
<polygon fill="black" stroke="black" points="17249.27,-31865.75 17245.77,-31855.75 17242.27,-31865.75 17249.27,-31865.75"/>
</g>
<!-- expert7_fc2_2 -->
<g id="node66" class="node">
<title>expert7_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="17549.31,-31743.74 17066.45,-31743.74 16942.23,-31607.74 17425.09,-31607.74 17549.31,-31743.74"/>
<text text-anchor="middle" x="17245.77" y="-31694.54" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="17245.77" y="-31679.54" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="17245.77" y="-31664.54" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="17245.77" y="-31649.54" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_2&#45;&gt;expert7_fc2_2 -->
<g id="edge82" class="edge">
<title>expert7_gelu_2&#45;&gt;expert7_fc2_2</title>
<path fill="none" stroke="black" d="M17245.77,-31780.68C17245.77,-31772.38 17245.77,-31763.26 17245.77,-31753.97"/>
<polygon fill="black" stroke="black" points="17249.27,-31753.86 17245.77,-31743.86 17242.27,-31753.86 17249.27,-31753.86"/>
</g>
<!-- expert7_fc2_2&#45;&gt;expert_agg_2 -->
<g id="edge83" class="edge">
<title>expert7_fc2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M16943.89,-31609.86C16940.16,-31609.14 16936.45,-31608.44 16932.77,-31607.74 16458.8,-31518.35 15900.59,-31431.57 15595.43,-31385.69"/>
<polygon fill="black" stroke="black" points="15595.54,-31382.17 15585.13,-31384.14 15594.5,-31389.09 15595.54,-31382.17"/>
</g>
<!-- expert_agg_2&#45;&gt;residual2_2 -->
<g id="edge84" class="edge">
<title>expert_agg_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M15579.19,-31291.21C15807.4,-31227.67 16163.14,-31128.62 16349.47,-31076.74"/>
<polygon fill="black" stroke="black" points="16350.61,-31080.05 16359.3,-31074 16348.73,-31073.31 16350.61,-31080.05"/>
</g>
<!-- comm_2 -->
<g id="node69" class="node">
<title>comm_2</title>
<polygon fill="yellow" stroke="black" points="16590.51,-30890.01 16590.51,-30923.67 16521.54,-30947.46 16424,-30947.46 16355.03,-30923.67 16355.03,-30890.01 16424,-30866.22 16521.54,-30866.22 16590.51,-30890.01"/>
<polygon fill="none" stroke="black" points="16594.5,-30887.16 16594.5,-30926.53 16522.21,-30951.47 16423.33,-30951.47 16351.04,-30926.53 16351.04,-30887.16 16423.33,-30862.21 16522.21,-30862.21 16594.5,-30887.16"/>
<text text-anchor="middle" x="16472.77" y="-30918.14" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="16472.77" y="-30903.14" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="16472.77" y="-30888.14" font-family="Times,serif" font-size="14.00">GPU1→GPU2</text>
</g>
<!-- residual2_2&#45;&gt;comm_2 -->
<g id="edge86" class="edge">
<title>residual2_2&#45;&gt;comm_2</title>
<path fill="none" stroke="black" d="M16472.77,-30988.39C16472.77,-30979.63 16472.77,-30970.53 16472.77,-30961.72"/>
<polygon fill="black" stroke="black" points="16476.27,-30961.56 16472.77,-30951.56 16469.27,-30961.56 16476.27,-30961.56"/>
</g>
<!-- ln1_3 -->
<g id="node70" class="node">
<title>ln1_3</title>
<polygon fill="lightgreen" stroke="black" points="16465.77,-30825.28 16321.77,-30825.28 16321.77,-30772.28 16465.77,-30772.28 16465.77,-30825.28"/>
<text text-anchor="middle" x="16393.77" y="-30810.08" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="16393.77" y="-30795.08" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="16393.77" y="-30780.08" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- comm_2&#45;&gt;ln1_3 -->
<g id="edge87" class="edge">
<title>comm_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M16440.18,-30862.09C16433.09,-30852.56 16425.69,-30842.63 16418.93,-30833.56"/>
<polygon fill="black" stroke="black" points="16421.72,-30831.44 16412.94,-30825.51 16416.1,-30835.62 16421.72,-30831.44"/>
</g>
<!-- residual1_3 -->
<g id="node74" class="node">
<title>residual1_3</title>
<polygon fill="lightgreen" stroke="black" points="16390.77,-30227.23 16097.77,-30174.23 16390.77,-30121.23 16683.77,-30174.23 16390.77,-30227.23"/>
<text text-anchor="middle" x="16390.77" y="-30185.53" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="16390.77" y="-30170.53" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="16390.77" y="-30155.53" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- comm_2&#45;&gt;residual1_3 -->
<g id="edge92" class="edge">
<title>comm_2&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16523.92,-30862.56C16539.1,-30845 16551.77,-30823.31 16551.77,-30799.78 16551.77,-30799.78 16551.77,-30799.78 16551.77,-30331.23 16551.77,-30300.16 16550.55,-30288.99 16531.77,-30264.23 16518.05,-30246.15 16499.52,-30230.8 16480.39,-30218.2"/>
<polygon fill="black" stroke="black" points="16482.2,-30215.2 16471.88,-30212.78 16478.44,-30221.1 16482.2,-30215.2"/>
<text text-anchor="middle" x="16580.77" y="-30570.08" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_3 -->
<g id="node71" class="node">
<title>qkv_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="16523.31,-30735.28 16040.45,-30735.28 15916.23,-30599.28 16399.09,-30599.28 16523.31,-30735.28"/>
<text text-anchor="middle" x="16219.77" y="-30686.08" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="16219.77" y="-30671.08" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="16219.77" y="-30656.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="16219.77" y="-30641.08" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_3&#45;&gt;qkv_proj_3 -->
<g id="edge88" class="edge">
<title>ln1_3&#45;&gt;qkv_proj_3</title>
<path fill="none" stroke="black" d="M16359.39,-30772.19C16347.27,-30763.17 16332.98,-30752.53 16318.23,-30741.56"/>
<polygon fill="black" stroke="black" points="16320.12,-30738.6 16310,-30735.43 16315.94,-30744.21 16320.12,-30738.6"/>
</g>
<!-- mha_3 -->
<g id="node72" class="node">
<title>mha_3</title>
<polygon fill="lightgreen" stroke="black" points="16465.24,-30492.75 16345.5,-30548.3 16106.04,-30548.3 15986.3,-30492.75 16106.04,-30437.21 16345.5,-30437.21 16465.24,-30492.75"/>
<text text-anchor="middle" x="16225.77" y="-30511.55" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="16225.77" y="-30496.55" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="16225.77" y="-30481.55" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="16225.77" y="-30466.55" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- qkv_proj_3&#45;&gt;mha_3 -->
<g id="edge89" class="edge">
<title>qkv_proj_3&#45;&gt;mha_3</title>
<path fill="none" stroke="black" d="M16222.11,-30599.08C16222.57,-30585.87 16223.05,-30572.03 16223.5,-30558.88"/>
<polygon fill="black" stroke="black" points="16227.01,-30558.63 16223.86,-30548.51 16220.02,-30558.39 16227.01,-30558.63"/>
</g>
<!-- out_proj_3 -->
<g id="node73" class="node">
<title>out_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="16523.14,-30400.23 16054.86,-30400.23 15934.39,-30264.23 16402.68,-30264.23 16523.14,-30400.23"/>
<text text-anchor="middle" x="16228.77" y="-30351.03" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="16228.77" y="-30336.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="16228.77" y="-30321.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="16228.77" y="-30306.03" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_3&#45;&gt;out_proj_3 -->
<g id="edge90" class="edge">
<title>mha_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M16226.8,-30437.2C16226.96,-30428.61 16227.13,-30419.59 16227.3,-30410.6"/>
<polygon fill="black" stroke="black" points="16230.81,-30410.56 16227.5,-30400.5 16223.81,-30410.43 16230.81,-30410.56"/>
</g>
<!-- out_proj_3&#45;&gt;residual1_3 -->
<g id="edge91" class="edge">
<title>out_proj_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M16298.41,-30264.17C16311.6,-30251.47 16325.2,-30238.37 16337.78,-30226.26"/>
<polygon fill="black" stroke="black" points="16340.27,-30228.72 16345.05,-30219.26 16335.42,-30223.67 16340.27,-30228.72"/>
</g>
<!-- ln2_3 -->
<g id="node75" class="node">
<title>ln2_3</title>
<polygon fill="lightgreen" stroke="black" points="16149.77,-30084.23 16005.77,-30084.23 16005.77,-30031.23 16149.77,-30031.23 16149.77,-30084.23"/>
<text text-anchor="middle" x="16077.77" y="-30069.03" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="16077.77" y="-30054.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="16077.77" y="-30039.03" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge93" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M16295.58,-30138.41C16251.37,-30122.24 16199.39,-30103.22 16157.3,-30087.83"/>
<polygon fill="black" stroke="black" points="16158.25,-30084.45 16147.66,-30084.3 16155.85,-30091.02 16158.25,-30084.45"/>
</g>
<!-- residual2_3 -->
<g id="node102" class="node">
<title>residual2_3</title>
<polygon fill="lightgreen" stroke="black" points="15599.77,-28888.94 15306.77,-28835.94 15599.77,-28782.94 15892.77,-28835.94 15599.77,-28888.94"/>
<text text-anchor="middle" x="15599.77" y="-28847.24" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="15599.77" y="-28832.24" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="15599.77" y="-28817.24" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge128" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16533.99,-30147.14C16616.8,-30127.82 16704.77,-30098.05 16704.77,-30058.73 16704.77,-30058.73 16704.77,-30058.73 16704.77,-29144.61 16704.77,-28961.77 16136.21,-28882.93 15814.76,-28852.97"/>
<polygon fill="black" stroke="black" points="15814.65,-28849.45 15804.38,-28852.01 15814.01,-28856.42 15814.65,-28849.45"/>
<text text-anchor="middle" x="16733.77" y="-29672.03" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_3 -->
<g id="node76" class="node">
<title>gate_3</title>
<polygon fill="lightgreen" stroke="black" points="14644.86,-29994.23 14344.68,-29994.23 14237.77,-29888.23 14751.77,-29888.23 14644.86,-29994.23"/>
<text text-anchor="middle" x="14494.77" y="-29952.53" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="14494.77" y="-29937.53" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="14494.77" y="-29922.53" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- ln2_3&#45;&gt;gate_3 -->
<g id="edge94" class="edge">
<title>ln2_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M16005.64,-30051.52C15774.84,-30034.82 15048.86,-29982.31 14693.99,-29956.64"/>
<polygon fill="black" stroke="black" points="14694.09,-29953.14 14683.86,-29955.91 14693.59,-29960.12 14694.09,-29953.14"/>
</g>
<!-- expert0_fc1_3 -->
<g id="node77" class="node">
<title>expert0_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="12294.31,-29837.23 11811.45,-29837.23 11687.23,-29701.23 12170.09,-29701.23 12294.31,-29837.23"/>
<text text-anchor="middle" x="11990.77" y="-29788.03" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="11990.77" y="-29773.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11990.77" y="-29758.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11990.77" y="-29743.03" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_3&#45;&gt;expert0_fc1_3 -->
<g id="edge95" class="edge">
<title>gate_3&#45;&gt;expert0_fc1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14284.31,-29934.75C13812.6,-29921.73 12682.47,-29886.36 12303.77,-29837.23 12303.66,-29837.22 12303.55,-29837.21 12303.45,-29837.19"/>
<polygon fill="black" stroke="black" points="12303.76,-29833.7 12293.38,-29835.84 12302.83,-29840.64 12303.76,-29833.7"/>
<text text-anchor="middle" x="12712.27" y="-29859.03" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_3 -->
<g id="node80" class="node">
<title>expert1_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="12920.31,-29837.23 12437.45,-29837.23 12313.23,-29701.23 12796.09,-29701.23 12920.31,-29837.23"/>
<text text-anchor="middle" x="12616.77" y="-29788.03" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="12616.77" y="-29773.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12616.77" y="-29758.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12616.77" y="-29743.03" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_3&#45;&gt;expert1_fc1_3 -->
<g id="edge99" class="edge">
<title>gate_3&#45;&gt;expert1_fc1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14285.89,-29936.11C13984.91,-29927.99 13412.34,-29904.4 12929.77,-29837.23 12929.55,-29837.2 12929.32,-29837.17 12929.1,-29837.14"/>
<polygon fill="black" stroke="black" points="12929.37,-29833.64 12918.98,-29835.69 12928.38,-29840.57 12929.37,-29833.64"/>
<text text-anchor="middle" x="13230.27" y="-29859.03" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_3 -->
<g id="node83" class="node">
<title>expert2_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="13546.31,-29837.23 13063.45,-29837.23 12939.23,-29701.23 13422.09,-29701.23 13546.31,-29837.23"/>
<text text-anchor="middle" x="13242.77" y="-29788.03" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="13242.77" y="-29773.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="13242.77" y="-29758.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13242.77" y="-29743.03" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_3&#45;&gt;expert2_fc1_3 -->
<g id="edge103" class="edge">
<title>gate_3&#45;&gt;expert2_fc1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14271.93,-29922.22C14081.13,-29905.25 13799.43,-29876.57 13555.77,-29837.23 13555.55,-29837.2 13555.32,-29837.16 13555.1,-29837.13"/>
<polygon fill="black" stroke="black" points="13555.45,-29833.64 13545.01,-29835.47 13554.31,-29840.54 13555.45,-29833.64"/>
<text text-anchor="middle" x="13806.27" y="-29859.03" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_3 -->
<g id="node86" class="node">
<title>expert3_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="14172.31,-29837.23 13689.45,-29837.23 13565.23,-29701.23 14048.09,-29701.23 14172.31,-29837.23"/>
<text text-anchor="middle" x="13868.77" y="-29788.03" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="13868.77" y="-29773.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="13868.77" y="-29758.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13868.77" y="-29743.03" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_3&#45;&gt;expert3_fc1_3 -->
<g id="edge107" class="edge">
<title>gate_3&#45;&gt;expert3_fc1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14303.12,-29888.19C14247.1,-29872.98 14184.95,-29856.1 14125.59,-29839.98"/>
<polygon fill="black" stroke="black" points="14126.27,-29836.53 14115.7,-29837.29 14124.43,-29843.29 14126.27,-29836.53"/>
<text text-anchor="middle" x="14265.27" y="-29859.03" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_3 -->
<g id="node89" class="node">
<title>expert4_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="14798.31,-29837.23 14315.45,-29837.23 14191.23,-29701.23 14674.09,-29701.23 14798.31,-29837.23"/>
<text text-anchor="middle" x="14494.77" y="-29788.03" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="14494.77" y="-29773.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14494.77" y="-29758.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14494.77" y="-29743.03" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_3&#45;&gt;expert4_fc1_3 -->
<g id="edge111" class="edge">
<title>gate_3&#45;&gt;expert4_fc1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14494.77,-29887.84C14494.77,-29875.17 14494.77,-29861.36 14494.77,-29847.8"/>
<polygon fill="black" stroke="black" points="14498.27,-29847.5 14494.77,-29837.5 14491.27,-29847.5 14498.27,-29847.5"/>
<text text-anchor="middle" x="14540.27" y="-29859.03" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_3 -->
<g id="node92" class="node">
<title>expert5_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="15424.31,-29837.23 14941.45,-29837.23 14817.23,-29701.23 15300.09,-29701.23 15424.31,-29837.23"/>
<text text-anchor="middle" x="15120.77" y="-29788.03" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="15120.77" y="-29773.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="15120.77" y="-29758.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="15120.77" y="-29743.03" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_3&#45;&gt;expert5_fc1_3 -->
<g id="edge115" class="edge">
<title>gate_3&#45;&gt;expert5_fc1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14686.42,-29888.19C14759.78,-29868.26 14843.67,-29845.48 14918.04,-29825.29"/>
<polygon fill="black" stroke="black" points="14919.27,-29828.58 14928,-29822.58 14917.43,-29821.83 14919.27,-29828.58"/>
<text text-anchor="middle" x="14853.27" y="-29859.03" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_3 -->
<g id="node95" class="node">
<title>expert6_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="16050.31,-29837.23 15567.45,-29837.23 15443.23,-29701.23 15926.09,-29701.23 16050.31,-29837.23"/>
<text text-anchor="middle" x="15746.77" y="-29788.03" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="15746.77" y="-29773.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="15746.77" y="-29758.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="15746.77" y="-29743.03" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_3&#45;&gt;expert6_fc1_3 -->
<g id="edge119" class="edge">
<title>gate_3&#45;&gt;expert6_fc1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14717.6,-29922.22C14908.4,-29905.25 15190.11,-29876.57 15433.77,-29837.23 15467.47,-29831.79 15503.03,-29825.1 15537.6,-29818.08"/>
<polygon fill="black" stroke="black" points="15538.71,-29821.43 15547.81,-29815.99 15537.31,-29814.57 15538.71,-29821.43"/>
<text text-anchor="middle" x="15352.27" y="-29859.03" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_3 -->
<g id="node98" class="node">
<title>expert7_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="16676.31,-29837.23 16193.45,-29837.23 16069.23,-29701.23 16552.09,-29701.23 16676.31,-29837.23"/>
<text text-anchor="middle" x="16372.77" y="-29788.03" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="16372.77" y="-29773.03" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="16372.77" y="-29758.03" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="16372.77" y="-29743.03" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_3&#45;&gt;expert7_fc1_3 -->
<g id="edge123" class="edge">
<title>gate_3&#45;&gt;expert7_fc1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14703.65,-29936.11C15004.63,-29927.99 15577.19,-29904.4 16059.77,-29837.23 16093.98,-29832.47 16130.03,-29826.07 16165.01,-29819.11"/>
<polygon fill="black" stroke="black" points="16165.73,-29822.54 16174.84,-29817.13 16164.35,-29815.67 16165.73,-29822.54"/>
<text text-anchor="middle" x="15937.27" y="-29859.03" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_3 -->
<g id="node78" class="node">
<title>expert0_gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="11990.77" cy="-29612.76" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11990.77" y="-29624.06" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="11990.77" y="-29609.06" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11990.77" y="-29594.06" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert0_fc1_3&#45;&gt;expert0_gelu_3 -->
<g id="edge96" class="edge">
<title>expert0_fc1_3&#45;&gt;expert0_gelu_3</title>
<path fill="none" stroke="black" d="M11990.77,-29700.93C11990.77,-29687.33 11990.77,-29673.32 11990.77,-29660.62"/>
<polygon fill="black" stroke="black" points="11994.27,-29660.29 11990.77,-29650.29 11987.27,-29660.29 11994.27,-29660.29"/>
</g>
<!-- expert0_fc2_3 -->
<g id="node79" class="node">
<title>expert0_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="12294.31,-29538.28 11811.45,-29538.28 11687.23,-29402.28 12170.09,-29402.28 12294.31,-29538.28"/>
<text text-anchor="middle" x="11990.77" y="-29489.08" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="11990.77" y="-29474.08" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11990.77" y="-29459.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="11990.77" y="-29444.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_3&#45;&gt;expert0_fc2_3 -->
<g id="edge97" class="edge">
<title>expert0_gelu_3&#45;&gt;expert0_fc2_3</title>
<path fill="none" stroke="black" d="M11990.77,-29575.21C11990.77,-29566.92 11990.77,-29557.8 11990.77,-29548.51"/>
<polygon fill="black" stroke="black" points="11994.27,-29548.4 11990.77,-29538.4 11987.27,-29548.4 11994.27,-29548.4"/>
</g>
<!-- expert_agg_3 -->
<g id="node101" class="node">
<title>expert_agg_3</title>
<ellipse fill="lightgreen" stroke="black" cx="14494.77" cy="-29145.61" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="14494.77" cy="-29145.61" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="14494.77" y="-29156.91" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="14494.77" y="-29141.91" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="14494.77" y="-29126.91" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert0_fc2_3&#45;&gt;expert_agg_3 -->
<g id="edge98" class="edge">
<title>expert0_fc2_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M12189.76,-29423.73C12227.5,-29415.93 12266.76,-29408.39 12303.77,-29402.28 13015.32,-29284.88 13865.61,-29201.85 14265.5,-29166.16"/>
<polygon fill="black" stroke="black" points="14266.08,-29169.62 14275.73,-29165.25 14265.46,-29162.65 14266.08,-29169.62"/>
</g>
<!-- expert1_gelu_3 -->
<g id="node81" class="node">
<title>expert1_gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="12616.77" cy="-29612.76" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12616.77" y="-29624.06" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="12616.77" y="-29609.06" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12616.77" y="-29594.06" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert1_fc1_3&#45;&gt;expert1_gelu_3 -->
<g id="edge100" class="edge">
<title>expert1_fc1_3&#45;&gt;expert1_gelu_3</title>
<path fill="none" stroke="black" d="M12616.77,-29700.93C12616.77,-29687.33 12616.77,-29673.32 12616.77,-29660.62"/>
<polygon fill="black" stroke="black" points="12620.27,-29660.29 12616.77,-29650.29 12613.27,-29660.29 12620.27,-29660.29"/>
</g>
<!-- expert1_fc2_3 -->
<g id="node82" class="node">
<title>expert1_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="12920.31,-29538.28 12437.45,-29538.28 12313.23,-29402.28 12796.09,-29402.28 12920.31,-29538.28"/>
<text text-anchor="middle" x="12616.77" y="-29489.08" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="12616.77" y="-29474.08" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12616.77" y="-29459.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="12616.77" y="-29444.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_3&#45;&gt;expert1_fc2_3 -->
<g id="edge101" class="edge">
<title>expert1_gelu_3&#45;&gt;expert1_fc2_3</title>
<path fill="none" stroke="black" d="M12616.77,-29575.21C12616.77,-29566.92 12616.77,-29557.8 12616.77,-29548.51"/>
<polygon fill="black" stroke="black" points="12620.27,-29548.4 12616.77,-29538.4 12613.27,-29548.4 12620.27,-29548.4"/>
</g>
<!-- expert1_fc2_3&#45;&gt;expert_agg_3 -->
<g id="edge102" class="edge">
<title>expert1_fc2_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M12816.84,-29424.93C12854.31,-29417.06 12893.18,-29409.18 12929.77,-29402.28 13403.74,-29312.89 13961.95,-29226.11 14267.11,-29180.23"/>
<polygon fill="black" stroke="black" points="14268.04,-29183.63 14277.41,-29178.68 14267,-29176.71 14268.04,-29183.63"/>
</g>
<!-- expert2_gelu_3 -->
<g id="node84" class="node">
<title>expert2_gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13242.77" cy="-29612.76" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="13242.77" y="-29624.06" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="13242.77" y="-29609.06" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="13242.77" y="-29594.06" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert2_fc1_3&#45;&gt;expert2_gelu_3 -->
<g id="edge104" class="edge">
<title>expert2_fc1_3&#45;&gt;expert2_gelu_3</title>
<path fill="none" stroke="black" d="M13242.77,-29700.93C13242.77,-29687.33 13242.77,-29673.32 13242.77,-29660.62"/>
<polygon fill="black" stroke="black" points="13246.27,-29660.29 13242.77,-29650.29 13239.27,-29660.29 13246.27,-29660.29"/>
</g>
<!-- expert2_fc2_3 -->
<g id="node85" class="node">
<title>expert2_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="13546.31,-29538.28 13063.45,-29538.28 12939.23,-29402.28 13422.09,-29402.28 13546.31,-29538.28"/>
<text text-anchor="middle" x="13242.77" y="-29489.08" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="13242.77" y="-29474.08" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13242.77" y="-29459.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13242.77" y="-29444.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_3&#45;&gt;expert2_fc2_3 -->
<g id="edge105" class="edge">
<title>expert2_gelu_3&#45;&gt;expert2_fc2_3</title>
<path fill="none" stroke="black" d="M13242.77,-29575.21C13242.77,-29566.92 13242.77,-29557.8 13242.77,-29548.51"/>
<polygon fill="black" stroke="black" points="13246.27,-29548.4 13242.77,-29538.4 13239.27,-29548.4 13246.27,-29548.4"/>
</g>
<!-- expert2_fc2_3&#45;&gt;expert_agg_3 -->
<g id="edge106" class="edge">
<title>expert2_fc2_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M13437.71,-29419.04C13663.7,-29360.8 14035.4,-29265 14272.45,-29203.91"/>
<polygon fill="black" stroke="black" points="14273.42,-29207.27 14282.23,-29201.39 14271.67,-29200.5 14273.42,-29207.27"/>
</g>
<!-- expert3_gelu_3 -->
<g id="node87" class="node">
<title>expert3_gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="13868.77" cy="-29612.76" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="13868.77" y="-29624.06" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="13868.77" y="-29609.06" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="13868.77" y="-29594.06" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert3_fc1_3&#45;&gt;expert3_gelu_3 -->
<g id="edge108" class="edge">
<title>expert3_fc1_3&#45;&gt;expert3_gelu_3</title>
<path fill="none" stroke="black" d="M13868.77,-29700.93C13868.77,-29687.33 13868.77,-29673.32 13868.77,-29660.62"/>
<polygon fill="black" stroke="black" points="13872.27,-29660.29 13868.77,-29650.29 13865.27,-29660.29 13872.27,-29660.29"/>
</g>
<!-- expert3_fc2_3 -->
<g id="node88" class="node">
<title>expert3_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="14172.31,-29538.28 13689.45,-29538.28 13565.23,-29402.28 14048.09,-29402.28 14172.31,-29538.28"/>
<text text-anchor="middle" x="13868.77" y="-29489.08" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="13868.77" y="-29474.08" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13868.77" y="-29459.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="13868.77" y="-29444.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_3&#45;&gt;expert3_fc2_3 -->
<g id="edge109" class="edge">
<title>expert3_gelu_3&#45;&gt;expert3_fc2_3</title>
<path fill="none" stroke="black" d="M13868.77,-29575.21C13868.77,-29566.92 13868.77,-29557.8 13868.77,-29548.51"/>
<polygon fill="black" stroke="black" points="13872.27,-29548.4 13868.77,-29538.4 13865.27,-29548.4 13872.27,-29548.4"/>
</g>
<!-- expert3_fc2_3&#45;&gt;expert_agg_3 -->
<g id="edge110" class="edge">
<title>expert3_fc2_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M13998.86,-29402.23C14083.18,-29358.76 14194.8,-29301.23 14290.78,-29251.76"/>
<polygon fill="black" stroke="black" points="14292.44,-29254.84 14299.72,-29247.15 14289.23,-29248.62 14292.44,-29254.84"/>
</g>
<!-- expert4_gelu_3 -->
<g id="node90" class="node">
<title>expert4_gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="14494.77" cy="-29612.76" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14494.77" y="-29624.06" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="14494.77" y="-29609.06" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14494.77" y="-29594.06" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert4_fc1_3&#45;&gt;expert4_gelu_3 -->
<g id="edge112" class="edge">
<title>expert4_fc1_3&#45;&gt;expert4_gelu_3</title>
<path fill="none" stroke="black" d="M14494.77,-29700.93C14494.77,-29687.33 14494.77,-29673.32 14494.77,-29660.62"/>
<polygon fill="black" stroke="black" points="14498.27,-29660.29 14494.77,-29650.29 14491.27,-29660.29 14498.27,-29660.29"/>
</g>
<!-- expert4_fc2_3 -->
<g id="node91" class="node">
<title>expert4_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="14798.31,-29538.28 14315.45,-29538.28 14191.23,-29402.28 14674.09,-29402.28 14798.31,-29538.28"/>
<text text-anchor="middle" x="14494.77" y="-29489.08" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="14494.77" y="-29474.08" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14494.77" y="-29459.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="14494.77" y="-29444.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_3&#45;&gt;expert4_fc2_3 -->
<g id="edge113" class="edge">
<title>expert4_gelu_3&#45;&gt;expert4_fc2_3</title>
<path fill="none" stroke="black" d="M14494.77,-29575.21C14494.77,-29566.92 14494.77,-29557.8 14494.77,-29548.51"/>
<polygon fill="black" stroke="black" points="14498.27,-29548.4 14494.77,-29538.4 14491.27,-29548.4 14498.27,-29548.4"/>
</g>
<!-- expert4_fc2_3&#45;&gt;expert_agg_3 -->
<g id="edge114" class="edge">
<title>expert4_fc2_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M14494.77,-29402.03C14494.77,-29393.69 14494.77,-29384.83 14494.77,-29375.61"/>
<polygon fill="black" stroke="black" points="14498.27,-29375.48 14494.77,-29365.48 14491.27,-29375.48 14498.27,-29375.48"/>
</g>
<!-- expert5_gelu_3 -->
<g id="node93" class="node">
<title>expert5_gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="15120.77" cy="-29612.76" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="15120.77" y="-29624.06" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="15120.77" y="-29609.06" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="15120.77" y="-29594.06" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert5_fc1_3&#45;&gt;expert5_gelu_3 -->
<g id="edge116" class="edge">
<title>expert5_fc1_3&#45;&gt;expert5_gelu_3</title>
<path fill="none" stroke="black" d="M15120.77,-29700.93C15120.77,-29687.33 15120.77,-29673.32 15120.77,-29660.62"/>
<polygon fill="black" stroke="black" points="15124.27,-29660.29 15120.77,-29650.29 15117.27,-29660.29 15124.27,-29660.29"/>
</g>
<!-- expert5_fc2_3 -->
<g id="node94" class="node">
<title>expert5_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="15424.31,-29538.28 14941.45,-29538.28 14817.23,-29402.28 15300.09,-29402.28 15424.31,-29538.28"/>
<text text-anchor="middle" x="15120.77" y="-29489.08" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="15120.77" y="-29474.08" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="15120.77" y="-29459.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="15120.77" y="-29444.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_3&#45;&gt;expert5_fc2_3 -->
<g id="edge117" class="edge">
<title>expert5_gelu_3&#45;&gt;expert5_fc2_3</title>
<path fill="none" stroke="black" d="M15120.77,-29575.21C15120.77,-29566.92 15120.77,-29557.8 15120.77,-29548.51"/>
<polygon fill="black" stroke="black" points="15124.27,-29548.4 15120.77,-29538.4 15117.27,-29548.4 15124.27,-29548.4"/>
</g>
<!-- expert5_fc2_3&#45;&gt;expert_agg_3 -->
<g id="edge118" class="edge">
<title>expert5_fc2_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M14990.68,-29402.23C14906.35,-29358.76 14794.74,-29301.23 14698.76,-29251.76"/>
<polygon fill="black" stroke="black" points="14700.31,-29248.62 14689.81,-29247.15 14697.1,-29254.84 14700.31,-29248.62"/>
</g>
<!-- expert6_gelu_3 -->
<g id="node96" class="node">
<title>expert6_gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="15746.77" cy="-29612.76" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="15746.77" y="-29624.06" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="15746.77" y="-29609.06" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="15746.77" y="-29594.06" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert6_fc1_3&#45;&gt;expert6_gelu_3 -->
<g id="edge120" class="edge">
<title>expert6_fc1_3&#45;&gt;expert6_gelu_3</title>
<path fill="none" stroke="black" d="M15746.77,-29700.93C15746.77,-29687.33 15746.77,-29673.32 15746.77,-29660.62"/>
<polygon fill="black" stroke="black" points="15750.27,-29660.29 15746.77,-29650.29 15743.27,-29660.29 15750.27,-29660.29"/>
</g>
<!-- expert6_fc2_3 -->
<g id="node97" class="node">
<title>expert6_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="16050.31,-29538.28 15567.45,-29538.28 15443.23,-29402.28 15926.09,-29402.28 16050.31,-29538.28"/>
<text text-anchor="middle" x="15746.77" y="-29489.08" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="15746.77" y="-29474.08" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="15746.77" y="-29459.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="15746.77" y="-29444.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_3&#45;&gt;expert6_fc2_3 -->
<g id="edge121" class="edge">
<title>expert6_gelu_3&#45;&gt;expert6_fc2_3</title>
<path fill="none" stroke="black" d="M15746.77,-29575.21C15746.77,-29566.92 15746.77,-29557.8 15746.77,-29548.51"/>
<polygon fill="black" stroke="black" points="15750.27,-29548.4 15746.77,-29538.4 15743.27,-29548.4 15750.27,-29548.4"/>
</g>
<!-- expert6_fc2_3&#45;&gt;expert_agg_3 -->
<g id="edge122" class="edge">
<title>expert6_fc2_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M15486.59,-29402.23C15259.21,-29343.63 14932.63,-29259.46 14717.2,-29203.94"/>
<polygon fill="black" stroke="black" points="14717.9,-29200.5 14707.34,-29201.4 14716.15,-29207.28 14717.9,-29200.5"/>
</g>
<!-- expert7_gelu_3 -->
<g id="node99" class="node">
<title>expert7_gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="16372.77" cy="-29612.76" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="16372.77" y="-29624.06" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="16372.77" y="-29609.06" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="16372.77" y="-29594.06" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- expert7_fc1_3&#45;&gt;expert7_gelu_3 -->
<g id="edge124" class="edge">
<title>expert7_fc1_3&#45;&gt;expert7_gelu_3</title>
<path fill="none" stroke="black" d="M16372.77,-29700.93C16372.77,-29687.33 16372.77,-29673.32 16372.77,-29660.62"/>
<polygon fill="black" stroke="black" points="16376.27,-29660.29 16372.77,-29650.29 16369.27,-29660.29 16376.27,-29660.29"/>
</g>
<!-- expert7_fc2_3 -->
<g id="node100" class="node">
<title>expert7_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="16676.31,-29538.28 16193.45,-29538.28 16069.23,-29402.28 16552.09,-29402.28 16676.31,-29538.28"/>
<text text-anchor="middle" x="16372.77" y="-29489.08" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="16372.77" y="-29474.08" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="16372.77" y="-29459.08" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="16372.77" y="-29444.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_3&#45;&gt;expert7_fc2_3 -->
<g id="edge125" class="edge">
<title>expert7_gelu_3&#45;&gt;expert7_fc2_3</title>
<path fill="none" stroke="black" d="M16372.77,-29575.21C16372.77,-29566.92 16372.77,-29557.8 16372.77,-29548.51"/>
<polygon fill="black" stroke="black" points="16376.27,-29548.4 16372.77,-29538.4 16369.27,-29548.4 16376.27,-29548.4"/>
</g>
<!-- expert7_fc2_3&#45;&gt;expert_agg_3 -->
<g id="edge126" class="edge">
<title>expert7_fc2_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M16070.89,-29404.39C16067.16,-29403.68 16063.45,-29402.98 16059.77,-29402.28 15585.8,-29312.89 15027.59,-29226.11 14722.43,-29180.23"/>
<polygon fill="black" stroke="black" points="14722.54,-29176.71 14712.13,-29178.68 14721.5,-29183.63 14722.54,-29176.71"/>
</g>
<!-- expert_agg_3&#45;&gt;residual2_3 -->
<g id="edge127" class="edge">
<title>expert_agg_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M14706.19,-29085.75C14934.4,-29022.2 15290.14,-28923.16 15476.47,-28871.28"/>
<polygon fill="black" stroke="black" points="15477.61,-28874.59 15486.3,-28868.54 15475.73,-28867.85 15477.61,-28874.59"/>
</g>
<!-- comm_3 -->
<g id="node103" class="node">
<title>comm_3</title>
<polygon fill="yellow" stroke="black" points="15717.51,-28684.55 15717.51,-28718.21 15648.54,-28742 15551,-28742 15482.03,-28718.21 15482.03,-28684.55 15551,-28660.76 15648.54,-28660.76 15717.51,-28684.55"/>
<polygon fill="none" stroke="black" points="15721.5,-28681.7 15721.5,-28721.06 15649.21,-28746.01 15550.33,-28746.01 15478.04,-28721.06 15478.04,-28681.7 15550.33,-28656.75 15649.21,-28656.75 15721.5,-28681.7"/>
<text text-anchor="middle" x="15599.77" y="-28712.68" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="15599.77" y="-28697.68" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="15599.77" y="-28682.68" font-family="Times,serif" font-size="14.00">GPU2→GPU3</text>
</g>
<!-- residual2_3&#45;&gt;comm_3 -->
<g id="edge129" class="edge">
<title>residual2_3&#45;&gt;comm_3</title>
<path fill="none" stroke="black" d="M15599.77,-28782.93C15599.77,-28774.17 15599.77,-28765.07 15599.77,-28756.26"/>
<polygon fill="black" stroke="black" points="15603.27,-28756.1 15599.77,-28746.1 15596.27,-28756.1 15603.27,-28756.1"/>
</g>
<!-- ln1_4 -->
<g id="node104" class="node">
<title>ln1_4</title>
<polygon fill="lightyellow" stroke="black" points="15592.77,-28619.82 15448.77,-28619.82 15448.77,-28566.82 15592.77,-28566.82 15592.77,-28619.82"/>
<text text-anchor="middle" x="15520.77" y="-28604.62" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="15520.77" y="-28589.62" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="15520.77" y="-28574.62" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- comm_3&#45;&gt;ln1_4 -->
<g id="edge130" class="edge">
<title>comm_3&#45;&gt;ln1_4</title>
<path fill="none" stroke="black" d="M15567.18,-28656.63C15560.09,-28647.1 15552.69,-28637.17 15545.93,-28628.1"/>
<polygon fill="black" stroke="black" points="15548.72,-28625.98 15539.94,-28620.05 15543.1,-28630.16 15548.72,-28625.98"/>
</g>
<!-- residual1_4 -->
<g id="node108" class="node">
<title>residual1_4</title>
<polygon fill="lightyellow" stroke="black" points="15517.77,-28021.77 15224.77,-27968.77 15517.77,-27915.77 15810.77,-27968.77 15517.77,-28021.77"/>
<text text-anchor="middle" x="15517.77" y="-27980.07" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="15517.77" y="-27965.07" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="15517.77" y="-27950.07" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- comm_3&#45;&gt;residual1_4 -->
<g id="edge135" class="edge">
<title>comm_3&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15650.92,-28657.09C15666.1,-28639.54 15678.77,-28617.85 15678.77,-28594.32 15678.77,-28594.32 15678.77,-28594.32 15678.77,-28125.77 15678.77,-28094.7 15677.55,-28083.53 15658.77,-28058.77 15645.05,-28040.69 15626.52,-28025.34 15607.39,-28012.74"/>
<polygon fill="black" stroke="black" points="15609.2,-28009.73 15598.88,-28007.32 15605.44,-28015.64 15609.2,-28009.73"/>
<text text-anchor="middle" x="15707.77" y="-28364.62" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_4 -->
<g id="node105" class="node">
<title>qkv_proj_4</title>
<polygon fill="lightyellow" stroke="black" points="15650.31,-28529.82 15167.45,-28529.82 15043.23,-28393.82 15526.09,-28393.82 15650.31,-28529.82"/>
<text text-anchor="middle" x="15346.77" y="-28480.62" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="15346.77" y="-28465.62" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="15346.77" y="-28450.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="15346.77" y="-28435.62" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_4&#45;&gt;qkv_proj_4 -->
<g id="edge131" class="edge">
<title>ln1_4&#45;&gt;qkv_proj_4</title>
<path fill="none" stroke="black" d="M15486.39,-28566.73C15474.27,-28557.71 15459.98,-28547.07 15445.23,-28536.1"/>
<polygon fill="black" stroke="black" points="15447.12,-28533.14 15437,-28529.97 15442.94,-28538.75 15447.12,-28533.14"/>
</g>
<!-- mha_4 -->
<g id="node106" class="node">
<title>mha_4</title>
<polygon fill="lightyellow" stroke="black" points="15592.24,-28287.29 15472.5,-28342.84 15233.04,-28342.84 15113.3,-28287.29 15233.04,-28231.75 15472.5,-28231.75 15592.24,-28287.29"/>
<text text-anchor="middle" x="15352.77" y="-28306.09" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="15352.77" y="-28291.09" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="15352.77" y="-28276.09" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="15352.77" y="-28261.09" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- qkv_proj_4&#45;&gt;mha_4 -->
<g id="edge132" class="edge">
<title>qkv_proj_4&#45;&gt;mha_4</title>
<path fill="none" stroke="black" d="M15349.11,-28393.62C15349.57,-28380.41 15350.05,-28366.56 15350.5,-28353.42"/>
<polygon fill="black" stroke="black" points="15354.01,-28353.17 15350.86,-28343.05 15347.02,-28352.93 15354.01,-28353.17"/>
</g>
<!-- out_proj_4 -->
<g id="node107" class="node">
<title>out_proj_4</title>
<polygon fill="lightyellow" stroke="black" points="15650.14,-28194.77 15181.86,-28194.77 15061.39,-28058.77 15529.68,-28058.77 15650.14,-28194.77"/>
<text text-anchor="middle" x="15355.77" y="-28145.57" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="15355.77" y="-28130.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="15355.77" y="-28115.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="15355.77" y="-28100.57" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_4&#45;&gt;out_proj_4 -->
<g id="edge133" class="edge">
<title>mha_4&#45;&gt;out_proj_4</title>
<path fill="none" stroke="black" d="M15353.8,-28231.74C15353.96,-28223.15 15354.13,-28214.13 15354.3,-28205.14"/>
<polygon fill="black" stroke="black" points="15357.81,-28205.1 15354.5,-28195.04 15350.81,-28204.97 15357.81,-28205.1"/>
</g>
<!-- out_proj_4&#45;&gt;residual1_4 -->
<g id="edge134" class="edge">
<title>out_proj_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M15425.41,-28058.71C15438.6,-28046.01 15452.2,-28032.91 15464.78,-28020.8"/>
<polygon fill="black" stroke="black" points="15467.27,-28023.26 15472.05,-28013.8 15462.42,-28018.21 15467.27,-28023.26"/>
</g>
<!-- ln2_4 -->
<g id="node109" class="node">
<title>ln2_4</title>
<polygon fill="lightyellow" stroke="black" points="15276.77,-27878.77 15132.77,-27878.77 15132.77,-27825.77 15276.77,-27825.77 15276.77,-27878.77"/>
<text text-anchor="middle" x="15204.77" y="-27863.57" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="15204.77" y="-27848.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="15204.77" y="-27833.57" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge136" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M15422.58,-27932.95C15378.37,-27916.78 15326.39,-27897.76 15284.3,-27882.37"/>
<polygon fill="black" stroke="black" points="15285.25,-27878.99 15274.66,-27878.84 15282.85,-27885.56 15285.25,-27878.99"/>
</g>
<!-- residual2_4 -->
<g id="node136" class="node">
<title>residual2_4</title>
<polygon fill="lightyellow" stroke="black" points="14726.77,-26683.48 14433.77,-26630.48 14726.77,-26577.48 15019.77,-26630.48 14726.77,-26683.48"/>
<text text-anchor="middle" x="14726.77" y="-26641.78" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="14726.77" y="-26626.78" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="14726.77" y="-26611.78" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- residual1_4&#45;&gt;residual2_4 -->
<g id="edge171" class="edge">
<title>residual1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15660.99,-27941.68C15743.8,-27922.36 15831.77,-27892.58 15831.77,-27853.27 15831.77,-27853.27 15831.77,-27853.27 15831.77,-26939.15 15831.77,-26756.31 15263.21,-26677.47 14941.76,-26647.51"/>
<polygon fill="black" stroke="black" points="14941.65,-26643.99 14931.38,-26646.55 14941.01,-26650.96 14941.65,-26643.99"/>
<text text-anchor="middle" x="15860.77" y="-27466.57" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_4 -->
<g id="node110" class="node">
<title>gate_4</title>
<polygon fill="lightyellow" stroke="black" points="13771.86,-27788.77 13471.68,-27788.77 13364.77,-27682.77 13878.77,-27682.77 13771.86,-27788.77"/>
<text text-anchor="middle" x="13621.77" y="-27747.07" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="13621.77" y="-27732.07" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="13621.77" y="-27717.07" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- ln2_4&#45;&gt;gate_4 -->
<g id="edge137" class="edge">
<title>ln2_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M15132.64,-27846.05C14901.84,-27829.36 14175.86,-27776.85 13820.99,-27751.18"/>
<polygon fill="black" stroke="black" points="13821.09,-27747.68 13810.86,-27750.45 13820.59,-27754.66 13821.09,-27747.68"/>
</g>
<!-- expert0_fc1_4 -->
<g id="node111" class="node">
<title>expert0_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="11421.31,-27631.77 10938.45,-27631.77 10814.23,-27495.77 11297.09,-27495.77 11421.31,-27631.77"/>
<text text-anchor="middle" x="11117.77" y="-27582.57" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="11117.77" y="-27567.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11117.77" y="-27552.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11117.77" y="-27537.57" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_4&#45;&gt;expert0_fc1_4 -->
<g id="edge138" class="edge">
<title>gate_4&#45;&gt;expert0_fc1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13411.31,-27729.28C12939.6,-27716.27 11809.47,-27680.89 11430.77,-27631.77 11430.66,-27631.76 11430.55,-27631.74 11430.45,-27631.73"/>
<polygon fill="black" stroke="black" points="11430.76,-27628.24 11420.38,-27630.38 11429.83,-27635.18 11430.76,-27628.24"/>
<text text-anchor="middle" x="11839.27" y="-27653.57" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_4 -->
<g id="node114" class="node">
<title>expert1_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="12047.31,-27631.77 11564.45,-27631.77 11440.23,-27495.77 11923.09,-27495.77 12047.31,-27631.77"/>
<text text-anchor="middle" x="11743.77" y="-27582.57" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="11743.77" y="-27567.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11743.77" y="-27552.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11743.77" y="-27537.57" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_4&#45;&gt;expert1_fc1_4 -->
<g id="edge142" class="edge">
<title>gate_4&#45;&gt;expert1_fc1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13412.89,-27730.65C13111.91,-27722.53 12539.34,-27698.94 12056.77,-27631.77 12056.55,-27631.74 12056.32,-27631.71 12056.1,-27631.68"/>
<polygon fill="black" stroke="black" points="12056.37,-27628.18 12045.98,-27630.23 12055.38,-27635.11 12056.37,-27628.18"/>
<text text-anchor="middle" x="12357.27" y="-27653.57" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_4 -->
<g id="node117" class="node">
<title>expert2_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="12673.31,-27631.77 12190.45,-27631.77 12066.23,-27495.77 12549.09,-27495.77 12673.31,-27631.77"/>
<text text-anchor="middle" x="12369.77" y="-27582.57" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="12369.77" y="-27567.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12369.77" y="-27552.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12369.77" y="-27537.57" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_4&#45;&gt;expert2_fc1_4 -->
<g id="edge146" class="edge">
<title>gate_4&#45;&gt;expert2_fc1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13398.93,-27716.75C13208.13,-27699.79 12926.43,-27671.11 12682.77,-27631.77 12682.55,-27631.74 12682.32,-27631.7 12682.1,-27631.66"/>
<polygon fill="black" stroke="black" points="12682.45,-27628.17 12672.01,-27630 12681.31,-27635.08 12682.45,-27628.17"/>
<text text-anchor="middle" x="12933.27" y="-27653.57" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_4 -->
<g id="node120" class="node">
<title>expert3_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="13299.31,-27631.77 12816.45,-27631.77 12692.23,-27495.77 13175.09,-27495.77 13299.31,-27631.77"/>
<text text-anchor="middle" x="12995.77" y="-27582.57" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="12995.77" y="-27567.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12995.77" y="-27552.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12995.77" y="-27537.57" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_4&#45;&gt;expert3_fc1_4 -->
<g id="edge150" class="edge">
<title>gate_4&#45;&gt;expert3_fc1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13430.12,-27682.73C13374.1,-27667.52 13311.95,-27650.64 13252.59,-27634.52"/>
<polygon fill="black" stroke="black" points="13253.27,-27631.07 13242.7,-27631.83 13251.43,-27637.83 13253.27,-27631.07"/>
<text text-anchor="middle" x="13392.27" y="-27653.57" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_4 -->
<g id="node123" class="node">
<title>expert4_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="13925.31,-27631.77 13442.45,-27631.77 13318.23,-27495.77 13801.09,-27495.77 13925.31,-27631.77"/>
<text text-anchor="middle" x="13621.77" y="-27582.57" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="13621.77" y="-27567.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="13621.77" y="-27552.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13621.77" y="-27537.57" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_4&#45;&gt;expert4_fc1_4 -->
<g id="edge154" class="edge">
<title>gate_4&#45;&gt;expert4_fc1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13621.77,-27682.38C13621.77,-27669.71 13621.77,-27655.9 13621.77,-27642.34"/>
<polygon fill="black" stroke="black" points="13625.27,-27642.04 13621.77,-27632.04 13618.27,-27642.04 13625.27,-27642.04"/>
<text text-anchor="middle" x="13667.27" y="-27653.57" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_4 -->
<g id="node126" class="node">
<title>expert5_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="14551.31,-27631.77 14068.45,-27631.77 13944.23,-27495.77 14427.09,-27495.77 14551.31,-27631.77"/>
<text text-anchor="middle" x="14247.77" y="-27582.57" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="14247.77" y="-27567.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14247.77" y="-27552.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14247.77" y="-27537.57" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_4&#45;&gt;expert5_fc1_4 -->
<g id="edge158" class="edge">
<title>gate_4&#45;&gt;expert5_fc1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13813.42,-27682.73C13886.78,-27662.8 13970.67,-27640.02 14045.04,-27619.83"/>
<polygon fill="black" stroke="black" points="14046.27,-27623.12 14055,-27617.12 14044.43,-27616.36 14046.27,-27623.12"/>
<text text-anchor="middle" x="13980.27" y="-27653.57" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_4 -->
<g id="node129" class="node">
<title>expert6_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="15177.31,-27631.77 14694.45,-27631.77 14570.23,-27495.77 15053.09,-27495.77 15177.31,-27631.77"/>
<text text-anchor="middle" x="14873.77" y="-27582.57" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="14873.77" y="-27567.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14873.77" y="-27552.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14873.77" y="-27537.57" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_4&#45;&gt;expert6_fc1_4 -->
<g id="edge162" class="edge">
<title>gate_4&#45;&gt;expert6_fc1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13844.6,-27716.75C14035.4,-27699.79 14317.11,-27671.11 14560.77,-27631.77 14594.47,-27626.33 14630.03,-27619.64 14664.6,-27612.62"/>
<polygon fill="black" stroke="black" points="14665.71,-27615.96 14674.81,-27610.53 14664.31,-27609.11 14665.71,-27615.96"/>
<text text-anchor="middle" x="14479.27" y="-27653.57" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_4 -->
<g id="node132" class="node">
<title>expert7_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="15803.31,-27631.77 15320.45,-27631.77 15196.23,-27495.77 15679.09,-27495.77 15803.31,-27631.77"/>
<text text-anchor="middle" x="15499.77" y="-27582.57" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="15499.77" y="-27567.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="15499.77" y="-27552.57" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="15499.77" y="-27537.57" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_4&#45;&gt;expert7_fc1_4 -->
<g id="edge166" class="edge">
<title>gate_4&#45;&gt;expert7_fc1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13830.65,-27730.65C14131.63,-27722.53 14704.19,-27698.94 15186.77,-27631.77 15220.98,-27627.01 15257.03,-27620.61 15292.01,-27613.65"/>
<polygon fill="black" stroke="black" points="15292.73,-27617.08 15301.84,-27611.67 15291.35,-27610.21 15292.73,-27617.08"/>
<text text-anchor="middle" x="15064.27" y="-27653.57" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_4 -->
<g id="node112" class="node">
<title>expert0_gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="11117.77" cy="-27407.3" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11117.77" y="-27418.6" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="11117.77" y="-27403.6" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11117.77" y="-27388.6" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert0_fc1_4&#45;&gt;expert0_gelu_4 -->
<g id="edge139" class="edge">
<title>expert0_fc1_4&#45;&gt;expert0_gelu_4</title>
<path fill="none" stroke="black" d="M11117.77,-27495.47C11117.77,-27481.87 11117.77,-27467.86 11117.77,-27455.16"/>
<polygon fill="black" stroke="black" points="11121.27,-27454.83 11117.77,-27444.83 11114.27,-27454.83 11121.27,-27454.83"/>
</g>
<!-- expert0_fc2_4 -->
<g id="node113" class="node">
<title>expert0_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="11421.31,-27332.82 10938.45,-27332.82 10814.23,-27196.82 11297.09,-27196.82 11421.31,-27332.82"/>
<text text-anchor="middle" x="11117.77" y="-27283.62" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="11117.77" y="-27268.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11117.77" y="-27253.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11117.77" y="-27238.62" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_4&#45;&gt;expert0_fc2_4 -->
<g id="edge140" class="edge">
<title>expert0_gelu_4&#45;&gt;expert0_fc2_4</title>
<path fill="none" stroke="black" d="M11117.77,-27369.75C11117.77,-27361.46 11117.77,-27352.33 11117.77,-27343.05"/>
<polygon fill="black" stroke="black" points="11121.27,-27342.94 11117.77,-27332.94 11114.27,-27342.94 11121.27,-27342.94"/>
</g>
<!-- expert_agg_4 -->
<g id="node135" class="node">
<title>expert_agg_4</title>
<ellipse fill="lightyellow" stroke="black" cx="13621.77" cy="-26940.15" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="13621.77" cy="-26940.15" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="13621.77" y="-26951.45" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="13621.77" y="-26936.45" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="13621.77" y="-26921.45" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert0_fc2_4&#45;&gt;expert_agg_4 -->
<g id="edge141" class="edge">
<title>expert0_fc2_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M11316.76,-27218.27C11354.5,-27210.47 11393.76,-27202.93 11430.77,-27196.82 12142.32,-27079.42 12992.61,-26996.39 13392.5,-26960.7"/>
<polygon fill="black" stroke="black" points="13393.08,-26964.16 13402.73,-26959.78 13392.46,-26957.19 13393.08,-26964.16"/>
</g>
<!-- expert1_gelu_4 -->
<g id="node115" class="node">
<title>expert1_gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="11743.77" cy="-27407.3" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11743.77" y="-27418.6" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="11743.77" y="-27403.6" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11743.77" y="-27388.6" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert1_fc1_4&#45;&gt;expert1_gelu_4 -->
<g id="edge143" class="edge">
<title>expert1_fc1_4&#45;&gt;expert1_gelu_4</title>
<path fill="none" stroke="black" d="M11743.77,-27495.47C11743.77,-27481.87 11743.77,-27467.86 11743.77,-27455.16"/>
<polygon fill="black" stroke="black" points="11747.27,-27454.83 11743.77,-27444.83 11740.27,-27454.83 11747.27,-27454.83"/>
</g>
<!-- expert1_fc2_4 -->
<g id="node116" class="node">
<title>expert1_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="12047.31,-27332.82 11564.45,-27332.82 11440.23,-27196.82 11923.09,-27196.82 12047.31,-27332.82"/>
<text text-anchor="middle" x="11743.77" y="-27283.62" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="11743.77" y="-27268.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11743.77" y="-27253.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="11743.77" y="-27238.62" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_4&#45;&gt;expert1_fc2_4 -->
<g id="edge144" class="edge">
<title>expert1_gelu_4&#45;&gt;expert1_fc2_4</title>
<path fill="none" stroke="black" d="M11743.77,-27369.75C11743.77,-27361.46 11743.77,-27352.33 11743.77,-27343.05"/>
<polygon fill="black" stroke="black" points="11747.27,-27342.94 11743.77,-27332.94 11740.27,-27342.94 11747.27,-27342.94"/>
</g>
<!-- expert1_fc2_4&#45;&gt;expert_agg_4 -->
<g id="edge145" class="edge">
<title>expert1_fc2_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M11943.84,-27219.47C11981.31,-27211.6 12020.18,-27203.72 12056.77,-27196.82 12530.74,-27107.43 13088.95,-27020.65 13394.11,-26974.77"/>
<polygon fill="black" stroke="black" points="13395.04,-26978.17 13404.41,-26973.22 13394,-26971.25 13395.04,-26978.17"/>
</g>
<!-- expert2_gelu_4 -->
<g id="node118" class="node">
<title>expert2_gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="12369.77" cy="-27407.3" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12369.77" y="-27418.6" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="12369.77" y="-27403.6" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12369.77" y="-27388.6" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert2_fc1_4&#45;&gt;expert2_gelu_4 -->
<g id="edge147" class="edge">
<title>expert2_fc1_4&#45;&gt;expert2_gelu_4</title>
<path fill="none" stroke="black" d="M12369.77,-27495.47C12369.77,-27481.87 12369.77,-27467.86 12369.77,-27455.16"/>
<polygon fill="black" stroke="black" points="12373.27,-27454.83 12369.77,-27444.83 12366.27,-27454.83 12373.27,-27454.83"/>
</g>
<!-- expert2_fc2_4 -->
<g id="node119" class="node">
<title>expert2_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="12673.31,-27332.82 12190.45,-27332.82 12066.23,-27196.82 12549.09,-27196.82 12673.31,-27332.82"/>
<text text-anchor="middle" x="12369.77" y="-27283.62" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="12369.77" y="-27268.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12369.77" y="-27253.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12369.77" y="-27238.62" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_4&#45;&gt;expert2_fc2_4 -->
<g id="edge148" class="edge">
<title>expert2_gelu_4&#45;&gt;expert2_fc2_4</title>
<path fill="none" stroke="black" d="M12369.77,-27369.75C12369.77,-27361.46 12369.77,-27352.33 12369.77,-27343.05"/>
<polygon fill="black" stroke="black" points="12373.27,-27342.94 12369.77,-27332.94 12366.27,-27342.94 12373.27,-27342.94"/>
</g>
<!-- expert2_fc2_4&#45;&gt;expert_agg_4 -->
<g id="edge149" class="edge">
<title>expert2_fc2_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M12564.71,-27213.58C12790.7,-27155.34 13162.4,-27059.54 13399.45,-26998.45"/>
<polygon fill="black" stroke="black" points="13400.42,-27001.81 13409.23,-26995.93 13398.67,-26995.03 13400.42,-27001.81"/>
</g>
<!-- expert3_gelu_4 -->
<g id="node121" class="node">
<title>expert3_gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="12995.77" cy="-27407.3" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12995.77" y="-27418.6" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="12995.77" y="-27403.6" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12995.77" y="-27388.6" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert3_fc1_4&#45;&gt;expert3_gelu_4 -->
<g id="edge151" class="edge">
<title>expert3_fc1_4&#45;&gt;expert3_gelu_4</title>
<path fill="none" stroke="black" d="M12995.77,-27495.47C12995.77,-27481.87 12995.77,-27467.86 12995.77,-27455.16"/>
<polygon fill="black" stroke="black" points="12999.27,-27454.83 12995.77,-27444.83 12992.27,-27454.83 12999.27,-27454.83"/>
</g>
<!-- expert3_fc2_4 -->
<g id="node122" class="node">
<title>expert3_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="13299.31,-27332.82 12816.45,-27332.82 12692.23,-27196.82 13175.09,-27196.82 13299.31,-27332.82"/>
<text text-anchor="middle" x="12995.77" y="-27283.62" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="12995.77" y="-27268.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12995.77" y="-27253.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="12995.77" y="-27238.62" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_4&#45;&gt;expert3_fc2_4 -->
<g id="edge152" class="edge">
<title>expert3_gelu_4&#45;&gt;expert3_fc2_4</title>
<path fill="none" stroke="black" d="M12995.77,-27369.75C12995.77,-27361.46 12995.77,-27352.33 12995.77,-27343.05"/>
<polygon fill="black" stroke="black" points="12999.27,-27342.94 12995.77,-27332.94 12992.27,-27342.94 12999.27,-27342.94"/>
</g>
<!-- expert3_fc2_4&#45;&gt;expert_agg_4 -->
<g id="edge153" class="edge">
<title>expert3_fc2_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M13125.86,-27196.77C13210.18,-27153.3 13321.8,-27095.77 13417.78,-27046.3"/>
<polygon fill="black" stroke="black" points="13419.44,-27049.38 13426.72,-27041.69 13416.23,-27043.16 13419.44,-27049.38"/>
</g>
<!-- expert4_gelu_4 -->
<g id="node124" class="node">
<title>expert4_gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="13621.77" cy="-27407.3" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="13621.77" y="-27418.6" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="13621.77" y="-27403.6" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="13621.77" y="-27388.6" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert4_fc1_4&#45;&gt;expert4_gelu_4 -->
<g id="edge155" class="edge">
<title>expert4_fc1_4&#45;&gt;expert4_gelu_4</title>
<path fill="none" stroke="black" d="M13621.77,-27495.47C13621.77,-27481.87 13621.77,-27467.86 13621.77,-27455.16"/>
<polygon fill="black" stroke="black" points="13625.27,-27454.83 13621.77,-27444.83 13618.27,-27454.83 13625.27,-27454.83"/>
</g>
<!-- expert4_fc2_4 -->
<g id="node125" class="node">
<title>expert4_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="13925.31,-27332.82 13442.45,-27332.82 13318.23,-27196.82 13801.09,-27196.82 13925.31,-27332.82"/>
<text text-anchor="middle" x="13621.77" y="-27283.62" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="13621.77" y="-27268.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13621.77" y="-27253.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="13621.77" y="-27238.62" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_4&#45;&gt;expert4_fc2_4 -->
<g id="edge156" class="edge">
<title>expert4_gelu_4&#45;&gt;expert4_fc2_4</title>
<path fill="none" stroke="black" d="M13621.77,-27369.75C13621.77,-27361.46 13621.77,-27352.33 13621.77,-27343.05"/>
<polygon fill="black" stroke="black" points="13625.27,-27342.94 13621.77,-27332.94 13618.27,-27342.94 13625.27,-27342.94"/>
</g>
<!-- expert4_fc2_4&#45;&gt;expert_agg_4 -->
<g id="edge157" class="edge">
<title>expert4_fc2_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M13621.77,-27196.57C13621.77,-27188.23 13621.77,-27179.37 13621.77,-27170.15"/>
<polygon fill="black" stroke="black" points="13625.27,-27170.02 13621.77,-27160.02 13618.27,-27170.02 13625.27,-27170.02"/>
</g>
<!-- expert5_gelu_4 -->
<g id="node127" class="node">
<title>expert5_gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="14247.77" cy="-27407.3" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14247.77" y="-27418.6" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="14247.77" y="-27403.6" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14247.77" y="-27388.6" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert5_fc1_4&#45;&gt;expert5_gelu_4 -->
<g id="edge159" class="edge">
<title>expert5_fc1_4&#45;&gt;expert5_gelu_4</title>
<path fill="none" stroke="black" d="M14247.77,-27495.47C14247.77,-27481.87 14247.77,-27467.86 14247.77,-27455.16"/>
<polygon fill="black" stroke="black" points="14251.27,-27454.83 14247.77,-27444.83 14244.27,-27454.83 14251.27,-27454.83"/>
</g>
<!-- expert5_fc2_4 -->
<g id="node128" class="node">
<title>expert5_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="14551.31,-27332.82 14068.45,-27332.82 13944.23,-27196.82 14427.09,-27196.82 14551.31,-27332.82"/>
<text text-anchor="middle" x="14247.77" y="-27283.62" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="14247.77" y="-27268.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14247.77" y="-27253.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14247.77" y="-27238.62" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_4&#45;&gt;expert5_fc2_4 -->
<g id="edge160" class="edge">
<title>expert5_gelu_4&#45;&gt;expert5_fc2_4</title>
<path fill="none" stroke="black" d="M14247.77,-27369.75C14247.77,-27361.46 14247.77,-27352.33 14247.77,-27343.05"/>
<polygon fill="black" stroke="black" points="14251.27,-27342.94 14247.77,-27332.94 14244.27,-27342.94 14251.27,-27342.94"/>
</g>
<!-- expert5_fc2_4&#45;&gt;expert_agg_4 -->
<g id="edge161" class="edge">
<title>expert5_fc2_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M14117.68,-27196.77C14033.35,-27153.3 13921.74,-27095.77 13825.76,-27046.3"/>
<polygon fill="black" stroke="black" points="13827.31,-27043.16 13816.81,-27041.69 13824.1,-27049.38 13827.31,-27043.16"/>
</g>
<!-- expert6_gelu_4 -->
<g id="node130" class="node">
<title>expert6_gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="14873.77" cy="-27407.3" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14873.77" y="-27418.6" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="14873.77" y="-27403.6" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14873.77" y="-27388.6" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert6_fc1_4&#45;&gt;expert6_gelu_4 -->
<g id="edge163" class="edge">
<title>expert6_fc1_4&#45;&gt;expert6_gelu_4</title>
<path fill="none" stroke="black" d="M14873.77,-27495.47C14873.77,-27481.87 14873.77,-27467.86 14873.77,-27455.16"/>
<polygon fill="black" stroke="black" points="14877.27,-27454.83 14873.77,-27444.83 14870.27,-27454.83 14877.27,-27454.83"/>
</g>
<!-- expert6_fc2_4 -->
<g id="node131" class="node">
<title>expert6_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="15177.31,-27332.82 14694.45,-27332.82 14570.23,-27196.82 15053.09,-27196.82 15177.31,-27332.82"/>
<text text-anchor="middle" x="14873.77" y="-27283.62" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="14873.77" y="-27268.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14873.77" y="-27253.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="14873.77" y="-27238.62" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_4&#45;&gt;expert6_fc2_4 -->
<g id="edge164" class="edge">
<title>expert6_gelu_4&#45;&gt;expert6_fc2_4</title>
<path fill="none" stroke="black" d="M14873.77,-27369.75C14873.77,-27361.46 14873.77,-27352.33 14873.77,-27343.05"/>
<polygon fill="black" stroke="black" points="14877.27,-27342.94 14873.77,-27332.94 14870.27,-27342.94 14877.27,-27342.94"/>
</g>
<!-- expert6_fc2_4&#45;&gt;expert_agg_4 -->
<g id="edge165" class="edge">
<title>expert6_fc2_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M14613.59,-27196.77C14386.21,-27138.17 14059.63,-27054 13844.2,-26998.48"/>
<polygon fill="black" stroke="black" points="13844.9,-26995.04 13834.34,-26995.94 13843.15,-27001.82 13844.9,-26995.04"/>
</g>
<!-- expert7_gelu_4 -->
<g id="node133" class="node">
<title>expert7_gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="15499.77" cy="-27407.3" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="15499.77" y="-27418.6" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="15499.77" y="-27403.6" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="15499.77" y="-27388.6" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- expert7_fc1_4&#45;&gt;expert7_gelu_4 -->
<g id="edge167" class="edge">
<title>expert7_fc1_4&#45;&gt;expert7_gelu_4</title>
<path fill="none" stroke="black" d="M15499.77,-27495.47C15499.77,-27481.87 15499.77,-27467.86 15499.77,-27455.16"/>
<polygon fill="black" stroke="black" points="15503.27,-27454.83 15499.77,-27444.83 15496.27,-27454.83 15503.27,-27454.83"/>
</g>
<!-- expert7_fc2_4 -->
<g id="node134" class="node">
<title>expert7_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="15803.31,-27332.82 15320.45,-27332.82 15196.23,-27196.82 15679.09,-27196.82 15803.31,-27332.82"/>
<text text-anchor="middle" x="15499.77" y="-27283.62" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="15499.77" y="-27268.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="15499.77" y="-27253.62" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="15499.77" y="-27238.62" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_4&#45;&gt;expert7_fc2_4 -->
<g id="edge168" class="edge">
<title>expert7_gelu_4&#45;&gt;expert7_fc2_4</title>
<path fill="none" stroke="black" d="M15499.77,-27369.75C15499.77,-27361.46 15499.77,-27352.33 15499.77,-27343.05"/>
<polygon fill="black" stroke="black" points="15503.27,-27342.94 15499.77,-27332.94 15496.27,-27342.94 15503.27,-27342.94"/>
</g>
<!-- expert7_fc2_4&#45;&gt;expert_agg_4 -->
<g id="edge169" class="edge">
<title>expert7_fc2_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M15197.89,-27198.93C15194.16,-27198.22 15190.45,-27197.51 15186.77,-27196.82 14712.8,-27107.43 14154.59,-27020.65 13849.43,-26974.77"/>
<polygon fill="black" stroke="black" points="13849.54,-26971.25 13839.13,-26973.22 13848.5,-26978.17 13849.54,-26971.25"/>
</g>
<!-- expert_agg_4&#45;&gt;residual2_4 -->
<g id="edge170" class="edge">
<title>expert_agg_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M13833.19,-26880.28C14061.4,-26816.74 14417.14,-26717.7 14603.47,-26665.82"/>
<polygon fill="black" stroke="black" points="14604.61,-26669.13 14613.3,-26663.08 14602.73,-26662.39 14604.61,-26669.13"/>
</g>
<!-- comm_4 -->
<g id="node137" class="node">
<title>comm_4</title>
<polygon fill="yellow" stroke="black" points="14844.51,-26479.09 14844.51,-26512.75 14775.54,-26536.54 14678,-26536.54 14609.03,-26512.75 14609.03,-26479.09 14678,-26455.3 14775.54,-26455.3 14844.51,-26479.09"/>
<polygon fill="none" stroke="black" points="14848.5,-26476.23 14848.5,-26515.6 14776.21,-26540.55 14677.33,-26540.55 14605.04,-26515.6 14605.04,-26476.23 14677.33,-26451.29 14776.21,-26451.29 14848.5,-26476.23"/>
<text text-anchor="middle" x="14726.77" y="-26507.22" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="14726.77" y="-26492.22" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="14726.77" y="-26477.22" font-family="Times,serif" font-size="14.00">GPU3→GPU4</text>
</g>
<!-- residual2_4&#45;&gt;comm_4 -->
<g id="edge172" class="edge">
<title>residual2_4&#45;&gt;comm_4</title>
<path fill="none" stroke="black" d="M14726.77,-26577.47C14726.77,-26568.71 14726.77,-26559.6 14726.77,-26550.8"/>
<polygon fill="black" stroke="black" points="14730.27,-26550.64 14726.77,-26540.64 14723.27,-26550.64 14730.27,-26550.64"/>
</g>
<!-- ln1_5 -->
<g id="node138" class="node">
<title>ln1_5</title>
<polygon fill="lightpink" stroke="black" points="14719.77,-26414.35 14575.77,-26414.35 14575.77,-26361.35 14719.77,-26361.35 14719.77,-26414.35"/>
<text text-anchor="middle" x="14647.77" y="-26399.15" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="14647.77" y="-26384.15" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="14647.77" y="-26369.15" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- comm_4&#45;&gt;ln1_5 -->
<g id="edge173" class="edge">
<title>comm_4&#45;&gt;ln1_5</title>
<path fill="none" stroke="black" d="M14694.18,-26451.17C14687.09,-26441.64 14679.69,-26431.71 14672.93,-26422.64"/>
<polygon fill="black" stroke="black" points="14675.72,-26420.52 14666.94,-26414.59 14670.1,-26424.7 14675.72,-26420.52"/>
</g>
<!-- residual1_5 -->
<g id="node142" class="node">
<title>residual1_5</title>
<polygon fill="lightpink" stroke="black" points="14644.77,-25816.31 14351.77,-25763.31 14644.77,-25710.31 14937.77,-25763.31 14644.77,-25816.31"/>
<text text-anchor="middle" x="14644.77" y="-25774.61" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="14644.77" y="-25759.61" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="14644.77" y="-25744.61" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- comm_4&#45;&gt;residual1_5 -->
<g id="edge178" class="edge">
<title>comm_4&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14777.92,-26451.63C14793.1,-26434.08 14805.77,-26412.39 14805.77,-26388.85 14805.77,-26388.85 14805.77,-26388.85 14805.77,-25920.31 14805.77,-25889.24 14804.55,-25878.07 14785.77,-25853.31 14772.05,-25835.23 14753.52,-25819.88 14734.39,-25807.28"/>
<polygon fill="black" stroke="black" points="14736.2,-25804.27 14725.88,-25801.86 14732.44,-25810.18 14736.2,-25804.27"/>
<text text-anchor="middle" x="14834.77" y="-26159.15" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_5 -->
<g id="node139" class="node">
<title>qkv_proj_5</title>
<polygon fill="lightpink" stroke="black" points="14777.31,-26324.35 14294.45,-26324.35 14170.23,-26188.35 14653.09,-26188.35 14777.31,-26324.35"/>
<text text-anchor="middle" x="14473.77" y="-26275.15" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="14473.77" y="-26260.15" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="14473.77" y="-26245.15" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14473.77" y="-26230.15" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_5&#45;&gt;qkv_proj_5 -->
<g id="edge174" class="edge">
<title>ln1_5&#45;&gt;qkv_proj_5</title>
<path fill="none" stroke="black" d="M14613.39,-26361.27C14601.27,-26352.25 14586.98,-26341.61 14572.23,-26330.64"/>
<polygon fill="black" stroke="black" points="14574.12,-26327.68 14564,-26324.51 14569.94,-26333.29 14574.12,-26327.68"/>
</g>
<!-- mha_5 -->
<g id="node140" class="node">
<title>mha_5</title>
<polygon fill="lightpink" stroke="black" points="14719.24,-26081.83 14599.5,-26137.38 14360.04,-26137.38 14240.3,-26081.83 14360.04,-26026.29 14599.5,-26026.29 14719.24,-26081.83"/>
<text text-anchor="middle" x="14479.77" y="-26100.63" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="14479.77" y="-26085.63" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="14479.77" y="-26070.63" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14479.77" y="-26055.63" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- qkv_proj_5&#45;&gt;mha_5 -->
<g id="edge175" class="edge">
<title>qkv_proj_5&#45;&gt;mha_5</title>
<path fill="none" stroke="black" d="M14476.11,-26188.16C14476.57,-26174.95 14477.05,-26161.1 14477.5,-26147.96"/>
<polygon fill="black" stroke="black" points="14481.01,-26147.71 14477.86,-26137.59 14474.02,-26147.46 14481.01,-26147.71"/>
</g>
<!-- out_proj_5 -->
<g id="node141" class="node">
<title>out_proj_5</title>
<polygon fill="lightpink" stroke="black" points="14777.14,-25989.31 14308.86,-25989.31 14188.39,-25853.31 14656.68,-25853.31 14777.14,-25989.31"/>
<text text-anchor="middle" x="14482.77" y="-25940.11" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="14482.77" y="-25925.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14482.77" y="-25910.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14482.77" y="-25895.11" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_5&#45;&gt;out_proj_5 -->
<g id="edge176" class="edge">
<title>mha_5&#45;&gt;out_proj_5</title>
<path fill="none" stroke="black" d="M14480.8,-26026.28C14480.96,-26017.69 14481.13,-26008.67 14481.3,-25999.68"/>
<polygon fill="black" stroke="black" points="14484.81,-25999.64 14481.5,-25989.57 14477.81,-25999.51 14484.81,-25999.64"/>
</g>
<!-- out_proj_5&#45;&gt;residual1_5 -->
<g id="edge177" class="edge">
<title>out_proj_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M14552.41,-25853.25C14565.6,-25840.55 14579.2,-25827.45 14591.78,-25815.34"/>
<polygon fill="black" stroke="black" points="14594.27,-25817.79 14599.05,-25808.34 14589.42,-25812.75 14594.27,-25817.79"/>
</g>
<!-- ln2_5 -->
<g id="node143" class="node">
<title>ln2_5</title>
<polygon fill="lightpink" stroke="black" points="14403.77,-25673.31 14259.77,-25673.31 14259.77,-25620.31 14403.77,-25620.31 14403.77,-25673.31"/>
<text text-anchor="middle" x="14331.77" y="-25658.11" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="14331.77" y="-25643.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="14331.77" y="-25628.11" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge179" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M14549.58,-25727.49C14505.37,-25711.32 14453.39,-25692.3 14411.3,-25676.91"/>
<polygon fill="black" stroke="black" points="14412.25,-25673.53 14401.66,-25673.38 14409.85,-25680.1 14412.25,-25673.53"/>
</g>
<!-- residual2_5 -->
<g id="node170" class="node">
<title>residual2_5</title>
<polygon fill="lightpink" stroke="black" points="13853.77,-24478.02 13560.77,-24425.02 13853.77,-24372.02 14146.77,-24425.02 13853.77,-24478.02"/>
<text text-anchor="middle" x="13853.77" y="-24436.32" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="13853.77" y="-24421.32" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="13853.77" y="-24406.32" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- residual1_5&#45;&gt;residual2_5 -->
<g id="edge214" class="edge">
<title>residual1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M14787.99,-25736.22C14870.8,-25716.9 14958.77,-25687.12 14958.77,-25647.81 14958.77,-25647.81 14958.77,-25647.81 14958.77,-24733.69 14958.77,-24550.85 14390.21,-24472.01 14068.76,-24442.05"/>
<polygon fill="black" stroke="black" points="14068.65,-24438.52 14058.38,-24441.09 14068.01,-24445.49 14068.65,-24438.52"/>
<text text-anchor="middle" x="14987.77" y="-25261.11" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_5 -->
<g id="node144" class="node">
<title>gate_5</title>
<polygon fill="lightpink" stroke="black" points="12898.86,-25583.31 12598.68,-25583.31 12491.77,-25477.31 13005.77,-25477.31 12898.86,-25583.31"/>
<text text-anchor="middle" x="12748.77" y="-25541.61" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="12748.77" y="-25526.61" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="12748.77" y="-25511.61" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- ln2_5&#45;&gt;gate_5 -->
<g id="edge180" class="edge">
<title>ln2_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M14259.64,-25640.59C14028.84,-25623.9 13302.86,-25571.39 12947.99,-25545.72"/>
<polygon fill="black" stroke="black" points="12948.09,-25542.22 12937.86,-25544.99 12947.59,-25549.2 12948.09,-25542.22"/>
</g>
<!-- expert0_fc1_5 -->
<g id="node145" class="node">
<title>expert0_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="10548.31,-25426.31 10065.45,-25426.31 9941.23,-25290.31 10424.09,-25290.31 10548.31,-25426.31"/>
<text text-anchor="middle" x="10244.77" y="-25377.11" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="10244.77" y="-25362.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="10244.77" y="-25347.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10244.77" y="-25332.11" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_5&#45;&gt;expert0_fc1_5 -->
<g id="edge181" class="edge">
<title>gate_5&#45;&gt;expert0_fc1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12538.31,-25523.82C12066.6,-25510.81 10936.47,-25475.43 10557.77,-25426.31 10557.66,-25426.3 10557.55,-25426.28 10557.45,-25426.27"/>
<polygon fill="black" stroke="black" points="10557.76,-25422.78 10547.38,-25424.92 10556.83,-25429.72 10557.76,-25422.78"/>
<text text-anchor="middle" x="10966.27" y="-25448.11" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_5 -->
<g id="node148" class="node">
<title>expert1_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="11174.31,-25426.31 10691.45,-25426.31 10567.23,-25290.31 11050.09,-25290.31 11174.31,-25426.31"/>
<text text-anchor="middle" x="10870.77" y="-25377.11" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="10870.77" y="-25362.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="10870.77" y="-25347.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10870.77" y="-25332.11" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_5&#45;&gt;expert1_fc1_5 -->
<g id="edge185" class="edge">
<title>gate_5&#45;&gt;expert1_fc1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12539.89,-25525.19C12238.91,-25517.07 11666.34,-25493.48 11183.77,-25426.31 11183.55,-25426.28 11183.32,-25426.25 11183.1,-25426.22"/>
<polygon fill="black" stroke="black" points="11183.37,-25422.72 11172.98,-25424.77 11182.38,-25429.65 11183.37,-25422.72"/>
<text text-anchor="middle" x="11484.27" y="-25448.11" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_5 -->
<g id="node151" class="node">
<title>expert2_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="11800.31,-25426.31 11317.45,-25426.31 11193.23,-25290.31 11676.09,-25290.31 11800.31,-25426.31"/>
<text text-anchor="middle" x="11496.77" y="-25377.11" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="11496.77" y="-25362.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11496.77" y="-25347.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11496.77" y="-25332.11" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_5&#45;&gt;expert2_fc1_5 -->
<g id="edge189" class="edge">
<title>gate_5&#45;&gt;expert2_fc1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12525.93,-25511.29C12335.13,-25494.33 12053.43,-25465.65 11809.77,-25426.31 11809.55,-25426.28 11809.32,-25426.24 11809.1,-25426.2"/>
<polygon fill="black" stroke="black" points="11809.45,-25422.71 11799.01,-25424.54 11808.31,-25429.62 11809.45,-25422.71"/>
<text text-anchor="middle" x="12060.27" y="-25448.11" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_5 -->
<g id="node154" class="node">
<title>expert3_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="12426.31,-25426.31 11943.45,-25426.31 11819.23,-25290.31 12302.09,-25290.31 12426.31,-25426.31"/>
<text text-anchor="middle" x="12122.77" y="-25377.11" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="12122.77" y="-25362.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12122.77" y="-25347.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12122.77" y="-25332.11" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_5&#45;&gt;expert3_fc1_5 -->
<g id="edge193" class="edge">
<title>gate_5&#45;&gt;expert3_fc1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12557.12,-25477.27C12501.1,-25462.05 12438.95,-25445.18 12379.59,-25429.05"/>
<polygon fill="black" stroke="black" points="12380.27,-25425.61 12369.7,-25426.37 12378.43,-25432.37 12380.27,-25425.61"/>
<text text-anchor="middle" x="12519.27" y="-25448.11" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_5 -->
<g id="node157" class="node">
<title>expert4_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="13052.31,-25426.31 12569.45,-25426.31 12445.23,-25290.31 12928.09,-25290.31 13052.31,-25426.31"/>
<text text-anchor="middle" x="12748.77" y="-25377.11" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="12748.77" y="-25362.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12748.77" y="-25347.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12748.77" y="-25332.11" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_5&#45;&gt;expert4_fc1_5 -->
<g id="edge197" class="edge">
<title>gate_5&#45;&gt;expert4_fc1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12748.77,-25476.92C12748.77,-25464.25 12748.77,-25450.44 12748.77,-25436.88"/>
<polygon fill="black" stroke="black" points="12752.27,-25436.58 12748.77,-25426.58 12745.27,-25436.58 12752.27,-25436.58"/>
<text text-anchor="middle" x="12794.27" y="-25448.11" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_5 -->
<g id="node160" class="node">
<title>expert5_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="13678.31,-25426.31 13195.45,-25426.31 13071.23,-25290.31 13554.09,-25290.31 13678.31,-25426.31"/>
<text text-anchor="middle" x="13374.77" y="-25377.11" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="13374.77" y="-25362.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="13374.77" y="-25347.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13374.77" y="-25332.11" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_5&#45;&gt;expert5_fc1_5 -->
<g id="edge201" class="edge">
<title>gate_5&#45;&gt;expert5_fc1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12940.42,-25477.27C13013.78,-25457.34 13097.67,-25434.56 13172.04,-25414.37"/>
<polygon fill="black" stroke="black" points="13173.27,-25417.66 13182,-25411.66 13171.43,-25410.9 13173.27,-25417.66"/>
<text text-anchor="middle" x="13107.27" y="-25448.11" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_5 -->
<g id="node163" class="node">
<title>expert6_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="14304.31,-25426.31 13821.45,-25426.31 13697.23,-25290.31 14180.09,-25290.31 14304.31,-25426.31"/>
<text text-anchor="middle" x="14000.77" y="-25377.11" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="14000.77" y="-25362.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14000.77" y="-25347.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14000.77" y="-25332.11" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_5&#45;&gt;expert6_fc1_5 -->
<g id="edge205" class="edge">
<title>gate_5&#45;&gt;expert6_fc1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12971.6,-25511.29C13162.4,-25494.33 13444.11,-25465.65 13687.77,-25426.31 13721.47,-25420.87 13757.03,-25414.18 13791.6,-25407.16"/>
<polygon fill="black" stroke="black" points="13792.71,-25410.5 13801.81,-25405.07 13791.31,-25403.65 13792.71,-25410.5"/>
<text text-anchor="middle" x="13606.27" y="-25448.11" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_5 -->
<g id="node166" class="node">
<title>expert7_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="14930.31,-25426.31 14447.45,-25426.31 14323.23,-25290.31 14806.09,-25290.31 14930.31,-25426.31"/>
<text text-anchor="middle" x="14626.77" y="-25377.11" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="14626.77" y="-25362.11" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="14626.77" y="-25347.11" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14626.77" y="-25332.11" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_5&#45;&gt;expert7_fc1_5 -->
<g id="edge209" class="edge">
<title>gate_5&#45;&gt;expert7_fc1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12957.65,-25525.19C13258.63,-25517.07 13831.19,-25493.48 14313.77,-25426.31 14347.98,-25421.55 14384.03,-25415.15 14419.01,-25408.19"/>
<polygon fill="black" stroke="black" points="14419.73,-25411.61 14428.84,-25406.21 14418.35,-25404.75 14419.73,-25411.61"/>
<text text-anchor="middle" x="14191.27" y="-25448.11" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_5 -->
<g id="node146" class="node">
<title>expert0_gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="10244.77" cy="-25201.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="10244.77" y="-25213.13" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="10244.77" y="-25198.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="10244.77" y="-25183.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert0_fc1_5&#45;&gt;expert0_gelu_5 -->
<g id="edge182" class="edge">
<title>expert0_fc1_5&#45;&gt;expert0_gelu_5</title>
<path fill="none" stroke="black" d="M10244.77,-25290.01C10244.77,-25276.41 10244.77,-25262.4 10244.77,-25249.7"/>
<polygon fill="black" stroke="black" points="10248.27,-25249.37 10244.77,-25239.37 10241.27,-25249.37 10248.27,-25249.37"/>
</g>
<!-- expert0_fc2_5 -->
<g id="node147" class="node">
<title>expert0_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="10548.31,-25127.36 10065.45,-25127.36 9941.23,-24991.36 10424.09,-24991.36 10548.31,-25127.36"/>
<text text-anchor="middle" x="10244.77" y="-25078.16" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="10244.77" y="-25063.16" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10244.77" y="-25048.16" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10244.77" y="-25033.16" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_5&#45;&gt;expert0_fc2_5 -->
<g id="edge183" class="edge">
<title>expert0_gelu_5&#45;&gt;expert0_fc2_5</title>
<path fill="none" stroke="black" d="M10244.77,-25164.29C10244.77,-25155.99 10244.77,-25146.87 10244.77,-25137.59"/>
<polygon fill="black" stroke="black" points="10248.27,-25137.48 10244.77,-25127.48 10241.27,-25137.48 10248.27,-25137.48"/>
</g>
<!-- expert_agg_5 -->
<g id="node169" class="node">
<title>expert_agg_5</title>
<ellipse fill="lightpink" stroke="black" cx="12748.77" cy="-24734.69" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="12748.77" cy="-24734.69" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="12748.77" y="-24745.99" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="12748.77" y="-24730.99" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="12748.77" y="-24715.99" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert0_fc2_5&#45;&gt;expert_agg_5 -->
<g id="edge184" class="edge">
<title>expert0_fc2_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M10443.76,-25012.81C10481.5,-25005.01 10520.76,-24997.46 10557.77,-24991.36 11269.32,-24873.96 12119.61,-24790.93 12519.5,-24755.24"/>
<polygon fill="black" stroke="black" points="12520.08,-24758.7 12529.73,-24754.32 12519.46,-24751.73 12520.08,-24758.7"/>
</g>
<!-- expert1_gelu_5 -->
<g id="node149" class="node">
<title>expert1_gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="10870.77" cy="-25201.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="10870.77" y="-25213.13" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="10870.77" y="-25198.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="10870.77" y="-25183.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert1_fc1_5&#45;&gt;expert1_gelu_5 -->
<g id="edge186" class="edge">
<title>expert1_fc1_5&#45;&gt;expert1_gelu_5</title>
<path fill="none" stroke="black" d="M10870.77,-25290.01C10870.77,-25276.41 10870.77,-25262.4 10870.77,-25249.7"/>
<polygon fill="black" stroke="black" points="10874.27,-25249.37 10870.77,-25239.37 10867.27,-25249.37 10874.27,-25249.37"/>
</g>
<!-- expert1_fc2_5 -->
<g id="node150" class="node">
<title>expert1_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="11174.31,-25127.36 10691.45,-25127.36 10567.23,-24991.36 11050.09,-24991.36 11174.31,-25127.36"/>
<text text-anchor="middle" x="10870.77" y="-25078.16" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="10870.77" y="-25063.16" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10870.77" y="-25048.16" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="10870.77" y="-25033.16" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_5&#45;&gt;expert1_fc2_5 -->
<g id="edge187" class="edge">
<title>expert1_gelu_5&#45;&gt;expert1_fc2_5</title>
<path fill="none" stroke="black" d="M10870.77,-25164.29C10870.77,-25155.99 10870.77,-25146.87 10870.77,-25137.59"/>
<polygon fill="black" stroke="black" points="10874.27,-25137.48 10870.77,-25127.48 10867.27,-25137.48 10874.27,-25137.48"/>
</g>
<!-- expert1_fc2_5&#45;&gt;expert_agg_5 -->
<g id="edge188" class="edge">
<title>expert1_fc2_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M11070.84,-25014.01C11108.31,-25006.14 11147.18,-24998.26 11183.77,-24991.36 11657.74,-24901.97 12215.95,-24815.19 12521.11,-24769.31"/>
<polygon fill="black" stroke="black" points="12522.04,-24772.71 12531.41,-24767.76 12521,-24765.79 12522.04,-24772.71"/>
</g>
<!-- expert2_gelu_5 -->
<g id="node152" class="node">
<title>expert2_gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="11496.77" cy="-25201.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11496.77" y="-25213.13" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="11496.77" y="-25198.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11496.77" y="-25183.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert2_fc1_5&#45;&gt;expert2_gelu_5 -->
<g id="edge190" class="edge">
<title>expert2_fc1_5&#45;&gt;expert2_gelu_5</title>
<path fill="none" stroke="black" d="M11496.77,-25290.01C11496.77,-25276.41 11496.77,-25262.4 11496.77,-25249.7"/>
<polygon fill="black" stroke="black" points="11500.27,-25249.37 11496.77,-25239.37 11493.27,-25249.37 11500.27,-25249.37"/>
</g>
<!-- expert2_fc2_5 -->
<g id="node153" class="node">
<title>expert2_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="11800.31,-25127.36 11317.45,-25127.36 11193.23,-24991.36 11676.09,-24991.36 11800.31,-25127.36"/>
<text text-anchor="middle" x="11496.77" y="-25078.16" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="11496.77" y="-25063.16" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11496.77" y="-25048.16" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="11496.77" y="-25033.16" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_5&#45;&gt;expert2_fc2_5 -->
<g id="edge191" class="edge">
<title>expert2_gelu_5&#45;&gt;expert2_fc2_5</title>
<path fill="none" stroke="black" d="M11496.77,-25164.29C11496.77,-25155.99 11496.77,-25146.87 11496.77,-25137.59"/>
<polygon fill="black" stroke="black" points="11500.27,-25137.48 11496.77,-25127.48 11493.27,-25137.48 11500.27,-25137.48"/>
</g>
<!-- expert2_fc2_5&#45;&gt;expert_agg_5 -->
<g id="edge192" class="edge">
<title>expert2_fc2_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M11691.71,-25008.12C11917.7,-24949.87 12289.4,-24854.08 12526.45,-24792.99"/>
<polygon fill="black" stroke="black" points="12527.42,-24796.35 12536.23,-24790.47 12525.67,-24789.57 12527.42,-24796.35"/>
</g>
<!-- expert3_gelu_5 -->
<g id="node155" class="node">
<title>expert3_gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="12122.77" cy="-25201.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12122.77" y="-25213.13" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="12122.77" y="-25198.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12122.77" y="-25183.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert3_fc1_5&#45;&gt;expert3_gelu_5 -->
<g id="edge194" class="edge">
<title>expert3_fc1_5&#45;&gt;expert3_gelu_5</title>
<path fill="none" stroke="black" d="M12122.77,-25290.01C12122.77,-25276.41 12122.77,-25262.4 12122.77,-25249.7"/>
<polygon fill="black" stroke="black" points="12126.27,-25249.37 12122.77,-25239.37 12119.27,-25249.37 12126.27,-25249.37"/>
</g>
<!-- expert3_fc2_5 -->
<g id="node156" class="node">
<title>expert3_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="12426.31,-25127.36 11943.45,-25127.36 11819.23,-24991.36 12302.09,-24991.36 12426.31,-25127.36"/>
<text text-anchor="middle" x="12122.77" y="-25078.16" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="12122.77" y="-25063.16" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12122.77" y="-25048.16" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12122.77" y="-25033.16" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_5&#45;&gt;expert3_fc2_5 -->
<g id="edge195" class="edge">
<title>expert3_gelu_5&#45;&gt;expert3_fc2_5</title>
<path fill="none" stroke="black" d="M12122.77,-25164.29C12122.77,-25155.99 12122.77,-25146.87 12122.77,-25137.59"/>
<polygon fill="black" stroke="black" points="12126.27,-25137.48 12122.77,-25127.48 12119.27,-25137.48 12126.27,-25137.48"/>
</g>
<!-- expert3_fc2_5&#45;&gt;expert_agg_5 -->
<g id="edge196" class="edge">
<title>expert3_fc2_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M12252.86,-24991.31C12337.18,-24947.84 12448.8,-24890.31 12544.78,-24840.83"/>
<polygon fill="black" stroke="black" points="12546.44,-24843.92 12553.72,-24836.22 12543.23,-24837.7 12546.44,-24843.92"/>
</g>
<!-- expert4_gelu_5 -->
<g id="node158" class="node">
<title>expert4_gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="12748.77" cy="-25201.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12748.77" y="-25213.13" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="12748.77" y="-25198.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12748.77" y="-25183.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert4_fc1_5&#45;&gt;expert4_gelu_5 -->
<g id="edge198" class="edge">
<title>expert4_fc1_5&#45;&gt;expert4_gelu_5</title>
<path fill="none" stroke="black" d="M12748.77,-25290.01C12748.77,-25276.41 12748.77,-25262.4 12748.77,-25249.7"/>
<polygon fill="black" stroke="black" points="12752.27,-25249.37 12748.77,-25239.37 12745.27,-25249.37 12752.27,-25249.37"/>
</g>
<!-- expert4_fc2_5 -->
<g id="node159" class="node">
<title>expert4_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="13052.31,-25127.36 12569.45,-25127.36 12445.23,-24991.36 12928.09,-24991.36 13052.31,-25127.36"/>
<text text-anchor="middle" x="12748.77" y="-25078.16" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="12748.77" y="-25063.16" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12748.77" y="-25048.16" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="12748.77" y="-25033.16" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_5&#45;&gt;expert4_fc2_5 -->
<g id="edge199" class="edge">
<title>expert4_gelu_5&#45;&gt;expert4_fc2_5</title>
<path fill="none" stroke="black" d="M12748.77,-25164.29C12748.77,-25155.99 12748.77,-25146.87 12748.77,-25137.59"/>
<polygon fill="black" stroke="black" points="12752.27,-25137.48 12748.77,-25127.48 12745.27,-25137.48 12752.27,-25137.48"/>
</g>
<!-- expert4_fc2_5&#45;&gt;expert_agg_5 -->
<g id="edge200" class="edge">
<title>expert4_fc2_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M12748.77,-24991.11C12748.77,-24982.77 12748.77,-24973.91 12748.77,-24964.69"/>
<polygon fill="black" stroke="black" points="12752.27,-24964.56 12748.77,-24954.56 12745.27,-24964.56 12752.27,-24964.56"/>
</g>
<!-- expert5_gelu_5 -->
<g id="node161" class="node">
<title>expert5_gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="13374.77" cy="-25201.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="13374.77" y="-25213.13" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="13374.77" y="-25198.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="13374.77" y="-25183.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert5_fc1_5&#45;&gt;expert5_gelu_5 -->
<g id="edge202" class="edge">
<title>expert5_fc1_5&#45;&gt;expert5_gelu_5</title>
<path fill="none" stroke="black" d="M13374.77,-25290.01C13374.77,-25276.41 13374.77,-25262.4 13374.77,-25249.7"/>
<polygon fill="black" stroke="black" points="13378.27,-25249.37 13374.77,-25239.37 13371.27,-25249.37 13378.27,-25249.37"/>
</g>
<!-- expert5_fc2_5 -->
<g id="node162" class="node">
<title>expert5_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="13678.31,-25127.36 13195.45,-25127.36 13071.23,-24991.36 13554.09,-24991.36 13678.31,-25127.36"/>
<text text-anchor="middle" x="13374.77" y="-25078.16" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="13374.77" y="-25063.16" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13374.77" y="-25048.16" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="13374.77" y="-25033.16" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_5&#45;&gt;expert5_fc2_5 -->
<g id="edge203" class="edge">
<title>expert5_gelu_5&#45;&gt;expert5_fc2_5</title>
<path fill="none" stroke="black" d="M13374.77,-25164.29C13374.77,-25155.99 13374.77,-25146.87 13374.77,-25137.59"/>
<polygon fill="black" stroke="black" points="13378.27,-25137.48 13374.77,-25127.48 13371.27,-25137.48 13378.27,-25137.48"/>
</g>
<!-- expert5_fc2_5&#45;&gt;expert_agg_5 -->
<g id="edge204" class="edge">
<title>expert5_fc2_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M13244.68,-24991.31C13160.35,-24947.84 13048.74,-24890.31 12952.76,-24840.83"/>
<polygon fill="black" stroke="black" points="12954.31,-24837.7 12943.81,-24836.22 12951.1,-24843.92 12954.31,-24837.7"/>
</g>
<!-- expert6_gelu_5 -->
<g id="node164" class="node">
<title>expert6_gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="14000.77" cy="-25201.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14000.77" y="-25213.13" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="14000.77" y="-25198.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14000.77" y="-25183.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert6_fc1_5&#45;&gt;expert6_gelu_5 -->
<g id="edge206" class="edge">
<title>expert6_fc1_5&#45;&gt;expert6_gelu_5</title>
<path fill="none" stroke="black" d="M14000.77,-25290.01C14000.77,-25276.41 14000.77,-25262.4 14000.77,-25249.7"/>
<polygon fill="black" stroke="black" points="14004.27,-25249.37 14000.77,-25239.37 13997.27,-25249.37 14004.27,-25249.37"/>
</g>
<!-- expert6_fc2_5 -->
<g id="node165" class="node">
<title>expert6_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="14304.31,-25127.36 13821.45,-25127.36 13697.23,-24991.36 14180.09,-24991.36 14304.31,-25127.36"/>
<text text-anchor="middle" x="14000.77" y="-25078.16" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="14000.77" y="-25063.16" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14000.77" y="-25048.16" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14000.77" y="-25033.16" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_5&#45;&gt;expert6_fc2_5 -->
<g id="edge207" class="edge">
<title>expert6_gelu_5&#45;&gt;expert6_fc2_5</title>
<path fill="none" stroke="black" d="M14000.77,-25164.29C14000.77,-25155.99 14000.77,-25146.87 14000.77,-25137.59"/>
<polygon fill="black" stroke="black" points="14004.27,-25137.48 14000.77,-25127.48 13997.27,-25137.48 14004.27,-25137.48"/>
</g>
<!-- expert6_fc2_5&#45;&gt;expert_agg_5 -->
<g id="edge208" class="edge">
<title>expert6_fc2_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M13740.59,-24991.31C13513.21,-24932.7 13186.63,-24848.54 12971.2,-24793.01"/>
<polygon fill="black" stroke="black" points="12971.9,-24789.58 12961.34,-24790.48 12970.15,-24796.36 12971.9,-24789.58"/>
</g>
<!-- expert7_gelu_5 -->
<g id="node167" class="node">
<title>expert7_gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="14626.77" cy="-25201.83" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="14626.77" y="-25213.13" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="14626.77" y="-25198.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="14626.77" y="-25183.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- expert7_fc1_5&#45;&gt;expert7_gelu_5 -->
<g id="edge210" class="edge">
<title>expert7_fc1_5&#45;&gt;expert7_gelu_5</title>
<path fill="none" stroke="black" d="M14626.77,-25290.01C14626.77,-25276.41 14626.77,-25262.4 14626.77,-25249.7"/>
<polygon fill="black" stroke="black" points="14630.27,-25249.37 14626.77,-25239.37 14623.27,-25249.37 14630.27,-25249.37"/>
</g>
<!-- expert7_fc2_5 -->
<g id="node168" class="node">
<title>expert7_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="14930.31,-25127.36 14447.45,-25127.36 14323.23,-24991.36 14806.09,-24991.36 14930.31,-25127.36"/>
<text text-anchor="middle" x="14626.77" y="-25078.16" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="14626.77" y="-25063.16" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="14626.77" y="-25048.16" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="14626.77" y="-25033.16" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_5&#45;&gt;expert7_fc2_5 -->
<g id="edge211" class="edge">
<title>expert7_gelu_5&#45;&gt;expert7_fc2_5</title>
<path fill="none" stroke="black" d="M14626.77,-25164.29C14626.77,-25155.99 14626.77,-25146.87 14626.77,-25137.59"/>
<polygon fill="black" stroke="black" points="14630.27,-25137.48 14626.77,-25127.48 14623.27,-25137.48 14630.27,-25137.48"/>
</g>
<!-- expert7_fc2_5&#45;&gt;expert_agg_5 -->
<g id="edge212" class="edge">
<title>expert7_fc2_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M14324.89,-24993.47C14321.16,-24992.76 14317.45,-24992.05 14313.77,-24991.36 13839.8,-24901.97 13281.59,-24815.19 12976.43,-24769.31"/>
<polygon fill="black" stroke="black" points="12976.54,-24765.79 12966.13,-24767.76 12975.5,-24772.71 12976.54,-24765.79"/>
</g>
<!-- expert_agg_5&#45;&gt;residual2_5 -->
<g id="edge213" class="edge">
<title>expert_agg_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M12960.19,-24674.82C13188.4,-24611.28 13544.14,-24512.23 13730.47,-24460.35"/>
<polygon fill="black" stroke="black" points="13731.61,-24463.67 13740.3,-24457.62 13729.73,-24456.93 13731.61,-24463.67"/>
</g>
<!-- comm_5 -->
<g id="node171" class="node">
<title>comm_5</title>
<polygon fill="yellow" stroke="black" points="13971.51,-24273.63 13971.51,-24307.29 13902.54,-24331.08 13805,-24331.08 13736.03,-24307.29 13736.03,-24273.63 13805,-24249.84 13902.54,-24249.84 13971.51,-24273.63"/>
<polygon fill="none" stroke="black" points="13975.5,-24270.77 13975.5,-24310.14 13903.21,-24335.09 13804.33,-24335.09 13732.04,-24310.14 13732.04,-24270.77 13804.33,-24245.83 13903.21,-24245.83 13975.5,-24270.77"/>
<text text-anchor="middle" x="13853.77" y="-24301.76" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="13853.77" y="-24286.76" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="13853.77" y="-24271.76" font-family="Times,serif" font-size="14.00">GPU4→GPU5</text>
</g>
<!-- residual2_5&#45;&gt;comm_5 -->
<g id="edge215" class="edge">
<title>residual2_5&#45;&gt;comm_5</title>
<path fill="none" stroke="black" d="M13853.77,-24372.01C13853.77,-24363.25 13853.77,-24354.14 13853.77,-24345.34"/>
<polygon fill="black" stroke="black" points="13857.27,-24345.18 13853.77,-24335.18 13850.27,-24345.18 13857.27,-24345.18"/>
</g>
<!-- ln1_6 -->
<g id="node172" class="node">
<title>ln1_6</title>
<polygon fill="lightcyan" stroke="black" points="13846.77,-24208.89 13702.77,-24208.89 13702.77,-24155.89 13846.77,-24155.89 13846.77,-24208.89"/>
<text text-anchor="middle" x="13774.77" y="-24193.69" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="13774.77" y="-24178.69" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="13774.77" y="-24163.69" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- comm_5&#45;&gt;ln1_6 -->
<g id="edge216" class="edge">
<title>comm_5&#45;&gt;ln1_6</title>
<path fill="none" stroke="black" d="M13821.18,-24245.71C13814.09,-24236.18 13806.69,-24226.24 13799.93,-24217.18"/>
<polygon fill="black" stroke="black" points="13802.72,-24215.06 13793.94,-24209.13 13797.1,-24219.24 13802.72,-24215.06"/>
</g>
<!-- residual1_6 -->
<g id="node176" class="node">
<title>residual1_6</title>
<polygon fill="lightcyan" stroke="black" points="13771.77,-23610.85 13478.77,-23557.85 13771.77,-23504.85 14064.77,-23557.85 13771.77,-23610.85"/>
<text text-anchor="middle" x="13771.77" y="-23569.15" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="13771.77" y="-23554.15" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="13771.77" y="-23539.15" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- comm_5&#45;&gt;residual1_6 -->
<g id="edge221" class="edge">
<title>comm_5&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13904.92,-24246.17C13920.1,-24228.62 13932.77,-24206.93 13932.77,-24183.39 13932.77,-24183.39 13932.77,-24183.39 13932.77,-23714.85 13932.77,-23683.77 13931.55,-23672.61 13912.77,-23647.85 13899.05,-23629.77 13880.52,-23614.42 13861.39,-23601.81"/>
<polygon fill="black" stroke="black" points="13863.2,-23598.81 13852.88,-23596.4 13859.44,-23604.72 13863.2,-23598.81"/>
<text text-anchor="middle" x="13961.77" y="-23953.69" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_6 -->
<g id="node173" class="node">
<title>qkv_proj_6</title>
<polygon fill="lightcyan" stroke="black" points="13904.31,-24118.89 13421.45,-24118.89 13297.23,-23982.89 13780.09,-23982.89 13904.31,-24118.89"/>
<text text-anchor="middle" x="13600.77" y="-24069.69" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="13600.77" y="-24054.69" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="13600.77" y="-24039.69" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13600.77" y="-24024.69" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_6&#45;&gt;qkv_proj_6 -->
<g id="edge217" class="edge">
<title>ln1_6&#45;&gt;qkv_proj_6</title>
<path fill="none" stroke="black" d="M13740.39,-24155.81C13728.27,-24146.79 13713.98,-24136.15 13699.23,-24125.17"/>
<polygon fill="black" stroke="black" points="13701.12,-24122.21 13691,-24119.05 13696.94,-24127.83 13701.12,-24122.21"/>
</g>
<!-- mha_6 -->
<g id="node174" class="node">
<title>mha_6</title>
<polygon fill="lightcyan" stroke="black" points="13846.24,-23876.37 13726.5,-23931.92 13487.04,-23931.92 13367.3,-23876.37 13487.04,-23820.83 13726.5,-23820.83 13846.24,-23876.37"/>
<text text-anchor="middle" x="13606.77" y="-23895.17" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="13606.77" y="-23880.17" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="13606.77" y="-23865.17" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13606.77" y="-23850.17" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- qkv_proj_6&#45;&gt;mha_6 -->
<g id="edge218" class="edge">
<title>qkv_proj_6&#45;&gt;mha_6</title>
<path fill="none" stroke="black" d="M13603.11,-23982.7C13603.57,-23969.48 13604.05,-23955.64 13604.5,-23942.5"/>
<polygon fill="black" stroke="black" points="13608.01,-23942.25 13604.86,-23932.13 13601.02,-23942 13608.01,-23942.25"/>
</g>
<!-- out_proj_6 -->
<g id="node175" class="node">
<title>out_proj_6</title>
<polygon fill="lightcyan" stroke="black" points="13904.14,-23783.85 13435.86,-23783.85 13315.39,-23647.85 13783.68,-23647.85 13904.14,-23783.85"/>
<text text-anchor="middle" x="13609.77" y="-23734.65" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="13609.77" y="-23719.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13609.77" y="-23704.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13609.77" y="-23689.65" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_6&#45;&gt;out_proj_6 -->
<g id="edge219" class="edge">
<title>mha_6&#45;&gt;out_proj_6</title>
<path fill="none" stroke="black" d="M13607.8,-23820.82C13607.96,-23812.23 13608.13,-23803.21 13608.3,-23794.22"/>
<polygon fill="black" stroke="black" points="13611.81,-23794.18 13608.5,-23784.11 13604.81,-23794.05 13611.81,-23794.18"/>
</g>
<!-- out_proj_6&#45;&gt;residual1_6 -->
<g id="edge220" class="edge">
<title>out_proj_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M13679.41,-23647.79C13692.6,-23635.09 13706.2,-23621.99 13718.78,-23609.88"/>
<polygon fill="black" stroke="black" points="13721.27,-23612.33 13726.05,-23602.88 13716.42,-23607.29 13721.27,-23612.33"/>
</g>
<!-- ln2_6 -->
<g id="node177" class="node">
<title>ln2_6</title>
<polygon fill="lightcyan" stroke="black" points="13530.77,-23467.85 13386.77,-23467.85 13386.77,-23414.85 13530.77,-23414.85 13530.77,-23467.85"/>
<text text-anchor="middle" x="13458.77" y="-23452.65" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="13458.77" y="-23437.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="13458.77" y="-23422.65" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge222" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M13676.58,-23522.03C13632.37,-23505.85 13580.39,-23486.84 13538.3,-23471.45"/>
<polygon fill="black" stroke="black" points="13539.25,-23468.07 13528.66,-23467.92 13536.85,-23474.64 13539.25,-23468.07"/>
</g>
<!-- residual2_6 -->
<g id="node204" class="node">
<title>residual2_6</title>
<polygon fill="lightcyan" stroke="black" points="12980.77,-22272.56 12687.77,-22219.56 12980.77,-22166.56 13273.77,-22219.56 12980.77,-22272.56"/>
<text text-anchor="middle" x="12980.77" y="-22230.86" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="12980.77" y="-22215.86" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="12980.77" y="-22200.86" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- residual1_6&#45;&gt;residual2_6 -->
<g id="edge257" class="edge">
<title>residual1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13914.99,-23530.76C13997.8,-23511.44 14085.77,-23481.66 14085.77,-23442.35 14085.77,-23442.35 14085.77,-23442.35 14085.77,-22528.23 14085.77,-22345.39 13517.21,-22266.55 13195.76,-22236.59"/>
<polygon fill="black" stroke="black" points="13195.65,-22233.06 13185.38,-22235.63 13195.01,-22240.03 13195.65,-22233.06"/>
<text text-anchor="middle" x="14114.77" y="-23055.65" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_6 -->
<g id="node178" class="node">
<title>gate_6</title>
<polygon fill="lightcyan" stroke="black" points="12025.86,-23377.85 11725.68,-23377.85 11618.77,-23271.85 12132.77,-23271.85 12025.86,-23377.85"/>
<text text-anchor="middle" x="11875.77" y="-23336.15" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="11875.77" y="-23321.15" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="11875.77" y="-23306.15" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- ln2_6&#45;&gt;gate_6 -->
<g id="edge223" class="edge">
<title>ln2_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M13386.64,-23435.13C13155.84,-23418.44 12429.86,-23365.93 12074.99,-23340.26"/>
<polygon fill="black" stroke="black" points="12075.09,-23336.76 12064.86,-23339.53 12074.59,-23343.74 12075.09,-23336.76"/>
</g>
<!-- expert0_fc1_6 -->
<g id="node179" class="node">
<title>expert0_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="9675.31,-23220.85 9192.45,-23220.85 9068.23,-23084.85 9551.09,-23084.85 9675.31,-23220.85"/>
<text text-anchor="middle" x="9371.77" y="-23171.65" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="9371.77" y="-23156.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9371.77" y="-23141.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9371.77" y="-23126.65" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_6&#45;&gt;expert0_fc1_6 -->
<g id="edge224" class="edge">
<title>gate_6&#45;&gt;expert0_fc1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11665.31,-23318.36C11193.6,-23305.35 10063.47,-23269.97 9684.77,-23220.85 9684.66,-23220.84 9684.55,-23220.82 9684.45,-23220.81"/>
<polygon fill="black" stroke="black" points="9684.76,-23217.32 9674.38,-23219.46 9683.83,-23224.26 9684.76,-23217.32"/>
<text text-anchor="middle" x="10093.27" y="-23242.65" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_6 -->
<g id="node182" class="node">
<title>expert1_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="10301.31,-23220.85 9818.45,-23220.85 9694.23,-23084.85 10177.09,-23084.85 10301.31,-23220.85"/>
<text text-anchor="middle" x="9997.77" y="-23171.65" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="9997.77" y="-23156.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9997.77" y="-23141.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9997.77" y="-23126.65" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_6&#45;&gt;expert1_fc1_6 -->
<g id="edge228" class="edge">
<title>gate_6&#45;&gt;expert1_fc1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11666.89,-23319.73C11365.91,-23311.61 10793.34,-23288.02 10310.77,-23220.85 10310.55,-23220.82 10310.32,-23220.79 10310.1,-23220.76"/>
<polygon fill="black" stroke="black" points="10310.37,-23217.26 10299.98,-23219.3 10309.38,-23224.19 10310.37,-23217.26"/>
<text text-anchor="middle" x="10611.27" y="-23242.65" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_6 -->
<g id="node185" class="node">
<title>expert2_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="10927.31,-23220.85 10444.45,-23220.85 10320.23,-23084.85 10803.09,-23084.85 10927.31,-23220.85"/>
<text text-anchor="middle" x="10623.77" y="-23171.65" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="10623.77" y="-23156.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="10623.77" y="-23141.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="10623.77" y="-23126.65" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_6&#45;&gt;expert2_fc1_6 -->
<g id="edge232" class="edge">
<title>gate_6&#45;&gt;expert2_fc1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11652.93,-23305.83C11462.13,-23288.87 11180.43,-23260.19 10936.77,-23220.85 10936.55,-23220.81 10936.32,-23220.78 10936.1,-23220.74"/>
<polygon fill="black" stroke="black" points="10936.45,-23217.25 10926.01,-23219.08 10935.31,-23224.16 10936.45,-23217.25"/>
<text text-anchor="middle" x="11187.27" y="-23242.65" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_6 -->
<g id="node188" class="node">
<title>expert3_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="11553.31,-23220.85 11070.45,-23220.85 10946.23,-23084.85 11429.09,-23084.85 11553.31,-23220.85"/>
<text text-anchor="middle" x="11249.77" y="-23171.65" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="11249.77" y="-23156.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11249.77" y="-23141.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11249.77" y="-23126.65" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_6&#45;&gt;expert3_fc1_6 -->
<g id="edge236" class="edge">
<title>gate_6&#45;&gt;expert3_fc1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11684.12,-23271.81C11628.1,-23256.59 11565.95,-23239.71 11506.59,-23223.59"/>
<polygon fill="black" stroke="black" points="11507.27,-23220.15 11496.7,-23220.91 11505.43,-23226.91 11507.27,-23220.15"/>
<text text-anchor="middle" x="11646.27" y="-23242.65" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_6 -->
<g id="node191" class="node">
<title>expert4_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="12179.31,-23220.85 11696.45,-23220.85 11572.23,-23084.85 12055.09,-23084.85 12179.31,-23220.85"/>
<text text-anchor="middle" x="11875.77" y="-23171.65" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="11875.77" y="-23156.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11875.77" y="-23141.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11875.77" y="-23126.65" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_6&#45;&gt;expert4_fc1_6 -->
<g id="edge240" class="edge">
<title>gate_6&#45;&gt;expert4_fc1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11875.77,-23271.46C11875.77,-23258.79 11875.77,-23244.97 11875.77,-23231.42"/>
<polygon fill="black" stroke="black" points="11879.27,-23231.12 11875.77,-23221.12 11872.27,-23231.12 11879.27,-23231.12"/>
<text text-anchor="middle" x="11921.27" y="-23242.65" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_6 -->
<g id="node194" class="node">
<title>expert5_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="12805.31,-23220.85 12322.45,-23220.85 12198.23,-23084.85 12681.09,-23084.85 12805.31,-23220.85"/>
<text text-anchor="middle" x="12501.77" y="-23171.65" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="12501.77" y="-23156.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12501.77" y="-23141.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12501.77" y="-23126.65" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_6&#45;&gt;expert5_fc1_6 -->
<g id="edge244" class="edge">
<title>gate_6&#45;&gt;expert5_fc1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12067.42,-23271.81C12140.78,-23251.88 12224.67,-23229.1 12299.04,-23208.9"/>
<polygon fill="black" stroke="black" points="12300.27,-23212.2 12309,-23206.2 12298.43,-23205.44 12300.27,-23212.2"/>
<text text-anchor="middle" x="12234.27" y="-23242.65" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_6 -->
<g id="node197" class="node">
<title>expert6_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="13431.31,-23220.85 12948.45,-23220.85 12824.23,-23084.85 13307.09,-23084.85 13431.31,-23220.85"/>
<text text-anchor="middle" x="13127.77" y="-23171.65" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="13127.77" y="-23156.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="13127.77" y="-23141.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13127.77" y="-23126.65" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_6&#45;&gt;expert6_fc1_6 -->
<g id="edge248" class="edge">
<title>gate_6&#45;&gt;expert6_fc1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12098.6,-23305.83C12289.4,-23288.87 12571.11,-23260.19 12814.77,-23220.85 12848.47,-23215.41 12884.03,-23208.72 12918.6,-23201.7"/>
<polygon fill="black" stroke="black" points="12919.71,-23205.04 12928.81,-23199.61 12918.31,-23198.18 12919.71,-23205.04"/>
<text text-anchor="middle" x="12733.27" y="-23242.65" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_6 -->
<g id="node200" class="node">
<title>expert7_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="14057.31,-23220.85 13574.45,-23220.85 13450.23,-23084.85 13933.09,-23084.85 14057.31,-23220.85"/>
<text text-anchor="middle" x="13753.77" y="-23171.65" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="13753.77" y="-23156.65" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="13753.77" y="-23141.65" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13753.77" y="-23126.65" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_6&#45;&gt;expert7_fc1_6 -->
<g id="edge252" class="edge">
<title>gate_6&#45;&gt;expert7_fc1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12084.65,-23319.73C12385.63,-23311.61 12958.19,-23288.02 13440.77,-23220.85 13474.98,-23216.09 13511.03,-23209.69 13546.01,-23202.73"/>
<polygon fill="black" stroke="black" points="13546.73,-23206.15 13555.84,-23200.75 13545.35,-23199.29 13546.73,-23206.15"/>
<text text-anchor="middle" x="13318.27" y="-23242.65" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_6 -->
<g id="node180" class="node">
<title>expert0_gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="9371.77" cy="-22996.37" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9371.77" y="-23007.67" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="9371.77" y="-22992.67" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9371.77" y="-22977.67" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert0_fc1_6&#45;&gt;expert0_gelu_6 -->
<g id="edge225" class="edge">
<title>expert0_fc1_6&#45;&gt;expert0_gelu_6</title>
<path fill="none" stroke="black" d="M9371.77,-23084.54C9371.77,-23070.95 9371.77,-23056.94 9371.77,-23044.23"/>
<polygon fill="black" stroke="black" points="9375.27,-23043.91 9371.77,-23033.91 9368.27,-23043.91 9375.27,-23043.91"/>
</g>
<!-- expert0_fc2_6 -->
<g id="node181" class="node">
<title>expert0_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="9675.31,-22921.9 9192.45,-22921.9 9068.23,-22785.9 9551.09,-22785.9 9675.31,-22921.9"/>
<text text-anchor="middle" x="9371.77" y="-22872.7" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="9371.77" y="-22857.7" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9371.77" y="-22842.7" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9371.77" y="-22827.7" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_6&#45;&gt;expert0_fc2_6 -->
<g id="edge226" class="edge">
<title>expert0_gelu_6&#45;&gt;expert0_fc2_6</title>
<path fill="none" stroke="black" d="M9371.77,-22958.83C9371.77,-22950.53 9371.77,-22941.41 9371.77,-22932.13"/>
<polygon fill="black" stroke="black" points="9375.27,-22932.02 9371.77,-22922.02 9368.27,-22932.02 9375.27,-22932.02"/>
</g>
<!-- expert_agg_6 -->
<g id="node203" class="node">
<title>expert_agg_6</title>
<ellipse fill="lightcyan" stroke="black" cx="11875.77" cy="-22529.23" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="11875.77" cy="-22529.23" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="11875.77" y="-22540.53" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11875.77" y="-22525.53" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="11875.77" y="-22510.53" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert0_fc2_6&#45;&gt;expert_agg_6 -->
<g id="edge227" class="edge">
<title>expert0_fc2_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M9570.76,-22807.35C9608.5,-22799.55 9647.76,-22792 9684.77,-22785.9 10396.32,-22668.5 11246.61,-22585.47 11646.5,-22549.78"/>
<polygon fill="black" stroke="black" points="11647.08,-22553.24 11656.73,-22548.86 11646.46,-22546.26 11647.08,-22553.24"/>
</g>
<!-- expert1_gelu_6 -->
<g id="node183" class="node">
<title>expert1_gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="9997.77" cy="-22996.37" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9997.77" y="-23007.67" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="9997.77" y="-22992.67" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9997.77" y="-22977.67" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert1_fc1_6&#45;&gt;expert1_gelu_6 -->
<g id="edge229" class="edge">
<title>expert1_fc1_6&#45;&gt;expert1_gelu_6</title>
<path fill="none" stroke="black" d="M9997.77,-23084.54C9997.77,-23070.95 9997.77,-23056.94 9997.77,-23044.23"/>
<polygon fill="black" stroke="black" points="10001.27,-23043.91 9997.77,-23033.91 9994.27,-23043.91 10001.27,-23043.91"/>
</g>
<!-- expert1_fc2_6 -->
<g id="node184" class="node">
<title>expert1_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="10301.31,-22921.9 9818.45,-22921.9 9694.23,-22785.9 10177.09,-22785.9 10301.31,-22921.9"/>
<text text-anchor="middle" x="9997.77" y="-22872.7" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="9997.77" y="-22857.7" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9997.77" y="-22842.7" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="9997.77" y="-22827.7" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_6&#45;&gt;expert1_fc2_6 -->
<g id="edge230" class="edge">
<title>expert1_gelu_6&#45;&gt;expert1_fc2_6</title>
<path fill="none" stroke="black" d="M9997.77,-22958.83C9997.77,-22950.53 9997.77,-22941.41 9997.77,-22932.13"/>
<polygon fill="black" stroke="black" points="10001.27,-22932.02 9997.77,-22922.02 9994.27,-22932.02 10001.27,-22932.02"/>
</g>
<!-- expert1_fc2_6&#45;&gt;expert_agg_6 -->
<g id="edge231" class="edge">
<title>expert1_fc2_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M10197.84,-22808.55C10235.31,-22800.68 10274.18,-22792.8 10310.77,-22785.9 10784.74,-22696.51 11342.95,-22609.73 11648.11,-22563.85"/>
<polygon fill="black" stroke="black" points="11649.04,-22567.25 11658.41,-22562.3 11648,-22560.32 11649.04,-22567.25"/>
</g>
<!-- expert2_gelu_6 -->
<g id="node186" class="node">
<title>expert2_gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="10623.77" cy="-22996.37" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="10623.77" y="-23007.67" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="10623.77" y="-22992.67" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="10623.77" y="-22977.67" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert2_fc1_6&#45;&gt;expert2_gelu_6 -->
<g id="edge233" class="edge">
<title>expert2_fc1_6&#45;&gt;expert2_gelu_6</title>
<path fill="none" stroke="black" d="M10623.77,-23084.54C10623.77,-23070.95 10623.77,-23056.94 10623.77,-23044.23"/>
<polygon fill="black" stroke="black" points="10627.27,-23043.91 10623.77,-23033.91 10620.27,-23043.91 10627.27,-23043.91"/>
</g>
<!-- expert2_fc2_6 -->
<g id="node187" class="node">
<title>expert2_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="10927.31,-22921.9 10444.45,-22921.9 10320.23,-22785.9 10803.09,-22785.9 10927.31,-22921.9"/>
<text text-anchor="middle" x="10623.77" y="-22872.7" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="10623.77" y="-22857.7" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10623.77" y="-22842.7" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="10623.77" y="-22827.7" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_6&#45;&gt;expert2_fc2_6 -->
<g id="edge234" class="edge">
<title>expert2_gelu_6&#45;&gt;expert2_fc2_6</title>
<path fill="none" stroke="black" d="M10623.77,-22958.83C10623.77,-22950.53 10623.77,-22941.41 10623.77,-22932.13"/>
<polygon fill="black" stroke="black" points="10627.27,-22932.02 10623.77,-22922.02 10620.27,-22932.02 10627.27,-22932.02"/>
</g>
<!-- expert2_fc2_6&#45;&gt;expert_agg_6 -->
<g id="edge235" class="edge">
<title>expert2_fc2_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M10818.71,-22802.66C11044.7,-22744.41 11416.4,-22648.62 11653.45,-22587.53"/>
<polygon fill="black" stroke="black" points="11654.42,-22590.89 11663.23,-22585.01 11652.67,-22584.11 11654.42,-22590.89"/>
</g>
<!-- expert3_gelu_6 -->
<g id="node189" class="node">
<title>expert3_gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="11249.77" cy="-22996.37" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11249.77" y="-23007.67" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="11249.77" y="-22992.67" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11249.77" y="-22977.67" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert3_fc1_6&#45;&gt;expert3_gelu_6 -->
<g id="edge237" class="edge">
<title>expert3_fc1_6&#45;&gt;expert3_gelu_6</title>
<path fill="none" stroke="black" d="M11249.77,-23084.54C11249.77,-23070.95 11249.77,-23056.94 11249.77,-23044.23"/>
<polygon fill="black" stroke="black" points="11253.27,-23043.91 11249.77,-23033.91 11246.27,-23043.91 11253.27,-23043.91"/>
</g>
<!-- expert3_fc2_6 -->
<g id="node190" class="node">
<title>expert3_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="11553.31,-22921.9 11070.45,-22921.9 10946.23,-22785.9 11429.09,-22785.9 11553.31,-22921.9"/>
<text text-anchor="middle" x="11249.77" y="-22872.7" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="11249.77" y="-22857.7" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11249.77" y="-22842.7" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11249.77" y="-22827.7" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_6&#45;&gt;expert3_fc2_6 -->
<g id="edge238" class="edge">
<title>expert3_gelu_6&#45;&gt;expert3_fc2_6</title>
<path fill="none" stroke="black" d="M11249.77,-22958.83C11249.77,-22950.53 11249.77,-22941.41 11249.77,-22932.13"/>
<polygon fill="black" stroke="black" points="11253.27,-22932.02 11249.77,-22922.02 11246.27,-22932.02 11253.27,-22932.02"/>
</g>
<!-- expert3_fc2_6&#45;&gt;expert_agg_6 -->
<g id="edge239" class="edge">
<title>expert3_fc2_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M11379.86,-22785.84C11464.18,-22742.38 11575.8,-22684.85 11671.78,-22635.37"/>
<polygon fill="black" stroke="black" points="11673.44,-22638.46 11680.72,-22630.76 11670.23,-22632.23 11673.44,-22638.46"/>
</g>
<!-- expert4_gelu_6 -->
<g id="node192" class="node">
<title>expert4_gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="11875.77" cy="-22996.37" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11875.77" y="-23007.67" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="11875.77" y="-22992.67" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11875.77" y="-22977.67" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert4_fc1_6&#45;&gt;expert4_gelu_6 -->
<g id="edge241" class="edge">
<title>expert4_fc1_6&#45;&gt;expert4_gelu_6</title>
<path fill="none" stroke="black" d="M11875.77,-23084.54C11875.77,-23070.95 11875.77,-23056.94 11875.77,-23044.23"/>
<polygon fill="black" stroke="black" points="11879.27,-23043.91 11875.77,-23033.91 11872.27,-23043.91 11879.27,-23043.91"/>
</g>
<!-- expert4_fc2_6 -->
<g id="node193" class="node">
<title>expert4_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="12179.31,-22921.9 11696.45,-22921.9 11572.23,-22785.9 12055.09,-22785.9 12179.31,-22921.9"/>
<text text-anchor="middle" x="11875.77" y="-22872.7" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="11875.77" y="-22857.7" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11875.77" y="-22842.7" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="11875.77" y="-22827.7" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_6&#45;&gt;expert4_fc2_6 -->
<g id="edge242" class="edge">
<title>expert4_gelu_6&#45;&gt;expert4_fc2_6</title>
<path fill="none" stroke="black" d="M11875.77,-22958.83C11875.77,-22950.53 11875.77,-22941.41 11875.77,-22932.13"/>
<polygon fill="black" stroke="black" points="11879.27,-22932.02 11875.77,-22922.02 11872.27,-22932.02 11879.27,-22932.02"/>
</g>
<!-- expert4_fc2_6&#45;&gt;expert_agg_6 -->
<g id="edge243" class="edge">
<title>expert4_fc2_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M11875.77,-22785.65C11875.77,-22777.31 11875.77,-22768.45 11875.77,-22759.23"/>
<polygon fill="black" stroke="black" points="11879.27,-22759.1 11875.77,-22749.1 11872.27,-22759.1 11879.27,-22759.1"/>
</g>
<!-- expert5_gelu_6 -->
<g id="node195" class="node">
<title>expert5_gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="12501.77" cy="-22996.37" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12501.77" y="-23007.67" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="12501.77" y="-22992.67" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12501.77" y="-22977.67" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert5_fc1_6&#45;&gt;expert5_gelu_6 -->
<g id="edge245" class="edge">
<title>expert5_fc1_6&#45;&gt;expert5_gelu_6</title>
<path fill="none" stroke="black" d="M12501.77,-23084.54C12501.77,-23070.95 12501.77,-23056.94 12501.77,-23044.23"/>
<polygon fill="black" stroke="black" points="12505.27,-23043.91 12501.77,-23033.91 12498.27,-23043.91 12505.27,-23043.91"/>
</g>
<!-- expert5_fc2_6 -->
<g id="node196" class="node">
<title>expert5_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="12805.31,-22921.9 12322.45,-22921.9 12198.23,-22785.9 12681.09,-22785.9 12805.31,-22921.9"/>
<text text-anchor="middle" x="12501.77" y="-22872.7" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="12501.77" y="-22857.7" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12501.77" y="-22842.7" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="12501.77" y="-22827.7" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_6&#45;&gt;expert5_fc2_6 -->
<g id="edge246" class="edge">
<title>expert5_gelu_6&#45;&gt;expert5_fc2_6</title>
<path fill="none" stroke="black" d="M12501.77,-22958.83C12501.77,-22950.53 12501.77,-22941.41 12501.77,-22932.13"/>
<polygon fill="black" stroke="black" points="12505.27,-22932.02 12501.77,-22922.02 12498.27,-22932.02 12505.27,-22932.02"/>
</g>
<!-- expert5_fc2_6&#45;&gt;expert_agg_6 -->
<g id="edge247" class="edge">
<title>expert5_fc2_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M12371.68,-22785.84C12287.35,-22742.38 12175.74,-22684.85 12079.76,-22635.37"/>
<polygon fill="black" stroke="black" points="12081.31,-22632.23 12070.81,-22630.76 12078.1,-22638.46 12081.31,-22632.23"/>
</g>
<!-- expert6_gelu_6 -->
<g id="node198" class="node">
<title>expert6_gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="13127.77" cy="-22996.37" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="13127.77" y="-23007.67" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="13127.77" y="-22992.67" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="13127.77" y="-22977.67" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert6_fc1_6&#45;&gt;expert6_gelu_6 -->
<g id="edge249" class="edge">
<title>expert6_fc1_6&#45;&gt;expert6_gelu_6</title>
<path fill="none" stroke="black" d="M13127.77,-23084.54C13127.77,-23070.95 13127.77,-23056.94 13127.77,-23044.23"/>
<polygon fill="black" stroke="black" points="13131.27,-23043.91 13127.77,-23033.91 13124.27,-23043.91 13131.27,-23043.91"/>
</g>
<!-- expert6_fc2_6 -->
<g id="node199" class="node">
<title>expert6_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="13431.31,-22921.9 12948.45,-22921.9 12824.23,-22785.9 13307.09,-22785.9 13431.31,-22921.9"/>
<text text-anchor="middle" x="13127.77" y="-22872.7" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="13127.77" y="-22857.7" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13127.77" y="-22842.7" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13127.77" y="-22827.7" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_6&#45;&gt;expert6_fc2_6 -->
<g id="edge250" class="edge">
<title>expert6_gelu_6&#45;&gt;expert6_fc2_6</title>
<path fill="none" stroke="black" d="M13127.77,-22958.83C13127.77,-22950.53 13127.77,-22941.41 13127.77,-22932.13"/>
<polygon fill="black" stroke="black" points="13131.27,-22932.02 13127.77,-22922.02 13124.27,-22932.02 13131.27,-22932.02"/>
</g>
<!-- expert6_fc2_6&#45;&gt;expert_agg_6 -->
<g id="edge251" class="edge">
<title>expert6_fc2_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M12867.59,-22785.84C12640.21,-22727.24 12313.63,-22643.08 12098.2,-22587.55"/>
<polygon fill="black" stroke="black" points="12098.9,-22584.12 12088.34,-22585.01 12097.15,-22590.9 12098.9,-22584.12"/>
</g>
<!-- expert7_gelu_6 -->
<g id="node201" class="node">
<title>expert7_gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="13753.77" cy="-22996.37" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="13753.77" y="-23007.67" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="13753.77" y="-22992.67" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="13753.77" y="-22977.67" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- expert7_fc1_6&#45;&gt;expert7_gelu_6 -->
<g id="edge253" class="edge">
<title>expert7_fc1_6&#45;&gt;expert7_gelu_6</title>
<path fill="none" stroke="black" d="M13753.77,-23084.54C13753.77,-23070.95 13753.77,-23056.94 13753.77,-23044.23"/>
<polygon fill="black" stroke="black" points="13757.27,-23043.91 13753.77,-23033.91 13750.27,-23043.91 13757.27,-23043.91"/>
</g>
<!-- expert7_fc2_6 -->
<g id="node202" class="node">
<title>expert7_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="14057.31,-22921.9 13574.45,-22921.9 13450.23,-22785.9 13933.09,-22785.9 14057.31,-22921.9"/>
<text text-anchor="middle" x="13753.77" y="-22872.7" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="13753.77" y="-22857.7" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="13753.77" y="-22842.7" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="13753.77" y="-22827.7" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_6&#45;&gt;expert7_fc2_6 -->
<g id="edge254" class="edge">
<title>expert7_gelu_6&#45;&gt;expert7_fc2_6</title>
<path fill="none" stroke="black" d="M13753.77,-22958.83C13753.77,-22950.53 13753.77,-22941.41 13753.77,-22932.13"/>
<polygon fill="black" stroke="black" points="13757.27,-22932.02 13753.77,-22922.02 13750.27,-22932.02 13757.27,-22932.02"/>
</g>
<!-- expert7_fc2_6&#45;&gt;expert_agg_6 -->
<g id="edge255" class="edge">
<title>expert7_fc2_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M13451.89,-22788.01C13448.16,-22787.3 13444.45,-22786.59 13440.77,-22785.9 12966.8,-22696.51 12408.59,-22609.73 12103.43,-22563.85"/>
<polygon fill="black" stroke="black" points="12103.54,-22560.32 12093.13,-22562.3 12102.5,-22567.25 12103.54,-22560.32"/>
</g>
<!-- expert_agg_6&#45;&gt;residual2_6 -->
<g id="edge256" class="edge">
<title>expert_agg_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M12087.19,-22469.36C12315.4,-22405.82 12671.14,-22306.77 12857.47,-22254.89"/>
<polygon fill="black" stroke="black" points="12858.61,-22258.21 12867.3,-22252.15 12856.73,-22251.46 12858.61,-22258.21"/>
</g>
<!-- comm_6 -->
<g id="node205" class="node">
<title>comm_6</title>
<polygon fill="yellow" stroke="black" points="13098.51,-22068.17 13098.51,-22101.82 13029.54,-22125.62 12932,-22125.62 12863.03,-22101.82 12863.03,-22068.17 12932,-22044.37 13029.54,-22044.37 13098.51,-22068.17"/>
<polygon fill="none" stroke="black" points="13102.5,-22065.31 13102.5,-22104.68 13030.21,-22129.63 12931.33,-22129.63 12859.04,-22104.68 12859.04,-22065.31 12931.33,-22040.37 13030.21,-22040.37 13102.5,-22065.31"/>
<text text-anchor="middle" x="12980.77" y="-22096.3" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="12980.77" y="-22081.3" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="12980.77" y="-22066.3" font-family="Times,serif" font-size="14.00">GPU5→GPU6</text>
</g>
<!-- residual2_6&#45;&gt;comm_6 -->
<g id="edge258" class="edge">
<title>residual2_6&#45;&gt;comm_6</title>
<path fill="none" stroke="black" d="M12980.77,-22166.55C12980.77,-22157.79 12980.77,-22148.68 12980.77,-22139.88"/>
<polygon fill="black" stroke="black" points="12984.27,-22139.72 12980.77,-22129.72 12977.27,-22139.72 12984.27,-22139.72"/>
</g>
<!-- ln1_7 -->
<g id="node206" class="node">
<title>ln1_7</title>
<polygon fill="lightgrey" stroke="black" points="12973.77,-22003.43 12829.77,-22003.43 12829.77,-21950.43 12973.77,-21950.43 12973.77,-22003.43"/>
<text text-anchor="middle" x="12901.77" y="-21988.23" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12901.77" y="-21973.23" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="12901.77" y="-21958.23" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- comm_6&#45;&gt;ln1_7 -->
<g id="edge259" class="edge">
<title>comm_6&#45;&gt;ln1_7</title>
<path fill="none" stroke="black" d="M12948.18,-22040.24C12941.09,-22030.72 12933.69,-22020.78 12926.93,-22011.72"/>
<polygon fill="black" stroke="black" points="12929.72,-22009.6 12920.94,-22003.67 12924.1,-22013.78 12929.72,-22009.6"/>
</g>
<!-- residual1_7 -->
<g id="node210" class="node">
<title>residual1_7</title>
<polygon fill="lightgrey" stroke="black" points="12898.77,-21405.39 12605.77,-21352.39 12898.77,-21299.39 13191.77,-21352.39 12898.77,-21405.39"/>
<text text-anchor="middle" x="12898.77" y="-21363.69" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="12898.77" y="-21348.69" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="12898.77" y="-21333.69" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- comm_6&#45;&gt;residual1_7 -->
<g id="edge264" class="edge">
<title>comm_6&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13031.92,-22040.71C13047.1,-22023.16 13059.77,-22001.47 13059.77,-21977.93 13059.77,-21977.93 13059.77,-21977.93 13059.77,-21509.39 13059.77,-21478.31 13058.55,-21467.15 13039.77,-21442.39 13026.05,-21424.31 13007.52,-21408.95 12988.39,-21396.35"/>
<polygon fill="black" stroke="black" points="12990.2,-21393.35 12979.88,-21390.94 12986.44,-21399.26 12990.2,-21393.35"/>
<text text-anchor="middle" x="13088.77" y="-21748.23" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_7 -->
<g id="node207" class="node">
<title>qkv_proj_7</title>
<polygon fill="lightgrey" stroke="black" points="13031.31,-21913.43 12548.45,-21913.43 12424.23,-21777.43 12907.09,-21777.43 13031.31,-21913.43"/>
<text text-anchor="middle" x="12727.77" y="-21864.23" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12727.77" y="-21849.23" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="12727.77" y="-21834.23" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12727.77" y="-21819.23" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_7&#45;&gt;qkv_proj_7 -->
<g id="edge260" class="edge">
<title>ln1_7&#45;&gt;qkv_proj_7</title>
<path fill="none" stroke="black" d="M12867.39,-21950.35C12855.27,-21941.33 12840.98,-21930.69 12826.23,-21919.71"/>
<polygon fill="black" stroke="black" points="12828.12,-21916.75 12818,-21913.59 12823.94,-21922.37 12828.12,-21916.75"/>
</g>
<!-- mha_7 -->
<g id="node208" class="node">
<title>mha_7</title>
<polygon fill="lightgrey" stroke="black" points="12973.24,-21670.91 12853.5,-21726.45 12614.04,-21726.45 12494.3,-21670.91 12614.04,-21615.37 12853.5,-21615.37 12973.24,-21670.91"/>
<text text-anchor="middle" x="12733.77" y="-21689.71" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="12733.77" y="-21674.71" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="12733.77" y="-21659.71" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12733.77" y="-21644.71" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- qkv_proj_7&#45;&gt;mha_7 -->
<g id="edge261" class="edge">
<title>qkv_proj_7&#45;&gt;mha_7</title>
<path fill="none" stroke="black" d="M12730.11,-21777.24C12730.57,-21764.02 12731.05,-21750.18 12731.5,-21737.04"/>
<polygon fill="black" stroke="black" points="12735.01,-21736.79 12731.86,-21726.67 12728.02,-21736.54 12735.01,-21736.79"/>
</g>
<!-- out_proj_7 -->
<g id="node209" class="node">
<title>out_proj_7</title>
<polygon fill="lightgrey" stroke="black" points="13031.14,-21578.39 12562.86,-21578.39 12442.39,-21442.39 12910.68,-21442.39 13031.14,-21578.39"/>
<text text-anchor="middle" x="12736.77" y="-21529.19" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="12736.77" y="-21514.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12736.77" y="-21499.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12736.77" y="-21484.19" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_7&#45;&gt;out_proj_7 -->
<g id="edge262" class="edge">
<title>mha_7&#45;&gt;out_proj_7</title>
<path fill="none" stroke="black" d="M12734.8,-21615.36C12734.96,-21606.77 12735.13,-21597.75 12735.3,-21588.76"/>
<polygon fill="black" stroke="black" points="12738.81,-21588.72 12735.5,-21578.65 12731.81,-21588.59 12738.81,-21588.72"/>
</g>
<!-- out_proj_7&#45;&gt;residual1_7 -->
<g id="edge263" class="edge">
<title>out_proj_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M12806.41,-21442.33C12819.6,-21429.62 12833.2,-21416.53 12845.78,-21404.42"/>
<polygon fill="black" stroke="black" points="12848.27,-21406.87 12853.05,-21397.42 12843.42,-21401.83 12848.27,-21406.87"/>
</g>
<!-- ln2_7 -->
<g id="node211" class="node">
<title>ln2_7</title>
<polygon fill="lightgrey" stroke="black" points="12657.77,-21262.39 12513.77,-21262.39 12513.77,-21209.39 12657.77,-21209.39 12657.77,-21262.39"/>
<text text-anchor="middle" x="12585.77" y="-21247.19" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12585.77" y="-21232.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="12585.77" y="-21217.19" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge265" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M12803.58,-21316.57C12759.37,-21300.39 12707.39,-21281.38 12665.3,-21265.99"/>
<polygon fill="black" stroke="black" points="12666.25,-21262.6 12655.66,-21262.46 12663.85,-21269.18 12666.25,-21262.6"/>
</g>
<!-- residual2_7 -->
<g id="node238" class="node">
<title>residual2_7</title>
<polygon fill="lightgrey" stroke="black" points="12107.77,-20067.1 11814.77,-20014.1 12107.77,-19961.1 12400.77,-20014.1 12107.77,-20067.1"/>
<text text-anchor="middle" x="12107.77" y="-20025.4" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="12107.77" y="-20010.4" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="12107.77" y="-19995.4" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- residual1_7&#45;&gt;residual2_7 -->
<g id="edge300" class="edge">
<title>residual1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13041.99,-21325.3C13124.8,-21305.98 13212.77,-21276.2 13212.77,-21236.89 13212.77,-21236.89 13212.77,-21236.89 13212.77,-20322.77 13212.77,-20139.93 12644.21,-20061.09 12322.76,-20031.13"/>
<polygon fill="black" stroke="black" points="12322.65,-20027.6 12312.38,-20030.17 12322.01,-20034.57 12322.65,-20027.6"/>
<text text-anchor="middle" x="13241.77" y="-20850.19" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_7 -->
<g id="node212" class="node">
<title>gate_7</title>
<polygon fill="lightgrey" stroke="black" points="11152.86,-21172.39 10852.68,-21172.39 10745.77,-21066.39 11259.77,-21066.39 11152.86,-21172.39"/>
<text text-anchor="middle" x="11002.77" y="-21130.69" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="11002.77" y="-21115.69" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="11002.77" y="-21100.69" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- ln2_7&#45;&gt;gate_7 -->
<g id="edge266" class="edge">
<title>ln2_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M12513.64,-21229.67C12282.84,-21212.98 11556.86,-21160.47 11201.99,-21134.8"/>
<polygon fill="black" stroke="black" points="11202.09,-21131.3 11191.86,-21134.07 11201.59,-21138.28 11202.09,-21131.3"/>
</g>
<!-- expert0_fc1_7 -->
<g id="node213" class="node">
<title>expert0_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="8802.31,-21015.39 8319.45,-21015.39 8195.23,-20879.39 8678.09,-20879.39 8802.31,-21015.39"/>
<text text-anchor="middle" x="8498.77" y="-20966.19" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="8498.77" y="-20951.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8498.77" y="-20936.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8498.77" y="-20921.19" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_7&#45;&gt;expert0_fc1_7 -->
<g id="edge267" class="edge">
<title>gate_7&#45;&gt;expert0_fc1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10792.31,-21112.9C10320.6,-21099.88 9190.47,-21064.51 8811.77,-21015.39 8811.66,-21015.38 8811.55,-21015.36 8811.45,-21015.35"/>
<polygon fill="black" stroke="black" points="8811.76,-21011.86 8801.38,-21014 8810.83,-21018.8 8811.76,-21011.86"/>
<text text-anchor="middle" x="9220.27" y="-21037.19" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_7 -->
<g id="node216" class="node">
<title>expert1_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="9428.31,-21015.39 8945.45,-21015.39 8821.23,-20879.39 9304.09,-20879.39 9428.31,-21015.39"/>
<text text-anchor="middle" x="9124.77" y="-20966.19" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="9124.77" y="-20951.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9124.77" y="-20936.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9124.77" y="-20921.19" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_7&#45;&gt;expert1_fc1_7 -->
<g id="edge271" class="edge">
<title>gate_7&#45;&gt;expert1_fc1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10793.89,-21114.27C10492.91,-21106.15 9920.34,-21082.56 9437.77,-21015.39 9437.55,-21015.36 9437.32,-21015.33 9437.1,-21015.3"/>
<polygon fill="black" stroke="black" points="9437.37,-21011.8 9426.98,-21013.84 9436.38,-21018.73 9437.37,-21011.8"/>
<text text-anchor="middle" x="9738.27" y="-21037.19" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_7 -->
<g id="node219" class="node">
<title>expert2_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="10054.31,-21015.39 9571.45,-21015.39 9447.23,-20879.39 9930.09,-20879.39 10054.31,-21015.39"/>
<text text-anchor="middle" x="9750.77" y="-20966.19" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="9750.77" y="-20951.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9750.77" y="-20936.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9750.77" y="-20921.19" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_7&#45;&gt;expert2_fc1_7 -->
<g id="edge275" class="edge">
<title>gate_7&#45;&gt;expert2_fc1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10779.93,-21100.37C10589.13,-21083.41 10307.43,-21054.73 10063.77,-21015.39 10063.55,-21015.35 10063.32,-21015.32 10063.1,-21015.28"/>
<polygon fill="black" stroke="black" points="10063.45,-21011.79 10053.01,-21013.62 10062.31,-21018.7 10063.45,-21011.79"/>
<text text-anchor="middle" x="10314.27" y="-21037.19" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_7 -->
<g id="node222" class="node">
<title>expert3_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="10680.31,-21015.39 10197.45,-21015.39 10073.23,-20879.39 10556.09,-20879.39 10680.31,-21015.39"/>
<text text-anchor="middle" x="10376.77" y="-20966.19" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="10376.77" y="-20951.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="10376.77" y="-20936.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10376.77" y="-20921.19" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_7&#45;&gt;expert3_fc1_7 -->
<g id="edge279" class="edge">
<title>gate_7&#45;&gt;expert3_fc1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10811.12,-21066.34C10755.1,-21051.13 10692.95,-21034.25 10633.59,-21018.13"/>
<polygon fill="black" stroke="black" points="10634.27,-21014.69 10623.7,-21015.45 10632.43,-21021.45 10634.27,-21014.69"/>
<text text-anchor="middle" x="10773.27" y="-21037.19" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_7 -->
<g id="node225" class="node">
<title>expert4_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="11306.31,-21015.39 10823.45,-21015.39 10699.23,-20879.39 11182.09,-20879.39 11306.31,-21015.39"/>
<text text-anchor="middle" x="11002.77" y="-20966.19" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="11002.77" y="-20951.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11002.77" y="-20936.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11002.77" y="-20921.19" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_7&#45;&gt;expert4_fc1_7 -->
<g id="edge283" class="edge">
<title>gate_7&#45;&gt;expert4_fc1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11002.77,-21066C11002.77,-21053.32 11002.77,-21039.51 11002.77,-21025.96"/>
<polygon fill="black" stroke="black" points="11006.27,-21025.66 11002.77,-21015.66 10999.27,-21025.66 11006.27,-21025.66"/>
<text text-anchor="middle" x="11048.27" y="-21037.19" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_7 -->
<g id="node228" class="node">
<title>expert5_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="11932.31,-21015.39 11449.45,-21015.39 11325.23,-20879.39 11808.09,-20879.39 11932.31,-21015.39"/>
<text text-anchor="middle" x="11628.77" y="-20966.19" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="11628.77" y="-20951.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11628.77" y="-20936.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11628.77" y="-20921.19" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_7&#45;&gt;expert5_fc1_7 -->
<g id="edge287" class="edge">
<title>gate_7&#45;&gt;expert5_fc1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11194.42,-21066.34C11267.78,-21046.42 11351.67,-21023.64 11426.04,-21003.44"/>
<polygon fill="black" stroke="black" points="11427.27,-21006.74 11436,-21000.74 11425.43,-20999.98 11427.27,-21006.74"/>
<text text-anchor="middle" x="11361.27" y="-21037.19" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_7 -->
<g id="node231" class="node">
<title>expert6_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="12558.31,-21015.39 12075.45,-21015.39 11951.23,-20879.39 12434.09,-20879.39 12558.31,-21015.39"/>
<text text-anchor="middle" x="12254.77" y="-20966.19" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="12254.77" y="-20951.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12254.77" y="-20936.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12254.77" y="-20921.19" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_7&#45;&gt;expert6_fc1_7 -->
<g id="edge291" class="edge">
<title>gate_7&#45;&gt;expert6_fc1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11225.6,-21100.37C11416.4,-21083.41 11698.11,-21054.73 11941.77,-21015.39 11975.47,-21009.95 12011.03,-21003.26 12045.6,-20996.24"/>
<polygon fill="black" stroke="black" points="12046.71,-20999.58 12055.81,-20994.15 12045.31,-20992.72 12046.71,-20999.58"/>
<text text-anchor="middle" x="11860.27" y="-21037.19" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_7 -->
<g id="node234" class="node">
<title>expert7_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="13184.31,-21015.39 12701.45,-21015.39 12577.23,-20879.39 13060.09,-20879.39 13184.31,-21015.39"/>
<text text-anchor="middle" x="12880.77" y="-20966.19" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="12880.77" y="-20951.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12880.77" y="-20936.19" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12880.77" y="-20921.19" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_7&#45;&gt;expert7_fc1_7 -->
<g id="edge295" class="edge">
<title>gate_7&#45;&gt;expert7_fc1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11211.65,-21114.27C11512.63,-21106.15 12085.19,-21082.56 12567.77,-21015.39 12601.98,-21010.63 12638.03,-21004.23 12673.01,-20997.27"/>
<polygon fill="black" stroke="black" points="12673.73,-21000.69 12682.84,-20995.29 12672.35,-20993.83 12673.73,-21000.69"/>
<text text-anchor="middle" x="12445.27" y="-21037.19" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_7 -->
<g id="node214" class="node">
<title>expert0_gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="8498.77" cy="-20790.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8498.77" y="-20802.21" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="8498.77" y="-20787.21" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8498.77" y="-20772.21" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert0_fc1_7&#45;&gt;expert0_gelu_7 -->
<g id="edge268" class="edge">
<title>expert0_fc1_7&#45;&gt;expert0_gelu_7</title>
<path fill="none" stroke="black" d="M8498.77,-20879.08C8498.77,-20865.49 8498.77,-20851.48 8498.77,-20838.77"/>
<polygon fill="black" stroke="black" points="8502.27,-20838.45 8498.77,-20828.45 8495.27,-20838.45 8502.27,-20838.45"/>
</g>
<!-- expert0_fc2_7 -->
<g id="node215" class="node">
<title>expert0_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="8802.31,-20716.44 8319.45,-20716.44 8195.23,-20580.44 8678.09,-20580.44 8802.31,-20716.44"/>
<text text-anchor="middle" x="8498.77" y="-20667.24" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="8498.77" y="-20652.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8498.77" y="-20637.24" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="8498.77" y="-20622.24" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_7&#45;&gt;expert0_fc2_7 -->
<g id="edge269" class="edge">
<title>expert0_gelu_7&#45;&gt;expert0_fc2_7</title>
<path fill="none" stroke="black" d="M8498.77,-20753.37C8498.77,-20745.07 8498.77,-20735.95 8498.77,-20726.67"/>
<polygon fill="black" stroke="black" points="8502.27,-20726.56 8498.77,-20716.56 8495.27,-20726.56 8502.27,-20726.56"/>
</g>
<!-- expert_agg_7 -->
<g id="node237" class="node">
<title>expert_agg_7</title>
<ellipse fill="lightgrey" stroke="black" cx="11002.77" cy="-20323.77" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="11002.77" cy="-20323.77" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="11002.77" y="-20335.07" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="11002.77" y="-20320.07" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="11002.77" y="-20305.07" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert0_fc2_7&#45;&gt;expert_agg_7 -->
<g id="edge270" class="edge">
<title>expert0_fc2_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M8697.76,-20601.89C8735.5,-20594.09 8774.76,-20586.54 8811.77,-20580.44 9523.32,-20463.03 10373.61,-20380.01 10773.5,-20344.31"/>
<polygon fill="black" stroke="black" points="10774.08,-20347.78 10783.73,-20343.4 10773.46,-20340.8 10774.08,-20347.78"/>
</g>
<!-- expert1_gelu_7 -->
<g id="node217" class="node">
<title>expert1_gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="9124.77" cy="-20790.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9124.77" y="-20802.21" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="9124.77" y="-20787.21" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9124.77" y="-20772.21" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert1_fc1_7&#45;&gt;expert1_gelu_7 -->
<g id="edge272" class="edge">
<title>expert1_fc1_7&#45;&gt;expert1_gelu_7</title>
<path fill="none" stroke="black" d="M9124.77,-20879.08C9124.77,-20865.49 9124.77,-20851.48 9124.77,-20838.77"/>
<polygon fill="black" stroke="black" points="9128.27,-20838.45 9124.77,-20828.45 9121.27,-20838.45 9128.27,-20838.45"/>
</g>
<!-- expert1_fc2_7 -->
<g id="node218" class="node">
<title>expert1_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="9428.31,-20716.44 8945.45,-20716.44 8821.23,-20580.44 9304.09,-20580.44 9428.31,-20716.44"/>
<text text-anchor="middle" x="9124.77" y="-20667.24" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="9124.77" y="-20652.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9124.77" y="-20637.24" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9124.77" y="-20622.24" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_7&#45;&gt;expert1_fc2_7 -->
<g id="edge273" class="edge">
<title>expert1_gelu_7&#45;&gt;expert1_fc2_7</title>
<path fill="none" stroke="black" d="M9124.77,-20753.37C9124.77,-20745.07 9124.77,-20735.95 9124.77,-20726.67"/>
<polygon fill="black" stroke="black" points="9128.27,-20726.56 9124.77,-20716.56 9121.27,-20726.56 9128.27,-20726.56"/>
</g>
<!-- expert1_fc2_7&#45;&gt;expert_agg_7 -->
<g id="edge274" class="edge">
<title>expert1_fc2_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M9324.84,-20603.09C9362.31,-20595.21 9401.18,-20587.34 9437.77,-20580.44 9911.74,-20491.05 10469.95,-20404.26 10775.11,-20358.39"/>
<polygon fill="black" stroke="black" points="10776.04,-20361.79 10785.41,-20356.84 10775,-20354.86 10776.04,-20361.79"/>
</g>
<!-- expert2_gelu_7 -->
<g id="node220" class="node">
<title>expert2_gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="9750.77" cy="-20790.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9750.77" y="-20802.21" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="9750.77" y="-20787.21" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9750.77" y="-20772.21" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert2_fc1_7&#45;&gt;expert2_gelu_7 -->
<g id="edge276" class="edge">
<title>expert2_fc1_7&#45;&gt;expert2_gelu_7</title>
<path fill="none" stroke="black" d="M9750.77,-20879.08C9750.77,-20865.49 9750.77,-20851.48 9750.77,-20838.77"/>
<polygon fill="black" stroke="black" points="9754.27,-20838.45 9750.77,-20828.45 9747.27,-20838.45 9754.27,-20838.45"/>
</g>
<!-- expert2_fc2_7 -->
<g id="node221" class="node">
<title>expert2_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="10054.31,-20716.44 9571.45,-20716.44 9447.23,-20580.44 9930.09,-20580.44 10054.31,-20716.44"/>
<text text-anchor="middle" x="9750.77" y="-20667.24" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="9750.77" y="-20652.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9750.77" y="-20637.24" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="9750.77" y="-20622.24" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_7&#45;&gt;expert2_fc2_7 -->
<g id="edge277" class="edge">
<title>expert2_gelu_7&#45;&gt;expert2_fc2_7</title>
<path fill="none" stroke="black" d="M9750.77,-20753.37C9750.77,-20745.07 9750.77,-20735.95 9750.77,-20726.67"/>
<polygon fill="black" stroke="black" points="9754.27,-20726.56 9750.77,-20716.56 9747.27,-20726.56 9754.27,-20726.56"/>
</g>
<!-- expert2_fc2_7&#45;&gt;expert_agg_7 -->
<g id="edge278" class="edge">
<title>expert2_fc2_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M9945.71,-20597.2C10171.7,-20538.95 10543.4,-20443.16 10780.45,-20382.07"/>
<polygon fill="black" stroke="black" points="10781.42,-20385.43 10790.23,-20379.55 10779.67,-20378.65 10781.42,-20385.43"/>
</g>
<!-- expert3_gelu_7 -->
<g id="node223" class="node">
<title>expert3_gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="10376.77" cy="-20790.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="10376.77" y="-20802.21" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="10376.77" y="-20787.21" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="10376.77" y="-20772.21" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert3_fc1_7&#45;&gt;expert3_gelu_7 -->
<g id="edge280" class="edge">
<title>expert3_fc1_7&#45;&gt;expert3_gelu_7</title>
<path fill="none" stroke="black" d="M10376.77,-20879.08C10376.77,-20865.49 10376.77,-20851.48 10376.77,-20838.77"/>
<polygon fill="black" stroke="black" points="10380.27,-20838.45 10376.77,-20828.45 10373.27,-20838.45 10380.27,-20838.45"/>
</g>
<!-- expert3_fc2_7 -->
<g id="node224" class="node">
<title>expert3_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="10680.31,-20716.44 10197.45,-20716.44 10073.23,-20580.44 10556.09,-20580.44 10680.31,-20716.44"/>
<text text-anchor="middle" x="10376.77" y="-20667.24" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="10376.77" y="-20652.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10376.77" y="-20637.24" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="10376.77" y="-20622.24" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_7&#45;&gt;expert3_fc2_7 -->
<g id="edge281" class="edge">
<title>expert3_gelu_7&#45;&gt;expert3_fc2_7</title>
<path fill="none" stroke="black" d="M10376.77,-20753.37C10376.77,-20745.07 10376.77,-20735.95 10376.77,-20726.67"/>
<polygon fill="black" stroke="black" points="10380.27,-20726.56 10376.77,-20716.56 10373.27,-20726.56 10380.27,-20726.56"/>
</g>
<!-- expert3_fc2_7&#45;&gt;expert_agg_7 -->
<g id="edge282" class="edge">
<title>expert3_fc2_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M10506.86,-20580.38C10591.18,-20536.92 10702.8,-20479.39 10798.78,-20429.91"/>
<polygon fill="black" stroke="black" points="10800.44,-20433 10807.72,-20425.3 10797.23,-20426.77 10800.44,-20433"/>
</g>
<!-- expert4_gelu_7 -->
<g id="node226" class="node">
<title>expert4_gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="11002.77" cy="-20790.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11002.77" y="-20802.21" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="11002.77" y="-20787.21" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11002.77" y="-20772.21" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert4_fc1_7&#45;&gt;expert4_gelu_7 -->
<g id="edge284" class="edge">
<title>expert4_fc1_7&#45;&gt;expert4_gelu_7</title>
<path fill="none" stroke="black" d="M11002.77,-20879.08C11002.77,-20865.49 11002.77,-20851.48 11002.77,-20838.77"/>
<polygon fill="black" stroke="black" points="11006.27,-20838.45 11002.77,-20828.45 10999.27,-20838.45 11006.27,-20838.45"/>
</g>
<!-- expert4_fc2_7 -->
<g id="node227" class="node">
<title>expert4_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="11306.31,-20716.44 10823.45,-20716.44 10699.23,-20580.44 11182.09,-20580.44 11306.31,-20716.44"/>
<text text-anchor="middle" x="11002.77" y="-20667.24" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="11002.77" y="-20652.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11002.77" y="-20637.24" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11002.77" y="-20622.24" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_7&#45;&gt;expert4_fc2_7 -->
<g id="edge285" class="edge">
<title>expert4_gelu_7&#45;&gt;expert4_fc2_7</title>
<path fill="none" stroke="black" d="M11002.77,-20753.37C11002.77,-20745.07 11002.77,-20735.95 11002.77,-20726.67"/>
<polygon fill="black" stroke="black" points="11006.27,-20726.56 11002.77,-20716.56 10999.27,-20726.56 11006.27,-20726.56"/>
</g>
<!-- expert4_fc2_7&#45;&gt;expert_agg_7 -->
<g id="edge286" class="edge">
<title>expert4_fc2_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M11002.77,-20580.19C11002.77,-20571.85 11002.77,-20562.99 11002.77,-20553.77"/>
<polygon fill="black" stroke="black" points="11006.27,-20553.64 11002.77,-20543.64 10999.27,-20553.64 11006.27,-20553.64"/>
</g>
<!-- expert5_gelu_7 -->
<g id="node229" class="node">
<title>expert5_gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="11628.77" cy="-20790.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11628.77" y="-20802.21" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="11628.77" y="-20787.21" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11628.77" y="-20772.21" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert5_fc1_7&#45;&gt;expert5_gelu_7 -->
<g id="edge288" class="edge">
<title>expert5_fc1_7&#45;&gt;expert5_gelu_7</title>
<path fill="none" stroke="black" d="M11628.77,-20879.08C11628.77,-20865.49 11628.77,-20851.48 11628.77,-20838.77"/>
<polygon fill="black" stroke="black" points="11632.27,-20838.45 11628.77,-20828.45 11625.27,-20838.45 11632.27,-20838.45"/>
</g>
<!-- expert5_fc2_7 -->
<g id="node230" class="node">
<title>expert5_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="11932.31,-20716.44 11449.45,-20716.44 11325.23,-20580.44 11808.09,-20580.44 11932.31,-20716.44"/>
<text text-anchor="middle" x="11628.77" y="-20667.24" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="11628.77" y="-20652.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11628.77" y="-20637.24" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="11628.77" y="-20622.24" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_7&#45;&gt;expert5_fc2_7 -->
<g id="edge289" class="edge">
<title>expert5_gelu_7&#45;&gt;expert5_fc2_7</title>
<path fill="none" stroke="black" d="M11628.77,-20753.37C11628.77,-20745.07 11628.77,-20735.95 11628.77,-20726.67"/>
<polygon fill="black" stroke="black" points="11632.27,-20726.56 11628.77,-20716.56 11625.27,-20726.56 11632.27,-20726.56"/>
</g>
<!-- expert5_fc2_7&#45;&gt;expert_agg_7 -->
<g id="edge290" class="edge">
<title>expert5_fc2_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M11498.68,-20580.38C11414.35,-20536.92 11302.74,-20479.39 11206.76,-20429.91"/>
<polygon fill="black" stroke="black" points="11208.31,-20426.77 11197.81,-20425.3 11205.1,-20433 11208.31,-20426.77"/>
</g>
<!-- expert6_gelu_7 -->
<g id="node232" class="node">
<title>expert6_gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="12254.77" cy="-20790.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12254.77" y="-20802.21" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="12254.77" y="-20787.21" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12254.77" y="-20772.21" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert6_fc1_7&#45;&gt;expert6_gelu_7 -->
<g id="edge292" class="edge">
<title>expert6_fc1_7&#45;&gt;expert6_gelu_7</title>
<path fill="none" stroke="black" d="M12254.77,-20879.08C12254.77,-20865.49 12254.77,-20851.48 12254.77,-20838.77"/>
<polygon fill="black" stroke="black" points="12258.27,-20838.45 12254.77,-20828.45 12251.27,-20838.45 12258.27,-20838.45"/>
</g>
<!-- expert6_fc2_7 -->
<g id="node233" class="node">
<title>expert6_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="12558.31,-20716.44 12075.45,-20716.44 11951.23,-20580.44 12434.09,-20580.44 12558.31,-20716.44"/>
<text text-anchor="middle" x="12254.77" y="-20667.24" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="12254.77" y="-20652.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12254.77" y="-20637.24" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12254.77" y="-20622.24" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_7&#45;&gt;expert6_fc2_7 -->
<g id="edge293" class="edge">
<title>expert6_gelu_7&#45;&gt;expert6_fc2_7</title>
<path fill="none" stroke="black" d="M12254.77,-20753.37C12254.77,-20745.07 12254.77,-20735.95 12254.77,-20726.67"/>
<polygon fill="black" stroke="black" points="12258.27,-20726.56 12254.77,-20716.56 12251.27,-20726.56 12258.27,-20726.56"/>
</g>
<!-- expert6_fc2_7&#45;&gt;expert_agg_7 -->
<g id="edge294" class="edge">
<title>expert6_fc2_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M11994.59,-20580.38C11767.21,-20521.78 11440.63,-20437.61 11225.2,-20382.09"/>
<polygon fill="black" stroke="black" points="11225.9,-20378.66 11215.34,-20379.55 11224.15,-20385.44 11225.9,-20378.66"/>
</g>
<!-- expert7_gelu_7 -->
<g id="node235" class="node">
<title>expert7_gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="12880.77" cy="-20790.91" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12880.77" y="-20802.21" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="12880.77" y="-20787.21" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12880.77" y="-20772.21" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- expert7_fc1_7&#45;&gt;expert7_gelu_7 -->
<g id="edge296" class="edge">
<title>expert7_fc1_7&#45;&gt;expert7_gelu_7</title>
<path fill="none" stroke="black" d="M12880.77,-20879.08C12880.77,-20865.49 12880.77,-20851.48 12880.77,-20838.77"/>
<polygon fill="black" stroke="black" points="12884.27,-20838.45 12880.77,-20828.45 12877.27,-20838.45 12884.27,-20838.45"/>
</g>
<!-- expert7_fc2_7 -->
<g id="node236" class="node">
<title>expert7_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="13184.31,-20716.44 12701.45,-20716.44 12577.23,-20580.44 13060.09,-20580.44 13184.31,-20716.44"/>
<text text-anchor="middle" x="12880.77" y="-20667.24" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="12880.77" y="-20652.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12880.77" y="-20637.24" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="12880.77" y="-20622.24" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_7&#45;&gt;expert7_fc2_7 -->
<g id="edge297" class="edge">
<title>expert7_gelu_7&#45;&gt;expert7_fc2_7</title>
<path fill="none" stroke="black" d="M12880.77,-20753.37C12880.77,-20745.07 12880.77,-20735.95 12880.77,-20726.67"/>
<polygon fill="black" stroke="black" points="12884.27,-20726.56 12880.77,-20716.56 12877.27,-20726.56 12884.27,-20726.56"/>
</g>
<!-- expert7_fc2_7&#45;&gt;expert_agg_7 -->
<g id="edge298" class="edge">
<title>expert7_fc2_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M12578.89,-20582.55C12575.16,-20581.84 12571.45,-20581.13 12567.77,-20580.44 12093.8,-20491.05 11535.59,-20404.26 11230.43,-20358.39"/>
<polygon fill="black" stroke="black" points="11230.54,-20354.86 11220.13,-20356.84 11229.5,-20361.79 11230.54,-20354.86"/>
</g>
<!-- expert_agg_7&#45;&gt;residual2_7 -->
<g id="edge299" class="edge">
<title>expert_agg_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M11214.19,-20263.9C11442.4,-20200.36 11798.14,-20101.31 11984.47,-20049.43"/>
<polygon fill="black" stroke="black" points="11985.61,-20052.75 11994.3,-20046.69 11983.73,-20046 11985.61,-20052.75"/>
</g>
<!-- comm_7 -->
<g id="node239" class="node">
<title>comm_7</title>
<polygon fill="yellow" stroke="black" points="12225.51,-19862.71 12225.51,-19896.36 12156.54,-19920.16 12059,-19920.16 11990.03,-19896.36 11990.03,-19862.71 12059,-19838.91 12156.54,-19838.91 12225.51,-19862.71"/>
<polygon fill="none" stroke="black" points="12229.5,-19859.85 12229.5,-19899.22 12157.21,-19924.17 12058.33,-19924.17 11986.04,-19899.22 11986.04,-19859.85 12058.33,-19834.91 12157.21,-19834.91 12229.5,-19859.85"/>
<text text-anchor="middle" x="12107.77" y="-19890.84" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="12107.77" y="-19875.84" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="12107.77" y="-19860.84" font-family="Times,serif" font-size="14.00">GPU6→GPU7</text>
</g>
<!-- residual2_7&#45;&gt;comm_7 -->
<g id="edge301" class="edge">
<title>residual2_7&#45;&gt;comm_7</title>
<path fill="none" stroke="black" d="M12107.77,-19961.09C12107.77,-19952.33 12107.77,-19943.22 12107.77,-19934.42"/>
<polygon fill="black" stroke="black" points="12111.27,-19934.26 12107.77,-19924.26 12104.27,-19934.26 12111.27,-19934.26"/>
</g>
<!-- ln1_8 -->
<g id="node240" class="node">
<title>ln1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="12100.77,-19797.97 11956.77,-19797.97 11956.77,-19744.97 12100.77,-19744.97 12100.77,-19797.97"/>
<text text-anchor="middle" x="12028.77" y="-19782.77" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12028.77" y="-19767.77" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="12028.77" y="-19752.77" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- comm_7&#45;&gt;ln1_8 -->
<g id="edge302" class="edge">
<title>comm_7&#45;&gt;ln1_8</title>
<path fill="none" stroke="black" d="M12075.18,-19834.78C12068.09,-19825.26 12060.69,-19815.32 12053.93,-19806.26"/>
<polygon fill="black" stroke="black" points="12056.72,-19804.14 12047.94,-19798.21 12051.1,-19808.32 12056.72,-19804.14"/>
</g>
<!-- residual1_8 -->
<g id="node244" class="node">
<title>residual1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="12025.77,-19199.93 11732.77,-19146.93 12025.77,-19093.93 12318.77,-19146.93 12025.77,-19199.93"/>
<text text-anchor="middle" x="12025.77" y="-19158.23" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="12025.77" y="-19143.23" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="12025.77" y="-19128.23" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- comm_7&#45;&gt;residual1_8 -->
<g id="edge307" class="edge">
<title>comm_7&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12158.92,-19835.25C12174.1,-19817.7 12186.77,-19796.01 12186.77,-19772.47 12186.77,-19772.47 12186.77,-19772.47 12186.77,-19303.93 12186.77,-19272.85 12185.55,-19261.69 12166.77,-19236.93 12153.05,-19218.85 12134.52,-19203.49 12115.39,-19190.89"/>
<polygon fill="black" stroke="black" points="12117.2,-19187.89 12106.88,-19185.48 12113.44,-19193.8 12117.2,-19187.89"/>
<text text-anchor="middle" x="12215.77" y="-19542.77" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_8 -->
<g id="node241" class="node">
<title>qkv_proj_8</title>
<polygon fill="lightsteelblue" stroke="black" points="12158.31,-19707.97 11675.45,-19707.97 11551.23,-19571.97 12034.09,-19571.97 12158.31,-19707.97"/>
<text text-anchor="middle" x="11854.77" y="-19658.77" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11854.77" y="-19643.77" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="11854.77" y="-19628.77" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11854.77" y="-19613.77" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_8&#45;&gt;qkv_proj_8 -->
<g id="edge303" class="edge">
<title>ln1_8&#45;&gt;qkv_proj_8</title>
<path fill="none" stroke="black" d="M11994.39,-19744.89C11982.27,-19735.87 11967.98,-19725.23 11953.23,-19714.25"/>
<polygon fill="black" stroke="black" points="11955.12,-19711.29 11945,-19708.13 11950.94,-19716.91 11955.12,-19711.29"/>
</g>
<!-- mha_8 -->
<g id="node242" class="node">
<title>mha_8</title>
<polygon fill="lightsteelblue" stroke="black" points="12100.24,-19465.45 11980.5,-19520.99 11741.04,-19520.99 11621.3,-19465.45 11741.04,-19409.91 11980.5,-19409.91 12100.24,-19465.45"/>
<text text-anchor="middle" x="11860.77" y="-19484.25" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="11860.77" y="-19469.25" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="11860.77" y="-19454.25" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11860.77" y="-19439.25" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- qkv_proj_8&#45;&gt;mha_8 -->
<g id="edge304" class="edge">
<title>qkv_proj_8&#45;&gt;mha_8</title>
<path fill="none" stroke="black" d="M11857.11,-19571.78C11857.57,-19558.56 11858.05,-19544.72 11858.5,-19531.58"/>
<polygon fill="black" stroke="black" points="11862.01,-19531.33 11858.86,-19521.21 11855.02,-19531.08 11862.01,-19531.33"/>
</g>
<!-- out_proj_8 -->
<g id="node243" class="node">
<title>out_proj_8</title>
<polygon fill="lightsteelblue" stroke="black" points="12158.14,-19372.93 11689.86,-19372.93 11569.39,-19236.93 12037.68,-19236.93 12158.14,-19372.93"/>
<text text-anchor="middle" x="11863.77" y="-19323.73" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="11863.77" y="-19308.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11863.77" y="-19293.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11863.77" y="-19278.73" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_8&#45;&gt;out_proj_8 -->
<g id="edge305" class="edge">
<title>mha_8&#45;&gt;out_proj_8</title>
<path fill="none" stroke="black" d="M11861.8,-19409.9C11861.96,-19401.31 11862.13,-19392.29 11862.3,-19383.3"/>
<polygon fill="black" stroke="black" points="11865.81,-19383.26 11862.5,-19373.19 11858.81,-19383.12 11865.81,-19383.26"/>
</g>
<!-- out_proj_8&#45;&gt;residual1_8 -->
<g id="edge306" class="edge">
<title>out_proj_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M11933.41,-19236.87C11946.6,-19224.16 11960.2,-19211.07 11972.78,-19198.96"/>
<polygon fill="black" stroke="black" points="11975.27,-19201.41 11980.05,-19191.95 11970.42,-19196.37 11975.27,-19201.41"/>
</g>
<!-- ln2_8 -->
<g id="node245" class="node">
<title>ln2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="11784.77,-19056.93 11640.77,-19056.93 11640.77,-19003.93 11784.77,-19003.93 11784.77,-19056.93"/>
<text text-anchor="middle" x="11712.77" y="-19041.73" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11712.77" y="-19026.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="11712.77" y="-19011.73" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge308" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M11930.58,-19111.11C11886.37,-19094.93 11834.39,-19075.92 11792.3,-19060.52"/>
<polygon fill="black" stroke="black" points="11793.25,-19057.14 11782.66,-19057 11790.85,-19063.72 11793.25,-19057.14"/>
</g>
<!-- residual2_8 -->
<g id="node272" class="node">
<title>residual2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="11234.77,-17861.64 10941.77,-17808.64 11234.77,-17755.64 11527.77,-17808.64 11234.77,-17861.64"/>
<text text-anchor="middle" x="11234.77" y="-17819.94" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="11234.77" y="-17804.94" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="11234.77" y="-17789.94" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- residual1_8&#45;&gt;residual2_8 -->
<g id="edge343" class="edge">
<title>residual1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12168.99,-19119.83C12251.8,-19100.52 12339.77,-19070.74 12339.77,-19031.43 12339.77,-19031.43 12339.77,-19031.43 12339.77,-18117.31 12339.77,-17934.47 11771.21,-17855.63 11449.76,-17825.67"/>
<polygon fill="black" stroke="black" points="11449.65,-17822.14 11439.38,-17824.71 11449.01,-17829.11 11449.65,-17822.14"/>
<text text-anchor="middle" x="12368.77" y="-18644.73" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_8 -->
<g id="node246" class="node">
<title>gate_8</title>
<polygon fill="lightsteelblue" stroke="black" points="10279.86,-18966.93 9979.68,-18966.93 9872.77,-18860.93 10386.77,-18860.93 10279.86,-18966.93"/>
<text text-anchor="middle" x="10129.77" y="-18925.23" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="10129.77" y="-18910.23" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="10129.77" y="-18895.23" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- ln2_8&#45;&gt;gate_8 -->
<g id="edge309" class="edge">
<title>ln2_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M11640.64,-19024.21C11409.84,-19007.52 10683.86,-18955.01 10328.99,-18929.34"/>
<polygon fill="black" stroke="black" points="10329.09,-18925.84 10318.86,-18928.61 10328.59,-18932.82 10329.09,-18925.84"/>
</g>
<!-- expert0_fc1_8 -->
<g id="node247" class="node">
<title>expert0_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="7929.31,-18809.93 7446.45,-18809.93 7322.23,-18673.93 7805.09,-18673.93 7929.31,-18809.93"/>
<text text-anchor="middle" x="7625.77" y="-18760.73" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="7625.77" y="-18745.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7625.77" y="-18730.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7625.77" y="-18715.73" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_8&#45;&gt;expert0_fc1_8 -->
<g id="edge310" class="edge">
<title>gate_8&#45;&gt;expert0_fc1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9919.31,-18907.44C9447.6,-18894.42 8317.47,-18859.05 7938.77,-18809.93 7938.66,-18809.91 7938.55,-18809.9 7938.45,-18809.89"/>
<polygon fill="black" stroke="black" points="7938.76,-18806.4 7928.38,-18808.54 7937.83,-18813.34 7938.76,-18806.4"/>
<text text-anchor="middle" x="8347.27" y="-18831.73" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_8 -->
<g id="node250" class="node">
<title>expert1_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="8555.31,-18809.93 8072.45,-18809.93 7948.23,-18673.93 8431.09,-18673.93 8555.31,-18809.93"/>
<text text-anchor="middle" x="8251.77" y="-18760.73" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="8251.77" y="-18745.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8251.77" y="-18730.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="8251.77" y="-18715.73" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_8&#45;&gt;expert1_fc1_8 -->
<g id="edge314" class="edge">
<title>gate_8&#45;&gt;expert1_fc1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9920.89,-18908.81C9619.91,-18900.69 9047.34,-18877.1 8564.77,-18809.93 8564.55,-18809.9 8564.32,-18809.87 8564.1,-18809.84"/>
<polygon fill="black" stroke="black" points="8564.37,-18806.34 8553.98,-18808.38 8563.38,-18813.27 8564.37,-18806.34"/>
<text text-anchor="middle" x="8865.27" y="-18831.73" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_8 -->
<g id="node253" class="node">
<title>expert2_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="9181.31,-18809.93 8698.45,-18809.93 8574.23,-18673.93 9057.09,-18673.93 9181.31,-18809.93"/>
<text text-anchor="middle" x="8877.77" y="-18760.73" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="8877.77" y="-18745.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8877.77" y="-18730.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="8877.77" y="-18715.73" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_8&#45;&gt;expert2_fc1_8 -->
<g id="edge318" class="edge">
<title>gate_8&#45;&gt;expert2_fc1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9906.93,-18894.91C9716.13,-18877.95 9434.43,-18849.27 9190.77,-18809.93 9190.55,-18809.89 9190.32,-18809.86 9190.1,-18809.82"/>
<polygon fill="black" stroke="black" points="9190.45,-18806.33 9180.01,-18808.16 9189.31,-18813.24 9190.45,-18806.33"/>
<text text-anchor="middle" x="9441.27" y="-18831.73" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_8 -->
<g id="node256" class="node">
<title>expert3_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="9807.31,-18809.93 9324.45,-18809.93 9200.23,-18673.93 9683.09,-18673.93 9807.31,-18809.93"/>
<text text-anchor="middle" x="9503.77" y="-18760.73" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="9503.77" y="-18745.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9503.77" y="-18730.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9503.77" y="-18715.73" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_8&#45;&gt;expert3_fc1_8 -->
<g id="edge322" class="edge">
<title>gate_8&#45;&gt;expert3_fc1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9938.12,-18860.88C9882.1,-18845.67 9819.95,-18828.79 9760.59,-18812.67"/>
<polygon fill="black" stroke="black" points="9761.27,-18809.23 9750.7,-18809.99 9759.43,-18815.99 9761.27,-18809.23"/>
<text text-anchor="middle" x="9900.27" y="-18831.73" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_8 -->
<g id="node259" class="node">
<title>expert4_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="10433.31,-18809.93 9950.45,-18809.93 9826.23,-18673.93 10309.09,-18673.93 10433.31,-18809.93"/>
<text text-anchor="middle" x="10129.77" y="-18760.73" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="10129.77" y="-18745.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="10129.77" y="-18730.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10129.77" y="-18715.73" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_8&#45;&gt;expert4_fc1_8 -->
<g id="edge326" class="edge">
<title>gate_8&#45;&gt;expert4_fc1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10129.77,-18860.54C10129.77,-18847.86 10129.77,-18834.05 10129.77,-18820.5"/>
<polygon fill="black" stroke="black" points="10133.27,-18820.2 10129.77,-18810.2 10126.27,-18820.2 10133.27,-18820.2"/>
<text text-anchor="middle" x="10175.27" y="-18831.73" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_8 -->
<g id="node262" class="node">
<title>expert5_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="11059.31,-18809.93 10576.45,-18809.93 10452.23,-18673.93 10935.09,-18673.93 11059.31,-18809.93"/>
<text text-anchor="middle" x="10755.77" y="-18760.73" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="10755.77" y="-18745.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="10755.77" y="-18730.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10755.77" y="-18715.73" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_8&#45;&gt;expert5_fc1_8 -->
<g id="edge330" class="edge">
<title>gate_8&#45;&gt;expert5_fc1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10321.42,-18860.88C10394.78,-18840.96 10478.67,-18818.18 10553.04,-18797.98"/>
<polygon fill="black" stroke="black" points="10554.27,-18801.28 10563,-18795.28 10552.43,-18794.52 10554.27,-18801.28"/>
<text text-anchor="middle" x="10488.27" y="-18831.73" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_8 -->
<g id="node265" class="node">
<title>expert6_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="11685.31,-18809.93 11202.45,-18809.93 11078.23,-18673.93 11561.09,-18673.93 11685.31,-18809.93"/>
<text text-anchor="middle" x="11381.77" y="-18760.73" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="11381.77" y="-18745.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11381.77" y="-18730.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11381.77" y="-18715.73" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_8&#45;&gt;expert6_fc1_8 -->
<g id="edge334" class="edge">
<title>gate_8&#45;&gt;expert6_fc1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10352.6,-18894.91C10543.4,-18877.95 10825.11,-18849.27 11068.77,-18809.93 11102.47,-18804.49 11138.03,-18797.8 11172.6,-18790.78"/>
<polygon fill="black" stroke="black" points="11173.71,-18794.12 11182.81,-18788.69 11172.31,-18787.26 11173.71,-18794.12"/>
<text text-anchor="middle" x="10987.27" y="-18831.73" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_8 -->
<g id="node268" class="node">
<title>expert7_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="12311.31,-18809.93 11828.45,-18809.93 11704.23,-18673.93 12187.09,-18673.93 12311.31,-18809.93"/>
<text text-anchor="middle" x="12007.77" y="-18760.73" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="12007.77" y="-18745.73" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="12007.77" y="-18730.73" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="12007.77" y="-18715.73" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_8&#45;&gt;expert7_fc1_8 -->
<g id="edge338" class="edge">
<title>gate_8&#45;&gt;expert7_fc1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10338.65,-18908.81C10639.63,-18900.69 11212.19,-18877.1 11694.77,-18809.93 11728.98,-18805.17 11765.03,-18798.77 11800.01,-18791.81"/>
<polygon fill="black" stroke="black" points="11800.73,-18795.23 11809.84,-18789.83 11799.35,-18788.37 11800.73,-18795.23"/>
<text text-anchor="middle" x="11572.27" y="-18831.73" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_8 -->
<g id="node248" class="node">
<title>expert0_gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="7625.77" cy="-18585.45" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7625.77" y="-18596.75" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="7625.77" y="-18581.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7625.77" y="-18566.75" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert0_fc1_8&#45;&gt;expert0_gelu_8 -->
<g id="edge311" class="edge">
<title>expert0_fc1_8&#45;&gt;expert0_gelu_8</title>
<path fill="none" stroke="black" d="M7625.77,-18673.62C7625.77,-18660.03 7625.77,-18646.02 7625.77,-18633.31"/>
<polygon fill="black" stroke="black" points="7629.27,-18632.98 7625.77,-18622.98 7622.27,-18632.98 7629.27,-18632.98"/>
</g>
<!-- expert0_fc2_8 -->
<g id="node249" class="node">
<title>expert0_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="7929.31,-18510.98 7446.45,-18510.98 7322.23,-18374.98 7805.09,-18374.98 7929.31,-18510.98"/>
<text text-anchor="middle" x="7625.77" y="-18461.78" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="7625.77" y="-18446.78" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7625.77" y="-18431.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="7625.77" y="-18416.78" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_8&#45;&gt;expert0_fc2_8 -->
<g id="edge312" class="edge">
<title>expert0_gelu_8&#45;&gt;expert0_fc2_8</title>
<path fill="none" stroke="black" d="M7625.77,-18547.91C7625.77,-18539.61 7625.77,-18530.49 7625.77,-18521.21"/>
<polygon fill="black" stroke="black" points="7629.27,-18521.1 7625.77,-18511.1 7622.27,-18521.1 7629.27,-18521.1"/>
</g>
<!-- expert_agg_8 -->
<g id="node271" class="node">
<title>expert_agg_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="10129.77" cy="-18118.31" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="10129.77" cy="-18118.31" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="10129.77" y="-18129.61" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10129.77" y="-18114.61" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="10129.77" y="-18099.61" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert0_fc2_8&#45;&gt;expert_agg_8 -->
<g id="edge313" class="edge">
<title>expert0_fc2_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M7824.76,-18396.43C7862.5,-18388.63 7901.76,-18381.08 7938.77,-18374.98 8650.32,-18257.57 9500.61,-18174.55 9900.5,-18138.85"/>
<polygon fill="black" stroke="black" points="9901.08,-18142.32 9910.73,-18137.94 9900.46,-18135.34 9901.08,-18142.32"/>
</g>
<!-- expert1_gelu_8 -->
<g id="node251" class="node">
<title>expert1_gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="8251.77" cy="-18585.45" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8251.77" y="-18596.75" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="8251.77" y="-18581.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8251.77" y="-18566.75" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert1_fc1_8&#45;&gt;expert1_gelu_8 -->
<g id="edge315" class="edge">
<title>expert1_fc1_8&#45;&gt;expert1_gelu_8</title>
<path fill="none" stroke="black" d="M8251.77,-18673.62C8251.77,-18660.03 8251.77,-18646.02 8251.77,-18633.31"/>
<polygon fill="black" stroke="black" points="8255.27,-18632.98 8251.77,-18622.98 8248.27,-18632.98 8255.27,-18632.98"/>
</g>
<!-- expert1_fc2_8 -->
<g id="node252" class="node">
<title>expert1_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="8555.31,-18510.98 8072.45,-18510.98 7948.23,-18374.98 8431.09,-18374.98 8555.31,-18510.98"/>
<text text-anchor="middle" x="8251.77" y="-18461.78" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="8251.77" y="-18446.78" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8251.77" y="-18431.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="8251.77" y="-18416.78" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_8&#45;&gt;expert1_fc2_8 -->
<g id="edge316" class="edge">
<title>expert1_gelu_8&#45;&gt;expert1_fc2_8</title>
<path fill="none" stroke="black" d="M8251.77,-18547.91C8251.77,-18539.61 8251.77,-18530.49 8251.77,-18521.21"/>
<polygon fill="black" stroke="black" points="8255.27,-18521.1 8251.77,-18511.1 8248.27,-18521.1 8255.27,-18521.1"/>
</g>
<!-- expert1_fc2_8&#45;&gt;expert_agg_8 -->
<g id="edge317" class="edge">
<title>expert1_fc2_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M8451.84,-18397.62C8489.31,-18389.75 8528.18,-18381.88 8564.77,-18374.98 9038.74,-18285.59 9596.95,-18198.8 9902.11,-18152.93"/>
<polygon fill="black" stroke="black" points="9903.04,-18156.33 9912.41,-18151.38 9902,-18149.4 9903.04,-18156.33"/>
</g>
<!-- expert2_gelu_8 -->
<g id="node254" class="node">
<title>expert2_gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="8877.77" cy="-18585.45" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8877.77" y="-18596.75" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="8877.77" y="-18581.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8877.77" y="-18566.75" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert2_fc1_8&#45;&gt;expert2_gelu_8 -->
<g id="edge319" class="edge">
<title>expert2_fc1_8&#45;&gt;expert2_gelu_8</title>
<path fill="none" stroke="black" d="M8877.77,-18673.62C8877.77,-18660.03 8877.77,-18646.02 8877.77,-18633.31"/>
<polygon fill="black" stroke="black" points="8881.27,-18632.98 8877.77,-18622.98 8874.27,-18632.98 8881.27,-18632.98"/>
</g>
<!-- expert2_fc2_8 -->
<g id="node255" class="node">
<title>expert2_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="9181.31,-18510.98 8698.45,-18510.98 8574.23,-18374.98 9057.09,-18374.98 9181.31,-18510.98"/>
<text text-anchor="middle" x="8877.77" y="-18461.78" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="8877.77" y="-18446.78" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8877.77" y="-18431.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="8877.77" y="-18416.78" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_8&#45;&gt;expert2_fc2_8 -->
<g id="edge320" class="edge">
<title>expert2_gelu_8&#45;&gt;expert2_fc2_8</title>
<path fill="none" stroke="black" d="M8877.77,-18547.91C8877.77,-18539.61 8877.77,-18530.49 8877.77,-18521.21"/>
<polygon fill="black" stroke="black" points="8881.27,-18521.1 8877.77,-18511.1 8874.27,-18521.1 8881.27,-18521.1"/>
</g>
<!-- expert2_fc2_8&#45;&gt;expert_agg_8 -->
<g id="edge321" class="edge">
<title>expert2_fc2_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M9072.71,-18391.74C9298.7,-18333.49 9670.4,-18237.7 9907.45,-18176.61"/>
<polygon fill="black" stroke="black" points="9908.42,-18179.97 9917.23,-18174.08 9906.67,-18173.19 9908.42,-18179.97"/>
</g>
<!-- expert3_gelu_8 -->
<g id="node257" class="node">
<title>expert3_gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="9503.77" cy="-18585.45" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9503.77" y="-18596.75" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="9503.77" y="-18581.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9503.77" y="-18566.75" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert3_fc1_8&#45;&gt;expert3_gelu_8 -->
<g id="edge323" class="edge">
<title>expert3_fc1_8&#45;&gt;expert3_gelu_8</title>
<path fill="none" stroke="black" d="M9503.77,-18673.62C9503.77,-18660.03 9503.77,-18646.02 9503.77,-18633.31"/>
<polygon fill="black" stroke="black" points="9507.27,-18632.98 9503.77,-18622.98 9500.27,-18632.98 9507.27,-18632.98"/>
</g>
<!-- expert3_fc2_8 -->
<g id="node258" class="node">
<title>expert3_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="9807.31,-18510.98 9324.45,-18510.98 9200.23,-18374.98 9683.09,-18374.98 9807.31,-18510.98"/>
<text text-anchor="middle" x="9503.77" y="-18461.78" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="9503.77" y="-18446.78" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9503.77" y="-18431.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="9503.77" y="-18416.78" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_8&#45;&gt;expert3_fc2_8 -->
<g id="edge324" class="edge">
<title>expert3_gelu_8&#45;&gt;expert3_fc2_8</title>
<path fill="none" stroke="black" d="M9503.77,-18547.91C9503.77,-18539.61 9503.77,-18530.49 9503.77,-18521.21"/>
<polygon fill="black" stroke="black" points="9507.27,-18521.1 9503.77,-18511.1 9500.27,-18521.1 9507.27,-18521.1"/>
</g>
<!-- expert3_fc2_8&#45;&gt;expert_agg_8 -->
<g id="edge325" class="edge">
<title>expert3_fc2_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M9633.86,-18374.92C9718.18,-18331.46 9829.8,-18273.93 9925.78,-18224.45"/>
<polygon fill="black" stroke="black" points="9927.44,-18227.53 9934.72,-18219.84 9924.23,-18221.31 9927.44,-18227.53"/>
</g>
<!-- expert4_gelu_8 -->
<g id="node260" class="node">
<title>expert4_gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="10129.77" cy="-18585.45" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="10129.77" y="-18596.75" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="10129.77" y="-18581.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="10129.77" y="-18566.75" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert4_fc1_8&#45;&gt;expert4_gelu_8 -->
<g id="edge327" class="edge">
<title>expert4_fc1_8&#45;&gt;expert4_gelu_8</title>
<path fill="none" stroke="black" d="M10129.77,-18673.62C10129.77,-18660.03 10129.77,-18646.02 10129.77,-18633.31"/>
<polygon fill="black" stroke="black" points="10133.27,-18632.98 10129.77,-18622.98 10126.27,-18632.98 10133.27,-18632.98"/>
</g>
<!-- expert4_fc2_8 -->
<g id="node261" class="node">
<title>expert4_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="10433.31,-18510.98 9950.45,-18510.98 9826.23,-18374.98 10309.09,-18374.98 10433.31,-18510.98"/>
<text text-anchor="middle" x="10129.77" y="-18461.78" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="10129.77" y="-18446.78" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10129.77" y="-18431.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10129.77" y="-18416.78" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_8&#45;&gt;expert4_fc2_8 -->
<g id="edge328" class="edge">
<title>expert4_gelu_8&#45;&gt;expert4_fc2_8</title>
<path fill="none" stroke="black" d="M10129.77,-18547.91C10129.77,-18539.61 10129.77,-18530.49 10129.77,-18521.21"/>
<polygon fill="black" stroke="black" points="10133.27,-18521.1 10129.77,-18511.1 10126.27,-18521.1 10133.27,-18521.1"/>
</g>
<!-- expert4_fc2_8&#45;&gt;expert_agg_8 -->
<g id="edge329" class="edge">
<title>expert4_fc2_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M10129.77,-18374.73C10129.77,-18366.38 10129.77,-18357.53 10129.77,-18348.31"/>
<polygon fill="black" stroke="black" points="10133.27,-18348.17 10129.77,-18338.17 10126.27,-18348.17 10133.27,-18348.17"/>
</g>
<!-- expert5_gelu_8 -->
<g id="node263" class="node">
<title>expert5_gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="10755.77" cy="-18585.45" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="10755.77" y="-18596.75" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="10755.77" y="-18581.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="10755.77" y="-18566.75" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert5_fc1_8&#45;&gt;expert5_gelu_8 -->
<g id="edge331" class="edge">
<title>expert5_fc1_8&#45;&gt;expert5_gelu_8</title>
<path fill="none" stroke="black" d="M10755.77,-18673.62C10755.77,-18660.03 10755.77,-18646.02 10755.77,-18633.31"/>
<polygon fill="black" stroke="black" points="10759.27,-18632.98 10755.77,-18622.98 10752.27,-18632.98 10759.27,-18632.98"/>
</g>
<!-- expert5_fc2_8 -->
<g id="node264" class="node">
<title>expert5_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="11059.31,-18510.98 10576.45,-18510.98 10452.23,-18374.98 10935.09,-18374.98 11059.31,-18510.98"/>
<text text-anchor="middle" x="10755.77" y="-18461.78" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="10755.77" y="-18446.78" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10755.77" y="-18431.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="10755.77" y="-18416.78" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_8&#45;&gt;expert5_fc2_8 -->
<g id="edge332" class="edge">
<title>expert5_gelu_8&#45;&gt;expert5_fc2_8</title>
<path fill="none" stroke="black" d="M10755.77,-18547.91C10755.77,-18539.61 10755.77,-18530.49 10755.77,-18521.21"/>
<polygon fill="black" stroke="black" points="10759.27,-18521.1 10755.77,-18511.1 10752.27,-18521.1 10759.27,-18521.1"/>
</g>
<!-- expert5_fc2_8&#45;&gt;expert_agg_8 -->
<g id="edge333" class="edge">
<title>expert5_fc2_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M10625.68,-18374.92C10541.35,-18331.46 10429.74,-18273.93 10333.76,-18224.45"/>
<polygon fill="black" stroke="black" points="10335.31,-18221.31 10324.81,-18219.84 10332.1,-18227.53 10335.31,-18221.31"/>
</g>
<!-- expert6_gelu_8 -->
<g id="node266" class="node">
<title>expert6_gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="11381.77" cy="-18585.45" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11381.77" y="-18596.75" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="11381.77" y="-18581.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11381.77" y="-18566.75" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert6_fc1_8&#45;&gt;expert6_gelu_8 -->
<g id="edge335" class="edge">
<title>expert6_fc1_8&#45;&gt;expert6_gelu_8</title>
<path fill="none" stroke="black" d="M11381.77,-18673.62C11381.77,-18660.03 11381.77,-18646.02 11381.77,-18633.31"/>
<polygon fill="black" stroke="black" points="11385.27,-18632.98 11381.77,-18622.98 11378.27,-18632.98 11385.27,-18632.98"/>
</g>
<!-- expert6_fc2_8 -->
<g id="node267" class="node">
<title>expert6_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="11685.31,-18510.98 11202.45,-18510.98 11078.23,-18374.98 11561.09,-18374.98 11685.31,-18510.98"/>
<text text-anchor="middle" x="11381.77" y="-18461.78" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="11381.77" y="-18446.78" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11381.77" y="-18431.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="11381.77" y="-18416.78" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_8&#45;&gt;expert6_fc2_8 -->
<g id="edge336" class="edge">
<title>expert6_gelu_8&#45;&gt;expert6_fc2_8</title>
<path fill="none" stroke="black" d="M11381.77,-18547.91C11381.77,-18539.61 11381.77,-18530.49 11381.77,-18521.21"/>
<polygon fill="black" stroke="black" points="11385.27,-18521.1 11381.77,-18511.1 11378.27,-18521.1 11385.27,-18521.1"/>
</g>
<!-- expert6_fc2_8&#45;&gt;expert_agg_8 -->
<g id="edge337" class="edge">
<title>expert6_fc2_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M11121.59,-18374.92C10894.21,-18316.32 10567.63,-18232.15 10352.2,-18176.63"/>
<polygon fill="black" stroke="black" points="10352.9,-18173.2 10342.34,-18174.09 10351.15,-18179.98 10352.9,-18173.2"/>
</g>
<!-- expert7_gelu_8 -->
<g id="node269" class="node">
<title>expert7_gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="12007.77" cy="-18585.45" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="12007.77" y="-18596.75" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="12007.77" y="-18581.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="12007.77" y="-18566.75" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- expert7_fc1_8&#45;&gt;expert7_gelu_8 -->
<g id="edge339" class="edge">
<title>expert7_fc1_8&#45;&gt;expert7_gelu_8</title>
<path fill="none" stroke="black" d="M12007.77,-18673.62C12007.77,-18660.03 12007.77,-18646.02 12007.77,-18633.31"/>
<polygon fill="black" stroke="black" points="12011.27,-18632.98 12007.77,-18622.98 12004.27,-18632.98 12011.27,-18632.98"/>
</g>
<!-- expert7_fc2_8 -->
<g id="node270" class="node">
<title>expert7_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="12311.31,-18510.98 11828.45,-18510.98 11704.23,-18374.98 12187.09,-18374.98 12311.31,-18510.98"/>
<text text-anchor="middle" x="12007.77" y="-18461.78" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="12007.77" y="-18446.78" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="12007.77" y="-18431.78" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="12007.77" y="-18416.78" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_8&#45;&gt;expert7_fc2_8 -->
<g id="edge340" class="edge">
<title>expert7_gelu_8&#45;&gt;expert7_fc2_8</title>
<path fill="none" stroke="black" d="M12007.77,-18547.91C12007.77,-18539.61 12007.77,-18530.49 12007.77,-18521.21"/>
<polygon fill="black" stroke="black" points="12011.27,-18521.1 12007.77,-18511.1 12004.27,-18521.1 12011.27,-18521.1"/>
</g>
<!-- expert7_fc2_8&#45;&gt;expert_agg_8 -->
<g id="edge341" class="edge">
<title>expert7_fc2_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M11705.89,-18377.09C11702.16,-18376.38 11698.45,-18375.67 11694.77,-18374.98 11220.8,-18285.59 10662.59,-18198.8 10357.43,-18152.93"/>
<polygon fill="black" stroke="black" points="10357.54,-18149.4 10347.13,-18151.38 10356.5,-18156.33 10357.54,-18149.4"/>
</g>
<!-- expert_agg_8&#45;&gt;residual2_8 -->
<g id="edge342" class="edge">
<title>expert_agg_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M10341.19,-18058.44C10569.4,-17994.9 10925.14,-17895.85 11111.47,-17843.97"/>
<polygon fill="black" stroke="black" points="11112.61,-17847.29 11121.3,-17841.23 11110.73,-17840.54 11112.61,-17847.29"/>
</g>
<!-- comm_8 -->
<g id="node273" class="node">
<title>comm_8</title>
<polygon fill="yellow" stroke="black" points="11352.51,-17657.25 11352.51,-17690.9 11283.54,-17714.7 11186,-17714.7 11117.03,-17690.9 11117.03,-17657.25 11186,-17633.45 11283.54,-17633.45 11352.51,-17657.25"/>
<polygon fill="none" stroke="black" points="11356.5,-17654.39 11356.5,-17693.76 11284.21,-17718.7 11185.33,-17718.7 11113.04,-17693.76 11113.04,-17654.39 11185.33,-17629.45 11284.21,-17629.45 11356.5,-17654.39"/>
<text text-anchor="middle" x="11234.77" y="-17685.38" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="11234.77" y="-17670.38" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="11234.77" y="-17655.38" font-family="Times,serif" font-size="14.00">GPU7→GPU8</text>
</g>
<!-- residual2_8&#45;&gt;comm_8 -->
<g id="edge344" class="edge">
<title>residual2_8&#45;&gt;comm_8</title>
<path fill="none" stroke="black" d="M11234.77,-17755.63C11234.77,-17746.87 11234.77,-17737.76 11234.77,-17728.96"/>
<polygon fill="black" stroke="black" points="11238.27,-17728.8 11234.77,-17718.8 11231.27,-17728.8 11238.27,-17728.8"/>
</g>
<!-- ln1_9 -->
<g id="node274" class="node">
<title>ln1_9</title>
<polygon fill="lightsalmon" stroke="black" points="11227.77,-17592.51 11083.77,-17592.51 11083.77,-17539.51 11227.77,-17539.51 11227.77,-17592.51"/>
<text text-anchor="middle" x="11155.77" y="-17577.31" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11155.77" y="-17562.31" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="11155.77" y="-17547.31" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- comm_8&#45;&gt;ln1_9 -->
<g id="edge345" class="edge">
<title>comm_8&#45;&gt;ln1_9</title>
<path fill="none" stroke="black" d="M11202.18,-17629.32C11195.09,-17619.8 11187.69,-17609.86 11180.93,-17600.79"/>
<polygon fill="black" stroke="black" points="11183.72,-17598.68 11174.94,-17592.75 11178.1,-17602.86 11183.72,-17598.68"/>
</g>
<!-- residual1_9 -->
<g id="node278" class="node">
<title>residual1_9</title>
<polygon fill="lightsalmon" stroke="black" points="11152.77,-16994.47 10859.77,-16941.47 11152.77,-16888.47 11445.77,-16941.47 11152.77,-16994.47"/>
<text text-anchor="middle" x="11152.77" y="-16952.77" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="11152.77" y="-16937.77" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="11152.77" y="-16922.77" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- comm_8&#45;&gt;residual1_9 -->
<g id="edge350" class="edge">
<title>comm_8&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11285.92,-17629.79C11301.1,-17612.24 11313.77,-17590.55 11313.77,-17567.01 11313.77,-17567.01 11313.77,-17567.01 11313.77,-17098.47 11313.77,-17067.39 11312.55,-17056.23 11293.77,-17031.47 11280.05,-17013.39 11261.52,-16998.03 11242.39,-16985.43"/>
<polygon fill="black" stroke="black" points="11244.2,-16982.43 11233.88,-16980.02 11240.44,-16988.34 11244.2,-16982.43"/>
<text text-anchor="middle" x="11342.77" y="-17337.31" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_9 -->
<g id="node275" class="node">
<title>qkv_proj_9</title>
<polygon fill="lightsalmon" stroke="black" points="11285.31,-17502.51 10802.45,-17502.51 10678.23,-17366.51 11161.09,-17366.51 11285.31,-17502.51"/>
<text text-anchor="middle" x="10981.77" y="-17453.31" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10981.77" y="-17438.31" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="10981.77" y="-17423.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="10981.77" y="-17408.31" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_9&#45;&gt;qkv_proj_9 -->
<g id="edge346" class="edge">
<title>ln1_9&#45;&gt;qkv_proj_9</title>
<path fill="none" stroke="black" d="M11121.39,-17539.43C11109.27,-17530.41 11094.98,-17519.77 11080.23,-17508.79"/>
<polygon fill="black" stroke="black" points="11082.12,-17505.83 11072,-17502.67 11077.94,-17511.45 11082.12,-17505.83"/>
</g>
<!-- mha_9 -->
<g id="node276" class="node">
<title>mha_9</title>
<polygon fill="lightsalmon" stroke="black" points="11227.24,-17259.99 11107.5,-17315.53 10868.04,-17315.53 10748.3,-17259.99 10868.04,-17204.45 11107.5,-17204.45 11227.24,-17259.99"/>
<text text-anchor="middle" x="10987.77" y="-17278.79" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10987.77" y="-17263.79" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="10987.77" y="-17248.79" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10987.77" y="-17233.79" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- qkv_proj_9&#45;&gt;mha_9 -->
<g id="edge347" class="edge">
<title>qkv_proj_9&#45;&gt;mha_9</title>
<path fill="none" stroke="black" d="M10984.11,-17366.32C10984.57,-17353.1 10985.05,-17339.26 10985.5,-17326.12"/>
<polygon fill="black" stroke="black" points="10989.01,-17325.86 10985.86,-17315.75 10982.02,-17325.62 10989.01,-17325.86"/>
</g>
<!-- out_proj_9 -->
<g id="node277" class="node">
<title>out_proj_9</title>
<polygon fill="lightsalmon" stroke="black" points="11285.14,-17167.47 10816.86,-17167.47 10696.39,-17031.47 11164.68,-17031.47 11285.14,-17167.47"/>
<text text-anchor="middle" x="10990.77" y="-17118.27" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10990.77" y="-17103.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10990.77" y="-17088.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="10990.77" y="-17073.27" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_9&#45;&gt;out_proj_9 -->
<g id="edge348" class="edge">
<title>mha_9&#45;&gt;out_proj_9</title>
<path fill="none" stroke="black" d="M10988.8,-17204.44C10988.96,-17195.85 10989.13,-17186.83 10989.3,-17177.84"/>
<polygon fill="black" stroke="black" points="10992.81,-17177.8 10989.5,-17167.73 10985.81,-17177.66 10992.81,-17177.8"/>
</g>
<!-- out_proj_9&#45;&gt;residual1_9 -->
<g id="edge349" class="edge">
<title>out_proj_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M11060.41,-17031.4C11073.6,-17018.7 11087.2,-17005.61 11099.78,-16993.5"/>
<polygon fill="black" stroke="black" points="11102.27,-16995.95 11107.05,-16986.49 11097.42,-16990.91 11102.27,-16995.95"/>
</g>
<!-- ln2_9 -->
<g id="node279" class="node">
<title>ln2_9</title>
<polygon fill="lightsalmon" stroke="black" points="10911.77,-16851.47 10767.77,-16851.47 10767.77,-16798.47 10911.77,-16798.47 10911.77,-16851.47"/>
<text text-anchor="middle" x="10839.77" y="-16836.27" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10839.77" y="-16821.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="10839.77" y="-16806.27" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge351" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M11057.58,-16905.65C11013.37,-16889.47 10961.39,-16870.46 10919.3,-16855.06"/>
<polygon fill="black" stroke="black" points="10920.25,-16851.68 10909.66,-16851.53 10917.85,-16858.26 10920.25,-16851.68"/>
</g>
<!-- residual2_9 -->
<g id="node306" class="node">
<title>residual2_9</title>
<polygon fill="lightsalmon" stroke="black" points="10361.77,-15656.18 10068.77,-15603.18 10361.77,-15550.18 10654.77,-15603.18 10361.77,-15656.18"/>
<text text-anchor="middle" x="10361.77" y="-15614.48" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="10361.77" y="-15599.48" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="10361.77" y="-15584.48" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- residual1_9&#45;&gt;residual2_9 -->
<g id="edge386" class="edge">
<title>residual1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11295.99,-16914.37C11378.8,-16895.05 11466.77,-16865.28 11466.77,-16825.97 11466.77,-16825.97 11466.77,-16825.97 11466.77,-15911.85 11466.77,-15729.01 10898.21,-15650.17 10576.76,-15620.21"/>
<polygon fill="black" stroke="black" points="10576.65,-15616.68 10566.38,-15619.25 10576.01,-15623.65 10576.65,-15616.68"/>
<text text-anchor="middle" x="11495.77" y="-16439.27" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_9 -->
<g id="node280" class="node">
<title>gate_9</title>
<polygon fill="lightsalmon" stroke="black" points="9406.86,-16761.47 9106.68,-16761.47 8999.77,-16655.47 9513.77,-16655.47 9406.86,-16761.47"/>
<text text-anchor="middle" x="9256.77" y="-16719.77" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="9256.77" y="-16704.77" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="9256.77" y="-16689.77" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- ln2_9&#45;&gt;gate_9 -->
<g id="edge352" class="edge">
<title>ln2_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M10767.64,-16818.75C10536.84,-16802.06 9810.86,-16749.55 9455.99,-16723.88"/>
<polygon fill="black" stroke="black" points="9456.09,-16720.38 9445.86,-16723.15 9455.59,-16727.36 9456.09,-16720.38"/>
</g>
<!-- expert0_fc1_9 -->
<g id="node281" class="node">
<title>expert0_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="7056.31,-16604.47 6573.45,-16604.47 6449.23,-16468.47 6932.09,-16468.47 7056.31,-16604.47"/>
<text text-anchor="middle" x="6752.77" y="-16555.27" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="6752.77" y="-16540.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6752.77" y="-16525.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6752.77" y="-16510.27" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_9&#45;&gt;expert0_fc1_9 -->
<g id="edge353" class="edge">
<title>gate_9&#45;&gt;expert0_fc1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9046.31,-16701.98C8574.6,-16688.96 7444.47,-16653.59 7065.77,-16604.47 7065.66,-16604.45 7065.55,-16604.44 7065.45,-16604.43"/>
<polygon fill="black" stroke="black" points="7065.76,-16600.94 7055.38,-16603.07 7064.83,-16607.87 7065.76,-16600.94"/>
<text text-anchor="middle" x="7474.27" y="-16626.27" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_9 -->
<g id="node284" class="node">
<title>expert1_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="7682.31,-16604.47 7199.45,-16604.47 7075.23,-16468.47 7558.09,-16468.47 7682.31,-16604.47"/>
<text text-anchor="middle" x="7378.77" y="-16555.27" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="7378.77" y="-16540.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7378.77" y="-16525.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7378.77" y="-16510.27" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_9&#45;&gt;expert1_fc1_9 -->
<g id="edge357" class="edge">
<title>gate_9&#45;&gt;expert1_fc1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9047.89,-16703.35C8746.91,-16695.23 8174.34,-16671.64 7691.77,-16604.47 7691.55,-16604.44 7691.32,-16604.41 7691.1,-16604.37"/>
<polygon fill="black" stroke="black" points="7691.37,-16600.88 7680.98,-16602.92 7690.38,-16607.81 7691.37,-16600.88"/>
<text text-anchor="middle" x="7992.27" y="-16626.27" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_9 -->
<g id="node287" class="node">
<title>expert2_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="8308.31,-16604.47 7825.45,-16604.47 7701.23,-16468.47 8184.09,-16468.47 8308.31,-16604.47"/>
<text text-anchor="middle" x="8004.77" y="-16555.27" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="8004.77" y="-16540.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8004.77" y="-16525.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8004.77" y="-16510.27" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_9&#45;&gt;expert2_fc1_9 -->
<g id="edge361" class="edge">
<title>gate_9&#45;&gt;expert2_fc1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9033.93,-16689.45C8843.13,-16672.49 8561.43,-16643.81 8317.77,-16604.47 8317.55,-16604.43 8317.32,-16604.4 8317.1,-16604.36"/>
<polygon fill="black" stroke="black" points="8317.45,-16600.87 8307.01,-16602.7 8316.31,-16607.78 8317.45,-16600.87"/>
<text text-anchor="middle" x="8568.27" y="-16626.27" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_9 -->
<g id="node290" class="node">
<title>expert3_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="8934.31,-16604.47 8451.45,-16604.47 8327.23,-16468.47 8810.09,-16468.47 8934.31,-16604.47"/>
<text text-anchor="middle" x="8630.77" y="-16555.27" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="8630.77" y="-16540.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8630.77" y="-16525.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8630.77" y="-16510.27" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_9&#45;&gt;expert3_fc1_9 -->
<g id="edge365" class="edge">
<title>gate_9&#45;&gt;expert3_fc1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9065.12,-16655.42C9009.1,-16640.21 8946.95,-16623.33 8887.59,-16607.21"/>
<polygon fill="black" stroke="black" points="8888.27,-16603.77 8877.7,-16604.53 8886.43,-16610.52 8888.27,-16603.77"/>
<text text-anchor="middle" x="9027.27" y="-16626.27" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_9 -->
<g id="node293" class="node">
<title>expert4_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="9560.31,-16604.47 9077.45,-16604.47 8953.23,-16468.47 9436.09,-16468.47 9560.31,-16604.47"/>
<text text-anchor="middle" x="9256.77" y="-16555.27" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="9256.77" y="-16540.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9256.77" y="-16525.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="9256.77" y="-16510.27" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_9&#45;&gt;expert4_fc1_9 -->
<g id="edge369" class="edge">
<title>gate_9&#45;&gt;expert4_fc1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9256.77,-16655.08C9256.77,-16642.4 9256.77,-16628.59 9256.77,-16615.03"/>
<polygon fill="black" stroke="black" points="9260.27,-16614.74 9256.77,-16604.74 9253.27,-16614.74 9260.27,-16614.74"/>
<text text-anchor="middle" x="9302.27" y="-16626.27" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_9 -->
<g id="node296" class="node">
<title>expert5_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="10186.31,-16604.47 9703.45,-16604.47 9579.23,-16468.47 10062.09,-16468.47 10186.31,-16604.47"/>
<text text-anchor="middle" x="9882.77" y="-16555.27" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="9882.77" y="-16540.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9882.77" y="-16525.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="9882.77" y="-16510.27" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_9&#45;&gt;expert5_fc1_9 -->
<g id="edge373" class="edge">
<title>gate_9&#45;&gt;expert5_fc1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9448.42,-16655.42C9521.78,-16635.5 9605.67,-16612.72 9680.04,-16592.52"/>
<polygon fill="black" stroke="black" points="9681.27,-16595.82 9690,-16589.82 9679.43,-16589.06 9681.27,-16595.82"/>
<text text-anchor="middle" x="9615.27" y="-16626.27" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_9 -->
<g id="node299" class="node">
<title>expert6_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="10812.31,-16604.47 10329.45,-16604.47 10205.23,-16468.47 10688.09,-16468.47 10812.31,-16604.47"/>
<text text-anchor="middle" x="10508.77" y="-16555.27" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="10508.77" y="-16540.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="10508.77" y="-16525.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="10508.77" y="-16510.27" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_9&#45;&gt;expert6_fc1_9 -->
<g id="edge377" class="edge">
<title>gate_9&#45;&gt;expert6_fc1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9479.6,-16689.45C9670.4,-16672.49 9952.11,-16643.81 10195.77,-16604.47 10229.47,-16599.03 10265.03,-16592.34 10299.6,-16585.31"/>
<polygon fill="black" stroke="black" points="10300.71,-16588.66 10309.81,-16583.23 10299.31,-16581.8 10300.71,-16588.66"/>
<text text-anchor="middle" x="10114.27" y="-16626.27" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_9 -->
<g id="node302" class="node">
<title>expert7_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="11438.31,-16604.47 10955.45,-16604.47 10831.23,-16468.47 11314.09,-16468.47 11438.31,-16604.47"/>
<text text-anchor="middle" x="11134.77" y="-16555.27" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="11134.77" y="-16540.27" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="11134.77" y="-16525.27" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="11134.77" y="-16510.27" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_9&#45;&gt;expert7_fc1_9 -->
<g id="edge381" class="edge">
<title>gate_9&#45;&gt;expert7_fc1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9465.65,-16703.35C9766.63,-16695.23 10339.19,-16671.64 10821.77,-16604.47 10855.98,-16599.71 10892.03,-16593.31 10927.01,-16586.35"/>
<polygon fill="black" stroke="black" points="10927.73,-16589.77 10936.84,-16584.37 10926.35,-16582.91 10927.73,-16589.77"/>
<text text-anchor="middle" x="10699.27" y="-16626.27" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_9 -->
<g id="node282" class="node">
<title>expert0_gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="6752.77" cy="-16379.99" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6752.77" y="-16391.29" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="6752.77" y="-16376.29" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6752.77" y="-16361.29" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert0_fc1_9&#45;&gt;expert0_gelu_9 -->
<g id="edge354" class="edge">
<title>expert0_fc1_9&#45;&gt;expert0_gelu_9</title>
<path fill="none" stroke="black" d="M6752.77,-16468.16C6752.77,-16454.57 6752.77,-16440.56 6752.77,-16427.85"/>
<polygon fill="black" stroke="black" points="6756.27,-16427.52 6752.77,-16417.52 6749.27,-16427.52 6756.27,-16427.52"/>
</g>
<!-- expert0_fc2_9 -->
<g id="node283" class="node">
<title>expert0_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="7056.31,-16305.51 6573.45,-16305.51 6449.23,-16169.51 6932.09,-16169.51 7056.31,-16305.51"/>
<text text-anchor="middle" x="6752.77" y="-16256.31" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="6752.77" y="-16241.31" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6752.77" y="-16226.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="6752.77" y="-16211.31" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_9&#45;&gt;expert0_fc2_9 -->
<g id="edge355" class="edge">
<title>expert0_gelu_9&#45;&gt;expert0_fc2_9</title>
<path fill="none" stroke="black" d="M6752.77,-16342.45C6752.77,-16334.15 6752.77,-16325.03 6752.77,-16315.74"/>
<polygon fill="black" stroke="black" points="6756.27,-16315.64 6752.77,-16305.64 6749.27,-16315.64 6756.27,-16315.64"/>
</g>
<!-- expert_agg_9 -->
<g id="node305" class="node">
<title>expert_agg_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="9256.77" cy="-15912.85" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="9256.77" cy="-15912.85" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="9256.77" y="-15924.15" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="9256.77" y="-15909.15" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="9256.77" y="-15894.15" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert0_fc2_9&#45;&gt;expert_agg_9 -->
<g id="edge356" class="edge">
<title>expert0_fc2_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M6951.76,-16190.96C6989.5,-16183.17 7028.76,-16175.62 7065.77,-16169.51 7777.32,-16052.11 8627.61,-15969.09 9027.5,-15933.39"/>
<polygon fill="black" stroke="black" points="9028.08,-15936.85 9037.73,-15932.48 9027.46,-15929.88 9028.08,-15936.85"/>
</g>
<!-- expert1_gelu_9 -->
<g id="node285" class="node">
<title>expert1_gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="7378.77" cy="-16379.99" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7378.77" y="-16391.29" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="7378.77" y="-16376.29" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7378.77" y="-16361.29" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert1_fc1_9&#45;&gt;expert1_gelu_9 -->
<g id="edge358" class="edge">
<title>expert1_fc1_9&#45;&gt;expert1_gelu_9</title>
<path fill="none" stroke="black" d="M7378.77,-16468.16C7378.77,-16454.57 7378.77,-16440.56 7378.77,-16427.85"/>
<polygon fill="black" stroke="black" points="7382.27,-16427.52 7378.77,-16417.52 7375.27,-16427.52 7382.27,-16427.52"/>
</g>
<!-- expert1_fc2_9 -->
<g id="node286" class="node">
<title>expert1_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="7682.31,-16305.51 7199.45,-16305.51 7075.23,-16169.51 7558.09,-16169.51 7682.31,-16305.51"/>
<text text-anchor="middle" x="7378.77" y="-16256.31" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="7378.77" y="-16241.31" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7378.77" y="-16226.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="7378.77" y="-16211.31" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_9&#45;&gt;expert1_fc2_9 -->
<g id="edge359" class="edge">
<title>expert1_gelu_9&#45;&gt;expert1_fc2_9</title>
<path fill="none" stroke="black" d="M7378.77,-16342.45C7378.77,-16334.15 7378.77,-16325.03 7378.77,-16315.74"/>
<polygon fill="black" stroke="black" points="7382.27,-16315.64 7378.77,-16305.64 7375.27,-16315.64 7382.27,-16315.64"/>
</g>
<!-- expert1_fc2_9&#45;&gt;expert_agg_9 -->
<g id="edge360" class="edge">
<title>expert1_fc2_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M7578.84,-16192.16C7616.31,-16184.29 7655.18,-16176.41 7691.77,-16169.51 8165.74,-16080.13 8723.95,-15993.34 9029.11,-15947.46"/>
<polygon fill="black" stroke="black" points="9030.04,-15950.86 9039.41,-15945.92 9029,-15943.94 9030.04,-15950.86"/>
</g>
<!-- expert2_gelu_9 -->
<g id="node288" class="node">
<title>expert2_gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="8004.77" cy="-16379.99" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8004.77" y="-16391.29" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="8004.77" y="-16376.29" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8004.77" y="-16361.29" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert2_fc1_9&#45;&gt;expert2_gelu_9 -->
<g id="edge362" class="edge">
<title>expert2_fc1_9&#45;&gt;expert2_gelu_9</title>
<path fill="none" stroke="black" d="M8004.77,-16468.16C8004.77,-16454.57 8004.77,-16440.56 8004.77,-16427.85"/>
<polygon fill="black" stroke="black" points="8008.27,-16427.52 8004.77,-16417.52 8001.27,-16427.52 8008.27,-16427.52"/>
</g>
<!-- expert2_fc2_9 -->
<g id="node289" class="node">
<title>expert2_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="8308.31,-16305.51 7825.45,-16305.51 7701.23,-16169.51 8184.09,-16169.51 8308.31,-16305.51"/>
<text text-anchor="middle" x="8004.77" y="-16256.31" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="8004.77" y="-16241.31" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8004.77" y="-16226.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8004.77" y="-16211.31" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_9&#45;&gt;expert2_fc2_9 -->
<g id="edge363" class="edge">
<title>expert2_gelu_9&#45;&gt;expert2_fc2_9</title>
<path fill="none" stroke="black" d="M8004.77,-16342.45C8004.77,-16334.15 8004.77,-16325.03 8004.77,-16315.74"/>
<polygon fill="black" stroke="black" points="8008.27,-16315.64 8004.77,-16305.64 8001.27,-16315.64 8008.27,-16315.64"/>
</g>
<!-- expert2_fc2_9&#45;&gt;expert_agg_9 -->
<g id="edge364" class="edge">
<title>expert2_fc2_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M8199.71,-16186.27C8425.7,-16128.03 8797.4,-16032.24 9034.45,-15971.14"/>
<polygon fill="black" stroke="black" points="9035.42,-15974.51 9044.23,-15968.62 9033.67,-15967.73 9035.42,-15974.51"/>
</g>
<!-- expert3_gelu_9 -->
<g id="node291" class="node">
<title>expert3_gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="8630.77" cy="-16379.99" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8630.77" y="-16391.29" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="8630.77" y="-16376.29" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8630.77" y="-16361.29" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert3_fc1_9&#45;&gt;expert3_gelu_9 -->
<g id="edge366" class="edge">
<title>expert3_fc1_9&#45;&gt;expert3_gelu_9</title>
<path fill="none" stroke="black" d="M8630.77,-16468.16C8630.77,-16454.57 8630.77,-16440.56 8630.77,-16427.85"/>
<polygon fill="black" stroke="black" points="8634.27,-16427.52 8630.77,-16417.52 8627.27,-16427.52 8634.27,-16427.52"/>
</g>
<!-- expert3_fc2_9 -->
<g id="node292" class="node">
<title>expert3_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="8934.31,-16305.51 8451.45,-16305.51 8327.23,-16169.51 8810.09,-16169.51 8934.31,-16305.51"/>
<text text-anchor="middle" x="8630.77" y="-16256.31" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="8630.77" y="-16241.31" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8630.77" y="-16226.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="8630.77" y="-16211.31" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_9&#45;&gt;expert3_fc2_9 -->
<g id="edge367" class="edge">
<title>expert3_gelu_9&#45;&gt;expert3_fc2_9</title>
<path fill="none" stroke="black" d="M8630.77,-16342.45C8630.77,-16334.15 8630.77,-16325.03 8630.77,-16315.74"/>
<polygon fill="black" stroke="black" points="8634.27,-16315.64 8630.77,-16305.64 8627.27,-16315.64 8634.27,-16315.64"/>
</g>
<!-- expert3_fc2_9&#45;&gt;expert_agg_9 -->
<g id="edge368" class="edge">
<title>expert3_fc2_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M8760.86,-16169.46C8845.18,-16126 8956.8,-16068.47 9052.78,-16018.99"/>
<polygon fill="black" stroke="black" points="9054.44,-16022.07 9061.72,-16014.38 9051.23,-16015.85 9054.44,-16022.07"/>
</g>
<!-- expert4_gelu_9 -->
<g id="node294" class="node">
<title>expert4_gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="9256.77" cy="-16379.99" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9256.77" y="-16391.29" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="9256.77" y="-16376.29" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9256.77" y="-16361.29" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert4_fc1_9&#45;&gt;expert4_gelu_9 -->
<g id="edge370" class="edge">
<title>expert4_fc1_9&#45;&gt;expert4_gelu_9</title>
<path fill="none" stroke="black" d="M9256.77,-16468.16C9256.77,-16454.57 9256.77,-16440.56 9256.77,-16427.85"/>
<polygon fill="black" stroke="black" points="9260.27,-16427.52 9256.77,-16417.52 9253.27,-16427.52 9260.27,-16427.52"/>
</g>
<!-- expert4_fc2_9 -->
<g id="node295" class="node">
<title>expert4_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="9560.31,-16305.51 9077.45,-16305.51 8953.23,-16169.51 9436.09,-16169.51 9560.31,-16305.51"/>
<text text-anchor="middle" x="9256.77" y="-16256.31" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="9256.77" y="-16241.31" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9256.77" y="-16226.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="9256.77" y="-16211.31" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_9&#45;&gt;expert4_fc2_9 -->
<g id="edge371" class="edge">
<title>expert4_gelu_9&#45;&gt;expert4_fc2_9</title>
<path fill="none" stroke="black" d="M9256.77,-16342.45C9256.77,-16334.15 9256.77,-16325.03 9256.77,-16315.74"/>
<polygon fill="black" stroke="black" points="9260.27,-16315.64 9256.77,-16305.64 9253.27,-16315.64 9260.27,-16315.64"/>
</g>
<!-- expert4_fc2_9&#45;&gt;expert_agg_9 -->
<g id="edge372" class="edge">
<title>expert4_fc2_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M9256.77,-16169.27C9256.77,-16160.92 9256.77,-16152.07 9256.77,-16142.85"/>
<polygon fill="black" stroke="black" points="9260.27,-16142.71 9256.77,-16132.71 9253.27,-16142.71 9260.27,-16142.71"/>
</g>
<!-- expert5_gelu_9 -->
<g id="node297" class="node">
<title>expert5_gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="9882.77" cy="-16379.99" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9882.77" y="-16391.29" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="9882.77" y="-16376.29" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9882.77" y="-16361.29" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert5_fc1_9&#45;&gt;expert5_gelu_9 -->
<g id="edge374" class="edge">
<title>expert5_fc1_9&#45;&gt;expert5_gelu_9</title>
<path fill="none" stroke="black" d="M9882.77,-16468.16C9882.77,-16454.57 9882.77,-16440.56 9882.77,-16427.85"/>
<polygon fill="black" stroke="black" points="9886.27,-16427.52 9882.77,-16417.52 9879.27,-16427.52 9886.27,-16427.52"/>
</g>
<!-- expert5_fc2_9 -->
<g id="node298" class="node">
<title>expert5_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="10186.31,-16305.51 9703.45,-16305.51 9579.23,-16169.51 10062.09,-16169.51 10186.31,-16305.51"/>
<text text-anchor="middle" x="9882.77" y="-16256.31" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="9882.77" y="-16241.31" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9882.77" y="-16226.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="9882.77" y="-16211.31" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_9&#45;&gt;expert5_fc2_9 -->
<g id="edge375" class="edge">
<title>expert5_gelu_9&#45;&gt;expert5_fc2_9</title>
<path fill="none" stroke="black" d="M9882.77,-16342.45C9882.77,-16334.15 9882.77,-16325.03 9882.77,-16315.74"/>
<polygon fill="black" stroke="black" points="9886.27,-16315.64 9882.77,-16305.64 9879.27,-16315.64 9886.27,-16315.64"/>
</g>
<!-- expert5_fc2_9&#45;&gt;expert_agg_9 -->
<g id="edge376" class="edge">
<title>expert5_fc2_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M9752.68,-16169.46C9668.35,-16126 9556.74,-16068.47 9460.76,-16018.99"/>
<polygon fill="black" stroke="black" points="9462.31,-16015.85 9451.81,-16014.38 9459.1,-16022.07 9462.31,-16015.85"/>
</g>
<!-- expert6_gelu_9 -->
<g id="node300" class="node">
<title>expert6_gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="10508.77" cy="-16379.99" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="10508.77" y="-16391.29" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="10508.77" y="-16376.29" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="10508.77" y="-16361.29" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert6_fc1_9&#45;&gt;expert6_gelu_9 -->
<g id="edge378" class="edge">
<title>expert6_fc1_9&#45;&gt;expert6_gelu_9</title>
<path fill="none" stroke="black" d="M10508.77,-16468.16C10508.77,-16454.57 10508.77,-16440.56 10508.77,-16427.85"/>
<polygon fill="black" stroke="black" points="10512.27,-16427.52 10508.77,-16417.52 10505.27,-16427.52 10512.27,-16427.52"/>
</g>
<!-- expert6_fc2_9 -->
<g id="node301" class="node">
<title>expert6_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="10812.31,-16305.51 10329.45,-16305.51 10205.23,-16169.51 10688.09,-16169.51 10812.31,-16305.51"/>
<text text-anchor="middle" x="10508.77" y="-16256.31" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="10508.77" y="-16241.31" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10508.77" y="-16226.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="10508.77" y="-16211.31" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_9&#45;&gt;expert6_fc2_9 -->
<g id="edge379" class="edge">
<title>expert6_gelu_9&#45;&gt;expert6_fc2_9</title>
<path fill="none" stroke="black" d="M10508.77,-16342.45C10508.77,-16334.15 10508.77,-16325.03 10508.77,-16315.74"/>
<polygon fill="black" stroke="black" points="10512.27,-16315.64 10508.77,-16305.64 10505.27,-16315.64 10512.27,-16315.64"/>
</g>
<!-- expert6_fc2_9&#45;&gt;expert_agg_9 -->
<g id="edge380" class="edge">
<title>expert6_fc2_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M10248.59,-16169.46C10021.21,-16110.86 9694.63,-16026.69 9479.2,-15971.17"/>
<polygon fill="black" stroke="black" points="9479.9,-15967.74 9469.34,-15968.63 9478.15,-15974.52 9479.9,-15967.74"/>
</g>
<!-- expert7_gelu_9 -->
<g id="node303" class="node">
<title>expert7_gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="11134.77" cy="-16379.99" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="11134.77" y="-16391.29" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="11134.77" y="-16376.29" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="11134.77" y="-16361.29" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- expert7_fc1_9&#45;&gt;expert7_gelu_9 -->
<g id="edge382" class="edge">
<title>expert7_fc1_9&#45;&gt;expert7_gelu_9</title>
<path fill="none" stroke="black" d="M11134.77,-16468.16C11134.77,-16454.57 11134.77,-16440.56 11134.77,-16427.85"/>
<polygon fill="black" stroke="black" points="11138.27,-16427.52 11134.77,-16417.52 11131.27,-16427.52 11138.27,-16427.52"/>
</g>
<!-- expert7_fc2_9 -->
<g id="node304" class="node">
<title>expert7_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="11438.31,-16305.51 10955.45,-16305.51 10831.23,-16169.51 11314.09,-16169.51 11438.31,-16305.51"/>
<text text-anchor="middle" x="11134.77" y="-16256.31" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="11134.77" y="-16241.31" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="11134.77" y="-16226.31" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="11134.77" y="-16211.31" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_9&#45;&gt;expert7_fc2_9 -->
<g id="edge383" class="edge">
<title>expert7_gelu_9&#45;&gt;expert7_fc2_9</title>
<path fill="none" stroke="black" d="M11134.77,-16342.45C11134.77,-16334.15 11134.77,-16325.03 11134.77,-16315.74"/>
<polygon fill="black" stroke="black" points="11138.27,-16315.64 11134.77,-16305.64 11131.27,-16315.64 11138.27,-16315.64"/>
</g>
<!-- expert7_fc2_9&#45;&gt;expert_agg_9 -->
<g id="edge384" class="edge">
<title>expert7_fc2_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M10832.89,-16171.63C10829.16,-16170.91 10825.45,-16170.21 10821.77,-16169.51 10347.8,-16080.13 9789.59,-15993.34 9484.43,-15947.46"/>
<polygon fill="black" stroke="black" points="9484.54,-15943.94 9474.13,-15945.92 9483.5,-15950.86 9484.54,-15943.94"/>
</g>
<!-- expert_agg_9&#45;&gt;residual2_9 -->
<g id="edge385" class="edge">
<title>expert_agg_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M9468.19,-15852.98C9696.4,-15789.44 10052.14,-15690.39 10238.47,-15638.51"/>
<polygon fill="black" stroke="black" points="10239.61,-15641.83 10248.3,-15635.77 10237.73,-15635.08 10239.61,-15641.83"/>
</g>
<!-- comm_9 -->
<g id="node307" class="node">
<title>comm_9</title>
<polygon fill="yellow" stroke="black" points="10479.51,-15451.79 10479.51,-15485.44 10410.54,-15509.24 10313,-15509.24 10244.03,-15485.44 10244.03,-15451.79 10313,-15427.99 10410.54,-15427.99 10479.51,-15451.79"/>
<polygon fill="none" stroke="black" points="10483.5,-15448.93 10483.5,-15488.3 10411.21,-15513.24 10312.33,-15513.24 10240.04,-15488.3 10240.04,-15448.93 10312.33,-15423.99 10411.21,-15423.99 10483.5,-15448.93"/>
<text text-anchor="middle" x="10361.77" y="-15479.92" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="10361.77" y="-15464.92" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="10361.77" y="-15449.92" font-family="Times,serif" font-size="14.00">GPU8→GPU9</text>
</g>
<!-- residual2_9&#45;&gt;comm_9 -->
<g id="edge387" class="edge">
<title>residual2_9&#45;&gt;comm_9</title>
<path fill="none" stroke="black" d="M10361.77,-15550.17C10361.77,-15541.41 10361.77,-15532.3 10361.77,-15523.5"/>
<polygon fill="black" stroke="black" points="10365.27,-15523.34 10361.77,-15513.34 10358.27,-15523.34 10365.27,-15523.34"/>
</g>
<!-- ln1_10 -->
<g id="node308" class="node">
<title>ln1_10</title>
<polygon fill="lightseagreen" stroke="black" points="10358.77,-15387.05 10214.77,-15387.05 10214.77,-15334.05 10358.77,-15334.05 10358.77,-15387.05"/>
<text text-anchor="middle" x="10286.77" y="-15371.85" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10286.77" y="-15356.85" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="10286.77" y="-15341.85" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- comm_9&#45;&gt;ln1_10 -->
<g id="edge388" class="edge">
<title>comm_9&#45;&gt;ln1_10</title>
<path fill="none" stroke="black" d="M10330.83,-15423.86C10324.16,-15414.44 10317.21,-15404.6 10310.85,-15395.61"/>
<polygon fill="black" stroke="black" points="10313.6,-15393.43 10304.97,-15387.29 10307.88,-15397.47 10313.6,-15393.43"/>
</g>
<!-- residual1_10 -->
<g id="node312" class="node">
<title>residual1_10</title>
<polygon fill="lightseagreen" stroke="black" points="10283.77,-14789.01 9990.77,-14736.01 10283.77,-14683.01 10576.77,-14736.01 10283.77,-14789.01"/>
<text text-anchor="middle" x="10283.77" y="-14747.31" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="10283.77" y="-14732.31" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="10283.77" y="-14717.31" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- comm_9&#45;&gt;residual1_10 -->
<g id="edge393" class="edge">
<title>comm_9&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10415.04,-15425.31C10431.2,-15407.72 10444.77,-15385.75 10444.77,-15361.55 10444.77,-15361.55 10444.77,-15361.55 10444.77,-14893.01 10444.77,-14861.93 10443.55,-14850.77 10424.77,-14826.01 10411.05,-14807.93 10392.52,-14792.57 10373.39,-14779.97"/>
<polygon fill="black" stroke="black" points="10375.2,-14776.97 10364.88,-14774.56 10371.44,-14782.88 10375.2,-14776.97"/>
<text text-anchor="middle" x="10473.77" y="-15131.85" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_10 -->
<g id="node309" class="node">
<title>qkv_proj_10</title>
<polygon fill="lightseagreen" stroke="black" points="10416.31,-15297.05 9933.45,-15297.05 9809.23,-15161.05 10292.09,-15161.05 10416.31,-15297.05"/>
<text text-anchor="middle" x="10112.77" y="-15247.85" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10112.77" y="-15232.85" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="10112.77" y="-15217.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="10112.77" y="-15202.85" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_10&#45;&gt;qkv_proj_10 -->
<g id="edge389" class="edge">
<title>ln1_10&#45;&gt;qkv_proj_10</title>
<path fill="none" stroke="black" d="M10252.39,-15333.97C10240.27,-15324.95 10225.98,-15314.31 10211.23,-15303.33"/>
<polygon fill="black" stroke="black" points="10213.12,-15300.37 10203,-15297.21 10208.94,-15305.99 10213.12,-15300.37"/>
</g>
<!-- mha_10 -->
<g id="node310" class="node">
<title>mha_10</title>
<polygon fill="lightseagreen" stroke="black" points="10358.24,-15054.53 10238.5,-15110.07 9999.04,-15110.07 9879.3,-15054.53 9999.04,-14998.99 10238.5,-14998.99 10358.24,-15054.53"/>
<text text-anchor="middle" x="10118.77" y="-15073.33" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="10118.77" y="-15058.33" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="10118.77" y="-15043.33" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10118.77" y="-15028.33" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- qkv_proj_10&#45;&gt;mha_10 -->
<g id="edge390" class="edge">
<title>qkv_proj_10&#45;&gt;mha_10</title>
<path fill="none" stroke="black" d="M10115.11,-15160.86C10115.57,-15147.64 10116.05,-15133.8 10116.5,-15120.65"/>
<polygon fill="black" stroke="black" points="10120.01,-15120.4 10116.86,-15110.29 10113.02,-15120.16 10120.01,-15120.4"/>
</g>
<!-- out_proj_10 -->
<g id="node311" class="node">
<title>out_proj_10</title>
<polygon fill="lightseagreen" stroke="black" points="10416.14,-14962.01 9947.86,-14962.01 9827.39,-14826.01 10295.68,-14826.01 10416.14,-14962.01"/>
<text text-anchor="middle" x="10121.77" y="-14912.81" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="10121.77" y="-14897.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10121.77" y="-14882.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="10121.77" y="-14867.81" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_10&#45;&gt;out_proj_10 -->
<g id="edge391" class="edge">
<title>mha_10&#45;&gt;out_proj_10</title>
<path fill="none" stroke="black" d="M10119.8,-14998.97C10119.96,-14990.39 10120.13,-14981.37 10120.3,-14972.38"/>
<polygon fill="black" stroke="black" points="10123.81,-14972.33 10120.5,-14962.27 10116.81,-14972.2 10123.81,-14972.33"/>
</g>
<!-- out_proj_10&#45;&gt;residual1_10 -->
<g id="edge392" class="edge">
<title>out_proj_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M10191.41,-14825.94C10204.6,-14813.24 10218.2,-14800.15 10230.78,-14788.04"/>
<polygon fill="black" stroke="black" points="10233.27,-14790.49 10238.05,-14781.03 10228.42,-14785.45 10233.27,-14790.49"/>
</g>
<!-- ln2_10 -->
<g id="node313" class="node">
<title>ln2_10</title>
<polygon fill="lightseagreen" stroke="black" points="10042.77,-14646.01 9898.77,-14646.01 9898.77,-14593.01 10042.77,-14593.01 10042.77,-14646.01"/>
<text text-anchor="middle" x="9970.77" y="-14630.81" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9970.77" y="-14615.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="9970.77" y="-14600.81" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge394" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M10188.58,-14700.19C10144.37,-14684.01 10092.39,-14665 10050.3,-14649.6"/>
<polygon fill="black" stroke="black" points="10051.25,-14646.22 10040.66,-14646.07 10048.85,-14652.8 10051.25,-14646.22"/>
</g>
<!-- residual2_10 -->
<g id="node340" class="node">
<title>residual2_10</title>
<polygon fill="lightseagreen" stroke="black" points="9492.77,-13450.72 9199.77,-13397.72 9492.77,-13344.72 9785.77,-13397.72 9492.77,-13450.72"/>
<text text-anchor="middle" x="9492.77" y="-13409.02" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="9492.77" y="-13394.02" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="9492.77" y="-13379.02" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- residual1_10&#45;&gt;residual2_10 -->
<g id="edge429" class="edge">
<title>residual1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10426.99,-14708.91C10509.8,-14689.59 10597.77,-14659.82 10597.77,-14620.51 10597.77,-14620.51 10597.77,-14620.51 10597.77,-13706.39 10597.77,-13523.55 10029.21,-13444.71 9707.76,-13414.74"/>
<polygon fill="black" stroke="black" points="9707.65,-13411.22 9697.38,-13413.79 9707.01,-13418.19 9707.65,-13411.22"/>
<text text-anchor="middle" x="10626.77" y="-14233.81" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_10 -->
<g id="node314" class="node">
<title>gate_10</title>
<polygon fill="lightseagreen" stroke="black" points="8537.86,-14556.01 8237.68,-14556.01 8130.77,-14450.01 8644.77,-14450.01 8537.86,-14556.01"/>
<text text-anchor="middle" x="8387.77" y="-14514.31" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="8387.77" y="-14499.31" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="8387.77" y="-14484.31" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- ln2_10&#45;&gt;gate_10 -->
<g id="edge395" class="edge">
<title>ln2_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M9898.64,-14613.29C9667.84,-14596.6 8941.86,-14544.09 8586.99,-14518.42"/>
<polygon fill="black" stroke="black" points="8587.09,-14514.92 8576.86,-14517.68 8586.59,-14521.9 8587.09,-14514.92"/>
</g>
<!-- expert0_fc1_10 -->
<g id="node315" class="node">
<title>expert0_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="6187.31,-14399.01 5704.45,-14399.01 5580.23,-14263.01 6063.09,-14263.01 6187.31,-14399.01"/>
<text text-anchor="middle" x="5883.77" y="-14349.81" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="5883.77" y="-14334.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5883.77" y="-14319.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5883.77" y="-14304.81" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_10&#45;&gt;expert0_fc1_10 -->
<g id="edge396" class="edge">
<title>gate_10&#45;&gt;expert0_fc1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8177.31,-14496.52C7705.6,-14483.5 6575.47,-14448.13 6196.77,-14399.01 6196.66,-14398.99 6196.55,-14398.98 6196.45,-14398.97"/>
<polygon fill="black" stroke="black" points="6196.76,-14395.48 6186.38,-14397.61 6195.83,-14402.41 6196.76,-14395.48"/>
<text text-anchor="middle" x="6605.27" y="-14420.81" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_10 -->
<g id="node318" class="node">
<title>expert1_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="6813.31,-14399.01 6330.45,-14399.01 6206.23,-14263.01 6689.09,-14263.01 6813.31,-14399.01"/>
<text text-anchor="middle" x="6509.77" y="-14349.81" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="6509.77" y="-14334.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6509.77" y="-14319.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6509.77" y="-14304.81" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_10&#45;&gt;expert1_fc1_10 -->
<g id="edge400" class="edge">
<title>gate_10&#45;&gt;expert1_fc1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8178.89,-14497.89C7877.91,-14489.77 7305.34,-14466.17 6822.77,-14399.01 6822.55,-14398.98 6822.32,-14398.94 6822.1,-14398.91"/>
<polygon fill="black" stroke="black" points="6822.37,-14395.42 6811.98,-14397.46 6821.38,-14402.35 6822.37,-14395.42"/>
<text text-anchor="middle" x="7123.27" y="-14420.81" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_10 -->
<g id="node321" class="node">
<title>expert2_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="7439.31,-14399.01 6956.45,-14399.01 6832.23,-14263.01 7315.09,-14263.01 7439.31,-14399.01"/>
<text text-anchor="middle" x="7135.77" y="-14349.81" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="7135.77" y="-14334.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7135.77" y="-14319.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="7135.77" y="-14304.81" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_10&#45;&gt;expert2_fc1_10 -->
<g id="edge404" class="edge">
<title>gate_10&#45;&gt;expert2_fc1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8164.93,-14483.99C7974.13,-14467.03 7692.43,-14438.35 7448.77,-14399.01 7448.55,-14398.97 7448.32,-14398.94 7448.1,-14398.9"/>
<polygon fill="black" stroke="black" points="7448.45,-14395.41 7438.01,-14397.24 7447.31,-14402.32 7448.45,-14395.41"/>
<text text-anchor="middle" x="7699.27" y="-14420.81" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_10 -->
<g id="node324" class="node">
<title>expert3_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="8065.31,-14399.01 7582.45,-14399.01 7458.23,-14263.01 7941.09,-14263.01 8065.31,-14399.01"/>
<text text-anchor="middle" x="7761.77" y="-14349.81" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="7761.77" y="-14334.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7761.77" y="-14319.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="7761.77" y="-14304.81" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_10&#45;&gt;expert3_fc1_10 -->
<g id="edge408" class="edge">
<title>gate_10&#45;&gt;expert3_fc1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8196.12,-14449.96C8140.1,-14434.75 8077.95,-14417.87 8018.59,-14401.75"/>
<polygon fill="black" stroke="black" points="8019.27,-14398.31 8008.7,-14399.07 8017.43,-14405.06 8019.27,-14398.31"/>
<text text-anchor="middle" x="8158.27" y="-14420.81" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_10 -->
<g id="node327" class="node">
<title>expert4_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="8691.31,-14399.01 8208.45,-14399.01 8084.23,-14263.01 8567.09,-14263.01 8691.31,-14399.01"/>
<text text-anchor="middle" x="8387.77" y="-14349.81" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="8387.77" y="-14334.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8387.77" y="-14319.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8387.77" y="-14304.81" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_10&#45;&gt;expert4_fc1_10 -->
<g id="edge412" class="edge">
<title>gate_10&#45;&gt;expert4_fc1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8387.77,-14449.61C8387.77,-14436.94 8387.77,-14423.13 8387.77,-14409.57"/>
<polygon fill="black" stroke="black" points="8391.27,-14409.28 8387.77,-14399.28 8384.27,-14409.28 8391.27,-14409.28"/>
<text text-anchor="middle" x="8433.27" y="-14420.81" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_10 -->
<g id="node330" class="node">
<title>expert5_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="9317.31,-14399.01 8834.45,-14399.01 8710.23,-14263.01 9193.09,-14263.01 9317.31,-14399.01"/>
<text text-anchor="middle" x="9013.77" y="-14349.81" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="9013.77" y="-14334.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9013.77" y="-14319.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9013.77" y="-14304.81" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_10&#45;&gt;expert5_fc1_10 -->
<g id="edge416" class="edge">
<title>gate_10&#45;&gt;expert5_fc1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8579.42,-14449.96C8652.78,-14430.04 8736.67,-14407.26 8811.04,-14387.06"/>
<polygon fill="black" stroke="black" points="8812.27,-14390.36 8821,-14384.36 8810.43,-14383.6 8812.27,-14390.36"/>
<text text-anchor="middle" x="8746.27" y="-14420.81" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_10 -->
<g id="node333" class="node">
<title>expert6_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="9943.31,-14399.01 9460.45,-14399.01 9336.23,-14263.01 9819.09,-14263.01 9943.31,-14399.01"/>
<text text-anchor="middle" x="9639.77" y="-14349.81" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="9639.77" y="-14334.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9639.77" y="-14319.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9639.77" y="-14304.81" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_10&#45;&gt;expert6_fc1_10 -->
<g id="edge420" class="edge">
<title>gate_10&#45;&gt;expert6_fc1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8610.6,-14483.99C8801.4,-14467.03 9083.11,-14438.35 9326.77,-14399.01 9360.47,-14393.57 9396.03,-14386.88 9430.6,-14379.85"/>
<polygon fill="black" stroke="black" points="9431.71,-14383.2 9440.81,-14377.77 9430.31,-14376.34 9431.71,-14383.2"/>
<text text-anchor="middle" x="9245.27" y="-14420.81" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_10 -->
<g id="node336" class="node">
<title>expert7_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="10569.31,-14399.01 10086.45,-14399.01 9962.23,-14263.01 10445.09,-14263.01 10569.31,-14399.01"/>
<text text-anchor="middle" x="10265.77" y="-14349.81" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="10265.77" y="-14334.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="10265.77" y="-14319.81" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="10265.77" y="-14304.81" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_10&#45;&gt;expert7_fc1_10 -->
<g id="edge424" class="edge">
<title>gate_10&#45;&gt;expert7_fc1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8596.65,-14497.89C8897.63,-14489.77 9470.19,-14466.17 9952.77,-14399.01 9986.98,-14394.25 10023.03,-14387.85 10058.01,-14380.89"/>
<polygon fill="black" stroke="black" points="10058.73,-14384.31 10067.84,-14378.91 10057.35,-14377.45 10058.73,-14384.31"/>
<text text-anchor="middle" x="9830.27" y="-14420.81" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_10 -->
<g id="node316" class="node">
<title>expert0_gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="5883.77" cy="-14174.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5883.77" y="-14185.83" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="5883.77" y="-14170.83" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5883.77" y="-14155.83" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert0_fc1_10&#45;&gt;expert0_gelu_10 -->
<g id="edge397" class="edge">
<title>expert0_fc1_10&#45;&gt;expert0_gelu_10</title>
<path fill="none" stroke="black" d="M5883.77,-14262.7C5883.77,-14249.11 5883.77,-14235.1 5883.77,-14222.39"/>
<polygon fill="black" stroke="black" points="5887.27,-14222.06 5883.77,-14212.06 5880.27,-14222.06 5887.27,-14222.06"/>
</g>
<!-- expert0_fc2_10 -->
<g id="node317" class="node">
<title>expert0_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="6187.31,-14100.05 5704.45,-14100.05 5580.23,-13964.05 6063.09,-13964.05 6187.31,-14100.05"/>
<text text-anchor="middle" x="5883.77" y="-14050.85" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="5883.77" y="-14035.85" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5883.77" y="-14020.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="5883.77" y="-14005.85" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_10&#45;&gt;expert0_fc2_10 -->
<g id="edge398" class="edge">
<title>expert0_gelu_10&#45;&gt;expert0_fc2_10</title>
<path fill="none" stroke="black" d="M5883.77,-14136.99C5883.77,-14128.69 5883.77,-14119.57 5883.77,-14110.28"/>
<polygon fill="black" stroke="black" points="5887.27,-14110.17 5883.77,-14100.17 5880.27,-14110.18 5887.27,-14110.17"/>
</g>
<!-- expert_agg_10 -->
<g id="node339" class="node">
<title>expert_agg_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="8387.77" cy="-13707.39" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="8387.77" cy="-13707.39" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="8387.77" y="-13718.69" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="8387.77" y="-13703.69" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="8387.77" y="-13688.69" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert0_fc2_10&#45;&gt;expert_agg_10 -->
<g id="edge399" class="edge">
<title>expert0_fc2_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M6082.76,-13985.5C6120.5,-13977.7 6159.76,-13970.16 6196.77,-13964.05 6908.32,-13846.65 7758.61,-13763.63 8158.5,-13727.93"/>
<polygon fill="black" stroke="black" points="8159.08,-13731.39 8168.73,-13727.02 8158.46,-13724.42 8159.08,-13731.39"/>
</g>
<!-- expert1_gelu_10 -->
<g id="node319" class="node">
<title>expert1_gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="6509.77" cy="-14174.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6509.77" y="-14185.83" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="6509.77" y="-14170.83" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6509.77" y="-14155.83" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert1_fc1_10&#45;&gt;expert1_gelu_10 -->
<g id="edge401" class="edge">
<title>expert1_fc1_10&#45;&gt;expert1_gelu_10</title>
<path fill="none" stroke="black" d="M6509.77,-14262.7C6509.77,-14249.11 6509.77,-14235.1 6509.77,-14222.39"/>
<polygon fill="black" stroke="black" points="6513.27,-14222.06 6509.77,-14212.06 6506.27,-14222.06 6513.27,-14222.06"/>
</g>
<!-- expert1_fc2_10 -->
<g id="node320" class="node">
<title>expert1_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="6813.31,-14100.05 6330.45,-14100.05 6206.23,-13964.05 6689.09,-13964.05 6813.31,-14100.05"/>
<text text-anchor="middle" x="6509.77" y="-14050.85" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="6509.77" y="-14035.85" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6509.77" y="-14020.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="6509.77" y="-14005.85" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_10&#45;&gt;expert1_fc2_10 -->
<g id="edge402" class="edge">
<title>expert1_gelu_10&#45;&gt;expert1_fc2_10</title>
<path fill="none" stroke="black" d="M6509.77,-14136.99C6509.77,-14128.69 6509.77,-14119.57 6509.77,-14110.28"/>
<polygon fill="black" stroke="black" points="6513.27,-14110.17 6509.77,-14100.17 6506.27,-14110.18 6513.27,-14110.17"/>
</g>
<!-- expert1_fc2_10&#45;&gt;expert_agg_10 -->
<g id="edge403" class="edge">
<title>expert1_fc2_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M6709.84,-13986.7C6747.31,-13978.83 6786.18,-13970.95 6822.77,-13964.05 7296.74,-13874.67 7854.95,-13787.88 8160.11,-13742"/>
<polygon fill="black" stroke="black" points="8161.04,-13745.4 8170.41,-13740.46 8160,-13738.48 8161.04,-13745.4"/>
</g>
<!-- expert2_gelu_10 -->
<g id="node322" class="node">
<title>expert2_gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="7135.77" cy="-14174.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7135.77" y="-14185.83" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="7135.77" y="-14170.83" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7135.77" y="-14155.83" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert2_fc1_10&#45;&gt;expert2_gelu_10 -->
<g id="edge405" class="edge">
<title>expert2_fc1_10&#45;&gt;expert2_gelu_10</title>
<path fill="none" stroke="black" d="M7135.77,-14262.7C7135.77,-14249.11 7135.77,-14235.1 7135.77,-14222.39"/>
<polygon fill="black" stroke="black" points="7139.27,-14222.06 7135.77,-14212.06 7132.27,-14222.06 7139.27,-14222.06"/>
</g>
<!-- expert2_fc2_10 -->
<g id="node323" class="node">
<title>expert2_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="7439.31,-14100.05 6956.45,-14100.05 6832.23,-13964.05 7315.09,-13964.05 7439.31,-14100.05"/>
<text text-anchor="middle" x="7135.77" y="-14050.85" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="7135.77" y="-14035.85" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7135.77" y="-14020.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="7135.77" y="-14005.85" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_10&#45;&gt;expert2_fc2_10 -->
<g id="edge406" class="edge">
<title>expert2_gelu_10&#45;&gt;expert2_fc2_10</title>
<path fill="none" stroke="black" d="M7135.77,-14136.99C7135.77,-14128.69 7135.77,-14119.57 7135.77,-14110.28"/>
<polygon fill="black" stroke="black" points="7139.27,-14110.17 7135.77,-14100.17 7132.27,-14110.18 7139.27,-14110.17"/>
</g>
<!-- expert2_fc2_10&#45;&gt;expert_agg_10 -->
<g id="edge407" class="edge">
<title>expert2_fc2_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M7330.71,-13980.81C7556.7,-13922.57 7928.4,-13826.78 8165.45,-13765.68"/>
<polygon fill="black" stroke="black" points="8166.42,-13769.05 8175.23,-13763.16 8164.67,-13762.27 8166.42,-13769.05"/>
</g>
<!-- expert3_gelu_10 -->
<g id="node325" class="node">
<title>expert3_gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="7761.77" cy="-14174.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7761.77" y="-14185.83" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="7761.77" y="-14170.83" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7761.77" y="-14155.83" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert3_fc1_10&#45;&gt;expert3_gelu_10 -->
<g id="edge409" class="edge">
<title>expert3_fc1_10&#45;&gt;expert3_gelu_10</title>
<path fill="none" stroke="black" d="M7761.77,-14262.7C7761.77,-14249.11 7761.77,-14235.1 7761.77,-14222.39"/>
<polygon fill="black" stroke="black" points="7765.27,-14222.06 7761.77,-14212.06 7758.27,-14222.06 7765.27,-14222.06"/>
</g>
<!-- expert3_fc2_10 -->
<g id="node326" class="node">
<title>expert3_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="8065.31,-14100.05 7582.45,-14100.05 7458.23,-13964.05 7941.09,-13964.05 8065.31,-14100.05"/>
<text text-anchor="middle" x="7761.77" y="-14050.85" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="7761.77" y="-14035.85" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7761.77" y="-14020.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="7761.77" y="-14005.85" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_10&#45;&gt;expert3_fc2_10 -->
<g id="edge410" class="edge">
<title>expert3_gelu_10&#45;&gt;expert3_fc2_10</title>
<path fill="none" stroke="black" d="M7761.77,-14136.99C7761.77,-14128.69 7761.77,-14119.57 7761.77,-14110.28"/>
<polygon fill="black" stroke="black" points="7765.27,-14110.17 7761.77,-14100.17 7758.27,-14110.18 7765.27,-14110.17"/>
</g>
<!-- expert3_fc2_10&#45;&gt;expert_agg_10 -->
<g id="edge411" class="edge">
<title>expert3_fc2_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M7891.86,-13964C7976.18,-13920.54 8087.8,-13863 8183.78,-13813.53"/>
<polygon fill="black" stroke="black" points="8185.44,-13816.61 8192.72,-13808.92 8182.23,-13810.39 8185.44,-13816.61"/>
</g>
<!-- expert4_gelu_10 -->
<g id="node328" class="node">
<title>expert4_gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="8387.77" cy="-14174.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8387.77" y="-14185.83" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="8387.77" y="-14170.83" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8387.77" y="-14155.83" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert4_fc1_10&#45;&gt;expert4_gelu_10 -->
<g id="edge413" class="edge">
<title>expert4_fc1_10&#45;&gt;expert4_gelu_10</title>
<path fill="none" stroke="black" d="M8387.77,-14262.7C8387.77,-14249.11 8387.77,-14235.1 8387.77,-14222.39"/>
<polygon fill="black" stroke="black" points="8391.27,-14222.06 8387.77,-14212.06 8384.27,-14222.06 8391.27,-14222.06"/>
</g>
<!-- expert4_fc2_10 -->
<g id="node329" class="node">
<title>expert4_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="8691.31,-14100.05 8208.45,-14100.05 8084.23,-13964.05 8567.09,-13964.05 8691.31,-14100.05"/>
<text text-anchor="middle" x="8387.77" y="-14050.85" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="8387.77" y="-14035.85" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8387.77" y="-14020.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="8387.77" y="-14005.85" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_10&#45;&gt;expert4_fc2_10 -->
<g id="edge414" class="edge">
<title>expert4_gelu_10&#45;&gt;expert4_fc2_10</title>
<path fill="none" stroke="black" d="M8387.77,-14136.99C8387.77,-14128.69 8387.77,-14119.57 8387.77,-14110.28"/>
<polygon fill="black" stroke="black" points="8391.27,-14110.17 8387.77,-14100.17 8384.27,-14110.18 8391.27,-14110.17"/>
</g>
<!-- expert4_fc2_10&#45;&gt;expert_agg_10 -->
<g id="edge415" class="edge">
<title>expert4_fc2_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M8387.77,-13963.8C8387.77,-13955.46 8387.77,-13946.61 8387.77,-13937.39"/>
<polygon fill="black" stroke="black" points="8391.27,-13937.25 8387.77,-13927.25 8384.27,-13937.25 8391.27,-13937.25"/>
</g>
<!-- expert5_gelu_10 -->
<g id="node331" class="node">
<title>expert5_gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="9013.77" cy="-14174.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9013.77" y="-14185.83" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="9013.77" y="-14170.83" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9013.77" y="-14155.83" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert5_fc1_10&#45;&gt;expert5_gelu_10 -->
<g id="edge417" class="edge">
<title>expert5_fc1_10&#45;&gt;expert5_gelu_10</title>
<path fill="none" stroke="black" d="M9013.77,-14262.7C9013.77,-14249.11 9013.77,-14235.1 9013.77,-14222.39"/>
<polygon fill="black" stroke="black" points="9017.27,-14222.06 9013.77,-14212.06 9010.27,-14222.06 9017.27,-14222.06"/>
</g>
<!-- expert5_fc2_10 -->
<g id="node332" class="node">
<title>expert5_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="9317.31,-14100.05 8834.45,-14100.05 8710.23,-13964.05 9193.09,-13964.05 9317.31,-14100.05"/>
<text text-anchor="middle" x="9013.77" y="-14050.85" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="9013.77" y="-14035.85" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9013.77" y="-14020.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9013.77" y="-14005.85" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_10&#45;&gt;expert5_fc2_10 -->
<g id="edge418" class="edge">
<title>expert5_gelu_10&#45;&gt;expert5_fc2_10</title>
<path fill="none" stroke="black" d="M9013.77,-14136.99C9013.77,-14128.69 9013.77,-14119.57 9013.77,-14110.28"/>
<polygon fill="black" stroke="black" points="9017.27,-14110.17 9013.77,-14100.17 9010.27,-14110.18 9017.27,-14110.17"/>
</g>
<!-- expert5_fc2_10&#45;&gt;expert_agg_10 -->
<g id="edge419" class="edge">
<title>expert5_fc2_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M8883.68,-13964C8799.35,-13920.54 8687.74,-13863 8591.76,-13813.53"/>
<polygon fill="black" stroke="black" points="8593.31,-13810.39 8582.81,-13808.92 8590.1,-13816.61 8593.31,-13810.39"/>
</g>
<!-- expert6_gelu_10 -->
<g id="node334" class="node">
<title>expert6_gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="9639.77" cy="-14174.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9639.77" y="-14185.83" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="9639.77" y="-14170.83" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9639.77" y="-14155.83" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert6_fc1_10&#45;&gt;expert6_gelu_10 -->
<g id="edge421" class="edge">
<title>expert6_fc1_10&#45;&gt;expert6_gelu_10</title>
<path fill="none" stroke="black" d="M9639.77,-14262.7C9639.77,-14249.11 9639.77,-14235.1 9639.77,-14222.39"/>
<polygon fill="black" stroke="black" points="9643.27,-14222.06 9639.77,-14212.06 9636.27,-14222.06 9643.27,-14222.06"/>
</g>
<!-- expert6_fc2_10 -->
<g id="node335" class="node">
<title>expert6_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="9943.31,-14100.05 9460.45,-14100.05 9336.23,-13964.05 9819.09,-13964.05 9943.31,-14100.05"/>
<text text-anchor="middle" x="9639.77" y="-14050.85" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="9639.77" y="-14035.85" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9639.77" y="-14020.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="9639.77" y="-14005.85" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_10&#45;&gt;expert6_fc2_10 -->
<g id="edge422" class="edge">
<title>expert6_gelu_10&#45;&gt;expert6_fc2_10</title>
<path fill="none" stroke="black" d="M9639.77,-14136.99C9639.77,-14128.69 9639.77,-14119.57 9639.77,-14110.28"/>
<polygon fill="black" stroke="black" points="9643.27,-14110.17 9639.77,-14100.17 9636.27,-14110.18 9643.27,-14110.17"/>
</g>
<!-- expert6_fc2_10&#45;&gt;expert_agg_10 -->
<g id="edge423" class="edge">
<title>expert6_fc2_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M9379.59,-13964C9152.21,-13905.4 8825.63,-13821.23 8610.2,-13765.71"/>
<polygon fill="black" stroke="black" points="8610.9,-13762.28 8600.34,-13763.17 8609.15,-13769.06 8610.9,-13762.28"/>
</g>
<!-- expert7_gelu_10 -->
<g id="node337" class="node">
<title>expert7_gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="10265.77" cy="-14174.53" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="10265.77" y="-14185.83" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="10265.77" y="-14170.83" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="10265.77" y="-14155.83" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- expert7_fc1_10&#45;&gt;expert7_gelu_10 -->
<g id="edge425" class="edge">
<title>expert7_fc1_10&#45;&gt;expert7_gelu_10</title>
<path fill="none" stroke="black" d="M10265.77,-14262.7C10265.77,-14249.11 10265.77,-14235.1 10265.77,-14222.39"/>
<polygon fill="black" stroke="black" points="10269.27,-14222.06 10265.77,-14212.06 10262.27,-14222.06 10269.27,-14222.06"/>
</g>
<!-- expert7_fc2_10 -->
<g id="node338" class="node">
<title>expert7_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="10569.31,-14100.05 10086.45,-14100.05 9962.23,-13964.05 10445.09,-13964.05 10569.31,-14100.05"/>
<text text-anchor="middle" x="10265.77" y="-14050.85" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="10265.77" y="-14035.85" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="10265.77" y="-14020.85" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="10265.77" y="-14005.85" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_10&#45;&gt;expert7_fc2_10 -->
<g id="edge426" class="edge">
<title>expert7_gelu_10&#45;&gt;expert7_fc2_10</title>
<path fill="none" stroke="black" d="M10265.77,-14136.99C10265.77,-14128.69 10265.77,-14119.57 10265.77,-14110.28"/>
<polygon fill="black" stroke="black" points="10269.27,-14110.17 10265.77,-14100.17 10262.27,-14110.18 10269.27,-14110.17"/>
</g>
<!-- expert7_fc2_10&#45;&gt;expert_agg_10 -->
<g id="edge427" class="edge">
<title>expert7_fc2_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M9963.89,-13966.17C9960.16,-13965.45 9956.45,-13964.75 9952.77,-13964.05 9478.8,-13874.67 8920.59,-13787.88 8615.43,-13742"/>
<polygon fill="black" stroke="black" points="8615.54,-13738.48 8605.13,-13740.46 8614.5,-13745.4 8615.54,-13738.48"/>
</g>
<!-- expert_agg_10&#45;&gt;residual2_10 -->
<g id="edge428" class="edge">
<title>expert_agg_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M8599.19,-13647.52C8827.4,-13583.98 9183.14,-13484.93 9369.47,-13433.05"/>
<polygon fill="black" stroke="black" points="9370.61,-13436.36 9379.3,-13430.31 9368.73,-13429.62 9370.61,-13436.36"/>
</g>
<!-- comm_10 -->
<g id="node341" class="node">
<title>comm_10</title>
<polygon fill="yellow" stroke="black" points="9610.51,-13246.33 9610.51,-13279.98 9541.54,-13303.78 9444,-13303.78 9375.03,-13279.98 9375.03,-13246.33 9444,-13222.53 9541.54,-13222.53 9610.51,-13246.33"/>
<polygon fill="none" stroke="black" points="9614.5,-13243.47 9614.5,-13282.84 9542.21,-13307.78 9443.33,-13307.78 9371.04,-13282.84 9371.04,-13243.47 9443.33,-13218.53 9542.21,-13218.53 9614.5,-13243.47"/>
<text text-anchor="middle" x="9492.77" y="-13274.45" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="9492.77" y="-13259.45" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="9492.77" y="-13244.45" font-family="Times,serif" font-size="14.00">GPU9→GPU10</text>
</g>
<!-- residual2_10&#45;&gt;comm_10 -->
<g id="edge430" class="edge">
<title>residual2_10&#45;&gt;comm_10</title>
<path fill="none" stroke="black" d="M9492.77,-13344.71C9492.77,-13335.95 9492.77,-13326.84 9492.77,-13318.03"/>
<polygon fill="black" stroke="black" points="9496.27,-13317.88 9492.77,-13307.88 9489.27,-13317.88 9496.27,-13317.88"/>
</g>
<!-- ln1_11 -->
<g id="node342" class="node">
<title>ln1_11</title>
<polygon fill="lightskyblue" stroke="black" points="9485.77,-13181.59 9341.77,-13181.59 9341.77,-13128.59 9485.77,-13128.59 9485.77,-13181.59"/>
<text text-anchor="middle" x="9413.77" y="-13166.39" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9413.77" y="-13151.39" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="9413.77" y="-13136.39" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- comm_10&#45;&gt;ln1_11 -->
<g id="edge431" class="edge">
<title>comm_10&#45;&gt;ln1_11</title>
<path fill="none" stroke="black" d="M9460.18,-13218.4C9453.09,-13208.88 9445.69,-13198.94 9438.93,-13189.87"/>
<polygon fill="black" stroke="black" points="9441.72,-13187.76 9432.94,-13181.83 9436.1,-13191.94 9441.72,-13187.76"/>
</g>
<!-- residual1_11 -->
<g id="node346" class="node">
<title>residual1_11</title>
<polygon fill="lightskyblue" stroke="black" points="9410.77,-12583.55 9117.77,-12530.55 9410.77,-12477.55 9703.77,-12530.55 9410.77,-12583.55"/>
<text text-anchor="middle" x="9410.77" y="-12541.85" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="9410.77" y="-12526.85" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="9410.77" y="-12511.85" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- comm_10&#45;&gt;residual1_11 -->
<g id="edge436" class="edge">
<title>comm_10&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9543.92,-13218.87C9559.1,-13201.32 9571.77,-13179.62 9571.77,-13156.09 9571.77,-13156.09 9571.77,-13156.09 9571.77,-12687.55 9571.77,-12656.47 9570.55,-12645.31 9551.77,-12620.55 9538.05,-12602.46 9519.52,-12587.11 9500.39,-12574.51"/>
<polygon fill="black" stroke="black" points="9502.2,-12571.51 9491.88,-12569.1 9498.44,-12577.42 9502.2,-12571.51"/>
<text text-anchor="middle" x="9600.77" y="-12926.39" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_11 -->
<g id="node343" class="node">
<title>qkv_proj_11</title>
<polygon fill="lightskyblue" stroke="black" points="9543.31,-13091.59 9060.45,-13091.59 8936.23,-12955.59 9419.09,-12955.59 9543.31,-13091.59"/>
<text text-anchor="middle" x="9239.77" y="-13042.39" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9239.77" y="-13027.39" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="9239.77" y="-13012.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9239.77" y="-12997.39" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_11&#45;&gt;qkv_proj_11 -->
<g id="edge432" class="edge">
<title>ln1_11&#45;&gt;qkv_proj_11</title>
<path fill="none" stroke="black" d="M9379.39,-13128.5C9367.27,-13119.49 9352.98,-13108.84 9338.23,-13097.87"/>
<polygon fill="black" stroke="black" points="9340.12,-13094.91 9330,-13091.75 9335.94,-13100.53 9340.12,-13094.91"/>
</g>
<!-- mha_11 -->
<g id="node344" class="node">
<title>mha_11</title>
<polygon fill="lightskyblue" stroke="black" points="9485.24,-12849.07 9365.5,-12904.61 9126.04,-12904.61 9006.3,-12849.07 9126.04,-12793.52 9365.5,-12793.52 9485.24,-12849.07"/>
<text text-anchor="middle" x="9245.77" y="-12867.87" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="9245.77" y="-12852.87" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="9245.77" y="-12837.87" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9245.77" y="-12822.87" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- qkv_proj_11&#45;&gt;mha_11 -->
<g id="edge433" class="edge">
<title>qkv_proj_11&#45;&gt;mha_11</title>
<path fill="none" stroke="black" d="M9242.11,-12955.39C9242.57,-12942.18 9243.05,-12928.34 9243.5,-12915.19"/>
<polygon fill="black" stroke="black" points="9247.01,-12914.94 9243.86,-12904.83 9240.02,-12914.7 9247.01,-12914.94"/>
</g>
<!-- out_proj_11 -->
<g id="node345" class="node">
<title>out_proj_11</title>
<polygon fill="lightskyblue" stroke="black" points="9543.14,-12756.55 9074.86,-12756.55 8954.39,-12620.55 9422.68,-12620.55 9543.14,-12756.55"/>
<text text-anchor="middle" x="9248.77" y="-12707.35" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="9248.77" y="-12692.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9248.77" y="-12677.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9248.77" y="-12662.35" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_11&#45;&gt;out_proj_11 -->
<g id="edge434" class="edge">
<title>mha_11&#45;&gt;out_proj_11</title>
<path fill="none" stroke="black" d="M9246.8,-12793.51C9246.96,-12784.92 9247.13,-12775.9 9247.3,-12766.92"/>
<polygon fill="black" stroke="black" points="9250.81,-12766.87 9247.5,-12756.81 9243.81,-12766.74 9250.81,-12766.87"/>
</g>
<!-- out_proj_11&#45;&gt;residual1_11 -->
<g id="edge435" class="edge">
<title>out_proj_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M9318.41,-12620.48C9331.6,-12607.78 9345.2,-12594.68 9357.78,-12582.58"/>
<polygon fill="black" stroke="black" points="9360.27,-12585.03 9365.05,-12575.57 9355.42,-12579.99 9360.27,-12585.03"/>
</g>
<!-- ln2_11 -->
<g id="node347" class="node">
<title>ln2_11</title>
<polygon fill="lightskyblue" stroke="black" points="9169.77,-12440.55 9025.77,-12440.55 9025.77,-12387.55 9169.77,-12387.55 9169.77,-12440.55"/>
<text text-anchor="middle" x="9097.77" y="-12425.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9097.77" y="-12410.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="9097.77" y="-12395.35" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge437" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M9315.58,-12494.73C9271.37,-12478.55 9219.39,-12459.54 9177.3,-12444.14"/>
<polygon fill="black" stroke="black" points="9178.25,-12440.76 9167.66,-12440.61 9175.85,-12447.34 9178.25,-12440.76"/>
</g>
<!-- residual2_11 -->
<g id="node374" class="node">
<title>residual2_11</title>
<polygon fill="lightskyblue" stroke="black" points="8619.77,-11245.26 8326.77,-11192.26 8619.77,-11139.26 8912.77,-11192.26 8619.77,-11245.26"/>
<text text-anchor="middle" x="8619.77" y="-11203.56" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="8619.77" y="-11188.56" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="8619.77" y="-11173.56" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- residual1_11&#45;&gt;residual2_11 -->
<g id="edge472" class="edge">
<title>residual1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9553.99,-12503.45C9636.8,-12484.13 9724.77,-12454.36 9724.77,-12415.05 9724.77,-12415.05 9724.77,-12415.05 9724.77,-11500.93 9724.77,-11318.09 9156.21,-11239.25 8834.76,-11209.28"/>
<polygon fill="black" stroke="black" points="8834.65,-11205.76 8824.38,-11208.32 8834.01,-11212.73 8834.65,-11205.76"/>
<text text-anchor="middle" x="9753.77" y="-12028.35" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_11 -->
<g id="node348" class="node">
<title>gate_11</title>
<polygon fill="lightskyblue" stroke="black" points="7664.86,-12350.55 7364.68,-12350.55 7257.77,-12244.55 7771.77,-12244.55 7664.86,-12350.55"/>
<text text-anchor="middle" x="7514.77" y="-12308.85" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="7514.77" y="-12293.85" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="7514.77" y="-12278.85" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- ln2_11&#45;&gt;gate_11 -->
<g id="edge438" class="edge">
<title>ln2_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M9025.64,-12407.83C8794.84,-12391.13 8068.86,-12338.62 7713.99,-12312.96"/>
<polygon fill="black" stroke="black" points="7714.09,-12309.45 7703.86,-12312.22 7713.59,-12316.44 7714.09,-12309.45"/>
</g>
<!-- expert0_fc1_11 -->
<g id="node349" class="node">
<title>expert0_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="5314.31,-12193.55 4831.45,-12193.55 4707.23,-12057.55 5190.09,-12057.55 5314.31,-12193.55"/>
<text text-anchor="middle" x="5010.77" y="-12144.35" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="5010.77" y="-12129.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5010.77" y="-12114.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5010.77" y="-12099.35" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_11&#45;&gt;expert0_fc1_11 -->
<g id="edge439" class="edge">
<title>gate_11&#45;&gt;expert0_fc1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7304.31,-12291.06C6832.6,-12278.04 5702.47,-12242.67 5323.77,-12193.55 5323.66,-12193.53 5323.55,-12193.52 5323.45,-12193.5"/>
<polygon fill="black" stroke="black" points="5323.76,-12190.02 5313.38,-12192.15 5322.83,-12196.95 5323.76,-12190.02"/>
<text text-anchor="middle" x="5732.27" y="-12215.35" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_11 -->
<g id="node352" class="node">
<title>expert1_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="5940.31,-12193.55 5457.45,-12193.55 5333.23,-12057.55 5816.09,-12057.55 5940.31,-12193.55"/>
<text text-anchor="middle" x="5636.77" y="-12144.35" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="5636.77" y="-12129.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5636.77" y="-12114.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5636.77" y="-12099.35" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_11&#45;&gt;expert1_fc1_11 -->
<g id="edge443" class="edge">
<title>gate_11&#45;&gt;expert1_fc1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7305.89,-12292.42C7004.91,-12284.31 6432.34,-12260.71 5949.77,-12193.55 5949.55,-12193.52 5949.32,-12193.48 5949.1,-12193.45"/>
<polygon fill="black" stroke="black" points="5949.37,-12189.96 5938.98,-12192 5948.38,-12196.89 5949.37,-12189.96"/>
<text text-anchor="middle" x="6250.27" y="-12215.35" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_11 -->
<g id="node355" class="node">
<title>expert2_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="6566.31,-12193.55 6083.45,-12193.55 5959.23,-12057.55 6442.09,-12057.55 6566.31,-12193.55"/>
<text text-anchor="middle" x="6262.77" y="-12144.35" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="6262.77" y="-12129.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6262.77" y="-12114.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6262.77" y="-12099.35" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_11&#45;&gt;expert2_fc1_11 -->
<g id="edge447" class="edge">
<title>gate_11&#45;&gt;expert2_fc1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7291.93,-12278.53C7101.13,-12261.57 6819.43,-12232.88 6575.77,-12193.55 6575.55,-12193.51 6575.32,-12193.47 6575.1,-12193.44"/>
<polygon fill="black" stroke="black" points="6575.45,-12189.95 6565.01,-12191.78 6574.31,-12196.86 6575.45,-12189.95"/>
<text text-anchor="middle" x="6826.27" y="-12215.35" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_11 -->
<g id="node358" class="node">
<title>expert3_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="7192.31,-12193.55 6709.45,-12193.55 6585.23,-12057.55 7068.09,-12057.55 7192.31,-12193.55"/>
<text text-anchor="middle" x="6888.77" y="-12144.35" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="6888.77" y="-12129.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6888.77" y="-12114.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6888.77" y="-12099.35" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_11&#45;&gt;expert3_fc1_11 -->
<g id="edge451" class="edge">
<title>gate_11&#45;&gt;expert3_fc1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7323.12,-12244.5C7267.1,-12229.29 7204.95,-12212.41 7145.59,-12196.29"/>
<polygon fill="black" stroke="black" points="7146.27,-12192.85 7135.7,-12193.6 7144.43,-12199.6 7146.27,-12192.85"/>
<text text-anchor="middle" x="7285.27" y="-12215.35" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_11 -->
<g id="node361" class="node">
<title>expert4_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="7818.31,-12193.55 7335.45,-12193.55 7211.23,-12057.55 7694.09,-12057.55 7818.31,-12193.55"/>
<text text-anchor="middle" x="7514.77" y="-12144.35" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="7514.77" y="-12129.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7514.77" y="-12114.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="7514.77" y="-12099.35" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_11&#45;&gt;expert4_fc1_11 -->
<g id="edge455" class="edge">
<title>gate_11&#45;&gt;expert4_fc1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7514.77,-12244.15C7514.77,-12231.48 7514.77,-12217.67 7514.77,-12204.11"/>
<polygon fill="black" stroke="black" points="7518.27,-12203.82 7514.77,-12193.82 7511.27,-12203.82 7518.27,-12203.82"/>
<text text-anchor="middle" x="7560.27" y="-12215.35" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_11 -->
<g id="node364" class="node">
<title>expert5_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="8444.31,-12193.55 7961.45,-12193.55 7837.23,-12057.55 8320.09,-12057.55 8444.31,-12193.55"/>
<text text-anchor="middle" x="8140.77" y="-12144.35" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="8140.77" y="-12129.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8140.77" y="-12114.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="8140.77" y="-12099.35" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_11&#45;&gt;expert5_fc1_11 -->
<g id="edge459" class="edge">
<title>gate_11&#45;&gt;expert5_fc1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7706.42,-12244.5C7779.78,-12224.58 7863.67,-12201.8 7938.04,-12181.6"/>
<polygon fill="black" stroke="black" points="7939.27,-12184.89 7948,-12178.9 7937.43,-12178.14 7939.27,-12184.89"/>
<text text-anchor="middle" x="7873.27" y="-12215.35" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_11 -->
<g id="node367" class="node">
<title>expert6_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="9070.31,-12193.55 8587.45,-12193.55 8463.23,-12057.55 8946.09,-12057.55 9070.31,-12193.55"/>
<text text-anchor="middle" x="8766.77" y="-12144.35" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="8766.77" y="-12129.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8766.77" y="-12114.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="8766.77" y="-12099.35" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_11&#45;&gt;expert6_fc1_11 -->
<g id="edge463" class="edge">
<title>gate_11&#45;&gt;expert6_fc1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7737.6,-12278.53C7928.4,-12261.57 8210.11,-12232.88 8453.77,-12193.55 8487.47,-12188.1 8523.03,-12181.42 8557.6,-12174.39"/>
<polygon fill="black" stroke="black" points="8558.71,-12177.74 8567.81,-12172.3 8557.31,-12170.88 8558.71,-12177.74"/>
<text text-anchor="middle" x="8372.27" y="-12215.35" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_11 -->
<g id="node370" class="node">
<title>expert7_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="9696.31,-12193.55 9213.45,-12193.55 9089.23,-12057.55 9572.09,-12057.55 9696.31,-12193.55"/>
<text text-anchor="middle" x="9392.77" y="-12144.35" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="9392.77" y="-12129.35" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="9392.77" y="-12114.35" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9392.77" y="-12099.35" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_11&#45;&gt;expert7_fc1_11 -->
<g id="edge467" class="edge">
<title>gate_11&#45;&gt;expert7_fc1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7723.65,-12292.42C8024.63,-12284.31 8597.19,-12260.71 9079.77,-12193.55 9113.98,-12188.78 9150.03,-12182.39 9185.01,-12175.42"/>
<polygon fill="black" stroke="black" points="9185.73,-12178.85 9194.84,-12173.45 9184.35,-12171.99 9185.73,-12178.85"/>
<text text-anchor="middle" x="8957.27" y="-12215.35" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_11 -->
<g id="node350" class="node">
<title>expert0_gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="5010.77" cy="-11969.07" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5010.77" y="-11980.37" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="5010.77" y="-11965.37" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5010.77" y="-11950.37" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert0_fc1_11&#45;&gt;expert0_gelu_11 -->
<g id="edge440" class="edge">
<title>expert0_fc1_11&#45;&gt;expert0_gelu_11</title>
<path fill="none" stroke="black" d="M5010.77,-12057.24C5010.77,-12043.65 5010.77,-12029.64 5010.77,-12016.93"/>
<polygon fill="black" stroke="black" points="5014.27,-12016.6 5010.77,-12006.6 5007.27,-12016.6 5014.27,-12016.6"/>
</g>
<!-- expert0_fc2_11 -->
<g id="node351" class="node">
<title>expert0_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="5314.31,-11894.59 4831.45,-11894.59 4707.23,-11758.59 5190.09,-11758.59 5314.31,-11894.59"/>
<text text-anchor="middle" x="5010.77" y="-11845.39" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="5010.77" y="-11830.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5010.77" y="-11815.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5010.77" y="-11800.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_11&#45;&gt;expert0_fc2_11 -->
<g id="edge441" class="edge">
<title>expert0_gelu_11&#45;&gt;expert0_fc2_11</title>
<path fill="none" stroke="black" d="M5010.77,-11931.53C5010.77,-11923.23 5010.77,-11914.11 5010.77,-11904.82"/>
<polygon fill="black" stroke="black" points="5014.27,-11904.71 5010.77,-11894.71 5007.27,-11904.71 5014.27,-11904.71"/>
</g>
<!-- expert_agg_11 -->
<g id="node373" class="node">
<title>expert_agg_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="7514.77" cy="-11501.93" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="7514.77" cy="-11501.93" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="7514.77" y="-11513.23" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="7514.77" y="-11498.23" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="7514.77" y="-11483.23" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert0_fc2_11&#45;&gt;expert_agg_11 -->
<g id="edge442" class="edge">
<title>expert0_fc2_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M5209.76,-11780.04C5247.5,-11772.24 5286.76,-11764.7 5323.77,-11758.59 6035.32,-11641.19 6885.61,-11558.17 7285.5,-11522.47"/>
<polygon fill="black" stroke="black" points="7286.08,-11525.93 7295.73,-11521.56 7285.46,-11518.96 7286.08,-11525.93"/>
</g>
<!-- expert1_gelu_11 -->
<g id="node353" class="node">
<title>expert1_gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="5636.77" cy="-11969.07" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5636.77" y="-11980.37" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="5636.77" y="-11965.37" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5636.77" y="-11950.37" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert1_fc1_11&#45;&gt;expert1_gelu_11 -->
<g id="edge444" class="edge">
<title>expert1_fc1_11&#45;&gt;expert1_gelu_11</title>
<path fill="none" stroke="black" d="M5636.77,-12057.24C5636.77,-12043.65 5636.77,-12029.64 5636.77,-12016.93"/>
<polygon fill="black" stroke="black" points="5640.27,-12016.6 5636.77,-12006.6 5633.27,-12016.6 5640.27,-12016.6"/>
</g>
<!-- expert1_fc2_11 -->
<g id="node354" class="node">
<title>expert1_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="5940.31,-11894.59 5457.45,-11894.59 5333.23,-11758.59 5816.09,-11758.59 5940.31,-11894.59"/>
<text text-anchor="middle" x="5636.77" y="-11845.39" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="5636.77" y="-11830.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5636.77" y="-11815.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="5636.77" y="-11800.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_11&#45;&gt;expert1_fc2_11 -->
<g id="edge445" class="edge">
<title>expert1_gelu_11&#45;&gt;expert1_fc2_11</title>
<path fill="none" stroke="black" d="M5636.77,-11931.53C5636.77,-11923.23 5636.77,-11914.11 5636.77,-11904.82"/>
<polygon fill="black" stroke="black" points="5640.27,-11904.71 5636.77,-11894.71 5633.27,-11904.71 5640.27,-11904.71"/>
</g>
<!-- expert1_fc2_11&#45;&gt;expert_agg_11 -->
<g id="edge446" class="edge">
<title>expert1_fc2_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M5836.84,-11781.24C5874.31,-11773.37 5913.18,-11765.49 5949.77,-11758.59 6423.74,-11669.2 6981.95,-11582.42 7287.11,-11536.54"/>
<polygon fill="black" stroke="black" points="7288.04,-11539.94 7297.41,-11535 7287,-11533.02 7288.04,-11539.94"/>
</g>
<!-- expert2_gelu_11 -->
<g id="node356" class="node">
<title>expert2_gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="6262.77" cy="-11969.07" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6262.77" y="-11980.37" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="6262.77" y="-11965.37" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6262.77" y="-11950.37" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert2_fc1_11&#45;&gt;expert2_gelu_11 -->
<g id="edge448" class="edge">
<title>expert2_fc1_11&#45;&gt;expert2_gelu_11</title>
<path fill="none" stroke="black" d="M6262.77,-12057.24C6262.77,-12043.65 6262.77,-12029.64 6262.77,-12016.93"/>
<polygon fill="black" stroke="black" points="6266.27,-12016.6 6262.77,-12006.6 6259.27,-12016.6 6266.27,-12016.6"/>
</g>
<!-- expert2_fc2_11 -->
<g id="node357" class="node">
<title>expert2_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="6566.31,-11894.59 6083.45,-11894.59 5959.23,-11758.59 6442.09,-11758.59 6566.31,-11894.59"/>
<text text-anchor="middle" x="6262.77" y="-11845.39" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="6262.77" y="-11830.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6262.77" y="-11815.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6262.77" y="-11800.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_11&#45;&gt;expert2_fc2_11 -->
<g id="edge449" class="edge">
<title>expert2_gelu_11&#45;&gt;expert2_fc2_11</title>
<path fill="none" stroke="black" d="M6262.77,-11931.53C6262.77,-11923.23 6262.77,-11914.11 6262.77,-11904.82"/>
<polygon fill="black" stroke="black" points="6266.27,-11904.71 6262.77,-11894.71 6259.27,-11904.71 6266.27,-11904.71"/>
</g>
<!-- expert2_fc2_11&#45;&gt;expert_agg_11 -->
<g id="edge450" class="edge">
<title>expert2_fc2_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M6457.71,-11775.35C6683.7,-11717.11 7055.4,-11621.31 7292.45,-11560.22"/>
<polygon fill="black" stroke="black" points="7293.42,-11563.59 7302.23,-11557.7 7291.67,-11556.81 7293.42,-11563.59"/>
</g>
<!-- expert3_gelu_11 -->
<g id="node359" class="node">
<title>expert3_gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="6888.77" cy="-11969.07" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6888.77" y="-11980.37" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="6888.77" y="-11965.37" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6888.77" y="-11950.37" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert3_fc1_11&#45;&gt;expert3_gelu_11 -->
<g id="edge452" class="edge">
<title>expert3_fc1_11&#45;&gt;expert3_gelu_11</title>
<path fill="none" stroke="black" d="M6888.77,-12057.24C6888.77,-12043.65 6888.77,-12029.64 6888.77,-12016.93"/>
<polygon fill="black" stroke="black" points="6892.27,-12016.6 6888.77,-12006.6 6885.27,-12016.6 6892.27,-12016.6"/>
</g>
<!-- expert3_fc2_11 -->
<g id="node360" class="node">
<title>expert3_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="7192.31,-11894.59 6709.45,-11894.59 6585.23,-11758.59 7068.09,-11758.59 7192.31,-11894.59"/>
<text text-anchor="middle" x="6888.77" y="-11845.39" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="6888.77" y="-11830.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6888.77" y="-11815.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="6888.77" y="-11800.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_11&#45;&gt;expert3_fc2_11 -->
<g id="edge453" class="edge">
<title>expert3_gelu_11&#45;&gt;expert3_fc2_11</title>
<path fill="none" stroke="black" d="M6888.77,-11931.53C6888.77,-11923.23 6888.77,-11914.11 6888.77,-11904.82"/>
<polygon fill="black" stroke="black" points="6892.27,-11904.71 6888.77,-11894.71 6885.27,-11904.71 6892.27,-11904.71"/>
</g>
<!-- expert3_fc2_11&#45;&gt;expert_agg_11 -->
<g id="edge454" class="edge">
<title>expert3_fc2_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M7018.86,-11758.54C7103.18,-11715.07 7214.8,-11657.54 7310.78,-11608.07"/>
<polygon fill="black" stroke="black" points="7312.44,-11611.15 7319.72,-11603.46 7309.23,-11604.93 7312.44,-11611.15"/>
</g>
<!-- expert4_gelu_11 -->
<g id="node362" class="node">
<title>expert4_gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="7514.77" cy="-11969.07" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7514.77" y="-11980.37" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="7514.77" y="-11965.37" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7514.77" y="-11950.37" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert4_fc1_11&#45;&gt;expert4_gelu_11 -->
<g id="edge456" class="edge">
<title>expert4_fc1_11&#45;&gt;expert4_gelu_11</title>
<path fill="none" stroke="black" d="M7514.77,-12057.24C7514.77,-12043.65 7514.77,-12029.64 7514.77,-12016.93"/>
<polygon fill="black" stroke="black" points="7518.27,-12016.6 7514.77,-12006.6 7511.27,-12016.6 7518.27,-12016.6"/>
</g>
<!-- expert4_fc2_11 -->
<g id="node363" class="node">
<title>expert4_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="7818.31,-11894.59 7335.45,-11894.59 7211.23,-11758.59 7694.09,-11758.59 7818.31,-11894.59"/>
<text text-anchor="middle" x="7514.77" y="-11845.39" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="7514.77" y="-11830.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7514.77" y="-11815.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="7514.77" y="-11800.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_11&#45;&gt;expert4_fc2_11 -->
<g id="edge457" class="edge">
<title>expert4_gelu_11&#45;&gt;expert4_fc2_11</title>
<path fill="none" stroke="black" d="M7514.77,-11931.53C7514.77,-11923.23 7514.77,-11914.11 7514.77,-11904.82"/>
<polygon fill="black" stroke="black" points="7518.27,-11904.71 7514.77,-11894.71 7511.27,-11904.71 7518.27,-11904.71"/>
</g>
<!-- expert4_fc2_11&#45;&gt;expert_agg_11 -->
<g id="edge458" class="edge">
<title>expert4_fc2_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M7514.77,-11758.34C7514.77,-11750 7514.77,-11741.14 7514.77,-11731.93"/>
<polygon fill="black" stroke="black" points="7518.27,-11731.79 7514.77,-11721.79 7511.27,-11731.79 7518.27,-11731.79"/>
</g>
<!-- expert5_gelu_11 -->
<g id="node365" class="node">
<title>expert5_gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="8140.77" cy="-11969.07" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8140.77" y="-11980.37" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="8140.77" y="-11965.37" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8140.77" y="-11950.37" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert5_fc1_11&#45;&gt;expert5_gelu_11 -->
<g id="edge460" class="edge">
<title>expert5_fc1_11&#45;&gt;expert5_gelu_11</title>
<path fill="none" stroke="black" d="M8140.77,-12057.24C8140.77,-12043.65 8140.77,-12029.64 8140.77,-12016.93"/>
<polygon fill="black" stroke="black" points="8144.27,-12016.6 8140.77,-12006.6 8137.27,-12016.6 8144.27,-12016.6"/>
</g>
<!-- expert5_fc2_11 -->
<g id="node366" class="node">
<title>expert5_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="8444.31,-11894.59 7961.45,-11894.59 7837.23,-11758.59 8320.09,-11758.59 8444.31,-11894.59"/>
<text text-anchor="middle" x="8140.77" y="-11845.39" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="8140.77" y="-11830.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8140.77" y="-11815.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="8140.77" y="-11800.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_11&#45;&gt;expert5_fc2_11 -->
<g id="edge461" class="edge">
<title>expert5_gelu_11&#45;&gt;expert5_fc2_11</title>
<path fill="none" stroke="black" d="M8140.77,-11931.53C8140.77,-11923.23 8140.77,-11914.11 8140.77,-11904.82"/>
<polygon fill="black" stroke="black" points="8144.27,-11904.71 8140.77,-11894.71 8137.27,-11904.71 8144.27,-11904.71"/>
</g>
<!-- expert5_fc2_11&#45;&gt;expert_agg_11 -->
<g id="edge462" class="edge">
<title>expert5_fc2_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M8010.68,-11758.54C7926.35,-11715.07 7814.74,-11657.54 7718.76,-11608.07"/>
<polygon fill="black" stroke="black" points="7720.31,-11604.93 7709.81,-11603.46 7717.1,-11611.15 7720.31,-11604.93"/>
</g>
<!-- expert6_gelu_11 -->
<g id="node368" class="node">
<title>expert6_gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="8766.77" cy="-11969.07" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8766.77" y="-11980.37" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="8766.77" y="-11965.37" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8766.77" y="-11950.37" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert6_fc1_11&#45;&gt;expert6_gelu_11 -->
<g id="edge464" class="edge">
<title>expert6_fc1_11&#45;&gt;expert6_gelu_11</title>
<path fill="none" stroke="black" d="M8766.77,-12057.24C8766.77,-12043.65 8766.77,-12029.64 8766.77,-12016.93"/>
<polygon fill="black" stroke="black" points="8770.27,-12016.6 8766.77,-12006.6 8763.27,-12016.6 8770.27,-12016.6"/>
</g>
<!-- expert6_fc2_11 -->
<g id="node369" class="node">
<title>expert6_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="9070.31,-11894.59 8587.45,-11894.59 8463.23,-11758.59 8946.09,-11758.59 9070.31,-11894.59"/>
<text text-anchor="middle" x="8766.77" y="-11845.39" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="8766.77" y="-11830.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8766.77" y="-11815.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="8766.77" y="-11800.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_11&#45;&gt;expert6_fc2_11 -->
<g id="edge465" class="edge">
<title>expert6_gelu_11&#45;&gt;expert6_fc2_11</title>
<path fill="none" stroke="black" d="M8766.77,-11931.53C8766.77,-11923.23 8766.77,-11914.11 8766.77,-11904.82"/>
<polygon fill="black" stroke="black" points="8770.27,-11904.71 8766.77,-11894.71 8763.27,-11904.71 8770.27,-11904.71"/>
</g>
<!-- expert6_fc2_11&#45;&gt;expert_agg_11 -->
<g id="edge466" class="edge">
<title>expert6_fc2_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M8506.59,-11758.54C8279.21,-11699.94 7952.63,-11615.77 7737.2,-11560.25"/>
<polygon fill="black" stroke="black" points="7737.9,-11556.82 7727.34,-11557.71 7736.15,-11563.6 7737.9,-11556.82"/>
</g>
<!-- expert7_gelu_11 -->
<g id="node371" class="node">
<title>expert7_gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="9392.77" cy="-11969.07" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="9392.77" y="-11980.37" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="9392.77" y="-11965.37" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="9392.77" y="-11950.37" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- expert7_fc1_11&#45;&gt;expert7_gelu_11 -->
<g id="edge468" class="edge">
<title>expert7_fc1_11&#45;&gt;expert7_gelu_11</title>
<path fill="none" stroke="black" d="M9392.77,-12057.24C9392.77,-12043.65 9392.77,-12029.64 9392.77,-12016.93"/>
<polygon fill="black" stroke="black" points="9396.27,-12016.6 9392.77,-12006.6 9389.27,-12016.6 9396.27,-12016.6"/>
</g>
<!-- expert7_fc2_11 -->
<g id="node372" class="node">
<title>expert7_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="9696.31,-11894.59 9213.45,-11894.59 9089.23,-11758.59 9572.09,-11758.59 9696.31,-11894.59"/>
<text text-anchor="middle" x="9392.77" y="-11845.39" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="9392.77" y="-11830.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="9392.77" y="-11815.39" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="9392.77" y="-11800.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_11&#45;&gt;expert7_fc2_11 -->
<g id="edge469" class="edge">
<title>expert7_gelu_11&#45;&gt;expert7_fc2_11</title>
<path fill="none" stroke="black" d="M9392.77,-11931.53C9392.77,-11923.23 9392.77,-11914.11 9392.77,-11904.82"/>
<polygon fill="black" stroke="black" points="9396.27,-11904.71 9392.77,-11894.71 9389.27,-11904.71 9396.27,-11904.71"/>
</g>
<!-- expert7_fc2_11&#45;&gt;expert_agg_11 -->
<g id="edge470" class="edge">
<title>expert7_fc2_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M9090.89,-11760.71C9087.16,-11759.99 9083.45,-11759.29 9079.77,-11758.59 8605.8,-11669.2 8047.59,-11582.42 7742.43,-11536.54"/>
<polygon fill="black" stroke="black" points="7742.54,-11533.02 7732.13,-11535 7741.5,-11539.94 7742.54,-11533.02"/>
</g>
<!-- expert_agg_11&#45;&gt;residual2_11 -->
<g id="edge471" class="edge">
<title>expert_agg_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M7726.19,-11442.06C7954.4,-11378.52 8310.14,-11279.47 8496.47,-11227.59"/>
<polygon fill="black" stroke="black" points="8497.61,-11230.9 8506.3,-11224.85 8495.73,-11224.16 8497.61,-11230.9"/>
</g>
<!-- comm_11 -->
<g id="node375" class="node">
<title>comm_11</title>
<polygon fill="yellow" stroke="black" points="8737.51,-11040.87 8737.51,-11074.52 8668.54,-11098.32 8571,-11098.32 8502.03,-11074.52 8502.03,-11040.87 8571,-11017.07 8668.54,-11017.07 8737.51,-11040.87"/>
<polygon fill="none" stroke="black" points="8741.5,-11038.01 8741.5,-11077.38 8669.21,-11102.32 8570.33,-11102.32 8498.04,-11077.38 8498.04,-11038.01 8570.33,-11013.06 8669.21,-11013.06 8741.5,-11038.01"/>
<text text-anchor="middle" x="8619.77" y="-11068.99" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="8619.77" y="-11053.99" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="8619.77" y="-11038.99" font-family="Times,serif" font-size="14.00">GPU10→GPU11</text>
</g>
<!-- residual2_11&#45;&gt;comm_11 -->
<g id="edge473" class="edge">
<title>residual2_11&#45;&gt;comm_11</title>
<path fill="none" stroke="black" d="M8619.77,-11139.25C8619.77,-11130.49 8619.77,-11121.38 8619.77,-11112.57"/>
<polygon fill="black" stroke="black" points="8623.27,-11112.42 8619.77,-11102.42 8616.27,-11112.42 8623.27,-11112.42"/>
</g>
<!-- ln1_12 -->
<g id="node376" class="node">
<title>ln1_12</title>
<polygon fill="#eedd82" stroke="black" points="8612.77,-10976.13 8468.77,-10976.13 8468.77,-10923.13 8612.77,-10923.13 8612.77,-10976.13"/>
<text text-anchor="middle" x="8540.77" y="-10960.93" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8540.77" y="-10945.93" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="8540.77" y="-10930.93" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- comm_11&#45;&gt;ln1_12 -->
<g id="edge474" class="edge">
<title>comm_11&#45;&gt;ln1_12</title>
<path fill="none" stroke="black" d="M8587.18,-11012.94C8580.09,-11003.42 8572.69,-10993.48 8565.93,-10984.41"/>
<polygon fill="black" stroke="black" points="8568.72,-10982.29 8559.94,-10976.37 8563.1,-10986.48 8568.72,-10982.29"/>
</g>
<!-- residual1_12 -->
<g id="node380" class="node">
<title>residual1_12</title>
<polygon fill="#eedd82" stroke="black" points="8537.77,-10378.09 8244.77,-10325.09 8537.77,-10272.09 8830.77,-10325.09 8537.77,-10378.09"/>
<text text-anchor="middle" x="8537.77" y="-10336.39" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="8537.77" y="-10321.39" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="8537.77" y="-10306.39" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- comm_11&#45;&gt;residual1_12 -->
<g id="edge479" class="edge">
<title>comm_11&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8670.92,-11013.41C8686.1,-10995.86 8698.77,-10974.16 8698.77,-10950.63 8698.77,-10950.63 8698.77,-10950.63 8698.77,-10482.09 8698.77,-10451.01 8697.55,-10439.84 8678.77,-10415.09 8665.05,-10397 8646.52,-10381.65 8627.39,-10369.05"/>
<polygon fill="black" stroke="black" points="8629.2,-10366.05 8618.88,-10363.64 8625.44,-10371.95 8629.2,-10366.05"/>
<text text-anchor="middle" x="8727.77" y="-10720.93" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_12 -->
<g id="node377" class="node">
<title>qkv_proj_12</title>
<polygon fill="#eedd82" stroke="black" points="8670.31,-10886.13 8187.45,-10886.13 8063.23,-10750.13 8546.09,-10750.13 8670.31,-10886.13"/>
<text text-anchor="middle" x="8366.77" y="-10836.93" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8366.77" y="-10821.93" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="8366.77" y="-10806.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="8366.77" y="-10791.93" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_12&#45;&gt;qkv_proj_12 -->
<g id="edge475" class="edge">
<title>ln1_12&#45;&gt;qkv_proj_12</title>
<path fill="none" stroke="black" d="M8506.39,-10923.04C8494.27,-10914.03 8479.98,-10903.38 8465.23,-10892.41"/>
<polygon fill="black" stroke="black" points="8467.12,-10889.45 8457,-10886.29 8462.94,-10895.06 8467.12,-10889.45"/>
</g>
<!-- mha_12 -->
<g id="node378" class="node">
<title>mha_12</title>
<polygon fill="#eedd82" stroke="black" points="8612.24,-10643.61 8492.5,-10699.15 8253.04,-10699.15 8133.3,-10643.61 8253.04,-10588.06 8492.5,-10588.06 8612.24,-10643.61"/>
<text text-anchor="middle" x="8372.77" y="-10662.41" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="8372.77" y="-10647.41" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="8372.77" y="-10632.41" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8372.77" y="-10617.41" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- qkv_proj_12&#45;&gt;mha_12 -->
<g id="edge476" class="edge">
<title>qkv_proj_12&#45;&gt;mha_12</title>
<path fill="none" stroke="black" d="M8369.11,-10749.93C8369.57,-10736.72 8370.05,-10722.88 8370.5,-10709.73"/>
<polygon fill="black" stroke="black" points="8374.01,-10709.48 8370.86,-10699.37 8367.02,-10709.24 8374.01,-10709.48"/>
</g>
<!-- out_proj_12 -->
<g id="node379" class="node">
<title>out_proj_12</title>
<polygon fill="#eedd82" stroke="black" points="8670.14,-10551.09 8201.86,-10551.09 8081.39,-10415.09 8549.68,-10415.09 8670.14,-10551.09"/>
<text text-anchor="middle" x="8375.77" y="-10501.89" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8375.77" y="-10486.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8375.77" y="-10471.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="8375.77" y="-10456.89" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_12&#45;&gt;out_proj_12 -->
<g id="edge477" class="edge">
<title>mha_12&#45;&gt;out_proj_12</title>
<path fill="none" stroke="black" d="M8373.8,-10588.05C8373.96,-10579.46 8374.13,-10570.44 8374.3,-10561.46"/>
<polygon fill="black" stroke="black" points="8377.81,-10561.41 8374.5,-10551.35 8370.81,-10561.28 8377.81,-10561.41"/>
</g>
<!-- out_proj_12&#45;&gt;residual1_12 -->
<g id="edge478" class="edge">
<title>out_proj_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M8445.41,-10415.02C8458.6,-10402.32 8472.2,-10389.22 8484.78,-10377.12"/>
<polygon fill="black" stroke="black" points="8487.27,-10379.57 8492.05,-10370.11 8482.42,-10374.53 8487.27,-10379.57"/>
</g>
<!-- ln2_12 -->
<g id="node381" class="node">
<title>ln2_12</title>
<polygon fill="#eedd82" stroke="black" points="8296.77,-10235.09 8152.77,-10235.09 8152.77,-10182.09 8296.77,-10182.09 8296.77,-10235.09"/>
<text text-anchor="middle" x="8224.77" y="-10219.89" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8224.77" y="-10204.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="8224.77" y="-10189.89" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge480" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M8442.58,-10289.27C8398.37,-10273.09 8346.39,-10254.08 8304.3,-10238.68"/>
<polygon fill="black" stroke="black" points="8305.25,-10235.3 8294.66,-10235.15 8302.85,-10241.87 8305.25,-10235.3"/>
</g>
<!-- residual2_12 -->
<g id="node408" class="node">
<title>residual2_12</title>
<polygon fill="#eedd82" stroke="black" points="7746.77,-9039.8 7453.77,-8986.8 7746.77,-8933.8 8039.77,-8986.8 7746.77,-9039.8"/>
<text text-anchor="middle" x="7746.77" y="-8998.1" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="7746.77" y="-8983.1" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="7746.77" y="-8968.1" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- residual1_12&#45;&gt;residual2_12 -->
<g id="edge515" class="edge">
<title>residual1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8680.99,-10297.99C8763.8,-10278.67 8851.77,-10248.9 8851.77,-10209.59 8851.77,-10209.59 8851.77,-10209.59 8851.77,-9295.46 8851.77,-9112.63 8283.21,-9033.79 7961.76,-9003.82"/>
<polygon fill="black" stroke="black" points="7961.65,-9000.3 7951.38,-9002.86 7961.01,-9007.27 7961.65,-9000.3"/>
<text text-anchor="middle" x="8880.77" y="-9822.89" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_12 -->
<g id="node382" class="node">
<title>gate_12</title>
<polygon fill="#eedd82" stroke="black" points="6791.86,-10145.09 6491.68,-10145.09 6384.77,-10039.09 6898.77,-10039.09 6791.86,-10145.09"/>
<text text-anchor="middle" x="6641.77" y="-10103.39" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="6641.77" y="-10088.39" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="6641.77" y="-10073.39" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- ln2_12&#45;&gt;gate_12 -->
<g id="edge481" class="edge">
<title>ln2_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M8152.64,-10202.37C7921.84,-10185.67 7195.86,-10133.16 6840.99,-10107.5"/>
<polygon fill="black" stroke="black" points="6841.09,-10103.99 6830.86,-10106.76 6840.59,-10110.98 6841.09,-10103.99"/>
</g>
<!-- expert0_fc1_12 -->
<g id="node383" class="node">
<title>expert0_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="4441.31,-9988.09 3958.45,-9988.09 3834.23,-9852.09 4317.09,-9852.09 4441.31,-9988.09"/>
<text text-anchor="middle" x="4137.77" y="-9938.89" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="4137.77" y="-9923.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="4137.77" y="-9908.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="4137.77" y="-9893.89" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_12&#45;&gt;expert0_fc1_12 -->
<g id="edge482" class="edge">
<title>gate_12&#45;&gt;expert0_fc1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6431.31,-10085.6C5959.6,-10072.58 4829.47,-10037.21 4450.77,-9988.09 4450.66,-9988.07 4450.55,-9988.06 4450.45,-9988.04"/>
<polygon fill="black" stroke="black" points="4450.76,-9984.55 4440.38,-9986.69 4449.83,-9991.49 4450.76,-9984.55"/>
<text text-anchor="middle" x="4859.27" y="-10009.89" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_12 -->
<g id="node386" class="node">
<title>expert1_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="5067.31,-9988.09 4584.45,-9988.09 4460.23,-9852.09 4943.09,-9852.09 5067.31,-9988.09"/>
<text text-anchor="middle" x="4763.77" y="-9938.89" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="4763.77" y="-9923.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="4763.77" y="-9908.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="4763.77" y="-9893.89" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_12&#45;&gt;expert1_fc1_12 -->
<g id="edge486" class="edge">
<title>gate_12&#45;&gt;expert1_fc1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6432.89,-10086.96C6131.91,-10078.85 5559.34,-10055.25 5076.77,-9988.09 5076.55,-9988.05 5076.32,-9988.02 5076.1,-9987.99"/>
<polygon fill="black" stroke="black" points="5076.37,-9984.5 5065.98,-9986.54 5075.38,-9991.42 5076.37,-9984.5"/>
<text text-anchor="middle" x="5377.27" y="-10009.89" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_12 -->
<g id="node389" class="node">
<title>expert2_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="5693.31,-9988.09 5210.45,-9988.09 5086.23,-9852.09 5569.09,-9852.09 5693.31,-9988.09"/>
<text text-anchor="middle" x="5389.77" y="-9938.89" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="5389.77" y="-9923.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5389.77" y="-9908.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5389.77" y="-9893.89" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_12&#45;&gt;expert2_fc1_12 -->
<g id="edge490" class="edge">
<title>gate_12&#45;&gt;expert2_fc1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6418.93,-10073.07C6228.13,-10056.11 5946.43,-10027.42 5702.77,-9988.09 5702.55,-9988.05 5702.32,-9988.01 5702.1,-9987.98"/>
<polygon fill="black" stroke="black" points="5702.45,-9984.49 5692.01,-9986.32 5701.31,-9991.39 5702.45,-9984.49"/>
<text text-anchor="middle" x="5953.27" y="-10009.89" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_12 -->
<g id="node392" class="node">
<title>expert3_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="6319.31,-9988.09 5836.45,-9988.09 5712.23,-9852.09 6195.09,-9852.09 6319.31,-9988.09"/>
<text text-anchor="middle" x="6015.77" y="-9938.89" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="6015.77" y="-9923.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6015.77" y="-9908.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6015.77" y="-9893.89" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_12&#45;&gt;expert3_fc1_12 -->
<g id="edge494" class="edge">
<title>gate_12&#45;&gt;expert3_fc1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6450.12,-10039.04C6394.1,-10023.83 6331.95,-10006.95 6272.59,-9990.83"/>
<polygon fill="black" stroke="black" points="6273.27,-9987.39 6262.7,-9988.14 6271.43,-9994.14 6273.27,-9987.39"/>
<text text-anchor="middle" x="6412.27" y="-10009.89" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_12 -->
<g id="node395" class="node">
<title>expert4_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="6945.31,-9988.09 6462.45,-9988.09 6338.23,-9852.09 6821.09,-9852.09 6945.31,-9988.09"/>
<text text-anchor="middle" x="6641.77" y="-9938.89" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="6641.77" y="-9923.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6641.77" y="-9908.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6641.77" y="-9893.89" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_12&#45;&gt;expert4_fc1_12 -->
<g id="edge498" class="edge">
<title>gate_12&#45;&gt;expert4_fc1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6641.77,-10038.69C6641.77,-10026.02 6641.77,-10012.21 6641.77,-9998.65"/>
<polygon fill="black" stroke="black" points="6645.27,-9998.36 6641.77,-9988.36 6638.27,-9998.36 6645.27,-9998.36"/>
<text text-anchor="middle" x="6687.27" y="-10009.89" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_12 -->
<g id="node398" class="node">
<title>expert5_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="7571.31,-9988.09 7088.45,-9988.09 6964.23,-9852.09 7447.09,-9852.09 7571.31,-9988.09"/>
<text text-anchor="middle" x="7267.77" y="-9938.89" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="7267.77" y="-9923.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7267.77" y="-9908.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7267.77" y="-9893.89" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_12&#45;&gt;expert5_fc1_12 -->
<g id="edge502" class="edge">
<title>gate_12&#45;&gt;expert5_fc1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6833.42,-10039.04C6906.78,-10019.12 6990.67,-9996.33 7065.04,-9976.14"/>
<polygon fill="black" stroke="black" points="7066.27,-9979.43 7075,-9973.43 7064.43,-9972.68 7066.27,-9979.43"/>
<text text-anchor="middle" x="7000.27" y="-10009.89" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_12 -->
<g id="node401" class="node">
<title>expert6_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="8197.31,-9988.09 7714.45,-9988.09 7590.23,-9852.09 8073.09,-9852.09 8197.31,-9988.09"/>
<text text-anchor="middle" x="7893.77" y="-9938.89" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="7893.77" y="-9923.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7893.77" y="-9908.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7893.77" y="-9893.89" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_12&#45;&gt;expert6_fc1_12 -->
<g id="edge506" class="edge">
<title>gate_12&#45;&gt;expert6_fc1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6864.6,-10073.07C7055.4,-10056.11 7337.11,-10027.42 7580.77,-9988.09 7614.47,-9982.64 7650.03,-9975.96 7684.6,-9968.93"/>
<polygon fill="black" stroke="black" points="7685.71,-9972.28 7694.81,-9966.84 7684.31,-9965.42 7685.71,-9972.28"/>
<text text-anchor="middle" x="7499.27" y="-10009.89" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_12 -->
<g id="node404" class="node">
<title>expert7_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="8823.31,-9988.09 8340.45,-9988.09 8216.23,-9852.09 8699.09,-9852.09 8823.31,-9988.09"/>
<text text-anchor="middle" x="8519.77" y="-9938.89" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="8519.77" y="-9923.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="8519.77" y="-9908.89" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="8519.77" y="-9893.89" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_12&#45;&gt;expert7_fc1_12 -->
<g id="edge510" class="edge">
<title>gate_12&#45;&gt;expert7_fc1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6850.65,-10086.96C7151.63,-10078.85 7724.19,-10055.25 8206.77,-9988.09 8240.98,-9983.32 8277.03,-9976.92 8312.01,-9969.96"/>
<polygon fill="black" stroke="black" points="8312.73,-9973.39 8321.84,-9967.99 8311.35,-9966.53 8312.73,-9973.39"/>
<text text-anchor="middle" x="8084.27" y="-10009.89" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_12 -->
<g id="node384" class="node">
<title>expert0_gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="4137.77" cy="-9763.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="4137.77" y="-9774.91" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="4137.77" y="-9759.91" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="4137.77" y="-9744.91" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert0_fc1_12&#45;&gt;expert0_gelu_12 -->
<g id="edge483" class="edge">
<title>expert0_fc1_12&#45;&gt;expert0_gelu_12</title>
<path fill="none" stroke="black" d="M4137.77,-9851.78C4137.77,-9838.19 4137.77,-9824.18 4137.77,-9811.47"/>
<polygon fill="black" stroke="black" points="4141.27,-9811.14 4137.77,-9801.14 4134.27,-9811.14 4141.27,-9811.14"/>
</g>
<!-- expert0_fc2_12 -->
<g id="node385" class="node">
<title>expert0_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="4441.31,-9689.13 3958.45,-9689.13 3834.23,-9553.13 4317.09,-9553.13 4441.31,-9689.13"/>
<text text-anchor="middle" x="4137.77" y="-9639.93" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="4137.77" y="-9624.93" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4137.77" y="-9609.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="4137.77" y="-9594.93" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_12&#45;&gt;expert0_fc2_12 -->
<g id="edge484" class="edge">
<title>expert0_gelu_12&#45;&gt;expert0_fc2_12</title>
<path fill="none" stroke="black" d="M4137.77,-9726.07C4137.77,-9717.77 4137.77,-9708.65 4137.77,-9699.36"/>
<polygon fill="black" stroke="black" points="4141.27,-9699.25 4137.77,-9689.25 4134.27,-9699.25 4141.27,-9699.25"/>
</g>
<!-- expert_agg_12 -->
<g id="node407" class="node">
<title>expert_agg_12</title>
<ellipse fill="#eedd82" stroke="black" cx="6641.77" cy="-9296.46" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="6641.77" cy="-9296.46" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="6641.77" y="-9307.76" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="6641.77" y="-9292.76" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="6641.77" y="-9277.76" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert0_fc2_12&#45;&gt;expert_agg_12 -->
<g id="edge485" class="edge">
<title>expert0_fc2_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M4336.76,-9574.58C4374.5,-9566.78 4413.76,-9559.24 4450.77,-9553.13 5162.32,-9435.73 6012.61,-9352.71 6412.5,-9317.01"/>
<polygon fill="black" stroke="black" points="6413.08,-9320.47 6422.73,-9316.1 6412.46,-9313.5 6413.08,-9320.47"/>
</g>
<!-- expert1_gelu_12 -->
<g id="node387" class="node">
<title>expert1_gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="4763.77" cy="-9763.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="4763.77" y="-9774.91" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="4763.77" y="-9759.91" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="4763.77" y="-9744.91" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert1_fc1_12&#45;&gt;expert1_gelu_12 -->
<g id="edge487" class="edge">
<title>expert1_fc1_12&#45;&gt;expert1_gelu_12</title>
<path fill="none" stroke="black" d="M4763.77,-9851.78C4763.77,-9838.19 4763.77,-9824.18 4763.77,-9811.47"/>
<polygon fill="black" stroke="black" points="4767.27,-9811.14 4763.77,-9801.14 4760.27,-9811.14 4767.27,-9811.14"/>
</g>
<!-- expert1_fc2_12 -->
<g id="node388" class="node">
<title>expert1_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="5067.31,-9689.13 4584.45,-9689.13 4460.23,-9553.13 4943.09,-9553.13 5067.31,-9689.13"/>
<text text-anchor="middle" x="4763.77" y="-9639.93" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="4763.77" y="-9624.93" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4763.77" y="-9609.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="4763.77" y="-9594.93" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_12&#45;&gt;expert1_fc2_12 -->
<g id="edge488" class="edge">
<title>expert1_gelu_12&#45;&gt;expert1_fc2_12</title>
<path fill="none" stroke="black" d="M4763.77,-9726.07C4763.77,-9717.77 4763.77,-9708.65 4763.77,-9699.36"/>
<polygon fill="black" stroke="black" points="4767.27,-9699.25 4763.77,-9689.25 4760.27,-9699.25 4767.27,-9699.25"/>
</g>
<!-- expert1_fc2_12&#45;&gt;expert_agg_12 -->
<g id="edge489" class="edge">
<title>expert1_fc2_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M4963.84,-9575.78C5001.31,-9567.91 5040.18,-9560.03 5076.77,-9553.13 5550.74,-9463.74 6108.95,-9376.96 6414.11,-9331.08"/>
<polygon fill="black" stroke="black" points="6415.04,-9334.48 6424.41,-9329.53 6414,-9327.56 6415.04,-9334.48"/>
</g>
<!-- expert2_gelu_12 -->
<g id="node390" class="node">
<title>expert2_gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="5389.77" cy="-9763.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5389.77" y="-9774.91" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="5389.77" y="-9759.91" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5389.77" y="-9744.91" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert2_fc1_12&#45;&gt;expert2_gelu_12 -->
<g id="edge491" class="edge">
<title>expert2_fc1_12&#45;&gt;expert2_gelu_12</title>
<path fill="none" stroke="black" d="M5389.77,-9851.78C5389.77,-9838.19 5389.77,-9824.18 5389.77,-9811.47"/>
<polygon fill="black" stroke="black" points="5393.27,-9811.14 5389.77,-9801.14 5386.27,-9811.14 5393.27,-9811.14"/>
</g>
<!-- expert2_fc2_12 -->
<g id="node391" class="node">
<title>expert2_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="5693.31,-9689.13 5210.45,-9689.13 5086.23,-9553.13 5569.09,-9553.13 5693.31,-9689.13"/>
<text text-anchor="middle" x="5389.77" y="-9639.93" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="5389.77" y="-9624.93" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5389.77" y="-9609.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="5389.77" y="-9594.93" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_12&#45;&gt;expert2_fc2_12 -->
<g id="edge492" class="edge">
<title>expert2_gelu_12&#45;&gt;expert2_fc2_12</title>
<path fill="none" stroke="black" d="M5389.77,-9726.07C5389.77,-9717.77 5389.77,-9708.65 5389.77,-9699.36"/>
<polygon fill="black" stroke="black" points="5393.27,-9699.25 5389.77,-9689.25 5386.27,-9699.25 5393.27,-9699.25"/>
</g>
<!-- expert2_fc2_12&#45;&gt;expert_agg_12 -->
<g id="edge493" class="edge">
<title>expert2_fc2_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M5584.71,-9569.89C5810.7,-9511.65 6182.4,-9415.85 6419.45,-9354.76"/>
<polygon fill="black" stroke="black" points="6420.42,-9358.13 6429.23,-9352.24 6418.67,-9351.35 6420.42,-9358.13"/>
</g>
<!-- expert3_gelu_12 -->
<g id="node393" class="node">
<title>expert3_gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="6015.77" cy="-9763.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6015.77" y="-9774.91" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="6015.77" y="-9759.91" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6015.77" y="-9744.91" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert3_fc1_12&#45;&gt;expert3_gelu_12 -->
<g id="edge495" class="edge">
<title>expert3_fc1_12&#45;&gt;expert3_gelu_12</title>
<path fill="none" stroke="black" d="M6015.77,-9851.78C6015.77,-9838.19 6015.77,-9824.18 6015.77,-9811.47"/>
<polygon fill="black" stroke="black" points="6019.27,-9811.14 6015.77,-9801.14 6012.27,-9811.14 6019.27,-9811.14"/>
</g>
<!-- expert3_fc2_12 -->
<g id="node394" class="node">
<title>expert3_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="6319.31,-9689.13 5836.45,-9689.13 5712.23,-9553.13 6195.09,-9553.13 6319.31,-9689.13"/>
<text text-anchor="middle" x="6015.77" y="-9639.93" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="6015.77" y="-9624.93" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6015.77" y="-9609.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6015.77" y="-9594.93" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_12&#45;&gt;expert3_fc2_12 -->
<g id="edge496" class="edge">
<title>expert3_gelu_12&#45;&gt;expert3_fc2_12</title>
<path fill="none" stroke="black" d="M6015.77,-9726.07C6015.77,-9717.77 6015.77,-9708.65 6015.77,-9699.36"/>
<polygon fill="black" stroke="black" points="6019.27,-9699.25 6015.77,-9689.25 6012.27,-9699.25 6019.27,-9699.25"/>
</g>
<!-- expert3_fc2_12&#45;&gt;expert_agg_12 -->
<g id="edge497" class="edge">
<title>expert3_fc2_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M6145.86,-9553.08C6230.18,-9509.61 6341.8,-9452.08 6437.78,-9402.61"/>
<polygon fill="black" stroke="black" points="6439.44,-9405.69 6446.72,-9398 6436.23,-9399.47 6439.44,-9405.69"/>
</g>
<!-- expert4_gelu_12 -->
<g id="node396" class="node">
<title>expert4_gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="6641.77" cy="-9763.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6641.77" y="-9774.91" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="6641.77" y="-9759.91" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6641.77" y="-9744.91" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert4_fc1_12&#45;&gt;expert4_gelu_12 -->
<g id="edge499" class="edge">
<title>expert4_fc1_12&#45;&gt;expert4_gelu_12</title>
<path fill="none" stroke="black" d="M6641.77,-9851.78C6641.77,-9838.19 6641.77,-9824.18 6641.77,-9811.47"/>
<polygon fill="black" stroke="black" points="6645.27,-9811.14 6641.77,-9801.14 6638.27,-9811.14 6645.27,-9811.14"/>
</g>
<!-- expert4_fc2_12 -->
<g id="node397" class="node">
<title>expert4_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="6945.31,-9689.13 6462.45,-9689.13 6338.23,-9553.13 6821.09,-9553.13 6945.31,-9689.13"/>
<text text-anchor="middle" x="6641.77" y="-9639.93" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="6641.77" y="-9624.93" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6641.77" y="-9609.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="6641.77" y="-9594.93" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_12&#45;&gt;expert4_fc2_12 -->
<g id="edge500" class="edge">
<title>expert4_gelu_12&#45;&gt;expert4_fc2_12</title>
<path fill="none" stroke="black" d="M6641.77,-9726.07C6641.77,-9717.77 6641.77,-9708.65 6641.77,-9699.36"/>
<polygon fill="black" stroke="black" points="6645.27,-9699.25 6641.77,-9689.25 6638.27,-9699.25 6645.27,-9699.25"/>
</g>
<!-- expert4_fc2_12&#45;&gt;expert_agg_12 -->
<g id="edge501" class="edge">
<title>expert4_fc2_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M6641.77,-9552.88C6641.77,-9544.54 6641.77,-9535.68 6641.77,-9526.47"/>
<polygon fill="black" stroke="black" points="6645.27,-9526.33 6641.77,-9516.33 6638.27,-9526.33 6645.27,-9526.33"/>
</g>
<!-- expert5_gelu_12 -->
<g id="node399" class="node">
<title>expert5_gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="7267.77" cy="-9763.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7267.77" y="-9774.91" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="7267.77" y="-9759.91" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7267.77" y="-9744.91" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert5_fc1_12&#45;&gt;expert5_gelu_12 -->
<g id="edge503" class="edge">
<title>expert5_fc1_12&#45;&gt;expert5_gelu_12</title>
<path fill="none" stroke="black" d="M7267.77,-9851.78C7267.77,-9838.19 7267.77,-9824.18 7267.77,-9811.47"/>
<polygon fill="black" stroke="black" points="7271.27,-9811.14 7267.77,-9801.14 7264.27,-9811.14 7271.27,-9811.14"/>
</g>
<!-- expert5_fc2_12 -->
<g id="node400" class="node">
<title>expert5_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="7571.31,-9689.13 7088.45,-9689.13 6964.23,-9553.13 7447.09,-9553.13 7571.31,-9689.13"/>
<text text-anchor="middle" x="7267.77" y="-9639.93" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="7267.77" y="-9624.93" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7267.77" y="-9609.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7267.77" y="-9594.93" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_12&#45;&gt;expert5_fc2_12 -->
<g id="edge504" class="edge">
<title>expert5_gelu_12&#45;&gt;expert5_fc2_12</title>
<path fill="none" stroke="black" d="M7267.77,-9726.07C7267.77,-9717.77 7267.77,-9708.65 7267.77,-9699.36"/>
<polygon fill="black" stroke="black" points="7271.27,-9699.25 7267.77,-9689.25 7264.27,-9699.25 7271.27,-9699.25"/>
</g>
<!-- expert5_fc2_12&#45;&gt;expert_agg_12 -->
<g id="edge505" class="edge">
<title>expert5_fc2_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M7137.68,-9553.08C7053.35,-9509.61 6941.74,-9452.08 6845.76,-9402.61"/>
<polygon fill="black" stroke="black" points="6847.31,-9399.47 6836.81,-9398 6844.1,-9405.69 6847.31,-9399.47"/>
</g>
<!-- expert6_gelu_12 -->
<g id="node402" class="node">
<title>expert6_gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="7893.77" cy="-9763.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7893.77" y="-9774.91" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="7893.77" y="-9759.91" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7893.77" y="-9744.91" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert6_fc1_12&#45;&gt;expert6_gelu_12 -->
<g id="edge507" class="edge">
<title>expert6_fc1_12&#45;&gt;expert6_gelu_12</title>
<path fill="none" stroke="black" d="M7893.77,-9851.78C7893.77,-9838.19 7893.77,-9824.18 7893.77,-9811.47"/>
<polygon fill="black" stroke="black" points="7897.27,-9811.14 7893.77,-9801.14 7890.27,-9811.14 7897.27,-9811.14"/>
</g>
<!-- expert6_fc2_12 -->
<g id="node403" class="node">
<title>expert6_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="8197.31,-9689.13 7714.45,-9689.13 7590.23,-9553.13 8073.09,-9553.13 8197.31,-9689.13"/>
<text text-anchor="middle" x="7893.77" y="-9639.93" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="7893.77" y="-9624.93" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7893.77" y="-9609.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="7893.77" y="-9594.93" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_12&#45;&gt;expert6_fc2_12 -->
<g id="edge508" class="edge">
<title>expert6_gelu_12&#45;&gt;expert6_fc2_12</title>
<path fill="none" stroke="black" d="M7893.77,-9726.07C7893.77,-9717.77 7893.77,-9708.65 7893.77,-9699.36"/>
<polygon fill="black" stroke="black" points="7897.27,-9699.25 7893.77,-9689.25 7890.27,-9699.25 7897.27,-9699.25"/>
</g>
<!-- expert6_fc2_12&#45;&gt;expert_agg_12 -->
<g id="edge509" class="edge">
<title>expert6_fc2_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M7633.59,-9553.08C7406.21,-9494.48 7079.63,-9410.31 6864.2,-9354.79"/>
<polygon fill="black" stroke="black" points="6864.9,-9351.36 6854.34,-9352.25 6863.15,-9358.13 6864.9,-9351.36"/>
</g>
<!-- expert7_gelu_12 -->
<g id="node405" class="node">
<title>expert7_gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="8519.77" cy="-9763.61" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="8519.77" y="-9774.91" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="8519.77" y="-9759.91" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="8519.77" y="-9744.91" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- expert7_fc1_12&#45;&gt;expert7_gelu_12 -->
<g id="edge511" class="edge">
<title>expert7_fc1_12&#45;&gt;expert7_gelu_12</title>
<path fill="none" stroke="black" d="M8519.77,-9851.78C8519.77,-9838.19 8519.77,-9824.18 8519.77,-9811.47"/>
<polygon fill="black" stroke="black" points="8523.27,-9811.14 8519.77,-9801.14 8516.27,-9811.14 8523.27,-9811.14"/>
</g>
<!-- expert7_fc2_12 -->
<g id="node406" class="node">
<title>expert7_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="8823.31,-9689.13 8340.45,-9689.13 8216.23,-9553.13 8699.09,-9553.13 8823.31,-9689.13"/>
<text text-anchor="middle" x="8519.77" y="-9639.93" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="8519.77" y="-9624.93" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="8519.77" y="-9609.93" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="8519.77" y="-9594.93" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_12&#45;&gt;expert7_fc2_12 -->
<g id="edge512" class="edge">
<title>expert7_gelu_12&#45;&gt;expert7_fc2_12</title>
<path fill="none" stroke="black" d="M8519.77,-9726.07C8519.77,-9717.77 8519.77,-9708.65 8519.77,-9699.36"/>
<polygon fill="black" stroke="black" points="8523.27,-9699.25 8519.77,-9689.25 8516.27,-9699.25 8523.27,-9699.25"/>
</g>
<!-- expert7_fc2_12&#45;&gt;expert_agg_12 -->
<g id="edge513" class="edge">
<title>expert7_fc2_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M8217.89,-9555.25C8214.16,-9554.53 8210.45,-9553.83 8206.77,-9553.13 7732.8,-9463.74 7174.59,-9376.96 6869.43,-9331.08"/>
<polygon fill="black" stroke="black" points="6869.54,-9327.56 6859.13,-9329.53 6868.5,-9334.48 6869.54,-9327.56"/>
</g>
<!-- expert_agg_12&#45;&gt;residual2_12 -->
<g id="edge514" class="edge">
<title>expert_agg_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M6853.19,-9236.6C7081.4,-9173.06 7437.14,-9074.01 7623.47,-9022.13"/>
<polygon fill="black" stroke="black" points="7624.61,-9025.44 7633.3,-9019.39 7622.73,-9018.7 7624.61,-9025.44"/>
</g>
<!-- comm_12 -->
<g id="node409" class="node">
<title>comm_12</title>
<polygon fill="yellow" stroke="black" points="7864.51,-8835.41 7864.51,-8869.06 7795.54,-8892.86 7698,-8892.86 7629.03,-8869.06 7629.03,-8835.41 7698,-8811.61 7795.54,-8811.61 7864.51,-8835.41"/>
<polygon fill="none" stroke="black" points="7868.5,-8832.55 7868.5,-8871.92 7796.21,-8896.86 7697.33,-8896.86 7625.04,-8871.92 7625.04,-8832.55 7697.33,-8807.6 7796.21,-8807.6 7868.5,-8832.55"/>
<text text-anchor="middle" x="7746.77" y="-8863.53" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="7746.77" y="-8848.53" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="7746.77" y="-8833.53" font-family="Times,serif" font-size="14.00">GPU11→GPU12</text>
</g>
<!-- residual2_12&#45;&gt;comm_12 -->
<g id="edge516" class="edge">
<title>residual2_12&#45;&gt;comm_12</title>
<path fill="none" stroke="black" d="M7746.77,-8933.78C7746.77,-8925.03 7746.77,-8915.92 7746.77,-8907.11"/>
<polygon fill="black" stroke="black" points="7750.27,-8906.95 7746.77,-8896.95 7743.27,-8906.95 7750.27,-8906.95"/>
</g>
<!-- ln1_13 -->
<g id="node410" class="node">
<title>ln1_13</title>
<polygon fill="lightcoral" stroke="black" points="7743.77,-8770.67 7599.77,-8770.67 7599.77,-8717.67 7743.77,-8717.67 7743.77,-8770.67"/>
<text text-anchor="middle" x="7671.77" y="-8755.47" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7671.77" y="-8740.47" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="7671.77" y="-8725.47" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- comm_12&#45;&gt;ln1_13 -->
<g id="edge517" class="edge">
<title>comm_12&#45;&gt;ln1_13</title>
<path fill="none" stroke="black" d="M7715.83,-8807.48C7709.16,-8798.05 7702.21,-8788.22 7695.85,-8779.23"/>
<polygon fill="black" stroke="black" points="7698.6,-8777.05 7689.97,-8770.9 7692.88,-8781.09 7698.6,-8777.05"/>
</g>
<!-- residual1_13 -->
<g id="node414" class="node">
<title>residual1_13</title>
<polygon fill="lightcoral" stroke="black" points="7668.77,-8172.62 7375.77,-8119.62 7668.77,-8066.62 7961.77,-8119.62 7668.77,-8172.62"/>
<text text-anchor="middle" x="7668.77" y="-8130.92" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="7668.77" y="-8115.92" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="7668.77" y="-8100.92" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- comm_12&#45;&gt;residual1_13 -->
<g id="edge522" class="edge">
<title>comm_12&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7800.04,-8808.92C7816.2,-8791.34 7829.77,-8769.37 7829.77,-8745.17 7829.77,-8745.17 7829.77,-8745.17 7829.77,-8276.62 7829.77,-8245.55 7828.55,-8234.38 7809.77,-8209.62 7796.05,-8191.54 7777.52,-8176.19 7758.39,-8163.59"/>
<polygon fill="black" stroke="black" points="7760.2,-8160.59 7749.88,-8158.17 7756.44,-8166.49 7760.2,-8160.59"/>
<text text-anchor="middle" x="7858.77" y="-8515.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_13 -->
<g id="node411" class="node">
<title>qkv_proj_13</title>
<polygon fill="lightcoral" stroke="black" points="7801.31,-8680.67 7318.45,-8680.67 7194.23,-8544.67 7677.09,-8544.67 7801.31,-8680.67"/>
<text text-anchor="middle" x="7497.77" y="-8631.47" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7497.77" y="-8616.47" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="7497.77" y="-8601.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7497.77" y="-8586.47" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_13&#45;&gt;qkv_proj_13 -->
<g id="edge518" class="edge">
<title>ln1_13&#45;&gt;qkv_proj_13</title>
<path fill="none" stroke="black" d="M7637.39,-8717.58C7625.27,-8708.56 7610.98,-8697.92 7596.23,-8686.95"/>
<polygon fill="black" stroke="black" points="7598.12,-8683.99 7588,-8680.83 7593.94,-8689.6 7598.12,-8683.99"/>
</g>
<!-- mha_13 -->
<g id="node412" class="node">
<title>mha_13</title>
<polygon fill="lightcoral" stroke="black" points="7743.24,-8438.15 7623.5,-8493.69 7384.04,-8493.69 7264.3,-8438.15 7384.04,-8382.6 7623.5,-8382.6 7743.24,-8438.15"/>
<text text-anchor="middle" x="7503.77" y="-8456.95" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="7503.77" y="-8441.95" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="7503.77" y="-8426.95" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7503.77" y="-8411.95" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- qkv_proj_13&#45;&gt;mha_13 -->
<g id="edge519" class="edge">
<title>qkv_proj_13&#45;&gt;mha_13</title>
<path fill="none" stroke="black" d="M7500.11,-8544.47C7500.57,-8531.26 7501.05,-8517.42 7501.5,-8504.27"/>
<polygon fill="black" stroke="black" points="7505.01,-8504.02 7501.86,-8493.91 7498.02,-8503.78 7505.01,-8504.02"/>
</g>
<!-- out_proj_13 -->
<g id="node413" class="node">
<title>out_proj_13</title>
<polygon fill="lightcoral" stroke="black" points="7801.14,-8345.62 7332.86,-8345.62 7212.39,-8209.62 7680.68,-8209.62 7801.14,-8345.62"/>
<text text-anchor="middle" x="7506.77" y="-8296.42" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7506.77" y="-8281.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7506.77" y="-8266.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7506.77" y="-8251.42" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_13&#45;&gt;out_proj_13 -->
<g id="edge520" class="edge">
<title>mha_13&#45;&gt;out_proj_13</title>
<path fill="none" stroke="black" d="M7504.8,-8382.59C7504.96,-8374 7505.13,-8364.98 7505.3,-8356"/>
<polygon fill="black" stroke="black" points="7508.81,-8355.95 7505.5,-8345.89 7501.81,-8355.82 7508.81,-8355.95"/>
</g>
<!-- out_proj_13&#45;&gt;residual1_13 -->
<g id="edge521" class="edge">
<title>out_proj_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M7576.41,-8209.56C7589.6,-8196.86 7603.2,-8183.76 7615.78,-8171.65"/>
<polygon fill="black" stroke="black" points="7618.27,-8174.11 7623.05,-8164.65 7613.42,-8169.07 7618.27,-8174.11"/>
</g>
<!-- ln2_13 -->
<g id="node415" class="node">
<title>ln2_13</title>
<polygon fill="lightcoral" stroke="black" points="7426.77,-8029.62 7282.77,-8029.62 7282.77,-7976.62 7426.77,-7976.62 7426.77,-8029.62"/>
<text text-anchor="middle" x="7354.77" y="-8014.42" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7354.77" y="-7999.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="7354.77" y="-7984.42" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge523" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M7573.28,-8083.8C7528.83,-8067.59 7476.56,-8048.54 7434.29,-8033.12"/>
<polygon fill="black" stroke="black" points="7435.48,-8029.83 7424.88,-8029.69 7433.08,-8036.41 7435.48,-8029.83"/>
</g>
<!-- residual2_13 -->
<g id="node442" class="node">
<title>residual2_13</title>
<polygon fill="lightcoral" stroke="black" points="6877.77,-6834.34 6584.77,-6781.34 6877.77,-6728.34 7170.77,-6781.34 6877.77,-6834.34"/>
<text text-anchor="middle" x="6877.77" y="-6792.64" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="6877.77" y="-6777.64" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="6877.77" y="-6762.64" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- residual1_13&#45;&gt;residual2_13 -->
<g id="edge558" class="edge">
<title>residual1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7811.99,-8092.53C7894.8,-8073.21 7982.77,-8043.44 7982.77,-8004.12 7982.77,-8004.12 7982.77,-8004.12 7982.77,-7090 7982.77,-6907.16 7414.21,-6828.32 7092.76,-6798.36"/>
<polygon fill="black" stroke="black" points="7092.65,-6794.84 7082.38,-6797.4 7092.01,-6801.81 7092.65,-6794.84"/>
<text text-anchor="middle" x="8011.77" y="-7617.42" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_13 -->
<g id="node416" class="node">
<title>gate_13</title>
<polygon fill="lightcoral" stroke="black" points="5922.86,-7939.62 5622.68,-7939.62 5515.77,-7833.62 6029.77,-7833.62 5922.86,-7939.62"/>
<text text-anchor="middle" x="5772.77" y="-7897.92" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="5772.77" y="-7882.92" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="5772.77" y="-7867.92" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- ln2_13&#45;&gt;gate_13 -->
<g id="edge524" class="edge">
<title>ln2_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M7282.68,-7996.91C7052.03,-7980.21 6326.51,-7927.7 5971.87,-7902.03"/>
<polygon fill="black" stroke="black" points="5971.97,-7898.53 5961.74,-7901.3 5971.47,-7905.51 5971.97,-7898.53"/>
</g>
<!-- expert0_fc1_13 -->
<g id="node417" class="node">
<title>expert0_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="3572.31,-7782.62 3089.45,-7782.62 2965.23,-7646.62 3448.09,-7646.62 3572.31,-7782.62"/>
<text text-anchor="middle" x="3268.77" y="-7733.42" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="3268.77" y="-7718.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="3268.77" y="-7703.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3268.77" y="-7688.42" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_13&#45;&gt;expert0_fc1_13 -->
<g id="edge525" class="edge">
<title>gate_13&#45;&gt;expert0_fc1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5562.31,-7880.14C5090.6,-7867.12 3960.47,-7831.75 3581.77,-7782.62 3581.66,-7782.61 3581.55,-7782.6 3581.45,-7782.58"/>
<polygon fill="black" stroke="black" points="3581.76,-7779.09 3571.38,-7781.23 3580.83,-7786.03 3581.76,-7779.09"/>
<text text-anchor="middle" x="3990.27" y="-7804.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_13 -->
<g id="node420" class="node">
<title>expert1_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="4198.31,-7782.62 3715.45,-7782.62 3591.23,-7646.62 4074.09,-7646.62 4198.31,-7782.62"/>
<text text-anchor="middle" x="3894.77" y="-7733.42" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="3894.77" y="-7718.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="3894.77" y="-7703.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3894.77" y="-7688.42" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_13&#45;&gt;expert1_fc1_13 -->
<g id="edge529" class="edge">
<title>gate_13&#45;&gt;expert1_fc1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5563.89,-7881.5C5262.91,-7873.39 4690.34,-7849.79 4207.77,-7782.62 4207.55,-7782.59 4207.32,-7782.56 4207.1,-7782.53"/>
<polygon fill="black" stroke="black" points="4207.37,-7779.03 4196.98,-7781.08 4206.38,-7785.96 4207.37,-7779.03"/>
<text text-anchor="middle" x="4508.27" y="-7804.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_13 -->
<g id="node423" class="node">
<title>expert2_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="4824.31,-7782.62 4341.45,-7782.62 4217.23,-7646.62 4700.09,-7646.62 4824.31,-7782.62"/>
<text text-anchor="middle" x="4520.77" y="-7733.42" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="4520.77" y="-7718.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="4520.77" y="-7703.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="4520.77" y="-7688.42" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_13&#45;&gt;expert2_fc1_13 -->
<g id="edge533" class="edge">
<title>gate_13&#45;&gt;expert2_fc1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5549.93,-7867.61C5359.13,-7850.65 5077.43,-7821.96 4833.77,-7782.62 4833.55,-7782.59 4833.32,-7782.55 4833.1,-7782.52"/>
<polygon fill="black" stroke="black" points="4833.45,-7779.03 4823.01,-7780.86 4832.31,-7785.93 4833.45,-7779.03"/>
<text text-anchor="middle" x="5084.27" y="-7804.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_13 -->
<g id="node426" class="node">
<title>expert3_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="5450.31,-7782.62 4967.45,-7782.62 4843.23,-7646.62 5326.09,-7646.62 5450.31,-7782.62"/>
<text text-anchor="middle" x="5146.77" y="-7733.42" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="5146.77" y="-7718.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5146.77" y="-7703.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="5146.77" y="-7688.42" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_13&#45;&gt;expert3_fc1_13 -->
<g id="edge537" class="edge">
<title>gate_13&#45;&gt;expert3_fc1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5581.12,-7833.58C5525.1,-7818.37 5462.95,-7801.49 5403.59,-7785.37"/>
<polygon fill="black" stroke="black" points="5404.27,-7781.93 5393.7,-7782.68 5402.43,-7788.68 5404.27,-7781.93"/>
<text text-anchor="middle" x="5543.27" y="-7804.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_13 -->
<g id="node429" class="node">
<title>expert4_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="6076.31,-7782.62 5593.45,-7782.62 5469.23,-7646.62 5952.09,-7646.62 6076.31,-7782.62"/>
<text text-anchor="middle" x="5772.77" y="-7733.42" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="5772.77" y="-7718.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5772.77" y="-7703.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="5772.77" y="-7688.42" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_13&#45;&gt;expert4_fc1_13 -->
<g id="edge541" class="edge">
<title>gate_13&#45;&gt;expert4_fc1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5772.77,-7833.23C5772.77,-7820.56 5772.77,-7806.75 5772.77,-7793.19"/>
<polygon fill="black" stroke="black" points="5776.27,-7792.9 5772.77,-7782.9 5769.27,-7792.9 5776.27,-7792.9"/>
<text text-anchor="middle" x="5818.27" y="-7804.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_13 -->
<g id="node432" class="node">
<title>expert5_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="6702.31,-7782.62 6219.45,-7782.62 6095.23,-7646.62 6578.09,-7646.62 6702.31,-7782.62"/>
<text text-anchor="middle" x="6398.77" y="-7733.42" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="6398.77" y="-7718.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6398.77" y="-7703.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6398.77" y="-7688.42" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_13&#45;&gt;expert5_fc1_13 -->
<g id="edge545" class="edge">
<title>gate_13&#45;&gt;expert5_fc1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5964.42,-7833.58C6037.78,-7813.66 6121.67,-7790.87 6196.04,-7770.68"/>
<polygon fill="black" stroke="black" points="6197.27,-7773.97 6206,-7767.97 6195.43,-7767.22 6197.27,-7773.97"/>
<text text-anchor="middle" x="6131.27" y="-7804.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_13 -->
<g id="node435" class="node">
<title>expert6_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="7328.31,-7782.62 6845.45,-7782.62 6721.23,-7646.62 7204.09,-7646.62 7328.31,-7782.62"/>
<text text-anchor="middle" x="7024.77" y="-7733.42" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="7024.77" y="-7718.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7024.77" y="-7703.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7024.77" y="-7688.42" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_13&#45;&gt;expert6_fc1_13 -->
<g id="edge549" class="edge">
<title>gate_13&#45;&gt;expert6_fc1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5995.6,-7867.61C6186.4,-7850.65 6468.11,-7821.96 6711.77,-7782.62 6745.47,-7777.18 6781.03,-7770.49 6815.6,-7763.47"/>
<polygon fill="black" stroke="black" points="6816.71,-7766.82 6825.81,-7761.38 6815.31,-7759.96 6816.71,-7766.82"/>
<text text-anchor="middle" x="6630.27" y="-7804.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_13 -->
<g id="node438" class="node">
<title>expert7_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="7954.31,-7782.62 7471.45,-7782.62 7347.23,-7646.62 7830.09,-7646.62 7954.31,-7782.62"/>
<text text-anchor="middle" x="7650.77" y="-7733.42" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="7650.77" y="-7718.42" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="7650.77" y="-7703.42" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7650.77" y="-7688.42" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_13&#45;&gt;expert7_fc1_13 -->
<g id="edge553" class="edge">
<title>gate_13&#45;&gt;expert7_fc1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5981.65,-7881.5C6282.63,-7873.39 6855.19,-7849.79 7337.77,-7782.62 7371.98,-7777.86 7408.03,-7771.46 7443.01,-7764.5"/>
<polygon fill="black" stroke="black" points="7443.73,-7767.93 7452.84,-7762.53 7442.35,-7761.07 7443.73,-7767.93"/>
<text text-anchor="middle" x="7215.27" y="-7804.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_13 -->
<g id="node418" class="node">
<title>expert0_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="3268.77" cy="-7558.15" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="3268.77" y="-7569.45" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="3268.77" y="-7554.45" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="3268.77" y="-7539.45" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert0_fc1_13&#45;&gt;expert0_gelu_13 -->
<g id="edge526" class="edge">
<title>expert0_fc1_13&#45;&gt;expert0_gelu_13</title>
<path fill="none" stroke="black" d="M3268.77,-7646.32C3268.77,-7632.72 3268.77,-7618.71 3268.77,-7606.01"/>
<polygon fill="black" stroke="black" points="3272.27,-7605.68 3268.77,-7595.68 3265.27,-7605.68 3272.27,-7605.68"/>
</g>
<!-- expert0_fc2_13 -->
<g id="node419" class="node">
<title>expert0_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="3572.31,-7483.67 3089.45,-7483.67 2965.23,-7347.67 3448.09,-7347.67 3572.31,-7483.67"/>
<text text-anchor="middle" x="3268.77" y="-7434.47" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="3268.77" y="-7419.47" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="3268.77" y="-7404.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3268.77" y="-7389.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_13&#45;&gt;expert0_fc2_13 -->
<g id="edge527" class="edge">
<title>expert0_gelu_13&#45;&gt;expert0_fc2_13</title>
<path fill="none" stroke="black" d="M3268.77,-7520.61C3268.77,-7512.31 3268.77,-7503.19 3268.77,-7493.9"/>
<polygon fill="black" stroke="black" points="3272.27,-7493.79 3268.77,-7483.79 3265.27,-7493.79 3272.27,-7493.79"/>
</g>
<!-- expert_agg_13 -->
<g id="node441" class="node">
<title>expert_agg_13</title>
<ellipse fill="lightcoral" stroke="black" cx="5772.77" cy="-7091" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="5772.77" cy="-7091" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="5772.77" y="-7102.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="5772.77" y="-7087.3" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="5772.77" y="-7072.3" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert0_fc2_13&#45;&gt;expert_agg_13 -->
<g id="edge528" class="edge">
<title>expert0_fc2_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3467.76,-7369.12C3505.5,-7361.32 3544.76,-7353.78 3581.77,-7347.67 4293.32,-7230.27 5143.61,-7147.25 5543.5,-7111.55"/>
<polygon fill="black" stroke="black" points="5544.08,-7115.01 5553.73,-7110.64 5543.46,-7108.04 5544.08,-7115.01"/>
</g>
<!-- expert1_gelu_13 -->
<g id="node421" class="node">
<title>expert1_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="3894.77" cy="-7558.15" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="3894.77" y="-7569.45" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="3894.77" y="-7554.45" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="3894.77" y="-7539.45" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert1_fc1_13&#45;&gt;expert1_gelu_13 -->
<g id="edge530" class="edge">
<title>expert1_fc1_13&#45;&gt;expert1_gelu_13</title>
<path fill="none" stroke="black" d="M3894.77,-7646.32C3894.77,-7632.72 3894.77,-7618.71 3894.77,-7606.01"/>
<polygon fill="black" stroke="black" points="3898.27,-7605.68 3894.77,-7595.68 3891.27,-7605.68 3898.27,-7605.68"/>
</g>
<!-- expert1_fc2_13 -->
<g id="node422" class="node">
<title>expert1_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="4198.31,-7483.67 3715.45,-7483.67 3591.23,-7347.67 4074.09,-7347.67 4198.31,-7483.67"/>
<text text-anchor="middle" x="3894.77" y="-7434.47" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="3894.77" y="-7419.47" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="3894.77" y="-7404.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="3894.77" y="-7389.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_13&#45;&gt;expert1_fc2_13 -->
<g id="edge531" class="edge">
<title>expert1_gelu_13&#45;&gt;expert1_fc2_13</title>
<path fill="none" stroke="black" d="M3894.77,-7520.61C3894.77,-7512.31 3894.77,-7503.19 3894.77,-7493.9"/>
<polygon fill="black" stroke="black" points="3898.27,-7493.79 3894.77,-7483.79 3891.27,-7493.79 3898.27,-7493.79"/>
</g>
<!-- expert1_fc2_13&#45;&gt;expert_agg_13 -->
<g id="edge532" class="edge">
<title>expert1_fc2_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M4094.84,-7370.32C4132.31,-7362.45 4171.18,-7354.57 4207.77,-7347.67 4681.74,-7258.28 5239.95,-7171.5 5545.11,-7125.62"/>
<polygon fill="black" stroke="black" points="5546.04,-7129.02 5555.41,-7124.07 5545,-7122.1 5546.04,-7129.02"/>
</g>
<!-- expert2_gelu_13 -->
<g id="node424" class="node">
<title>expert2_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="4520.77" cy="-7558.15" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="4520.77" y="-7569.45" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="4520.77" y="-7554.45" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="4520.77" y="-7539.45" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert2_fc1_13&#45;&gt;expert2_gelu_13 -->
<g id="edge534" class="edge">
<title>expert2_fc1_13&#45;&gt;expert2_gelu_13</title>
<path fill="none" stroke="black" d="M4520.77,-7646.32C4520.77,-7632.72 4520.77,-7618.71 4520.77,-7606.01"/>
<polygon fill="black" stroke="black" points="4524.27,-7605.68 4520.77,-7595.68 4517.27,-7605.68 4524.27,-7605.68"/>
</g>
<!-- expert2_fc2_13 -->
<g id="node425" class="node">
<title>expert2_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="4824.31,-7483.67 4341.45,-7483.67 4217.23,-7347.67 4700.09,-7347.67 4824.31,-7483.67"/>
<text text-anchor="middle" x="4520.77" y="-7434.47" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="4520.77" y="-7419.47" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4520.77" y="-7404.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="4520.77" y="-7389.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_13&#45;&gt;expert2_fc2_13 -->
<g id="edge535" class="edge">
<title>expert2_gelu_13&#45;&gt;expert2_fc2_13</title>
<path fill="none" stroke="black" d="M4520.77,-7520.61C4520.77,-7512.31 4520.77,-7503.19 4520.77,-7493.9"/>
<polygon fill="black" stroke="black" points="4524.27,-7493.79 4520.77,-7483.79 4517.27,-7493.79 4524.27,-7493.79"/>
</g>
<!-- expert2_fc2_13&#45;&gt;expert_agg_13 -->
<g id="edge536" class="edge">
<title>expert2_fc2_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M4715.71,-7364.43C4941.7,-7306.19 5313.4,-7210.39 5550.45,-7149.3"/>
<polygon fill="black" stroke="black" points="5551.42,-7152.67 5560.23,-7146.78 5549.67,-7145.89 5551.42,-7152.67"/>
</g>
<!-- expert3_gelu_13 -->
<g id="node427" class="node">
<title>expert3_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="5146.77" cy="-7558.15" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5146.77" y="-7569.45" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="5146.77" y="-7554.45" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5146.77" y="-7539.45" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert3_fc1_13&#45;&gt;expert3_gelu_13 -->
<g id="edge538" class="edge">
<title>expert3_fc1_13&#45;&gt;expert3_gelu_13</title>
<path fill="none" stroke="black" d="M5146.77,-7646.32C5146.77,-7632.72 5146.77,-7618.71 5146.77,-7606.01"/>
<polygon fill="black" stroke="black" points="5150.27,-7605.68 5146.77,-7595.68 5143.27,-7605.68 5150.27,-7605.68"/>
</g>
<!-- expert3_fc2_13 -->
<g id="node428" class="node">
<title>expert3_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="5450.31,-7483.67 4967.45,-7483.67 4843.23,-7347.67 5326.09,-7347.67 5450.31,-7483.67"/>
<text text-anchor="middle" x="5146.77" y="-7434.47" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="5146.77" y="-7419.47" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5146.77" y="-7404.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="5146.77" y="-7389.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_13&#45;&gt;expert3_fc2_13 -->
<g id="edge539" class="edge">
<title>expert3_gelu_13&#45;&gt;expert3_fc2_13</title>
<path fill="none" stroke="black" d="M5146.77,-7520.61C5146.77,-7512.31 5146.77,-7503.19 5146.77,-7493.9"/>
<polygon fill="black" stroke="black" points="5150.27,-7493.79 5146.77,-7483.79 5143.27,-7493.79 5150.27,-7493.79"/>
</g>
<!-- expert3_fc2_13&#45;&gt;expert_agg_13 -->
<g id="edge540" class="edge">
<title>expert3_fc2_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M5276.86,-7347.62C5361.18,-7304.15 5472.8,-7246.62 5568.78,-7197.15"/>
<polygon fill="black" stroke="black" points="5570.44,-7200.23 5577.72,-7192.54 5567.23,-7194.01 5570.44,-7200.23"/>
</g>
<!-- expert4_gelu_13 -->
<g id="node430" class="node">
<title>expert4_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="5772.77" cy="-7558.15" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5772.77" y="-7569.45" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="5772.77" y="-7554.45" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5772.77" y="-7539.45" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert4_fc1_13&#45;&gt;expert4_gelu_13 -->
<g id="edge542" class="edge">
<title>expert4_fc1_13&#45;&gt;expert4_gelu_13</title>
<path fill="none" stroke="black" d="M5772.77,-7646.32C5772.77,-7632.72 5772.77,-7618.71 5772.77,-7606.01"/>
<polygon fill="black" stroke="black" points="5776.27,-7605.68 5772.77,-7595.68 5769.27,-7605.68 5776.27,-7605.68"/>
</g>
<!-- expert4_fc2_13 -->
<g id="node431" class="node">
<title>expert4_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="6076.31,-7483.67 5593.45,-7483.67 5469.23,-7347.67 5952.09,-7347.67 6076.31,-7483.67"/>
<text text-anchor="middle" x="5772.77" y="-7434.47" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="5772.77" y="-7419.47" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5772.77" y="-7404.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="5772.77" y="-7389.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_13&#45;&gt;expert4_fc2_13 -->
<g id="edge543" class="edge">
<title>expert4_gelu_13&#45;&gt;expert4_fc2_13</title>
<path fill="none" stroke="black" d="M5772.77,-7520.61C5772.77,-7512.31 5772.77,-7503.19 5772.77,-7493.9"/>
<polygon fill="black" stroke="black" points="5776.27,-7493.79 5772.77,-7483.79 5769.27,-7493.79 5776.27,-7493.79"/>
</g>
<!-- expert4_fc2_13&#45;&gt;expert_agg_13 -->
<g id="edge544" class="edge">
<title>expert4_fc2_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M5772.77,-7347.42C5772.77,-7339.08 5772.77,-7330.22 5772.77,-7321.01"/>
<polygon fill="black" stroke="black" points="5776.27,-7320.87 5772.77,-7310.87 5769.27,-7320.87 5776.27,-7320.87"/>
</g>
<!-- expert5_gelu_13 -->
<g id="node433" class="node">
<title>expert5_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="6398.77" cy="-7558.15" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6398.77" y="-7569.45" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="6398.77" y="-7554.45" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6398.77" y="-7539.45" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert5_fc1_13&#45;&gt;expert5_gelu_13 -->
<g id="edge546" class="edge">
<title>expert5_fc1_13&#45;&gt;expert5_gelu_13</title>
<path fill="none" stroke="black" d="M6398.77,-7646.32C6398.77,-7632.72 6398.77,-7618.71 6398.77,-7606.01"/>
<polygon fill="black" stroke="black" points="6402.27,-7605.68 6398.77,-7595.68 6395.27,-7605.68 6402.27,-7605.68"/>
</g>
<!-- expert5_fc2_13 -->
<g id="node434" class="node">
<title>expert5_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="6702.31,-7483.67 6219.45,-7483.67 6095.23,-7347.67 6578.09,-7347.67 6702.31,-7483.67"/>
<text text-anchor="middle" x="6398.77" y="-7434.47" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="6398.77" y="-7419.47" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6398.77" y="-7404.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="6398.77" y="-7389.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_13&#45;&gt;expert5_fc2_13 -->
<g id="edge547" class="edge">
<title>expert5_gelu_13&#45;&gt;expert5_fc2_13</title>
<path fill="none" stroke="black" d="M6398.77,-7520.61C6398.77,-7512.31 6398.77,-7503.19 6398.77,-7493.9"/>
<polygon fill="black" stroke="black" points="6402.27,-7493.79 6398.77,-7483.79 6395.27,-7493.79 6402.27,-7493.79"/>
</g>
<!-- expert5_fc2_13&#45;&gt;expert_agg_13 -->
<g id="edge548" class="edge">
<title>expert5_fc2_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M6268.68,-7347.62C6184.35,-7304.15 6072.74,-7246.62 5976.76,-7197.15"/>
<polygon fill="black" stroke="black" points="5978.31,-7194.01 5967.81,-7192.54 5975.1,-7200.23 5978.31,-7194.01"/>
</g>
<!-- expert6_gelu_13 -->
<g id="node436" class="node">
<title>expert6_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="7024.77" cy="-7558.15" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7024.77" y="-7569.45" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="7024.77" y="-7554.45" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7024.77" y="-7539.45" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert6_fc1_13&#45;&gt;expert6_gelu_13 -->
<g id="edge550" class="edge">
<title>expert6_fc1_13&#45;&gt;expert6_gelu_13</title>
<path fill="none" stroke="black" d="M7024.77,-7646.32C7024.77,-7632.72 7024.77,-7618.71 7024.77,-7606.01"/>
<polygon fill="black" stroke="black" points="7028.27,-7605.68 7024.77,-7595.68 7021.27,-7605.68 7028.27,-7605.68"/>
</g>
<!-- expert6_fc2_13 -->
<g id="node437" class="node">
<title>expert6_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="7328.31,-7483.67 6845.45,-7483.67 6721.23,-7347.67 7204.09,-7347.67 7328.31,-7483.67"/>
<text text-anchor="middle" x="7024.77" y="-7434.47" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="7024.77" y="-7419.47" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7024.77" y="-7404.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7024.77" y="-7389.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_13&#45;&gt;expert6_fc2_13 -->
<g id="edge551" class="edge">
<title>expert6_gelu_13&#45;&gt;expert6_fc2_13</title>
<path fill="none" stroke="black" d="M7024.77,-7520.61C7024.77,-7512.31 7024.77,-7503.19 7024.77,-7493.9"/>
<polygon fill="black" stroke="black" points="7028.27,-7493.79 7024.77,-7483.79 7021.27,-7493.79 7028.27,-7493.79"/>
</g>
<!-- expert6_fc2_13&#45;&gt;expert_agg_13 -->
<g id="edge552" class="edge">
<title>expert6_fc2_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M6764.59,-7347.62C6537.21,-7289.02 6210.63,-7204.85 5995.2,-7149.33"/>
<polygon fill="black" stroke="black" points="5995.9,-7145.89 5985.34,-7146.79 5994.15,-7152.67 5995.9,-7145.89"/>
</g>
<!-- expert7_gelu_13 -->
<g id="node439" class="node">
<title>expert7_gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="7650.77" cy="-7558.15" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="7650.77" y="-7569.45" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="7650.77" y="-7554.45" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="7650.77" y="-7539.45" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- expert7_fc1_13&#45;&gt;expert7_gelu_13 -->
<g id="edge554" class="edge">
<title>expert7_fc1_13&#45;&gt;expert7_gelu_13</title>
<path fill="none" stroke="black" d="M7650.77,-7646.32C7650.77,-7632.72 7650.77,-7618.71 7650.77,-7606.01"/>
<polygon fill="black" stroke="black" points="7654.27,-7605.68 7650.77,-7595.68 7647.27,-7605.68 7654.27,-7605.68"/>
</g>
<!-- expert7_fc2_13 -->
<g id="node440" class="node">
<title>expert7_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="7954.31,-7483.67 7471.45,-7483.67 7347.23,-7347.67 7830.09,-7347.67 7954.31,-7483.67"/>
<text text-anchor="middle" x="7650.77" y="-7434.47" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="7650.77" y="-7419.47" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="7650.77" y="-7404.47" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="7650.77" y="-7389.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_13&#45;&gt;expert7_fc2_13 -->
<g id="edge555" class="edge">
<title>expert7_gelu_13&#45;&gt;expert7_fc2_13</title>
<path fill="none" stroke="black" d="M7650.77,-7520.61C7650.77,-7512.31 7650.77,-7503.19 7650.77,-7493.9"/>
<polygon fill="black" stroke="black" points="7654.27,-7493.79 7650.77,-7483.79 7647.27,-7493.79 7654.27,-7493.79"/>
</g>
<!-- expert7_fc2_13&#45;&gt;expert_agg_13 -->
<g id="edge556" class="edge">
<title>expert7_fc2_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M7348.89,-7349.79C7345.16,-7349.07 7341.45,-7348.37 7337.77,-7347.67 6863.8,-7258.28 6305.59,-7171.5 6000.43,-7125.62"/>
<polygon fill="black" stroke="black" points="6000.54,-7122.1 5990.13,-7124.07 5999.5,-7129.02 6000.54,-7122.1"/>
</g>
<!-- expert_agg_13&#45;&gt;residual2_13 -->
<g id="edge557" class="edge">
<title>expert_agg_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M5984.19,-7031.14C6212.4,-6967.6 6568.14,-6868.55 6754.47,-6816.67"/>
<polygon fill="black" stroke="black" points="6755.61,-6819.98 6764.3,-6813.93 6753.73,-6813.24 6755.61,-6819.98"/>
</g>
<!-- comm_13 -->
<g id="node443" class="node">
<title>comm_13</title>
<polygon fill="yellow" stroke="black" points="6995.51,-6629.94 6995.51,-6663.6 6926.54,-6687.39 6829,-6687.39 6760.03,-6663.6 6760.03,-6629.94 6829,-6606.15 6926.54,-6606.15 6995.51,-6629.94"/>
<polygon fill="none" stroke="black" points="6999.5,-6627.09 6999.5,-6666.46 6927.21,-6691.4 6828.33,-6691.4 6756.04,-6666.46 6756.04,-6627.09 6828.33,-6602.14 6927.21,-6602.14 6999.5,-6627.09"/>
<text text-anchor="middle" x="6877.77" y="-6658.07" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="6877.77" y="-6643.07" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="6877.77" y="-6628.07" font-family="Times,serif" font-size="14.00">GPU12→GPU13</text>
</g>
<!-- residual2_13&#45;&gt;comm_13 -->
<g id="edge559" class="edge">
<title>residual2_13&#45;&gt;comm_13</title>
<path fill="none" stroke="black" d="M6877.77,-6728.32C6877.77,-6719.56 6877.77,-6710.46 6877.77,-6701.65"/>
<polygon fill="black" stroke="black" points="6881.27,-6701.49 6877.77,-6691.49 6874.27,-6701.49 6881.27,-6701.49"/>
</g>
<!-- ln1_14 -->
<g id="node444" class="node">
<title>ln1_14</title>
<polygon fill="lightgreen" stroke="black" points="6870.77,-6565.21 6726.77,-6565.21 6726.77,-6512.21 6870.77,-6512.21 6870.77,-6565.21"/>
<text text-anchor="middle" x="6798.77" y="-6550.01" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6798.77" y="-6535.01" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="6798.77" y="-6520.01" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- comm_13&#45;&gt;ln1_14 -->
<g id="edge560" class="edge">
<title>comm_13&#45;&gt;ln1_14</title>
<path fill="none" stroke="black" d="M6845.18,-6602.02C6838.09,-6592.49 6830.69,-6582.56 6823.93,-6573.49"/>
<polygon fill="black" stroke="black" points="6826.72,-6571.37 6817.94,-6565.44 6821.1,-6575.55 6826.72,-6571.37"/>
</g>
<!-- residual1_14 -->
<g id="node448" class="node">
<title>residual1_14</title>
<polygon fill="lightgreen" stroke="black" points="6795.77,-5967.16 6502.77,-5914.16 6795.77,-5861.16 7088.77,-5914.16 6795.77,-5967.16"/>
<text text-anchor="middle" x="6795.77" y="-5925.46" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="6795.77" y="-5910.46" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="6795.77" y="-5895.46" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- comm_13&#45;&gt;residual1_14 -->
<g id="edge565" class="edge">
<title>comm_13&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6928.92,-6602.49C6944.1,-6584.93 6956.77,-6563.24 6956.77,-6539.71 6956.77,-6539.71 6956.77,-6539.71 6956.77,-6071.16 6956.77,-6040.09 6955.55,-6028.92 6936.77,-6004.16 6923.05,-5986.08 6904.52,-5970.73 6885.39,-5958.13"/>
<polygon fill="black" stroke="black" points="6887.2,-5955.13 6876.88,-5952.71 6883.44,-5961.03 6887.2,-5955.13"/>
<text text-anchor="middle" x="6985.77" y="-6310.01" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_14 -->
<g id="node445" class="node">
<title>qkv_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="6928.31,-6475.21 6445.45,-6475.21 6321.23,-6339.21 6804.09,-6339.21 6928.31,-6475.21"/>
<text text-anchor="middle" x="6624.77" y="-6426.01" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6624.77" y="-6411.01" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="6624.77" y="-6396.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6624.77" y="-6381.01" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_14&#45;&gt;qkv_proj_14 -->
<g id="edge561" class="edge">
<title>ln1_14&#45;&gt;qkv_proj_14</title>
<path fill="none" stroke="black" d="M6764.39,-6512.12C6752.27,-6503.1 6737.98,-6492.46 6723.23,-6481.49"/>
<polygon fill="black" stroke="black" points="6725.12,-6478.53 6715,-6475.36 6720.94,-6484.14 6725.12,-6478.53"/>
</g>
<!-- mha_14 -->
<g id="node446" class="node">
<title>mha_14</title>
<polygon fill="lightgreen" stroke="black" points="6870.24,-6232.69 6750.5,-6288.23 6511.04,-6288.23 6391.3,-6232.69 6511.04,-6177.14 6750.5,-6177.14 6870.24,-6232.69"/>
<text text-anchor="middle" x="6630.77" y="-6251.49" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="6630.77" y="-6236.49" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="6630.77" y="-6221.49" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6630.77" y="-6206.49" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- qkv_proj_14&#45;&gt;mha_14 -->
<g id="edge562" class="edge">
<title>qkv_proj_14&#45;&gt;mha_14</title>
<path fill="none" stroke="black" d="M6627.11,-6339.01C6627.57,-6325.8 6628.05,-6311.96 6628.5,-6298.81"/>
<polygon fill="black" stroke="black" points="6632.01,-6298.56 6628.86,-6288.44 6625.02,-6298.32 6632.01,-6298.56"/>
</g>
<!-- out_proj_14 -->
<g id="node447" class="node">
<title>out_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="6928.14,-6140.16 6459.86,-6140.16 6339.39,-6004.16 6807.68,-6004.16 6928.14,-6140.16"/>
<text text-anchor="middle" x="6633.77" y="-6090.96" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6633.77" y="-6075.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6633.77" y="-6060.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6633.77" y="-6045.96" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_14&#45;&gt;out_proj_14 -->
<g id="edge563" class="edge">
<title>mha_14&#45;&gt;out_proj_14</title>
<path fill="none" stroke="black" d="M6631.8,-6177.13C6631.96,-6168.54 6632.13,-6159.52 6632.3,-6150.54"/>
<polygon fill="black" stroke="black" points="6635.81,-6150.49 6632.5,-6140.43 6628.81,-6150.36 6635.81,-6150.49"/>
</g>
<!-- out_proj_14&#45;&gt;residual1_14 -->
<g id="edge564" class="edge">
<title>out_proj_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M6703.41,-6004.1C6716.6,-5991.4 6730.2,-5978.3 6742.78,-5966.19"/>
<polygon fill="black" stroke="black" points="6745.27,-5968.65 6750.05,-5959.19 6740.42,-5963.6 6745.27,-5968.65"/>
</g>
<!-- ln2_14 -->
<g id="node449" class="node">
<title>ln2_14</title>
<polygon fill="lightgreen" stroke="black" points="6554.77,-5824.16 6410.77,-5824.16 6410.77,-5771.16 6554.77,-5771.16 6554.77,-5824.16"/>
<text text-anchor="middle" x="6482.77" y="-5808.96" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6482.77" y="-5793.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="6482.77" y="-5778.96" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge566" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M6700.58,-5878.34C6656.37,-5862.17 6604.39,-5843.15 6562.3,-5827.76"/>
<polygon fill="black" stroke="black" points="6563.25,-5824.38 6552.66,-5824.23 6560.85,-5830.95 6563.25,-5824.38"/>
</g>
<!-- residual2_14 -->
<g id="node476" class="node">
<title>residual2_14</title>
<polygon fill="lightgreen" stroke="black" points="6004.77,-4628.88 5711.77,-4575.88 6004.77,-4522.88 6297.77,-4575.88 6004.77,-4628.88"/>
<text text-anchor="middle" x="6004.77" y="-4587.18" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="6004.77" y="-4572.18" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="6004.77" y="-4557.18" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- residual1_14&#45;&gt;residual2_14 -->
<g id="edge601" class="edge">
<title>residual1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6938.99,-5887.07C7021.8,-5867.75 7109.77,-5837.98 7109.77,-5798.66 7109.77,-5798.66 7109.77,-5798.66 7109.77,-4884.54 7109.77,-4701.7 6541.21,-4622.86 6219.76,-4592.9"/>
<polygon fill="black" stroke="black" points="6219.65,-4589.38 6209.38,-4591.94 6219.01,-4596.35 6219.65,-4589.38"/>
<text text-anchor="middle" x="7138.77" y="-5411.96" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_14 -->
<g id="node450" class="node">
<title>gate_14</title>
<polygon fill="lightgreen" stroke="black" points="5049.86,-5734.16 4749.68,-5734.16 4642.77,-5628.16 5156.77,-5628.16 5049.86,-5734.16"/>
<text text-anchor="middle" x="4899.77" y="-5692.46" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="4899.77" y="-5677.46" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="4899.77" y="-5662.46" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- ln2_14&#45;&gt;gate_14 -->
<g id="edge567" class="edge">
<title>ln2_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M6410.64,-5791.45C6179.84,-5774.75 5453.86,-5722.24 5098.99,-5696.57"/>
<polygon fill="black" stroke="black" points="5099.09,-5693.07 5088.86,-5695.84 5098.59,-5700.05 5099.09,-5693.07"/>
</g>
<!-- expert0_fc1_14 -->
<g id="node451" class="node">
<title>expert0_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="2699.31,-5577.16 2216.45,-5577.16 2092.23,-5441.16 2575.09,-5441.16 2699.31,-5577.16"/>
<text text-anchor="middle" x="2395.77" y="-5527.96" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="2395.77" y="-5512.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="2395.77" y="-5497.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2395.77" y="-5482.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_14&#45;&gt;expert0_fc1_14 -->
<g id="edge568" class="edge">
<title>gate_14&#45;&gt;expert0_fc1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4689.31,-5674.68C4217.6,-5661.66 3087.47,-5626.29 2708.77,-5577.16 2708.66,-5577.15 2708.55,-5577.14 2708.45,-5577.12"/>
<polygon fill="black" stroke="black" points="2708.76,-5573.63 2698.38,-5575.77 2707.83,-5580.57 2708.76,-5573.63"/>
<text text-anchor="middle" x="3117.27" y="-5598.96" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_14 -->
<g id="node454" class="node">
<title>expert1_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="3325.31,-5577.16 2842.45,-5577.16 2718.23,-5441.16 3201.09,-5441.16 3325.31,-5577.16"/>
<text text-anchor="middle" x="3021.77" y="-5527.96" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="3021.77" y="-5512.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="3021.77" y="-5497.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3021.77" y="-5482.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_14&#45;&gt;expert1_fc1_14 -->
<g id="edge572" class="edge">
<title>gate_14&#45;&gt;expert1_fc1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4690.89,-5676.04C4389.91,-5667.92 3817.34,-5644.33 3334.77,-5577.16 3334.55,-5577.13 3334.32,-5577.1 3334.1,-5577.07"/>
<polygon fill="black" stroke="black" points="3334.37,-5573.57 3323.98,-5575.62 3333.38,-5580.5 3334.37,-5573.57"/>
<text text-anchor="middle" x="3635.27" y="-5598.96" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_14 -->
<g id="node457" class="node">
<title>expert2_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="3951.31,-5577.16 3468.45,-5577.16 3344.23,-5441.16 3827.09,-5441.16 3951.31,-5577.16"/>
<text text-anchor="middle" x="3647.77" y="-5527.96" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="3647.77" y="-5512.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="3647.77" y="-5497.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3647.77" y="-5482.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_14&#45;&gt;expert2_fc1_14 -->
<g id="edge576" class="edge">
<title>gate_14&#45;&gt;expert2_fc1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4676.93,-5662.15C4486.13,-5645.19 4204.43,-5616.5 3960.77,-5577.16 3960.55,-5577.13 3960.32,-5577.09 3960.1,-5577.06"/>
<polygon fill="black" stroke="black" points="3960.45,-5573.57 3950.01,-5575.4 3959.31,-5580.47 3960.45,-5573.57"/>
<text text-anchor="middle" x="4211.27" y="-5598.96" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_14 -->
<g id="node460" class="node">
<title>expert3_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="4577.31,-5577.16 4094.45,-5577.16 3970.23,-5441.16 4453.09,-5441.16 4577.31,-5577.16"/>
<text text-anchor="middle" x="4273.77" y="-5527.96" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="4273.77" y="-5512.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="4273.77" y="-5497.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="4273.77" y="-5482.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_14&#45;&gt;expert3_fc1_14 -->
<g id="edge580" class="edge">
<title>gate_14&#45;&gt;expert3_fc1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4708.12,-5628.12C4652.1,-5612.91 4589.95,-5596.03 4530.59,-5579.91"/>
<polygon fill="black" stroke="black" points="4531.27,-5576.46 4520.7,-5577.22 4529.43,-5583.22 4531.27,-5576.46"/>
<text text-anchor="middle" x="4670.27" y="-5598.96" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_14 -->
<g id="node463" class="node">
<title>expert4_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="5203.31,-5577.16 4720.45,-5577.16 4596.23,-5441.16 5079.09,-5441.16 5203.31,-5577.16"/>
<text text-anchor="middle" x="4899.77" y="-5527.96" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="4899.77" y="-5512.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="4899.77" y="-5497.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="4899.77" y="-5482.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_14&#45;&gt;expert4_fc1_14 -->
<g id="edge584" class="edge">
<title>gate_14&#45;&gt;expert4_fc1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4899.77,-5627.77C4899.77,-5615.1 4899.77,-5601.29 4899.77,-5587.73"/>
<polygon fill="black" stroke="black" points="4903.27,-5587.43 4899.77,-5577.43 4896.27,-5587.44 4903.27,-5587.43"/>
<text text-anchor="middle" x="4945.27" y="-5598.96" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_14 -->
<g id="node466" class="node">
<title>expert5_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="5829.31,-5577.16 5346.45,-5577.16 5222.23,-5441.16 5705.09,-5441.16 5829.31,-5577.16"/>
<text text-anchor="middle" x="5525.77" y="-5527.96" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="5525.77" y="-5512.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5525.77" y="-5497.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="5525.77" y="-5482.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_14&#45;&gt;expert5_fc1_14 -->
<g id="edge588" class="edge">
<title>gate_14&#45;&gt;expert5_fc1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5091.42,-5628.12C5164.78,-5608.19 5248.67,-5585.41 5323.04,-5565.22"/>
<polygon fill="black" stroke="black" points="5324.27,-5568.51 5333,-5562.51 5322.43,-5561.76 5324.27,-5568.51"/>
<text text-anchor="middle" x="5258.27" y="-5598.96" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_14 -->
<g id="node469" class="node">
<title>expert6_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="6455.31,-5577.16 5972.45,-5577.16 5848.23,-5441.16 6331.09,-5441.16 6455.31,-5577.16"/>
<text text-anchor="middle" x="6151.77" y="-5527.96" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="6151.77" y="-5512.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6151.77" y="-5497.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6151.77" y="-5482.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_14&#45;&gt;expert6_fc1_14 -->
<g id="edge592" class="edge">
<title>gate_14&#45;&gt;expert6_fc1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5122.6,-5662.15C5313.4,-5645.19 5595.11,-5616.5 5838.77,-5577.16 5872.47,-5571.72 5908.03,-5565.03 5942.6,-5558.01"/>
<polygon fill="black" stroke="black" points="5943.71,-5561.36 5952.81,-5555.92 5942.31,-5554.5 5943.71,-5561.36"/>
<text text-anchor="middle" x="5757.27" y="-5598.96" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_14 -->
<g id="node472" class="node">
<title>expert7_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="7081.31,-5577.16 6598.45,-5577.16 6474.23,-5441.16 6957.09,-5441.16 7081.31,-5577.16"/>
<text text-anchor="middle" x="6777.77" y="-5527.96" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="6777.77" y="-5512.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="6777.77" y="-5497.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6777.77" y="-5482.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_14&#45;&gt;expert7_fc1_14 -->
<g id="edge596" class="edge">
<title>gate_14&#45;&gt;expert7_fc1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5108.65,-5676.04C5409.63,-5667.92 5982.19,-5644.33 6464.77,-5577.16 6498.98,-5572.4 6535.03,-5566 6570.01,-5559.04"/>
<polygon fill="black" stroke="black" points="6570.73,-5562.47 6579.84,-5557.06 6569.35,-5555.6 6570.73,-5562.47"/>
<text text-anchor="middle" x="6342.27" y="-5598.96" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_14 -->
<g id="node452" class="node">
<title>expert0_gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="2395.77" cy="-5352.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="2395.77" y="-5363.99" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="2395.77" y="-5348.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="2395.77" y="-5333.99" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert0_fc1_14&#45;&gt;expert0_gelu_14 -->
<g id="edge569" class="edge">
<title>expert0_fc1_14&#45;&gt;expert0_gelu_14</title>
<path fill="none" stroke="black" d="M2395.77,-5440.86C2395.77,-5427.26 2395.77,-5413.25 2395.77,-5400.55"/>
<polygon fill="black" stroke="black" points="2399.27,-5400.22 2395.77,-5390.22 2392.27,-5400.22 2399.27,-5400.22"/>
</g>
<!-- expert0_fc2_14 -->
<g id="node453" class="node">
<title>expert0_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="2699.31,-5278.21 2216.45,-5278.21 2092.23,-5142.21 2575.09,-5142.21 2699.31,-5278.21"/>
<text text-anchor="middle" x="2395.77" y="-5229.01" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="2395.77" y="-5214.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2395.77" y="-5199.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="2395.77" y="-5184.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_14&#45;&gt;expert0_fc2_14 -->
<g id="edge570" class="edge">
<title>expert0_gelu_14&#45;&gt;expert0_fc2_14</title>
<path fill="none" stroke="black" d="M2395.77,-5315.14C2395.77,-5306.85 2395.77,-5297.73 2395.77,-5288.44"/>
<polygon fill="black" stroke="black" points="2399.27,-5288.33 2395.77,-5278.33 2392.27,-5288.33 2399.27,-5288.33"/>
</g>
<!-- expert_agg_14 -->
<g id="node475" class="node">
<title>expert_agg_14</title>
<ellipse fill="lightgreen" stroke="black" cx="4899.77" cy="-4885.54" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="4899.77" cy="-4885.54" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="4899.77" y="-4896.84" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="4899.77" y="-4881.84" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="4899.77" y="-4866.84" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert0_fc2_14&#45;&gt;expert_agg_14 -->
<g id="edge571" class="edge">
<title>expert0_fc2_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2594.76,-5163.66C2632.5,-5155.86 2671.76,-5148.32 2708.77,-5142.21 3420.32,-5024.81 4270.61,-4941.78 4670.5,-4906.09"/>
<polygon fill="black" stroke="black" points="4671.08,-4909.55 4680.73,-4905.18 4670.46,-4902.58 4671.08,-4909.55"/>
</g>
<!-- expert1_gelu_14 -->
<g id="node455" class="node">
<title>expert1_gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="3021.77" cy="-5352.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="3021.77" y="-5363.99" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="3021.77" y="-5348.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="3021.77" y="-5333.99" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert1_fc1_14&#45;&gt;expert1_gelu_14 -->
<g id="edge573" class="edge">
<title>expert1_fc1_14&#45;&gt;expert1_gelu_14</title>
<path fill="none" stroke="black" d="M3021.77,-5440.86C3021.77,-5427.26 3021.77,-5413.25 3021.77,-5400.55"/>
<polygon fill="black" stroke="black" points="3025.27,-5400.22 3021.77,-5390.22 3018.27,-5400.22 3025.27,-5400.22"/>
</g>
<!-- expert1_fc2_14 -->
<g id="node456" class="node">
<title>expert1_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="3325.31,-5278.21 2842.45,-5278.21 2718.23,-5142.21 3201.09,-5142.21 3325.31,-5278.21"/>
<text text-anchor="middle" x="3021.77" y="-5229.01" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="3021.77" y="-5214.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="3021.77" y="-5199.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3021.77" y="-5184.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_14&#45;&gt;expert1_fc2_14 -->
<g id="edge574" class="edge">
<title>expert1_gelu_14&#45;&gt;expert1_fc2_14</title>
<path fill="none" stroke="black" d="M3021.77,-5315.14C3021.77,-5306.85 3021.77,-5297.73 3021.77,-5288.44"/>
<polygon fill="black" stroke="black" points="3025.27,-5288.33 3021.77,-5278.33 3018.27,-5288.33 3025.27,-5288.33"/>
</g>
<!-- expert1_fc2_14&#45;&gt;expert_agg_14 -->
<g id="edge575" class="edge">
<title>expert1_fc2_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M3221.84,-5164.86C3259.31,-5156.99 3298.18,-5149.11 3334.77,-5142.21 3808.74,-5052.82 4366.95,-4966.04 4672.11,-4920.16"/>
<polygon fill="black" stroke="black" points="4673.04,-4923.56 4682.41,-4918.61 4672,-4916.64 4673.04,-4923.56"/>
</g>
<!-- expert2_gelu_14 -->
<g id="node458" class="node">
<title>expert2_gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="3647.77" cy="-5352.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="3647.77" y="-5363.99" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="3647.77" y="-5348.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="3647.77" y="-5333.99" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert2_fc1_14&#45;&gt;expert2_gelu_14 -->
<g id="edge577" class="edge">
<title>expert2_fc1_14&#45;&gt;expert2_gelu_14</title>
<path fill="none" stroke="black" d="M3647.77,-5440.86C3647.77,-5427.26 3647.77,-5413.25 3647.77,-5400.55"/>
<polygon fill="black" stroke="black" points="3651.27,-5400.22 3647.77,-5390.22 3644.27,-5400.22 3651.27,-5400.22"/>
</g>
<!-- expert2_fc2_14 -->
<g id="node459" class="node">
<title>expert2_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="3951.31,-5278.21 3468.45,-5278.21 3344.23,-5142.21 3827.09,-5142.21 3951.31,-5278.21"/>
<text text-anchor="middle" x="3647.77" y="-5229.01" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="3647.77" y="-5214.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="3647.77" y="-5199.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="3647.77" y="-5184.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_14&#45;&gt;expert2_fc2_14 -->
<g id="edge578" class="edge">
<title>expert2_gelu_14&#45;&gt;expert2_fc2_14</title>
<path fill="none" stroke="black" d="M3647.77,-5315.14C3647.77,-5306.85 3647.77,-5297.73 3647.77,-5288.44"/>
<polygon fill="black" stroke="black" points="3651.27,-5288.33 3647.77,-5278.33 3644.27,-5288.33 3651.27,-5288.33"/>
</g>
<!-- expert2_fc2_14&#45;&gt;expert_agg_14 -->
<g id="edge579" class="edge">
<title>expert2_fc2_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M3842.71,-5158.97C4068.7,-5100.73 4440.4,-5004.93 4677.45,-4943.84"/>
<polygon fill="black" stroke="black" points="4678.42,-4947.2 4687.23,-4941.32 4676.67,-4940.43 4678.42,-4947.2"/>
</g>
<!-- expert3_gelu_14 -->
<g id="node461" class="node">
<title>expert3_gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="4273.77" cy="-5352.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="4273.77" y="-5363.99" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="4273.77" y="-5348.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="4273.77" y="-5333.99" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert3_fc1_14&#45;&gt;expert3_gelu_14 -->
<g id="edge581" class="edge">
<title>expert3_fc1_14&#45;&gt;expert3_gelu_14</title>
<path fill="none" stroke="black" d="M4273.77,-5440.86C4273.77,-5427.26 4273.77,-5413.25 4273.77,-5400.55"/>
<polygon fill="black" stroke="black" points="4277.27,-5400.22 4273.77,-5390.22 4270.27,-5400.22 4277.27,-5400.22"/>
</g>
<!-- expert3_fc2_14 -->
<g id="node462" class="node">
<title>expert3_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="4577.31,-5278.21 4094.45,-5278.21 3970.23,-5142.21 4453.09,-5142.21 4577.31,-5278.21"/>
<text text-anchor="middle" x="4273.77" y="-5229.01" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="4273.77" y="-5214.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4273.77" y="-5199.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="4273.77" y="-5184.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_14&#45;&gt;expert3_fc2_14 -->
<g id="edge582" class="edge">
<title>expert3_gelu_14&#45;&gt;expert3_fc2_14</title>
<path fill="none" stroke="black" d="M4273.77,-5315.14C4273.77,-5306.85 4273.77,-5297.73 4273.77,-5288.44"/>
<polygon fill="black" stroke="black" points="4277.27,-5288.33 4273.77,-5278.33 4270.27,-5288.33 4277.27,-5288.33"/>
</g>
<!-- expert3_fc2_14&#45;&gt;expert_agg_14 -->
<g id="edge583" class="edge">
<title>expert3_fc2_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M4403.86,-5142.16C4488.18,-5098.69 4599.8,-5041.16 4695.78,-4991.69"/>
<polygon fill="black" stroke="black" points="4697.44,-4994.77 4704.72,-4987.08 4694.23,-4988.55 4697.44,-4994.77"/>
</g>
<!-- expert4_gelu_14 -->
<g id="node464" class="node">
<title>expert4_gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="4899.77" cy="-5352.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="4899.77" y="-5363.99" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="4899.77" y="-5348.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="4899.77" y="-5333.99" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert4_fc1_14&#45;&gt;expert4_gelu_14 -->
<g id="edge585" class="edge">
<title>expert4_fc1_14&#45;&gt;expert4_gelu_14</title>
<path fill="none" stroke="black" d="M4899.77,-5440.86C4899.77,-5427.26 4899.77,-5413.25 4899.77,-5400.55"/>
<polygon fill="black" stroke="black" points="4903.27,-5400.22 4899.77,-5390.22 4896.27,-5400.22 4903.27,-5400.22"/>
</g>
<!-- expert4_fc2_14 -->
<g id="node465" class="node">
<title>expert4_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="5203.31,-5278.21 4720.45,-5278.21 4596.23,-5142.21 5079.09,-5142.21 5203.31,-5278.21"/>
<text text-anchor="middle" x="4899.77" y="-5229.01" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="4899.77" y="-5214.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4899.77" y="-5199.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="4899.77" y="-5184.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_14&#45;&gt;expert4_fc2_14 -->
<g id="edge586" class="edge">
<title>expert4_gelu_14&#45;&gt;expert4_fc2_14</title>
<path fill="none" stroke="black" d="M4899.77,-5315.14C4899.77,-5306.85 4899.77,-5297.73 4899.77,-5288.44"/>
<polygon fill="black" stroke="black" points="4903.27,-5288.33 4899.77,-5278.33 4896.27,-5288.33 4903.27,-5288.33"/>
</g>
<!-- expert4_fc2_14&#45;&gt;expert_agg_14 -->
<g id="edge587" class="edge">
<title>expert4_fc2_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M4899.77,-5141.96C4899.77,-5133.62 4899.77,-5124.76 4899.77,-5115.54"/>
<polygon fill="black" stroke="black" points="4903.27,-5115.41 4899.77,-5105.41 4896.27,-5115.41 4903.27,-5115.41"/>
</g>
<!-- expert5_gelu_14 -->
<g id="node467" class="node">
<title>expert5_gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="5525.77" cy="-5352.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5525.77" y="-5363.99" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="5525.77" y="-5348.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5525.77" y="-5333.99" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert5_fc1_14&#45;&gt;expert5_gelu_14 -->
<g id="edge589" class="edge">
<title>expert5_fc1_14&#45;&gt;expert5_gelu_14</title>
<path fill="none" stroke="black" d="M5525.77,-5440.86C5525.77,-5427.26 5525.77,-5413.25 5525.77,-5400.55"/>
<polygon fill="black" stroke="black" points="5529.27,-5400.22 5525.77,-5390.22 5522.27,-5400.22 5529.27,-5400.22"/>
</g>
<!-- expert5_fc2_14 -->
<g id="node468" class="node">
<title>expert5_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="5829.31,-5278.21 5346.45,-5278.21 5222.23,-5142.21 5705.09,-5142.21 5829.31,-5278.21"/>
<text text-anchor="middle" x="5525.77" y="-5229.01" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="5525.77" y="-5214.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5525.77" y="-5199.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="5525.77" y="-5184.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_14&#45;&gt;expert5_fc2_14 -->
<g id="edge590" class="edge">
<title>expert5_gelu_14&#45;&gt;expert5_fc2_14</title>
<path fill="none" stroke="black" d="M5525.77,-5315.14C5525.77,-5306.85 5525.77,-5297.73 5525.77,-5288.44"/>
<polygon fill="black" stroke="black" points="5529.27,-5288.33 5525.77,-5278.33 5522.27,-5288.33 5529.27,-5288.33"/>
</g>
<!-- expert5_fc2_14&#45;&gt;expert_agg_14 -->
<g id="edge591" class="edge">
<title>expert5_fc2_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M5395.68,-5142.16C5311.35,-5098.69 5199.74,-5041.16 5103.76,-4991.69"/>
<polygon fill="black" stroke="black" points="5105.31,-4988.55 5094.81,-4987.08 5102.1,-4994.77 5105.31,-4988.55"/>
</g>
<!-- expert6_gelu_14 -->
<g id="node470" class="node">
<title>expert6_gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="6151.77" cy="-5352.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6151.77" y="-5363.99" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="6151.77" y="-5348.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6151.77" y="-5333.99" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert6_fc1_14&#45;&gt;expert6_gelu_14 -->
<g id="edge593" class="edge">
<title>expert6_fc1_14&#45;&gt;expert6_gelu_14</title>
<path fill="none" stroke="black" d="M6151.77,-5440.86C6151.77,-5427.26 6151.77,-5413.25 6151.77,-5400.55"/>
<polygon fill="black" stroke="black" points="6155.27,-5400.22 6151.77,-5390.22 6148.27,-5400.22 6155.27,-5400.22"/>
</g>
<!-- expert6_fc2_14 -->
<g id="node471" class="node">
<title>expert6_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="6455.31,-5278.21 5972.45,-5278.21 5848.23,-5142.21 6331.09,-5142.21 6455.31,-5278.21"/>
<text text-anchor="middle" x="6151.77" y="-5229.01" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="6151.77" y="-5214.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6151.77" y="-5199.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6151.77" y="-5184.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_14&#45;&gt;expert6_fc2_14 -->
<g id="edge594" class="edge">
<title>expert6_gelu_14&#45;&gt;expert6_fc2_14</title>
<path fill="none" stroke="black" d="M6151.77,-5315.14C6151.77,-5306.85 6151.77,-5297.73 6151.77,-5288.44"/>
<polygon fill="black" stroke="black" points="6155.27,-5288.33 6151.77,-5278.33 6148.27,-5288.33 6155.27,-5288.33"/>
</g>
<!-- expert6_fc2_14&#45;&gt;expert_agg_14 -->
<g id="edge595" class="edge">
<title>expert6_fc2_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M5891.59,-5142.16C5664.21,-5083.56 5337.63,-4999.39 5122.2,-4943.87"/>
<polygon fill="black" stroke="black" points="5122.9,-4940.43 5112.34,-4941.33 5121.15,-4947.21 5122.9,-4940.43"/>
</g>
<!-- expert7_gelu_14 -->
<g id="node473" class="node">
<title>expert7_gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="6777.77" cy="-5352.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="6777.77" y="-5363.99" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="6777.77" y="-5348.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="6777.77" y="-5333.99" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- expert7_fc1_14&#45;&gt;expert7_gelu_14 -->
<g id="edge597" class="edge">
<title>expert7_fc1_14&#45;&gt;expert7_gelu_14</title>
<path fill="none" stroke="black" d="M6777.77,-5440.86C6777.77,-5427.26 6777.77,-5413.25 6777.77,-5400.55"/>
<polygon fill="black" stroke="black" points="6781.27,-5400.22 6777.77,-5390.22 6774.27,-5400.22 6781.27,-5400.22"/>
</g>
<!-- expert7_fc2_14 -->
<g id="node474" class="node">
<title>expert7_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="7081.31,-5278.21 6598.45,-5278.21 6474.23,-5142.21 6957.09,-5142.21 7081.31,-5278.21"/>
<text text-anchor="middle" x="6777.77" y="-5229.01" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="6777.77" y="-5214.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="6777.77" y="-5199.01" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="6777.77" y="-5184.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_14&#45;&gt;expert7_fc2_14 -->
<g id="edge598" class="edge">
<title>expert7_gelu_14&#45;&gt;expert7_fc2_14</title>
<path fill="none" stroke="black" d="M6777.77,-5315.14C6777.77,-5306.85 6777.77,-5297.73 6777.77,-5288.44"/>
<polygon fill="black" stroke="black" points="6781.27,-5288.33 6777.77,-5278.33 6774.27,-5288.33 6781.27,-5288.33"/>
</g>
<!-- expert7_fc2_14&#45;&gt;expert_agg_14 -->
<g id="edge599" class="edge">
<title>expert7_fc2_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M6475.89,-5144.32C6472.16,-5143.61 6468.45,-5142.91 6464.77,-5142.21 5990.8,-5052.82 5432.59,-4966.04 5127.43,-4920.16"/>
<polygon fill="black" stroke="black" points="5127.54,-4916.64 5117.13,-4918.61 5126.5,-4923.56 5127.54,-4916.64"/>
</g>
<!-- expert_agg_14&#45;&gt;residual2_14 -->
<g id="edge600" class="edge">
<title>expert_agg_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M5111.19,-4825.68C5339.4,-4762.14 5695.14,-4663.09 5881.47,-4611.21"/>
<polygon fill="black" stroke="black" points="5882.61,-4614.52 5891.3,-4608.47 5880.73,-4607.78 5882.61,-4614.52"/>
</g>
<!-- comm_14 -->
<g id="node477" class="node">
<title>comm_14</title>
<polygon fill="yellow" stroke="black" points="6122.51,-4424.48 6122.51,-4458.14 6053.54,-4481.93 5956,-4481.93 5887.03,-4458.14 5887.03,-4424.48 5956,-4400.69 6053.54,-4400.69 6122.51,-4424.48"/>
<polygon fill="none" stroke="black" points="6126.5,-4421.63 6126.5,-4461 6054.21,-4485.94 5955.33,-4485.94 5883.04,-4461 5883.04,-4421.63 5955.33,-4396.68 6054.21,-4396.68 6126.5,-4421.63"/>
<text text-anchor="middle" x="6004.77" y="-4452.61" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="6004.77" y="-4437.61" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="6004.77" y="-4422.61" font-family="Times,serif" font-size="14.00">GPU13→GPU14</text>
</g>
<!-- residual2_14&#45;&gt;comm_14 -->
<g id="edge602" class="edge">
<title>residual2_14&#45;&gt;comm_14</title>
<path fill="none" stroke="black" d="M6004.77,-4522.86C6004.77,-4514.1 6004.77,-4505 6004.77,-4496.19"/>
<polygon fill="black" stroke="black" points="6008.27,-4496.03 6004.77,-4486.03 6001.27,-4496.03 6008.27,-4496.03"/>
</g>
<!-- ln1_15 -->
<g id="node478" class="node">
<title>ln1_15</title>
<polygon fill="lightyellow" stroke="black" points="6001.77,-4359.75 5857.77,-4359.75 5857.77,-4306.75 6001.77,-4306.75 6001.77,-4359.75"/>
<text text-anchor="middle" x="5929.77" y="-4344.55" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="5929.77" y="-4329.55" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="5929.77" y="-4314.55" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- comm_14&#45;&gt;ln1_15 -->
<g id="edge603" class="edge">
<title>comm_14&#45;&gt;ln1_15</title>
<path fill="none" stroke="black" d="M5973.83,-4396.56C5967.16,-4387.13 5960.21,-4377.3 5953.85,-4368.31"/>
<polygon fill="black" stroke="black" points="5956.6,-4366.13 5947.97,-4359.98 5950.88,-4370.17 5956.6,-4366.13"/>
</g>
<!-- residual1_15 -->
<g id="node482" class="node">
<title>residual1_15</title>
<polygon fill="lightyellow" stroke="black" points="5926.77,-3761.7 5633.77,-3708.7 5926.77,-3655.7 6219.77,-3708.7 5926.77,-3761.7"/>
<text text-anchor="middle" x="5926.77" y="-3720" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5926.77" y="-3705" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="5926.77" y="-3690" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- comm_14&#45;&gt;residual1_15 -->
<g id="edge608" class="edge">
<title>comm_14&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6058.04,-4398C6074.2,-4380.42 6087.77,-4358.45 6087.77,-4334.25 6087.77,-4334.25 6087.77,-4334.25 6087.77,-3865.7 6087.77,-3834.63 6086.55,-3823.46 6067.77,-3798.7 6054.05,-3780.62 6035.52,-3765.27 6016.39,-3752.67"/>
<polygon fill="black" stroke="black" points="6018.2,-3749.67 6007.88,-3747.25 6014.44,-3755.57 6018.2,-3749.67"/>
<text text-anchor="middle" x="6116.77" y="-4104.55" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_15 -->
<g id="node479" class="node">
<title>qkv_proj_15</title>
<polygon fill="lightyellow" stroke="black" points="6059.31,-4269.75 5576.45,-4269.75 5452.23,-4133.75 5935.09,-4133.75 6059.31,-4269.75"/>
<text text-anchor="middle" x="5755.77" y="-4220.55" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5755.77" y="-4205.55" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="5755.77" y="-4190.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="5755.77" y="-4175.55" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_15&#45;&gt;qkv_proj_15 -->
<g id="edge604" class="edge">
<title>ln1_15&#45;&gt;qkv_proj_15</title>
<path fill="none" stroke="black" d="M5895.39,-4306.66C5883.27,-4297.64 5868.98,-4287 5854.23,-4276.03"/>
<polygon fill="black" stroke="black" points="5856.12,-4273.07 5846,-4269.9 5851.94,-4278.68 5856.12,-4273.07"/>
</g>
<!-- mha_15 -->
<g id="node480" class="node">
<title>mha_15</title>
<polygon fill="lightyellow" stroke="black" points="6002.24,-4027.22 5882.5,-4082.77 5643.04,-4082.77 5523.3,-4027.22 5643.04,-3971.68 5882.5,-3971.68 6002.24,-4027.22"/>
<text text-anchor="middle" x="5762.77" y="-4046.02" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5762.77" y="-4031.02" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="5762.77" y="-4016.02" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5762.77" y="-4001.02" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- qkv_proj_15&#45;&gt;mha_15 -->
<g id="edge605" class="edge">
<title>qkv_proj_15&#45;&gt;mha_15</title>
<path fill="none" stroke="black" d="M5758.5,-4133.55C5759.03,-4120.34 5759.59,-4106.49 5760.13,-4093.35"/>
<polygon fill="black" stroke="black" points="5763.64,-4093.12 5760.55,-4082.98 5756.64,-4092.83 5763.64,-4093.12"/>
</g>
<!-- out_proj_15 -->
<g id="node481" class="node">
<title>out_proj_15</title>
<polygon fill="lightyellow" stroke="black" points="6059.14,-3934.7 5590.86,-3934.7 5470.39,-3798.7 5938.68,-3798.7 6059.14,-3934.7"/>
<text text-anchor="middle" x="5764.77" y="-3885.5" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="5764.77" y="-3870.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5764.77" y="-3855.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="5764.77" y="-3840.5" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_15&#45;&gt;out_proj_15 -->
<g id="edge606" class="edge">
<title>mha_15&#45;&gt;out_proj_15</title>
<path fill="none" stroke="black" d="M5763.46,-3971.67C5763.57,-3963.08 5763.68,-3954.06 5763.79,-3945.07"/>
<polygon fill="black" stroke="black" points="5767.29,-3945.01 5763.92,-3934.97 5760.29,-3944.92 5767.29,-3945.01"/>
</g>
<!-- out_proj_15&#45;&gt;residual1_15 -->
<g id="edge607" class="edge">
<title>out_proj_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M5834.41,-3798.64C5847.6,-3785.94 5861.2,-3772.84 5873.78,-3760.73"/>
<polygon fill="black" stroke="black" points="5876.27,-3763.19 5881.05,-3753.73 5871.42,-3758.14 5876.27,-3763.19"/>
</g>
<!-- ln2_15 -->
<g id="node483" class="node">
<title>ln2_15</title>
<polygon fill="lightyellow" stroke="black" points="4341.77,-3618.7 4197.77,-3618.7 4197.77,-3565.7 4341.77,-3565.7 4341.77,-3618.7"/>
<text text-anchor="middle" x="4269.77" y="-3603.5" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="4269.77" y="-3588.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="4269.77" y="-3573.5" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge609" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M5718.59,-3693.32C5350.58,-3667.89 4600.51,-3616.06 4351.88,-3598.88"/>
<polygon fill="black" stroke="black" points="4352.05,-3595.38 4341.83,-3598.18 4351.57,-3602.36 4352.05,-3595.38"/>
</g>
<!-- residual2_15 -->
<g id="node510" class="node">
<title>residual2_15</title>
<polygon fill="lightyellow" stroke="black" points="4960.77,-2423.41 4667.77,-2370.41 4960.77,-2317.41 5253.77,-2370.41 4960.77,-2423.41"/>
<text text-anchor="middle" x="4960.77" y="-2381.71" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="4960.77" y="-2366.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="4960.77" y="-2351.71" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- residual1_15&#45;&gt;residual2_15 -->
<g id="edge644" class="edge">
<title>residual1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6012.43,-3671C6041.03,-3652.62 6065.77,-3626.97 6065.77,-3593.2 6065.77,-3593.2 6065.77,-3593.2 6065.77,-2679.08 6065.77,-2496.24 5497.21,-2417.4 5175.76,-2387.44"/>
<polygon fill="black" stroke="black" points="5175.65,-2383.92 5165.38,-2386.48 5175.01,-2390.89 5175.65,-2383.92"/>
<text text-anchor="middle" x="6094.77" y="-3206.5" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_15 -->
<g id="node484" class="node">
<title>gate_15</title>
<polygon fill="lightyellow" stroke="black" points="4005.86,-3528.7 3705.68,-3528.7 3598.77,-3422.7 4112.77,-3422.7 4005.86,-3528.7"/>
<text text-anchor="middle" x="3855.77" y="-3487" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="3855.77" y="-3472" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="3855.77" y="-3457" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- ln2_15&#45;&gt;gate_15 -->
<g id="edge610" class="edge">
<title>ln2_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M4197.66,-3571.26C4149.72,-3558 4084.68,-3540.01 4024.2,-3523.29"/>
<polygon fill="black" stroke="black" points="4025.11,-3519.91 4014.54,-3520.61 4023.24,-3526.65 4025.11,-3519.91"/>
</g>
<!-- expert0_fc1_15 -->
<g id="node485" class="node">
<title>expert0_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="1655.31,-3371.7 1172.45,-3371.7 1048.23,-3235.7 1531.09,-3235.7 1655.31,-3371.7"/>
<text text-anchor="middle" x="1351.77" y="-3322.5" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="1351.77" y="-3307.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1351.77" y="-3292.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="1351.77" y="-3277.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_15&#45;&gt;expert0_fc1_15 -->
<g id="edge611" class="edge">
<title>gate_15&#45;&gt;expert0_fc1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3645.31,-3469.21C3173.6,-3456.2 2043.47,-3420.82 1664.77,-3371.7 1664.66,-3371.69 1664.55,-3371.67 1664.45,-3371.66"/>
<polygon fill="black" stroke="black" points="1664.76,-3368.17 1654.38,-3370.31 1663.83,-3375.11 1664.76,-3368.17"/>
<text text-anchor="middle" x="2073.27" y="-3393.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_15 -->
<g id="node488" class="node">
<title>expert1_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="2281.31,-3371.7 1798.45,-3371.7 1674.23,-3235.7 2157.09,-3235.7 2281.31,-3371.7"/>
<text text-anchor="middle" x="1977.77" y="-3322.5" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="1977.77" y="-3307.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1977.77" y="-3292.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="1977.77" y="-3277.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_15&#45;&gt;expert1_fc1_15 -->
<g id="edge615" class="edge">
<title>gate_15&#45;&gt;expert1_fc1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3646.89,-3470.58C3345.91,-3462.46 2773.34,-3438.87 2290.77,-3371.7 2290.55,-3371.67 2290.32,-3371.64 2290.1,-3371.61"/>
<polygon fill="black" stroke="black" points="2290.37,-3368.11 2279.98,-3370.16 2289.38,-3375.04 2290.37,-3368.11"/>
<text text-anchor="middle" x="2591.27" y="-3393.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_15 -->
<g id="node491" class="node">
<title>expert2_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="2907.31,-3371.7 2424.45,-3371.7 2300.23,-3235.7 2783.09,-3235.7 2907.31,-3371.7"/>
<text text-anchor="middle" x="2603.77" y="-3322.5" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="2603.77" y="-3307.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="2603.77" y="-3292.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="2603.77" y="-3277.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_15&#45;&gt;expert2_fc1_15 -->
<g id="edge619" class="edge">
<title>gate_15&#45;&gt;expert2_fc1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3632.93,-3456.68C3442.13,-3439.72 3160.43,-3411.04 2916.77,-3371.7 2916.55,-3371.67 2916.32,-3371.63 2916.1,-3371.59"/>
<polygon fill="black" stroke="black" points="2916.45,-3368.1 2906.01,-3369.93 2915.31,-3375.01 2916.45,-3368.1"/>
<text text-anchor="middle" x="3167.27" y="-3393.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_15 -->
<g id="node494" class="node">
<title>expert3_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="3533.31,-3371.7 3050.45,-3371.7 2926.23,-3235.7 3409.09,-3235.7 3533.31,-3371.7"/>
<text text-anchor="middle" x="3229.77" y="-3322.5" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="3229.77" y="-3307.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="3229.77" y="-3292.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3229.77" y="-3277.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_15&#45;&gt;expert3_fc1_15 -->
<g id="edge623" class="edge">
<title>gate_15&#45;&gt;expert3_fc1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3664.12,-3422.66C3608.1,-3407.45 3545.95,-3390.57 3486.59,-3374.45"/>
<polygon fill="black" stroke="black" points="3487.27,-3371 3476.7,-3371.76 3485.43,-3377.76 3487.27,-3371"/>
<text text-anchor="middle" x="3626.27" y="-3393.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_15 -->
<g id="node497" class="node">
<title>expert4_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="4159.31,-3371.7 3676.45,-3371.7 3552.23,-3235.7 4035.09,-3235.7 4159.31,-3371.7"/>
<text text-anchor="middle" x="3855.77" y="-3322.5" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="3855.77" y="-3307.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="3855.77" y="-3292.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3855.77" y="-3277.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_15&#45;&gt;expert4_fc1_15 -->
<g id="edge627" class="edge">
<title>gate_15&#45;&gt;expert4_fc1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3855.77,-3422.31C3855.77,-3409.64 3855.77,-3395.83 3855.77,-3382.27"/>
<polygon fill="black" stroke="black" points="3859.27,-3381.97 3855.77,-3371.97 3852.27,-3381.97 3859.27,-3381.97"/>
<text text-anchor="middle" x="3901.27" y="-3393.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_15 -->
<g id="node500" class="node">
<title>expert5_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="4785.31,-3371.7 4302.45,-3371.7 4178.23,-3235.7 4661.09,-3235.7 4785.31,-3371.7"/>
<text text-anchor="middle" x="4481.77" y="-3322.5" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="4481.77" y="-3307.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="4481.77" y="-3292.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4481.77" y="-3277.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_15&#45;&gt;expert5_fc1_15 -->
<g id="edge631" class="edge">
<title>gate_15&#45;&gt;expert5_fc1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4047.42,-3422.66C4120.78,-3402.73 4204.67,-3379.95 4279.04,-3359.76"/>
<polygon fill="black" stroke="black" points="4280.27,-3363.05 4289,-3357.05 4278.43,-3356.3 4280.27,-3363.05"/>
<text text-anchor="middle" x="4214.27" y="-3393.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_15 -->
<g id="node503" class="node">
<title>expert6_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="5411.31,-3371.7 4928.45,-3371.7 4804.23,-3235.7 5287.09,-3235.7 5411.31,-3371.7"/>
<text text-anchor="middle" x="5107.77" y="-3322.5" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="5107.77" y="-3307.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5107.77" y="-3292.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="5107.77" y="-3277.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_15&#45;&gt;expert6_fc1_15 -->
<g id="edge635" class="edge">
<title>gate_15&#45;&gt;expert6_fc1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4078.6,-3456.68C4269.4,-3439.72 4551.11,-3411.04 4794.77,-3371.7 4828.47,-3366.26 4864.03,-3359.57 4898.6,-3352.55"/>
<polygon fill="black" stroke="black" points="4899.71,-3355.89 4908.81,-3350.46 4898.31,-3349.04 4899.71,-3355.89"/>
<text text-anchor="middle" x="4713.27" y="-3393.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_15 -->
<g id="node506" class="node">
<title>expert7_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="6037.31,-3371.7 5554.45,-3371.7 5430.23,-3235.7 5913.09,-3235.7 6037.31,-3371.7"/>
<text text-anchor="middle" x="5733.77" y="-3322.5" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="5733.77" y="-3307.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="5733.77" y="-3292.5" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="5733.77" y="-3277.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_15&#45;&gt;expert7_fc1_15 -->
<g id="edge639" class="edge">
<title>gate_15&#45;&gt;expert7_fc1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4064.65,-3470.58C4365.63,-3462.46 4938.19,-3438.87 5420.77,-3371.7 5454.98,-3366.94 5491.03,-3360.54 5526.01,-3353.58"/>
<polygon fill="black" stroke="black" points="5526.73,-3357.01 5535.84,-3351.6 5525.35,-3350.14 5526.73,-3357.01"/>
<text text-anchor="middle" x="5298.27" y="-3393.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_15 -->
<g id="node486" class="node">
<title>expert0_gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="1351.77" cy="-3147.23" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1351.77" y="-3158.53" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="1351.77" y="-3143.53" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1351.77" y="-3128.53" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert0_fc1_15&#45;&gt;expert0_gelu_15 -->
<g id="edge612" class="edge">
<title>expert0_fc1_15&#45;&gt;expert0_gelu_15</title>
<path fill="none" stroke="black" d="M1351.77,-3235.4C1351.77,-3221.8 1351.77,-3207.79 1351.77,-3195.09"/>
<polygon fill="black" stroke="black" points="1355.27,-3194.76 1351.77,-3184.76 1348.27,-3194.76 1355.27,-3194.76"/>
</g>
<!-- expert0_fc2_15 -->
<g id="node487" class="node">
<title>expert0_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="1655.31,-3072.75 1172.45,-3072.75 1048.23,-2936.75 1531.09,-2936.75 1655.31,-3072.75"/>
<text text-anchor="middle" x="1351.77" y="-3023.55" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="1351.77" y="-3008.55" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1351.77" y="-2993.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="1351.77" y="-2978.55" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_15&#45;&gt;expert0_fc2_15 -->
<g id="edge613" class="edge">
<title>expert0_gelu_15&#45;&gt;expert0_fc2_15</title>
<path fill="none" stroke="black" d="M1351.77,-3109.68C1351.77,-3101.39 1351.77,-3092.27 1351.77,-3082.98"/>
<polygon fill="black" stroke="black" points="1355.27,-3082.87 1351.77,-3072.87 1348.27,-3082.87 1355.27,-3082.87"/>
</g>
<!-- expert_agg_15 -->
<g id="node509" class="node">
<title>expert_agg_15</title>
<ellipse fill="lightyellow" stroke="black" cx="3855.77" cy="-2680.08" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="3855.77" cy="-2680.08" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="3855.77" y="-2691.38" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3855.77" y="-2676.38" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="3855.77" y="-2661.38" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert0_fc2_15&#45;&gt;expert_agg_15 -->
<g id="edge614" class="edge">
<title>expert0_fc2_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1550.76,-2958.2C1588.5,-2950.4 1627.76,-2942.86 1664.77,-2936.75 2376.32,-2819.35 3226.61,-2736.32 3626.5,-2700.63"/>
<polygon fill="black" stroke="black" points="3627.08,-2704.09 3636.73,-2699.72 3626.46,-2697.12 3627.08,-2704.09"/>
</g>
<!-- expert1_gelu_15 -->
<g id="node489" class="node">
<title>expert1_gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="1977.77" cy="-3147.23" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1977.77" y="-3158.53" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="1977.77" y="-3143.53" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1977.77" y="-3128.53" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert1_fc1_15&#45;&gt;expert1_gelu_15 -->
<g id="edge616" class="edge">
<title>expert1_fc1_15&#45;&gt;expert1_gelu_15</title>
<path fill="none" stroke="black" d="M1977.77,-3235.4C1977.77,-3221.8 1977.77,-3207.79 1977.77,-3195.09"/>
<polygon fill="black" stroke="black" points="1981.27,-3194.76 1977.77,-3184.76 1974.27,-3194.76 1981.27,-3194.76"/>
</g>
<!-- expert1_fc2_15 -->
<g id="node490" class="node">
<title>expert1_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="2281.31,-3072.75 1798.45,-3072.75 1674.23,-2936.75 2157.09,-2936.75 2281.31,-3072.75"/>
<text text-anchor="middle" x="1977.77" y="-3023.55" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="1977.77" y="-3008.55" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1977.77" y="-2993.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="1977.77" y="-2978.55" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_15&#45;&gt;expert1_fc2_15 -->
<g id="edge617" class="edge">
<title>expert1_gelu_15&#45;&gt;expert1_fc2_15</title>
<path fill="none" stroke="black" d="M1977.77,-3109.68C1977.77,-3101.39 1977.77,-3092.27 1977.77,-3082.98"/>
<polygon fill="black" stroke="black" points="1981.27,-3082.87 1977.77,-3072.87 1974.27,-3082.87 1981.27,-3082.87"/>
</g>
<!-- expert1_fc2_15&#45;&gt;expert_agg_15 -->
<g id="edge618" class="edge">
<title>expert1_fc2_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M2177.84,-2959.4C2215.31,-2951.53 2254.18,-2943.65 2290.77,-2936.75 2764.74,-2847.36 3322.95,-2760.58 3628.11,-2714.7"/>
<polygon fill="black" stroke="black" points="3629.04,-2718.1 3638.41,-2713.15 3628,-2711.18 3629.04,-2718.1"/>
</g>
<!-- expert2_gelu_15 -->
<g id="node492" class="node">
<title>expert2_gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="2603.77" cy="-3147.23" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="2603.77" y="-3158.53" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="2603.77" y="-3143.53" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="2603.77" y="-3128.53" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert2_fc1_15&#45;&gt;expert2_gelu_15 -->
<g id="edge620" class="edge">
<title>expert2_fc1_15&#45;&gt;expert2_gelu_15</title>
<path fill="none" stroke="black" d="M2603.77,-3235.4C2603.77,-3221.8 2603.77,-3207.79 2603.77,-3195.09"/>
<polygon fill="black" stroke="black" points="2607.27,-3194.76 2603.77,-3184.76 2600.27,-3194.76 2607.27,-3194.76"/>
</g>
<!-- expert2_fc2_15 -->
<g id="node493" class="node">
<title>expert2_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="2907.31,-3072.75 2424.45,-3072.75 2300.23,-2936.75 2783.09,-2936.75 2907.31,-3072.75"/>
<text text-anchor="middle" x="2603.77" y="-3023.55" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="2603.77" y="-3008.55" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2603.77" y="-2993.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="2603.77" y="-2978.55" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_15&#45;&gt;expert2_fc2_15 -->
<g id="edge621" class="edge">
<title>expert2_gelu_15&#45;&gt;expert2_fc2_15</title>
<path fill="none" stroke="black" d="M2603.77,-3109.68C2603.77,-3101.39 2603.77,-3092.27 2603.77,-3082.98"/>
<polygon fill="black" stroke="black" points="2607.27,-3082.87 2603.77,-3072.87 2600.27,-3082.87 2607.27,-3082.87"/>
</g>
<!-- expert2_fc2_15&#45;&gt;expert_agg_15 -->
<g id="edge622" class="edge">
<title>expert2_fc2_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M2798.71,-2953.51C3024.7,-2895.27 3396.4,-2799.47 3633.45,-2738.38"/>
<polygon fill="black" stroke="black" points="3634.42,-2741.74 3643.23,-2735.86 3632.67,-2734.97 3634.42,-2741.74"/>
</g>
<!-- expert3_gelu_15 -->
<g id="node495" class="node">
<title>expert3_gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="3229.77" cy="-3147.23" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="3229.77" y="-3158.53" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="3229.77" y="-3143.53" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="3229.77" y="-3128.53" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert3_fc1_15&#45;&gt;expert3_gelu_15 -->
<g id="edge624" class="edge">
<title>expert3_fc1_15&#45;&gt;expert3_gelu_15</title>
<path fill="none" stroke="black" d="M3229.77,-3235.4C3229.77,-3221.8 3229.77,-3207.79 3229.77,-3195.09"/>
<polygon fill="black" stroke="black" points="3233.27,-3194.76 3229.77,-3184.76 3226.27,-3194.76 3233.27,-3194.76"/>
</g>
<!-- expert3_fc2_15 -->
<g id="node496" class="node">
<title>expert3_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="3533.31,-3072.75 3050.45,-3072.75 2926.23,-2936.75 3409.09,-2936.75 3533.31,-3072.75"/>
<text text-anchor="middle" x="3229.77" y="-3023.55" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="3229.77" y="-3008.55" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="3229.77" y="-2993.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3229.77" y="-2978.55" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_15&#45;&gt;expert3_fc2_15 -->
<g id="edge625" class="edge">
<title>expert3_gelu_15&#45;&gt;expert3_fc2_15</title>
<path fill="none" stroke="black" d="M3229.77,-3109.68C3229.77,-3101.39 3229.77,-3092.27 3229.77,-3082.98"/>
<polygon fill="black" stroke="black" points="3233.27,-3082.87 3229.77,-3072.87 3226.27,-3082.87 3233.27,-3082.87"/>
</g>
<!-- expert3_fc2_15&#45;&gt;expert_agg_15 -->
<g id="edge626" class="edge">
<title>expert3_fc2_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M3359.86,-2936.7C3444.18,-2893.23 3555.8,-2835.7 3651.78,-2786.23"/>
<polygon fill="black" stroke="black" points="3653.44,-2789.31 3660.72,-2781.62 3650.23,-2783.09 3653.44,-2789.31"/>
</g>
<!-- expert4_gelu_15 -->
<g id="node498" class="node">
<title>expert4_gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="3855.77" cy="-3147.23" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="3855.77" y="-3158.53" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="3855.77" y="-3143.53" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="3855.77" y="-3128.53" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert4_fc1_15&#45;&gt;expert4_gelu_15 -->
<g id="edge628" class="edge">
<title>expert4_fc1_15&#45;&gt;expert4_gelu_15</title>
<path fill="none" stroke="black" d="M3855.77,-3235.4C3855.77,-3221.8 3855.77,-3207.79 3855.77,-3195.09"/>
<polygon fill="black" stroke="black" points="3859.27,-3194.76 3855.77,-3184.76 3852.27,-3194.76 3859.27,-3194.76"/>
</g>
<!-- expert4_fc2_15 -->
<g id="node499" class="node">
<title>expert4_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="4159.31,-3072.75 3676.45,-3072.75 3552.23,-2936.75 4035.09,-2936.75 4159.31,-3072.75"/>
<text text-anchor="middle" x="3855.77" y="-3023.55" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="3855.77" y="-3008.55" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="3855.77" y="-2993.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="3855.77" y="-2978.55" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_15&#45;&gt;expert4_fc2_15 -->
<g id="edge629" class="edge">
<title>expert4_gelu_15&#45;&gt;expert4_fc2_15</title>
<path fill="none" stroke="black" d="M3855.77,-3109.68C3855.77,-3101.39 3855.77,-3092.27 3855.77,-3082.98"/>
<polygon fill="black" stroke="black" points="3859.27,-3082.87 3855.77,-3072.87 3852.27,-3082.87 3859.27,-3082.87"/>
</g>
<!-- expert4_fc2_15&#45;&gt;expert_agg_15 -->
<g id="edge630" class="edge">
<title>expert4_fc2_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M3855.77,-2936.5C3855.77,-2928.16 3855.77,-2919.3 3855.77,-2910.08"/>
<polygon fill="black" stroke="black" points="3859.27,-2909.95 3855.77,-2899.95 3852.27,-2909.95 3859.27,-2909.95"/>
</g>
<!-- expert5_gelu_15 -->
<g id="node501" class="node">
<title>expert5_gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="4481.77" cy="-3147.23" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="4481.77" y="-3158.53" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="4481.77" y="-3143.53" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="4481.77" y="-3128.53" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert5_fc1_15&#45;&gt;expert5_gelu_15 -->
<g id="edge632" class="edge">
<title>expert5_fc1_15&#45;&gt;expert5_gelu_15</title>
<path fill="none" stroke="black" d="M4481.77,-3235.4C4481.77,-3221.8 4481.77,-3207.79 4481.77,-3195.09"/>
<polygon fill="black" stroke="black" points="4485.27,-3194.76 4481.77,-3184.76 4478.27,-3194.76 4485.27,-3194.76"/>
</g>
<!-- expert5_fc2_15 -->
<g id="node502" class="node">
<title>expert5_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="4785.31,-3072.75 4302.45,-3072.75 4178.23,-2936.75 4661.09,-2936.75 4785.31,-3072.75"/>
<text text-anchor="middle" x="4481.77" y="-3023.55" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="4481.77" y="-3008.55" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4481.77" y="-2993.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="4481.77" y="-2978.55" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_15&#45;&gt;expert5_fc2_15 -->
<g id="edge633" class="edge">
<title>expert5_gelu_15&#45;&gt;expert5_fc2_15</title>
<path fill="none" stroke="black" d="M4481.77,-3109.68C4481.77,-3101.39 4481.77,-3092.27 4481.77,-3082.98"/>
<polygon fill="black" stroke="black" points="4485.27,-3082.87 4481.77,-3072.87 4478.27,-3082.87 4485.27,-3082.87"/>
</g>
<!-- expert5_fc2_15&#45;&gt;expert_agg_15 -->
<g id="edge634" class="edge">
<title>expert5_fc2_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M4351.68,-2936.7C4267.35,-2893.23 4155.74,-2835.7 4059.76,-2786.23"/>
<polygon fill="black" stroke="black" points="4061.31,-2783.09 4050.81,-2781.62 4058.1,-2789.31 4061.31,-2783.09"/>
</g>
<!-- expert6_gelu_15 -->
<g id="node504" class="node">
<title>expert6_gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="5107.77" cy="-3147.23" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5107.77" y="-3158.53" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="5107.77" y="-3143.53" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5107.77" y="-3128.53" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert6_fc1_15&#45;&gt;expert6_gelu_15 -->
<g id="edge636" class="edge">
<title>expert6_fc1_15&#45;&gt;expert6_gelu_15</title>
<path fill="none" stroke="black" d="M5107.77,-3235.4C5107.77,-3221.8 5107.77,-3207.79 5107.77,-3195.09"/>
<polygon fill="black" stroke="black" points="5111.27,-3194.76 5107.77,-3184.76 5104.27,-3194.76 5111.27,-3194.76"/>
</g>
<!-- expert6_fc2_15 -->
<g id="node505" class="node">
<title>expert6_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="5411.31,-3072.75 4928.45,-3072.75 4804.23,-2936.75 5287.09,-2936.75 5411.31,-3072.75"/>
<text text-anchor="middle" x="5107.77" y="-3023.55" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="5107.77" y="-3008.55" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5107.77" y="-2993.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="5107.77" y="-2978.55" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_15&#45;&gt;expert6_fc2_15 -->
<g id="edge637" class="edge">
<title>expert6_gelu_15&#45;&gt;expert6_fc2_15</title>
<path fill="none" stroke="black" d="M5107.77,-3109.68C5107.77,-3101.39 5107.77,-3092.27 5107.77,-3082.98"/>
<polygon fill="black" stroke="black" points="5111.27,-3082.87 5107.77,-3072.87 5104.27,-3082.87 5111.27,-3082.87"/>
</g>
<!-- expert6_fc2_15&#45;&gt;expert_agg_15 -->
<g id="edge638" class="edge">
<title>expert6_fc2_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M4847.59,-2936.7C4620.21,-2878.1 4293.63,-2793.93 4078.2,-2738.41"/>
<polygon fill="black" stroke="black" points="4078.9,-2734.97 4068.34,-2735.87 4077.15,-2741.75 4078.9,-2734.97"/>
</g>
<!-- expert7_gelu_15 -->
<g id="node507" class="node">
<title>expert7_gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="5733.77" cy="-3147.23" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="5733.77" y="-3158.53" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="5733.77" y="-3143.53" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="5733.77" y="-3128.53" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- expert7_fc1_15&#45;&gt;expert7_gelu_15 -->
<g id="edge640" class="edge">
<title>expert7_fc1_15&#45;&gt;expert7_gelu_15</title>
<path fill="none" stroke="black" d="M5733.77,-3235.4C5733.77,-3221.8 5733.77,-3207.79 5733.77,-3195.09"/>
<polygon fill="black" stroke="black" points="5737.27,-3194.76 5733.77,-3184.76 5730.27,-3194.76 5737.27,-3194.76"/>
</g>
<!-- expert7_fc2_15 -->
<g id="node508" class="node">
<title>expert7_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="6037.31,-3072.75 5554.45,-3072.75 5430.23,-2936.75 5913.09,-2936.75 6037.31,-3072.75"/>
<text text-anchor="middle" x="5733.77" y="-3023.55" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="5733.77" y="-3008.55" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="5733.77" y="-2993.55" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="5733.77" y="-2978.55" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_15&#45;&gt;expert7_fc2_15 -->
<g id="edge641" class="edge">
<title>expert7_gelu_15&#45;&gt;expert7_fc2_15</title>
<path fill="none" stroke="black" d="M5733.77,-3109.68C5733.77,-3101.39 5733.77,-3092.27 5733.77,-3082.98"/>
<polygon fill="black" stroke="black" points="5737.27,-3082.87 5733.77,-3072.87 5730.27,-3082.87 5737.27,-3082.87"/>
</g>
<!-- expert7_fc2_15&#45;&gt;expert_agg_15 -->
<g id="edge642" class="edge">
<title>expert7_fc2_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M5431.89,-2938.86C5428.16,-2938.15 5424.45,-2937.44 5420.77,-2936.75 4946.8,-2847.36 4388.59,-2760.58 4083.43,-2714.7"/>
<polygon fill="black" stroke="black" points="4083.54,-2711.18 4073.13,-2713.15 4082.5,-2718.1 4083.54,-2711.18"/>
</g>
<!-- expert_agg_15&#45;&gt;residual2_15 -->
<g id="edge643" class="edge">
<title>expert_agg_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M4067.19,-2620.22C4295.4,-2556.67 4651.14,-2457.63 4837.47,-2405.75"/>
<polygon fill="black" stroke="black" points="4838.61,-2409.06 4847.3,-2403.01 4836.73,-2402.32 4838.61,-2409.06"/>
</g>
<!-- comm_15 -->
<g id="node511" class="node">
<title>comm_15</title>
<polygon fill="yellow" stroke="black" points="5078.51,-2219.02 5078.51,-2252.68 5009.54,-2276.47 4912,-2276.47 4843.03,-2252.68 4843.03,-2219.02 4912,-2195.23 5009.54,-2195.23 5078.51,-2219.02"/>
<polygon fill="none" stroke="black" points="5082.5,-2216.17 5082.5,-2255.53 5010.21,-2280.48 4911.33,-2280.48 4839.04,-2255.53 4839.04,-2216.17 4911.33,-2191.22 5010.21,-2191.22 5082.5,-2216.17"/>
<text text-anchor="middle" x="4960.77" y="-2247.15" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="4960.77" y="-2232.15" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="4960.77" y="-2217.15" font-family="Times,serif" font-size="14.00">GPU14→GPU15</text>
</g>
<!-- residual2_15&#45;&gt;comm_15 -->
<g id="edge645" class="edge">
<title>residual2_15&#45;&gt;comm_15</title>
<path fill="none" stroke="black" d="M4960.77,-2317.4C4960.77,-2308.64 4960.77,-2299.54 4960.77,-2290.73"/>
<polygon fill="black" stroke="black" points="4964.27,-2290.57 4960.77,-2280.57 4957.27,-2290.57 4964.27,-2290.57"/>
</g>
<!-- ln1_16 -->
<g id="node512" class="node">
<title>ln1_16</title>
<polygon fill="lightpink" stroke="black" points="4953.77,-2154.29 4809.77,-2154.29 4809.77,-2101.29 4953.77,-2101.29 4953.77,-2154.29"/>
<text text-anchor="middle" x="4881.77" y="-2139.09" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4881.77" y="-2124.09" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="4881.77" y="-2109.09" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- comm_15&#45;&gt;ln1_16 -->
<g id="edge646" class="edge">
<title>comm_15&#45;&gt;ln1_16</title>
<path fill="none" stroke="black" d="M4928.18,-2191.1C4921.09,-2181.57 4913.69,-2171.64 4906.93,-2162.57"/>
<polygon fill="black" stroke="black" points="4909.72,-2160.45 4900.94,-2154.52 4904.1,-2164.63 4909.72,-2160.45"/>
</g>
<!-- residual1_16 -->
<g id="node516" class="node">
<title>residual1_16</title>
<polygon fill="lightpink" stroke="black" points="4878.77,-1556.24 4585.77,-1503.24 4878.77,-1450.24 5171.77,-1503.24 4878.77,-1556.24"/>
<text text-anchor="middle" x="4878.77" y="-1514.54" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="4878.77" y="-1499.54" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="4878.77" y="-1484.54" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- comm_15&#45;&gt;residual1_16 -->
<g id="edge651" class="edge">
<title>comm_15&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5011.92,-2191.56C5027.1,-2174.01 5039.77,-2152.32 5039.77,-2128.79 5039.77,-2128.79 5039.77,-2128.79 5039.77,-1660.24 5039.77,-1629.17 5038.55,-1618 5019.77,-1593.24 5006.05,-1575.16 4987.52,-1559.81 4968.39,-1547.21"/>
<polygon fill="black" stroke="black" points="4970.2,-1544.2 4959.88,-1541.79 4966.44,-1550.11 4970.2,-1544.2"/>
<text text-anchor="middle" x="5068.77" y="-1899.09" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_16 -->
<g id="node513" class="node">
<title>qkv_proj_16</title>
<polygon fill="lightpink" stroke="black" points="5011.31,-2064.29 4528.45,-2064.29 4404.23,-1928.29 4887.09,-1928.29 5011.31,-2064.29"/>
<text text-anchor="middle" x="4707.77" y="-2015.09" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4707.77" y="-2000.09" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="4707.77" y="-1985.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4707.77" y="-1970.09" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_16&#45;&gt;qkv_proj_16 -->
<g id="edge647" class="edge">
<title>ln1_16&#45;&gt;qkv_proj_16</title>
<path fill="none" stroke="black" d="M4847.39,-2101.2C4835.27,-2092.18 4820.98,-2081.54 4806.23,-2070.57"/>
<polygon fill="black" stroke="black" points="4808.12,-2067.61 4798,-2064.44 4803.94,-2073.22 4808.12,-2067.61"/>
</g>
<!-- mha_16 -->
<g id="node514" class="node">
<title>mha_16</title>
<polygon fill="lightpink" stroke="black" points="4954.24,-1821.76 4834.5,-1877.31 4595.04,-1877.31 4475.3,-1821.76 4595.04,-1766.22 4834.5,-1766.22 4954.24,-1821.76"/>
<text text-anchor="middle" x="4714.77" y="-1840.56" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4714.77" y="-1825.56" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="4714.77" y="-1810.56" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4714.77" y="-1795.56" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- qkv_proj_16&#45;&gt;mha_16 -->
<g id="edge648" class="edge">
<title>qkv_proj_16&#45;&gt;mha_16</title>
<path fill="none" stroke="black" d="M4710.5,-1928.09C4711.03,-1914.88 4711.59,-1901.03 4712.13,-1887.89"/>
<polygon fill="black" stroke="black" points="4715.64,-1887.66 4712.55,-1877.52 4708.64,-1887.37 4715.64,-1887.66"/>
</g>
<!-- out_proj_16 -->
<g id="node515" class="node">
<title>out_proj_16</title>
<polygon fill="lightpink" stroke="black" points="5011.14,-1729.24 4542.86,-1729.24 4422.39,-1593.24 4890.68,-1593.24 5011.14,-1729.24"/>
<text text-anchor="middle" x="4716.77" y="-1680.04" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4716.77" y="-1665.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4716.77" y="-1650.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4716.77" y="-1635.04" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_16&#45;&gt;out_proj_16 -->
<g id="edge649" class="edge">
<title>mha_16&#45;&gt;out_proj_16</title>
<path fill="none" stroke="black" d="M4715.46,-1766.21C4715.57,-1757.62 4715.68,-1748.6 4715.79,-1739.61"/>
<polygon fill="black" stroke="black" points="4719.29,-1739.55 4715.92,-1729.51 4712.29,-1739.46 4719.29,-1739.55"/>
</g>
<!-- out_proj_16&#45;&gt;residual1_16 -->
<g id="edge650" class="edge">
<title>out_proj_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M4786.41,-1593.18C4799.6,-1580.48 4813.2,-1567.38 4825.78,-1555.27"/>
<polygon fill="black" stroke="black" points="4828.27,-1557.73 4833.05,-1548.27 4823.42,-1552.68 4828.27,-1557.73"/>
</g>
<!-- ln2_16 -->
<g id="node517" class="node">
<title>ln2_16</title>
<polygon fill="lightpink" stroke="black" points="3293.77,-1413.24 3149.77,-1413.24 3149.77,-1360.24 3293.77,-1360.24 3293.77,-1413.24"/>
<text text-anchor="middle" x="3221.77" y="-1398.04" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3221.77" y="-1383.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="3221.77" y="-1368.04" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- residual1_16&#45;&gt;ln2_16 -->
<g id="edge652" class="edge">
<title>residual1_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M4670.59,-1487.86C4302.58,-1462.43 3552.51,-1410.6 3303.88,-1393.42"/>
<polygon fill="black" stroke="black" points="3304.05,-1389.92 3293.83,-1392.72 3303.57,-1396.9 3304.05,-1389.92"/>
</g>
<!-- residual2_16 -->
<g id="node544" class="node">
<title>residual2_16</title>
<polygon fill="lightpink" stroke="black" points="3912.77,-217.95 3619.77,-164.95 3912.77,-111.95 4205.77,-164.95 3912.77,-217.95"/>
<text text-anchor="middle" x="3912.77" y="-176.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="3912.77" y="-161.25" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="3912.77" y="-146.25" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- residual1_16&#45;&gt;residual2_16 -->
<g id="edge687" class="edge">
<title>residual1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4964.43,-1465.54C4993.03,-1447.16 5017.77,-1421.51 5017.77,-1387.74 5017.77,-1387.74 5017.77,-1387.74 5017.77,-473.62 5017.77,-290.78 4449.21,-211.94 4127.76,-181.98"/>
<polygon fill="black" stroke="black" points="4127.65,-178.45 4117.38,-181.02 4127.01,-185.42 4127.65,-178.45"/>
<text text-anchor="middle" x="5046.77" y="-1001.04" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- gate_16 -->
<g id="node518" class="node">
<title>gate_16</title>
<polygon fill="lightpink" stroke="black" points="2957.86,-1323.24 2657.68,-1323.24 2550.77,-1217.24 3064.77,-1217.24 2957.86,-1323.24"/>
<text text-anchor="middle" x="2807.77" y="-1281.54" font-family="Times,serif" font-size="14.00">Gate Network</text>
<text text-anchor="middle" x="2807.77" y="-1266.54" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8]</text>
<text text-anchor="middle" x="2807.77" y="-1251.54" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- ln2_16&#45;&gt;gate_16 -->
<g id="edge653" class="edge">
<title>ln2_16&#45;&gt;gate_16</title>
<path fill="none" stroke="black" d="M3149.66,-1365.8C3101.72,-1352.54 3036.68,-1334.55 2976.2,-1317.83"/>
<polygon fill="black" stroke="black" points="2977.11,-1314.44 2966.54,-1315.15 2975.24,-1321.19 2977.11,-1314.44"/>
</g>
<!-- expert0_fc1_16 -->
<g id="node519" class="node">
<title>expert0_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="607.31,-1166.24 124.45,-1166.24 0.23,-1030.24 483.09,-1030.24 607.31,-1166.24"/>
<text text-anchor="middle" x="303.77" y="-1117.04" font-family="Times,serif" font-size="14.00">Expert0 FC1</text>
<text text-anchor="middle" x="303.77" y="-1102.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="303.77" y="-1087.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="303.77" y="-1072.04" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_16&#45;&gt;expert0_fc1_16 -->
<g id="edge654" class="edge">
<title>gate_16&#45;&gt;expert0_fc1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2597.31,-1263.75C2125.6,-1250.74 995.47,-1215.36 616.77,-1166.24 616.66,-1166.23 616.55,-1166.21 616.45,-1166.2"/>
<polygon fill="black" stroke="black" points="616.76,-1162.71 606.38,-1164.85 615.83,-1169.65 616.76,-1162.71"/>
<text text-anchor="middle" x="1025.27" y="-1188.04" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert1_fc1_16 -->
<g id="node522" class="node">
<title>expert1_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="1233.31,-1166.24 750.45,-1166.24 626.23,-1030.24 1109.09,-1030.24 1233.31,-1166.24"/>
<text text-anchor="middle" x="929.77" y="-1117.04" font-family="Times,serif" font-size="14.00">Expert1 FC1</text>
<text text-anchor="middle" x="929.77" y="-1102.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="929.77" y="-1087.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="929.77" y="-1072.04" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_16&#45;&gt;expert1_fc1_16 -->
<g id="edge658" class="edge">
<title>gate_16&#45;&gt;expert1_fc1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2598.89,-1265.12C2297.91,-1257 1725.34,-1233.41 1242.77,-1166.24 1242.55,-1166.21 1242.32,-1166.18 1242.1,-1166.15"/>
<polygon fill="black" stroke="black" points="1242.37,-1162.65 1231.98,-1164.7 1241.38,-1169.58 1242.37,-1162.65"/>
<text text-anchor="middle" x="1543.27" y="-1188.04" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert2_fc1_16 -->
<g id="node525" class="node">
<title>expert2_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="1859.31,-1166.24 1376.45,-1166.24 1252.23,-1030.24 1735.09,-1030.24 1859.31,-1166.24"/>
<text text-anchor="middle" x="1555.77" y="-1117.04" font-family="Times,serif" font-size="14.00">Expert2 FC1</text>
<text text-anchor="middle" x="1555.77" y="-1102.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1555.77" y="-1087.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="1555.77" y="-1072.04" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_16&#45;&gt;expert2_fc1_16 -->
<g id="edge662" class="edge">
<title>gate_16&#45;&gt;expert2_fc1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2584.93,-1251.22C2394.13,-1234.26 2112.43,-1205.58 1868.77,-1166.24 1868.55,-1166.21 1868.32,-1166.17 1868.1,-1166.13"/>
<polygon fill="black" stroke="black" points="1868.45,-1162.64 1858.01,-1164.47 1867.31,-1169.55 1868.45,-1162.64"/>
<text text-anchor="middle" x="2119.27" y="-1188.04" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert3_fc1_16 -->
<g id="node528" class="node">
<title>expert3_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="2485.31,-1166.24 2002.45,-1166.24 1878.23,-1030.24 2361.09,-1030.24 2485.31,-1166.24"/>
<text text-anchor="middle" x="2181.77" y="-1117.04" font-family="Times,serif" font-size="14.00">Expert3 FC1</text>
<text text-anchor="middle" x="2181.77" y="-1102.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="2181.77" y="-1087.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="2181.77" y="-1072.04" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_16&#45;&gt;expert3_fc1_16 -->
<g id="edge666" class="edge">
<title>gate_16&#45;&gt;expert3_fc1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2616.12,-1217.2C2560.1,-1201.98 2497.95,-1185.11 2438.59,-1168.98"/>
<polygon fill="black" stroke="black" points="2439.27,-1165.54 2428.7,-1166.3 2437.43,-1172.3 2439.27,-1165.54"/>
<text text-anchor="middle" x="2578.27" y="-1188.04" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert4_fc1_16 -->
<g id="node531" class="node">
<title>expert4_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="3111.31,-1166.24 2628.45,-1166.24 2504.23,-1030.24 2987.09,-1030.24 3111.31,-1166.24"/>
<text text-anchor="middle" x="2807.77" y="-1117.04" font-family="Times,serif" font-size="14.00">Expert4 FC1</text>
<text text-anchor="middle" x="2807.77" y="-1102.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="2807.77" y="-1087.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="2807.77" y="-1072.04" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_16&#45;&gt;expert4_fc1_16 -->
<g id="edge670" class="edge">
<title>gate_16&#45;&gt;expert4_fc1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2807.77,-1216.85C2807.77,-1204.18 2807.77,-1190.37 2807.77,-1176.81"/>
<polygon fill="black" stroke="black" points="2811.27,-1176.51 2807.77,-1166.51 2804.27,-1176.51 2811.27,-1176.51"/>
<text text-anchor="middle" x="2853.27" y="-1188.04" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert5_fc1_16 -->
<g id="node534" class="node">
<title>expert5_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="3737.31,-1166.24 3254.45,-1166.24 3130.23,-1030.24 3613.09,-1030.24 3737.31,-1166.24"/>
<text text-anchor="middle" x="3433.77" y="-1117.04" font-family="Times,serif" font-size="14.00">Expert5 FC1</text>
<text text-anchor="middle" x="3433.77" y="-1102.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="3433.77" y="-1087.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="3433.77" y="-1072.04" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_16&#45;&gt;expert5_fc1_16 -->
<g id="edge674" class="edge">
<title>gate_16&#45;&gt;expert5_fc1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2999.42,-1217.2C3072.78,-1197.27 3156.67,-1174.49 3231.04,-1154.3"/>
<polygon fill="black" stroke="black" points="3232.27,-1157.59 3241,-1151.59 3230.43,-1150.83 3232.27,-1157.59"/>
<text text-anchor="middle" x="3166.27" y="-1188.04" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert6_fc1_16 -->
<g id="node537" class="node">
<title>expert6_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="4363.31,-1166.24 3880.45,-1166.24 3756.23,-1030.24 4239.09,-1030.24 4363.31,-1166.24"/>
<text text-anchor="middle" x="4059.77" y="-1117.04" font-family="Times,serif" font-size="14.00">Expert6 FC1</text>
<text text-anchor="middle" x="4059.77" y="-1102.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="4059.77" y="-1087.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4059.77" y="-1072.04" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_16&#45;&gt;expert6_fc1_16 -->
<g id="edge678" class="edge">
<title>gate_16&#45;&gt;expert6_fc1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3030.6,-1251.22C3221.4,-1234.26 3503.11,-1205.58 3746.77,-1166.24 3780.47,-1160.8 3816.03,-1154.11 3850.6,-1147.09"/>
<polygon fill="black" stroke="black" points="3851.71,-1150.43 3860.81,-1145 3850.31,-1143.58 3851.71,-1150.43"/>
<text text-anchor="middle" x="3665.27" y="-1188.04" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert7_fc1_16 -->
<g id="node540" class="node">
<title>expert7_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="4989.31,-1166.24 4506.45,-1166.24 4382.23,-1030.24 4865.09,-1030.24 4989.31,-1166.24"/>
<text text-anchor="middle" x="4685.77" y="-1117.04" font-family="Times,serif" font-size="14.00">Expert7 FC1</text>
<text text-anchor="middle" x="4685.77" y="-1102.04" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="4685.77" y="-1087.04" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4685.77" y="-1072.04" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- gate_16&#45;&gt;expert7_fc1_16 -->
<g id="edge682" class="edge">
<title>gate_16&#45;&gt;expert7_fc1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3016.65,-1265.12C3317.63,-1257 3890.19,-1233.41 4372.77,-1166.24 4406.98,-1161.48 4443.03,-1155.08 4478.01,-1148.12"/>
<polygon fill="black" stroke="black" points="4478.73,-1151.55 4487.84,-1146.14 4477.35,-1144.68 4478.73,-1151.55"/>
<text text-anchor="middle" x="4250.27" y="-1188.04" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert0_gelu_16 -->
<g id="node520" class="node">
<title>expert0_gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="303.77" cy="-941.77" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="303.77" y="-953.07" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="303.77" y="-938.07" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="303.77" y="-923.07" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert0_fc1_16&#45;&gt;expert0_gelu_16 -->
<g id="edge655" class="edge">
<title>expert0_fc1_16&#45;&gt;expert0_gelu_16</title>
<path fill="none" stroke="black" d="M303.77,-1029.94C303.77,-1016.34 303.77,-1002.33 303.77,-989.63"/>
<polygon fill="black" stroke="black" points="307.27,-989.3 303.77,-979.3 300.27,-989.3 307.27,-989.3"/>
</g>
<!-- expert0_fc2_16 -->
<g id="node521" class="node">
<title>expert0_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="607.31,-867.29 124.45,-867.29 0.23,-731.29 483.09,-731.29 607.31,-867.29"/>
<text text-anchor="middle" x="303.77" y="-818.09" font-family="Times,serif" font-size="14.00">Expert0 FC2</text>
<text text-anchor="middle" x="303.77" y="-803.09" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="303.77" y="-788.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="303.77" y="-773.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert0_gelu_16&#45;&gt;expert0_fc2_16 -->
<g id="edge656" class="edge">
<title>expert0_gelu_16&#45;&gt;expert0_fc2_16</title>
<path fill="none" stroke="black" d="M303.77,-904.22C303.77,-895.92 303.77,-886.8 303.77,-877.52"/>
<polygon fill="black" stroke="black" points="307.27,-877.41 303.77,-867.41 300.27,-877.41 307.27,-877.41"/>
</g>
<!-- expert_agg_16 -->
<g id="node543" class="node">
<title>expert_agg_16</title>
<ellipse fill="lightpink" stroke="black" cx="2807.77" cy="-474.62" rx="215.83" ry="215.83"/>
<ellipse fill="none" stroke="black" cx="2807.77" cy="-474.62" rx="219.84" ry="219.84"/>
<text text-anchor="middle" x="2807.77" y="-485.92" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2807.77" y="-470.92" font-family="Times,serif" font-size="14.00">[1024,2048,8192]×8→[1024,2048,8192]</text>
<text text-anchor="middle" x="2807.77" y="-455.92" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert0_fc2_16&#45;&gt;expert_agg_16 -->
<g id="edge657" class="edge">
<title>expert0_fc2_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M502.76,-752.74C540.5,-744.94 579.76,-737.39 616.77,-731.29 1328.32,-613.89 2178.61,-530.86 2578.5,-495.17"/>
<polygon fill="black" stroke="black" points="2579.08,-498.63 2588.73,-494.25 2578.46,-491.66 2579.08,-498.63"/>
</g>
<!-- expert1_gelu_16 -->
<g id="node523" class="node">
<title>expert1_gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="929.77" cy="-941.77" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="929.77" y="-953.07" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="929.77" y="-938.07" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="929.77" y="-923.07" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert1_fc1_16&#45;&gt;expert1_gelu_16 -->
<g id="edge659" class="edge">
<title>expert1_fc1_16&#45;&gt;expert1_gelu_16</title>
<path fill="none" stroke="black" d="M929.77,-1029.94C929.77,-1016.34 929.77,-1002.33 929.77,-989.63"/>
<polygon fill="black" stroke="black" points="933.27,-989.3 929.77,-979.3 926.27,-989.3 933.27,-989.3"/>
</g>
<!-- expert1_fc2_16 -->
<g id="node524" class="node">
<title>expert1_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="1233.31,-867.29 750.45,-867.29 626.23,-731.29 1109.09,-731.29 1233.31,-867.29"/>
<text text-anchor="middle" x="929.77" y="-818.09" font-family="Times,serif" font-size="14.00">Expert1 FC2</text>
<text text-anchor="middle" x="929.77" y="-803.09" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="929.77" y="-788.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="929.77" y="-773.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert1_gelu_16&#45;&gt;expert1_fc2_16 -->
<g id="edge660" class="edge">
<title>expert1_gelu_16&#45;&gt;expert1_fc2_16</title>
<path fill="none" stroke="black" d="M929.77,-904.22C929.77,-895.92 929.77,-886.8 929.77,-877.52"/>
<polygon fill="black" stroke="black" points="933.27,-877.41 929.77,-867.41 926.27,-877.41 933.27,-877.41"/>
</g>
<!-- expert1_fc2_16&#45;&gt;expert_agg_16 -->
<g id="edge661" class="edge">
<title>expert1_fc2_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M1129.84,-753.94C1167.31,-746.07 1206.18,-738.19 1242.77,-731.29 1716.74,-641.9 2274.95,-555.12 2580.11,-509.24"/>
<polygon fill="black" stroke="black" points="2581.04,-512.64 2590.41,-507.69 2580,-505.72 2581.04,-512.64"/>
</g>
<!-- expert2_gelu_16 -->
<g id="node526" class="node">
<title>expert2_gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="1555.77" cy="-941.77" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1555.77" y="-953.07" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="1555.77" y="-938.07" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1555.77" y="-923.07" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert2_fc1_16&#45;&gt;expert2_gelu_16 -->
<g id="edge663" class="edge">
<title>expert2_fc1_16&#45;&gt;expert2_gelu_16</title>
<path fill="none" stroke="black" d="M1555.77,-1029.94C1555.77,-1016.34 1555.77,-1002.33 1555.77,-989.63"/>
<polygon fill="black" stroke="black" points="1559.27,-989.3 1555.77,-979.3 1552.27,-989.3 1559.27,-989.3"/>
</g>
<!-- expert2_fc2_16 -->
<g id="node527" class="node">
<title>expert2_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="1859.31,-867.29 1376.45,-867.29 1252.23,-731.29 1735.09,-731.29 1859.31,-867.29"/>
<text text-anchor="middle" x="1555.77" y="-818.09" font-family="Times,serif" font-size="14.00">Expert2 FC2</text>
<text text-anchor="middle" x="1555.77" y="-803.09" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1555.77" y="-788.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="1555.77" y="-773.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert2_gelu_16&#45;&gt;expert2_fc2_16 -->
<g id="edge664" class="edge">
<title>expert2_gelu_16&#45;&gt;expert2_fc2_16</title>
<path fill="none" stroke="black" d="M1555.77,-904.22C1555.77,-895.92 1555.77,-886.8 1555.77,-877.52"/>
<polygon fill="black" stroke="black" points="1559.27,-877.41 1555.77,-867.41 1552.27,-877.41 1559.27,-877.41"/>
</g>
<!-- expert2_fc2_16&#45;&gt;expert_agg_16 -->
<g id="edge665" class="edge">
<title>expert2_fc2_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M1750.71,-748.05C1976.7,-689.81 2348.4,-594.01 2585.45,-532.92"/>
<polygon fill="black" stroke="black" points="2586.42,-536.28 2595.23,-530.4 2584.67,-529.5 2586.42,-536.28"/>
</g>
<!-- expert3_gelu_16 -->
<g id="node529" class="node">
<title>expert3_gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="2181.77" cy="-941.77" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="2181.77" y="-953.07" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="2181.77" y="-938.07" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="2181.77" y="-923.07" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert3_fc1_16&#45;&gt;expert3_gelu_16 -->
<g id="edge667" class="edge">
<title>expert3_fc1_16&#45;&gt;expert3_gelu_16</title>
<path fill="none" stroke="black" d="M2181.77,-1029.94C2181.77,-1016.34 2181.77,-1002.33 2181.77,-989.63"/>
<polygon fill="black" stroke="black" points="2185.27,-989.3 2181.77,-979.3 2178.27,-989.3 2185.27,-989.3"/>
</g>
<!-- expert3_fc2_16 -->
<g id="node530" class="node">
<title>expert3_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="2485.31,-867.29 2002.45,-867.29 1878.23,-731.29 2361.09,-731.29 2485.31,-867.29"/>
<text text-anchor="middle" x="2181.77" y="-818.09" font-family="Times,serif" font-size="14.00">Expert3 FC2</text>
<text text-anchor="middle" x="2181.77" y="-803.09" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2181.77" y="-788.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="2181.77" y="-773.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert3_gelu_16&#45;&gt;expert3_fc2_16 -->
<g id="edge668" class="edge">
<title>expert3_gelu_16&#45;&gt;expert3_fc2_16</title>
<path fill="none" stroke="black" d="M2181.77,-904.22C2181.77,-895.92 2181.77,-886.8 2181.77,-877.52"/>
<polygon fill="black" stroke="black" points="2185.27,-877.41 2181.77,-867.41 2178.27,-877.41 2185.27,-877.41"/>
</g>
<!-- expert3_fc2_16&#45;&gt;expert_agg_16 -->
<g id="edge669" class="edge">
<title>expert3_fc2_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M2311.86,-731.24C2396.18,-687.77 2507.8,-630.24 2603.78,-580.76"/>
<polygon fill="black" stroke="black" points="2605.44,-583.85 2612.72,-576.16 2602.23,-577.63 2605.44,-583.85"/>
</g>
<!-- expert4_gelu_16 -->
<g id="node532" class="node">
<title>expert4_gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="2807.77" cy="-941.77" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="2807.77" y="-953.07" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="2807.77" y="-938.07" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="2807.77" y="-923.07" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert4_fc1_16&#45;&gt;expert4_gelu_16 -->
<g id="edge671" class="edge">
<title>expert4_fc1_16&#45;&gt;expert4_gelu_16</title>
<path fill="none" stroke="black" d="M2807.77,-1029.94C2807.77,-1016.34 2807.77,-1002.33 2807.77,-989.63"/>
<polygon fill="black" stroke="black" points="2811.27,-989.3 2807.77,-979.3 2804.27,-989.3 2811.27,-989.3"/>
</g>
<!-- expert4_fc2_16 -->
<g id="node533" class="node">
<title>expert4_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="3111.31,-867.29 2628.45,-867.29 2504.23,-731.29 2987.09,-731.29 3111.31,-867.29"/>
<text text-anchor="middle" x="2807.77" y="-818.09" font-family="Times,serif" font-size="14.00">Expert4 FC2</text>
<text text-anchor="middle" x="2807.77" y="-803.09" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2807.77" y="-788.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="2807.77" y="-773.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert4_gelu_16&#45;&gt;expert4_fc2_16 -->
<g id="edge672" class="edge">
<title>expert4_gelu_16&#45;&gt;expert4_fc2_16</title>
<path fill="none" stroke="black" d="M2807.77,-904.22C2807.77,-895.92 2807.77,-886.8 2807.77,-877.52"/>
<polygon fill="black" stroke="black" points="2811.27,-877.41 2807.77,-867.41 2804.27,-877.41 2811.27,-877.41"/>
</g>
<!-- expert4_fc2_16&#45;&gt;expert_agg_16 -->
<g id="edge673" class="edge">
<title>expert4_fc2_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M2807.77,-731.04C2807.77,-722.7 2807.77,-713.84 2807.77,-704.62"/>
<polygon fill="black" stroke="black" points="2811.27,-704.49 2807.77,-694.49 2804.27,-704.49 2811.27,-704.49"/>
</g>
<!-- expert5_gelu_16 -->
<g id="node535" class="node">
<title>expert5_gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="3433.77" cy="-941.77" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="3433.77" y="-953.07" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="3433.77" y="-938.07" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="3433.77" y="-923.07" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert5_fc1_16&#45;&gt;expert5_gelu_16 -->
<g id="edge675" class="edge">
<title>expert5_fc1_16&#45;&gt;expert5_gelu_16</title>
<path fill="none" stroke="black" d="M3433.77,-1029.94C3433.77,-1016.34 3433.77,-1002.33 3433.77,-989.63"/>
<polygon fill="black" stroke="black" points="3437.27,-989.3 3433.77,-979.3 3430.27,-989.3 3437.27,-989.3"/>
</g>
<!-- expert5_fc2_16 -->
<g id="node536" class="node">
<title>expert5_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="3737.31,-867.29 3254.45,-867.29 3130.23,-731.29 3613.09,-731.29 3737.31,-867.29"/>
<text text-anchor="middle" x="3433.77" y="-818.09" font-family="Times,serif" font-size="14.00">Expert5 FC2</text>
<text text-anchor="middle" x="3433.77" y="-803.09" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="3433.77" y="-788.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="3433.77" y="-773.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert5_gelu_16&#45;&gt;expert5_fc2_16 -->
<g id="edge676" class="edge">
<title>expert5_gelu_16&#45;&gt;expert5_fc2_16</title>
<path fill="none" stroke="black" d="M3433.77,-904.22C3433.77,-895.92 3433.77,-886.8 3433.77,-877.52"/>
<polygon fill="black" stroke="black" points="3437.27,-877.41 3433.77,-867.41 3430.27,-877.41 3437.27,-877.41"/>
</g>
<!-- expert5_fc2_16&#45;&gt;expert_agg_16 -->
<g id="edge677" class="edge">
<title>expert5_fc2_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M3303.68,-731.24C3219.35,-687.77 3107.74,-630.24 3011.76,-580.76"/>
<polygon fill="black" stroke="black" points="3013.31,-577.63 3002.81,-576.16 3010.1,-583.85 3013.31,-577.63"/>
</g>
<!-- expert6_gelu_16 -->
<g id="node538" class="node">
<title>expert6_gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="4059.77" cy="-941.77" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="4059.77" y="-953.07" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="4059.77" y="-938.07" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="4059.77" y="-923.07" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert6_fc1_16&#45;&gt;expert6_gelu_16 -->
<g id="edge679" class="edge">
<title>expert6_fc1_16&#45;&gt;expert6_gelu_16</title>
<path fill="none" stroke="black" d="M4059.77,-1029.94C4059.77,-1016.34 4059.77,-1002.33 4059.77,-989.63"/>
<polygon fill="black" stroke="black" points="4063.27,-989.3 4059.77,-979.3 4056.27,-989.3 4063.27,-989.3"/>
</g>
<!-- expert6_fc2_16 -->
<g id="node539" class="node">
<title>expert6_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="4363.31,-867.29 3880.45,-867.29 3756.23,-731.29 4239.09,-731.29 4363.31,-867.29"/>
<text text-anchor="middle" x="4059.77" y="-818.09" font-family="Times,serif" font-size="14.00">Expert6 FC2</text>
<text text-anchor="middle" x="4059.77" y="-803.09" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4059.77" y="-788.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4059.77" y="-773.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert6_gelu_16&#45;&gt;expert6_fc2_16 -->
<g id="edge680" class="edge">
<title>expert6_gelu_16&#45;&gt;expert6_fc2_16</title>
<path fill="none" stroke="black" d="M4059.77,-904.22C4059.77,-895.92 4059.77,-886.8 4059.77,-877.52"/>
<polygon fill="black" stroke="black" points="4063.27,-877.41 4059.77,-867.41 4056.27,-877.41 4063.27,-877.41"/>
</g>
<!-- expert6_fc2_16&#45;&gt;expert_agg_16 -->
<g id="edge681" class="edge">
<title>expert6_fc2_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M3799.59,-731.24C3572.21,-672.63 3245.63,-588.47 3030.2,-532.95"/>
<polygon fill="black" stroke="black" points="3030.9,-529.51 3020.34,-530.41 3029.15,-536.29 3030.9,-529.51"/>
</g>
<!-- expert7_gelu_16 -->
<g id="node541" class="node">
<title>expert7_gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="4685.77" cy="-941.77" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="4685.77" y="-953.07" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="4685.77" y="-938.07" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="4685.77" y="-923.07" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- expert7_fc1_16&#45;&gt;expert7_gelu_16 -->
<g id="edge683" class="edge">
<title>expert7_fc1_16&#45;&gt;expert7_gelu_16</title>
<path fill="none" stroke="black" d="M4685.77,-1029.94C4685.77,-1016.34 4685.77,-1002.33 4685.77,-989.63"/>
<polygon fill="black" stroke="black" points="4689.27,-989.3 4685.77,-979.3 4682.27,-989.3 4689.27,-989.3"/>
</g>
<!-- expert7_fc2_16 -->
<g id="node542" class="node">
<title>expert7_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="4989.31,-867.29 4506.45,-867.29 4382.23,-731.29 4865.09,-731.29 4989.31,-867.29"/>
<text text-anchor="middle" x="4685.77" y="-818.09" font-family="Times,serif" font-size="14.00">Expert7 FC2</text>
<text text-anchor="middle" x="4685.77" y="-803.09" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="4685.77" y="-788.09" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="4685.77" y="-773.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- expert7_gelu_16&#45;&gt;expert7_fc2_16 -->
<g id="edge684" class="edge">
<title>expert7_gelu_16&#45;&gt;expert7_fc2_16</title>
<path fill="none" stroke="black" d="M4685.77,-904.22C4685.77,-895.92 4685.77,-886.8 4685.77,-877.52"/>
<polygon fill="black" stroke="black" points="4689.27,-877.41 4685.77,-867.41 4682.27,-877.41 4689.27,-877.41"/>
</g>
<!-- expert7_fc2_16&#45;&gt;expert_agg_16 -->
<g id="edge685" class="edge">
<title>expert7_fc2_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M4383.89,-733.4C4380.16,-732.69 4376.45,-731.98 4372.77,-731.29 3898.8,-641.9 3340.59,-555.12 3035.43,-509.24"/>
<polygon fill="black" stroke="black" points="3035.54,-505.72 3025.13,-507.69 3034.5,-512.64 3035.54,-505.72"/>
</g>
<!-- expert_agg_16&#45;&gt;residual2_16 -->
<g id="edge686" class="edge">
<title>expert_agg_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M3019.19,-414.75C3247.4,-351.21 3603.14,-252.16 3789.47,-200.28"/>
<polygon fill="black" stroke="black" points="3790.61,-203.6 3799.3,-197.55 3788.73,-196.86 3790.61,-203.6"/>
</g>
<!-- output -->
<g id="node545" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="3912.77" cy="-37.48" rx="218.49" ry="37.45"/>
<text text-anchor="middle" x="3912.77" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="3912.77" y="-33.78" font-family="Times,serif" font-size="14.00">[Batch=1024, Seq=2048, Hidden=8192]</text>
<text text-anchor="middle" x="3912.77" y="-18.78" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- residual2_16&#45;&gt;output -->
<g id="edge688" class="edge">
<title>residual2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3912.77,-111.83C3912.77,-102.93 3912.77,-93.73 3912.77,-84.98"/>
<polygon fill="black" stroke="black" points="3916.27,-84.96 3912.77,-74.96 3909.27,-84.96 3916.27,-84.96"/>
</g>
</g>
</svg>
