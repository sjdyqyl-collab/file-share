<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Model_Layerwise_Deployment Pages: 1 -->
<svg width="1800pt" height="1710pt"
 viewBox="0.00 0.00 1800.00 1709.71" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.14 0.14) rotate(0) translate(4 12313)">
<title>MoE_Model_Layerwise_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-12313 12963.5,-12313 12963.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="#e6f3ff" stroke="black" points="2873.5,-12309 2645.5,-12309 2645.5,-12256 2873.5,-12256 2873.5,-12309"/>
<text text-anchor="middle" x="2759.5" y="-12293.8" font-family="Arial" font-size="14.00">Input</text>
<text text-anchor="middle" x="2759.5" y="-12278.8" font-family="Arial" font-size="14.00">[batch=1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2759.5" y="-12263.8" font-family="Arial" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="#ffe4e1" stroke="black" points="2793,-12220 2606,-12220 2606,-12167 2793,-12167 2793,-12220"/>
<text text-anchor="middle" x="2699.5" y="-12204.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2699.5" y="-12189.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2699.5" y="-12174.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M2741.82,-12255.87C2735.95,-12247.36 2729.33,-12237.75 2723.09,-12228.7"/>
<polygon fill="black" stroke="black" points="2725.82,-12226.49 2717.26,-12220.25 2720.05,-12230.47 2725.82,-12226.49"/>
</g>
<!-- residual1_1 -->
<g id="node3" class="node">
<title>residual1_1</title>
<polygon fill="#f0f8ff" stroke="black" points="2856,-11686 2669,-11686 2669,-11633 2856,-11633 2856,-11686"/>
<text text-anchor="middle" x="2762.5" y="-11670.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2762.5" y="-11655.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2762.5" y="-11640.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M2789.22,-12255.82C2822.4,-12224.14 2871.5,-12166.89 2871.5,-12105.5 2871.5,-12105.5 2871.5,-12105.5 2871.5,-11836.5 2871.5,-11784.92 2880.25,-11765.49 2852.5,-11722 2845.05,-11710.32 2834.49,-11700.29 2823.22,-11691.92"/>
<polygon fill="black" stroke="black" points="2825.13,-11688.98 2814.92,-11686.12 2821.12,-11694.72 2825.13,-11688.98"/>
</g>
<!-- attn_qkv_1 -->
<g id="node4" class="node">
<title>attn_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="2843.5,-12131 2451.5,-12131 2451.5,-12078 2843.5,-12078 2843.5,-12131"/>
<text text-anchor="middle" x="2647.5" y="-12115.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2647.5" y="-12100.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="2647.5" y="-12085.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- ln1_1&#45;&gt;attn_qkv_1 -->
<g id="edge3" class="edge">
<title>ln1_1&#45;&gt;attn_qkv_1</title>
<path fill="none" stroke="black" d="M2684.18,-12166.87C2679.15,-12158.45 2673.47,-12148.95 2668.11,-12139.98"/>
<polygon fill="black" stroke="black" points="2671.03,-12138.04 2662.89,-12131.25 2665.02,-12141.63 2671.03,-12138.04"/>
</g>
<!-- ln2_1 -->
<g id="node9" class="node">
<title>ln2_1</title>
<polygon fill="#ffe4e1" stroke="black" points="2332,-11597 2145,-11597 2145,-11544 2332,-11544 2332,-11597"/>
<text text-anchor="middle" x="2238.5" y="-11581.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2238.5" y="-11566.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2238.5" y="-11551.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge9" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M2668.82,-11642.95C2576.99,-11627.7 2437.31,-11604.51 2342.18,-11588.71"/>
<polygon fill="black" stroke="black" points="2342.69,-11585.25 2332.25,-11587.07 2341.54,-11592.16 2342.69,-11585.25"/>
</g>
<!-- residual2_1 -->
<g id="node10" class="node">
<title>residual2_1</title>
<polygon fill="#f0f8ff" stroke="black" points="3259,-11152 3072,-11152 3072,-11099 3259,-11099 3259,-11152"/>
<text text-anchor="middle" x="3165.5" y="-11136.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3165.5" y="-11121.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3165.5" y="-11106.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge10" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M2856.07,-11642.37C2990.82,-11616.45 3223.5,-11560.41 3223.5,-11482.5 3223.5,-11482.5 3223.5,-11482.5 3223.5,-11302.5 3223.5,-11251.48 3201.24,-11196.13 3184.3,-11161.39"/>
<polygon fill="black" stroke="black" points="3187.29,-11159.54 3179.69,-11152.16 3181.03,-11162.67 3187.29,-11159.54"/>
</g>
<!-- attn_score_1 -->
<g id="node5" class="node">
<title>attn_score_1</title>
<polygon fill="#ffe6e6" stroke="black" points="2730.5,-12042 2566.5,-12042 2566.5,-11989 2730.5,-11989 2730.5,-12042"/>
<text text-anchor="middle" x="2648.5" y="-12026.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2648.5" y="-12011.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2648.5" y="-11996.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_qkv_1&#45;&gt;attn_score_1 -->
<g id="edge4" class="edge">
<title>attn_qkv_1&#45;&gt;attn_score_1</title>
<path fill="none" stroke="black" d="M2647.79,-12077.87C2647.89,-12069.89 2647.99,-12060.93 2648.09,-12052.38"/>
<polygon fill="black" stroke="black" points="2651.59,-12052.29 2648.2,-12042.25 2644.59,-12052.21 2651.59,-12052.29"/>
</g>
<!-- attn_weight_1 -->
<g id="node6" class="node">
<title>attn_weight_1</title>
<polygon fill="#ffe6e6" stroke="black" points="2731.5,-11953 2567.5,-11953 2567.5,-11900 2731.5,-11900 2731.5,-11953"/>
<text text-anchor="middle" x="2649.5" y="-11937.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="2649.5" y="-11922.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2649.5" y="-11907.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_score_1&#45;&gt;attn_weight_1 -->
<g id="edge5" class="edge">
<title>attn_score_1&#45;&gt;attn_weight_1</title>
<path fill="none" stroke="black" d="M2648.79,-11988.87C2648.89,-11980.89 2648.99,-11971.93 2649.09,-11963.38"/>
<polygon fill="black" stroke="black" points="2652.59,-11963.29 2649.2,-11953.25 2645.59,-11963.21 2652.59,-11963.29"/>
</g>
<!-- attn_context_1 -->
<g id="node7" class="node">
<title>attn_context_1</title>
<polygon fill="#ffe6e6" stroke="black" points="2745,-11864 2558,-11864 2558,-11811 2745,-11811 2745,-11864"/>
<text text-anchor="middle" x="2651.5" y="-11848.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="2651.5" y="-11833.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2651.5" y="-11818.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_weight_1&#45;&gt;attn_context_1 -->
<g id="edge6" class="edge">
<title>attn_weight_1&#45;&gt;attn_context_1</title>
<path fill="none" stroke="black" d="M2650.09,-11899.87C2650.27,-11891.89 2650.48,-11882.93 2650.68,-11874.38"/>
<polygon fill="black" stroke="black" points="2654.18,-11874.33 2650.91,-11864.25 2647.18,-11874.17 2654.18,-11874.33"/>
</g>
<!-- attn_out_1 -->
<g id="node8" class="node">
<title>attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="2844,-11775 2465,-11775 2465,-11722 2844,-11722 2844,-11775"/>
<text text-anchor="middle" x="2654.5" y="-11759.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2654.5" y="-11744.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2654.5" y="-11729.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_context_1&#45;&gt;attn_out_1 -->
<g id="edge7" class="edge">
<title>attn_context_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M2652.38,-11810.87C2652.66,-11802.89 2652.97,-11793.93 2653.26,-11785.38"/>
<polygon fill="black" stroke="black" points="2656.77,-11785.36 2653.61,-11775.25 2649.77,-11785.12 2656.77,-11785.36"/>
</g>
<!-- attn_out_1&#45;&gt;residual1_1 -->
<g id="edge8" class="edge">
<title>attn_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M2686.32,-11721.87C2697.64,-11712.75 2710.54,-11702.35 2722.47,-11692.75"/>
<polygon fill="black" stroke="black" points="2724.94,-11695.25 2730.53,-11686.25 2720.55,-11689.8 2724.94,-11695.25"/>
</g>
<!-- moe_gate_1 -->
<g id="node11" class="node">
<title>moe_gate_1</title>
<polygon fill="#e6e6ff" stroke="black" points="2134.5,-11508 1818.5,-11508 1818.5,-11455 2134.5,-11455 2134.5,-11508"/>
<text text-anchor="middle" x="1976.5" y="-11492.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1976.5" y="-11477.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="1976.5" y="-11462.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- ln2_1&#45;&gt;moe_gate_1 -->
<g id="edge11" class="edge">
<title>ln2_1&#45;&gt;moe_gate_1</title>
<path fill="none" stroke="black" d="M2161.66,-11543.98C2130.74,-11533.72 2094.92,-11521.82 2063.08,-11511.25"/>
<polygon fill="black" stroke="black" points="2063.93,-11507.84 2053.34,-11508.01 2061.72,-11514.49 2063.93,-11507.84"/>
</g>
<!-- comm_1_2 -->
<g id="node22" class="node">
<title>comm_1_2</title>
<ellipse fill="#f0e6ff" stroke="black" cx="3165.5" cy="-11025.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="3165.5" y="-11036.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="3165.5" y="-11021.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3165.5" y="-11006.8" font-family="Arial" font-size="14.00">GPU: 0 → GPU: 1</text>
</g>
<!-- residual2_1&#45;&gt;comm_1_2 -->
<g id="edge31" class="edge">
<title>residual2_1&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M3165.5,-11098.75C3165.5,-11090.93 3165.5,-11082.07 3165.5,-11073.31"/>
<polygon fill="black" stroke="black" points="3169,-11073.13 3165.5,-11063.13 3162,-11073.13 3169,-11073.13"/>
</g>
<!-- expert_1_0 -->
<g id="node12" class="node">
<title>expert_1_0</title>
<polygon fill="#e6ffe6" stroke="black" points="379,-11419 0,-11419 0,-11366 379,-11366 379,-11419"/>
<text text-anchor="middle" x="189.5" y="-11403.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="189.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="189.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_1_0 -->
<g id="edge12" class="edge">
<title>moe_gate_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" d="M1818.34,-11479.06C1534.13,-11475.43 918.1,-11462.85 389.28,-11419.12"/>
<polygon fill="black" stroke="black" points="389.41,-11415.62 379.15,-11418.28 388.83,-11422.59 389.41,-11415.62"/>
</g>
<!-- expert_1_1 -->
<g id="node13" class="node">
<title>expert_1_1</title>
<polygon fill="#e6ffe6" stroke="black" points="776,-11419 397,-11419 397,-11366 776,-11366 776,-11419"/>
<text text-anchor="middle" x="586.5" y="-11403.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="586.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="586.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_1_1 -->
<g id="edge13" class="edge">
<title>moe_gate_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M1818.12,-11476.19C1591.52,-11469.14 1161.57,-11452.56 786.13,-11419.12"/>
<polygon fill="black" stroke="black" points="786.43,-11415.63 776.16,-11418.23 785.8,-11422.61 786.43,-11415.63"/>
</g>
<!-- expert_1_2 -->
<g id="node14" class="node">
<title>expert_1_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1173,-11419 794,-11419 794,-11366 1173,-11366 1173,-11419"/>
<text text-anchor="middle" x="983.5" y="-11403.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="983.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="983.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_1_2 -->
<g id="edge14" class="edge">
<title>moe_gate_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" d="M1818.28,-11470.64C1660.04,-11460.23 1409.47,-11442.25 1183.24,-11419.16"/>
<polygon fill="black" stroke="black" points="1183.47,-11415.67 1173.17,-11418.13 1182.76,-11422.63 1183.47,-11415.67"/>
</g>
<!-- expert_1_3 -->
<g id="node15" class="node">
<title>expert_1_3</title>
<polygon fill="#e6ffe6" stroke="black" points="1570,-11419 1191,-11419 1191,-11366 1570,-11366 1570,-11419"/>
<text text-anchor="middle" x="1380.5" y="-11403.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1380.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1380.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_1_3 -->
<g id="edge15" class="edge">
<title>moe_gate_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" d="M1818.35,-11457.41C1740.71,-11446.08 1646.7,-11432.36 1565.72,-11420.54"/>
<polygon fill="black" stroke="black" points="1565.81,-11417.01 1555.4,-11419.03 1564.79,-11423.94 1565.81,-11417.01"/>
</g>
<!-- expert_1_4 -->
<g id="node16" class="node">
<title>expert_1_4</title>
<polygon fill="#e6ffe6" stroke="black" points="1967,-11419 1588,-11419 1588,-11366 1967,-11366 1967,-11419"/>
<text text-anchor="middle" x="1777.5" y="-11403.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1777.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1777.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_1_4 -->
<g id="edge16" class="edge">
<title>moe_gate_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" d="M1918.14,-11454.98C1895.26,-11444.98 1868.85,-11433.44 1845.14,-11423.07"/>
<polygon fill="black" stroke="black" points="1846.43,-11419.81 1835.86,-11419.01 1843.62,-11426.23 1846.43,-11419.81"/>
</g>
<!-- expert_1_5 -->
<g id="node17" class="node">
<title>expert_1_5</title>
<polygon fill="#e6ffe6" stroke="black" points="2364,-11419 1985,-11419 1985,-11366 2364,-11366 2364,-11419"/>
<text text-anchor="middle" x="2174.5" y="-11403.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2174.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2174.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_1_5 -->
<g id="edge17" class="edge">
<title>moe_gate_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" d="M2034.57,-11454.98C2057.34,-11444.98 2083.61,-11433.44 2107.2,-11423.07"/>
<polygon fill="black" stroke="black" points="2108.69,-11426.24 2116.43,-11419.01 2105.87,-11419.83 2108.69,-11426.24"/>
</g>
<!-- expert_1_6 -->
<g id="node18" class="node">
<title>expert_1_6</title>
<polygon fill="#e6ffe6" stroke="black" points="2761,-11419 2382,-11419 2382,-11366 2761,-11366 2761,-11419"/>
<text text-anchor="middle" x="2571.5" y="-11403.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2571.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2571.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_1_6 -->
<g id="edge18" class="edge">
<title>moe_gate_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" d="M2134.78,-11457.36C2212.2,-11446.04 2305.86,-11432.34 2386.56,-11420.54"/>
<polygon fill="black" stroke="black" points="2387.45,-11423.95 2396.84,-11419.04 2386.44,-11417.02 2387.45,-11423.95"/>
</g>
<!-- expert_1_7 -->
<g id="node19" class="node">
<title>expert_1_7</title>
<polygon fill="#e6ffe6" stroke="black" points="3158,-11419 2779,-11419 2779,-11366 3158,-11366 3158,-11419"/>
<text text-anchor="middle" x="2968.5" y="-11403.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2968.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2968.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_1_7 -->
<g id="edge19" class="edge">
<title>moe_gate_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" d="M2134.69,-11470.57C2292.55,-11460.12 2542.27,-11442.13 2768.84,-11419.05"/>
<polygon fill="black" stroke="black" points="2769.34,-11422.51 2778.93,-11418.01 2768.63,-11415.55 2769.34,-11422.51"/>
</g>
<!-- expert_combine_1 -->
<g id="node20" class="node">
<title>expert_combine_1</title>
<polygon fill="#fff0e6" stroke="black" points="2069,-11330 1882,-11330 1882,-11277 2069,-11277 2069,-11330"/>
<text text-anchor="middle" x="1975.5" y="-11314.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="1975.5" y="-11299.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1975.5" y="-11284.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- moe_gate_1&#45;&gt;expert_combine_1 -->
<g id="edge20" class="edge">
<title>moe_gate_1&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M2134.53,-11478.04C2450.38,-11472.35 3132.5,-11455.85 3167.5,-11419 3183.72,-11401.92 3183.72,-11383.08 3167.5,-11366 3130.3,-11326.83 2362.65,-11310.67 2079.35,-11306.02"/>
<polygon fill="black" stroke="black" points="2079.12,-11302.51 2069.07,-11305.85 2079.01,-11309.51 2079.12,-11302.51"/>
</g>
<!-- expert_1_0&#45;&gt;expert_combine_1 -->
<g id="edge21" class="edge">
<title>expert_1_0&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M379.15,-11366.72C381.95,-11366.47 384.74,-11366.23 387.5,-11366 945.8,-11319.33 1617.53,-11308 1871.48,-11305.32"/>
<polygon fill="black" stroke="black" points="1871.84,-11308.81 1881.8,-11305.21 1871.77,-11301.81 1871.84,-11308.81"/>
</g>
<!-- expert_1_1&#45;&gt;expert_combine_1 -->
<g id="edge22" class="edge">
<title>expert_1_1&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M776.16,-11366.77C778.96,-11366.51 781.74,-11366.25 784.5,-11366 1185.51,-11329.88 1664.54,-11313.15 1871.66,-11307.19"/>
<polygon fill="black" stroke="black" points="1872.01,-11310.68 1881.91,-11306.9 1871.81,-11303.68 1872.01,-11310.68"/>
</g>
<!-- expert_1_2&#45;&gt;expert_combine_1 -->
<g id="edge23" class="edge">
<title>expert_1_2&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M1173.17,-11366.87C1175.96,-11366.58 1178.74,-11366.28 1181.5,-11366 1428.54,-11340.54 1719.81,-11320.53 1871.61,-11310.86"/>
<polygon fill="black" stroke="black" points="1872.1,-11314.33 1881.85,-11310.21 1871.65,-11307.35 1872.1,-11314.33"/>
</g>
<!-- expert_1_3&#45;&gt;expert_combine_1 -->
<g id="edge24" class="edge">
<title>expert_1_3&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M1555,-11365.98C1657.85,-11350.95 1784.51,-11332.43 1871.78,-11319.67"/>
<polygon fill="black" stroke="black" points="1872.3,-11323.13 1881.69,-11318.22 1871.29,-11316.2 1872.3,-11323.13"/>
</g>
<!-- expert_1_4&#45;&gt;expert_combine_1 -->
<g id="edge25" class="edge">
<title>expert_1_4&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M1835.57,-11365.98C1858.34,-11355.98 1884.61,-11344.44 1908.2,-11334.07"/>
<polygon fill="black" stroke="black" points="1909.69,-11337.24 1917.43,-11330.01 1906.87,-11330.83 1909.69,-11337.24"/>
</g>
<!-- expert_1_5&#45;&gt;expert_combine_1 -->
<g id="edge26" class="edge">
<title>expert_1_5&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M2116.14,-11365.98C2093.26,-11355.98 2066.85,-11344.44 2043.14,-11334.07"/>
<polygon fill="black" stroke="black" points="2044.43,-11330.81 2033.86,-11330.01 2041.62,-11337.23 2044.43,-11330.81"/>
</g>
<!-- expert_1_6&#45;&gt;expert_combine_1 -->
<g id="edge27" class="edge">
<title>expert_1_6&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M2396.71,-11365.98C2293.52,-11350.92 2166.41,-11332.37 2078.97,-11319.6"/>
<polygon fill="black" stroke="black" points="2079.45,-11316.14 2069.04,-11318.16 2078.43,-11323.06 2079.45,-11316.14"/>
</g>
<!-- expert_1_7&#45;&gt;expert_combine_1 -->
<g id="edge28" class="edge">
<title>expert_1_7&#45;&gt;expert_combine_1</title>
<path fill="none" stroke="black" d="M2778.93,-11366.99C2775.76,-11366.65 2772.62,-11366.32 2769.5,-11366 2522.45,-11340.62 2231.19,-11320.58 2079.38,-11310.88"/>
<polygon fill="black" stroke="black" points="2079.35,-11307.37 2069.14,-11310.23 2078.9,-11314.36 2079.35,-11307.37"/>
</g>
<!-- expert_out_1 -->
<g id="node21" class="node">
<title>expert_out_1</title>
<polygon fill="#fff0e6" stroke="black" points="2582,-11241 2203,-11241 2203,-11188 2582,-11188 2582,-11241"/>
<text text-anchor="middle" x="2392.5" y="-11225.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="2392.5" y="-11210.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2392.5" y="-11195.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_combine_1&#45;&gt;expert_out_1 -->
<g id="edge29" class="edge">
<title>expert_combine_1&#45;&gt;expert_out_1</title>
<path fill="none" stroke="black" d="M2069.08,-11282.98C2125.38,-11271.23 2197.94,-11256.09 2260.06,-11243.13"/>
<polygon fill="black" stroke="black" points="2260.86,-11246.54 2269.93,-11241.07 2259.43,-11239.69 2260.86,-11246.54"/>
</g>
<!-- expert_out_1&#45;&gt;residual2_1 -->
<g id="edge30" class="edge">
<title>expert_out_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M2582.09,-11192.16C2733.28,-11175.15 2939.33,-11151.96 3061.77,-11138.17"/>
<polygon fill="black" stroke="black" points="3062.35,-11141.63 3071.89,-11137.04 3061.56,-11134.68 3062.35,-11141.63"/>
</g>
<!-- residual1_2 -->
<g id="node23" class="node">
<title>residual1_2</title>
<polygon fill="#f0f8ff" stroke="black" points="3429,-10952 3242,-10952 3242,-10899 3429,-10899 3429,-10952"/>
<text text-anchor="middle" x="3335.5" y="-10936.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3335.5" y="-10921.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3335.5" y="-10906.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- comm_1_2&#45;&gt;residual1_2 -->
<g id="edge32" class="edge">
<title>comm_1_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M3222.58,-10991.59C3241.9,-10980.46 3263.38,-10968.07 3282.38,-10957.12"/>
<polygon fill="black" stroke="black" points="3284.29,-10960.06 3291.2,-10952.04 3280.79,-10954 3284.29,-10960.06"/>
</g>
<!-- ln2_2 -->
<g id="node30" class="node">
<title>ln2_2</title>
<polygon fill="#ffe4e1" stroke="black" points="2905,-10863 2718,-10863 2718,-10810 2905,-10810 2905,-10863"/>
<text text-anchor="middle" x="2811.5" y="-10847.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2811.5" y="-10832.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2811.5" y="-10817.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge39" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M3241.82,-10908.95C3149.99,-10893.7 3010.31,-10870.51 2915.18,-10854.71"/>
<polygon fill="black" stroke="black" points="2915.69,-10851.25 2905.25,-10853.07 2914.54,-10858.16 2915.69,-10851.25"/>
</g>
<!-- residual2_2 -->
<g id="node31" class="node">
<title>residual2_2</title>
<polygon fill="#f0f8ff" stroke="black" points="3832,-10418 3645,-10418 3645,-10365 3832,-10365 3832,-10418"/>
<text text-anchor="middle" x="3738.5" y="-10402.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3738.5" y="-10387.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3738.5" y="-10372.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge40" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M3429.07,-10908.37C3563.82,-10882.45 3796.5,-10826.41 3796.5,-10748.5 3796.5,-10748.5 3796.5,-10748.5 3796.5,-10568.5 3796.5,-10517.48 3774.24,-10462.13 3757.3,-10427.39"/>
<polygon fill="black" stroke="black" points="3760.29,-10425.54 3752.69,-10418.16 3754.03,-10428.67 3760.29,-10425.54"/>
</g>
<!-- ln1_2 -->
<g id="node24" class="node">
<title>ln1_2</title>
<polygon fill="#ffe4e1" stroke="black" points="3599,-11508 3412,-11508 3412,-11455 3599,-11455 3599,-11508"/>
<text text-anchor="middle" x="3505.5" y="-11492.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3505.5" y="-11477.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3505.5" y="-11462.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_qkv_2 -->
<g id="node25" class="node">
<title>attn_qkv_2</title>
<polygon fill="#ffe6e6" stroke="black" points="3701.5,-11419 3309.5,-11419 3309.5,-11366 3701.5,-11366 3701.5,-11419"/>
<text text-anchor="middle" x="3505.5" y="-11403.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3505.5" y="-11388.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="3505.5" y="-11373.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- ln1_2&#45;&gt;attn_qkv_2 -->
<g id="edge33" class="edge">
<title>ln1_2&#45;&gt;attn_qkv_2</title>
<path fill="none" stroke="black" d="M3505.5,-11454.87C3505.5,-11446.89 3505.5,-11437.93 3505.5,-11429.38"/>
<polygon fill="black" stroke="black" points="3509,-11429.25 3505.5,-11419.25 3502,-11429.25 3509,-11429.25"/>
</g>
<!-- attn_score_2 -->
<g id="node26" class="node">
<title>attn_score_2</title>
<polygon fill="#ffe6e6" stroke="black" points="3587.5,-11330 3423.5,-11330 3423.5,-11277 3587.5,-11277 3587.5,-11330"/>
<text text-anchor="middle" x="3505.5" y="-11314.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3505.5" y="-11299.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3505.5" y="-11284.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_qkv_2&#45;&gt;attn_score_2 -->
<g id="edge34" class="edge">
<title>attn_qkv_2&#45;&gt;attn_score_2</title>
<path fill="none" stroke="black" d="M3505.5,-11365.87C3505.5,-11357.89 3505.5,-11348.93 3505.5,-11340.38"/>
<polygon fill="black" stroke="black" points="3509,-11340.25 3505.5,-11330.25 3502,-11340.25 3509,-11340.25"/>
</g>
<!-- attn_weight_2 -->
<g id="node27" class="node">
<title>attn_weight_2</title>
<polygon fill="#ffe6e6" stroke="black" points="3587.5,-11241 3423.5,-11241 3423.5,-11188 3587.5,-11188 3587.5,-11241"/>
<text text-anchor="middle" x="3505.5" y="-11225.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="3505.5" y="-11210.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3505.5" y="-11195.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_score_2&#45;&gt;attn_weight_2 -->
<g id="edge35" class="edge">
<title>attn_score_2&#45;&gt;attn_weight_2</title>
<path fill="none" stroke="black" d="M3505.5,-11276.87C3505.5,-11268.89 3505.5,-11259.93 3505.5,-11251.38"/>
<polygon fill="black" stroke="black" points="3509,-11251.25 3505.5,-11241.25 3502,-11251.25 3509,-11251.25"/>
</g>
<!-- attn_context_2 -->
<g id="node28" class="node">
<title>attn_context_2</title>
<polygon fill="#ffe6e6" stroke="black" points="3599,-11152 3412,-11152 3412,-11099 3599,-11099 3599,-11152"/>
<text text-anchor="middle" x="3505.5" y="-11136.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="3505.5" y="-11121.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3505.5" y="-11106.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_weight_2&#45;&gt;attn_context_2 -->
<g id="edge36" class="edge">
<title>attn_weight_2&#45;&gt;attn_context_2</title>
<path fill="none" stroke="black" d="M3505.5,-11187.87C3505.5,-11179.89 3505.5,-11170.93 3505.5,-11162.38"/>
<polygon fill="black" stroke="black" points="3509,-11162.25 3505.5,-11152.25 3502,-11162.25 3509,-11162.25"/>
</g>
<!-- attn_out_2 -->
<g id="node29" class="node">
<title>attn_out_2</title>
<polygon fill="#ffe6e6" stroke="black" points="3695,-11052 3316,-11052 3316,-10999 3695,-10999 3695,-11052"/>
<text text-anchor="middle" x="3505.5" y="-11036.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3505.5" y="-11021.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3505.5" y="-11006.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_context_2&#45;&gt;attn_out_2 -->
<g id="edge37" class="edge">
<title>attn_context_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M3505.5,-11098.75C3505.5,-11087.61 3505.5,-11074.38 3505.5,-11062.31"/>
<polygon fill="black" stroke="black" points="3509,-11062.08 3505.5,-11052.08 3502,-11062.08 3509,-11062.08"/>
</g>
<!-- attn_out_2&#45;&gt;residual1_2 -->
<g id="edge38" class="edge">
<title>attn_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M3460.83,-10998.75C3438.68,-10985.98 3411.76,-10970.46 3388.56,-10957.09"/>
<polygon fill="black" stroke="black" points="3390.28,-10954.04 3379.87,-10952.08 3386.78,-10960.1 3390.28,-10954.04"/>
</g>
<!-- moe_gate_2 -->
<g id="node32" class="node">
<title>moe_gate_2</title>
<polygon fill="#e6e6ff" stroke="black" points="2707.5,-10774 2391.5,-10774 2391.5,-10721 2707.5,-10721 2707.5,-10774"/>
<text text-anchor="middle" x="2549.5" y="-10758.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2549.5" y="-10743.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="2549.5" y="-10728.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- ln2_2&#45;&gt;moe_gate_2 -->
<g id="edge41" class="edge">
<title>ln2_2&#45;&gt;moe_gate_2</title>
<path fill="none" stroke="black" d="M2734.66,-10809.98C2703.74,-10799.72 2667.92,-10787.82 2636.08,-10777.25"/>
<polygon fill="black" stroke="black" points="2636.93,-10773.84 2626.34,-10774.01 2634.72,-10780.49 2636.93,-10773.84"/>
</g>
<!-- comm_2_3 -->
<g id="node43" class="node">
<title>comm_2_3</title>
<ellipse fill="#f0e6ff" stroke="black" cx="3738.5" cy="-10291.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="3738.5" y="-10302.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="3738.5" y="-10287.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3738.5" y="-10272.8" font-family="Arial" font-size="14.00">GPU: 1 → GPU: 2</text>
</g>
<!-- residual2_2&#45;&gt;comm_2_3 -->
<g id="edge61" class="edge">
<title>residual2_2&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M3738.5,-10364.75C3738.5,-10356.93 3738.5,-10348.07 3738.5,-10339.31"/>
<polygon fill="black" stroke="black" points="3742,-10339.13 3738.5,-10329.13 3735,-10339.13 3742,-10339.13"/>
</g>
<!-- expert_2_0 -->
<g id="node33" class="node">
<title>expert_2_0</title>
<polygon fill="#e6ffe6" stroke="black" points="952,-10685 573,-10685 573,-10632 952,-10632 952,-10685"/>
<text text-anchor="middle" x="762.5" y="-10669.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="762.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="762.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_2_0 -->
<g id="edge42" class="edge">
<title>moe_gate_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" d="M2391.34,-10745.06C2107.13,-10741.43 1491.1,-10728.85 962.28,-10685.12"/>
<polygon fill="black" stroke="black" points="962.41,-10681.62 952.15,-10684.28 961.83,-10688.59 962.41,-10681.62"/>
</g>
<!-- expert_2_1 -->
<g id="node34" class="node">
<title>expert_2_1</title>
<polygon fill="#e6ffe6" stroke="black" points="1349,-10685 970,-10685 970,-10632 1349,-10632 1349,-10685"/>
<text text-anchor="middle" x="1159.5" y="-10669.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1159.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1159.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_2_1 -->
<g id="edge43" class="edge">
<title>moe_gate_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" d="M2391.12,-10742.19C2164.52,-10735.14 1734.57,-10718.56 1359.13,-10685.12"/>
<polygon fill="black" stroke="black" points="1359.43,-10681.63 1349.16,-10684.23 1358.8,-10688.61 1359.43,-10681.63"/>
</g>
<!-- expert_2_2 -->
<g id="node35" class="node">
<title>expert_2_2</title>
<polygon fill="#e6ffe6" stroke="black" points="1746,-10685 1367,-10685 1367,-10632 1746,-10632 1746,-10685"/>
<text text-anchor="middle" x="1556.5" y="-10669.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1556.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1556.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_2_2 -->
<g id="edge44" class="edge">
<title>moe_gate_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" d="M2391.28,-10736.64C2233.04,-10726.23 1982.47,-10708.25 1756.24,-10685.16"/>
<polygon fill="black" stroke="black" points="1756.47,-10681.67 1746.17,-10684.13 1755.76,-10688.63 1756.47,-10681.67"/>
</g>
<!-- expert_2_3 -->
<g id="node36" class="node">
<title>expert_2_3</title>
<polygon fill="#e6ffe6" stroke="black" points="2143,-10685 1764,-10685 1764,-10632 2143,-10632 2143,-10685"/>
<text text-anchor="middle" x="1953.5" y="-10669.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1953.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1953.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_2_3 -->
<g id="edge45" class="edge">
<title>moe_gate_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" d="M2391.35,-10723.41C2313.71,-10712.08 2219.7,-10698.36 2138.72,-10686.54"/>
<polygon fill="black" stroke="black" points="2138.81,-10683.01 2128.4,-10685.03 2137.79,-10689.94 2138.81,-10683.01"/>
</g>
<!-- expert_2_4 -->
<g id="node37" class="node">
<title>expert_2_4</title>
<polygon fill="#e6ffe6" stroke="black" points="2540,-10685 2161,-10685 2161,-10632 2540,-10632 2540,-10685"/>
<text text-anchor="middle" x="2350.5" y="-10669.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2350.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2350.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_2_4 -->
<g id="edge46" class="edge">
<title>moe_gate_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" d="M2491.14,-10720.98C2468.26,-10710.98 2441.85,-10699.44 2418.14,-10689.07"/>
<polygon fill="black" stroke="black" points="2419.43,-10685.81 2408.86,-10685.01 2416.62,-10692.23 2419.43,-10685.81"/>
</g>
<!-- expert_2_5 -->
<g id="node38" class="node">
<title>expert_2_5</title>
<polygon fill="#e6ffe6" stroke="black" points="2937,-10685 2558,-10685 2558,-10632 2937,-10632 2937,-10685"/>
<text text-anchor="middle" x="2747.5" y="-10669.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2747.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2747.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_2_5 -->
<g id="edge47" class="edge">
<title>moe_gate_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" d="M2607.57,-10720.98C2630.34,-10710.98 2656.61,-10699.44 2680.2,-10689.07"/>
<polygon fill="black" stroke="black" points="2681.69,-10692.24 2689.43,-10685.01 2678.87,-10685.83 2681.69,-10692.24"/>
</g>
<!-- expert_2_6 -->
<g id="node39" class="node">
<title>expert_2_6</title>
<polygon fill="#e6ffe6" stroke="black" points="3334,-10685 2955,-10685 2955,-10632 3334,-10632 3334,-10685"/>
<text text-anchor="middle" x="3144.5" y="-10669.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3144.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3144.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_2_6 -->
<g id="edge48" class="edge">
<title>moe_gate_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" d="M2707.78,-10723.36C2785.2,-10712.04 2878.86,-10698.34 2959.56,-10686.54"/>
<polygon fill="black" stroke="black" points="2960.45,-10689.95 2969.84,-10685.04 2959.44,-10683.02 2960.45,-10689.95"/>
</g>
<!-- expert_2_7 -->
<g id="node40" class="node">
<title>expert_2_7</title>
<polygon fill="#e6ffe6" stroke="black" points="3731,-10685 3352,-10685 3352,-10632 3731,-10632 3731,-10685"/>
<text text-anchor="middle" x="3541.5" y="-10669.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3541.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3541.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_2_7 -->
<g id="edge49" class="edge">
<title>moe_gate_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" d="M2707.52,-10736.63C2865.56,-10726.21 3115.82,-10708.23 3341.77,-10685.16"/>
<polygon fill="black" stroke="black" points="3342.24,-10688.63 3351.83,-10684.13 3341.53,-10681.67 3342.24,-10688.63"/>
</g>
<!-- expert_combine_2 -->
<g id="node41" class="node">
<title>expert_combine_2</title>
<polygon fill="#fff0e6" stroke="black" points="2642,-10596 2455,-10596 2455,-10543 2642,-10543 2642,-10596"/>
<text text-anchor="middle" x="2548.5" y="-10580.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="2548.5" y="-10565.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2548.5" y="-10550.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- moe_gate_2&#45;&gt;expert_combine_2 -->
<g id="edge50" class="edge">
<title>moe_gate_2&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M2707.53,-10744.04C3023.38,-10738.35 3705.5,-10721.85 3740.5,-10685 3756.72,-10667.92 3756.72,-10649.08 3740.5,-10632 3703.3,-10592.83 2935.65,-10576.67 2652.35,-10572.02"/>
<polygon fill="black" stroke="black" points="2652.12,-10568.51 2642.07,-10571.85 2652.01,-10575.51 2652.12,-10568.51"/>
</g>
<!-- expert_2_0&#45;&gt;expert_combine_2 -->
<g id="edge51" class="edge">
<title>expert_2_0&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M952.15,-10632.72C954.95,-10632.47 957.74,-10632.23 960.5,-10632 1518.8,-10585.33 2190.53,-10574 2444.48,-10571.32"/>
<polygon fill="black" stroke="black" points="2444.84,-10574.81 2454.8,-10571.21 2444.77,-10567.81 2444.84,-10574.81"/>
</g>
<!-- expert_2_1&#45;&gt;expert_combine_2 -->
<g id="edge52" class="edge">
<title>expert_2_1&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M1349.16,-10632.77C1351.96,-10632.51 1354.74,-10632.25 1357.5,-10632 1758.51,-10595.88 2237.54,-10579.15 2444.66,-10573.19"/>
<polygon fill="black" stroke="black" points="2445.01,-10576.68 2454.91,-10572.9 2444.81,-10569.68 2445.01,-10576.68"/>
</g>
<!-- expert_2_2&#45;&gt;expert_combine_2 -->
<g id="edge53" class="edge">
<title>expert_2_2&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M1746.17,-10632.87C1748.96,-10632.58 1751.74,-10632.28 1754.5,-10632 2001.54,-10606.54 2292.81,-10586.53 2444.61,-10576.86"/>
<polygon fill="black" stroke="black" points="2445.1,-10580.33 2454.85,-10576.21 2444.65,-10573.35 2445.1,-10580.33"/>
</g>
<!-- expert_2_3&#45;&gt;expert_combine_2 -->
<g id="edge54" class="edge">
<title>expert_2_3&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M2128,-10631.98C2230.85,-10616.95 2357.51,-10598.43 2444.78,-10585.67"/>
<polygon fill="black" stroke="black" points="2445.3,-10589.13 2454.69,-10584.22 2444.29,-10582.2 2445.3,-10589.13"/>
</g>
<!-- expert_2_4&#45;&gt;expert_combine_2 -->
<g id="edge55" class="edge">
<title>expert_2_4&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M2408.57,-10631.98C2431.34,-10621.98 2457.61,-10610.44 2481.2,-10600.07"/>
<polygon fill="black" stroke="black" points="2482.69,-10603.24 2490.43,-10596.01 2479.87,-10596.83 2482.69,-10603.24"/>
</g>
<!-- expert_2_5&#45;&gt;expert_combine_2 -->
<g id="edge56" class="edge">
<title>expert_2_5&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M2689.14,-10631.98C2666.26,-10621.98 2639.85,-10610.44 2616.14,-10600.07"/>
<polygon fill="black" stroke="black" points="2617.43,-10596.81 2606.86,-10596.01 2614.62,-10603.23 2617.43,-10596.81"/>
</g>
<!-- expert_2_6&#45;&gt;expert_combine_2 -->
<g id="edge57" class="edge">
<title>expert_2_6&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M2969.71,-10631.98C2866.52,-10616.92 2739.41,-10598.37 2651.97,-10585.6"/>
<polygon fill="black" stroke="black" points="2652.45,-10582.14 2642.04,-10584.16 2651.43,-10589.06 2652.45,-10582.14"/>
</g>
<!-- expert_2_7&#45;&gt;expert_combine_2 -->
<g id="edge58" class="edge">
<title>expert_2_7&#45;&gt;expert_combine_2</title>
<path fill="none" stroke="black" d="M3351.83,-10632.87C3349.04,-10632.58 3346.26,-10632.28 3343.5,-10632 3096.15,-10606.52 2804.52,-10586.52 2652.52,-10576.85"/>
<polygon fill="black" stroke="black" points="2652.46,-10573.34 2642.26,-10576.2 2652.02,-10580.33 2652.46,-10573.34"/>
</g>
<!-- expert_out_2 -->
<g id="node42" class="node">
<title>expert_out_2</title>
<polygon fill="#fff0e6" stroke="black" points="3155,-10507 2776,-10507 2776,-10454 3155,-10454 3155,-10507"/>
<text text-anchor="middle" x="2965.5" y="-10491.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="2965.5" y="-10476.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2965.5" y="-10461.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_combine_2&#45;&gt;expert_out_2 -->
<g id="edge59" class="edge">
<title>expert_combine_2&#45;&gt;expert_out_2</title>
<path fill="none" stroke="black" d="M2642.08,-10548.98C2698.38,-10537.23 2770.94,-10522.09 2833.06,-10509.13"/>
<polygon fill="black" stroke="black" points="2833.86,-10512.54 2842.93,-10507.07 2832.43,-10505.69 2833.86,-10512.54"/>
</g>
<!-- expert_out_2&#45;&gt;residual2_2 -->
<g id="edge60" class="edge">
<title>expert_out_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M3155.09,-10458.16C3306.28,-10441.15 3512.33,-10417.96 3634.77,-10404.17"/>
<polygon fill="black" stroke="black" points="3635.35,-10407.63 3644.89,-10403.04 3634.56,-10400.68 3635.35,-10407.63"/>
</g>
<!-- residual1_3 -->
<g id="node44" class="node">
<title>residual1_3</title>
<polygon fill="#f0f8ff" stroke="black" points="4002,-10218 3815,-10218 3815,-10165 4002,-10165 4002,-10218"/>
<text text-anchor="middle" x="3908.5" y="-10202.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3908.5" y="-10187.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3908.5" y="-10172.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- comm_2_3&#45;&gt;residual1_3 -->
<g id="edge62" class="edge">
<title>comm_2_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M3795.58,-10257.59C3814.9,-10246.46 3836.38,-10234.07 3855.38,-10223.12"/>
<polygon fill="black" stroke="black" points="3857.29,-10226.06 3864.2,-10218.04 3853.79,-10220 3857.29,-10226.06"/>
</g>
<!-- ln2_3 -->
<g id="node51" class="node">
<title>ln2_3</title>
<polygon fill="#ffe4e1" stroke="black" points="3942,-10129 3755,-10129 3755,-10076 3942,-10076 3942,-10129"/>
<text text-anchor="middle" x="3848.5" y="-10113.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3848.5" y="-10098.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3848.5" y="-10083.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge69" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M3890.82,-10164.87C3884.95,-10156.36 3878.33,-10146.75 3872.09,-10137.7"/>
<polygon fill="black" stroke="black" points="3874.82,-10135.49 3866.26,-10129.25 3869.05,-10139.47 3874.82,-10135.49"/>
</g>
<!-- residual2_3 -->
<g id="node52" class="node">
<title>residual2_3</title>
<polygon fill="#f0f8ff" stroke="black" points="4568,-9684 4381,-9684 4381,-9631 4568,-9631 4568,-9684"/>
<text text-anchor="middle" x="4474.5" y="-9668.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4474.5" y="-9653.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4474.5" y="-9638.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge70" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M4002.26,-10183.59C4176.45,-10168.17 4532.5,-10123.33 4532.5,-10014.5 4532.5,-10014.5 4532.5,-10014.5 4532.5,-9834.5 4532.5,-9783.48 4510.24,-9728.13 4493.3,-9693.39"/>
<polygon fill="black" stroke="black" points="4496.29,-9691.54 4488.69,-9684.16 4490.03,-9694.67 4496.29,-9691.54"/>
</g>
<!-- ln1_3 -->
<g id="node45" class="node">
<title>ln1_3</title>
<polygon fill="#ffe4e1" stroke="black" points="4172,-10774 3985,-10774 3985,-10721 4172,-10721 4172,-10774"/>
<text text-anchor="middle" x="4078.5" y="-10758.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4078.5" y="-10743.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4078.5" y="-10728.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_qkv_3 -->
<g id="node46" class="node">
<title>attn_qkv_3</title>
<polygon fill="#ffe6e6" stroke="black" points="4274.5,-10685 3882.5,-10685 3882.5,-10632 4274.5,-10632 4274.5,-10685"/>
<text text-anchor="middle" x="4078.5" y="-10669.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4078.5" y="-10654.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="4078.5" y="-10639.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- ln1_3&#45;&gt;attn_qkv_3 -->
<g id="edge63" class="edge">
<title>ln1_3&#45;&gt;attn_qkv_3</title>
<path fill="none" stroke="black" d="M4078.5,-10720.87C4078.5,-10712.89 4078.5,-10703.93 4078.5,-10695.38"/>
<polygon fill="black" stroke="black" points="4082,-10695.25 4078.5,-10685.25 4075,-10695.25 4082,-10695.25"/>
</g>
<!-- attn_score_3 -->
<g id="node47" class="node">
<title>attn_score_3</title>
<polygon fill="#ffe6e6" stroke="black" points="4160.5,-10596 3996.5,-10596 3996.5,-10543 4160.5,-10543 4160.5,-10596"/>
<text text-anchor="middle" x="4078.5" y="-10580.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="4078.5" y="-10565.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="4078.5" y="-10550.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_qkv_3&#45;&gt;attn_score_3 -->
<g id="edge64" class="edge">
<title>attn_qkv_3&#45;&gt;attn_score_3</title>
<path fill="none" stroke="black" d="M4078.5,-10631.87C4078.5,-10623.89 4078.5,-10614.93 4078.5,-10606.38"/>
<polygon fill="black" stroke="black" points="4082,-10606.25 4078.5,-10596.25 4075,-10606.25 4082,-10606.25"/>
</g>
<!-- attn_weight_3 -->
<g id="node48" class="node">
<title>attn_weight_3</title>
<polygon fill="#ffe6e6" stroke="black" points="4160.5,-10507 3996.5,-10507 3996.5,-10454 4160.5,-10454 4160.5,-10507"/>
<text text-anchor="middle" x="4078.5" y="-10491.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="4078.5" y="-10476.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="4078.5" y="-10461.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_score_3&#45;&gt;attn_weight_3 -->
<g id="edge65" class="edge">
<title>attn_score_3&#45;&gt;attn_weight_3</title>
<path fill="none" stroke="black" d="M4078.5,-10542.87C4078.5,-10534.89 4078.5,-10525.93 4078.5,-10517.38"/>
<polygon fill="black" stroke="black" points="4082,-10517.25 4078.5,-10507.25 4075,-10517.25 4082,-10517.25"/>
</g>
<!-- attn_context_3 -->
<g id="node49" class="node">
<title>attn_context_3</title>
<polygon fill="#ffe6e6" stroke="black" points="4172,-10418 3985,-10418 3985,-10365 4172,-10365 4172,-10418"/>
<text text-anchor="middle" x="4078.5" y="-10402.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="4078.5" y="-10387.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4078.5" y="-10372.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_weight_3&#45;&gt;attn_context_3 -->
<g id="edge66" class="edge">
<title>attn_weight_3&#45;&gt;attn_context_3</title>
<path fill="none" stroke="black" d="M4078.5,-10453.87C4078.5,-10445.89 4078.5,-10436.93 4078.5,-10428.38"/>
<polygon fill="black" stroke="black" points="4082,-10428.25 4078.5,-10418.25 4075,-10428.25 4082,-10428.25"/>
</g>
<!-- attn_out_3 -->
<g id="node50" class="node">
<title>attn_out_3</title>
<polygon fill="#ffe6e6" stroke="black" points="4268,-10318 3889,-10318 3889,-10265 4268,-10265 4268,-10318"/>
<text text-anchor="middle" x="4078.5" y="-10302.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4078.5" y="-10287.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4078.5" y="-10272.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_context_3&#45;&gt;attn_out_3 -->
<g id="edge67" class="edge">
<title>attn_context_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M4078.5,-10364.75C4078.5,-10353.61 4078.5,-10340.38 4078.5,-10328.31"/>
<polygon fill="black" stroke="black" points="4082,-10328.08 4078.5,-10318.08 4075,-10328.08 4082,-10328.08"/>
</g>
<!-- attn_out_3&#45;&gt;residual1_3 -->
<g id="edge68" class="edge">
<title>attn_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M4033.83,-10264.75C4011.68,-10251.98 3984.76,-10236.46 3961.56,-10223.09"/>
<polygon fill="black" stroke="black" points="3963.28,-10220.04 3952.87,-10218.08 3959.78,-10226.1 3963.28,-10220.04"/>
</g>
<!-- moe_gate_3 -->
<g id="node53" class="node">
<title>moe_gate_3</title>
<polygon fill="#e6e6ff" stroke="black" points="3443.5,-10040 3127.5,-10040 3127.5,-9987 3443.5,-9987 3443.5,-10040"/>
<text text-anchor="middle" x="3285.5" y="-10024.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="3285.5" y="-10009.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="3285.5" y="-9994.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- ln2_3&#45;&gt;moe_gate_3 -->
<g id="edge71" class="edge">
<title>ln2_3&#45;&gt;moe_gate_3</title>
<path fill="none" stroke="black" d="M3754.9,-10087.04C3673.05,-10074.39 3552.2,-10055.71 3453.63,-10040.48"/>
<polygon fill="black" stroke="black" points="3453.97,-10036.99 3443.55,-10038.92 3452.9,-10043.91 3453.97,-10036.99"/>
</g>
<!-- comm_3_4 -->
<g id="node64" class="node">
<title>comm_3_4</title>
<ellipse fill="#f0e6ff" stroke="black" cx="4474.5" cy="-9557.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="4474.5" y="-9568.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="4474.5" y="-9553.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4474.5" y="-9538.8" font-family="Arial" font-size="14.00">GPU: 2 → GPU: 3</text>
</g>
<!-- residual2_3&#45;&gt;comm_3_4 -->
<g id="edge91" class="edge">
<title>residual2_3&#45;&gt;comm_3_4</title>
<path fill="none" stroke="black" d="M4474.5,-9630.75C4474.5,-9622.93 4474.5,-9614.07 4474.5,-9605.31"/>
<polygon fill="black" stroke="black" points="4478,-9605.13 4474.5,-9595.13 4471,-9605.13 4478,-9605.13"/>
</g>
<!-- expert_3_0 -->
<g id="node54" class="node">
<title>expert_3_0</title>
<polygon fill="#e6ffe6" stroke="black" points="1688,-9951 1309,-9951 1309,-9898 1688,-9898 1688,-9951"/>
<text text-anchor="middle" x="1498.5" y="-9935.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1498.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1498.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_3_0 -->
<g id="edge72" class="edge">
<title>moe_gate_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" d="M3127.34,-10011.06C2843.13,-10007.43 2227.1,-9994.85 1698.28,-9951.12"/>
<polygon fill="black" stroke="black" points="1698.41,-9947.62 1688.15,-9950.28 1697.83,-9954.59 1698.41,-9947.62"/>
</g>
<!-- expert_3_1 -->
<g id="node55" class="node">
<title>expert_3_1</title>
<polygon fill="#e6ffe6" stroke="black" points="2085,-9951 1706,-9951 1706,-9898 2085,-9898 2085,-9951"/>
<text text-anchor="middle" x="1895.5" y="-9935.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1895.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1895.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_3_1 -->
<g id="edge73" class="edge">
<title>moe_gate_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" d="M3127.12,-10008.19C2900.52,-10001.14 2470.57,-9984.56 2095.13,-9951.12"/>
<polygon fill="black" stroke="black" points="2095.43,-9947.63 2085.16,-9950.23 2094.8,-9954.61 2095.43,-9947.63"/>
</g>
<!-- expert_3_2 -->
<g id="node56" class="node">
<title>expert_3_2</title>
<polygon fill="#e6ffe6" stroke="black" points="2482,-9951 2103,-9951 2103,-9898 2482,-9898 2482,-9951"/>
<text text-anchor="middle" x="2292.5" y="-9935.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2292.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2292.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_3_2 -->
<g id="edge74" class="edge">
<title>moe_gate_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" d="M3127.28,-10002.64C2969.04,-9992.23 2718.47,-9974.25 2492.24,-9951.16"/>
<polygon fill="black" stroke="black" points="2492.47,-9947.67 2482.17,-9950.13 2491.76,-9954.63 2492.47,-9947.67"/>
</g>
<!-- expert_3_3 -->
<g id="node57" class="node">
<title>expert_3_3</title>
<polygon fill="#e6ffe6" stroke="black" points="2879,-9951 2500,-9951 2500,-9898 2879,-9898 2879,-9951"/>
<text text-anchor="middle" x="2689.5" y="-9935.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2689.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2689.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_3_3 -->
<g id="edge75" class="edge">
<title>moe_gate_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" d="M3127.35,-9989.41C3049.71,-9978.08 2955.7,-9964.36 2874.72,-9952.54"/>
<polygon fill="black" stroke="black" points="2874.81,-9949.01 2864.4,-9951.03 2873.79,-9955.94 2874.81,-9949.01"/>
</g>
<!-- expert_3_4 -->
<g id="node58" class="node">
<title>expert_3_4</title>
<polygon fill="#e6ffe6" stroke="black" points="3276,-9951 2897,-9951 2897,-9898 3276,-9898 3276,-9951"/>
<text text-anchor="middle" x="3086.5" y="-9935.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3086.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3086.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_3_4 -->
<g id="edge76" class="edge">
<title>moe_gate_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" d="M3227.14,-9986.98C3204.26,-9976.98 3177.85,-9965.44 3154.14,-9955.07"/>
<polygon fill="black" stroke="black" points="3155.43,-9951.81 3144.86,-9951.01 3152.62,-9958.23 3155.43,-9951.81"/>
</g>
<!-- expert_3_5 -->
<g id="node59" class="node">
<title>expert_3_5</title>
<polygon fill="#e6ffe6" stroke="black" points="3673,-9951 3294,-9951 3294,-9898 3673,-9898 3673,-9951"/>
<text text-anchor="middle" x="3483.5" y="-9935.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3483.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3483.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_3_5 -->
<g id="edge77" class="edge">
<title>moe_gate_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" d="M3343.57,-9986.98C3366.34,-9976.98 3392.61,-9965.44 3416.2,-9955.07"/>
<polygon fill="black" stroke="black" points="3417.69,-9958.24 3425.43,-9951.01 3414.87,-9951.83 3417.69,-9958.24"/>
</g>
<!-- expert_3_6 -->
<g id="node60" class="node">
<title>expert_3_6</title>
<polygon fill="#e6ffe6" stroke="black" points="4070,-9951 3691,-9951 3691,-9898 4070,-9898 4070,-9951"/>
<text text-anchor="middle" x="3880.5" y="-9935.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3880.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3880.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_3_6 -->
<g id="edge78" class="edge">
<title>moe_gate_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" d="M3443.78,-9989.36C3521.2,-9978.04 3614.86,-9964.34 3695.56,-9952.54"/>
<polygon fill="black" stroke="black" points="3696.45,-9955.95 3705.84,-9951.04 3695.44,-9949.02 3696.45,-9955.95"/>
</g>
<!-- expert_3_7 -->
<g id="node61" class="node">
<title>expert_3_7</title>
<polygon fill="#e6ffe6" stroke="black" points="4467,-9951 4088,-9951 4088,-9898 4467,-9898 4467,-9951"/>
<text text-anchor="middle" x="4277.5" y="-9935.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="4277.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4277.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_3_7 -->
<g id="edge79" class="edge">
<title>moe_gate_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" d="M3443.52,-10002.63C3601.56,-9992.21 3851.82,-9974.23 4077.77,-9951.16"/>
<polygon fill="black" stroke="black" points="4078.24,-9954.63 4087.83,-9950.13 4077.53,-9947.67 4078.24,-9954.63"/>
</g>
<!-- expert_combine_3 -->
<g id="node62" class="node">
<title>expert_combine_3</title>
<polygon fill="#fff0e6" stroke="black" points="3378,-9862 3191,-9862 3191,-9809 3378,-9809 3378,-9862"/>
<text text-anchor="middle" x="3284.5" y="-9846.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="3284.5" y="-9831.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3284.5" y="-9816.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- moe_gate_3&#45;&gt;expert_combine_3 -->
<g id="edge80" class="edge">
<title>moe_gate_3&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M3443.53,-10010.04C3759.38,-10004.35 4441.5,-9987.85 4476.5,-9951 4492.72,-9933.92 4492.72,-9915.08 4476.5,-9898 4439.3,-9858.83 3671.65,-9842.67 3388.35,-9838.02"/>
<polygon fill="black" stroke="black" points="3388.12,-9834.51 3378.07,-9837.85 3388.01,-9841.51 3388.12,-9834.51"/>
</g>
<!-- expert_3_0&#45;&gt;expert_combine_3 -->
<g id="edge81" class="edge">
<title>expert_3_0&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M1688.15,-9898.72C1690.95,-9898.47 1693.74,-9898.23 1696.5,-9898 2254.8,-9851.33 2926.53,-9840 3180.48,-9837.32"/>
<polygon fill="black" stroke="black" points="3180.84,-9840.81 3190.8,-9837.21 3180.77,-9833.81 3180.84,-9840.81"/>
</g>
<!-- expert_3_1&#45;&gt;expert_combine_3 -->
<g id="edge82" class="edge">
<title>expert_3_1&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M2085.16,-9898.77C2087.96,-9898.51 2090.74,-9898.25 2093.5,-9898 2494.51,-9861.88 2973.54,-9845.15 3180.66,-9839.19"/>
<polygon fill="black" stroke="black" points="3181.01,-9842.68 3190.91,-9838.9 3180.81,-9835.68 3181.01,-9842.68"/>
</g>
<!-- expert_3_2&#45;&gt;expert_combine_3 -->
<g id="edge83" class="edge">
<title>expert_3_2&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M2482.17,-9898.87C2484.96,-9898.58 2487.74,-9898.28 2490.5,-9898 2737.54,-9872.54 3028.81,-9852.53 3180.61,-9842.86"/>
<polygon fill="black" stroke="black" points="3181.1,-9846.33 3190.85,-9842.21 3180.65,-9839.35 3181.1,-9846.33"/>
</g>
<!-- expert_3_3&#45;&gt;expert_combine_3 -->
<g id="edge84" class="edge">
<title>expert_3_3&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M2864,-9897.98C2966.85,-9882.95 3093.51,-9864.43 3180.78,-9851.67"/>
<polygon fill="black" stroke="black" points="3181.3,-9855.13 3190.69,-9850.22 3180.29,-9848.2 3181.3,-9855.13"/>
</g>
<!-- expert_3_4&#45;&gt;expert_combine_3 -->
<g id="edge85" class="edge">
<title>expert_3_4&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M3144.57,-9897.98C3167.34,-9887.98 3193.61,-9876.44 3217.2,-9866.07"/>
<polygon fill="black" stroke="black" points="3218.69,-9869.24 3226.43,-9862.01 3215.87,-9862.83 3218.69,-9869.24"/>
</g>
<!-- expert_3_5&#45;&gt;expert_combine_3 -->
<g id="edge86" class="edge">
<title>expert_3_5&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M3425.14,-9897.98C3402.26,-9887.98 3375.85,-9876.44 3352.14,-9866.07"/>
<polygon fill="black" stroke="black" points="3353.43,-9862.81 3342.86,-9862.01 3350.62,-9869.23 3353.43,-9862.81"/>
</g>
<!-- expert_3_6&#45;&gt;expert_combine_3 -->
<g id="edge87" class="edge">
<title>expert_3_6&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M3705.71,-9897.98C3602.52,-9882.92 3475.41,-9864.37 3387.97,-9851.6"/>
<polygon fill="black" stroke="black" points="3388.45,-9848.14 3378.04,-9850.16 3387.43,-9855.06 3388.45,-9848.14"/>
</g>
<!-- expert_3_7&#45;&gt;expert_combine_3 -->
<g id="edge88" class="edge">
<title>expert_3_7&#45;&gt;expert_combine_3</title>
<path fill="none" stroke="black" d="M4087.83,-9898.87C4085.04,-9898.58 4082.26,-9898.28 4079.5,-9898 3832.15,-9872.52 3540.52,-9852.52 3388.52,-9842.85"/>
<polygon fill="black" stroke="black" points="3388.46,-9839.34 3378.26,-9842.2 3388.02,-9846.33 3388.46,-9839.34"/>
</g>
<!-- expert_out_3 -->
<g id="node63" class="node">
<title>expert_out_3</title>
<polygon fill="#fff0e6" stroke="black" points="3891,-9773 3512,-9773 3512,-9720 3891,-9720 3891,-9773"/>
<text text-anchor="middle" x="3701.5" y="-9757.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="3701.5" y="-9742.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3701.5" y="-9727.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_combine_3&#45;&gt;expert_out_3 -->
<g id="edge89" class="edge">
<title>expert_combine_3&#45;&gt;expert_out_3</title>
<path fill="none" stroke="black" d="M3378.08,-9814.98C3434.38,-9803.23 3506.94,-9788.09 3569.06,-9775.13"/>
<polygon fill="black" stroke="black" points="3569.86,-9778.54 3578.93,-9773.07 3568.43,-9771.69 3569.86,-9778.54"/>
</g>
<!-- expert_out_3&#45;&gt;residual2_3 -->
<g id="edge90" class="edge">
<title>expert_out_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M3891.09,-9724.16C4042.28,-9707.15 4248.33,-9683.96 4370.77,-9670.17"/>
<polygon fill="black" stroke="black" points="4371.35,-9673.63 4380.89,-9669.04 4370.56,-9666.68 4371.35,-9673.63"/>
</g>
<!-- residual1_4 -->
<g id="node65" class="node">
<title>residual1_4</title>
<polygon fill="#f0f8ff" stroke="black" points="4738,-9484 4551,-9484 4551,-9431 4738,-9431 4738,-9484"/>
<text text-anchor="middle" x="4644.5" y="-9468.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4644.5" y="-9453.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4644.5" y="-9438.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- comm_3_4&#45;&gt;residual1_4 -->
<g id="edge92" class="edge">
<title>comm_3_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M4531.58,-9523.59C4550.9,-9512.46 4572.38,-9500.07 4591.38,-9489.12"/>
<polygon fill="black" stroke="black" points="4593.29,-9492.06 4600.2,-9484.04 4589.79,-9486 4593.29,-9492.06"/>
</g>
<!-- ln2_4 -->
<g id="node72" class="node">
<title>ln2_4</title>
<polygon fill="#ffe4e1" stroke="black" points="4678,-9395 4491,-9395 4491,-9342 4678,-9342 4678,-9395"/>
<text text-anchor="middle" x="4584.5" y="-9379.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="4584.5" y="-9364.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4584.5" y="-9349.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge99" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M4626.82,-9430.87C4620.95,-9422.36 4614.33,-9412.75 4608.09,-9403.7"/>
<polygon fill="black" stroke="black" points="4610.82,-9401.49 4602.26,-9395.25 4605.05,-9405.47 4610.82,-9401.49"/>
</g>
<!-- residual2_4 -->
<g id="node73" class="node">
<title>residual2_4</title>
<polygon fill="#f0f8ff" stroke="black" points="5304,-8950 5117,-8950 5117,-8897 5304,-8897 5304,-8950"/>
<text text-anchor="middle" x="5210.5" y="-8934.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5210.5" y="-8919.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5210.5" y="-8904.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- residual1_4&#45;&gt;residual2_4 -->
<g id="edge100" class="edge">
<title>residual1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M4738.26,-9449.59C4912.45,-9434.17 5268.5,-9389.33 5268.5,-9280.5 5268.5,-9280.5 5268.5,-9280.5 5268.5,-9100.5 5268.5,-9049.48 5246.24,-8994.13 5229.3,-8959.39"/>
<polygon fill="black" stroke="black" points="5232.29,-8957.54 5224.69,-8950.16 5226.03,-8960.67 5232.29,-8957.54"/>
</g>
<!-- ln1_4 -->
<g id="node66" class="node">
<title>ln1_4</title>
<polygon fill="#ffe4e1" stroke="black" points="4908,-10040 4721,-10040 4721,-9987 4908,-9987 4908,-10040"/>
<text text-anchor="middle" x="4814.5" y="-10024.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="4814.5" y="-10009.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4814.5" y="-9994.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_qkv_4 -->
<g id="node67" class="node">
<title>attn_qkv_4</title>
<polygon fill="#ffe6e6" stroke="black" points="5010.5,-9951 4618.5,-9951 4618.5,-9898 5010.5,-9898 5010.5,-9951"/>
<text text-anchor="middle" x="4814.5" y="-9935.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="4814.5" y="-9920.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="4814.5" y="-9905.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- ln1_4&#45;&gt;attn_qkv_4 -->
<g id="edge93" class="edge">
<title>ln1_4&#45;&gt;attn_qkv_4</title>
<path fill="none" stroke="black" d="M4814.5,-9986.87C4814.5,-9978.89 4814.5,-9969.93 4814.5,-9961.38"/>
<polygon fill="black" stroke="black" points="4818,-9961.25 4814.5,-9951.25 4811,-9961.25 4818,-9961.25"/>
</g>
<!-- attn_score_4 -->
<g id="node68" class="node">
<title>attn_score_4</title>
<polygon fill="#ffe6e6" stroke="black" points="4896.5,-9862 4732.5,-9862 4732.5,-9809 4896.5,-9809 4896.5,-9862"/>
<text text-anchor="middle" x="4814.5" y="-9846.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="4814.5" y="-9831.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="4814.5" y="-9816.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_qkv_4&#45;&gt;attn_score_4 -->
<g id="edge94" class="edge">
<title>attn_qkv_4&#45;&gt;attn_score_4</title>
<path fill="none" stroke="black" d="M4814.5,-9897.87C4814.5,-9889.89 4814.5,-9880.93 4814.5,-9872.38"/>
<polygon fill="black" stroke="black" points="4818,-9872.25 4814.5,-9862.25 4811,-9872.25 4818,-9872.25"/>
</g>
<!-- attn_weight_4 -->
<g id="node69" class="node">
<title>attn_weight_4</title>
<polygon fill="#ffe6e6" stroke="black" points="4896.5,-9773 4732.5,-9773 4732.5,-9720 4896.5,-9720 4896.5,-9773"/>
<text text-anchor="middle" x="4814.5" y="-9757.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="4814.5" y="-9742.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="4814.5" y="-9727.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_score_4&#45;&gt;attn_weight_4 -->
<g id="edge95" class="edge">
<title>attn_score_4&#45;&gt;attn_weight_4</title>
<path fill="none" stroke="black" d="M4814.5,-9808.87C4814.5,-9800.89 4814.5,-9791.93 4814.5,-9783.38"/>
<polygon fill="black" stroke="black" points="4818,-9783.25 4814.5,-9773.25 4811,-9783.25 4818,-9783.25"/>
</g>
<!-- attn_context_4 -->
<g id="node70" class="node">
<title>attn_context_4</title>
<polygon fill="#ffe6e6" stroke="black" points="4908,-9684 4721,-9684 4721,-9631 4908,-9631 4908,-9684"/>
<text text-anchor="middle" x="4814.5" y="-9668.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="4814.5" y="-9653.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4814.5" y="-9638.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_weight_4&#45;&gt;attn_context_4 -->
<g id="edge96" class="edge">
<title>attn_weight_4&#45;&gt;attn_context_4</title>
<path fill="none" stroke="black" d="M4814.5,-9719.87C4814.5,-9711.89 4814.5,-9702.93 4814.5,-9694.38"/>
<polygon fill="black" stroke="black" points="4818,-9694.25 4814.5,-9684.25 4811,-9694.25 4818,-9694.25"/>
</g>
<!-- attn_out_4 -->
<g id="node71" class="node">
<title>attn_out_4</title>
<polygon fill="#ffe6e6" stroke="black" points="5004,-9584 4625,-9584 4625,-9531 5004,-9531 5004,-9584"/>
<text text-anchor="middle" x="4814.5" y="-9568.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="4814.5" y="-9553.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4814.5" y="-9538.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_context_4&#45;&gt;attn_out_4 -->
<g id="edge97" class="edge">
<title>attn_context_4&#45;&gt;attn_out_4</title>
<path fill="none" stroke="black" d="M4814.5,-9630.75C4814.5,-9619.61 4814.5,-9606.38 4814.5,-9594.31"/>
<polygon fill="black" stroke="black" points="4818,-9594.08 4814.5,-9584.08 4811,-9594.08 4818,-9594.08"/>
</g>
<!-- attn_out_4&#45;&gt;residual1_4 -->
<g id="edge98" class="edge">
<title>attn_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M4769.83,-9530.75C4747.68,-9517.98 4720.76,-9502.46 4697.56,-9489.09"/>
<polygon fill="black" stroke="black" points="4699.28,-9486.04 4688.87,-9484.08 4695.78,-9492.1 4699.28,-9486.04"/>
</g>
<!-- moe_gate_4 -->
<g id="node74" class="node">
<title>moe_gate_4</title>
<polygon fill="#e6e6ff" stroke="black" points="4179.5,-9306 3863.5,-9306 3863.5,-9253 4179.5,-9253 4179.5,-9306"/>
<text text-anchor="middle" x="4021.5" y="-9290.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="4021.5" y="-9275.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="4021.5" y="-9260.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- ln2_4&#45;&gt;moe_gate_4 -->
<g id="edge101" class="edge">
<title>ln2_4&#45;&gt;moe_gate_4</title>
<path fill="none" stroke="black" d="M4490.9,-9353.04C4409.05,-9340.39 4288.2,-9321.71 4189.63,-9306.48"/>
<polygon fill="black" stroke="black" points="4189.97,-9302.99 4179.55,-9304.92 4188.9,-9309.91 4189.97,-9302.99"/>
</g>
<!-- comm_4_5 -->
<g id="node85" class="node">
<title>comm_4_5</title>
<ellipse fill="#f0e6ff" stroke="black" cx="5210.5" cy="-8823.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="5210.5" y="-8834.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="5210.5" y="-8819.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5210.5" y="-8804.8" font-family="Arial" font-size="14.00">GPU: 3 → GPU: 4</text>
</g>
<!-- residual2_4&#45;&gt;comm_4_5 -->
<g id="edge121" class="edge">
<title>residual2_4&#45;&gt;comm_4_5</title>
<path fill="none" stroke="black" d="M5210.5,-8896.75C5210.5,-8888.93 5210.5,-8880.07 5210.5,-8871.31"/>
<polygon fill="black" stroke="black" points="5214,-8871.13 5210.5,-8861.13 5207,-8871.13 5214,-8871.13"/>
</g>
<!-- expert_4_0 -->
<g id="node75" class="node">
<title>expert_4_0</title>
<polygon fill="#e6ffe6" stroke="black" points="2424,-9217 2045,-9217 2045,-9164 2424,-9164 2424,-9217"/>
<text text-anchor="middle" x="2234.5" y="-9201.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2234.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2234.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_4_0 -->
<g id="edge102" class="edge">
<title>moe_gate_4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" d="M3863.34,-9277.06C3579.13,-9273.43 2963.1,-9260.85 2434.28,-9217.12"/>
<polygon fill="black" stroke="black" points="2434.41,-9213.62 2424.15,-9216.28 2433.83,-9220.59 2434.41,-9213.62"/>
</g>
<!-- expert_4_1 -->
<g id="node76" class="node">
<title>expert_4_1</title>
<polygon fill="#e6ffe6" stroke="black" points="2821,-9217 2442,-9217 2442,-9164 2821,-9164 2821,-9217"/>
<text text-anchor="middle" x="2631.5" y="-9201.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2631.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2631.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_4_1 -->
<g id="edge103" class="edge">
<title>moe_gate_4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" d="M3863.26,-9274.15C3636.85,-9267.06 3207.26,-9250.43 2831.05,-9217.02"/>
<polygon fill="black" stroke="black" points="2831.33,-9213.53 2821.06,-9216.12 2830.71,-9220.5 2831.33,-9213.53"/>
</g>
<!-- expert_4_2 -->
<g id="node77" class="node">
<title>expert_4_2</title>
<polygon fill="#e6ffe6" stroke="black" points="3218,-9217 2839,-9217 2839,-9164 3218,-9164 3218,-9217"/>
<text text-anchor="middle" x="3028.5" y="-9201.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3028.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3028.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_4_2 -->
<g id="edge104" class="edge">
<title>moe_gate_4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" d="M3863.49,-9268.6C3705.45,-9258.16 3455.19,-9240.16 3228.18,-9217.05"/>
<polygon fill="black" stroke="black" points="3228.37,-9213.55 3218.07,-9216.01 3227.66,-9220.51 3228.37,-9213.55"/>
</g>
<!-- expert_4_3 -->
<g id="node78" class="node">
<title>expert_4_3</title>
<polygon fill="#e6ffe6" stroke="black" points="3615,-9217 3236,-9217 3236,-9164 3615,-9164 3615,-9217"/>
<text text-anchor="middle" x="3425.5" y="-9201.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3425.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3425.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_4_3 -->
<g id="edge105" class="edge">
<title>moe_gate_4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" d="M3863.35,-9255.41C3785.71,-9244.08 3691.7,-9230.36 3610.72,-9218.54"/>
<polygon fill="black" stroke="black" points="3610.81,-9215.01 3600.4,-9217.03 3609.79,-9221.94 3610.81,-9215.01"/>
</g>
<!-- expert_4_4 -->
<g id="node79" class="node">
<title>expert_4_4</title>
<polygon fill="#e6ffe6" stroke="black" points="4012,-9217 3633,-9217 3633,-9164 4012,-9164 4012,-9217"/>
<text text-anchor="middle" x="3822.5" y="-9201.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3822.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3822.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_4_4 -->
<g id="edge106" class="edge">
<title>moe_gate_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" d="M3963.14,-9252.98C3940.26,-9242.98 3913.85,-9231.44 3890.14,-9221.07"/>
<polygon fill="black" stroke="black" points="3891.43,-9217.81 3880.86,-9217.01 3888.62,-9224.23 3891.43,-9217.81"/>
</g>
<!-- expert_4_5 -->
<g id="node80" class="node">
<title>expert_4_5</title>
<polygon fill="#e6ffe6" stroke="black" points="4409,-9217 4030,-9217 4030,-9164 4409,-9164 4409,-9217"/>
<text text-anchor="middle" x="4219.5" y="-9201.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4219.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4219.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_4_5 -->
<g id="edge107" class="edge">
<title>moe_gate_4&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" d="M4079.57,-9252.98C4102.34,-9242.98 4128.61,-9231.44 4152.2,-9221.07"/>
<polygon fill="black" stroke="black" points="4153.69,-9224.24 4161.43,-9217.01 4150.87,-9217.83 4153.69,-9224.24"/>
</g>
<!-- expert_4_6 -->
<g id="node81" class="node">
<title>expert_4_6</title>
<polygon fill="#e6ffe6" stroke="black" points="4806,-9217 4427,-9217 4427,-9164 4806,-9164 4806,-9217"/>
<text text-anchor="middle" x="4616.5" y="-9201.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4616.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4616.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_4_6 -->
<g id="edge108" class="edge">
<title>moe_gate_4&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" d="M4179.78,-9255.36C4257.2,-9244.04 4350.86,-9230.34 4431.56,-9218.54"/>
<polygon fill="black" stroke="black" points="4432.45,-9221.95 4441.84,-9217.04 4431.44,-9215.02 4432.45,-9221.95"/>
</g>
<!-- expert_4_7 -->
<g id="node82" class="node">
<title>expert_4_7</title>
<polygon fill="#e6ffe6" stroke="black" points="5203,-9217 4824,-9217 4824,-9164 5203,-9164 5203,-9217"/>
<text text-anchor="middle" x="5013.5" y="-9201.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5013.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5013.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_4_7 -->
<g id="edge109" class="edge">
<title>moe_gate_4&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" d="M4179.52,-9268.63C4337.56,-9258.21 4587.82,-9240.23 4813.77,-9217.16"/>
<polygon fill="black" stroke="black" points="4814.24,-9220.63 4823.83,-9216.13 4813.53,-9213.67 4814.24,-9220.63"/>
</g>
<!-- expert_combine_4 -->
<g id="node83" class="node">
<title>expert_combine_4</title>
<polygon fill="#fff0e6" stroke="black" points="4114,-9128 3927,-9128 3927,-9075 4114,-9075 4114,-9128"/>
<text text-anchor="middle" x="4020.5" y="-9112.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="4020.5" y="-9097.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4020.5" y="-9082.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- moe_gate_4&#45;&gt;expert_combine_4 -->
<g id="edge110" class="edge">
<title>moe_gate_4&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M4179.53,-9276.04C4495.38,-9270.35 5177.5,-9253.85 5212.5,-9217 5228.72,-9199.92 5228.72,-9181.08 5212.5,-9164 5175.3,-9124.83 4407.65,-9108.67 4124.35,-9104.02"/>
<polygon fill="black" stroke="black" points="4124.12,-9100.51 4114.07,-9103.85 4124.01,-9107.51 4124.12,-9100.51"/>
</g>
<!-- expert_4_0&#45;&gt;expert_combine_4 -->
<g id="edge111" class="edge">
<title>expert_4_0&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M2424.15,-9164.72C2426.95,-9164.47 2429.74,-9164.23 2432.5,-9164 2990.8,-9117.33 3662.53,-9106 3916.48,-9103.32"/>
<polygon fill="black" stroke="black" points="3916.84,-9106.81 3926.8,-9103.21 3916.77,-9099.81 3916.84,-9106.81"/>
</g>
<!-- expert_4_1&#45;&gt;expert_combine_4 -->
<g id="edge112" class="edge">
<title>expert_4_1&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M2821.06,-9164.88C2824.23,-9164.57 2827.38,-9164.28 2830.5,-9164 3231.19,-9128.03 3709.81,-9111.22 3916.74,-9105.22"/>
<polygon fill="black" stroke="black" points="3917.1,-9108.71 3926.99,-9104.92 3916.89,-9101.71 3917.1,-9108.71"/>
</g>
<!-- expert_4_2&#45;&gt;expert_combine_4 -->
<g id="edge113" class="edge">
<title>expert_4_2&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M3218.07,-9164.99C3221.24,-9164.65 3224.38,-9164.32 3227.5,-9164 3474.24,-9138.64 3765.13,-9118.59 3916.75,-9108.88"/>
<polygon fill="black" stroke="black" points="3917.22,-9112.36 3926.97,-9108.23 3916.77,-9105.38 3917.22,-9112.36"/>
</g>
<!-- expert_4_3&#45;&gt;expert_combine_4 -->
<g id="edge114" class="edge">
<title>expert_4_3&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M3600,-9163.98C3702.85,-9148.95 3829.51,-9130.43 3916.78,-9117.67"/>
<polygon fill="black" stroke="black" points="3917.3,-9121.13 3926.69,-9116.22 3916.29,-9114.2 3917.3,-9121.13"/>
</g>
<!-- expert_4_4&#45;&gt;expert_combine_4 -->
<g id="edge115" class="edge">
<title>expert_4_4&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M3880.57,-9163.98C3903.34,-9153.98 3929.61,-9142.44 3953.2,-9132.07"/>
<polygon fill="black" stroke="black" points="3954.69,-9135.24 3962.43,-9128.01 3951.87,-9128.83 3954.69,-9135.24"/>
</g>
<!-- expert_4_5&#45;&gt;expert_combine_4 -->
<g id="edge116" class="edge">
<title>expert_4_5&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M4161.14,-9163.98C4138.26,-9153.98 4111.85,-9142.44 4088.14,-9132.07"/>
<polygon fill="black" stroke="black" points="4089.43,-9128.81 4078.86,-9128.01 4086.62,-9135.23 4089.43,-9128.81"/>
</g>
<!-- expert_4_6&#45;&gt;expert_combine_4 -->
<g id="edge117" class="edge">
<title>expert_4_6&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M4441.71,-9163.98C4338.52,-9148.92 4211.41,-9130.37 4123.97,-9117.6"/>
<polygon fill="black" stroke="black" points="4124.45,-9114.14 4114.04,-9116.16 4123.43,-9121.06 4124.45,-9114.14"/>
</g>
<!-- expert_4_7&#45;&gt;expert_combine_4 -->
<g id="edge118" class="edge">
<title>expert_4_7&#45;&gt;expert_combine_4</title>
<path fill="none" stroke="black" d="M4823.83,-9164.87C4821.04,-9164.58 4818.26,-9164.28 4815.5,-9164 4568.15,-9138.52 4276.52,-9118.52 4124.52,-9108.85"/>
<polygon fill="black" stroke="black" points="4124.46,-9105.34 4114.26,-9108.2 4124.02,-9112.33 4124.46,-9105.34"/>
</g>
<!-- expert_out_4 -->
<g id="node84" class="node">
<title>expert_out_4</title>
<polygon fill="#fff0e6" stroke="black" points="4627,-9039 4248,-9039 4248,-8986 4627,-8986 4627,-9039"/>
<text text-anchor="middle" x="4437.5" y="-9023.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="4437.5" y="-9008.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4437.5" y="-8993.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_combine_4&#45;&gt;expert_out_4 -->
<g id="edge119" class="edge">
<title>expert_combine_4&#45;&gt;expert_out_4</title>
<path fill="none" stroke="black" d="M4114.08,-9080.98C4170.38,-9069.23 4242.94,-9054.09 4305.06,-9041.13"/>
<polygon fill="black" stroke="black" points="4305.86,-9044.54 4314.93,-9039.07 4304.43,-9037.69 4305.86,-9044.54"/>
</g>
<!-- expert_out_4&#45;&gt;residual2_4 -->
<g id="edge120" class="edge">
<title>expert_out_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M4627.09,-8990.16C4778.28,-8973.15 4984.33,-8949.96 5106.77,-8936.17"/>
<polygon fill="black" stroke="black" points="5107.35,-8939.63 5116.89,-8935.04 5106.56,-8932.68 5107.35,-8939.63"/>
</g>
<!-- residual1_5 -->
<g id="node86" class="node">
<title>residual1_5</title>
<polygon fill="#f0f8ff" stroke="black" points="5474,-8750 5287,-8750 5287,-8697 5474,-8697 5474,-8750"/>
<text text-anchor="middle" x="5380.5" y="-8734.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5380.5" y="-8719.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5380.5" y="-8704.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- comm_4_5&#45;&gt;residual1_5 -->
<g id="edge122" class="edge">
<title>comm_4_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M5267.58,-8789.59C5286.9,-8778.46 5308.38,-8766.07 5327.38,-8755.12"/>
<polygon fill="black" stroke="black" points="5329.29,-8758.06 5336.2,-8750.04 5325.79,-8752 5329.29,-8758.06"/>
</g>
<!-- ln2_5 -->
<g id="node93" class="node">
<title>ln2_5</title>
<polygon fill="#ffe4e1" stroke="black" points="4950,-8661 4763,-8661 4763,-8608 4950,-8608 4950,-8661"/>
<text text-anchor="middle" x="4856.5" y="-8645.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="4856.5" y="-8630.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4856.5" y="-8615.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge129" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M5286.82,-8706.95C5194.99,-8691.7 5055.31,-8668.51 4960.18,-8652.71"/>
<polygon fill="black" stroke="black" points="4960.69,-8649.25 4950.25,-8651.07 4959.54,-8656.16 4960.69,-8649.25"/>
</g>
<!-- residual2_5 -->
<g id="node94" class="node">
<title>residual2_5</title>
<polygon fill="#f0f8ff" stroke="black" points="5877,-8216 5690,-8216 5690,-8163 5877,-8163 5877,-8216"/>
<text text-anchor="middle" x="5783.5" y="-8200.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5783.5" y="-8185.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5783.5" y="-8170.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- residual1_5&#45;&gt;residual2_5 -->
<g id="edge130" class="edge">
<title>residual1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M5474.07,-8706.37C5608.82,-8680.45 5841.5,-8624.41 5841.5,-8546.5 5841.5,-8546.5 5841.5,-8546.5 5841.5,-8366.5 5841.5,-8315.48 5819.24,-8260.13 5802.3,-8225.39"/>
<polygon fill="black" stroke="black" points="5805.29,-8223.54 5797.69,-8216.16 5799.03,-8226.67 5805.29,-8223.54"/>
</g>
<!-- ln1_5 -->
<g id="node87" class="node">
<title>ln1_5</title>
<polygon fill="#ffe4e1" stroke="black" points="5644,-9306 5457,-9306 5457,-9253 5644,-9253 5644,-9306"/>
<text text-anchor="middle" x="5550.5" y="-9290.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="5550.5" y="-9275.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5550.5" y="-9260.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_qkv_5 -->
<g id="node88" class="node">
<title>attn_qkv_5</title>
<polygon fill="#ffe6e6" stroke="black" points="5746.5,-9217 5354.5,-9217 5354.5,-9164 5746.5,-9164 5746.5,-9217"/>
<text text-anchor="middle" x="5550.5" y="-9201.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="5550.5" y="-9186.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="5550.5" y="-9171.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- ln1_5&#45;&gt;attn_qkv_5 -->
<g id="edge123" class="edge">
<title>ln1_5&#45;&gt;attn_qkv_5</title>
<path fill="none" stroke="black" d="M5550.5,-9252.87C5550.5,-9244.89 5550.5,-9235.93 5550.5,-9227.38"/>
<polygon fill="black" stroke="black" points="5554,-9227.25 5550.5,-9217.25 5547,-9227.25 5554,-9227.25"/>
</g>
<!-- attn_score_5 -->
<g id="node89" class="node">
<title>attn_score_5</title>
<polygon fill="#ffe6e6" stroke="black" points="5632.5,-9128 5468.5,-9128 5468.5,-9075 5632.5,-9075 5632.5,-9128"/>
<text text-anchor="middle" x="5550.5" y="-9112.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="5550.5" y="-9097.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="5550.5" y="-9082.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_qkv_5&#45;&gt;attn_score_5 -->
<g id="edge124" class="edge">
<title>attn_qkv_5&#45;&gt;attn_score_5</title>
<path fill="none" stroke="black" d="M5550.5,-9163.87C5550.5,-9155.89 5550.5,-9146.93 5550.5,-9138.38"/>
<polygon fill="black" stroke="black" points="5554,-9138.25 5550.5,-9128.25 5547,-9138.25 5554,-9138.25"/>
</g>
<!-- attn_weight_5 -->
<g id="node90" class="node">
<title>attn_weight_5</title>
<polygon fill="#ffe6e6" stroke="black" points="5632.5,-9039 5468.5,-9039 5468.5,-8986 5632.5,-8986 5632.5,-9039"/>
<text text-anchor="middle" x="5550.5" y="-9023.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="5550.5" y="-9008.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="5550.5" y="-8993.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_score_5&#45;&gt;attn_weight_5 -->
<g id="edge125" class="edge">
<title>attn_score_5&#45;&gt;attn_weight_5</title>
<path fill="none" stroke="black" d="M5550.5,-9074.87C5550.5,-9066.89 5550.5,-9057.93 5550.5,-9049.38"/>
<polygon fill="black" stroke="black" points="5554,-9049.25 5550.5,-9039.25 5547,-9049.25 5554,-9049.25"/>
</g>
<!-- attn_context_5 -->
<g id="node91" class="node">
<title>attn_context_5</title>
<polygon fill="#ffe6e6" stroke="black" points="5644,-8950 5457,-8950 5457,-8897 5644,-8897 5644,-8950"/>
<text text-anchor="middle" x="5550.5" y="-8934.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="5550.5" y="-8919.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5550.5" y="-8904.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_weight_5&#45;&gt;attn_context_5 -->
<g id="edge126" class="edge">
<title>attn_weight_5&#45;&gt;attn_context_5</title>
<path fill="none" stroke="black" d="M5550.5,-8985.87C5550.5,-8977.89 5550.5,-8968.93 5550.5,-8960.38"/>
<polygon fill="black" stroke="black" points="5554,-8960.25 5550.5,-8950.25 5547,-8960.25 5554,-8960.25"/>
</g>
<!-- attn_out_5 -->
<g id="node92" class="node">
<title>attn_out_5</title>
<polygon fill="#ffe6e6" stroke="black" points="5740,-8850 5361,-8850 5361,-8797 5740,-8797 5740,-8850"/>
<text text-anchor="middle" x="5550.5" y="-8834.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="5550.5" y="-8819.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5550.5" y="-8804.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_context_5&#45;&gt;attn_out_5 -->
<g id="edge127" class="edge">
<title>attn_context_5&#45;&gt;attn_out_5</title>
<path fill="none" stroke="black" d="M5550.5,-8896.75C5550.5,-8885.61 5550.5,-8872.38 5550.5,-8860.31"/>
<polygon fill="black" stroke="black" points="5554,-8860.08 5550.5,-8850.08 5547,-8860.08 5554,-8860.08"/>
</g>
<!-- attn_out_5&#45;&gt;residual1_5 -->
<g id="edge128" class="edge">
<title>attn_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M5505.83,-8796.75C5483.68,-8783.98 5456.76,-8768.46 5433.56,-8755.09"/>
<polygon fill="black" stroke="black" points="5435.28,-8752.04 5424.87,-8750.08 5431.78,-8758.1 5435.28,-8752.04"/>
</g>
<!-- moe_gate_5 -->
<g id="node95" class="node">
<title>moe_gate_5</title>
<polygon fill="#e6e6ff" stroke="black" points="4752.5,-8572 4436.5,-8572 4436.5,-8519 4752.5,-8519 4752.5,-8572"/>
<text text-anchor="middle" x="4594.5" y="-8556.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="4594.5" y="-8541.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="4594.5" y="-8526.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- ln2_5&#45;&gt;moe_gate_5 -->
<g id="edge131" class="edge">
<title>ln2_5&#45;&gt;moe_gate_5</title>
<path fill="none" stroke="black" d="M4779.66,-8607.98C4748.74,-8597.72 4712.92,-8585.82 4681.08,-8575.25"/>
<polygon fill="black" stroke="black" points="4681.93,-8571.84 4671.34,-8572.01 4679.72,-8578.49 4681.93,-8571.84"/>
</g>
<!-- comm_5_6 -->
<g id="node106" class="node">
<title>comm_5_6</title>
<ellipse fill="#f0e6ff" stroke="black" cx="5783.5" cy="-8089.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="5783.5" y="-8100.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="5783.5" y="-8085.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5783.5" y="-8070.8" font-family="Arial" font-size="14.00">GPU: 4 → GPU: 5</text>
</g>
<!-- residual2_5&#45;&gt;comm_5_6 -->
<g id="edge151" class="edge">
<title>residual2_5&#45;&gt;comm_5_6</title>
<path fill="none" stroke="black" d="M5783.5,-8162.75C5783.5,-8154.93 5783.5,-8146.07 5783.5,-8137.31"/>
<polygon fill="black" stroke="black" points="5787,-8137.13 5783.5,-8127.13 5780,-8137.13 5787,-8137.13"/>
</g>
<!-- expert_5_0 -->
<g id="node96" class="node">
<title>expert_5_0</title>
<polygon fill="#e6ffe6" stroke="black" points="2997,-8483 2618,-8483 2618,-8430 2997,-8430 2997,-8483"/>
<text text-anchor="middle" x="2807.5" y="-8467.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2807.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2807.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_5_0 -->
<g id="edge132" class="edge">
<title>moe_gate_5&#45;&gt;expert_5_0</title>
<path fill="none" stroke="black" d="M4436.44,-8543.02C4152.42,-8539.33 3536.78,-8526.66 3007.19,-8483.02"/>
<polygon fill="black" stroke="black" points="3007.31,-8479.52 2997.05,-8482.18 3006.73,-8486.5 3007.31,-8479.52"/>
</g>
<!-- expert_5_1 -->
<g id="node97" class="node">
<title>expert_5_1</title>
<polygon fill="#e6ffe6" stroke="black" points="3394,-8483 3015,-8483 3015,-8430 3394,-8430 3394,-8483"/>
<text text-anchor="middle" x="3204.5" y="-8467.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3204.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3204.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_5_1 -->
<g id="edge133" class="edge">
<title>moe_gate_5&#45;&gt;expert_5_1</title>
<path fill="none" stroke="black" d="M4436.26,-8540.15C4209.85,-8533.06 3780.26,-8516.43 3404.05,-8483.02"/>
<polygon fill="black" stroke="black" points="3404.33,-8479.53 3394.06,-8482.12 3403.71,-8486.5 3404.33,-8479.53"/>
</g>
<!-- expert_5_2 -->
<g id="node98" class="node">
<title>expert_5_2</title>
<polygon fill="#e6ffe6" stroke="black" points="3791,-8483 3412,-8483 3412,-8430 3791,-8430 3791,-8483"/>
<text text-anchor="middle" x="3601.5" y="-8467.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3601.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3601.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_5_2 -->
<g id="edge134" class="edge">
<title>moe_gate_5&#45;&gt;expert_5_2</title>
<path fill="none" stroke="black" d="M4436.49,-8534.6C4278.45,-8524.16 4028.19,-8506.16 3801.18,-8483.05"/>
<polygon fill="black" stroke="black" points="3801.37,-8479.55 3791.07,-8482.01 3800.66,-8486.51 3801.37,-8479.55"/>
</g>
<!-- expert_5_3 -->
<g id="node99" class="node">
<title>expert_5_3</title>
<polygon fill="#e6ffe6" stroke="black" points="4188,-8483 3809,-8483 3809,-8430 4188,-8430 4188,-8483"/>
<text text-anchor="middle" x="3998.5" y="-8467.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3998.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3998.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_5_3 -->
<g id="edge135" class="edge">
<title>moe_gate_5&#45;&gt;expert_5_3</title>
<path fill="none" stroke="black" d="M4436.35,-8521.41C4358.71,-8510.08 4264.7,-8496.36 4183.72,-8484.54"/>
<polygon fill="black" stroke="black" points="4183.81,-8481.01 4173.4,-8483.03 4182.79,-8487.94 4183.81,-8481.01"/>
</g>
<!-- expert_5_4 -->
<g id="node100" class="node">
<title>expert_5_4</title>
<polygon fill="#e6ffe6" stroke="black" points="4585,-8483 4206,-8483 4206,-8430 4585,-8430 4585,-8483"/>
<text text-anchor="middle" x="4395.5" y="-8467.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4395.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4395.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_5_4 -->
<g id="edge136" class="edge">
<title>moe_gate_5&#45;&gt;expert_5_4</title>
<path fill="none" stroke="black" d="M4536.14,-8518.98C4513.26,-8508.98 4486.85,-8497.44 4463.14,-8487.07"/>
<polygon fill="black" stroke="black" points="4464.43,-8483.81 4453.86,-8483.01 4461.62,-8490.23 4464.43,-8483.81"/>
</g>
<!-- expert_5_5 -->
<g id="node101" class="node">
<title>expert_5_5</title>
<polygon fill="#e6ffe6" stroke="black" points="4982,-8483 4603,-8483 4603,-8430 4982,-8430 4982,-8483"/>
<text text-anchor="middle" x="4792.5" y="-8467.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4792.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4792.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_5_5 -->
<g id="edge137" class="edge">
<title>moe_gate_5&#45;&gt;expert_5_5</title>
<path fill="none" stroke="black" d="M4652.57,-8518.98C4675.34,-8508.98 4701.61,-8497.44 4725.2,-8487.07"/>
<polygon fill="black" stroke="black" points="4726.69,-8490.24 4734.43,-8483.01 4723.87,-8483.83 4726.69,-8490.24"/>
</g>
<!-- expert_5_6 -->
<g id="node102" class="node">
<title>expert_5_6</title>
<polygon fill="#e6ffe6" stroke="black" points="5379,-8483 5000,-8483 5000,-8430 5379,-8430 5379,-8483"/>
<text text-anchor="middle" x="5189.5" y="-8467.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5189.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5189.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_5_6 -->
<g id="edge138" class="edge">
<title>moe_gate_5&#45;&gt;expert_5_6</title>
<path fill="none" stroke="black" d="M4752.78,-8521.36C4830.2,-8510.04 4923.86,-8496.34 5004.56,-8484.54"/>
<polygon fill="black" stroke="black" points="5005.45,-8487.95 5014.84,-8483.04 5004.44,-8481.02 5005.45,-8487.95"/>
</g>
<!-- expert_5_7 -->
<g id="node103" class="node">
<title>expert_5_7</title>
<polygon fill="#e6ffe6" stroke="black" points="5776,-8483 5397,-8483 5397,-8430 5776,-8430 5776,-8483"/>
<text text-anchor="middle" x="5586.5" y="-8467.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5586.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5586.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_5_7 -->
<g id="edge139" class="edge">
<title>moe_gate_5&#45;&gt;expert_5_7</title>
<path fill="none" stroke="black" d="M4752.52,-8534.63C4910.56,-8524.21 5160.82,-8506.23 5386.77,-8483.16"/>
<polygon fill="black" stroke="black" points="5387.24,-8486.63 5396.83,-8482.13 5386.53,-8479.67 5387.24,-8486.63"/>
</g>
<!-- expert_combine_5 -->
<g id="node104" class="node">
<title>expert_combine_5</title>
<polygon fill="#fff0e6" stroke="black" points="4687,-8394 4500,-8394 4500,-8341 4687,-8341 4687,-8394"/>
<text text-anchor="middle" x="4593.5" y="-8378.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="4593.5" y="-8363.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4593.5" y="-8348.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- moe_gate_5&#45;&gt;expert_combine_5 -->
<g id="edge140" class="edge">
<title>moe_gate_5&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M4752.53,-8542.04C5068.38,-8536.35 5750.5,-8519.85 5785.5,-8483 5801.72,-8465.92 5801.72,-8447.08 5785.5,-8430 5748.3,-8390.83 4980.65,-8374.67 4697.35,-8370.02"/>
<polygon fill="black" stroke="black" points="4697.12,-8366.51 4687.07,-8369.85 4697.01,-8373.51 4697.12,-8366.51"/>
</g>
<!-- expert_5_0&#45;&gt;expert_combine_5 -->
<g id="edge141" class="edge">
<title>expert_5_0&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M2997.05,-8430.82C3000.23,-8430.53 3003.38,-8430.26 3006.5,-8430 3564.46,-8383.53 4235.77,-8372.09 4489.55,-8369.34"/>
<polygon fill="black" stroke="black" points="4489.9,-8372.84 4499.86,-8369.23 4489.83,-8365.84 4489.9,-8372.84"/>
</g>
<!-- expert_5_1&#45;&gt;expert_combine_5 -->
<g id="edge142" class="edge">
<title>expert_5_1&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M3394.06,-8430.88C3397.23,-8430.57 3400.38,-8430.28 3403.5,-8430 3804.19,-8394.03 4282.81,-8377.22 4489.74,-8371.22"/>
<polygon fill="black" stroke="black" points="4490.1,-8374.71 4499.99,-8370.92 4489.89,-8367.71 4490.1,-8374.71"/>
</g>
<!-- expert_5_2&#45;&gt;expert_combine_5 -->
<g id="edge143" class="edge">
<title>expert_5_2&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M3791.07,-8430.99C3794.24,-8430.65 3797.38,-8430.32 3800.5,-8430 4047.24,-8404.64 4338.13,-8384.59 4489.75,-8374.88"/>
<polygon fill="black" stroke="black" points="4490.22,-8378.36 4499.97,-8374.23 4489.77,-8371.38 4490.22,-8378.36"/>
</g>
<!-- expert_5_3&#45;&gt;expert_combine_5 -->
<g id="edge144" class="edge">
<title>expert_5_3&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M4173,-8429.98C4275.85,-8414.95 4402.51,-8396.43 4489.78,-8383.67"/>
<polygon fill="black" stroke="black" points="4490.3,-8387.13 4499.69,-8382.22 4489.29,-8380.2 4490.3,-8387.13"/>
</g>
<!-- expert_5_4&#45;&gt;expert_combine_5 -->
<g id="edge145" class="edge">
<title>expert_5_4&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M4453.57,-8429.98C4476.34,-8419.98 4502.61,-8408.44 4526.2,-8398.07"/>
<polygon fill="black" stroke="black" points="4527.69,-8401.24 4535.43,-8394.01 4524.87,-8394.83 4527.69,-8401.24"/>
</g>
<!-- expert_5_5&#45;&gt;expert_combine_5 -->
<g id="edge146" class="edge">
<title>expert_5_5&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M4734.14,-8429.98C4711.26,-8419.98 4684.85,-8408.44 4661.14,-8398.07"/>
<polygon fill="black" stroke="black" points="4662.43,-8394.81 4651.86,-8394.01 4659.62,-8401.23 4662.43,-8394.81"/>
</g>
<!-- expert_5_6&#45;&gt;expert_combine_5 -->
<g id="edge147" class="edge">
<title>expert_5_6&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M5014.71,-8429.98C4911.52,-8414.92 4784.41,-8396.37 4696.97,-8383.6"/>
<polygon fill="black" stroke="black" points="4697.45,-8380.14 4687.04,-8382.16 4696.43,-8387.06 4697.45,-8380.14"/>
</g>
<!-- expert_5_7&#45;&gt;expert_combine_5 -->
<g id="edge148" class="edge">
<title>expert_5_7&#45;&gt;expert_combine_5</title>
<path fill="none" stroke="black" d="M5396.83,-8430.87C5394.04,-8430.58 5391.26,-8430.28 5388.5,-8430 5141.15,-8404.52 4849.52,-8384.52 4697.52,-8374.85"/>
<polygon fill="black" stroke="black" points="4697.46,-8371.34 4687.26,-8374.2 4697.02,-8378.33 4697.46,-8371.34"/>
</g>
<!-- expert_out_5 -->
<g id="node105" class="node">
<title>expert_out_5</title>
<polygon fill="#fff0e6" stroke="black" points="5200,-8305 4821,-8305 4821,-8252 5200,-8252 5200,-8305"/>
<text text-anchor="middle" x="5010.5" y="-8289.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="5010.5" y="-8274.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5010.5" y="-8259.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_combine_5&#45;&gt;expert_out_5 -->
<g id="edge149" class="edge">
<title>expert_combine_5&#45;&gt;expert_out_5</title>
<path fill="none" stroke="black" d="M4687.08,-8346.98C4743.38,-8335.23 4815.94,-8320.09 4878.06,-8307.13"/>
<polygon fill="black" stroke="black" points="4878.86,-8310.54 4887.93,-8305.07 4877.43,-8303.69 4878.86,-8310.54"/>
</g>
<!-- expert_out_5&#45;&gt;residual2_5 -->
<g id="edge150" class="edge">
<title>expert_out_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M5200.09,-8256.16C5351.28,-8239.15 5557.33,-8215.96 5679.77,-8202.17"/>
<polygon fill="black" stroke="black" points="5680.35,-8205.63 5689.89,-8201.04 5679.56,-8198.68 5680.35,-8205.63"/>
</g>
<!-- residual1_6 -->
<g id="node107" class="node">
<title>residual1_6</title>
<polygon fill="#f0f8ff" stroke="black" points="6047,-8016 5860,-8016 5860,-7963 6047,-7963 6047,-8016"/>
<text text-anchor="middle" x="5953.5" y="-8000.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5953.5" y="-7985.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5953.5" y="-7970.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- comm_5_6&#45;&gt;residual1_6 -->
<g id="edge152" class="edge">
<title>comm_5_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M5840.58,-8055.59C5859.9,-8044.46 5881.38,-8032.07 5900.38,-8021.12"/>
<polygon fill="black" stroke="black" points="5902.29,-8024.06 5909.2,-8016.04 5898.79,-8018 5902.29,-8024.06"/>
</g>
<!-- ln2_6 -->
<g id="node114" class="node">
<title>ln2_6</title>
<polygon fill="#ffe4e1" stroke="black" points="5523,-7927 5336,-7927 5336,-7874 5523,-7874 5523,-7927"/>
<text text-anchor="middle" x="5429.5" y="-7911.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="5429.5" y="-7896.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5429.5" y="-7881.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge159" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M5859.82,-7972.95C5767.99,-7957.7 5628.31,-7934.51 5533.18,-7918.71"/>
<polygon fill="black" stroke="black" points="5533.69,-7915.25 5523.25,-7917.07 5532.54,-7922.16 5533.69,-7915.25"/>
</g>
<!-- residual2_6 -->
<g id="node115" class="node">
<title>residual2_6</title>
<polygon fill="#f0f8ff" stroke="black" points="6450,-7482 6263,-7482 6263,-7429 6450,-7429 6450,-7482"/>
<text text-anchor="middle" x="6356.5" y="-7466.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6356.5" y="-7451.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6356.5" y="-7436.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- residual1_6&#45;&gt;residual2_6 -->
<g id="edge160" class="edge">
<title>residual1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M6047.07,-7972.37C6181.82,-7946.45 6414.5,-7890.41 6414.5,-7812.5 6414.5,-7812.5 6414.5,-7812.5 6414.5,-7632.5 6414.5,-7581.48 6392.24,-7526.13 6375.3,-7491.39"/>
<polygon fill="black" stroke="black" points="6378.29,-7489.54 6370.69,-7482.16 6372.03,-7492.67 6378.29,-7489.54"/>
</g>
<!-- ln1_6 -->
<g id="node108" class="node">
<title>ln1_6</title>
<polygon fill="#ffe4e1" stroke="black" points="6217,-8572 6030,-8572 6030,-8519 6217,-8519 6217,-8572"/>
<text text-anchor="middle" x="6123.5" y="-8556.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6123.5" y="-8541.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6123.5" y="-8526.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_qkv_6 -->
<g id="node109" class="node">
<title>attn_qkv_6</title>
<polygon fill="#ffe6e6" stroke="black" points="6319.5,-8483 5927.5,-8483 5927.5,-8430 6319.5,-8430 6319.5,-8483"/>
<text text-anchor="middle" x="6123.5" y="-8467.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6123.5" y="-8452.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="6123.5" y="-8437.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- ln1_6&#45;&gt;attn_qkv_6 -->
<g id="edge153" class="edge">
<title>ln1_6&#45;&gt;attn_qkv_6</title>
<path fill="none" stroke="black" d="M6123.5,-8518.87C6123.5,-8510.89 6123.5,-8501.93 6123.5,-8493.38"/>
<polygon fill="black" stroke="black" points="6127,-8493.25 6123.5,-8483.25 6120,-8493.25 6127,-8493.25"/>
</g>
<!-- attn_score_6 -->
<g id="node110" class="node">
<title>attn_score_6</title>
<polygon fill="#ffe6e6" stroke="black" points="6205.5,-8394 6041.5,-8394 6041.5,-8341 6205.5,-8341 6205.5,-8394"/>
<text text-anchor="middle" x="6123.5" y="-8378.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6123.5" y="-8363.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="6123.5" y="-8348.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_qkv_6&#45;&gt;attn_score_6 -->
<g id="edge154" class="edge">
<title>attn_qkv_6&#45;&gt;attn_score_6</title>
<path fill="none" stroke="black" d="M6123.5,-8429.87C6123.5,-8421.89 6123.5,-8412.93 6123.5,-8404.38"/>
<polygon fill="black" stroke="black" points="6127,-8404.25 6123.5,-8394.25 6120,-8404.25 6127,-8404.25"/>
</g>
<!-- attn_weight_6 -->
<g id="node111" class="node">
<title>attn_weight_6</title>
<polygon fill="#ffe6e6" stroke="black" points="6205.5,-8305 6041.5,-8305 6041.5,-8252 6205.5,-8252 6205.5,-8305"/>
<text text-anchor="middle" x="6123.5" y="-8289.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="6123.5" y="-8274.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="6123.5" y="-8259.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_score_6&#45;&gt;attn_weight_6 -->
<g id="edge155" class="edge">
<title>attn_score_6&#45;&gt;attn_weight_6</title>
<path fill="none" stroke="black" d="M6123.5,-8340.87C6123.5,-8332.89 6123.5,-8323.93 6123.5,-8315.38"/>
<polygon fill="black" stroke="black" points="6127,-8315.25 6123.5,-8305.25 6120,-8315.25 6127,-8315.25"/>
</g>
<!-- attn_context_6 -->
<g id="node112" class="node">
<title>attn_context_6</title>
<polygon fill="#ffe6e6" stroke="black" points="6217,-8216 6030,-8216 6030,-8163 6217,-8163 6217,-8216"/>
<text text-anchor="middle" x="6123.5" y="-8200.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="6123.5" y="-8185.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6123.5" y="-8170.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_weight_6&#45;&gt;attn_context_6 -->
<g id="edge156" class="edge">
<title>attn_weight_6&#45;&gt;attn_context_6</title>
<path fill="none" stroke="black" d="M6123.5,-8251.87C6123.5,-8243.89 6123.5,-8234.93 6123.5,-8226.38"/>
<polygon fill="black" stroke="black" points="6127,-8226.25 6123.5,-8216.25 6120,-8226.25 6127,-8226.25"/>
</g>
<!-- attn_out_6 -->
<g id="node113" class="node">
<title>attn_out_6</title>
<polygon fill="#ffe6e6" stroke="black" points="6313,-8116 5934,-8116 5934,-8063 6313,-8063 6313,-8116"/>
<text text-anchor="middle" x="6123.5" y="-8100.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6123.5" y="-8085.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6123.5" y="-8070.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_context_6&#45;&gt;attn_out_6 -->
<g id="edge157" class="edge">
<title>attn_context_6&#45;&gt;attn_out_6</title>
<path fill="none" stroke="black" d="M6123.5,-8162.75C6123.5,-8151.61 6123.5,-8138.38 6123.5,-8126.31"/>
<polygon fill="black" stroke="black" points="6127,-8126.08 6123.5,-8116.08 6120,-8126.08 6127,-8126.08"/>
</g>
<!-- attn_out_6&#45;&gt;residual1_6 -->
<g id="edge158" class="edge">
<title>attn_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M6078.83,-8062.75C6056.68,-8049.98 6029.76,-8034.46 6006.56,-8021.09"/>
<polygon fill="black" stroke="black" points="6008.28,-8018.04 5997.87,-8016.08 6004.78,-8024.1 6008.28,-8018.04"/>
</g>
<!-- moe_gate_6 -->
<g id="node116" class="node">
<title>moe_gate_6</title>
<polygon fill="#e6e6ff" stroke="black" points="5325.5,-7838 5009.5,-7838 5009.5,-7785 5325.5,-7785 5325.5,-7838"/>
<text text-anchor="middle" x="5167.5" y="-7822.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="5167.5" y="-7807.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="5167.5" y="-7792.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- ln2_6&#45;&gt;moe_gate_6 -->
<g id="edge161" class="edge">
<title>ln2_6&#45;&gt;moe_gate_6</title>
<path fill="none" stroke="black" d="M5352.66,-7873.98C5321.74,-7863.72 5285.92,-7851.82 5254.08,-7841.25"/>
<polygon fill="black" stroke="black" points="5254.93,-7837.84 5244.34,-7838.01 5252.72,-7844.49 5254.93,-7837.84"/>
</g>
<!-- comm_6_7 -->
<g id="node127" class="node">
<title>comm_6_7</title>
<ellipse fill="#f0e6ff" stroke="black" cx="6356.5" cy="-7355.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="6356.5" y="-7366.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="6356.5" y="-7351.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6356.5" y="-7336.8" font-family="Arial" font-size="14.00">GPU: 5 → GPU: 6</text>
</g>
<!-- residual2_6&#45;&gt;comm_6_7 -->
<g id="edge181" class="edge">
<title>residual2_6&#45;&gt;comm_6_7</title>
<path fill="none" stroke="black" d="M6356.5,-7428.75C6356.5,-7420.93 6356.5,-7412.07 6356.5,-7403.31"/>
<polygon fill="black" stroke="black" points="6360,-7403.13 6356.5,-7393.13 6353,-7403.13 6360,-7403.13"/>
</g>
<!-- expert_6_0 -->
<g id="node117" class="node">
<title>expert_6_0</title>
<polygon fill="#e6ffe6" stroke="black" points="3570,-7749 3191,-7749 3191,-7696 3570,-7696 3570,-7749"/>
<text text-anchor="middle" x="3380.5" y="-7733.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3380.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3380.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_6_0 -->
<g id="edge162" class="edge">
<title>moe_gate_6&#45;&gt;expert_6_0</title>
<path fill="none" stroke="black" d="M5009.44,-7809.02C4725.42,-7805.33 4109.78,-7792.66 3580.19,-7749.02"/>
<polygon fill="black" stroke="black" points="3580.31,-7745.52 3570.05,-7748.18 3579.73,-7752.5 3580.31,-7745.52"/>
</g>
<!-- expert_6_1 -->
<g id="node118" class="node">
<title>expert_6_1</title>
<polygon fill="#e6ffe6" stroke="black" points="3967,-7749 3588,-7749 3588,-7696 3967,-7696 3967,-7749"/>
<text text-anchor="middle" x="3777.5" y="-7733.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3777.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3777.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_6_1 -->
<g id="edge163" class="edge">
<title>moe_gate_6&#45;&gt;expert_6_1</title>
<path fill="none" stroke="black" d="M5009.26,-7806.15C4782.85,-7799.06 4353.26,-7782.43 3977.05,-7749.02"/>
<polygon fill="black" stroke="black" points="3977.33,-7745.53 3967.06,-7748.12 3976.71,-7752.5 3977.33,-7745.53"/>
</g>
<!-- expert_6_2 -->
<g id="node119" class="node">
<title>expert_6_2</title>
<polygon fill="#e6ffe6" stroke="black" points="4364,-7749 3985,-7749 3985,-7696 4364,-7696 4364,-7749"/>
<text text-anchor="middle" x="4174.5" y="-7733.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4174.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4174.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_6_2 -->
<g id="edge164" class="edge">
<title>moe_gate_6&#45;&gt;expert_6_2</title>
<path fill="none" stroke="black" d="M5009.49,-7800.6C4851.45,-7790.16 4601.19,-7772.16 4374.18,-7749.05"/>
<polygon fill="black" stroke="black" points="4374.37,-7745.55 4364.07,-7748.01 4373.66,-7752.51 4374.37,-7745.55"/>
</g>
<!-- expert_6_3 -->
<g id="node120" class="node">
<title>expert_6_3</title>
<polygon fill="#e6ffe6" stroke="black" points="4761,-7749 4382,-7749 4382,-7696 4761,-7696 4761,-7749"/>
<text text-anchor="middle" x="4571.5" y="-7733.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4571.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4571.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_6_3 -->
<g id="edge165" class="edge">
<title>moe_gate_6&#45;&gt;expert_6_3</title>
<path fill="none" stroke="black" d="M5009.35,-7787.41C4931.71,-7776.08 4837.7,-7762.36 4756.72,-7750.54"/>
<polygon fill="black" stroke="black" points="4756.81,-7747.01 4746.4,-7749.03 4755.79,-7753.94 4756.81,-7747.01"/>
</g>
<!-- expert_6_4 -->
<g id="node121" class="node">
<title>expert_6_4</title>
<polygon fill="#e6ffe6" stroke="black" points="5158,-7749 4779,-7749 4779,-7696 5158,-7696 5158,-7749"/>
<text text-anchor="middle" x="4968.5" y="-7733.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4968.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4968.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_6_4 -->
<g id="edge166" class="edge">
<title>moe_gate_6&#45;&gt;expert_6_4</title>
<path fill="none" stroke="black" d="M5109.14,-7784.98C5086.26,-7774.98 5059.85,-7763.44 5036.14,-7753.07"/>
<polygon fill="black" stroke="black" points="5037.43,-7749.81 5026.86,-7749.01 5034.62,-7756.23 5037.43,-7749.81"/>
</g>
<!-- expert_6_5 -->
<g id="node122" class="node">
<title>expert_6_5</title>
<polygon fill="#e6ffe6" stroke="black" points="5555,-7749 5176,-7749 5176,-7696 5555,-7696 5555,-7749"/>
<text text-anchor="middle" x="5365.5" y="-7733.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="5365.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5365.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_6_5 -->
<g id="edge167" class="edge">
<title>moe_gate_6&#45;&gt;expert_6_5</title>
<path fill="none" stroke="black" d="M5225.57,-7784.98C5248.34,-7774.98 5274.61,-7763.44 5298.2,-7753.07"/>
<polygon fill="black" stroke="black" points="5299.69,-7756.24 5307.43,-7749.01 5296.87,-7749.83 5299.69,-7756.24"/>
</g>
<!-- expert_6_6 -->
<g id="node123" class="node">
<title>expert_6_6</title>
<polygon fill="#e6ffe6" stroke="black" points="5952,-7749 5573,-7749 5573,-7696 5952,-7696 5952,-7749"/>
<text text-anchor="middle" x="5762.5" y="-7733.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5762.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5762.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_6_6 -->
<g id="edge168" class="edge">
<title>moe_gate_6&#45;&gt;expert_6_6</title>
<path fill="none" stroke="black" d="M5325.78,-7787.36C5403.2,-7776.04 5496.86,-7762.34 5577.56,-7750.54"/>
<polygon fill="black" stroke="black" points="5578.45,-7753.95 5587.84,-7749.04 5577.44,-7747.02 5578.45,-7753.95"/>
</g>
<!-- expert_6_7 -->
<g id="node124" class="node">
<title>expert_6_7</title>
<polygon fill="#e6ffe6" stroke="black" points="6349,-7749 5970,-7749 5970,-7696 6349,-7696 6349,-7749"/>
<text text-anchor="middle" x="6159.5" y="-7733.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6159.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6159.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_6_7 -->
<g id="edge169" class="edge">
<title>moe_gate_6&#45;&gt;expert_6_7</title>
<path fill="none" stroke="black" d="M5325.52,-7800.63C5483.56,-7790.21 5733.82,-7772.23 5959.77,-7749.16"/>
<polygon fill="black" stroke="black" points="5960.24,-7752.63 5969.83,-7748.13 5959.53,-7745.67 5960.24,-7752.63"/>
</g>
<!-- expert_combine_6 -->
<g id="node125" class="node">
<title>expert_combine_6</title>
<polygon fill="#fff0e6" stroke="black" points="5260,-7660 5073,-7660 5073,-7607 5260,-7607 5260,-7660"/>
<text text-anchor="middle" x="5166.5" y="-7644.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="5166.5" y="-7629.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5166.5" y="-7614.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- moe_gate_6&#45;&gt;expert_combine_6 -->
<g id="edge170" class="edge">
<title>moe_gate_6&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M5325.53,-7808.04C5641.38,-7802.35 6323.5,-7785.85 6358.5,-7749 6374.72,-7731.92 6374.72,-7713.08 6358.5,-7696 6321.3,-7656.83 5553.65,-7640.67 5270.35,-7636.02"/>
<polygon fill="black" stroke="black" points="5270.12,-7632.51 5260.07,-7635.85 5270.01,-7639.51 5270.12,-7632.51"/>
</g>
<!-- expert_6_0&#45;&gt;expert_combine_6 -->
<g id="edge171" class="edge">
<title>expert_6_0&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M3570.05,-7696.82C3573.23,-7696.53 3576.38,-7696.26 3579.5,-7696 4137.46,-7649.53 4808.77,-7638.09 5062.55,-7635.34"/>
<polygon fill="black" stroke="black" points="5062.9,-7638.84 5072.86,-7635.23 5062.83,-7631.84 5062.9,-7638.84"/>
</g>
<!-- expert_6_1&#45;&gt;expert_combine_6 -->
<g id="edge172" class="edge">
<title>expert_6_1&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M3967.06,-7696.88C3970.23,-7696.57 3973.38,-7696.28 3976.5,-7696 4377.19,-7660.03 4855.81,-7643.22 5062.74,-7637.22"/>
<polygon fill="black" stroke="black" points="5063.1,-7640.71 5072.99,-7636.92 5062.89,-7633.71 5063.1,-7640.71"/>
</g>
<!-- expert_6_2&#45;&gt;expert_combine_6 -->
<g id="edge173" class="edge">
<title>expert_6_2&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M4364.07,-7696.99C4367.24,-7696.65 4370.38,-7696.32 4373.5,-7696 4620.24,-7670.64 4911.13,-7650.59 5062.75,-7640.88"/>
<polygon fill="black" stroke="black" points="5063.22,-7644.36 5072.97,-7640.23 5062.77,-7637.38 5063.22,-7644.36"/>
</g>
<!-- expert_6_3&#45;&gt;expert_combine_6 -->
<g id="edge174" class="edge">
<title>expert_6_3&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M4746,-7695.98C4848.85,-7680.95 4975.51,-7662.43 5062.78,-7649.67"/>
<polygon fill="black" stroke="black" points="5063.3,-7653.13 5072.69,-7648.22 5062.29,-7646.2 5063.3,-7653.13"/>
</g>
<!-- expert_6_4&#45;&gt;expert_combine_6 -->
<g id="edge175" class="edge">
<title>expert_6_4&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M5026.57,-7695.98C5049.34,-7685.98 5075.61,-7674.44 5099.2,-7664.07"/>
<polygon fill="black" stroke="black" points="5100.69,-7667.24 5108.43,-7660.01 5097.87,-7660.83 5100.69,-7667.24"/>
</g>
<!-- expert_6_5&#45;&gt;expert_combine_6 -->
<g id="edge176" class="edge">
<title>expert_6_5&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M5307.14,-7695.98C5284.26,-7685.98 5257.85,-7674.44 5234.14,-7664.07"/>
<polygon fill="black" stroke="black" points="5235.43,-7660.81 5224.86,-7660.01 5232.62,-7667.23 5235.43,-7660.81"/>
</g>
<!-- expert_6_6&#45;&gt;expert_combine_6 -->
<g id="edge177" class="edge">
<title>expert_6_6&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M5587.71,-7695.98C5484.52,-7680.92 5357.41,-7662.37 5269.97,-7649.6"/>
<polygon fill="black" stroke="black" points="5270.45,-7646.14 5260.04,-7648.16 5269.43,-7653.06 5270.45,-7646.14"/>
</g>
<!-- expert_6_7&#45;&gt;expert_combine_6 -->
<g id="edge178" class="edge">
<title>expert_6_7&#45;&gt;expert_combine_6</title>
<path fill="none" stroke="black" d="M5969.83,-7696.87C5967.04,-7696.58 5964.26,-7696.28 5961.5,-7696 5714.15,-7670.52 5422.52,-7650.52 5270.52,-7640.85"/>
<polygon fill="black" stroke="black" points="5270.46,-7637.34 5260.26,-7640.2 5270.02,-7644.33 5270.46,-7637.34"/>
</g>
<!-- expert_out_6 -->
<g id="node126" class="node">
<title>expert_out_6</title>
<polygon fill="#fff0e6" stroke="black" points="5773,-7571 5394,-7571 5394,-7518 5773,-7518 5773,-7571"/>
<text text-anchor="middle" x="5583.5" y="-7555.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="5583.5" y="-7540.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5583.5" y="-7525.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_combine_6&#45;&gt;expert_out_6 -->
<g id="edge179" class="edge">
<title>expert_combine_6&#45;&gt;expert_out_6</title>
<path fill="none" stroke="black" d="M5260.08,-7612.98C5316.38,-7601.23 5388.94,-7586.09 5451.06,-7573.13"/>
<polygon fill="black" stroke="black" points="5451.86,-7576.54 5460.93,-7571.07 5450.43,-7569.69 5451.86,-7576.54"/>
</g>
<!-- expert_out_6&#45;&gt;residual2_6 -->
<g id="edge180" class="edge">
<title>expert_out_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M5773.09,-7522.16C5924.28,-7505.15 6130.33,-7481.96 6252.77,-7468.17"/>
<polygon fill="black" stroke="black" points="6253.35,-7471.63 6262.89,-7467.04 6252.56,-7464.68 6253.35,-7471.63"/>
</g>
<!-- residual1_7 -->
<g id="node128" class="node">
<title>residual1_7</title>
<polygon fill="#f0f8ff" stroke="black" points="6620,-7282 6433,-7282 6433,-7229 6620,-7229 6620,-7282"/>
<text text-anchor="middle" x="6526.5" y="-7266.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6526.5" y="-7251.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6526.5" y="-7236.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- comm_6_7&#45;&gt;residual1_7 -->
<g id="edge182" class="edge">
<title>comm_6_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M6413.58,-7321.59C6432.9,-7310.46 6454.38,-7298.07 6473.38,-7287.12"/>
<polygon fill="black" stroke="black" points="6475.29,-7290.06 6482.2,-7282.04 6471.79,-7284 6475.29,-7290.06"/>
</g>
<!-- ln2_7 -->
<g id="node135" class="node">
<title>ln2_7</title>
<polygon fill="#ffe4e1" stroke="black" points="6560,-7193 6373,-7193 6373,-7140 6560,-7140 6560,-7193"/>
<text text-anchor="middle" x="6466.5" y="-7177.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6466.5" y="-7162.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6466.5" y="-7147.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge189" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M6508.82,-7228.87C6502.95,-7220.36 6496.33,-7210.75 6490.09,-7201.7"/>
<polygon fill="black" stroke="black" points="6492.82,-7199.49 6484.26,-7193.25 6487.05,-7203.47 6492.82,-7199.49"/>
</g>
<!-- residual2_7 -->
<g id="node136" class="node">
<title>residual2_7</title>
<polygon fill="#f0f8ff" stroke="black" points="7186,-6748 6999,-6748 6999,-6695 7186,-6695 7186,-6748"/>
<text text-anchor="middle" x="7092.5" y="-6732.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7092.5" y="-6717.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7092.5" y="-6702.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- residual1_7&#45;&gt;residual2_7 -->
<g id="edge190" class="edge">
<title>residual1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M6620.26,-7247.59C6794.45,-7232.17 7150.5,-7187.33 7150.5,-7078.5 7150.5,-7078.5 7150.5,-7078.5 7150.5,-6898.5 7150.5,-6847.48 7128.24,-6792.13 7111.3,-6757.39"/>
<polygon fill="black" stroke="black" points="7114.29,-6755.54 7106.69,-6748.16 7108.03,-6758.67 7114.29,-6755.54"/>
</g>
<!-- ln1_7 -->
<g id="node129" class="node">
<title>ln1_7</title>
<polygon fill="#ffe4e1" stroke="black" points="6790,-7838 6603,-7838 6603,-7785 6790,-7785 6790,-7838"/>
<text text-anchor="middle" x="6696.5" y="-7822.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6696.5" y="-7807.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6696.5" y="-7792.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_qkv_7 -->
<g id="node130" class="node">
<title>attn_qkv_7</title>
<polygon fill="#ffe6e6" stroke="black" points="6892.5,-7749 6500.5,-7749 6500.5,-7696 6892.5,-7696 6892.5,-7749"/>
<text text-anchor="middle" x="6696.5" y="-7733.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="6696.5" y="-7718.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="6696.5" y="-7703.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- ln1_7&#45;&gt;attn_qkv_7 -->
<g id="edge183" class="edge">
<title>ln1_7&#45;&gt;attn_qkv_7</title>
<path fill="none" stroke="black" d="M6696.5,-7784.87C6696.5,-7776.89 6696.5,-7767.93 6696.5,-7759.38"/>
<polygon fill="black" stroke="black" points="6700,-7759.25 6696.5,-7749.25 6693,-7759.25 6700,-7759.25"/>
</g>
<!-- attn_score_7 -->
<g id="node131" class="node">
<title>attn_score_7</title>
<polygon fill="#ffe6e6" stroke="black" points="6778.5,-7660 6614.5,-7660 6614.5,-7607 6778.5,-7607 6778.5,-7660"/>
<text text-anchor="middle" x="6696.5" y="-7644.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="6696.5" y="-7629.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="6696.5" y="-7614.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_qkv_7&#45;&gt;attn_score_7 -->
<g id="edge184" class="edge">
<title>attn_qkv_7&#45;&gt;attn_score_7</title>
<path fill="none" stroke="black" d="M6696.5,-7695.87C6696.5,-7687.89 6696.5,-7678.93 6696.5,-7670.38"/>
<polygon fill="black" stroke="black" points="6700,-7670.25 6696.5,-7660.25 6693,-7670.25 6700,-7670.25"/>
</g>
<!-- attn_weight_7 -->
<g id="node132" class="node">
<title>attn_weight_7</title>
<polygon fill="#ffe6e6" stroke="black" points="6778.5,-7571 6614.5,-7571 6614.5,-7518 6778.5,-7518 6778.5,-7571"/>
<text text-anchor="middle" x="6696.5" y="-7555.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="6696.5" y="-7540.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="6696.5" y="-7525.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_score_7&#45;&gt;attn_weight_7 -->
<g id="edge185" class="edge">
<title>attn_score_7&#45;&gt;attn_weight_7</title>
<path fill="none" stroke="black" d="M6696.5,-7606.87C6696.5,-7598.89 6696.5,-7589.93 6696.5,-7581.38"/>
<polygon fill="black" stroke="black" points="6700,-7581.25 6696.5,-7571.25 6693,-7581.25 6700,-7581.25"/>
</g>
<!-- attn_context_7 -->
<g id="node133" class="node">
<title>attn_context_7</title>
<polygon fill="#ffe6e6" stroke="black" points="6790,-7482 6603,-7482 6603,-7429 6790,-7429 6790,-7482"/>
<text text-anchor="middle" x="6696.5" y="-7466.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="6696.5" y="-7451.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6696.5" y="-7436.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_weight_7&#45;&gt;attn_context_7 -->
<g id="edge186" class="edge">
<title>attn_weight_7&#45;&gt;attn_context_7</title>
<path fill="none" stroke="black" d="M6696.5,-7517.87C6696.5,-7509.89 6696.5,-7500.93 6696.5,-7492.38"/>
<polygon fill="black" stroke="black" points="6700,-7492.25 6696.5,-7482.25 6693,-7492.25 6700,-7492.25"/>
</g>
<!-- attn_out_7 -->
<g id="node134" class="node">
<title>attn_out_7</title>
<polygon fill="#ffe6e6" stroke="black" points="6886,-7382 6507,-7382 6507,-7329 6886,-7329 6886,-7382"/>
<text text-anchor="middle" x="6696.5" y="-7366.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6696.5" y="-7351.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6696.5" y="-7336.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_context_7&#45;&gt;attn_out_7 -->
<g id="edge187" class="edge">
<title>attn_context_7&#45;&gt;attn_out_7</title>
<path fill="none" stroke="black" d="M6696.5,-7428.75C6696.5,-7417.61 6696.5,-7404.38 6696.5,-7392.31"/>
<polygon fill="black" stroke="black" points="6700,-7392.08 6696.5,-7382.08 6693,-7392.08 6700,-7392.08"/>
</g>
<!-- attn_out_7&#45;&gt;residual1_7 -->
<g id="edge188" class="edge">
<title>attn_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M6651.83,-7328.75C6629.68,-7315.98 6602.76,-7300.46 6579.56,-7287.09"/>
<polygon fill="black" stroke="black" points="6581.28,-7284.04 6570.87,-7282.08 6577.78,-7290.1 6581.28,-7284.04"/>
</g>
<!-- moe_gate_7 -->
<g id="node137" class="node">
<title>moe_gate_7</title>
<polygon fill="#e6e6ff" stroke="black" points="6061.5,-7104 5745.5,-7104 5745.5,-7051 6061.5,-7051 6061.5,-7104"/>
<text text-anchor="middle" x="5903.5" y="-7088.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="5903.5" y="-7073.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="5903.5" y="-7058.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- ln2_7&#45;&gt;moe_gate_7 -->
<g id="edge191" class="edge">
<title>ln2_7&#45;&gt;moe_gate_7</title>
<path fill="none" stroke="black" d="M6372.9,-7151.04C6291.05,-7138.39 6170.2,-7119.71 6071.63,-7104.48"/>
<polygon fill="black" stroke="black" points="6071.97,-7100.99 6061.55,-7102.92 6070.9,-7107.91 6071.97,-7100.99"/>
</g>
<!-- comm_7_8 -->
<g id="node148" class="node">
<title>comm_7_8</title>
<ellipse fill="#f0e6ff" stroke="black" cx="7092.5" cy="-6621.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="7092.5" y="-6632.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="7092.5" y="-6617.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7092.5" y="-6602.8" font-family="Arial" font-size="14.00">GPU: 6 → GPU: 7</text>
</g>
<!-- residual2_7&#45;&gt;comm_7_8 -->
<g id="edge211" class="edge">
<title>residual2_7&#45;&gt;comm_7_8</title>
<path fill="none" stroke="black" d="M7092.5,-6694.75C7092.5,-6686.93 7092.5,-6678.07 7092.5,-6669.31"/>
<polygon fill="black" stroke="black" points="7096,-6669.13 7092.5,-6659.13 7089,-6669.13 7096,-6669.13"/>
</g>
<!-- expert_7_0 -->
<g id="node138" class="node">
<title>expert_7_0</title>
<polygon fill="#e6ffe6" stroke="black" points="4306,-7015 3927,-7015 3927,-6962 4306,-6962 4306,-7015"/>
<text text-anchor="middle" x="4116.5" y="-6999.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4116.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4116.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_7_0 -->
<g id="edge192" class="edge">
<title>moe_gate_7&#45;&gt;expert_7_0</title>
<path fill="none" stroke="black" d="M5745.44,-7075.02C5461.42,-7071.33 4845.78,-7058.66 4316.19,-7015.02"/>
<polygon fill="black" stroke="black" points="4316.31,-7011.52 4306.05,-7014.18 4315.73,-7018.5 4316.31,-7011.52"/>
</g>
<!-- expert_7_1 -->
<g id="node139" class="node">
<title>expert_7_1</title>
<polygon fill="#e6ffe6" stroke="black" points="4703,-7015 4324,-7015 4324,-6962 4703,-6962 4703,-7015"/>
<text text-anchor="middle" x="4513.5" y="-6999.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4513.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4513.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_7_1 -->
<g id="edge193" class="edge">
<title>moe_gate_7&#45;&gt;expert_7_1</title>
<path fill="none" stroke="black" d="M5745.26,-7072.15C5518.85,-7065.06 5089.26,-7048.43 4713.05,-7015.02"/>
<polygon fill="black" stroke="black" points="4713.33,-7011.53 4703.06,-7014.12 4712.71,-7018.5 4713.33,-7011.53"/>
</g>
<!-- expert_7_2 -->
<g id="node140" class="node">
<title>expert_7_2</title>
<polygon fill="#e6ffe6" stroke="black" points="5100,-7015 4721,-7015 4721,-6962 5100,-6962 5100,-7015"/>
<text text-anchor="middle" x="4910.5" y="-6999.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4910.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4910.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_7_2 -->
<g id="edge194" class="edge">
<title>moe_gate_7&#45;&gt;expert_7_2</title>
<path fill="none" stroke="black" d="M5745.49,-7066.6C5587.45,-7056.16 5337.19,-7038.16 5110.18,-7015.05"/>
<polygon fill="black" stroke="black" points="5110.37,-7011.55 5100.07,-7014.01 5109.66,-7018.51 5110.37,-7011.55"/>
</g>
<!-- expert_7_3 -->
<g id="node141" class="node">
<title>expert_7_3</title>
<polygon fill="#e6ffe6" stroke="black" points="5497,-7015 5118,-7015 5118,-6962 5497,-6962 5497,-7015"/>
<text text-anchor="middle" x="5307.5" y="-6999.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5307.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5307.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_7_3 -->
<g id="edge195" class="edge">
<title>moe_gate_7&#45;&gt;expert_7_3</title>
<path fill="none" stroke="black" d="M5745.35,-7053.41C5667.71,-7042.08 5573.7,-7028.36 5492.72,-7016.54"/>
<polygon fill="black" stroke="black" points="5492.81,-7013.01 5482.4,-7015.03 5491.79,-7019.94 5492.81,-7013.01"/>
</g>
<!-- expert_7_4 -->
<g id="node142" class="node">
<title>expert_7_4</title>
<polygon fill="#e6ffe6" stroke="black" points="5894,-7015 5515,-7015 5515,-6962 5894,-6962 5894,-7015"/>
<text text-anchor="middle" x="5704.5" y="-6999.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="5704.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5704.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_7_4 -->
<g id="edge196" class="edge">
<title>moe_gate_7&#45;&gt;expert_7_4</title>
<path fill="none" stroke="black" d="M5845.14,-7050.98C5822.26,-7040.98 5795.85,-7029.44 5772.14,-7019.07"/>
<polygon fill="black" stroke="black" points="5773.43,-7015.81 5762.86,-7015.01 5770.62,-7022.23 5773.43,-7015.81"/>
</g>
<!-- expert_7_5 -->
<g id="node143" class="node">
<title>expert_7_5</title>
<polygon fill="#e6ffe6" stroke="black" points="6291,-7015 5912,-7015 5912,-6962 6291,-6962 6291,-7015"/>
<text text-anchor="middle" x="6101.5" y="-6999.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="6101.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6101.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_7_5 -->
<g id="edge197" class="edge">
<title>moe_gate_7&#45;&gt;expert_7_5</title>
<path fill="none" stroke="black" d="M5961.57,-7050.98C5984.34,-7040.98 6010.61,-7029.44 6034.2,-7019.07"/>
<polygon fill="black" stroke="black" points="6035.69,-7022.24 6043.43,-7015.01 6032.87,-7015.83 6035.69,-7022.24"/>
</g>
<!-- expert_7_6 -->
<g id="node144" class="node">
<title>expert_7_6</title>
<polygon fill="#e6ffe6" stroke="black" points="6688,-7015 6309,-7015 6309,-6962 6688,-6962 6688,-7015"/>
<text text-anchor="middle" x="6498.5" y="-6999.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6498.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6498.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_7_6 -->
<g id="edge198" class="edge">
<title>moe_gate_7&#45;&gt;expert_7_6</title>
<path fill="none" stroke="black" d="M6061.78,-7053.36C6139.2,-7042.04 6232.86,-7028.34 6313.56,-7016.54"/>
<polygon fill="black" stroke="black" points="6314.45,-7019.95 6323.84,-7015.04 6313.44,-7013.02 6314.45,-7019.95"/>
</g>
<!-- expert_7_7 -->
<g id="node145" class="node">
<title>expert_7_7</title>
<polygon fill="#e6ffe6" stroke="black" points="7085,-7015 6706,-7015 6706,-6962 7085,-6962 7085,-7015"/>
<text text-anchor="middle" x="6895.5" y="-6999.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="6895.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6895.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_7_7 -->
<g id="edge199" class="edge">
<title>moe_gate_7&#45;&gt;expert_7_7</title>
<path fill="none" stroke="black" d="M6061.52,-7066.63C6219.56,-7056.21 6469.82,-7038.23 6695.77,-7015.16"/>
<polygon fill="black" stroke="black" points="6696.24,-7018.63 6705.83,-7014.13 6695.53,-7011.67 6696.24,-7018.63"/>
</g>
<!-- expert_combine_7 -->
<g id="node146" class="node">
<title>expert_combine_7</title>
<polygon fill="#fff0e6" stroke="black" points="5996,-6926 5809,-6926 5809,-6873 5996,-6873 5996,-6926"/>
<text text-anchor="middle" x="5902.5" y="-6910.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="5902.5" y="-6895.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5902.5" y="-6880.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- moe_gate_7&#45;&gt;expert_combine_7 -->
<g id="edge200" class="edge">
<title>moe_gate_7&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M6061.53,-7074.04C6377.38,-7068.35 7059.5,-7051.85 7094.5,-7015 7110.72,-6997.92 7110.72,-6979.08 7094.5,-6962 7057.3,-6922.83 6289.65,-6906.67 6006.35,-6902.02"/>
<polygon fill="black" stroke="black" points="6006.12,-6898.51 5996.07,-6901.85 6006.01,-6905.51 6006.12,-6898.51"/>
</g>
<!-- expert_7_0&#45;&gt;expert_combine_7 -->
<g id="edge201" class="edge">
<title>expert_7_0&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M4306.05,-6962.82C4309.23,-6962.53 4312.38,-6962.26 4315.5,-6962 4873.46,-6915.53 5544.77,-6904.09 5798.55,-6901.34"/>
<polygon fill="black" stroke="black" points="5798.9,-6904.84 5808.86,-6901.23 5798.83,-6897.84 5798.9,-6904.84"/>
</g>
<!-- expert_7_1&#45;&gt;expert_combine_7 -->
<g id="edge202" class="edge">
<title>expert_7_1&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M4703.06,-6962.88C4706.23,-6962.57 4709.38,-6962.28 4712.5,-6962 5113.19,-6926.03 5591.81,-6909.22 5798.74,-6903.22"/>
<polygon fill="black" stroke="black" points="5799.1,-6906.71 5808.99,-6902.92 5798.89,-6899.71 5799.1,-6906.71"/>
</g>
<!-- expert_7_2&#45;&gt;expert_combine_7 -->
<g id="edge203" class="edge">
<title>expert_7_2&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M5100.07,-6962.99C5103.24,-6962.65 5106.38,-6962.32 5109.5,-6962 5356.24,-6936.64 5647.13,-6916.59 5798.75,-6906.88"/>
<polygon fill="black" stroke="black" points="5799.22,-6910.36 5808.97,-6906.23 5798.77,-6903.38 5799.22,-6910.36"/>
</g>
<!-- expert_7_3&#45;&gt;expert_combine_7 -->
<g id="edge204" class="edge">
<title>expert_7_3&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M5482,-6961.98C5584.85,-6946.95 5711.51,-6928.43 5798.78,-6915.67"/>
<polygon fill="black" stroke="black" points="5799.3,-6919.13 5808.69,-6914.22 5798.29,-6912.2 5799.3,-6919.13"/>
</g>
<!-- expert_7_4&#45;&gt;expert_combine_7 -->
<g id="edge205" class="edge">
<title>expert_7_4&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M5762.57,-6961.98C5785.34,-6951.98 5811.61,-6940.44 5835.2,-6930.07"/>
<polygon fill="black" stroke="black" points="5836.69,-6933.24 5844.43,-6926.01 5833.87,-6926.83 5836.69,-6933.24"/>
</g>
<!-- expert_7_5&#45;&gt;expert_combine_7 -->
<g id="edge206" class="edge">
<title>expert_7_5&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M6043.14,-6961.98C6020.26,-6951.98 5993.85,-6940.44 5970.14,-6930.07"/>
<polygon fill="black" stroke="black" points="5971.43,-6926.81 5960.86,-6926.01 5968.62,-6933.23 5971.43,-6926.81"/>
</g>
<!-- expert_7_6&#45;&gt;expert_combine_7 -->
<g id="edge207" class="edge">
<title>expert_7_6&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M6323.71,-6961.98C6220.52,-6946.92 6093.41,-6928.37 6005.97,-6915.6"/>
<polygon fill="black" stroke="black" points="6006.45,-6912.14 5996.04,-6914.16 6005.43,-6919.06 6006.45,-6912.14"/>
</g>
<!-- expert_7_7&#45;&gt;expert_combine_7 -->
<g id="edge208" class="edge">
<title>expert_7_7&#45;&gt;expert_combine_7</title>
<path fill="none" stroke="black" d="M6705.83,-6962.87C6703.04,-6962.58 6700.26,-6962.28 6697.5,-6962 6450.15,-6936.52 6158.52,-6916.52 6006.52,-6906.85"/>
<polygon fill="black" stroke="black" points="6006.46,-6903.34 5996.26,-6906.2 6006.02,-6910.33 6006.46,-6903.34"/>
</g>
<!-- expert_out_7 -->
<g id="node147" class="node">
<title>expert_out_7</title>
<polygon fill="#fff0e6" stroke="black" points="6509,-6837 6130,-6837 6130,-6784 6509,-6784 6509,-6837"/>
<text text-anchor="middle" x="6319.5" y="-6821.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="6319.5" y="-6806.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6319.5" y="-6791.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_combine_7&#45;&gt;expert_out_7 -->
<g id="edge209" class="edge">
<title>expert_combine_7&#45;&gt;expert_out_7</title>
<path fill="none" stroke="black" d="M5996.08,-6878.98C6052.38,-6867.23 6124.94,-6852.09 6187.06,-6839.13"/>
<polygon fill="black" stroke="black" points="6187.86,-6842.54 6196.93,-6837.07 6186.43,-6835.69 6187.86,-6842.54"/>
</g>
<!-- expert_out_7&#45;&gt;residual2_7 -->
<g id="edge210" class="edge">
<title>expert_out_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M6509.09,-6788.16C6660.28,-6771.15 6866.33,-6747.96 6988.77,-6734.17"/>
<polygon fill="black" stroke="black" points="6989.35,-6737.63 6998.89,-6733.04 6988.56,-6730.68 6989.35,-6737.63"/>
</g>
<!-- residual1_8 -->
<g id="node149" class="node">
<title>residual1_8</title>
<polygon fill="#f0f8ff" stroke="black" points="7356,-6548 7169,-6548 7169,-6495 7356,-6495 7356,-6548"/>
<text text-anchor="middle" x="7262.5" y="-6532.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7262.5" y="-6517.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7262.5" y="-6502.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- comm_7_8&#45;&gt;residual1_8 -->
<g id="edge212" class="edge">
<title>comm_7_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M7149.58,-6587.59C7168.9,-6576.46 7190.38,-6564.07 7209.38,-6553.12"/>
<polygon fill="black" stroke="black" points="7211.29,-6556.06 7218.2,-6548.04 7207.79,-6550 7211.29,-6556.06"/>
</g>
<!-- ln2_8 -->
<g id="node156" class="node">
<title>ln2_8</title>
<polygon fill="#ffe4e1" stroke="black" points="6832,-6459 6645,-6459 6645,-6406 6832,-6406 6832,-6459"/>
<text text-anchor="middle" x="6738.5" y="-6443.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6738.5" y="-6428.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6738.5" y="-6413.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge219" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M7168.82,-6504.95C7076.99,-6489.7 6937.31,-6466.51 6842.18,-6450.71"/>
<polygon fill="black" stroke="black" points="6842.69,-6447.25 6832.25,-6449.07 6841.54,-6454.16 6842.69,-6447.25"/>
</g>
<!-- residual2_8 -->
<g id="node157" class="node">
<title>residual2_8</title>
<polygon fill="#f0f8ff" stroke="black" points="7759,-6014 7572,-6014 7572,-5961 7759,-5961 7759,-6014"/>
<text text-anchor="middle" x="7665.5" y="-5998.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7665.5" y="-5983.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7665.5" y="-5968.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- residual1_8&#45;&gt;residual2_8 -->
<g id="edge220" class="edge">
<title>residual1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M7356.07,-6504.37C7490.82,-6478.45 7723.5,-6422.41 7723.5,-6344.5 7723.5,-6344.5 7723.5,-6344.5 7723.5,-6164.5 7723.5,-6113.48 7701.24,-6058.13 7684.3,-6023.39"/>
<polygon fill="black" stroke="black" points="7687.29,-6021.54 7679.69,-6014.16 7681.03,-6024.67 7687.29,-6021.54"/>
</g>
<!-- ln1_8 -->
<g id="node150" class="node">
<title>ln1_8</title>
<polygon fill="#ffe4e1" stroke="black" points="7526,-7104 7339,-7104 7339,-7051 7526,-7051 7526,-7104"/>
<text text-anchor="middle" x="7432.5" y="-7088.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7432.5" y="-7073.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7432.5" y="-7058.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_qkv_8 -->
<g id="node151" class="node">
<title>attn_qkv_8</title>
<polygon fill="#ffe6e6" stroke="black" points="7628.5,-7015 7236.5,-7015 7236.5,-6962 7628.5,-6962 7628.5,-7015"/>
<text text-anchor="middle" x="7432.5" y="-6999.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="7432.5" y="-6984.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="7432.5" y="-6969.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- ln1_8&#45;&gt;attn_qkv_8 -->
<g id="edge213" class="edge">
<title>ln1_8&#45;&gt;attn_qkv_8</title>
<path fill="none" stroke="black" d="M7432.5,-7050.87C7432.5,-7042.89 7432.5,-7033.93 7432.5,-7025.38"/>
<polygon fill="black" stroke="black" points="7436,-7025.25 7432.5,-7015.25 7429,-7025.25 7436,-7025.25"/>
</g>
<!-- attn_score_8 -->
<g id="node152" class="node">
<title>attn_score_8</title>
<polygon fill="#ffe6e6" stroke="black" points="7514.5,-6926 7350.5,-6926 7350.5,-6873 7514.5,-6873 7514.5,-6926"/>
<text text-anchor="middle" x="7432.5" y="-6910.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="7432.5" y="-6895.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="7432.5" y="-6880.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_qkv_8&#45;&gt;attn_score_8 -->
<g id="edge214" class="edge">
<title>attn_qkv_8&#45;&gt;attn_score_8</title>
<path fill="none" stroke="black" d="M7432.5,-6961.87C7432.5,-6953.89 7432.5,-6944.93 7432.5,-6936.38"/>
<polygon fill="black" stroke="black" points="7436,-6936.25 7432.5,-6926.25 7429,-6936.25 7436,-6936.25"/>
</g>
<!-- attn_weight_8 -->
<g id="node153" class="node">
<title>attn_weight_8</title>
<polygon fill="#ffe6e6" stroke="black" points="7514.5,-6837 7350.5,-6837 7350.5,-6784 7514.5,-6784 7514.5,-6837"/>
<text text-anchor="middle" x="7432.5" y="-6821.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="7432.5" y="-6806.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="7432.5" y="-6791.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_score_8&#45;&gt;attn_weight_8 -->
<g id="edge215" class="edge">
<title>attn_score_8&#45;&gt;attn_weight_8</title>
<path fill="none" stroke="black" d="M7432.5,-6872.87C7432.5,-6864.89 7432.5,-6855.93 7432.5,-6847.38"/>
<polygon fill="black" stroke="black" points="7436,-6847.25 7432.5,-6837.25 7429,-6847.25 7436,-6847.25"/>
</g>
<!-- attn_context_8 -->
<g id="node154" class="node">
<title>attn_context_8</title>
<polygon fill="#ffe6e6" stroke="black" points="7526,-6748 7339,-6748 7339,-6695 7526,-6695 7526,-6748"/>
<text text-anchor="middle" x="7432.5" y="-6732.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="7432.5" y="-6717.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7432.5" y="-6702.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_weight_8&#45;&gt;attn_context_8 -->
<g id="edge216" class="edge">
<title>attn_weight_8&#45;&gt;attn_context_8</title>
<path fill="none" stroke="black" d="M7432.5,-6783.87C7432.5,-6775.89 7432.5,-6766.93 7432.5,-6758.38"/>
<polygon fill="black" stroke="black" points="7436,-6758.25 7432.5,-6748.25 7429,-6758.25 7436,-6758.25"/>
</g>
<!-- attn_out_8 -->
<g id="node155" class="node">
<title>attn_out_8</title>
<polygon fill="#ffe6e6" stroke="black" points="7622,-6648 7243,-6648 7243,-6595 7622,-6595 7622,-6648"/>
<text text-anchor="middle" x="7432.5" y="-6632.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="7432.5" y="-6617.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7432.5" y="-6602.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_context_8&#45;&gt;attn_out_8 -->
<g id="edge217" class="edge">
<title>attn_context_8&#45;&gt;attn_out_8</title>
<path fill="none" stroke="black" d="M7432.5,-6694.75C7432.5,-6683.61 7432.5,-6670.38 7432.5,-6658.31"/>
<polygon fill="black" stroke="black" points="7436,-6658.08 7432.5,-6648.08 7429,-6658.08 7436,-6658.08"/>
</g>
<!-- attn_out_8&#45;&gt;residual1_8 -->
<g id="edge218" class="edge">
<title>attn_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M7387.83,-6594.75C7365.68,-6581.98 7338.76,-6566.46 7315.56,-6553.09"/>
<polygon fill="black" stroke="black" points="7317.28,-6550.04 7306.87,-6548.08 7313.78,-6556.1 7317.28,-6550.04"/>
</g>
<!-- moe_gate_8 -->
<g id="node158" class="node">
<title>moe_gate_8</title>
<polygon fill="#e6e6ff" stroke="black" points="6634.5,-6370 6318.5,-6370 6318.5,-6317 6634.5,-6317 6634.5,-6370"/>
<text text-anchor="middle" x="6476.5" y="-6354.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="6476.5" y="-6339.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="6476.5" y="-6324.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- ln2_8&#45;&gt;moe_gate_8 -->
<g id="edge221" class="edge">
<title>ln2_8&#45;&gt;moe_gate_8</title>
<path fill="none" stroke="black" d="M6661.66,-6405.98C6630.74,-6395.72 6594.92,-6383.82 6563.08,-6373.25"/>
<polygon fill="black" stroke="black" points="6563.93,-6369.84 6553.34,-6370.01 6561.72,-6376.49 6563.93,-6369.84"/>
</g>
<!-- comm_8_9 -->
<g id="node169" class="node">
<title>comm_8_9</title>
<ellipse fill="#f0e6ff" stroke="black" cx="7665.5" cy="-5887.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="7665.5" y="-5898.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="7665.5" y="-5883.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7665.5" y="-5868.8" font-family="Arial" font-size="14.00">GPU: 7 → GPU: 8</text>
</g>
<!-- residual2_8&#45;&gt;comm_8_9 -->
<g id="edge241" class="edge">
<title>residual2_8&#45;&gt;comm_8_9</title>
<path fill="none" stroke="black" d="M7665.5,-5960.75C7665.5,-5952.93 7665.5,-5944.07 7665.5,-5935.31"/>
<polygon fill="black" stroke="black" points="7669,-5935.13 7665.5,-5925.13 7662,-5935.13 7669,-5935.13"/>
</g>
<!-- expert_8_0 -->
<g id="node159" class="node">
<title>expert_8_0</title>
<polygon fill="#e6ffe6" stroke="black" points="4879,-6281 4500,-6281 4500,-6228 4879,-6228 4879,-6281"/>
<text text-anchor="middle" x="4689.5" y="-6265.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4689.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="4689.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_8_0 -->
<g id="edge222" class="edge">
<title>moe_gate_8&#45;&gt;expert_8_0</title>
<path fill="none" stroke="black" d="M6318.44,-6341.02C6034.42,-6337.33 5418.78,-6324.66 4889.19,-6281.02"/>
<polygon fill="black" stroke="black" points="4889.31,-6277.52 4879.05,-6280.18 4888.73,-6284.5 4889.31,-6277.52"/>
</g>
<!-- expert_8_1 -->
<g id="node160" class="node">
<title>expert_8_1</title>
<polygon fill="#e6ffe6" stroke="black" points="5276,-6281 4897,-6281 4897,-6228 5276,-6228 5276,-6281"/>
<text text-anchor="middle" x="5086.5" y="-6265.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5086.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5086.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_8_1 -->
<g id="edge223" class="edge">
<title>moe_gate_8&#45;&gt;expert_8_1</title>
<path fill="none" stroke="black" d="M6318.26,-6338.15C6091.85,-6331.06 5662.26,-6314.43 5286.05,-6281.02"/>
<polygon fill="black" stroke="black" points="5286.33,-6277.53 5276.06,-6280.12 5285.71,-6284.5 5286.33,-6277.53"/>
</g>
<!-- expert_8_2 -->
<g id="node161" class="node">
<title>expert_8_2</title>
<polygon fill="#e6ffe6" stroke="black" points="5673,-6281 5294,-6281 5294,-6228 5673,-6228 5673,-6281"/>
<text text-anchor="middle" x="5483.5" y="-6265.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5483.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5483.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_8_2 -->
<g id="edge224" class="edge">
<title>moe_gate_8&#45;&gt;expert_8_2</title>
<path fill="none" stroke="black" d="M6318.49,-6332.6C6160.45,-6322.16 5910.19,-6304.16 5683.18,-6281.05"/>
<polygon fill="black" stroke="black" points="5683.37,-6277.55 5673.07,-6280.01 5682.66,-6284.51 5683.37,-6277.55"/>
</g>
<!-- expert_8_3 -->
<g id="node162" class="node">
<title>expert_8_3</title>
<polygon fill="#e6ffe6" stroke="black" points="6070,-6281 5691,-6281 5691,-6228 6070,-6228 6070,-6281"/>
<text text-anchor="middle" x="5880.5" y="-6265.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5880.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5880.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_8_3 -->
<g id="edge225" class="edge">
<title>moe_gate_8&#45;&gt;expert_8_3</title>
<path fill="none" stroke="black" d="M6318.35,-6319.41C6240.71,-6308.08 6146.7,-6294.36 6065.72,-6282.54"/>
<polygon fill="black" stroke="black" points="6065.81,-6279.01 6055.4,-6281.03 6064.79,-6285.94 6065.81,-6279.01"/>
</g>
<!-- expert_8_4 -->
<g id="node163" class="node">
<title>expert_8_4</title>
<polygon fill="#e6ffe6" stroke="black" points="6467,-6281 6088,-6281 6088,-6228 6467,-6228 6467,-6281"/>
<text text-anchor="middle" x="6277.5" y="-6265.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="6277.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6277.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_8_4 -->
<g id="edge226" class="edge">
<title>moe_gate_8&#45;&gt;expert_8_4</title>
<path fill="none" stroke="black" d="M6418.14,-6316.98C6395.26,-6306.98 6368.85,-6295.44 6345.14,-6285.07"/>
<polygon fill="black" stroke="black" points="6346.43,-6281.81 6335.86,-6281.01 6343.62,-6288.23 6346.43,-6281.81"/>
</g>
<!-- expert_8_5 -->
<g id="node164" class="node">
<title>expert_8_5</title>
<polygon fill="#e6ffe6" stroke="black" points="6864,-6281 6485,-6281 6485,-6228 6864,-6228 6864,-6281"/>
<text text-anchor="middle" x="6674.5" y="-6265.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="6674.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6674.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_8_5 -->
<g id="edge227" class="edge">
<title>moe_gate_8&#45;&gt;expert_8_5</title>
<path fill="none" stroke="black" d="M6534.57,-6316.98C6557.34,-6306.98 6583.61,-6295.44 6607.2,-6285.07"/>
<polygon fill="black" stroke="black" points="6608.69,-6288.24 6616.43,-6281.01 6605.87,-6281.83 6608.69,-6288.24"/>
</g>
<!-- expert_8_6 -->
<g id="node165" class="node">
<title>expert_8_6</title>
<polygon fill="#e6ffe6" stroke="black" points="7261,-6281 6882,-6281 6882,-6228 7261,-6228 7261,-6281"/>
<text text-anchor="middle" x="7071.5" y="-6265.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="7071.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7071.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_8_6 -->
<g id="edge228" class="edge">
<title>moe_gate_8&#45;&gt;expert_8_6</title>
<path fill="none" stroke="black" d="M6634.78,-6319.36C6712.2,-6308.04 6805.86,-6294.34 6886.56,-6282.54"/>
<polygon fill="black" stroke="black" points="6887.45,-6285.95 6896.84,-6281.04 6886.44,-6279.02 6887.45,-6285.95"/>
</g>
<!-- expert_8_7 -->
<g id="node166" class="node">
<title>expert_8_7</title>
<polygon fill="#e6ffe6" stroke="black" points="7658,-6281 7279,-6281 7279,-6228 7658,-6228 7658,-6281"/>
<text text-anchor="middle" x="7468.5" y="-6265.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="7468.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7468.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_8_7 -->
<g id="edge229" class="edge">
<title>moe_gate_8&#45;&gt;expert_8_7</title>
<path fill="none" stroke="black" d="M6634.52,-6332.63C6792.56,-6322.21 7042.82,-6304.23 7268.77,-6281.16"/>
<polygon fill="black" stroke="black" points="7269.24,-6284.63 7278.83,-6280.13 7268.53,-6277.67 7269.24,-6284.63"/>
</g>
<!-- expert_combine_8 -->
<g id="node167" class="node">
<title>expert_combine_8</title>
<polygon fill="#fff0e6" stroke="black" points="6569,-6192 6382,-6192 6382,-6139 6569,-6139 6569,-6192"/>
<text text-anchor="middle" x="6475.5" y="-6176.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="6475.5" y="-6161.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6475.5" y="-6146.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- moe_gate_8&#45;&gt;expert_combine_8 -->
<g id="edge230" class="edge">
<title>moe_gate_8&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M6634.53,-6340.04C6950.38,-6334.35 7632.5,-6317.85 7667.5,-6281 7683.72,-6263.92 7683.72,-6245.08 7667.5,-6228 7630.3,-6188.83 6862.65,-6172.67 6579.35,-6168.02"/>
<polygon fill="black" stroke="black" points="6579.12,-6164.51 6569.07,-6167.85 6579.01,-6171.51 6579.12,-6164.51"/>
</g>
<!-- expert_8_0&#45;&gt;expert_combine_8 -->
<g id="edge231" class="edge">
<title>expert_8_0&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M4879.05,-6228.82C4882.23,-6228.53 4885.38,-6228.26 4888.5,-6228 5446.46,-6181.53 6117.77,-6170.09 6371.55,-6167.34"/>
<polygon fill="black" stroke="black" points="6371.9,-6170.84 6381.86,-6167.23 6371.83,-6163.84 6371.9,-6170.84"/>
</g>
<!-- expert_8_1&#45;&gt;expert_combine_8 -->
<g id="edge232" class="edge">
<title>expert_8_1&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M5276.06,-6228.88C5279.23,-6228.57 5282.38,-6228.28 5285.5,-6228 5686.19,-6192.03 6164.81,-6175.22 6371.74,-6169.22"/>
<polygon fill="black" stroke="black" points="6372.1,-6172.71 6381.99,-6168.92 6371.89,-6165.71 6372.1,-6172.71"/>
</g>
<!-- expert_8_2&#45;&gt;expert_combine_8 -->
<g id="edge233" class="edge">
<title>expert_8_2&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M5673.07,-6228.99C5676.24,-6228.65 5679.38,-6228.32 5682.5,-6228 5929.24,-6202.64 6220.13,-6182.59 6371.75,-6172.88"/>
<polygon fill="black" stroke="black" points="6372.22,-6176.36 6381.97,-6172.23 6371.77,-6169.38 6372.22,-6176.36"/>
</g>
<!-- expert_8_3&#45;&gt;expert_combine_8 -->
<g id="edge234" class="edge">
<title>expert_8_3&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M6055,-6227.98C6157.85,-6212.95 6284.51,-6194.43 6371.78,-6181.67"/>
<polygon fill="black" stroke="black" points="6372.3,-6185.13 6381.69,-6180.22 6371.29,-6178.2 6372.3,-6185.13"/>
</g>
<!-- expert_8_4&#45;&gt;expert_combine_8 -->
<g id="edge235" class="edge">
<title>expert_8_4&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M6335.57,-6227.98C6358.34,-6217.98 6384.61,-6206.44 6408.2,-6196.07"/>
<polygon fill="black" stroke="black" points="6409.69,-6199.24 6417.43,-6192.01 6406.87,-6192.83 6409.69,-6199.24"/>
</g>
<!-- expert_8_5&#45;&gt;expert_combine_8 -->
<g id="edge236" class="edge">
<title>expert_8_5&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M6616.14,-6227.98C6593.26,-6217.98 6566.85,-6206.44 6543.14,-6196.07"/>
<polygon fill="black" stroke="black" points="6544.43,-6192.81 6533.86,-6192.01 6541.62,-6199.23 6544.43,-6192.81"/>
</g>
<!-- expert_8_6&#45;&gt;expert_combine_8 -->
<g id="edge237" class="edge">
<title>expert_8_6&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M6896.71,-6227.98C6793.52,-6212.92 6666.41,-6194.37 6578.97,-6181.6"/>
<polygon fill="black" stroke="black" points="6579.45,-6178.14 6569.04,-6180.16 6578.43,-6185.06 6579.45,-6178.14"/>
</g>
<!-- expert_8_7&#45;&gt;expert_combine_8 -->
<g id="edge238" class="edge">
<title>expert_8_7&#45;&gt;expert_combine_8</title>
<path fill="none" stroke="black" d="M7278.83,-6228.87C7276.04,-6228.58 7273.26,-6228.28 7270.5,-6228 7023.15,-6202.52 6731.52,-6182.52 6579.52,-6172.85"/>
<polygon fill="black" stroke="black" points="6579.46,-6169.34 6569.26,-6172.2 6579.02,-6176.33 6579.46,-6169.34"/>
</g>
<!-- expert_out_8 -->
<g id="node168" class="node">
<title>expert_out_8</title>
<polygon fill="#fff0e6" stroke="black" points="7082,-6103 6703,-6103 6703,-6050 7082,-6050 7082,-6103"/>
<text text-anchor="middle" x="6892.5" y="-6087.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="6892.5" y="-6072.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6892.5" y="-6057.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_combine_8&#45;&gt;expert_out_8 -->
<g id="edge239" class="edge">
<title>expert_combine_8&#45;&gt;expert_out_8</title>
<path fill="none" stroke="black" d="M6569.08,-6144.98C6625.38,-6133.23 6697.94,-6118.09 6760.06,-6105.13"/>
<polygon fill="black" stroke="black" points="6760.86,-6108.54 6769.93,-6103.07 6759.43,-6101.69 6760.86,-6108.54"/>
</g>
<!-- expert_out_8&#45;&gt;residual2_8 -->
<g id="edge240" class="edge">
<title>expert_out_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M7082.09,-6054.16C7233.28,-6037.15 7439.33,-6013.96 7561.77,-6000.17"/>
<polygon fill="black" stroke="black" points="7562.35,-6003.63 7571.89,-5999.04 7561.56,-5996.68 7562.35,-6003.63"/>
</g>
<!-- residual1_9 -->
<g id="node170" class="node">
<title>residual1_9</title>
<polygon fill="#f0f8ff" stroke="black" points="7929,-5814 7742,-5814 7742,-5761 7929,-5761 7929,-5814"/>
<text text-anchor="middle" x="7835.5" y="-5798.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7835.5" y="-5783.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7835.5" y="-5768.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- comm_8_9&#45;&gt;residual1_9 -->
<g id="edge242" class="edge">
<title>comm_8_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M7722.58,-5853.59C7741.9,-5842.46 7763.38,-5830.07 7782.38,-5819.12"/>
<polygon fill="black" stroke="black" points="7784.29,-5822.06 7791.2,-5814.04 7780.79,-5816 7784.29,-5822.06"/>
</g>
<!-- ln2_9 -->
<g id="node177" class="node">
<title>ln2_9</title>
<polygon fill="#ffe4e1" stroke="black" points="7405,-5725 7218,-5725 7218,-5672 7405,-5672 7405,-5725"/>
<text text-anchor="middle" x="7311.5" y="-5709.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7311.5" y="-5694.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7311.5" y="-5679.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge249" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M7741.82,-5770.95C7649.99,-5755.7 7510.31,-5732.51 7415.18,-5716.71"/>
<polygon fill="black" stroke="black" points="7415.69,-5713.25 7405.25,-5715.07 7414.54,-5720.16 7415.69,-5713.25"/>
</g>
<!-- residual2_9 -->
<g id="node178" class="node">
<title>residual2_9</title>
<polygon fill="#f0f8ff" stroke="black" points="8332,-5280 8145,-5280 8145,-5227 8332,-5227 8332,-5280"/>
<text text-anchor="middle" x="8238.5" y="-5264.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8238.5" y="-5249.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8238.5" y="-5234.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- residual1_9&#45;&gt;residual2_9 -->
<g id="edge250" class="edge">
<title>residual1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M7929.07,-5770.37C8063.82,-5744.45 8296.5,-5688.41 8296.5,-5610.5 8296.5,-5610.5 8296.5,-5610.5 8296.5,-5430.5 8296.5,-5379.48 8274.24,-5324.13 8257.3,-5289.39"/>
<polygon fill="black" stroke="black" points="8260.29,-5287.54 8252.69,-5280.16 8254.03,-5290.67 8260.29,-5287.54"/>
</g>
<!-- ln1_9 -->
<g id="node171" class="node">
<title>ln1_9</title>
<polygon fill="#ffe4e1" stroke="black" points="8099,-6370 7912,-6370 7912,-6317 8099,-6317 8099,-6370"/>
<text text-anchor="middle" x="8005.5" y="-6354.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8005.5" y="-6339.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8005.5" y="-6324.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_qkv_9 -->
<g id="node172" class="node">
<title>attn_qkv_9</title>
<polygon fill="#ffe6e6" stroke="black" points="8201.5,-6281 7809.5,-6281 7809.5,-6228 8201.5,-6228 8201.5,-6281"/>
<text text-anchor="middle" x="8005.5" y="-6265.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8005.5" y="-6250.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="8005.5" y="-6235.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- ln1_9&#45;&gt;attn_qkv_9 -->
<g id="edge243" class="edge">
<title>ln1_9&#45;&gt;attn_qkv_9</title>
<path fill="none" stroke="black" d="M8005.5,-6316.87C8005.5,-6308.89 8005.5,-6299.93 8005.5,-6291.38"/>
<polygon fill="black" stroke="black" points="8009,-6291.25 8005.5,-6281.25 8002,-6291.25 8009,-6291.25"/>
</g>
<!-- attn_score_9 -->
<g id="node173" class="node">
<title>attn_score_9</title>
<polygon fill="#ffe6e6" stroke="black" points="8087.5,-6192 7923.5,-6192 7923.5,-6139 8087.5,-6139 8087.5,-6192"/>
<text text-anchor="middle" x="8005.5" y="-6176.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8005.5" y="-6161.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="8005.5" y="-6146.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_qkv_9&#45;&gt;attn_score_9 -->
<g id="edge244" class="edge">
<title>attn_qkv_9&#45;&gt;attn_score_9</title>
<path fill="none" stroke="black" d="M8005.5,-6227.87C8005.5,-6219.89 8005.5,-6210.93 8005.5,-6202.38"/>
<polygon fill="black" stroke="black" points="8009,-6202.25 8005.5,-6192.25 8002,-6202.25 8009,-6202.25"/>
</g>
<!-- attn_weight_9 -->
<g id="node174" class="node">
<title>attn_weight_9</title>
<polygon fill="#ffe6e6" stroke="black" points="8087.5,-6103 7923.5,-6103 7923.5,-6050 8087.5,-6050 8087.5,-6103"/>
<text text-anchor="middle" x="8005.5" y="-6087.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="8005.5" y="-6072.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="8005.5" y="-6057.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_score_9&#45;&gt;attn_weight_9 -->
<g id="edge245" class="edge">
<title>attn_score_9&#45;&gt;attn_weight_9</title>
<path fill="none" stroke="black" d="M8005.5,-6138.87C8005.5,-6130.89 8005.5,-6121.93 8005.5,-6113.38"/>
<polygon fill="black" stroke="black" points="8009,-6113.25 8005.5,-6103.25 8002,-6113.25 8009,-6113.25"/>
</g>
<!-- attn_context_9 -->
<g id="node175" class="node">
<title>attn_context_9</title>
<polygon fill="#ffe6e6" stroke="black" points="8099,-6014 7912,-6014 7912,-5961 8099,-5961 8099,-6014"/>
<text text-anchor="middle" x="8005.5" y="-5998.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="8005.5" y="-5983.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8005.5" y="-5968.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_weight_9&#45;&gt;attn_context_9 -->
<g id="edge246" class="edge">
<title>attn_weight_9&#45;&gt;attn_context_9</title>
<path fill="none" stroke="black" d="M8005.5,-6049.87C8005.5,-6041.89 8005.5,-6032.93 8005.5,-6024.38"/>
<polygon fill="black" stroke="black" points="8009,-6024.25 8005.5,-6014.25 8002,-6024.25 8009,-6024.25"/>
</g>
<!-- attn_out_9 -->
<g id="node176" class="node">
<title>attn_out_9</title>
<polygon fill="#ffe6e6" stroke="black" points="8195,-5914 7816,-5914 7816,-5861 8195,-5861 8195,-5914"/>
<text text-anchor="middle" x="8005.5" y="-5898.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8005.5" y="-5883.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8005.5" y="-5868.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_context_9&#45;&gt;attn_out_9 -->
<g id="edge247" class="edge">
<title>attn_context_9&#45;&gt;attn_out_9</title>
<path fill="none" stroke="black" d="M8005.5,-5960.75C8005.5,-5949.61 8005.5,-5936.38 8005.5,-5924.31"/>
<polygon fill="black" stroke="black" points="8009,-5924.08 8005.5,-5914.08 8002,-5924.08 8009,-5924.08"/>
</g>
<!-- attn_out_9&#45;&gt;residual1_9 -->
<g id="edge248" class="edge">
<title>attn_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M7960.83,-5860.75C7938.68,-5847.98 7911.76,-5832.46 7888.56,-5819.09"/>
<polygon fill="black" stroke="black" points="7890.28,-5816.04 7879.87,-5814.08 7886.78,-5822.1 7890.28,-5816.04"/>
</g>
<!-- moe_gate_9 -->
<g id="node179" class="node">
<title>moe_gate_9</title>
<polygon fill="#e6e6ff" stroke="black" points="7207.5,-5636 6891.5,-5636 6891.5,-5583 7207.5,-5583 7207.5,-5636"/>
<text text-anchor="middle" x="7049.5" y="-5620.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="7049.5" y="-5605.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="7049.5" y="-5590.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- ln2_9&#45;&gt;moe_gate_9 -->
<g id="edge251" class="edge">
<title>ln2_9&#45;&gt;moe_gate_9</title>
<path fill="none" stroke="black" d="M7234.66,-5671.98C7203.74,-5661.72 7167.92,-5649.82 7136.08,-5639.25"/>
<polygon fill="black" stroke="black" points="7136.93,-5635.84 7126.34,-5636.01 7134.72,-5642.49 7136.93,-5635.84"/>
</g>
<!-- comm_9_10 -->
<g id="node190" class="node">
<title>comm_9_10</title>
<ellipse fill="#f0e6ff" stroke="black" cx="8238.5" cy="-5153.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="8238.5" y="-5164.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="8238.5" y="-5149.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8238.5" y="-5134.8" font-family="Arial" font-size="14.00">GPU: 8 → GPU: 9</text>
</g>
<!-- residual2_9&#45;&gt;comm_9_10 -->
<g id="edge271" class="edge">
<title>residual2_9&#45;&gt;comm_9_10</title>
<path fill="none" stroke="black" d="M8238.5,-5226.75C8238.5,-5218.93 8238.5,-5210.07 8238.5,-5201.31"/>
<polygon fill="black" stroke="black" points="8242,-5201.13 8238.5,-5191.13 8235,-5201.13 8242,-5201.13"/>
</g>
<!-- expert_9_0 -->
<g id="node180" class="node">
<title>expert_9_0</title>
<polygon fill="#e6ffe6" stroke="black" points="5452,-5547 5073,-5547 5073,-5494 5452,-5494 5452,-5547"/>
<text text-anchor="middle" x="5262.5" y="-5531.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5262.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5262.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_9_0 -->
<g id="edge252" class="edge">
<title>moe_gate_9&#45;&gt;expert_9_0</title>
<path fill="none" stroke="black" d="M6891.44,-5607.02C6607.42,-5603.33 5991.78,-5590.66 5462.19,-5547.02"/>
<polygon fill="black" stroke="black" points="5462.31,-5543.52 5452.05,-5546.18 5461.73,-5550.5 5462.31,-5543.52"/>
</g>
<!-- expert_9_1 -->
<g id="node181" class="node">
<title>expert_9_1</title>
<polygon fill="#e6ffe6" stroke="black" points="5849,-5547 5470,-5547 5470,-5494 5849,-5494 5849,-5547"/>
<text text-anchor="middle" x="5659.5" y="-5531.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5659.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5659.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_9_1 -->
<g id="edge253" class="edge">
<title>moe_gate_9&#45;&gt;expert_9_1</title>
<path fill="none" stroke="black" d="M6891.26,-5604.15C6664.85,-5597.06 6235.26,-5580.43 5859.05,-5547.02"/>
<polygon fill="black" stroke="black" points="5859.33,-5543.53 5849.06,-5546.12 5858.71,-5550.5 5859.33,-5543.53"/>
</g>
<!-- expert_9_2 -->
<g id="node182" class="node">
<title>expert_9_2</title>
<polygon fill="#e6ffe6" stroke="black" points="6246,-5547 5867,-5547 5867,-5494 6246,-5494 6246,-5547"/>
<text text-anchor="middle" x="6056.5" y="-5531.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6056.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6056.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_9_2 -->
<g id="edge254" class="edge">
<title>moe_gate_9&#45;&gt;expert_9_2</title>
<path fill="none" stroke="black" d="M6891.49,-5598.6C6733.45,-5588.16 6483.19,-5570.16 6256.18,-5547.05"/>
<polygon fill="black" stroke="black" points="6256.37,-5543.55 6246.07,-5546.01 6255.66,-5550.51 6256.37,-5543.55"/>
</g>
<!-- expert_9_3 -->
<g id="node183" class="node">
<title>expert_9_3</title>
<polygon fill="#e6ffe6" stroke="black" points="6643,-5547 6264,-5547 6264,-5494 6643,-5494 6643,-5547"/>
<text text-anchor="middle" x="6453.5" y="-5531.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6453.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6453.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_9_3 -->
<g id="edge255" class="edge">
<title>moe_gate_9&#45;&gt;expert_9_3</title>
<path fill="none" stroke="black" d="M6891.35,-5585.41C6813.71,-5574.08 6719.7,-5560.36 6638.72,-5548.54"/>
<polygon fill="black" stroke="black" points="6638.81,-5545.01 6628.4,-5547.03 6637.79,-5551.94 6638.81,-5545.01"/>
</g>
<!-- expert_9_4 -->
<g id="node184" class="node">
<title>expert_9_4</title>
<polygon fill="#e6ffe6" stroke="black" points="7040,-5547 6661,-5547 6661,-5494 7040,-5494 7040,-5547"/>
<text text-anchor="middle" x="6850.5" y="-5531.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="6850.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6850.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_9_4 -->
<g id="edge256" class="edge">
<title>moe_gate_9&#45;&gt;expert_9_4</title>
<path fill="none" stroke="black" d="M6991.14,-5582.98C6968.26,-5572.98 6941.85,-5561.44 6918.14,-5551.07"/>
<polygon fill="black" stroke="black" points="6919.43,-5547.81 6908.86,-5547.01 6916.62,-5554.23 6919.43,-5547.81"/>
</g>
<!-- expert_9_5 -->
<g id="node185" class="node">
<title>expert_9_5</title>
<polygon fill="#e6ffe6" stroke="black" points="7437,-5547 7058,-5547 7058,-5494 7437,-5494 7437,-5547"/>
<text text-anchor="middle" x="7247.5" y="-5531.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="7247.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7247.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_9_5 -->
<g id="edge257" class="edge">
<title>moe_gate_9&#45;&gt;expert_9_5</title>
<path fill="none" stroke="black" d="M7107.57,-5582.98C7130.34,-5572.98 7156.61,-5561.44 7180.2,-5551.07"/>
<polygon fill="black" stroke="black" points="7181.69,-5554.24 7189.43,-5547.01 7178.87,-5547.83 7181.69,-5554.24"/>
</g>
<!-- expert_9_6 -->
<g id="node186" class="node">
<title>expert_9_6</title>
<polygon fill="#e6ffe6" stroke="black" points="7834,-5547 7455,-5547 7455,-5494 7834,-5494 7834,-5547"/>
<text text-anchor="middle" x="7644.5" y="-5531.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="7644.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7644.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_9_6 -->
<g id="edge258" class="edge">
<title>moe_gate_9&#45;&gt;expert_9_6</title>
<path fill="none" stroke="black" d="M7207.78,-5585.36C7285.2,-5574.04 7378.86,-5560.34 7459.56,-5548.54"/>
<polygon fill="black" stroke="black" points="7460.45,-5551.95 7469.84,-5547.04 7459.44,-5545.02 7460.45,-5551.95"/>
</g>
<!-- expert_9_7 -->
<g id="node187" class="node">
<title>expert_9_7</title>
<polygon fill="#e6ffe6" stroke="black" points="8231,-5547 7852,-5547 7852,-5494 8231,-5494 8231,-5547"/>
<text text-anchor="middle" x="8041.5" y="-5531.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8041.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8041.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_9_7 -->
<g id="edge259" class="edge">
<title>moe_gate_9&#45;&gt;expert_9_7</title>
<path fill="none" stroke="black" d="M7207.52,-5598.63C7365.56,-5588.21 7615.82,-5570.23 7841.77,-5547.16"/>
<polygon fill="black" stroke="black" points="7842.24,-5550.63 7851.83,-5546.13 7841.53,-5543.67 7842.24,-5550.63"/>
</g>
<!-- expert_combine_9 -->
<g id="node188" class="node">
<title>expert_combine_9</title>
<polygon fill="#fff0e6" stroke="black" points="7142,-5458 6955,-5458 6955,-5405 7142,-5405 7142,-5458"/>
<text text-anchor="middle" x="7048.5" y="-5442.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="7048.5" y="-5427.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7048.5" y="-5412.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- moe_gate_9&#45;&gt;expert_combine_9 -->
<g id="edge260" class="edge">
<title>moe_gate_9&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M7207.53,-5606.04C7523.38,-5600.35 8205.5,-5583.85 8240.5,-5547 8256.72,-5529.92 8256.72,-5511.08 8240.5,-5494 8203.3,-5454.83 7435.65,-5438.67 7152.35,-5434.02"/>
<polygon fill="black" stroke="black" points="7152.12,-5430.51 7142.07,-5433.85 7152.01,-5437.51 7152.12,-5430.51"/>
</g>
<!-- expert_9_0&#45;&gt;expert_combine_9 -->
<g id="edge261" class="edge">
<title>expert_9_0&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M5452.05,-5494.82C5455.23,-5494.53 5458.38,-5494.26 5461.5,-5494 6019.46,-5447.53 6690.77,-5436.09 6944.55,-5433.34"/>
<polygon fill="black" stroke="black" points="6944.9,-5436.84 6954.86,-5433.23 6944.83,-5429.84 6944.9,-5436.84"/>
</g>
<!-- expert_9_1&#45;&gt;expert_combine_9 -->
<g id="edge262" class="edge">
<title>expert_9_1&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M5849.06,-5494.88C5852.23,-5494.57 5855.38,-5494.28 5858.5,-5494 6259.19,-5458.03 6737.81,-5441.22 6944.74,-5435.22"/>
<polygon fill="black" stroke="black" points="6945.1,-5438.71 6954.99,-5434.92 6944.89,-5431.71 6945.1,-5438.71"/>
</g>
<!-- expert_9_2&#45;&gt;expert_combine_9 -->
<g id="edge263" class="edge">
<title>expert_9_2&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M6246.07,-5494.99C6249.24,-5494.65 6252.38,-5494.32 6255.5,-5494 6502.24,-5468.64 6793.13,-5448.59 6944.75,-5438.88"/>
<polygon fill="black" stroke="black" points="6945.22,-5442.36 6954.97,-5438.23 6944.77,-5435.38 6945.22,-5442.36"/>
</g>
<!-- expert_9_3&#45;&gt;expert_combine_9 -->
<g id="edge264" class="edge">
<title>expert_9_3&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M6628,-5493.98C6730.85,-5478.95 6857.51,-5460.43 6944.78,-5447.67"/>
<polygon fill="black" stroke="black" points="6945.3,-5451.13 6954.69,-5446.22 6944.29,-5444.2 6945.3,-5451.13"/>
</g>
<!-- expert_9_4&#45;&gt;expert_combine_9 -->
<g id="edge265" class="edge">
<title>expert_9_4&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M6908.57,-5493.98C6931.34,-5483.98 6957.61,-5472.44 6981.2,-5462.07"/>
<polygon fill="black" stroke="black" points="6982.69,-5465.24 6990.43,-5458.01 6979.87,-5458.83 6982.69,-5465.24"/>
</g>
<!-- expert_9_5&#45;&gt;expert_combine_9 -->
<g id="edge266" class="edge">
<title>expert_9_5&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M7189.14,-5493.98C7166.26,-5483.98 7139.85,-5472.44 7116.14,-5462.07"/>
<polygon fill="black" stroke="black" points="7117.43,-5458.81 7106.86,-5458.01 7114.62,-5465.23 7117.43,-5458.81"/>
</g>
<!-- expert_9_6&#45;&gt;expert_combine_9 -->
<g id="edge267" class="edge">
<title>expert_9_6&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M7469.71,-5493.98C7366.52,-5478.92 7239.41,-5460.37 7151.97,-5447.6"/>
<polygon fill="black" stroke="black" points="7152.45,-5444.14 7142.04,-5446.16 7151.43,-5451.06 7152.45,-5444.14"/>
</g>
<!-- expert_9_7&#45;&gt;expert_combine_9 -->
<g id="edge268" class="edge">
<title>expert_9_7&#45;&gt;expert_combine_9</title>
<path fill="none" stroke="black" d="M7851.83,-5494.87C7849.04,-5494.58 7846.26,-5494.28 7843.5,-5494 7596.15,-5468.52 7304.52,-5448.52 7152.52,-5438.85"/>
<polygon fill="black" stroke="black" points="7152.46,-5435.34 7142.26,-5438.2 7152.02,-5442.33 7152.46,-5435.34"/>
</g>
<!-- expert_out_9 -->
<g id="node189" class="node">
<title>expert_out_9</title>
<polygon fill="#fff0e6" stroke="black" points="7655,-5369 7276,-5369 7276,-5316 7655,-5316 7655,-5369"/>
<text text-anchor="middle" x="7465.5" y="-5353.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="7465.5" y="-5338.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7465.5" y="-5323.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_combine_9&#45;&gt;expert_out_9 -->
<g id="edge269" class="edge">
<title>expert_combine_9&#45;&gt;expert_out_9</title>
<path fill="none" stroke="black" d="M7142.08,-5410.98C7198.38,-5399.23 7270.94,-5384.09 7333.06,-5371.13"/>
<polygon fill="black" stroke="black" points="7333.86,-5374.54 7342.93,-5369.07 7332.43,-5367.69 7333.86,-5374.54"/>
</g>
<!-- expert_out_9&#45;&gt;residual2_9 -->
<g id="edge270" class="edge">
<title>expert_out_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M7655.09,-5320.16C7806.28,-5303.15 8012.33,-5279.96 8134.77,-5266.17"/>
<polygon fill="black" stroke="black" points="8135.35,-5269.63 8144.89,-5265.04 8134.56,-5262.68 8135.35,-5269.63"/>
</g>
<!-- residual1_10 -->
<g id="node191" class="node">
<title>residual1_10</title>
<polygon fill="#f0f8ff" stroke="black" points="8502,-5080 8315,-5080 8315,-5027 8502,-5027 8502,-5080"/>
<text text-anchor="middle" x="8408.5" y="-5064.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8408.5" y="-5049.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8408.5" y="-5034.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- comm_9_10&#45;&gt;residual1_10 -->
<g id="edge272" class="edge">
<title>comm_9_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M8295.58,-5119.59C8314.9,-5108.46 8336.38,-5096.07 8355.38,-5085.12"/>
<polygon fill="black" stroke="black" points="8357.29,-5088.06 8364.2,-5080.04 8353.79,-5082 8357.29,-5088.06"/>
</g>
<!-- ln2_10 -->
<g id="node198" class="node">
<title>ln2_10</title>
<polygon fill="#ffe4e1" stroke="black" points="7978,-4991 7791,-4991 7791,-4938 7978,-4938 7978,-4991"/>
<text text-anchor="middle" x="7884.5" y="-4975.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7884.5" y="-4960.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7884.5" y="-4945.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge279" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M8314.82,-5036.95C8222.99,-5021.7 8083.31,-4998.51 7988.18,-4982.71"/>
<polygon fill="black" stroke="black" points="7988.69,-4979.25 7978.25,-4981.07 7987.54,-4986.16 7988.69,-4979.25"/>
</g>
<!-- residual2_10 -->
<g id="node199" class="node">
<title>residual2_10</title>
<polygon fill="#f0f8ff" stroke="black" points="8905,-4546 8718,-4546 8718,-4493 8905,-4493 8905,-4546"/>
<text text-anchor="middle" x="8811.5" y="-4530.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8811.5" y="-4515.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8811.5" y="-4500.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- residual1_10&#45;&gt;residual2_10 -->
<g id="edge280" class="edge">
<title>residual1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M8502.07,-5036.37C8636.82,-5010.45 8869.5,-4954.41 8869.5,-4876.5 8869.5,-4876.5 8869.5,-4876.5 8869.5,-4696.5 8869.5,-4645.48 8847.24,-4590.13 8830.3,-4555.39"/>
<polygon fill="black" stroke="black" points="8833.29,-4553.54 8825.69,-4546.16 8827.03,-4556.67 8833.29,-4553.54"/>
</g>
<!-- ln1_10 -->
<g id="node192" class="node">
<title>ln1_10</title>
<polygon fill="#ffe4e1" stroke="black" points="8672,-5636 8485,-5636 8485,-5583 8672,-5583 8672,-5636"/>
<text text-anchor="middle" x="8578.5" y="-5620.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8578.5" y="-5605.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8578.5" y="-5590.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_qkv_10 -->
<g id="node193" class="node">
<title>attn_qkv_10</title>
<polygon fill="#ffe6e6" stroke="black" points="8774.5,-5547 8382.5,-5547 8382.5,-5494 8774.5,-5494 8774.5,-5547"/>
<text text-anchor="middle" x="8578.5" y="-5531.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="8578.5" y="-5516.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="8578.5" y="-5501.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- ln1_10&#45;&gt;attn_qkv_10 -->
<g id="edge273" class="edge">
<title>ln1_10&#45;&gt;attn_qkv_10</title>
<path fill="none" stroke="black" d="M8578.5,-5582.87C8578.5,-5574.89 8578.5,-5565.93 8578.5,-5557.38"/>
<polygon fill="black" stroke="black" points="8582,-5557.25 8578.5,-5547.25 8575,-5557.25 8582,-5557.25"/>
</g>
<!-- attn_score_10 -->
<g id="node194" class="node">
<title>attn_score_10</title>
<polygon fill="#ffe6e6" stroke="black" points="8660.5,-5458 8496.5,-5458 8496.5,-5405 8660.5,-5405 8660.5,-5458"/>
<text text-anchor="middle" x="8578.5" y="-5442.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="8578.5" y="-5427.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="8578.5" y="-5412.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_qkv_10&#45;&gt;attn_score_10 -->
<g id="edge274" class="edge">
<title>attn_qkv_10&#45;&gt;attn_score_10</title>
<path fill="none" stroke="black" d="M8578.5,-5493.87C8578.5,-5485.89 8578.5,-5476.93 8578.5,-5468.38"/>
<polygon fill="black" stroke="black" points="8582,-5468.25 8578.5,-5458.25 8575,-5468.25 8582,-5468.25"/>
</g>
<!-- attn_weight_10 -->
<g id="node195" class="node">
<title>attn_weight_10</title>
<polygon fill="#ffe6e6" stroke="black" points="8660.5,-5369 8496.5,-5369 8496.5,-5316 8660.5,-5316 8660.5,-5369"/>
<text text-anchor="middle" x="8578.5" y="-5353.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="8578.5" y="-5338.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="8578.5" y="-5323.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_score_10&#45;&gt;attn_weight_10 -->
<g id="edge275" class="edge">
<title>attn_score_10&#45;&gt;attn_weight_10</title>
<path fill="none" stroke="black" d="M8578.5,-5404.87C8578.5,-5396.89 8578.5,-5387.93 8578.5,-5379.38"/>
<polygon fill="black" stroke="black" points="8582,-5379.25 8578.5,-5369.25 8575,-5379.25 8582,-5379.25"/>
</g>
<!-- attn_context_10 -->
<g id="node196" class="node">
<title>attn_context_10</title>
<polygon fill="#ffe6e6" stroke="black" points="8672,-5280 8485,-5280 8485,-5227 8672,-5227 8672,-5280"/>
<text text-anchor="middle" x="8578.5" y="-5264.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="8578.5" y="-5249.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8578.5" y="-5234.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_weight_10&#45;&gt;attn_context_10 -->
<g id="edge276" class="edge">
<title>attn_weight_10&#45;&gt;attn_context_10</title>
<path fill="none" stroke="black" d="M8578.5,-5315.87C8578.5,-5307.89 8578.5,-5298.93 8578.5,-5290.38"/>
<polygon fill="black" stroke="black" points="8582,-5290.25 8578.5,-5280.25 8575,-5290.25 8582,-5290.25"/>
</g>
<!-- attn_out_10 -->
<g id="node197" class="node">
<title>attn_out_10</title>
<polygon fill="#ffe6e6" stroke="black" points="8768,-5180 8389,-5180 8389,-5127 8768,-5127 8768,-5180"/>
<text text-anchor="middle" x="8578.5" y="-5164.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="8578.5" y="-5149.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8578.5" y="-5134.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_context_10&#45;&gt;attn_out_10 -->
<g id="edge277" class="edge">
<title>attn_context_10&#45;&gt;attn_out_10</title>
<path fill="none" stroke="black" d="M8578.5,-5226.75C8578.5,-5215.61 8578.5,-5202.38 8578.5,-5190.31"/>
<polygon fill="black" stroke="black" points="8582,-5190.08 8578.5,-5180.08 8575,-5190.08 8582,-5190.08"/>
</g>
<!-- attn_out_10&#45;&gt;residual1_10 -->
<g id="edge278" class="edge">
<title>attn_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M8533.83,-5126.75C8511.68,-5113.98 8484.76,-5098.46 8461.56,-5085.09"/>
<polygon fill="black" stroke="black" points="8463.28,-5082.04 8452.87,-5080.08 8459.78,-5088.1 8463.28,-5082.04"/>
</g>
<!-- moe_gate_10 -->
<g id="node200" class="node">
<title>moe_gate_10</title>
<polygon fill="#e6e6ff" stroke="black" points="7780.5,-4902 7464.5,-4902 7464.5,-4849 7780.5,-4849 7780.5,-4902"/>
<text text-anchor="middle" x="7622.5" y="-4886.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="7622.5" y="-4871.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="7622.5" y="-4856.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- ln2_10&#45;&gt;moe_gate_10 -->
<g id="edge281" class="edge">
<title>ln2_10&#45;&gt;moe_gate_10</title>
<path fill="none" stroke="black" d="M7807.66,-4937.98C7776.74,-4927.72 7740.92,-4915.82 7709.08,-4905.25"/>
<polygon fill="black" stroke="black" points="7709.93,-4901.84 7699.34,-4902.01 7707.72,-4908.49 7709.93,-4901.84"/>
</g>
<!-- comm_10_11 -->
<g id="node211" class="node">
<title>comm_10_11</title>
<ellipse fill="#f0e6ff" stroke="black" cx="8811.5" cy="-4419.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="8811.5" y="-4430.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="8811.5" y="-4415.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8811.5" y="-4400.8" font-family="Arial" font-size="14.00">GPU: 9 → GPU: 10</text>
</g>
<!-- residual2_10&#45;&gt;comm_10_11 -->
<g id="edge301" class="edge">
<title>residual2_10&#45;&gt;comm_10_11</title>
<path fill="none" stroke="black" d="M8811.5,-4492.75C8811.5,-4484.93 8811.5,-4476.07 8811.5,-4467.31"/>
<polygon fill="black" stroke="black" points="8815,-4467.13 8811.5,-4457.13 8808,-4467.13 8815,-4467.13"/>
</g>
<!-- expert_10_0 -->
<g id="node201" class="node">
<title>expert_10_0</title>
<polygon fill="#e6ffe6" stroke="black" points="6025,-4813 5646,-4813 5646,-4760 6025,-4760 6025,-4813"/>
<text text-anchor="middle" x="5835.5" y="-4797.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5835.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="5835.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_10_0 -->
<g id="edge282" class="edge">
<title>moe_gate_10&#45;&gt;expert_10_0</title>
<path fill="none" stroke="black" d="M7464.44,-4873.02C7180.42,-4869.33 6564.78,-4856.66 6035.19,-4813.02"/>
<polygon fill="black" stroke="black" points="6035.31,-4809.52 6025.05,-4812.18 6034.73,-4816.5 6035.31,-4809.52"/>
</g>
<!-- expert_10_1 -->
<g id="node202" class="node">
<title>expert_10_1</title>
<polygon fill="#e6ffe6" stroke="black" points="6422,-4813 6043,-4813 6043,-4760 6422,-4760 6422,-4813"/>
<text text-anchor="middle" x="6232.5" y="-4797.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6232.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6232.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_10_1 -->
<g id="edge283" class="edge">
<title>moe_gate_10&#45;&gt;expert_10_1</title>
<path fill="none" stroke="black" d="M7464.26,-4870.15C7237.85,-4863.06 6808.26,-4846.43 6432.05,-4813.02"/>
<polygon fill="black" stroke="black" points="6432.33,-4809.53 6422.06,-4812.12 6431.71,-4816.5 6432.33,-4809.53"/>
</g>
<!-- expert_10_2 -->
<g id="node203" class="node">
<title>expert_10_2</title>
<polygon fill="#e6ffe6" stroke="black" points="6819,-4813 6440,-4813 6440,-4760 6819,-4760 6819,-4813"/>
<text text-anchor="middle" x="6629.5" y="-4797.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6629.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6629.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_10_2 -->
<g id="edge284" class="edge">
<title>moe_gate_10&#45;&gt;expert_10_2</title>
<path fill="none" stroke="black" d="M7464.49,-4864.6C7306.45,-4854.16 7056.19,-4836.16 6829.18,-4813.05"/>
<polygon fill="black" stroke="black" points="6829.37,-4809.55 6819.07,-4812.01 6828.66,-4816.51 6829.37,-4809.55"/>
</g>
<!-- expert_10_3 -->
<g id="node204" class="node">
<title>expert_10_3</title>
<polygon fill="#e6ffe6" stroke="black" points="7216,-4813 6837,-4813 6837,-4760 7216,-4760 7216,-4813"/>
<text text-anchor="middle" x="7026.5" y="-4797.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7026.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7026.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_10_3 -->
<g id="edge285" class="edge">
<title>moe_gate_10&#45;&gt;expert_10_3</title>
<path fill="none" stroke="black" d="M7464.35,-4851.41C7386.71,-4840.08 7292.7,-4826.36 7211.72,-4814.54"/>
<polygon fill="black" stroke="black" points="7211.81,-4811.01 7201.4,-4813.03 7210.79,-4817.94 7211.81,-4811.01"/>
</g>
<!-- expert_10_4 -->
<g id="node205" class="node">
<title>expert_10_4</title>
<polygon fill="#e6ffe6" stroke="black" points="7613,-4813 7234,-4813 7234,-4760 7613,-4760 7613,-4813"/>
<text text-anchor="middle" x="7423.5" y="-4797.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7423.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7423.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_10_4 -->
<g id="edge286" class="edge">
<title>moe_gate_10&#45;&gt;expert_10_4</title>
<path fill="none" stroke="black" d="M7564.14,-4848.98C7541.26,-4838.98 7514.85,-4827.44 7491.14,-4817.07"/>
<polygon fill="black" stroke="black" points="7492.43,-4813.81 7481.86,-4813.01 7489.62,-4820.23 7492.43,-4813.81"/>
</g>
<!-- expert_10_5 -->
<g id="node206" class="node">
<title>expert_10_5</title>
<polygon fill="#e6ffe6" stroke="black" points="8010,-4813 7631,-4813 7631,-4760 8010,-4760 8010,-4813"/>
<text text-anchor="middle" x="7820.5" y="-4797.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="7820.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7820.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_10_5 -->
<g id="edge287" class="edge">
<title>moe_gate_10&#45;&gt;expert_10_5</title>
<path fill="none" stroke="black" d="M7680.57,-4848.98C7703.34,-4838.98 7729.61,-4827.44 7753.2,-4817.07"/>
<polygon fill="black" stroke="black" points="7754.69,-4820.24 7762.43,-4813.01 7751.87,-4813.83 7754.69,-4820.24"/>
</g>
<!-- expert_10_6 -->
<g id="node207" class="node">
<title>expert_10_6</title>
<polygon fill="#e6ffe6" stroke="black" points="8407,-4813 8028,-4813 8028,-4760 8407,-4760 8407,-4813"/>
<text text-anchor="middle" x="8217.5" y="-4797.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8217.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8217.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_10_6 -->
<g id="edge288" class="edge">
<title>moe_gate_10&#45;&gt;expert_10_6</title>
<path fill="none" stroke="black" d="M7780.78,-4851.36C7858.2,-4840.04 7951.86,-4826.34 8032.56,-4814.54"/>
<polygon fill="black" stroke="black" points="8033.45,-4817.95 8042.84,-4813.04 8032.44,-4811.02 8033.45,-4817.95"/>
</g>
<!-- expert_10_7 -->
<g id="node208" class="node">
<title>expert_10_7</title>
<polygon fill="#e6ffe6" stroke="black" points="8804,-4813 8425,-4813 8425,-4760 8804,-4760 8804,-4813"/>
<text text-anchor="middle" x="8614.5" y="-4797.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="8614.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8614.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_10_7 -->
<g id="edge289" class="edge">
<title>moe_gate_10&#45;&gt;expert_10_7</title>
<path fill="none" stroke="black" d="M7780.52,-4864.63C7938.56,-4854.21 8188.82,-4836.23 8414.77,-4813.16"/>
<polygon fill="black" stroke="black" points="8415.24,-4816.63 8424.83,-4812.13 8414.53,-4809.67 8415.24,-4816.63"/>
</g>
<!-- expert_combine_10 -->
<g id="node209" class="node">
<title>expert_combine_10</title>
<polygon fill="#fff0e6" stroke="black" points="7715,-4724 7528,-4724 7528,-4671 7715,-4671 7715,-4724"/>
<text text-anchor="middle" x="7621.5" y="-4708.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="7621.5" y="-4693.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7621.5" y="-4678.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- moe_gate_10&#45;&gt;expert_combine_10 -->
<g id="edge290" class="edge">
<title>moe_gate_10&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M7780.53,-4872.04C8096.38,-4866.35 8778.5,-4849.85 8813.5,-4813 8829.72,-4795.92 8829.72,-4777.08 8813.5,-4760 8776.3,-4720.83 8008.65,-4704.67 7725.35,-4700.02"/>
<polygon fill="black" stroke="black" points="7725.12,-4696.51 7715.07,-4699.85 7725.01,-4703.51 7725.12,-4696.51"/>
</g>
<!-- expert_10_0&#45;&gt;expert_combine_10 -->
<g id="edge291" class="edge">
<title>expert_10_0&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M6025.05,-4760.82C6028.23,-4760.53 6031.38,-4760.26 6034.5,-4760 6592.46,-4713.53 7263.77,-4702.09 7517.55,-4699.34"/>
<polygon fill="black" stroke="black" points="7517.9,-4702.84 7527.86,-4699.23 7517.83,-4695.84 7517.9,-4702.84"/>
</g>
<!-- expert_10_1&#45;&gt;expert_combine_10 -->
<g id="edge292" class="edge">
<title>expert_10_1&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M6422.06,-4760.88C6425.23,-4760.57 6428.38,-4760.28 6431.5,-4760 6832.19,-4724.03 7310.81,-4707.22 7517.74,-4701.22"/>
<polygon fill="black" stroke="black" points="7518.1,-4704.71 7527.99,-4700.92 7517.89,-4697.71 7518.1,-4704.71"/>
</g>
<!-- expert_10_2&#45;&gt;expert_combine_10 -->
<g id="edge293" class="edge">
<title>expert_10_2&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M6819.07,-4760.99C6822.24,-4760.65 6825.38,-4760.32 6828.5,-4760 7075.24,-4734.64 7366.13,-4714.59 7517.75,-4704.88"/>
<polygon fill="black" stroke="black" points="7518.22,-4708.36 7527.97,-4704.23 7517.77,-4701.38 7518.22,-4708.36"/>
</g>
<!-- expert_10_3&#45;&gt;expert_combine_10 -->
<g id="edge294" class="edge">
<title>expert_10_3&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M7201,-4759.98C7303.85,-4744.95 7430.51,-4726.43 7517.78,-4713.67"/>
<polygon fill="black" stroke="black" points="7518.3,-4717.13 7527.69,-4712.22 7517.29,-4710.2 7518.3,-4717.13"/>
</g>
<!-- expert_10_4&#45;&gt;expert_combine_10 -->
<g id="edge295" class="edge">
<title>expert_10_4&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M7481.57,-4759.98C7504.34,-4749.98 7530.61,-4738.44 7554.2,-4728.07"/>
<polygon fill="black" stroke="black" points="7555.69,-4731.24 7563.43,-4724.01 7552.87,-4724.83 7555.69,-4731.24"/>
</g>
<!-- expert_10_5&#45;&gt;expert_combine_10 -->
<g id="edge296" class="edge">
<title>expert_10_5&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M7762.14,-4759.98C7739.26,-4749.98 7712.85,-4738.44 7689.14,-4728.07"/>
<polygon fill="black" stroke="black" points="7690.43,-4724.81 7679.86,-4724.01 7687.62,-4731.23 7690.43,-4724.81"/>
</g>
<!-- expert_10_6&#45;&gt;expert_combine_10 -->
<g id="edge297" class="edge">
<title>expert_10_6&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M8042.71,-4759.98C7939.52,-4744.92 7812.41,-4726.37 7724.97,-4713.6"/>
<polygon fill="black" stroke="black" points="7725.45,-4710.14 7715.04,-4712.16 7724.43,-4717.06 7725.45,-4710.14"/>
</g>
<!-- expert_10_7&#45;&gt;expert_combine_10 -->
<g id="edge298" class="edge">
<title>expert_10_7&#45;&gt;expert_combine_10</title>
<path fill="none" stroke="black" d="M8424.83,-4760.87C8422.04,-4760.58 8419.26,-4760.28 8416.5,-4760 8169.15,-4734.52 7877.52,-4714.52 7725.52,-4704.85"/>
<polygon fill="black" stroke="black" points="7725.46,-4701.34 7715.26,-4704.2 7725.02,-4708.33 7725.46,-4701.34"/>
</g>
<!-- expert_out_10 -->
<g id="node210" class="node">
<title>expert_out_10</title>
<polygon fill="#fff0e6" stroke="black" points="8228,-4635 7849,-4635 7849,-4582 8228,-4582 8228,-4635"/>
<text text-anchor="middle" x="8038.5" y="-4619.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="8038.5" y="-4604.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8038.5" y="-4589.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_combine_10&#45;&gt;expert_out_10 -->
<g id="edge299" class="edge">
<title>expert_combine_10&#45;&gt;expert_out_10</title>
<path fill="none" stroke="black" d="M7715.08,-4676.98C7771.38,-4665.23 7843.94,-4650.09 7906.06,-4637.13"/>
<polygon fill="black" stroke="black" points="7906.86,-4640.54 7915.93,-4635.07 7905.43,-4633.69 7906.86,-4640.54"/>
</g>
<!-- expert_out_10&#45;&gt;residual2_10 -->
<g id="edge300" class="edge">
<title>expert_out_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M8228.09,-4586.16C8379.28,-4569.15 8585.33,-4545.96 8707.77,-4532.17"/>
<polygon fill="black" stroke="black" points="8708.35,-4535.63 8717.89,-4531.04 8707.56,-4528.68 8708.35,-4535.63"/>
</g>
<!-- residual1_11 -->
<g id="node212" class="node">
<title>residual1_11</title>
<polygon fill="#f0f8ff" stroke="black" points="9075,-4346 8888,-4346 8888,-4293 9075,-4293 9075,-4346"/>
<text text-anchor="middle" x="8981.5" y="-4330.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8981.5" y="-4315.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8981.5" y="-4300.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- comm_10_11&#45;&gt;residual1_11 -->
<g id="edge302" class="edge">
<title>comm_10_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M8868.58,-4385.59C8887.9,-4374.46 8909.38,-4362.07 8928.38,-4351.12"/>
<polygon fill="black" stroke="black" points="8930.29,-4354.06 8937.2,-4346.04 8926.79,-4348 8930.29,-4354.06"/>
</g>
<!-- ln2_11 -->
<g id="node219" class="node">
<title>ln2_11</title>
<polygon fill="#ffe4e1" stroke="black" points="8551,-4257 8364,-4257 8364,-4204 8551,-4204 8551,-4257"/>
<text text-anchor="middle" x="8457.5" y="-4241.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8457.5" y="-4226.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8457.5" y="-4211.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge309" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M8887.82,-4302.95C8795.99,-4287.7 8656.31,-4264.51 8561.18,-4248.71"/>
<polygon fill="black" stroke="black" points="8561.69,-4245.25 8551.25,-4247.07 8560.54,-4252.16 8561.69,-4245.25"/>
</g>
<!-- residual2_11 -->
<g id="node220" class="node">
<title>residual2_11</title>
<polygon fill="#f0f8ff" stroke="black" points="9478,-3812 9291,-3812 9291,-3759 9478,-3759 9478,-3812"/>
<text text-anchor="middle" x="9384.5" y="-3796.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9384.5" y="-3781.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9384.5" y="-3766.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- residual1_11&#45;&gt;residual2_11 -->
<g id="edge310" class="edge">
<title>residual1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M9075.07,-4302.37C9209.82,-4276.45 9442.5,-4220.41 9442.5,-4142.5 9442.5,-4142.5 9442.5,-4142.5 9442.5,-3962.5 9442.5,-3911.48 9420.24,-3856.13 9403.3,-3821.39"/>
<polygon fill="black" stroke="black" points="9406.29,-3819.54 9398.69,-3812.16 9400.03,-3822.67 9406.29,-3819.54"/>
</g>
<!-- ln1_11 -->
<g id="node213" class="node">
<title>ln1_11</title>
<polygon fill="#ffe4e1" stroke="black" points="9245,-4902 9058,-4902 9058,-4849 9245,-4849 9245,-4902"/>
<text text-anchor="middle" x="9151.5" y="-4886.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9151.5" y="-4871.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9151.5" y="-4856.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_qkv_11 -->
<g id="node214" class="node">
<title>attn_qkv_11</title>
<polygon fill="#ffe6e6" stroke="black" points="9347.5,-4813 8955.5,-4813 8955.5,-4760 9347.5,-4760 9347.5,-4813"/>
<text text-anchor="middle" x="9151.5" y="-4797.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9151.5" y="-4782.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="9151.5" y="-4767.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- ln1_11&#45;&gt;attn_qkv_11 -->
<g id="edge303" class="edge">
<title>ln1_11&#45;&gt;attn_qkv_11</title>
<path fill="none" stroke="black" d="M9151.5,-4848.87C9151.5,-4840.89 9151.5,-4831.93 9151.5,-4823.38"/>
<polygon fill="black" stroke="black" points="9155,-4823.25 9151.5,-4813.25 9148,-4823.25 9155,-4823.25"/>
</g>
<!-- attn_score_11 -->
<g id="node215" class="node">
<title>attn_score_11</title>
<polygon fill="#ffe6e6" stroke="black" points="9233.5,-4724 9069.5,-4724 9069.5,-4671 9233.5,-4671 9233.5,-4724"/>
<text text-anchor="middle" x="9151.5" y="-4708.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9151.5" y="-4693.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="9151.5" y="-4678.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_qkv_11&#45;&gt;attn_score_11 -->
<g id="edge304" class="edge">
<title>attn_qkv_11&#45;&gt;attn_score_11</title>
<path fill="none" stroke="black" d="M9151.5,-4759.87C9151.5,-4751.89 9151.5,-4742.93 9151.5,-4734.38"/>
<polygon fill="black" stroke="black" points="9155,-4734.25 9151.5,-4724.25 9148,-4734.25 9155,-4734.25"/>
</g>
<!-- attn_weight_11 -->
<g id="node216" class="node">
<title>attn_weight_11</title>
<polygon fill="#ffe6e6" stroke="black" points="9233.5,-4635 9069.5,-4635 9069.5,-4582 9233.5,-4582 9233.5,-4635"/>
<text text-anchor="middle" x="9151.5" y="-4619.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="9151.5" y="-4604.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="9151.5" y="-4589.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_score_11&#45;&gt;attn_weight_11 -->
<g id="edge305" class="edge">
<title>attn_score_11&#45;&gt;attn_weight_11</title>
<path fill="none" stroke="black" d="M9151.5,-4670.87C9151.5,-4662.89 9151.5,-4653.93 9151.5,-4645.38"/>
<polygon fill="black" stroke="black" points="9155,-4645.25 9151.5,-4635.25 9148,-4645.25 9155,-4645.25"/>
</g>
<!-- attn_context_11 -->
<g id="node217" class="node">
<title>attn_context_11</title>
<polygon fill="#ffe6e6" stroke="black" points="9245,-4546 9058,-4546 9058,-4493 9245,-4493 9245,-4546"/>
<text text-anchor="middle" x="9151.5" y="-4530.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="9151.5" y="-4515.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9151.5" y="-4500.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_weight_11&#45;&gt;attn_context_11 -->
<g id="edge306" class="edge">
<title>attn_weight_11&#45;&gt;attn_context_11</title>
<path fill="none" stroke="black" d="M9151.5,-4581.87C9151.5,-4573.89 9151.5,-4564.93 9151.5,-4556.38"/>
<polygon fill="black" stroke="black" points="9155,-4556.25 9151.5,-4546.25 9148,-4556.25 9155,-4556.25"/>
</g>
<!-- attn_out_11 -->
<g id="node218" class="node">
<title>attn_out_11</title>
<polygon fill="#ffe6e6" stroke="black" points="9341,-4446 8962,-4446 8962,-4393 9341,-4393 9341,-4446"/>
<text text-anchor="middle" x="9151.5" y="-4430.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9151.5" y="-4415.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9151.5" y="-4400.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_context_11&#45;&gt;attn_out_11 -->
<g id="edge307" class="edge">
<title>attn_context_11&#45;&gt;attn_out_11</title>
<path fill="none" stroke="black" d="M9151.5,-4492.75C9151.5,-4481.61 9151.5,-4468.38 9151.5,-4456.31"/>
<polygon fill="black" stroke="black" points="9155,-4456.08 9151.5,-4446.08 9148,-4456.08 9155,-4456.08"/>
</g>
<!-- attn_out_11&#45;&gt;residual1_11 -->
<g id="edge308" class="edge">
<title>attn_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M9106.83,-4392.75C9084.68,-4379.98 9057.76,-4364.46 9034.56,-4351.09"/>
<polygon fill="black" stroke="black" points="9036.28,-4348.04 9025.87,-4346.08 9032.78,-4354.1 9036.28,-4348.04"/>
</g>
<!-- moe_gate_11 -->
<g id="node221" class="node">
<title>moe_gate_11</title>
<polygon fill="#e6e6ff" stroke="black" points="8353.5,-4168 8037.5,-4168 8037.5,-4115 8353.5,-4115 8353.5,-4168"/>
<text text-anchor="middle" x="8195.5" y="-4152.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="8195.5" y="-4137.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="8195.5" y="-4122.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- ln2_11&#45;&gt;moe_gate_11 -->
<g id="edge311" class="edge">
<title>ln2_11&#45;&gt;moe_gate_11</title>
<path fill="none" stroke="black" d="M8380.66,-4203.98C8349.74,-4193.72 8313.92,-4181.82 8282.08,-4171.25"/>
<polygon fill="black" stroke="black" points="8282.93,-4167.84 8272.34,-4168.01 8280.72,-4174.49 8282.93,-4167.84"/>
</g>
<!-- comm_11_12 -->
<g id="node232" class="node">
<title>comm_11_12</title>
<ellipse fill="#f0e6ff" stroke="black" cx="9384.5" cy="-3685.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="9384.5" y="-3696.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="9384.5" y="-3681.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9384.5" y="-3666.8" font-family="Arial" font-size="14.00">GPU: 10 → GPU: 11</text>
</g>
<!-- residual2_11&#45;&gt;comm_11_12 -->
<g id="edge331" class="edge">
<title>residual2_11&#45;&gt;comm_11_12</title>
<path fill="none" stroke="black" d="M9384.5,-3758.75C9384.5,-3750.93 9384.5,-3742.07 9384.5,-3733.31"/>
<polygon fill="black" stroke="black" points="9388,-3733.13 9384.5,-3723.13 9381,-3733.13 9388,-3733.13"/>
</g>
<!-- expert_11_0 -->
<g id="node222" class="node">
<title>expert_11_0</title>
<polygon fill="#e6ffe6" stroke="black" points="6598,-4079 6219,-4079 6219,-4026 6598,-4026 6598,-4079"/>
<text text-anchor="middle" x="6408.5" y="-4063.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6408.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6408.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_11_0 -->
<g id="edge312" class="edge">
<title>moe_gate_11&#45;&gt;expert_11_0</title>
<path fill="none" stroke="black" d="M8037.44,-4139.02C7753.42,-4135.33 7137.78,-4122.66 6608.19,-4079.02"/>
<polygon fill="black" stroke="black" points="6608.31,-4075.52 6598.05,-4078.18 6607.73,-4082.5 6608.31,-4075.52"/>
</g>
<!-- expert_11_1 -->
<g id="node223" class="node">
<title>expert_11_1</title>
<polygon fill="#e6ffe6" stroke="black" points="6995,-4079 6616,-4079 6616,-4026 6995,-4026 6995,-4079"/>
<text text-anchor="middle" x="6805.5" y="-4063.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6805.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6805.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_11_1 -->
<g id="edge313" class="edge">
<title>moe_gate_11&#45;&gt;expert_11_1</title>
<path fill="none" stroke="black" d="M8037.26,-4136.15C7810.85,-4129.06 7381.26,-4112.43 7005.05,-4079.02"/>
<polygon fill="black" stroke="black" points="7005.33,-4075.53 6995.06,-4078.12 7004.71,-4082.5 7005.33,-4075.53"/>
</g>
<!-- expert_11_2 -->
<g id="node224" class="node">
<title>expert_11_2</title>
<polygon fill="#e6ffe6" stroke="black" points="7392,-4079 7013,-4079 7013,-4026 7392,-4026 7392,-4079"/>
<text text-anchor="middle" x="7202.5" y="-4063.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7202.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7202.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_11_2 -->
<g id="edge314" class="edge">
<title>moe_gate_11&#45;&gt;expert_11_2</title>
<path fill="none" stroke="black" d="M8037.49,-4130.6C7879.45,-4120.16 7629.19,-4102.16 7402.18,-4079.05"/>
<polygon fill="black" stroke="black" points="7402.37,-4075.55 7392.07,-4078.01 7401.66,-4082.51 7402.37,-4075.55"/>
</g>
<!-- expert_11_3 -->
<g id="node225" class="node">
<title>expert_11_3</title>
<polygon fill="#e6ffe6" stroke="black" points="7789,-4079 7410,-4079 7410,-4026 7789,-4026 7789,-4079"/>
<text text-anchor="middle" x="7599.5" y="-4063.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7599.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7599.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_11_3 -->
<g id="edge315" class="edge">
<title>moe_gate_11&#45;&gt;expert_11_3</title>
<path fill="none" stroke="black" d="M8037.35,-4117.41C7959.71,-4106.08 7865.7,-4092.36 7784.72,-4080.54"/>
<polygon fill="black" stroke="black" points="7784.81,-4077.01 7774.4,-4079.03 7783.79,-4083.94 7784.81,-4077.01"/>
</g>
<!-- expert_11_4 -->
<g id="node226" class="node">
<title>expert_11_4</title>
<polygon fill="#e6ffe6" stroke="black" points="8186,-4079 7807,-4079 7807,-4026 8186,-4026 8186,-4079"/>
<text text-anchor="middle" x="7996.5" y="-4063.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="7996.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7996.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_11_4 -->
<g id="edge316" class="edge">
<title>moe_gate_11&#45;&gt;expert_11_4</title>
<path fill="none" stroke="black" d="M8137.14,-4114.98C8114.26,-4104.98 8087.85,-4093.44 8064.14,-4083.07"/>
<polygon fill="black" stroke="black" points="8065.43,-4079.81 8054.86,-4079.01 8062.62,-4086.23 8065.43,-4079.81"/>
</g>
<!-- expert_11_5 -->
<g id="node227" class="node">
<title>expert_11_5</title>
<polygon fill="#e6ffe6" stroke="black" points="8583,-4079 8204,-4079 8204,-4026 8583,-4026 8583,-4079"/>
<text text-anchor="middle" x="8393.5" y="-4063.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8393.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8393.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_11_5 -->
<g id="edge317" class="edge">
<title>moe_gate_11&#45;&gt;expert_11_5</title>
<path fill="none" stroke="black" d="M8253.57,-4114.98C8276.34,-4104.98 8302.61,-4093.44 8326.2,-4083.07"/>
<polygon fill="black" stroke="black" points="8327.69,-4086.24 8335.43,-4079.01 8324.87,-4079.83 8327.69,-4086.24"/>
</g>
<!-- expert_11_6 -->
<g id="node228" class="node">
<title>expert_11_6</title>
<polygon fill="#e6ffe6" stroke="black" points="8980,-4079 8601,-4079 8601,-4026 8980,-4026 8980,-4079"/>
<text text-anchor="middle" x="8790.5" y="-4063.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="8790.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8790.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_11_6 -->
<g id="edge318" class="edge">
<title>moe_gate_11&#45;&gt;expert_11_6</title>
<path fill="none" stroke="black" d="M8353.78,-4117.36C8431.2,-4106.04 8524.86,-4092.34 8605.56,-4080.54"/>
<polygon fill="black" stroke="black" points="8606.45,-4083.95 8615.84,-4079.04 8605.44,-4077.02 8606.45,-4083.95"/>
</g>
<!-- expert_11_7 -->
<g id="node229" class="node">
<title>expert_11_7</title>
<polygon fill="#e6ffe6" stroke="black" points="9377,-4079 8998,-4079 8998,-4026 9377,-4026 9377,-4079"/>
<text text-anchor="middle" x="9187.5" y="-4063.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="9187.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9187.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_11_7 -->
<g id="edge319" class="edge">
<title>moe_gate_11&#45;&gt;expert_11_7</title>
<path fill="none" stroke="black" d="M8353.52,-4130.63C8511.56,-4120.21 8761.82,-4102.23 8987.77,-4079.16"/>
<polygon fill="black" stroke="black" points="8988.24,-4082.63 8997.83,-4078.13 8987.53,-4075.67 8988.24,-4082.63"/>
</g>
<!-- expert_combine_11 -->
<g id="node230" class="node">
<title>expert_combine_11</title>
<polygon fill="#fff0e6" stroke="black" points="8288,-3990 8101,-3990 8101,-3937 8288,-3937 8288,-3990"/>
<text text-anchor="middle" x="8194.5" y="-3974.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="8194.5" y="-3959.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8194.5" y="-3944.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- moe_gate_11&#45;&gt;expert_combine_11 -->
<g id="edge320" class="edge">
<title>moe_gate_11&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M8353.53,-4138.04C8669.38,-4132.35 9351.5,-4115.85 9386.5,-4079 9402.72,-4061.92 9402.72,-4043.08 9386.5,-4026 9349.3,-3986.83 8581.65,-3970.67 8298.35,-3966.02"/>
<polygon fill="black" stroke="black" points="8298.12,-3962.51 8288.07,-3965.85 8298.01,-3969.51 8298.12,-3962.51"/>
</g>
<!-- expert_11_0&#45;&gt;expert_combine_11 -->
<g id="edge321" class="edge">
<title>expert_11_0&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M6598.05,-4026.82C6601.23,-4026.53 6604.38,-4026.26 6607.5,-4026 7165.46,-3979.53 7836.77,-3968.09 8090.55,-3965.34"/>
<polygon fill="black" stroke="black" points="8090.9,-3968.84 8100.86,-3965.23 8090.83,-3961.84 8090.9,-3968.84"/>
</g>
<!-- expert_11_1&#45;&gt;expert_combine_11 -->
<g id="edge322" class="edge">
<title>expert_11_1&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M6995.06,-4026.88C6998.23,-4026.57 7001.38,-4026.28 7004.5,-4026 7405.19,-3990.03 7883.81,-3973.22 8090.74,-3967.22"/>
<polygon fill="black" stroke="black" points="8091.1,-3970.71 8100.99,-3966.92 8090.89,-3963.71 8091.1,-3970.71"/>
</g>
<!-- expert_11_2&#45;&gt;expert_combine_11 -->
<g id="edge323" class="edge">
<title>expert_11_2&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M7392.07,-4026.99C7395.24,-4026.65 7398.38,-4026.32 7401.5,-4026 7648.24,-4000.64 7939.13,-3980.59 8090.75,-3970.88"/>
<polygon fill="black" stroke="black" points="8091.22,-3974.36 8100.97,-3970.23 8090.77,-3967.38 8091.22,-3974.36"/>
</g>
<!-- expert_11_3&#45;&gt;expert_combine_11 -->
<g id="edge324" class="edge">
<title>expert_11_3&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M7774,-4025.98C7876.85,-4010.95 8003.51,-3992.43 8090.78,-3979.67"/>
<polygon fill="black" stroke="black" points="8091.3,-3983.13 8100.69,-3978.22 8090.29,-3976.2 8091.3,-3983.13"/>
</g>
<!-- expert_11_4&#45;&gt;expert_combine_11 -->
<g id="edge325" class="edge">
<title>expert_11_4&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M8054.57,-4025.98C8077.34,-4015.98 8103.61,-4004.44 8127.2,-3994.07"/>
<polygon fill="black" stroke="black" points="8128.69,-3997.24 8136.43,-3990.01 8125.87,-3990.83 8128.69,-3997.24"/>
</g>
<!-- expert_11_5&#45;&gt;expert_combine_11 -->
<g id="edge326" class="edge">
<title>expert_11_5&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M8335.14,-4025.98C8312.26,-4015.98 8285.85,-4004.44 8262.14,-3994.07"/>
<polygon fill="black" stroke="black" points="8263.43,-3990.81 8252.86,-3990.01 8260.62,-3997.23 8263.43,-3990.81"/>
</g>
<!-- expert_11_6&#45;&gt;expert_combine_11 -->
<g id="edge327" class="edge">
<title>expert_11_6&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M8615.71,-4025.98C8512.52,-4010.92 8385.41,-3992.37 8297.97,-3979.6"/>
<polygon fill="black" stroke="black" points="8298.45,-3976.14 8288.04,-3978.16 8297.43,-3983.06 8298.45,-3976.14"/>
</g>
<!-- expert_11_7&#45;&gt;expert_combine_11 -->
<g id="edge328" class="edge">
<title>expert_11_7&#45;&gt;expert_combine_11</title>
<path fill="none" stroke="black" d="M8997.83,-4026.87C8995.04,-4026.58 8992.26,-4026.28 8989.5,-4026 8742.15,-4000.52 8450.52,-3980.52 8298.52,-3970.85"/>
<polygon fill="black" stroke="black" points="8298.46,-3967.34 8288.26,-3970.2 8298.02,-3974.33 8298.46,-3967.34"/>
</g>
<!-- expert_out_11 -->
<g id="node231" class="node">
<title>expert_out_11</title>
<polygon fill="#fff0e6" stroke="black" points="8801,-3901 8422,-3901 8422,-3848 8801,-3848 8801,-3901"/>
<text text-anchor="middle" x="8611.5" y="-3885.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="8611.5" y="-3870.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8611.5" y="-3855.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_combine_11&#45;&gt;expert_out_11 -->
<g id="edge329" class="edge">
<title>expert_combine_11&#45;&gt;expert_out_11</title>
<path fill="none" stroke="black" d="M8288.08,-3942.98C8344.38,-3931.23 8416.94,-3916.09 8479.06,-3903.13"/>
<polygon fill="black" stroke="black" points="8479.86,-3906.54 8488.93,-3901.07 8478.43,-3899.69 8479.86,-3906.54"/>
</g>
<!-- expert_out_11&#45;&gt;residual2_11 -->
<g id="edge330" class="edge">
<title>expert_out_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M8801.09,-3852.16C8952.28,-3835.15 9158.33,-3811.96 9280.77,-3798.17"/>
<polygon fill="black" stroke="black" points="9281.35,-3801.63 9290.89,-3797.04 9280.56,-3794.68 9281.35,-3801.63"/>
</g>
<!-- residual1_12 -->
<g id="node233" class="node">
<title>residual1_12</title>
<polygon fill="#f0f8ff" stroke="black" points="9648,-3612 9461,-3612 9461,-3559 9648,-3559 9648,-3612"/>
<text text-anchor="middle" x="9554.5" y="-3596.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9554.5" y="-3581.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9554.5" y="-3566.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- comm_11_12&#45;&gt;residual1_12 -->
<g id="edge332" class="edge">
<title>comm_11_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M9441.58,-3651.59C9460.9,-3640.46 9482.38,-3628.07 9501.38,-3617.12"/>
<polygon fill="black" stroke="black" points="9503.29,-3620.06 9510.2,-3612.04 9499.79,-3614 9503.29,-3620.06"/>
</g>
<!-- ln2_12 -->
<g id="node240" class="node">
<title>ln2_12</title>
<polygon fill="#ffe4e1" stroke="black" points="9124,-3523 8937,-3523 8937,-3470 9124,-3470 9124,-3523"/>
<text text-anchor="middle" x="9030.5" y="-3507.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9030.5" y="-3492.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9030.5" y="-3477.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge339" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M9460.82,-3568.95C9368.99,-3553.7 9229.31,-3530.51 9134.18,-3514.71"/>
<polygon fill="black" stroke="black" points="9134.69,-3511.25 9124.25,-3513.07 9133.54,-3518.16 9134.69,-3511.25"/>
</g>
<!-- residual2_12 -->
<g id="node241" class="node">
<title>residual2_12</title>
<polygon fill="#f0f8ff" stroke="black" points="10051,-3078 9864,-3078 9864,-3025 10051,-3025 10051,-3078"/>
<text text-anchor="middle" x="9957.5" y="-3062.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9957.5" y="-3047.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9957.5" y="-3032.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- residual1_12&#45;&gt;residual2_12 -->
<g id="edge340" class="edge">
<title>residual1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M9648.07,-3568.37C9782.82,-3542.45 10015.5,-3486.41 10015.5,-3408.5 10015.5,-3408.5 10015.5,-3408.5 10015.5,-3228.5 10015.5,-3177.48 9993.24,-3122.13 9976.3,-3087.39"/>
<polygon fill="black" stroke="black" points="9979.29,-3085.54 9971.69,-3078.16 9973.03,-3088.67 9979.29,-3085.54"/>
</g>
<!-- ln1_12 -->
<g id="node234" class="node">
<title>ln1_12</title>
<polygon fill="#ffe4e1" stroke="black" points="9818,-4168 9631,-4168 9631,-4115 9818,-4115 9818,-4168"/>
<text text-anchor="middle" x="9724.5" y="-4152.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9724.5" y="-4137.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9724.5" y="-4122.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_qkv_12 -->
<g id="node235" class="node">
<title>attn_qkv_12</title>
<polygon fill="#ffe6e6" stroke="black" points="9920.5,-4079 9528.5,-4079 9528.5,-4026 9920.5,-4026 9920.5,-4079"/>
<text text-anchor="middle" x="9724.5" y="-4063.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="9724.5" y="-4048.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="9724.5" y="-4033.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- ln1_12&#45;&gt;attn_qkv_12 -->
<g id="edge333" class="edge">
<title>ln1_12&#45;&gt;attn_qkv_12</title>
<path fill="none" stroke="black" d="M9724.5,-4114.87C9724.5,-4106.89 9724.5,-4097.93 9724.5,-4089.38"/>
<polygon fill="black" stroke="black" points="9728,-4089.25 9724.5,-4079.25 9721,-4089.25 9728,-4089.25"/>
</g>
<!-- attn_score_12 -->
<g id="node236" class="node">
<title>attn_score_12</title>
<polygon fill="#ffe6e6" stroke="black" points="9806.5,-3990 9642.5,-3990 9642.5,-3937 9806.5,-3937 9806.5,-3990"/>
<text text-anchor="middle" x="9724.5" y="-3974.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="9724.5" y="-3959.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="9724.5" y="-3944.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_qkv_12&#45;&gt;attn_score_12 -->
<g id="edge334" class="edge">
<title>attn_qkv_12&#45;&gt;attn_score_12</title>
<path fill="none" stroke="black" d="M9724.5,-4025.87C9724.5,-4017.89 9724.5,-4008.93 9724.5,-4000.38"/>
<polygon fill="black" stroke="black" points="9728,-4000.25 9724.5,-3990.25 9721,-4000.25 9728,-4000.25"/>
</g>
<!-- attn_weight_12 -->
<g id="node237" class="node">
<title>attn_weight_12</title>
<polygon fill="#ffe6e6" stroke="black" points="9806.5,-3901 9642.5,-3901 9642.5,-3848 9806.5,-3848 9806.5,-3901"/>
<text text-anchor="middle" x="9724.5" y="-3885.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="9724.5" y="-3870.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="9724.5" y="-3855.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_score_12&#45;&gt;attn_weight_12 -->
<g id="edge335" class="edge">
<title>attn_score_12&#45;&gt;attn_weight_12</title>
<path fill="none" stroke="black" d="M9724.5,-3936.87C9724.5,-3928.89 9724.5,-3919.93 9724.5,-3911.38"/>
<polygon fill="black" stroke="black" points="9728,-3911.25 9724.5,-3901.25 9721,-3911.25 9728,-3911.25"/>
</g>
<!-- attn_context_12 -->
<g id="node238" class="node">
<title>attn_context_12</title>
<polygon fill="#ffe6e6" stroke="black" points="9818,-3812 9631,-3812 9631,-3759 9818,-3759 9818,-3812"/>
<text text-anchor="middle" x="9724.5" y="-3796.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="9724.5" y="-3781.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9724.5" y="-3766.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_weight_12&#45;&gt;attn_context_12 -->
<g id="edge336" class="edge">
<title>attn_weight_12&#45;&gt;attn_context_12</title>
<path fill="none" stroke="black" d="M9724.5,-3847.87C9724.5,-3839.89 9724.5,-3830.93 9724.5,-3822.38"/>
<polygon fill="black" stroke="black" points="9728,-3822.25 9724.5,-3812.25 9721,-3822.25 9728,-3822.25"/>
</g>
<!-- attn_out_12 -->
<g id="node239" class="node">
<title>attn_out_12</title>
<polygon fill="#ffe6e6" stroke="black" points="9914,-3712 9535,-3712 9535,-3659 9914,-3659 9914,-3712"/>
<text text-anchor="middle" x="9724.5" y="-3696.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="9724.5" y="-3681.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9724.5" y="-3666.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_context_12&#45;&gt;attn_out_12 -->
<g id="edge337" class="edge">
<title>attn_context_12&#45;&gt;attn_out_12</title>
<path fill="none" stroke="black" d="M9724.5,-3758.75C9724.5,-3747.61 9724.5,-3734.38 9724.5,-3722.31"/>
<polygon fill="black" stroke="black" points="9728,-3722.08 9724.5,-3712.08 9721,-3722.08 9728,-3722.08"/>
</g>
<!-- attn_out_12&#45;&gt;residual1_12 -->
<g id="edge338" class="edge">
<title>attn_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M9679.83,-3658.75C9657.68,-3645.98 9630.76,-3630.46 9607.56,-3617.09"/>
<polygon fill="black" stroke="black" points="9609.28,-3614.04 9598.87,-3612.08 9605.78,-3620.1 9609.28,-3614.04"/>
</g>
<!-- moe_gate_12 -->
<g id="node242" class="node">
<title>moe_gate_12</title>
<polygon fill="#e6e6ff" stroke="black" points="8926.5,-3434 8610.5,-3434 8610.5,-3381 8926.5,-3381 8926.5,-3434"/>
<text text-anchor="middle" x="8768.5" y="-3418.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="8768.5" y="-3403.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="8768.5" y="-3388.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- ln2_12&#45;&gt;moe_gate_12 -->
<g id="edge341" class="edge">
<title>ln2_12&#45;&gt;moe_gate_12</title>
<path fill="none" stroke="black" d="M8953.66,-3469.98C8922.74,-3459.72 8886.92,-3447.82 8855.08,-3437.25"/>
<polygon fill="black" stroke="black" points="8855.93,-3433.84 8845.34,-3434.01 8853.72,-3440.49 8855.93,-3433.84"/>
</g>
<!-- comm_12_13 -->
<g id="node253" class="node">
<title>comm_12_13</title>
<ellipse fill="#f0e6ff" stroke="black" cx="9957.5" cy="-2951.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="9957.5" y="-2962.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="9957.5" y="-2947.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9957.5" y="-2932.8" font-family="Arial" font-size="14.00">GPU: 11 → GPU: 12</text>
</g>
<!-- residual2_12&#45;&gt;comm_12_13 -->
<g id="edge361" class="edge">
<title>residual2_12&#45;&gt;comm_12_13</title>
<path fill="none" stroke="black" d="M9957.5,-3024.75C9957.5,-3016.93 9957.5,-3008.07 9957.5,-2999.31"/>
<polygon fill="black" stroke="black" points="9961,-2999.13 9957.5,-2989.13 9954,-2999.13 9961,-2999.13"/>
</g>
<!-- expert_12_0 -->
<g id="node243" class="node">
<title>expert_12_0</title>
<polygon fill="#e6ffe6" stroke="black" points="7171,-3345 6792,-3345 6792,-3292 7171,-3292 7171,-3345"/>
<text text-anchor="middle" x="6981.5" y="-3329.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6981.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="6981.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_12_0 -->
<g id="edge342" class="edge">
<title>moe_gate_12&#45;&gt;expert_12_0</title>
<path fill="none" stroke="black" d="M8610.44,-3405.02C8326.42,-3401.33 7710.78,-3388.66 7181.19,-3345.02"/>
<polygon fill="black" stroke="black" points="7181.31,-3341.52 7171.05,-3344.18 7180.73,-3348.5 7181.31,-3341.52"/>
</g>
<!-- expert_12_1 -->
<g id="node244" class="node">
<title>expert_12_1</title>
<polygon fill="#e6ffe6" stroke="black" points="7568,-3345 7189,-3345 7189,-3292 7568,-3292 7568,-3345"/>
<text text-anchor="middle" x="7378.5" y="-3329.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7378.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7378.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_12_1 -->
<g id="edge343" class="edge">
<title>moe_gate_12&#45;&gt;expert_12_1</title>
<path fill="none" stroke="black" d="M8610.26,-3402.15C8383.85,-3395.06 7954.26,-3378.43 7578.05,-3345.02"/>
<polygon fill="black" stroke="black" points="7578.33,-3341.53 7568.06,-3344.12 7577.71,-3348.5 7578.33,-3341.53"/>
</g>
<!-- expert_12_2 -->
<g id="node245" class="node">
<title>expert_12_2</title>
<polygon fill="#e6ffe6" stroke="black" points="7965,-3345 7586,-3345 7586,-3292 7965,-3292 7965,-3345"/>
<text text-anchor="middle" x="7775.5" y="-3329.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7775.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7775.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_12_2 -->
<g id="edge344" class="edge">
<title>moe_gate_12&#45;&gt;expert_12_2</title>
<path fill="none" stroke="black" d="M8610.49,-3396.6C8452.45,-3386.16 8202.19,-3368.16 7975.18,-3345.05"/>
<polygon fill="black" stroke="black" points="7975.37,-3341.55 7965.07,-3344.01 7974.66,-3348.51 7975.37,-3341.55"/>
</g>
<!-- expert_12_3 -->
<g id="node246" class="node">
<title>expert_12_3</title>
<polygon fill="#e6ffe6" stroke="black" points="8362,-3345 7983,-3345 7983,-3292 8362,-3292 8362,-3345"/>
<text text-anchor="middle" x="8172.5" y="-3329.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="8172.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8172.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_12_3 -->
<g id="edge345" class="edge">
<title>moe_gate_12&#45;&gt;expert_12_3</title>
<path fill="none" stroke="black" d="M8610.35,-3383.41C8532.71,-3372.08 8438.7,-3358.36 8357.72,-3346.54"/>
<polygon fill="black" stroke="black" points="8357.81,-3343.01 8347.4,-3345.03 8356.79,-3349.94 8357.81,-3343.01"/>
</g>
<!-- expert_12_4 -->
<g id="node247" class="node">
<title>expert_12_4</title>
<polygon fill="#e6ffe6" stroke="black" points="8759,-3345 8380,-3345 8380,-3292 8759,-3292 8759,-3345"/>
<text text-anchor="middle" x="8569.5" y="-3329.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8569.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8569.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_12_4 -->
<g id="edge346" class="edge">
<title>moe_gate_12&#45;&gt;expert_12_4</title>
<path fill="none" stroke="black" d="M8710.14,-3380.98C8687.26,-3370.98 8660.85,-3359.44 8637.14,-3349.07"/>
<polygon fill="black" stroke="black" points="8638.43,-3345.81 8627.86,-3345.01 8635.62,-3352.23 8638.43,-3345.81"/>
</g>
<!-- expert_12_5 -->
<g id="node248" class="node">
<title>expert_12_5</title>
<polygon fill="#e6ffe6" stroke="black" points="9156,-3345 8777,-3345 8777,-3292 9156,-3292 9156,-3345"/>
<text text-anchor="middle" x="8966.5" y="-3329.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8966.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8966.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_12_5 -->
<g id="edge347" class="edge">
<title>moe_gate_12&#45;&gt;expert_12_5</title>
<path fill="none" stroke="black" d="M8826.57,-3380.98C8849.34,-3370.98 8875.61,-3359.44 8899.2,-3349.07"/>
<polygon fill="black" stroke="black" points="8900.69,-3352.24 8908.43,-3345.01 8897.87,-3345.83 8900.69,-3352.24"/>
</g>
<!-- expert_12_6 -->
<g id="node249" class="node">
<title>expert_12_6</title>
<polygon fill="#e6ffe6" stroke="black" points="9553,-3345 9174,-3345 9174,-3292 9553,-3292 9553,-3345"/>
<text text-anchor="middle" x="9363.5" y="-3329.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9363.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9363.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_12_6 -->
<g id="edge348" class="edge">
<title>moe_gate_12&#45;&gt;expert_12_6</title>
<path fill="none" stroke="black" d="M8926.78,-3383.36C9004.2,-3372.04 9097.86,-3358.34 9178.56,-3346.54"/>
<polygon fill="black" stroke="black" points="9179.45,-3349.95 9188.84,-3345.04 9178.44,-3343.02 9179.45,-3349.95"/>
</g>
<!-- expert_12_7 -->
<g id="node250" class="node">
<title>expert_12_7</title>
<polygon fill="#e6ffe6" stroke="black" points="9950,-3345 9571,-3345 9571,-3292 9950,-3292 9950,-3345"/>
<text text-anchor="middle" x="9760.5" y="-3329.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="9760.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9760.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_12_7 -->
<g id="edge349" class="edge">
<title>moe_gate_12&#45;&gt;expert_12_7</title>
<path fill="none" stroke="black" d="M8926.52,-3396.63C9084.56,-3386.21 9334.82,-3368.23 9560.77,-3345.16"/>
<polygon fill="black" stroke="black" points="9561.24,-3348.63 9570.83,-3344.13 9560.53,-3341.67 9561.24,-3348.63"/>
</g>
<!-- expert_combine_12 -->
<g id="node251" class="node">
<title>expert_combine_12</title>
<polygon fill="#fff0e6" stroke="black" points="8861,-3256 8674,-3256 8674,-3203 8861,-3203 8861,-3256"/>
<text text-anchor="middle" x="8767.5" y="-3240.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="8767.5" y="-3225.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8767.5" y="-3210.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- moe_gate_12&#45;&gt;expert_combine_12 -->
<g id="edge350" class="edge">
<title>moe_gate_12&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M8926.53,-3404.04C9242.38,-3398.35 9924.5,-3381.85 9959.5,-3345 9975.72,-3327.92 9975.72,-3309.08 9959.5,-3292 9922.3,-3252.83 9154.65,-3236.67 8871.35,-3232.02"/>
<polygon fill="black" stroke="black" points="8871.12,-3228.51 8861.07,-3231.85 8871.01,-3235.51 8871.12,-3228.51"/>
</g>
<!-- expert_12_0&#45;&gt;expert_combine_12 -->
<g id="edge351" class="edge">
<title>expert_12_0&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M7171.05,-3292.82C7174.23,-3292.53 7177.38,-3292.26 7180.5,-3292 7738.46,-3245.53 8409.77,-3234.09 8663.55,-3231.34"/>
<polygon fill="black" stroke="black" points="8663.9,-3234.84 8673.86,-3231.23 8663.83,-3227.84 8663.9,-3234.84"/>
</g>
<!-- expert_12_1&#45;&gt;expert_combine_12 -->
<g id="edge352" class="edge">
<title>expert_12_1&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M7568.06,-3292.88C7571.23,-3292.57 7574.38,-3292.28 7577.5,-3292 7978.19,-3256.03 8456.81,-3239.22 8663.74,-3233.22"/>
<polygon fill="black" stroke="black" points="8664.1,-3236.71 8673.99,-3232.92 8663.89,-3229.71 8664.1,-3236.71"/>
</g>
<!-- expert_12_2&#45;&gt;expert_combine_12 -->
<g id="edge353" class="edge">
<title>expert_12_2&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M7965.07,-3292.99C7968.24,-3292.65 7971.38,-3292.32 7974.5,-3292 8221.24,-3266.64 8512.13,-3246.59 8663.75,-3236.88"/>
<polygon fill="black" stroke="black" points="8664.22,-3240.36 8673.97,-3236.23 8663.77,-3233.38 8664.22,-3240.36"/>
</g>
<!-- expert_12_3&#45;&gt;expert_combine_12 -->
<g id="edge354" class="edge">
<title>expert_12_3&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M8347,-3291.98C8449.85,-3276.95 8576.51,-3258.43 8663.78,-3245.67"/>
<polygon fill="black" stroke="black" points="8664.3,-3249.13 8673.69,-3244.22 8663.29,-3242.2 8664.3,-3249.13"/>
</g>
<!-- expert_12_4&#45;&gt;expert_combine_12 -->
<g id="edge355" class="edge">
<title>expert_12_4&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M8627.57,-3291.98C8650.34,-3281.98 8676.61,-3270.44 8700.2,-3260.07"/>
<polygon fill="black" stroke="black" points="8701.69,-3263.24 8709.43,-3256.01 8698.87,-3256.83 8701.69,-3263.24"/>
</g>
<!-- expert_12_5&#45;&gt;expert_combine_12 -->
<g id="edge356" class="edge">
<title>expert_12_5&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M8908.14,-3291.98C8885.26,-3281.98 8858.85,-3270.44 8835.14,-3260.07"/>
<polygon fill="black" stroke="black" points="8836.43,-3256.81 8825.86,-3256.01 8833.62,-3263.23 8836.43,-3256.81"/>
</g>
<!-- expert_12_6&#45;&gt;expert_combine_12 -->
<g id="edge357" class="edge">
<title>expert_12_6&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M9188.71,-3291.98C9085.52,-3276.92 8958.41,-3258.37 8870.97,-3245.6"/>
<polygon fill="black" stroke="black" points="8871.45,-3242.14 8861.04,-3244.16 8870.43,-3249.06 8871.45,-3242.14"/>
</g>
<!-- expert_12_7&#45;&gt;expert_combine_12 -->
<g id="edge358" class="edge">
<title>expert_12_7&#45;&gt;expert_combine_12</title>
<path fill="none" stroke="black" d="M9570.83,-3292.87C9568.04,-3292.58 9565.26,-3292.28 9562.5,-3292 9315.15,-3266.52 9023.52,-3246.52 8871.52,-3236.85"/>
<polygon fill="black" stroke="black" points="8871.46,-3233.34 8861.26,-3236.2 8871.02,-3240.33 8871.46,-3233.34"/>
</g>
<!-- expert_out_12 -->
<g id="node252" class="node">
<title>expert_out_12</title>
<polygon fill="#fff0e6" stroke="black" points="9374,-3167 8995,-3167 8995,-3114 9374,-3114 9374,-3167"/>
<text text-anchor="middle" x="9184.5" y="-3151.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="9184.5" y="-3136.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9184.5" y="-3121.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_combine_12&#45;&gt;expert_out_12 -->
<g id="edge359" class="edge">
<title>expert_combine_12&#45;&gt;expert_out_12</title>
<path fill="none" stroke="black" d="M8861.08,-3208.98C8917.38,-3197.23 8989.94,-3182.09 9052.06,-3169.13"/>
<polygon fill="black" stroke="black" points="9052.86,-3172.54 9061.93,-3167.07 9051.43,-3165.69 9052.86,-3172.54"/>
</g>
<!-- expert_out_12&#45;&gt;residual2_12 -->
<g id="edge360" class="edge">
<title>expert_out_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M9374.09,-3118.16C9525.28,-3101.15 9731.33,-3077.96 9853.77,-3064.17"/>
<polygon fill="black" stroke="black" points="9854.35,-3067.63 9863.89,-3063.04 9853.56,-3060.68 9854.35,-3067.63"/>
</g>
<!-- residual1_13 -->
<g id="node254" class="node">
<title>residual1_13</title>
<polygon fill="#f0f8ff" stroke="black" points="10221,-2878 10034,-2878 10034,-2825 10221,-2825 10221,-2878"/>
<text text-anchor="middle" x="10127.5" y="-2862.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10127.5" y="-2847.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10127.5" y="-2832.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- comm_12_13&#45;&gt;residual1_13 -->
<g id="edge362" class="edge">
<title>comm_12_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M10014.58,-2917.59C10033.9,-2906.46 10055.38,-2894.07 10074.38,-2883.12"/>
<polygon fill="black" stroke="black" points="10076.29,-2886.06 10083.2,-2878.04 10072.79,-2880 10076.29,-2886.06"/>
</g>
<!-- ln2_13 -->
<g id="node261" class="node">
<title>ln2_13</title>
<polygon fill="#ffe4e1" stroke="black" points="10161,-2789 9974,-2789 9974,-2736 10161,-2736 10161,-2789"/>
<text text-anchor="middle" x="10067.5" y="-2773.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10067.5" y="-2758.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10067.5" y="-2743.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge369" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M10109.82,-2824.87C10103.95,-2816.36 10097.33,-2806.75 10091.09,-2797.7"/>
<polygon fill="black" stroke="black" points="10093.82,-2795.49 10085.26,-2789.25 10088.05,-2799.47 10093.82,-2795.49"/>
</g>
<!-- residual2_13 -->
<g id="node262" class="node">
<title>residual2_13</title>
<polygon fill="#f0f8ff" stroke="black" points="10787,-2344 10600,-2344 10600,-2291 10787,-2291 10787,-2344"/>
<text text-anchor="middle" x="10693.5" y="-2328.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10693.5" y="-2313.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10693.5" y="-2298.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- residual1_13&#45;&gt;residual2_13 -->
<g id="edge370" class="edge">
<title>residual1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M10221.26,-2843.59C10395.45,-2828.17 10751.5,-2783.33 10751.5,-2674.5 10751.5,-2674.5 10751.5,-2674.5 10751.5,-2494.5 10751.5,-2443.48 10729.24,-2388.13 10712.3,-2353.39"/>
<polygon fill="black" stroke="black" points="10715.29,-2351.54 10707.69,-2344.16 10709.03,-2354.67 10715.29,-2351.54"/>
</g>
<!-- ln1_13 -->
<g id="node255" class="node">
<title>ln1_13</title>
<polygon fill="#ffe4e1" stroke="black" points="10391,-3434 10204,-3434 10204,-3381 10391,-3381 10391,-3434"/>
<text text-anchor="middle" x="10297.5" y="-3418.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10297.5" y="-3403.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10297.5" y="-3388.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_qkv_13 -->
<g id="node256" class="node">
<title>attn_qkv_13</title>
<polygon fill="#ffe6e6" stroke="black" points="10493.5,-3345 10101.5,-3345 10101.5,-3292 10493.5,-3292 10493.5,-3345"/>
<text text-anchor="middle" x="10297.5" y="-3329.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="10297.5" y="-3314.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="10297.5" y="-3299.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- ln1_13&#45;&gt;attn_qkv_13 -->
<g id="edge363" class="edge">
<title>ln1_13&#45;&gt;attn_qkv_13</title>
<path fill="none" stroke="black" d="M10297.5,-3380.87C10297.5,-3372.89 10297.5,-3363.93 10297.5,-3355.38"/>
<polygon fill="black" stroke="black" points="10301,-3355.25 10297.5,-3345.25 10294,-3355.25 10301,-3355.25"/>
</g>
<!-- attn_score_13 -->
<g id="node257" class="node">
<title>attn_score_13</title>
<polygon fill="#ffe6e6" stroke="black" points="10379.5,-3256 10215.5,-3256 10215.5,-3203 10379.5,-3203 10379.5,-3256"/>
<text text-anchor="middle" x="10297.5" y="-3240.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="10297.5" y="-3225.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="10297.5" y="-3210.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_qkv_13&#45;&gt;attn_score_13 -->
<g id="edge364" class="edge">
<title>attn_qkv_13&#45;&gt;attn_score_13</title>
<path fill="none" stroke="black" d="M10297.5,-3291.87C10297.5,-3283.89 10297.5,-3274.93 10297.5,-3266.38"/>
<polygon fill="black" stroke="black" points="10301,-3266.25 10297.5,-3256.25 10294,-3266.25 10301,-3266.25"/>
</g>
<!-- attn_weight_13 -->
<g id="node258" class="node">
<title>attn_weight_13</title>
<polygon fill="#ffe6e6" stroke="black" points="10379.5,-3167 10215.5,-3167 10215.5,-3114 10379.5,-3114 10379.5,-3167"/>
<text text-anchor="middle" x="10297.5" y="-3151.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="10297.5" y="-3136.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="10297.5" y="-3121.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_score_13&#45;&gt;attn_weight_13 -->
<g id="edge365" class="edge">
<title>attn_score_13&#45;&gt;attn_weight_13</title>
<path fill="none" stroke="black" d="M10297.5,-3202.87C10297.5,-3194.89 10297.5,-3185.93 10297.5,-3177.38"/>
<polygon fill="black" stroke="black" points="10301,-3177.25 10297.5,-3167.25 10294,-3177.25 10301,-3177.25"/>
</g>
<!-- attn_context_13 -->
<g id="node259" class="node">
<title>attn_context_13</title>
<polygon fill="#ffe6e6" stroke="black" points="10391,-3078 10204,-3078 10204,-3025 10391,-3025 10391,-3078"/>
<text text-anchor="middle" x="10297.5" y="-3062.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="10297.5" y="-3047.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10297.5" y="-3032.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_weight_13&#45;&gt;attn_context_13 -->
<g id="edge366" class="edge">
<title>attn_weight_13&#45;&gt;attn_context_13</title>
<path fill="none" stroke="black" d="M10297.5,-3113.87C10297.5,-3105.89 10297.5,-3096.93 10297.5,-3088.38"/>
<polygon fill="black" stroke="black" points="10301,-3088.25 10297.5,-3078.25 10294,-3088.25 10301,-3088.25"/>
</g>
<!-- attn_out_13 -->
<g id="node260" class="node">
<title>attn_out_13</title>
<polygon fill="#ffe6e6" stroke="black" points="10487,-2978 10108,-2978 10108,-2925 10487,-2925 10487,-2978"/>
<text text-anchor="middle" x="10297.5" y="-2962.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="10297.5" y="-2947.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10297.5" y="-2932.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_context_13&#45;&gt;attn_out_13 -->
<g id="edge367" class="edge">
<title>attn_context_13&#45;&gt;attn_out_13</title>
<path fill="none" stroke="black" d="M10297.5,-3024.75C10297.5,-3013.61 10297.5,-3000.38 10297.5,-2988.31"/>
<polygon fill="black" stroke="black" points="10301,-2988.08 10297.5,-2978.08 10294,-2988.08 10301,-2988.08"/>
</g>
<!-- attn_out_13&#45;&gt;residual1_13 -->
<g id="edge368" class="edge">
<title>attn_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M10252.83,-2924.75C10230.68,-2911.98 10203.76,-2896.46 10180.56,-2883.09"/>
<polygon fill="black" stroke="black" points="10182.28,-2880.04 10171.87,-2878.08 10178.78,-2886.1 10182.28,-2880.04"/>
</g>
<!-- moe_gate_13 -->
<g id="node263" class="node">
<title>moe_gate_13</title>
<polygon fill="#e6e6ff" stroke="black" points="9662.5,-2700 9346.5,-2700 9346.5,-2647 9662.5,-2647 9662.5,-2700"/>
<text text-anchor="middle" x="9504.5" y="-2684.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="9504.5" y="-2669.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="9504.5" y="-2654.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- ln2_13&#45;&gt;moe_gate_13 -->
<g id="edge371" class="edge">
<title>ln2_13&#45;&gt;moe_gate_13</title>
<path fill="none" stroke="black" d="M9973.9,-2747.04C9892.05,-2734.39 9771.2,-2715.71 9672.63,-2700.48"/>
<polygon fill="black" stroke="black" points="9672.97,-2696.99 9662.55,-2698.92 9671.9,-2703.91 9672.97,-2696.99"/>
</g>
<!-- comm_13_14 -->
<g id="node274" class="node">
<title>comm_13_14</title>
<ellipse fill="#f0e6ff" stroke="black" cx="10693.5" cy="-2217.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="10693.5" y="-2228.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="10693.5" y="-2213.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10693.5" y="-2198.8" font-family="Arial" font-size="14.00">GPU: 12 → GPU: 13</text>
</g>
<!-- residual2_13&#45;&gt;comm_13_14 -->
<g id="edge391" class="edge">
<title>residual2_13&#45;&gt;comm_13_14</title>
<path fill="none" stroke="black" d="M10693.5,-2290.75C10693.5,-2282.93 10693.5,-2274.07 10693.5,-2265.31"/>
<polygon fill="black" stroke="black" points="10697,-2265.13 10693.5,-2255.13 10690,-2265.13 10697,-2265.13"/>
</g>
<!-- expert_13_0 -->
<g id="node264" class="node">
<title>expert_13_0</title>
<polygon fill="#e6ffe6" stroke="black" points="7907,-2611 7528,-2611 7528,-2558 7907,-2558 7907,-2611"/>
<text text-anchor="middle" x="7717.5" y="-2595.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7717.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="7717.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_13_0 -->
<g id="edge372" class="edge">
<title>moe_gate_13&#45;&gt;expert_13_0</title>
<path fill="none" stroke="black" d="M9346.44,-2671.02C9062.42,-2667.33 8446.78,-2654.66 7917.19,-2611.02"/>
<polygon fill="black" stroke="black" points="7917.31,-2607.52 7907.05,-2610.18 7916.73,-2614.5 7917.31,-2607.52"/>
</g>
<!-- expert_13_1 -->
<g id="node265" class="node">
<title>expert_13_1</title>
<polygon fill="#e6ffe6" stroke="black" points="8304,-2611 7925,-2611 7925,-2558 8304,-2558 8304,-2611"/>
<text text-anchor="middle" x="8114.5" y="-2595.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8114.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8114.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_13_1 -->
<g id="edge373" class="edge">
<title>moe_gate_13&#45;&gt;expert_13_1</title>
<path fill="none" stroke="black" d="M9346.26,-2668.15C9119.85,-2661.06 8690.26,-2644.43 8314.05,-2611.02"/>
<polygon fill="black" stroke="black" points="8314.33,-2607.53 8304.06,-2610.12 8313.71,-2614.5 8314.33,-2607.53"/>
</g>
<!-- expert_13_2 -->
<g id="node266" class="node">
<title>expert_13_2</title>
<polygon fill="#e6ffe6" stroke="black" points="8701,-2611 8322,-2611 8322,-2558 8701,-2558 8701,-2611"/>
<text text-anchor="middle" x="8511.5" y="-2595.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8511.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8511.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_13_2 -->
<g id="edge374" class="edge">
<title>moe_gate_13&#45;&gt;expert_13_2</title>
<path fill="none" stroke="black" d="M9346.49,-2662.6C9188.45,-2652.16 8938.19,-2634.16 8711.18,-2611.05"/>
<polygon fill="black" stroke="black" points="8711.37,-2607.55 8701.07,-2610.01 8710.66,-2614.51 8711.37,-2607.55"/>
</g>
<!-- expert_13_3 -->
<g id="node267" class="node">
<title>expert_13_3</title>
<polygon fill="#e6ffe6" stroke="black" points="9098,-2611 8719,-2611 8719,-2558 9098,-2558 9098,-2611"/>
<text text-anchor="middle" x="8908.5" y="-2595.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="8908.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8908.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_13_3 -->
<g id="edge375" class="edge">
<title>moe_gate_13&#45;&gt;expert_13_3</title>
<path fill="none" stroke="black" d="M9346.35,-2649.41C9268.71,-2638.08 9174.7,-2624.36 9093.72,-2612.54"/>
<polygon fill="black" stroke="black" points="9093.81,-2609.01 9083.4,-2611.03 9092.79,-2615.94 9093.81,-2609.01"/>
</g>
<!-- expert_13_4 -->
<g id="node268" class="node">
<title>expert_13_4</title>
<polygon fill="#e6ffe6" stroke="black" points="9495,-2611 9116,-2611 9116,-2558 9495,-2558 9495,-2611"/>
<text text-anchor="middle" x="9305.5" y="-2595.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="9305.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9305.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_13_4 -->
<g id="edge376" class="edge">
<title>moe_gate_13&#45;&gt;expert_13_4</title>
<path fill="none" stroke="black" d="M9446.14,-2646.98C9423.26,-2636.98 9396.85,-2625.44 9373.14,-2615.07"/>
<polygon fill="black" stroke="black" points="9374.43,-2611.81 9363.86,-2611.01 9371.62,-2618.23 9374.43,-2611.81"/>
</g>
<!-- expert_13_5 -->
<g id="node269" class="node">
<title>expert_13_5</title>
<polygon fill="#e6ffe6" stroke="black" points="9892,-2611 9513,-2611 9513,-2558 9892,-2558 9892,-2611"/>
<text text-anchor="middle" x="9702.5" y="-2595.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="9702.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9702.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_13_5 -->
<g id="edge377" class="edge">
<title>moe_gate_13&#45;&gt;expert_13_5</title>
<path fill="none" stroke="black" d="M9562.57,-2646.98C9585.34,-2636.98 9611.61,-2625.44 9635.2,-2615.07"/>
<polygon fill="black" stroke="black" points="9636.69,-2618.24 9644.43,-2611.01 9633.87,-2611.83 9636.69,-2618.24"/>
</g>
<!-- expert_13_6 -->
<g id="node270" class="node">
<title>expert_13_6</title>
<polygon fill="#e6ffe6" stroke="black" points="10289,-2611 9910,-2611 9910,-2558 10289,-2558 10289,-2611"/>
<text text-anchor="middle" x="10099.5" y="-2595.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10099.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10099.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_13_6 -->
<g id="edge378" class="edge">
<title>moe_gate_13&#45;&gt;expert_13_6</title>
<path fill="none" stroke="black" d="M9662.78,-2649.36C9740.2,-2638.04 9833.86,-2624.34 9914.56,-2612.54"/>
<polygon fill="black" stroke="black" points="9915.45,-2615.95 9924.84,-2611.04 9914.44,-2609.02 9915.45,-2615.95"/>
</g>
<!-- expert_13_7 -->
<g id="node271" class="node">
<title>expert_13_7</title>
<polygon fill="#e6ffe6" stroke="black" points="10686,-2611 10307,-2611 10307,-2558 10686,-2558 10686,-2611"/>
<text text-anchor="middle" x="10496.5" y="-2595.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="10496.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10496.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_13_7 -->
<g id="edge379" class="edge">
<title>moe_gate_13&#45;&gt;expert_13_7</title>
<path fill="none" stroke="black" d="M9662.52,-2662.63C9820.56,-2652.21 10070.82,-2634.23 10296.77,-2611.16"/>
<polygon fill="black" stroke="black" points="10297.24,-2614.63 10306.83,-2610.13 10296.53,-2607.67 10297.24,-2614.63"/>
</g>
<!-- expert_combine_13 -->
<g id="node272" class="node">
<title>expert_combine_13</title>
<polygon fill="#fff0e6" stroke="black" points="9597,-2522 9410,-2522 9410,-2469 9597,-2469 9597,-2522"/>
<text text-anchor="middle" x="9503.5" y="-2506.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="9503.5" y="-2491.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9503.5" y="-2476.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- moe_gate_13&#45;&gt;expert_combine_13 -->
<g id="edge380" class="edge">
<title>moe_gate_13&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M9662.53,-2670.04C9978.38,-2664.35 10660.5,-2647.85 10695.5,-2611 10711.72,-2593.92 10711.72,-2575.08 10695.5,-2558 10658.3,-2518.83 9890.65,-2502.67 9607.35,-2498.02"/>
<polygon fill="black" stroke="black" points="9607.12,-2494.51 9597.07,-2497.85 9607.01,-2501.51 9607.12,-2494.51"/>
</g>
<!-- expert_13_0&#45;&gt;expert_combine_13 -->
<g id="edge381" class="edge">
<title>expert_13_0&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M7907.05,-2558.82C7910.23,-2558.53 7913.38,-2558.26 7916.5,-2558 8474.46,-2511.53 9145.77,-2500.09 9399.55,-2497.34"/>
<polygon fill="black" stroke="black" points="9399.9,-2500.84 9409.86,-2497.23 9399.83,-2493.84 9399.9,-2500.84"/>
</g>
<!-- expert_13_1&#45;&gt;expert_combine_13 -->
<g id="edge382" class="edge">
<title>expert_13_1&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M8304.06,-2558.88C8307.23,-2558.57 8310.38,-2558.28 8313.5,-2558 8714.19,-2522.03 9192.81,-2505.22 9399.74,-2499.22"/>
<polygon fill="black" stroke="black" points="9400.1,-2502.71 9409.99,-2498.92 9399.89,-2495.71 9400.1,-2502.71"/>
</g>
<!-- expert_13_2&#45;&gt;expert_combine_13 -->
<g id="edge383" class="edge">
<title>expert_13_2&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M8701.07,-2558.99C8704.24,-2558.65 8707.38,-2558.32 8710.5,-2558 8957.24,-2532.64 9248.13,-2512.59 9399.75,-2502.88"/>
<polygon fill="black" stroke="black" points="9400.22,-2506.36 9409.97,-2502.23 9399.77,-2499.38 9400.22,-2506.36"/>
</g>
<!-- expert_13_3&#45;&gt;expert_combine_13 -->
<g id="edge384" class="edge">
<title>expert_13_3&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M9083,-2557.98C9185.85,-2542.95 9312.51,-2524.43 9399.78,-2511.67"/>
<polygon fill="black" stroke="black" points="9400.3,-2515.13 9409.69,-2510.22 9399.29,-2508.2 9400.3,-2515.13"/>
</g>
<!-- expert_13_4&#45;&gt;expert_combine_13 -->
<g id="edge385" class="edge">
<title>expert_13_4&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M9363.57,-2557.98C9386.34,-2547.98 9412.61,-2536.44 9436.2,-2526.07"/>
<polygon fill="black" stroke="black" points="9437.69,-2529.24 9445.43,-2522.01 9434.87,-2522.83 9437.69,-2529.24"/>
</g>
<!-- expert_13_5&#45;&gt;expert_combine_13 -->
<g id="edge386" class="edge">
<title>expert_13_5&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M9644.14,-2557.98C9621.26,-2547.98 9594.85,-2536.44 9571.14,-2526.07"/>
<polygon fill="black" stroke="black" points="9572.43,-2522.81 9561.86,-2522.01 9569.62,-2529.23 9572.43,-2522.81"/>
</g>
<!-- expert_13_6&#45;&gt;expert_combine_13 -->
<g id="edge387" class="edge">
<title>expert_13_6&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M9924.71,-2557.98C9821.52,-2542.92 9694.41,-2524.37 9606.97,-2511.6"/>
<polygon fill="black" stroke="black" points="9607.45,-2508.14 9597.04,-2510.16 9606.43,-2515.06 9607.45,-2508.14"/>
</g>
<!-- expert_13_7&#45;&gt;expert_combine_13 -->
<g id="edge388" class="edge">
<title>expert_13_7&#45;&gt;expert_combine_13</title>
<path fill="none" stroke="black" d="M10306.83,-2558.87C10304.04,-2558.58 10301.26,-2558.28 10298.5,-2558 10051.15,-2532.52 9759.52,-2512.52 9607.52,-2502.85"/>
<polygon fill="black" stroke="black" points="9607.46,-2499.34 9597.26,-2502.2 9607.02,-2506.33 9607.46,-2499.34"/>
</g>
<!-- expert_out_13 -->
<g id="node273" class="node">
<title>expert_out_13</title>
<polygon fill="#fff0e6" stroke="black" points="10110,-2433 9731,-2433 9731,-2380 10110,-2380 10110,-2433"/>
<text text-anchor="middle" x="9920.5" y="-2417.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="9920.5" y="-2402.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9920.5" y="-2387.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_combine_13&#45;&gt;expert_out_13 -->
<g id="edge389" class="edge">
<title>expert_combine_13&#45;&gt;expert_out_13</title>
<path fill="none" stroke="black" d="M9597.08,-2474.98C9653.38,-2463.23 9725.94,-2448.09 9788.06,-2435.13"/>
<polygon fill="black" stroke="black" points="9788.86,-2438.54 9797.93,-2433.07 9787.43,-2431.69 9788.86,-2438.54"/>
</g>
<!-- expert_out_13&#45;&gt;residual2_13 -->
<g id="edge390" class="edge">
<title>expert_out_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M10110.09,-2384.16C10261.28,-2367.15 10467.33,-2343.96 10589.77,-2330.17"/>
<polygon fill="black" stroke="black" points="10590.35,-2333.63 10599.89,-2329.04 10589.56,-2326.68 10590.35,-2333.63"/>
</g>
<!-- residual1_14 -->
<g id="node275" class="node">
<title>residual1_14</title>
<polygon fill="#f0f8ff" stroke="black" points="10957,-2144 10770,-2144 10770,-2091 10957,-2091 10957,-2144"/>
<text text-anchor="middle" x="10863.5" y="-2128.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10863.5" y="-2113.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10863.5" y="-2098.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- comm_13_14&#45;&gt;residual1_14 -->
<g id="edge392" class="edge">
<title>comm_13_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M10750.58,-2183.59C10769.9,-2172.46 10791.38,-2160.07 10810.38,-2149.12"/>
<polygon fill="black" stroke="black" points="10812.29,-2152.06 10819.2,-2144.04 10808.79,-2146 10812.29,-2152.06"/>
</g>
<!-- ln2_14 -->
<g id="node282" class="node">
<title>ln2_14</title>
<polygon fill="#ffe4e1" stroke="black" points="10897,-2055 10710,-2055 10710,-2002 10897,-2002 10897,-2055"/>
<text text-anchor="middle" x="10803.5" y="-2039.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10803.5" y="-2024.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10803.5" y="-2009.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge399" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M10845.82,-2090.87C10839.95,-2082.36 10833.33,-2072.75 10827.09,-2063.7"/>
<polygon fill="black" stroke="black" points="10829.82,-2061.49 10821.26,-2055.25 10824.05,-2065.47 10829.82,-2061.49"/>
</g>
<!-- residual2_14 -->
<g id="node283" class="node">
<title>residual2_14</title>
<polygon fill="#f0f8ff" stroke="black" points="11523,-1610 11336,-1610 11336,-1557 11523,-1557 11523,-1610"/>
<text text-anchor="middle" x="11429.5" y="-1594.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11429.5" y="-1579.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11429.5" y="-1564.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- residual1_14&#45;&gt;residual2_14 -->
<g id="edge400" class="edge">
<title>residual1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M10957.26,-2109.59C11131.45,-2094.17 11487.5,-2049.33 11487.5,-1940.5 11487.5,-1940.5 11487.5,-1940.5 11487.5,-1760.5 11487.5,-1709.48 11465.24,-1654.13 11448.3,-1619.39"/>
<polygon fill="black" stroke="black" points="11451.29,-1617.54 11443.69,-1610.16 11445.03,-1620.67 11451.29,-1617.54"/>
</g>
<!-- ln1_14 -->
<g id="node276" class="node">
<title>ln1_14</title>
<polygon fill="#ffe4e1" stroke="black" points="11127,-2700 10940,-2700 10940,-2647 11127,-2647 11127,-2700"/>
<text text-anchor="middle" x="11033.5" y="-2684.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11033.5" y="-2669.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11033.5" y="-2654.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_qkv_14 -->
<g id="node277" class="node">
<title>attn_qkv_14</title>
<polygon fill="#ffe6e6" stroke="black" points="11229.5,-2611 10837.5,-2611 10837.5,-2558 11229.5,-2558 11229.5,-2611"/>
<text text-anchor="middle" x="11033.5" y="-2595.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11033.5" y="-2580.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="11033.5" y="-2565.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- ln1_14&#45;&gt;attn_qkv_14 -->
<g id="edge393" class="edge">
<title>ln1_14&#45;&gt;attn_qkv_14</title>
<path fill="none" stroke="black" d="M11033.5,-2646.87C11033.5,-2638.89 11033.5,-2629.93 11033.5,-2621.38"/>
<polygon fill="black" stroke="black" points="11037,-2621.25 11033.5,-2611.25 11030,-2621.25 11037,-2621.25"/>
</g>
<!-- attn_score_14 -->
<g id="node278" class="node">
<title>attn_score_14</title>
<polygon fill="#ffe6e6" stroke="black" points="11115.5,-2522 10951.5,-2522 10951.5,-2469 11115.5,-2469 11115.5,-2522"/>
<text text-anchor="middle" x="11033.5" y="-2506.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11033.5" y="-2491.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="11033.5" y="-2476.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_qkv_14&#45;&gt;attn_score_14 -->
<g id="edge394" class="edge">
<title>attn_qkv_14&#45;&gt;attn_score_14</title>
<path fill="none" stroke="black" d="M11033.5,-2557.87C11033.5,-2549.89 11033.5,-2540.93 11033.5,-2532.38"/>
<polygon fill="black" stroke="black" points="11037,-2532.25 11033.5,-2522.25 11030,-2532.25 11037,-2532.25"/>
</g>
<!-- attn_weight_14 -->
<g id="node279" class="node">
<title>attn_weight_14</title>
<polygon fill="#ffe6e6" stroke="black" points="11115.5,-2433 10951.5,-2433 10951.5,-2380 11115.5,-2380 11115.5,-2433"/>
<text text-anchor="middle" x="11033.5" y="-2417.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="11033.5" y="-2402.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="11033.5" y="-2387.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_score_14&#45;&gt;attn_weight_14 -->
<g id="edge395" class="edge">
<title>attn_score_14&#45;&gt;attn_weight_14</title>
<path fill="none" stroke="black" d="M11033.5,-2468.87C11033.5,-2460.89 11033.5,-2451.93 11033.5,-2443.38"/>
<polygon fill="black" stroke="black" points="11037,-2443.25 11033.5,-2433.25 11030,-2443.25 11037,-2443.25"/>
</g>
<!-- attn_context_14 -->
<g id="node280" class="node">
<title>attn_context_14</title>
<polygon fill="#ffe6e6" stroke="black" points="11127,-2344 10940,-2344 10940,-2291 11127,-2291 11127,-2344"/>
<text text-anchor="middle" x="11033.5" y="-2328.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="11033.5" y="-2313.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11033.5" y="-2298.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_weight_14&#45;&gt;attn_context_14 -->
<g id="edge396" class="edge">
<title>attn_weight_14&#45;&gt;attn_context_14</title>
<path fill="none" stroke="black" d="M11033.5,-2379.87C11033.5,-2371.89 11033.5,-2362.93 11033.5,-2354.38"/>
<polygon fill="black" stroke="black" points="11037,-2354.25 11033.5,-2344.25 11030,-2354.25 11037,-2354.25"/>
</g>
<!-- attn_out_14 -->
<g id="node281" class="node">
<title>attn_out_14</title>
<polygon fill="#ffe6e6" stroke="black" points="11223,-2244 10844,-2244 10844,-2191 11223,-2191 11223,-2244"/>
<text text-anchor="middle" x="11033.5" y="-2228.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11033.5" y="-2213.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11033.5" y="-2198.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_context_14&#45;&gt;attn_out_14 -->
<g id="edge397" class="edge">
<title>attn_context_14&#45;&gt;attn_out_14</title>
<path fill="none" stroke="black" d="M11033.5,-2290.75C11033.5,-2279.61 11033.5,-2266.38 11033.5,-2254.31"/>
<polygon fill="black" stroke="black" points="11037,-2254.08 11033.5,-2244.08 11030,-2254.08 11037,-2254.08"/>
</g>
<!-- attn_out_14&#45;&gt;residual1_14 -->
<g id="edge398" class="edge">
<title>attn_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M10988.83,-2190.75C10966.68,-2177.98 10939.76,-2162.46 10916.56,-2149.09"/>
<polygon fill="black" stroke="black" points="10918.28,-2146.04 10907.87,-2144.08 10914.78,-2152.1 10918.28,-2146.04"/>
</g>
<!-- moe_gate_14 -->
<g id="node284" class="node">
<title>moe_gate_14</title>
<polygon fill="#e6e6ff" stroke="black" points="10398.5,-1966 10082.5,-1966 10082.5,-1913 10398.5,-1913 10398.5,-1966"/>
<text text-anchor="middle" x="10240.5" y="-1950.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="10240.5" y="-1935.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="10240.5" y="-1920.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- ln2_14&#45;&gt;moe_gate_14 -->
<g id="edge401" class="edge">
<title>ln2_14&#45;&gt;moe_gate_14</title>
<path fill="none" stroke="black" d="M10709.9,-2013.04C10628.05,-2000.39 10507.2,-1981.71 10408.63,-1966.48"/>
<polygon fill="black" stroke="black" points="10408.97,-1962.99 10398.55,-1964.92 10407.9,-1969.91 10408.97,-1962.99"/>
</g>
<!-- comm_14_15 -->
<g id="node295" class="node">
<title>comm_14_15</title>
<ellipse fill="#f0e6ff" stroke="black" cx="11429.5" cy="-1483.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="11429.5" y="-1494.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="11429.5" y="-1479.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11429.5" y="-1464.8" font-family="Arial" font-size="14.00">GPU: 13 → GPU: 14</text>
</g>
<!-- residual2_14&#45;&gt;comm_14_15 -->
<g id="edge421" class="edge">
<title>residual2_14&#45;&gt;comm_14_15</title>
<path fill="none" stroke="black" d="M11429.5,-1556.75C11429.5,-1548.93 11429.5,-1540.07 11429.5,-1531.31"/>
<polygon fill="black" stroke="black" points="11433,-1531.13 11429.5,-1521.13 11426,-1531.13 11433,-1531.13"/>
</g>
<!-- expert_14_0 -->
<g id="node285" class="node">
<title>expert_14_0</title>
<polygon fill="#e6ffe6" stroke="black" points="8643,-1877 8264,-1877 8264,-1824 8643,-1824 8643,-1877"/>
<text text-anchor="middle" x="8453.5" y="-1861.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8453.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8453.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_14_0 -->
<g id="edge402" class="edge">
<title>moe_gate_14&#45;&gt;expert_14_0</title>
<path fill="none" stroke="black" d="M10082.44,-1937.02C9798.42,-1933.33 9182.78,-1920.66 8653.19,-1877.02"/>
<polygon fill="black" stroke="black" points="8653.31,-1873.52 8643.05,-1876.18 8652.73,-1880.5 8653.31,-1873.52"/>
</g>
<!-- expert_14_1 -->
<g id="node286" class="node">
<title>expert_14_1</title>
<polygon fill="#e6ffe6" stroke="black" points="9040,-1877 8661,-1877 8661,-1824 9040,-1824 9040,-1877"/>
<text text-anchor="middle" x="8850.5" y="-1861.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8850.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="8850.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_14_1 -->
<g id="edge403" class="edge">
<title>moe_gate_14&#45;&gt;expert_14_1</title>
<path fill="none" stroke="black" d="M10082.26,-1934.15C9855.85,-1927.06 9426.26,-1910.43 9050.05,-1877.02"/>
<polygon fill="black" stroke="black" points="9050.33,-1873.53 9040.06,-1876.12 9049.71,-1880.5 9050.33,-1873.53"/>
</g>
<!-- expert_14_2 -->
<g id="node287" class="node">
<title>expert_14_2</title>
<polygon fill="#e6ffe6" stroke="black" points="9437,-1877 9058,-1877 9058,-1824 9437,-1824 9437,-1877"/>
<text text-anchor="middle" x="9247.5" y="-1861.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9247.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9247.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_14_2 -->
<g id="edge404" class="edge">
<title>moe_gate_14&#45;&gt;expert_14_2</title>
<path fill="none" stroke="black" d="M10082.49,-1928.6C9924.45,-1918.16 9674.19,-1900.16 9447.18,-1877.05"/>
<polygon fill="black" stroke="black" points="9447.37,-1873.55 9437.07,-1876.01 9446.66,-1880.51 9447.37,-1873.55"/>
</g>
<!-- expert_14_3 -->
<g id="node288" class="node">
<title>expert_14_3</title>
<polygon fill="#e6ffe6" stroke="black" points="9834,-1877 9455,-1877 9455,-1824 9834,-1824 9834,-1877"/>
<text text-anchor="middle" x="9644.5" y="-1861.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9644.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9644.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_14_3 -->
<g id="edge405" class="edge">
<title>moe_gate_14&#45;&gt;expert_14_3</title>
<path fill="none" stroke="black" d="M10082.35,-1915.41C10004.71,-1904.08 9910.7,-1890.36 9829.72,-1878.54"/>
<polygon fill="black" stroke="black" points="9829.81,-1875.01 9819.4,-1877.03 9828.79,-1881.94 9829.81,-1875.01"/>
</g>
<!-- expert_14_4 -->
<g id="node289" class="node">
<title>expert_14_4</title>
<polygon fill="#e6ffe6" stroke="black" points="10231,-1877 9852,-1877 9852,-1824 10231,-1824 10231,-1877"/>
<text text-anchor="middle" x="10041.5" y="-1861.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10041.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10041.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_14_4 -->
<g id="edge406" class="edge">
<title>moe_gate_14&#45;&gt;expert_14_4</title>
<path fill="none" stroke="black" d="M10182.14,-1912.98C10159.26,-1902.98 10132.85,-1891.44 10109.14,-1881.07"/>
<polygon fill="black" stroke="black" points="10110.43,-1877.81 10099.86,-1877.01 10107.62,-1884.23 10110.43,-1877.81"/>
</g>
<!-- expert_14_5 -->
<g id="node290" class="node">
<title>expert_14_5</title>
<polygon fill="#e6ffe6" stroke="black" points="10628,-1877 10249,-1877 10249,-1824 10628,-1824 10628,-1877"/>
<text text-anchor="middle" x="10438.5" y="-1861.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="10438.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10438.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_14_5 -->
<g id="edge407" class="edge">
<title>moe_gate_14&#45;&gt;expert_14_5</title>
<path fill="none" stroke="black" d="M10298.57,-1912.98C10321.34,-1902.98 10347.61,-1891.44 10371.2,-1881.07"/>
<polygon fill="black" stroke="black" points="10372.69,-1884.24 10380.43,-1877.01 10369.87,-1877.83 10372.69,-1884.24"/>
</g>
<!-- expert_14_6 -->
<g id="node291" class="node">
<title>expert_14_6</title>
<polygon fill="#e6ffe6" stroke="black" points="11025,-1877 10646,-1877 10646,-1824 11025,-1824 11025,-1877"/>
<text text-anchor="middle" x="10835.5" y="-1861.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="10835.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10835.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_14_6 -->
<g id="edge408" class="edge">
<title>moe_gate_14&#45;&gt;expert_14_6</title>
<path fill="none" stroke="black" d="M10398.78,-1915.36C10476.2,-1904.04 10569.86,-1890.34 10650.56,-1878.54"/>
<polygon fill="black" stroke="black" points="10651.45,-1881.95 10660.84,-1877.04 10650.44,-1875.02 10651.45,-1881.95"/>
</g>
<!-- expert_14_7 -->
<g id="node292" class="node">
<title>expert_14_7</title>
<polygon fill="#e6ffe6" stroke="black" points="11422,-1877 11043,-1877 11043,-1824 11422,-1824 11422,-1877"/>
<text text-anchor="middle" x="11232.5" y="-1861.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="11232.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11232.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_14_7 -->
<g id="edge409" class="edge">
<title>moe_gate_14&#45;&gt;expert_14_7</title>
<path fill="none" stroke="black" d="M10398.52,-1928.63C10556.56,-1918.21 10806.82,-1900.23 11032.77,-1877.16"/>
<polygon fill="black" stroke="black" points="11033.24,-1880.63 11042.83,-1876.13 11032.53,-1873.67 11033.24,-1880.63"/>
</g>
<!-- expert_combine_14 -->
<g id="node293" class="node">
<title>expert_combine_14</title>
<polygon fill="#fff0e6" stroke="black" points="10333,-1788 10146,-1788 10146,-1735 10333,-1735 10333,-1788"/>
<text text-anchor="middle" x="10239.5" y="-1772.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="10239.5" y="-1757.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10239.5" y="-1742.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- moe_gate_14&#45;&gt;expert_combine_14 -->
<g id="edge410" class="edge">
<title>moe_gate_14&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M10398.53,-1936.04C10714.38,-1930.35 11396.5,-1913.85 11431.5,-1877 11447.72,-1859.92 11447.72,-1841.08 11431.5,-1824 11394.3,-1784.83 10626.65,-1768.67 10343.35,-1764.02"/>
<polygon fill="black" stroke="black" points="10343.12,-1760.51 10333.07,-1763.85 10343.01,-1767.51 10343.12,-1760.51"/>
</g>
<!-- expert_14_0&#45;&gt;expert_combine_14 -->
<g id="edge411" class="edge">
<title>expert_14_0&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M8643.05,-1824.82C8646.23,-1824.53 8649.38,-1824.26 8652.5,-1824 9210.46,-1777.53 9881.77,-1766.09 10135.55,-1763.34"/>
<polygon fill="black" stroke="black" points="10135.9,-1766.84 10145.86,-1763.23 10135.83,-1759.84 10135.9,-1766.84"/>
</g>
<!-- expert_14_1&#45;&gt;expert_combine_14 -->
<g id="edge412" class="edge">
<title>expert_14_1&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M9040.06,-1824.88C9043.23,-1824.57 9046.38,-1824.28 9049.5,-1824 9450.19,-1788.03 9928.81,-1771.22 10135.74,-1765.22"/>
<polygon fill="black" stroke="black" points="10136.1,-1768.71 10145.99,-1764.92 10135.89,-1761.71 10136.1,-1768.71"/>
</g>
<!-- expert_14_2&#45;&gt;expert_combine_14 -->
<g id="edge413" class="edge">
<title>expert_14_2&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M9437.07,-1824.99C9440.24,-1824.65 9443.38,-1824.32 9446.5,-1824 9693.24,-1798.64 9984.13,-1778.59 10135.75,-1768.88"/>
<polygon fill="black" stroke="black" points="10136.22,-1772.36 10145.97,-1768.23 10135.77,-1765.38 10136.22,-1772.36"/>
</g>
<!-- expert_14_3&#45;&gt;expert_combine_14 -->
<g id="edge414" class="edge">
<title>expert_14_3&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M9819,-1823.98C9921.85,-1808.95 10048.51,-1790.43 10135.78,-1777.67"/>
<polygon fill="black" stroke="black" points="10136.3,-1781.13 10145.69,-1776.22 10135.29,-1774.2 10136.3,-1781.13"/>
</g>
<!-- expert_14_4&#45;&gt;expert_combine_14 -->
<g id="edge415" class="edge">
<title>expert_14_4&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M10099.57,-1823.98C10122.34,-1813.98 10148.61,-1802.44 10172.2,-1792.07"/>
<polygon fill="black" stroke="black" points="10173.69,-1795.24 10181.43,-1788.01 10170.87,-1788.83 10173.69,-1795.24"/>
</g>
<!-- expert_14_5&#45;&gt;expert_combine_14 -->
<g id="edge416" class="edge">
<title>expert_14_5&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M10380.14,-1823.98C10357.26,-1813.98 10330.85,-1802.44 10307.14,-1792.07"/>
<polygon fill="black" stroke="black" points="10308.43,-1788.81 10297.86,-1788.01 10305.62,-1795.23 10308.43,-1788.81"/>
</g>
<!-- expert_14_6&#45;&gt;expert_combine_14 -->
<g id="edge417" class="edge">
<title>expert_14_6&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M10660.71,-1823.98C10557.52,-1808.92 10430.41,-1790.37 10342.97,-1777.6"/>
<polygon fill="black" stroke="black" points="10343.45,-1774.14 10333.04,-1776.16 10342.43,-1781.06 10343.45,-1774.14"/>
</g>
<!-- expert_14_7&#45;&gt;expert_combine_14 -->
<g id="edge418" class="edge">
<title>expert_14_7&#45;&gt;expert_combine_14</title>
<path fill="none" stroke="black" d="M11042.83,-1824.87C11040.04,-1824.58 11037.26,-1824.28 11034.5,-1824 10787.15,-1798.52 10495.52,-1778.52 10343.52,-1768.85"/>
<polygon fill="black" stroke="black" points="10343.46,-1765.34 10333.26,-1768.2 10343.02,-1772.33 10343.46,-1765.34"/>
</g>
<!-- expert_out_14 -->
<g id="node294" class="node">
<title>expert_out_14</title>
<polygon fill="#fff0e6" stroke="black" points="10846,-1699 10467,-1699 10467,-1646 10846,-1646 10846,-1699"/>
<text text-anchor="middle" x="10656.5" y="-1683.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="10656.5" y="-1668.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10656.5" y="-1653.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_combine_14&#45;&gt;expert_out_14 -->
<g id="edge419" class="edge">
<title>expert_combine_14&#45;&gt;expert_out_14</title>
<path fill="none" stroke="black" d="M10333.08,-1740.98C10389.38,-1729.23 10461.94,-1714.09 10524.06,-1701.13"/>
<polygon fill="black" stroke="black" points="10524.86,-1704.54 10533.93,-1699.07 10523.43,-1697.69 10524.86,-1704.54"/>
</g>
<!-- expert_out_14&#45;&gt;residual2_14 -->
<g id="edge420" class="edge">
<title>expert_out_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M10846.09,-1650.16C10997.28,-1633.15 11203.33,-1609.96 11325.77,-1596.17"/>
<polygon fill="black" stroke="black" points="11326.35,-1599.63 11335.89,-1595.04 11325.56,-1592.68 11326.35,-1599.63"/>
</g>
<!-- residual1_15 -->
<g id="node296" class="node">
<title>residual1_15</title>
<polygon fill="#f0f8ff" stroke="black" points="11693,-1410 11506,-1410 11506,-1357 11693,-1357 11693,-1410"/>
<text text-anchor="middle" x="11599.5" y="-1394.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="11599.5" y="-1379.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11599.5" y="-1364.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- comm_14_15&#45;&gt;residual1_15 -->
<g id="edge422" class="edge">
<title>comm_14_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M11486.58,-1449.59C11505.9,-1438.46 11527.38,-1426.07 11546.38,-1415.12"/>
<polygon fill="black" stroke="black" points="11548.29,-1418.06 11555.2,-1410.04 11544.79,-1412 11548.29,-1418.06"/>
</g>
<!-- ln2_15 -->
<g id="node303" class="node">
<title>ln2_15</title>
<polygon fill="#ffe4e1" stroke="black" points="11633,-1321 11446,-1321 11446,-1268 11633,-1268 11633,-1321"/>
<text text-anchor="middle" x="11539.5" y="-1305.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11539.5" y="-1290.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11539.5" y="-1275.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge429" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M11581.82,-1356.87C11575.95,-1348.36 11569.33,-1338.75 11563.09,-1329.7"/>
<polygon fill="black" stroke="black" points="11565.82,-1327.49 11557.26,-1321.25 11560.05,-1331.47 11565.82,-1327.49"/>
</g>
<!-- residual2_15 -->
<g id="node304" class="node">
<title>residual2_15</title>
<polygon fill="#f0f8ff" stroke="black" points="12259,-876 12072,-876 12072,-823 12259,-823 12259,-876"/>
<text text-anchor="middle" x="12165.5" y="-860.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12165.5" y="-845.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12165.5" y="-830.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- residual1_15&#45;&gt;residual2_15 -->
<g id="edge430" class="edge">
<title>residual1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M11693.26,-1375.59C11867.45,-1360.17 12223.5,-1315.33 12223.5,-1206.5 12223.5,-1206.5 12223.5,-1206.5 12223.5,-1026.5 12223.5,-975.48 12201.24,-920.13 12184.3,-885.39"/>
<polygon fill="black" stroke="black" points="12187.29,-883.54 12179.69,-876.16 12181.03,-886.67 12187.29,-883.54"/>
</g>
<!-- ln1_15 -->
<g id="node297" class="node">
<title>ln1_15</title>
<polygon fill="#ffe4e1" stroke="black" points="11863,-1966 11676,-1966 11676,-1913 11863,-1913 11863,-1966"/>
<text text-anchor="middle" x="11769.5" y="-1950.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11769.5" y="-1935.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11769.5" y="-1920.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_qkv_15 -->
<g id="node298" class="node">
<title>attn_qkv_15</title>
<polygon fill="#ffe6e6" stroke="black" points="11965.5,-1877 11573.5,-1877 11573.5,-1824 11965.5,-1824 11965.5,-1877"/>
<text text-anchor="middle" x="11769.5" y="-1861.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="11769.5" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="11769.5" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- ln1_15&#45;&gt;attn_qkv_15 -->
<g id="edge423" class="edge">
<title>ln1_15&#45;&gt;attn_qkv_15</title>
<path fill="none" stroke="black" d="M11769.5,-1912.87C11769.5,-1904.89 11769.5,-1895.93 11769.5,-1887.38"/>
<polygon fill="black" stroke="black" points="11773,-1887.25 11769.5,-1877.25 11766,-1887.25 11773,-1887.25"/>
</g>
<!-- attn_score_15 -->
<g id="node299" class="node">
<title>attn_score_15</title>
<polygon fill="#ffe6e6" stroke="black" points="11851.5,-1788 11687.5,-1788 11687.5,-1735 11851.5,-1735 11851.5,-1788"/>
<text text-anchor="middle" x="11769.5" y="-1772.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="11769.5" y="-1757.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="11769.5" y="-1742.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_qkv_15&#45;&gt;attn_score_15 -->
<g id="edge424" class="edge">
<title>attn_qkv_15&#45;&gt;attn_score_15</title>
<path fill="none" stroke="black" d="M11769.5,-1823.87C11769.5,-1815.89 11769.5,-1806.93 11769.5,-1798.38"/>
<polygon fill="black" stroke="black" points="11773,-1798.25 11769.5,-1788.25 11766,-1798.25 11773,-1798.25"/>
</g>
<!-- attn_weight_15 -->
<g id="node300" class="node">
<title>attn_weight_15</title>
<polygon fill="#ffe6e6" stroke="black" points="11851.5,-1699 11687.5,-1699 11687.5,-1646 11851.5,-1646 11851.5,-1699"/>
<text text-anchor="middle" x="11769.5" y="-1683.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="11769.5" y="-1668.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="11769.5" y="-1653.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_score_15&#45;&gt;attn_weight_15 -->
<g id="edge425" class="edge">
<title>attn_score_15&#45;&gt;attn_weight_15</title>
<path fill="none" stroke="black" d="M11769.5,-1734.87C11769.5,-1726.89 11769.5,-1717.93 11769.5,-1709.38"/>
<polygon fill="black" stroke="black" points="11773,-1709.25 11769.5,-1699.25 11766,-1709.25 11773,-1709.25"/>
</g>
<!-- attn_context_15 -->
<g id="node301" class="node">
<title>attn_context_15</title>
<polygon fill="#ffe6e6" stroke="black" points="11863,-1610 11676,-1610 11676,-1557 11863,-1557 11863,-1610"/>
<text text-anchor="middle" x="11769.5" y="-1594.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="11769.5" y="-1579.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11769.5" y="-1564.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_weight_15&#45;&gt;attn_context_15 -->
<g id="edge426" class="edge">
<title>attn_weight_15&#45;&gt;attn_context_15</title>
<path fill="none" stroke="black" d="M11769.5,-1645.87C11769.5,-1637.89 11769.5,-1628.93 11769.5,-1620.38"/>
<polygon fill="black" stroke="black" points="11773,-1620.25 11769.5,-1610.25 11766,-1620.25 11773,-1620.25"/>
</g>
<!-- attn_out_15 -->
<g id="node302" class="node">
<title>attn_out_15</title>
<polygon fill="#ffe6e6" stroke="black" points="11959,-1510 11580,-1510 11580,-1457 11959,-1457 11959,-1510"/>
<text text-anchor="middle" x="11769.5" y="-1494.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11769.5" y="-1479.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11769.5" y="-1464.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_context_15&#45;&gt;attn_out_15 -->
<g id="edge427" class="edge">
<title>attn_context_15&#45;&gt;attn_out_15</title>
<path fill="none" stroke="black" d="M11769.5,-1556.75C11769.5,-1545.61 11769.5,-1532.38 11769.5,-1520.31"/>
<polygon fill="black" stroke="black" points="11773,-1520.08 11769.5,-1510.08 11766,-1520.08 11773,-1520.08"/>
</g>
<!-- attn_out_15&#45;&gt;residual1_15 -->
<g id="edge428" class="edge">
<title>attn_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M11724.83,-1456.75C11702.68,-1443.98 11675.76,-1428.46 11652.56,-1415.09"/>
<polygon fill="black" stroke="black" points="11654.28,-1412.04 11643.87,-1410.08 11650.78,-1418.1 11654.28,-1412.04"/>
</g>
<!-- moe_gate_15 -->
<g id="node305" class="node">
<title>moe_gate_15</title>
<polygon fill="#e6e6ff" stroke="black" points="11134.5,-1232 10818.5,-1232 10818.5,-1179 11134.5,-1179 11134.5,-1232"/>
<text text-anchor="middle" x="10976.5" y="-1216.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="10976.5" y="-1201.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="10976.5" y="-1186.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- ln2_15&#45;&gt;moe_gate_15 -->
<g id="edge431" class="edge">
<title>ln2_15&#45;&gt;moe_gate_15</title>
<path fill="none" stroke="black" d="M11445.9,-1279.04C11364.05,-1266.39 11243.2,-1247.71 11144.63,-1232.48"/>
<polygon fill="black" stroke="black" points="11144.97,-1228.99 11134.55,-1230.92 11143.9,-1235.91 11144.97,-1228.99"/>
</g>
<!-- comm_15_16 -->
<g id="node316" class="node">
<title>comm_15_16</title>
<ellipse fill="#f0e6ff" stroke="black" cx="12165.5" cy="-749.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="12165.5" y="-760.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="12165.5" y="-745.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12165.5" y="-730.8" font-family="Arial" font-size="14.00">GPU: 14 → GPU: 15</text>
</g>
<!-- residual2_15&#45;&gt;comm_15_16 -->
<g id="edge451" class="edge">
<title>residual2_15&#45;&gt;comm_15_16</title>
<path fill="none" stroke="black" d="M12165.5,-822.75C12165.5,-814.93 12165.5,-806.07 12165.5,-797.31"/>
<polygon fill="black" stroke="black" points="12169,-797.13 12165.5,-787.13 12162,-797.13 12169,-797.13"/>
</g>
<!-- expert_15_0 -->
<g id="node306" class="node">
<title>expert_15_0</title>
<polygon fill="#e6ffe6" stroke="black" points="9379,-1143 9000,-1143 9000,-1090 9379,-1090 9379,-1143"/>
<text text-anchor="middle" x="9189.5" y="-1127.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9189.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9189.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_15_0 -->
<g id="edge432" class="edge">
<title>moe_gate_15&#45;&gt;expert_15_0</title>
<path fill="none" stroke="black" d="M10818.44,-1203.02C10534.42,-1199.33 9918.78,-1186.66 9389.19,-1143.02"/>
<polygon fill="black" stroke="black" points="9389.31,-1139.52 9379.05,-1142.18 9388.73,-1146.5 9389.31,-1139.52"/>
</g>
<!-- expert_15_1 -->
<g id="node307" class="node">
<title>expert_15_1</title>
<polygon fill="#e6ffe6" stroke="black" points="9776,-1143 9397,-1143 9397,-1090 9776,-1090 9776,-1143"/>
<text text-anchor="middle" x="9586.5" y="-1127.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9586.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9586.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_15_1 -->
<g id="edge433" class="edge">
<title>moe_gate_15&#45;&gt;expert_15_1</title>
<path fill="none" stroke="black" d="M10818.26,-1200.15C10591.85,-1193.06 10162.26,-1176.43 9786.05,-1143.02"/>
<polygon fill="black" stroke="black" points="9786.33,-1139.53 9776.06,-1142.12 9785.71,-1146.5 9786.33,-1139.53"/>
</g>
<!-- expert_15_2 -->
<g id="node308" class="node">
<title>expert_15_2</title>
<polygon fill="#e6ffe6" stroke="black" points="10173,-1143 9794,-1143 9794,-1090 10173,-1090 10173,-1143"/>
<text text-anchor="middle" x="9983.5" y="-1127.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9983.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9983.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_15_2 -->
<g id="edge434" class="edge">
<title>moe_gate_15&#45;&gt;expert_15_2</title>
<path fill="none" stroke="black" d="M10818.49,-1194.6C10660.45,-1184.16 10410.19,-1166.16 10183.18,-1143.05"/>
<polygon fill="black" stroke="black" points="10183.37,-1139.55 10173.07,-1142.01 10182.66,-1146.51 10183.37,-1139.55"/>
</g>
<!-- expert_15_3 -->
<g id="node309" class="node">
<title>expert_15_3</title>
<polygon fill="#e6ffe6" stroke="black" points="10570,-1143 10191,-1143 10191,-1090 10570,-1090 10570,-1143"/>
<text text-anchor="middle" x="10380.5" y="-1127.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10380.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10380.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_15_3 -->
<g id="edge435" class="edge">
<title>moe_gate_15&#45;&gt;expert_15_3</title>
<path fill="none" stroke="black" d="M10818.35,-1181.41C10740.71,-1170.08 10646.7,-1156.36 10565.72,-1144.54"/>
<polygon fill="black" stroke="black" points="10565.81,-1141.01 10555.4,-1143.03 10564.79,-1147.94 10565.81,-1141.01"/>
</g>
<!-- expert_15_4 -->
<g id="node310" class="node">
<title>expert_15_4</title>
<polygon fill="#e6ffe6" stroke="black" points="10967,-1143 10588,-1143 10588,-1090 10967,-1090 10967,-1143"/>
<text text-anchor="middle" x="10777.5" y="-1127.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="10777.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10777.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_15_4 -->
<g id="edge436" class="edge">
<title>moe_gate_15&#45;&gt;expert_15_4</title>
<path fill="none" stroke="black" d="M10918.14,-1178.98C10895.26,-1168.98 10868.85,-1157.44 10845.14,-1147.07"/>
<polygon fill="black" stroke="black" points="10846.43,-1143.81 10835.86,-1143.01 10843.62,-1150.23 10846.43,-1143.81"/>
</g>
<!-- expert_15_5 -->
<g id="node311" class="node">
<title>expert_15_5</title>
<polygon fill="#e6ffe6" stroke="black" points="11364,-1143 10985,-1143 10985,-1090 11364,-1090 11364,-1143"/>
<text text-anchor="middle" x="11174.5" y="-1127.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="11174.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11174.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_15_5 -->
<g id="edge437" class="edge">
<title>moe_gate_15&#45;&gt;expert_15_5</title>
<path fill="none" stroke="black" d="M11034.57,-1178.98C11057.34,-1168.98 11083.61,-1157.44 11107.2,-1147.07"/>
<polygon fill="black" stroke="black" points="11108.69,-1150.24 11116.43,-1143.01 11105.87,-1143.83 11108.69,-1150.24"/>
</g>
<!-- expert_15_6 -->
<g id="node312" class="node">
<title>expert_15_6</title>
<polygon fill="#e6ffe6" stroke="black" points="11761,-1143 11382,-1143 11382,-1090 11761,-1090 11761,-1143"/>
<text text-anchor="middle" x="11571.5" y="-1127.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="11571.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11571.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_15_6 -->
<g id="edge438" class="edge">
<title>moe_gate_15&#45;&gt;expert_15_6</title>
<path fill="none" stroke="black" d="M11134.78,-1181.36C11212.2,-1170.04 11305.86,-1156.34 11386.56,-1144.54"/>
<polygon fill="black" stroke="black" points="11387.45,-1147.95 11396.84,-1143.04 11386.44,-1141.02 11387.45,-1147.95"/>
</g>
<!-- expert_15_7 -->
<g id="node313" class="node">
<title>expert_15_7</title>
<polygon fill="#e6ffe6" stroke="black" points="12158,-1143 11779,-1143 11779,-1090 12158,-1090 12158,-1143"/>
<text text-anchor="middle" x="11968.5" y="-1127.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="11968.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11968.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_15_7 -->
<g id="edge439" class="edge">
<title>moe_gate_15&#45;&gt;expert_15_7</title>
<path fill="none" stroke="black" d="M11134.52,-1194.63C11292.56,-1184.21 11542.82,-1166.23 11768.77,-1143.16"/>
<polygon fill="black" stroke="black" points="11769.24,-1146.63 11778.83,-1142.13 11768.53,-1139.67 11769.24,-1146.63"/>
</g>
<!-- expert_combine_15 -->
<g id="node314" class="node">
<title>expert_combine_15</title>
<polygon fill="#fff0e6" stroke="black" points="11069,-1054 10882,-1054 10882,-1001 11069,-1001 11069,-1054"/>
<text text-anchor="middle" x="10975.5" y="-1038.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="10975.5" y="-1023.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10975.5" y="-1008.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- moe_gate_15&#45;&gt;expert_combine_15 -->
<g id="edge440" class="edge">
<title>moe_gate_15&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M11134.53,-1202.04C11450.38,-1196.35 12132.5,-1179.85 12167.5,-1143 12183.72,-1125.92 12183.72,-1107.08 12167.5,-1090 12130.3,-1050.83 11362.65,-1034.67 11079.35,-1030.02"/>
<polygon fill="black" stroke="black" points="11079.12,-1026.51 11069.07,-1029.85 11079.01,-1033.51 11079.12,-1026.51"/>
</g>
<!-- expert_15_0&#45;&gt;expert_combine_15 -->
<g id="edge441" class="edge">
<title>expert_15_0&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M9379.05,-1090.82C9382.23,-1090.53 9385.38,-1090.26 9388.5,-1090 9946.46,-1043.53 10617.77,-1032.09 10871.55,-1029.34"/>
<polygon fill="black" stroke="black" points="10871.9,-1032.84 10881.86,-1029.23 10871.83,-1025.84 10871.9,-1032.84"/>
</g>
<!-- expert_15_1&#45;&gt;expert_combine_15 -->
<g id="edge442" class="edge">
<title>expert_15_1&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M9776.06,-1090.88C9779.23,-1090.57 9782.38,-1090.28 9785.5,-1090 10186.19,-1054.03 10664.81,-1037.22 10871.74,-1031.22"/>
<polygon fill="black" stroke="black" points="10872.1,-1034.71 10881.99,-1030.92 10871.89,-1027.71 10872.1,-1034.71"/>
</g>
<!-- expert_15_2&#45;&gt;expert_combine_15 -->
<g id="edge443" class="edge">
<title>expert_15_2&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M10173.07,-1090.99C10176.24,-1090.65 10179.38,-1090.32 10182.5,-1090 10429.24,-1064.64 10720.13,-1044.59 10871.75,-1034.88"/>
<polygon fill="black" stroke="black" points="10872.22,-1038.36 10881.97,-1034.23 10871.77,-1031.38 10872.22,-1038.36"/>
</g>
<!-- expert_15_3&#45;&gt;expert_combine_15 -->
<g id="edge444" class="edge">
<title>expert_15_3&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M10555,-1089.98C10657.85,-1074.95 10784.51,-1056.43 10871.78,-1043.67"/>
<polygon fill="black" stroke="black" points="10872.3,-1047.13 10881.69,-1042.22 10871.29,-1040.2 10872.3,-1047.13"/>
</g>
<!-- expert_15_4&#45;&gt;expert_combine_15 -->
<g id="edge445" class="edge">
<title>expert_15_4&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M10835.57,-1089.98C10858.34,-1079.98 10884.61,-1068.44 10908.2,-1058.07"/>
<polygon fill="black" stroke="black" points="10909.69,-1061.24 10917.43,-1054.01 10906.87,-1054.83 10909.69,-1061.24"/>
</g>
<!-- expert_15_5&#45;&gt;expert_combine_15 -->
<g id="edge446" class="edge">
<title>expert_15_5&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M11116.14,-1089.98C11093.26,-1079.98 11066.85,-1068.44 11043.14,-1058.07"/>
<polygon fill="black" stroke="black" points="11044.43,-1054.81 11033.86,-1054.01 11041.62,-1061.23 11044.43,-1054.81"/>
</g>
<!-- expert_15_6&#45;&gt;expert_combine_15 -->
<g id="edge447" class="edge">
<title>expert_15_6&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M11396.71,-1089.98C11293.52,-1074.92 11166.41,-1056.37 11078.97,-1043.6"/>
<polygon fill="black" stroke="black" points="11079.45,-1040.14 11069.04,-1042.16 11078.43,-1047.06 11079.45,-1040.14"/>
</g>
<!-- expert_15_7&#45;&gt;expert_combine_15 -->
<g id="edge448" class="edge">
<title>expert_15_7&#45;&gt;expert_combine_15</title>
<path fill="none" stroke="black" d="M11778.83,-1090.87C11776.04,-1090.58 11773.26,-1090.28 11770.5,-1090 11523.15,-1064.52 11231.52,-1044.52 11079.52,-1034.85"/>
<polygon fill="black" stroke="black" points="11079.46,-1031.34 11069.26,-1034.2 11079.02,-1038.33 11079.46,-1031.34"/>
</g>
<!-- expert_out_15 -->
<g id="node315" class="node">
<title>expert_out_15</title>
<polygon fill="#fff0e6" stroke="black" points="11582,-965 11203,-965 11203,-912 11582,-912 11582,-965"/>
<text text-anchor="middle" x="11392.5" y="-949.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="11392.5" y="-934.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11392.5" y="-919.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_combine_15&#45;&gt;expert_out_15 -->
<g id="edge449" class="edge">
<title>expert_combine_15&#45;&gt;expert_out_15</title>
<path fill="none" stroke="black" d="M11069.08,-1006.98C11125.38,-995.23 11197.94,-980.09 11260.06,-967.13"/>
<polygon fill="black" stroke="black" points="11260.86,-970.54 11269.93,-965.07 11259.43,-963.69 11260.86,-970.54"/>
</g>
<!-- expert_out_15&#45;&gt;residual2_15 -->
<g id="edge450" class="edge">
<title>expert_out_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M11582.09,-916.16C11733.28,-899.15 11939.33,-875.96 12061.77,-862.17"/>
<polygon fill="black" stroke="black" points="12062.35,-865.63 12071.89,-861.04 12061.56,-858.68 12062.35,-865.63"/>
</g>
<!-- residual1_16 -->
<g id="node317" class="node">
<title>residual1_16</title>
<polygon fill="#f0f8ff" stroke="black" points="12429,-676 12242,-676 12242,-623 12429,-623 12429,-676"/>
<text text-anchor="middle" x="12335.5" y="-660.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12335.5" y="-645.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12335.5" y="-630.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- comm_15_16&#45;&gt;residual1_16 -->
<g id="edge452" class="edge">
<title>comm_15_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M12222.58,-715.59C12241.9,-704.46 12263.38,-692.07 12282.38,-681.12"/>
<polygon fill="black" stroke="black" points="12284.29,-684.06 12291.2,-676.04 12280.79,-678 12284.29,-684.06"/>
</g>
<!-- ln2_16 -->
<g id="node324" class="node">
<title>ln2_16</title>
<polygon fill="#ffe4e1" stroke="black" points="12369,-587 12182,-587 12182,-534 12369,-534 12369,-587"/>
<text text-anchor="middle" x="12275.5" y="-571.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12275.5" y="-556.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12275.5" y="-541.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- residual1_16&#45;&gt;ln2_16 -->
<g id="edge459" class="edge">
<title>residual1_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M12317.82,-622.87C12311.95,-614.36 12305.33,-604.75 12299.09,-595.7"/>
<polygon fill="black" stroke="black" points="12301.82,-593.49 12293.26,-587.25 12296.05,-597.47 12301.82,-593.49"/>
</g>
<!-- residual2_16 -->
<g id="node325" class="node">
<title>residual2_16</title>
<polygon fill="#f0f8ff" stroke="black" points="12835,-142 12648,-142 12648,-89 12835,-89 12835,-142"/>
<text text-anchor="middle" x="12741.5" y="-126.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="12741.5" y="-111.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12741.5" y="-96.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- residual1_16&#45;&gt;residual2_16 -->
<g id="edge460" class="edge">
<title>residual1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M12429.26,-641.59C12603.45,-626.17 12959.5,-581.33 12959.5,-472.5 12959.5,-472.5 12959.5,-472.5 12959.5,-292.5 12959.5,-221.02 12887.66,-173.61 12826.46,-146.19"/>
<polygon fill="black" stroke="black" points="12827.7,-142.91 12817.13,-142.12 12824.9,-149.32 12827.7,-142.91"/>
</g>
<!-- ln1_16 -->
<g id="node318" class="node">
<title>ln1_16</title>
<polygon fill="#ffe4e1" stroke="black" points="12599,-1232 12412,-1232 12412,-1179 12599,-1179 12599,-1232"/>
<text text-anchor="middle" x="12505.5" y="-1216.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12505.5" y="-1201.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12505.5" y="-1186.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_qkv_16 -->
<g id="node319" class="node">
<title>attn_qkv_16</title>
<polygon fill="#ffe6e6" stroke="black" points="12701.5,-1143 12309.5,-1143 12309.5,-1090 12701.5,-1090 12701.5,-1143"/>
<text text-anchor="middle" x="12505.5" y="-1127.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="12505.5" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="12505.5" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- ln1_16&#45;&gt;attn_qkv_16 -->
<g id="edge453" class="edge">
<title>ln1_16&#45;&gt;attn_qkv_16</title>
<path fill="none" stroke="black" d="M12505.5,-1178.87C12505.5,-1170.89 12505.5,-1161.93 12505.5,-1153.38"/>
<polygon fill="black" stroke="black" points="12509,-1153.25 12505.5,-1143.25 12502,-1153.25 12509,-1153.25"/>
</g>
<!-- attn_score_16 -->
<g id="node320" class="node">
<title>attn_score_16</title>
<polygon fill="#ffe6e6" stroke="black" points="12587.5,-1054 12423.5,-1054 12423.5,-1001 12587.5,-1001 12587.5,-1054"/>
<text text-anchor="middle" x="12505.5" y="-1038.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="12505.5" y="-1023.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="12505.5" y="-1008.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_qkv_16&#45;&gt;attn_score_16 -->
<g id="edge454" class="edge">
<title>attn_qkv_16&#45;&gt;attn_score_16</title>
<path fill="none" stroke="black" d="M12505.5,-1089.87C12505.5,-1081.89 12505.5,-1072.93 12505.5,-1064.38"/>
<polygon fill="black" stroke="black" points="12509,-1064.25 12505.5,-1054.25 12502,-1064.25 12509,-1064.25"/>
</g>
<!-- attn_weight_16 -->
<g id="node321" class="node">
<title>attn_weight_16</title>
<polygon fill="#ffe6e6" stroke="black" points="12587.5,-965 12423.5,-965 12423.5,-912 12587.5,-912 12587.5,-965"/>
<text text-anchor="middle" x="12505.5" y="-949.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="12505.5" y="-934.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="12505.5" y="-919.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_score_16&#45;&gt;attn_weight_16 -->
<g id="edge455" class="edge">
<title>attn_score_16&#45;&gt;attn_weight_16</title>
<path fill="none" stroke="black" d="M12505.5,-1000.87C12505.5,-992.89 12505.5,-983.93 12505.5,-975.38"/>
<polygon fill="black" stroke="black" points="12509,-975.25 12505.5,-965.25 12502,-975.25 12509,-975.25"/>
</g>
<!-- attn_context_16 -->
<g id="node322" class="node">
<title>attn_context_16</title>
<polygon fill="#ffe6e6" stroke="black" points="12599,-876 12412,-876 12412,-823 12599,-823 12599,-876"/>
<text text-anchor="middle" x="12505.5" y="-860.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="12505.5" y="-845.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12505.5" y="-830.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_weight_16&#45;&gt;attn_context_16 -->
<g id="edge456" class="edge">
<title>attn_weight_16&#45;&gt;attn_context_16</title>
<path fill="none" stroke="black" d="M12505.5,-911.87C12505.5,-903.89 12505.5,-894.93 12505.5,-886.38"/>
<polygon fill="black" stroke="black" points="12509,-886.25 12505.5,-876.25 12502,-886.25 12509,-886.25"/>
</g>
<!-- attn_out_16 -->
<g id="node323" class="node">
<title>attn_out_16</title>
<polygon fill="#ffe6e6" stroke="black" points="12695,-776 12316,-776 12316,-723 12695,-723 12695,-776"/>
<text text-anchor="middle" x="12505.5" y="-760.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="12505.5" y="-745.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12505.5" y="-730.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_context_16&#45;&gt;attn_out_16 -->
<g id="edge457" class="edge">
<title>attn_context_16&#45;&gt;attn_out_16</title>
<path fill="none" stroke="black" d="M12505.5,-822.75C12505.5,-811.61 12505.5,-798.38 12505.5,-786.31"/>
<polygon fill="black" stroke="black" points="12509,-786.08 12505.5,-776.08 12502,-786.08 12509,-786.08"/>
</g>
<!-- attn_out_16&#45;&gt;residual1_16 -->
<g id="edge458" class="edge">
<title>attn_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M12460.83,-722.75C12438.68,-709.98 12411.76,-694.46 12388.56,-681.09"/>
<polygon fill="black" stroke="black" points="12390.28,-678.04 12379.87,-676.08 12386.78,-684.1 12390.28,-678.04"/>
</g>
<!-- moe_gate_16 -->
<g id="node326" class="node">
<title>moe_gate_16</title>
<polygon fill="#e6e6ff" stroke="black" points="11870.5,-498 11554.5,-498 11554.5,-445 11870.5,-445 11870.5,-498"/>
<text text-anchor="middle" x="11712.5" y="-482.8" font-family="Arial" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="11712.5" y="-467.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 8]</text>
<text text-anchor="middle" x="11712.5" y="-452.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- ln2_16&#45;&gt;moe_gate_16 -->
<g id="edge461" class="edge">
<title>ln2_16&#45;&gt;moe_gate_16</title>
<path fill="none" stroke="black" d="M12181.9,-545.04C12100.05,-532.39 11979.2,-513.71 11880.63,-498.48"/>
<polygon fill="black" stroke="black" points="11880.97,-494.99 11870.55,-496.92 11879.9,-501.91 11880.97,-494.99"/>
</g>
<!-- output -->
<g id="node337" class="node">
<title>output</title>
<polygon fill="#e6f3ff" stroke="black" points="12855.5,-53 12627.5,-53 12627.5,0 12855.5,0 12855.5,-53"/>
<text text-anchor="middle" x="12741.5" y="-37.8" font-family="Arial" font-size="14.00">Output</text>
<text text-anchor="middle" x="12741.5" y="-22.8" font-family="Arial" font-size="14.00">[batch=1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12741.5" y="-7.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- residual2_16&#45;&gt;output -->
<g id="edge481" class="edge">
<title>residual2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M12741.5,-88.87C12741.5,-80.89 12741.5,-71.93 12741.5,-63.38"/>
<polygon fill="black" stroke="black" points="12745,-63.25 12741.5,-53.25 12738,-63.25 12745,-63.25"/>
</g>
<!-- expert_16_0 -->
<g id="node327" class="node">
<title>expert_16_0</title>
<polygon fill="#e6ffe6" stroke="black" points="10115,-409 9736,-409 9736,-356 10115,-356 10115,-409"/>
<text text-anchor="middle" x="9925.5" y="-393.8" font-family="Arial" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9925.5" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="9925.5" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_16_0 -->
<g id="edge462" class="edge">
<title>moe_gate_16&#45;&gt;expert_16_0</title>
<path fill="none" stroke="black" d="M11554.44,-469.02C11270.42,-465.33 10654.78,-452.66 10125.19,-409.02"/>
<polygon fill="black" stroke="black" points="10125.31,-405.52 10115.05,-408.18 10124.73,-412.5 10125.31,-405.52"/>
</g>
<!-- expert_16_1 -->
<g id="node328" class="node">
<title>expert_16_1</title>
<polygon fill="#e6ffe6" stroke="black" points="10512,-409 10133,-409 10133,-356 10512,-356 10512,-409"/>
<text text-anchor="middle" x="10322.5" y="-393.8" font-family="Arial" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10322.5" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10322.5" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_16_1 -->
<g id="edge463" class="edge">
<title>moe_gate_16&#45;&gt;expert_16_1</title>
<path fill="none" stroke="black" d="M11554.26,-466.15C11327.85,-459.06 10898.26,-442.43 10522.05,-409.02"/>
<polygon fill="black" stroke="black" points="10522.33,-405.53 10512.06,-408.12 10521.71,-412.5 10522.33,-405.53"/>
</g>
<!-- expert_16_2 -->
<g id="node329" class="node">
<title>expert_16_2</title>
<polygon fill="#e6ffe6" stroke="black" points="10909,-409 10530,-409 10530,-356 10909,-356 10909,-409"/>
<text text-anchor="middle" x="10719.5" y="-393.8" font-family="Arial" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="10719.5" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="10719.5" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_16_2 -->
<g id="edge464" class="edge">
<title>moe_gate_16&#45;&gt;expert_16_2</title>
<path fill="none" stroke="black" d="M11554.49,-460.6C11396.45,-450.16 11146.19,-432.16 10919.18,-409.05"/>
<polygon fill="black" stroke="black" points="10919.37,-405.55 10909.07,-408.01 10918.66,-412.51 10919.37,-405.55"/>
</g>
<!-- expert_16_3 -->
<g id="node330" class="node">
<title>expert_16_3</title>
<polygon fill="#e6ffe6" stroke="black" points="11306,-409 10927,-409 10927,-356 11306,-356 11306,-409"/>
<text text-anchor="middle" x="11116.5" y="-393.8" font-family="Arial" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11116.5" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11116.5" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_16_3 -->
<g id="edge465" class="edge">
<title>moe_gate_16&#45;&gt;expert_16_3</title>
<path fill="none" stroke="black" d="M11554.35,-447.41C11476.71,-436.08 11382.7,-422.36 11301.72,-410.54"/>
<polygon fill="black" stroke="black" points="11301.81,-407.01 11291.4,-409.03 11300.79,-413.94 11301.81,-407.01"/>
</g>
<!-- expert_16_4 -->
<g id="node331" class="node">
<title>expert_16_4</title>
<polygon fill="#e6ffe6" stroke="black" points="11703,-409 11324,-409 11324,-356 11703,-356 11703,-409"/>
<text text-anchor="middle" x="11513.5" y="-393.8" font-family="Arial" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="11513.5" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11513.5" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_16_4 -->
<g id="edge466" class="edge">
<title>moe_gate_16&#45;&gt;expert_16_4</title>
<path fill="none" stroke="black" d="M11654.14,-444.98C11631.26,-434.98 11604.85,-423.44 11581.14,-413.07"/>
<polygon fill="black" stroke="black" points="11582.43,-409.81 11571.86,-409.01 11579.62,-416.23 11582.43,-409.81"/>
</g>
<!-- expert_16_5 -->
<g id="node332" class="node">
<title>expert_16_5</title>
<polygon fill="#e6ffe6" stroke="black" points="12100,-409 11721,-409 11721,-356 12100,-356 12100,-409"/>
<text text-anchor="middle" x="11910.5" y="-393.8" font-family="Arial" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="11910.5" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11910.5" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_16_5 -->
<g id="edge467" class="edge">
<title>moe_gate_16&#45;&gt;expert_16_5</title>
<path fill="none" stroke="black" d="M11770.57,-444.98C11793.34,-434.98 11819.61,-423.44 11843.2,-413.07"/>
<polygon fill="black" stroke="black" points="11844.69,-416.24 11852.43,-409.01 11841.87,-409.83 11844.69,-416.24"/>
</g>
<!-- expert_16_6 -->
<g id="node333" class="node">
<title>expert_16_6</title>
<polygon fill="#e6ffe6" stroke="black" points="12497,-409 12118,-409 12118,-356 12497,-356 12497,-409"/>
<text text-anchor="middle" x="12307.5" y="-393.8" font-family="Arial" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="12307.5" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12307.5" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_16_6 -->
<g id="edge468" class="edge">
<title>moe_gate_16&#45;&gt;expert_16_6</title>
<path fill="none" stroke="black" d="M11870.78,-447.36C11948.2,-436.04 12041.86,-422.34 12122.56,-410.54"/>
<polygon fill="black" stroke="black" points="12123.45,-413.95 12132.84,-409.04 12122.44,-407.02 12123.45,-413.95"/>
</g>
<!-- expert_16_7 -->
<g id="node334" class="node">
<title>expert_16_7</title>
<polygon fill="#e6ffe6" stroke="black" points="12894,-409 12515,-409 12515,-356 12894,-356 12894,-409"/>
<text text-anchor="middle" x="12704.5" y="-393.8" font-family="Arial" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="12704.5" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12704.5" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_16_7 -->
<g id="edge469" class="edge">
<title>moe_gate_16&#45;&gt;expert_16_7</title>
<path fill="none" stroke="black" d="M11870.52,-460.63C12028.56,-450.21 12278.82,-432.23 12504.77,-409.16"/>
<polygon fill="black" stroke="black" points="12505.24,-412.63 12514.83,-408.13 12504.53,-405.67 12505.24,-412.63"/>
</g>
<!-- expert_combine_16 -->
<g id="node335" class="node">
<title>expert_combine_16</title>
<polygon fill="#fff0e6" stroke="black" points="11805,-320 11618,-320 11618,-267 11805,-267 11805,-320"/>
<text text-anchor="middle" x="11711.5" y="-304.8" font-family="Arial" font-size="14.00">Expert Combination</text>
<text text-anchor="middle" x="11711.5" y="-289.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="11711.5" y="-274.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- moe_gate_16&#45;&gt;expert_combine_16 -->
<g id="edge470" class="edge">
<title>moe_gate_16&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M11870.53,-468.04C12186.38,-462.35 12868.5,-445.85 12903.5,-409 12919.72,-391.92 12919.72,-373.08 12903.5,-356 12866.3,-316.83 12098.65,-300.67 11815.35,-296.02"/>
<polygon fill="black" stroke="black" points="11815.12,-292.51 11805.07,-295.85 11815.01,-299.51 11815.12,-292.51"/>
</g>
<!-- expert_16_0&#45;&gt;expert_combine_16 -->
<g id="edge471" class="edge">
<title>expert_16_0&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M10115.05,-356.82C10118.23,-356.53 10121.38,-356.26 10124.5,-356 10682.46,-309.53 11353.77,-298.09 11607.55,-295.34"/>
<polygon fill="black" stroke="black" points="11607.9,-298.84 11617.86,-295.23 11607.83,-291.84 11607.9,-298.84"/>
</g>
<!-- expert_16_1&#45;&gt;expert_combine_16 -->
<g id="edge472" class="edge">
<title>expert_16_1&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M10512.06,-356.88C10515.23,-356.57 10518.38,-356.28 10521.5,-356 10922.19,-320.03 11400.81,-303.22 11607.74,-297.22"/>
<polygon fill="black" stroke="black" points="11608.1,-300.71 11617.99,-296.92 11607.89,-293.71 11608.1,-300.71"/>
</g>
<!-- expert_16_2&#45;&gt;expert_combine_16 -->
<g id="edge473" class="edge">
<title>expert_16_2&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M10909.07,-356.99C10912.24,-356.65 10915.38,-356.32 10918.5,-356 11165.24,-330.64 11456.13,-310.59 11607.75,-300.88"/>
<polygon fill="black" stroke="black" points="11608.22,-304.36 11617.97,-300.23 11607.77,-297.38 11608.22,-304.36"/>
</g>
<!-- expert_16_3&#45;&gt;expert_combine_16 -->
<g id="edge474" class="edge">
<title>expert_16_3&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M11291,-355.98C11393.85,-340.95 11520.51,-322.43 11607.78,-309.67"/>
<polygon fill="black" stroke="black" points="11608.3,-313.13 11617.69,-308.22 11607.29,-306.2 11608.3,-313.13"/>
</g>
<!-- expert_16_4&#45;&gt;expert_combine_16 -->
<g id="edge475" class="edge">
<title>expert_16_4&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M11571.57,-355.98C11594.34,-345.98 11620.61,-334.44 11644.2,-324.07"/>
<polygon fill="black" stroke="black" points="11645.69,-327.24 11653.43,-320.01 11642.87,-320.83 11645.69,-327.24"/>
</g>
<!-- expert_16_5&#45;&gt;expert_combine_16 -->
<g id="edge476" class="edge">
<title>expert_16_5&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M11852.14,-355.98C11829.26,-345.98 11802.85,-334.44 11779.14,-324.07"/>
<polygon fill="black" stroke="black" points="11780.43,-320.81 11769.86,-320.01 11777.62,-327.23 11780.43,-320.81"/>
</g>
<!-- expert_16_6&#45;&gt;expert_combine_16 -->
<g id="edge477" class="edge">
<title>expert_16_6&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M12132.71,-355.98C12029.52,-340.92 11902.41,-322.37 11814.97,-309.6"/>
<polygon fill="black" stroke="black" points="11815.45,-306.14 11805.04,-308.16 11814.43,-313.06 11815.45,-306.14"/>
</g>
<!-- expert_16_7&#45;&gt;expert_combine_16 -->
<g id="edge478" class="edge">
<title>expert_16_7&#45;&gt;expert_combine_16</title>
<path fill="none" stroke="black" d="M12514.83,-356.87C12512.04,-356.58 12509.26,-356.28 12506.5,-356 12259.15,-330.52 11967.52,-310.52 11815.52,-300.85"/>
<polygon fill="black" stroke="black" points="11815.46,-297.34 11805.26,-300.2 11815.02,-304.33 11815.46,-297.34"/>
</g>
<!-- expert_out_16 -->
<g id="node336" class="node">
<title>expert_out_16</title>
<polygon fill="#fff0e6" stroke="black" points="12515,-231 12136,-231 12136,-178 12515,-178 12515,-231"/>
<text text-anchor="middle" x="12325.5" y="-215.8" font-family="Arial" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="12325.5" y="-200.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="12325.5" y="-185.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_combine_16&#45;&gt;expert_out_16 -->
<g id="edge479" class="edge">
<title>expert_combine_16&#45;&gt;expert_out_16</title>
<path fill="none" stroke="black" d="M11805.09,-279.24C11892.5,-266.85 12025.59,-248 12135.29,-232.45"/>
<polygon fill="black" stroke="black" points="12136.09,-235.87 12145.5,-231.01 12135.11,-228.94 12136.09,-235.87"/>
</g>
<!-- expert_out_16&#45;&gt;residual2_16 -->
<g id="edge480" class="edge">
<title>expert_out_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M12447.5,-177.98C12508.01,-165.33 12580.31,-150.21 12638.07,-138.13"/>
<polygon fill="black" stroke="black" points="12638.87,-141.54 12647.94,-136.07 12637.44,-134.69 12638.87,-141.54"/>
</g>
</g>
</svg>
