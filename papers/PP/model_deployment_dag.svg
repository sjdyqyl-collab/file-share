<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: ModelDeployment Pages: 1 -->
<svg width="2079pt" height="1756pt"
 viewBox="0.00 0.00 2078.84 1755.93" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1751.93)">
<title>ModelDeployment</title>
<polygon fill="#f8f9fa" stroke="transparent" points="-4,4 -4,-1751.93 2074.84,-1751.93 2074.84,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_legend</title>
<polygon fill="#f8f9fa" stroke="gray" stroke-dasharray="5,2" points="8,-1645.06 8,-1735.8 574,-1735.8 574,-1645.06 8,-1645.06"/>
<text text-anchor="middle" x="38.5" y="-1722.2" font-family="Helvetica,sans-Serif" font-size="12.00">Legend</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu0_3</title>
<path fill="#f3f3f3" stroke="#1976d2" d="M525,-1329.39C525,-1329.39 1024,-1329.39 1024,-1329.39 1030,-1329.39 1036,-1335.39 1036,-1341.39 1036,-1341.39 1036,-1551.93 1036,-1551.93 1036,-1557.93 1030,-1563.93 1024,-1563.93 1024,-1563.93 525,-1563.93 525,-1563.93 519,-1563.93 513,-1557.93 513,-1551.93 513,-1551.93 513,-1341.39 513,-1341.39 513,-1335.39 519,-1329.39 525,-1329.39"/>
<text text-anchor="middle" x="611.5" y="-1550.33" font-family="Helvetica,sans-Serif" font-size="12.00">GPU 0&#45;3: Layer 1 (Dense/MoE)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu4_7</title>
<path fill="#f3f3f3" stroke="#388e3c" d="M542,-920.84C542,-920.84 1041,-920.84 1041,-920.84 1047,-920.84 1053,-926.84 1053,-932.84 1053,-932.84 1053,-1143.39 1053,-1143.39 1053,-1149.39 1047,-1155.39 1041,-1155.39 1041,-1155.39 542,-1155.39 542,-1155.39 536,-1155.39 530,-1149.39 530,-1143.39 530,-1143.39 530,-932.84 530,-932.84 530,-926.84 536,-920.84 542,-920.84"/>
<text text-anchor="middle" x="628.5" y="-1141.79" font-family="Helvetica,sans-Serif" font-size="12.00">GPU 4&#45;7: Layer 2 (Dense/MoE)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu8_11</title>
<path fill="#f3f3f3" stroke="#7b1fa2" d="M509,-512.29C509,-512.29 1008,-512.29 1008,-512.29 1014,-512.29 1020,-518.29 1020,-524.29 1020,-524.29 1020,-734.84 1020,-734.84 1020,-740.84 1014,-746.84 1008,-746.84 1008,-746.84 509,-746.84 509,-746.84 503,-746.84 497,-740.84 497,-734.84 497,-734.84 497,-524.29 497,-524.29 497,-518.29 503,-512.29 509,-512.29"/>
<text text-anchor="middle" x="599.5" y="-733.24" font-family="Helvetica,sans-Serif" font-size="12.00">GPU 8&#45;11: Layer 3 (Dense/MoE)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu12_15</title>
<path fill="#f3f3f3" stroke="#c62828" d="M476,-103.74C476,-103.74 975,-103.74 975,-103.74 981,-103.74 987,-109.74 987,-115.74 987,-115.74 987,-326.29 987,-326.29 987,-332.29 981,-338.29 975,-338.29 975,-338.29 476,-338.29 476,-338.29 470,-338.29 464,-332.29 464,-326.29 464,-326.29 464,-115.74 464,-115.74 464,-109.74 470,-103.74 476,-103.74"/>
<text text-anchor="middle" x="570" y="-324.69" font-family="Helvetica,sans-Serif" font-size="12.00">GPU 12&#45;15: Layer 4 (Dense/MoE)</text>
</g>
<!-- legend_input -->
<g id="node1" class="node">
<title>legend_input</title>
<ellipse fill="#e3f2fd" stroke="black" cx="485" cy="-1679.93" rx="81.13" ry="26.74"/>
<text text-anchor="middle" x="485" y="-1683.73" font-family="Helvetica,sans-Serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="485" y="-1668.73" font-family="Helvetica,sans-Serif" font-size="14.00">(Batch=1024)</text>
</g>
<!-- legend_layer -->
<g id="node2" class="node">
<title>legend_layer</title>
<path fill="#fff3e0" stroke="black" d="M374,-1697.93C374,-1697.93 282,-1697.93 282,-1697.93 276,-1697.93 270,-1691.93 270,-1685.93 270,-1685.93 270,-1673.93 270,-1673.93 270,-1667.93 276,-1661.93 282,-1661.93 282,-1661.93 374,-1661.93 374,-1661.93 380,-1661.93 386,-1667.93 386,-1673.93 386,-1673.93 386,-1685.93 386,-1685.93 386,-1691.93 380,-1697.93 374,-1697.93"/>
<text text-anchor="middle" x="328" y="-1676.23" font-family="Helvetica,sans-Serif" font-size="14.00">Layer Partition</text>
</g>
<!-- legend_gpu -->
<g id="node3" class="node">
<title>legend_gpu</title>
<path fill="#f3e5f5" stroke="black" d="M239.5,-1697.93C239.5,-1697.93 130.5,-1697.93 130.5,-1697.93 124.5,-1697.93 118.5,-1691.93 118.5,-1685.93 118.5,-1685.93 118.5,-1673.93 118.5,-1673.93 118.5,-1667.93 124.5,-1661.93 130.5,-1661.93 130.5,-1661.93 239.5,-1661.93 239.5,-1661.93 245.5,-1661.93 251.5,-1667.93 251.5,-1673.93 251.5,-1673.93 251.5,-1685.93 251.5,-1685.93 251.5,-1691.93 245.5,-1697.93 239.5,-1697.93"/>
<text text-anchor="middle" x="185" y="-1676.23" font-family="Helvetica,sans-Serif" font-size="14.00">GPU Assignment</text>
</g>
<!-- legend_output -->
<g id="node4" class="node">
<title>legend_output</title>
<ellipse fill="#e8f5e8" stroke="black" cx="58" cy="-1679.93" rx="42.49" ry="18"/>
<text text-anchor="middle" x="58" y="-1676.23" font-family="Helvetica,sans-Serif" font-size="14.00">Output</text>
</g>
<!-- input -->
<g id="node5" class="node">
<title>input</title>
<ellipse fill="#e3f2fd" stroke="black" cx="758" cy="-1679.93" rx="173.48" ry="26.74"/>
<text text-anchor="middle" x="758" y="-1683.73" font-family="Helvetica,sans-Serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="758" y="-1668.73" font-family="Helvetica,sans-Serif" font-size="14.00">(Batch=1024, Seq_len=Variable)</text>
</g>
<!-- layer1_gpu0 -->
<g id="node6" class="node">
<title>layer1_gpu0</title>
<path fill="#fff3e0" stroke="black" d="M622.5,-1534.93C622.5,-1534.93 533.5,-1534.93 533.5,-1534.93 527.5,-1534.93 521.5,-1528.93 521.5,-1522.93 521.5,-1522.93 521.5,-1493.93 521.5,-1493.93 521.5,-1487.93 527.5,-1481.93 533.5,-1481.93 533.5,-1481.93 622.5,-1481.93 622.5,-1481.93 628.5,-1481.93 634.5,-1487.93 634.5,-1493.93 634.5,-1493.93 634.5,-1522.93 634.5,-1522.93 634.5,-1528.93 628.5,-1534.93 622.5,-1534.93"/>
<text text-anchor="middle" x="578" y="-1519.73" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 1.1</text>
<text text-anchor="middle" x="578" y="-1504.73" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="578" y="-1489.73" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;layer1_gpu0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer1_gpu0</title>
<path fill="none" stroke="black" d="M730.66,-1653.19C699.12,-1623.49 647.18,-1574.58 612.79,-1542.19"/>
<polygon fill="black" stroke="black" points="614.98,-1539.45 605.3,-1535.14 610.18,-1544.55 614.98,-1539.45"/>
<text text-anchor="middle" x="683" y="-1585.93" font-family="Helvetica,sans-Serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="683" y="-1574.93" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- layer1_gpu1 -->
<g id="node7" class="node">
<title>layer1_gpu1</title>
<path fill="#fff3e0" stroke="black" d="M753.5,-1534.93C753.5,-1534.93 664.5,-1534.93 664.5,-1534.93 658.5,-1534.93 652.5,-1528.93 652.5,-1522.93 652.5,-1522.93 652.5,-1493.93 652.5,-1493.93 652.5,-1487.93 658.5,-1481.93 664.5,-1481.93 664.5,-1481.93 753.5,-1481.93 753.5,-1481.93 759.5,-1481.93 765.5,-1487.93 765.5,-1493.93 765.5,-1493.93 765.5,-1522.93 765.5,-1522.93 765.5,-1528.93 759.5,-1534.93 753.5,-1534.93"/>
<text text-anchor="middle" x="709" y="-1519.73" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 1.2</text>
<text text-anchor="middle" x="709" y="-1504.73" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="709" y="-1489.73" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 1</text>
</g>
<!-- input&#45;&gt;layer1_gpu1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;layer1_gpu1</title>
<path fill="none" stroke="black" d="M750.45,-1652.82C742.09,-1623.91 728.58,-1577.15 719.26,-1544.93"/>
<polygon fill="black" stroke="black" points="722.54,-1543.66 716.4,-1535.02 715.81,-1545.6 722.54,-1543.66"/>
<text text-anchor="middle" x="753" y="-1585.93" font-family="Helvetica,sans-Serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="753" y="-1574.93" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- layer1_gpu2 -->
<g id="node8" class="node">
<title>layer1_gpu2</title>
<path fill="#fff3e0" stroke="black" d="M884.5,-1534.93C884.5,-1534.93 795.5,-1534.93 795.5,-1534.93 789.5,-1534.93 783.5,-1528.93 783.5,-1522.93 783.5,-1522.93 783.5,-1493.93 783.5,-1493.93 783.5,-1487.93 789.5,-1481.93 795.5,-1481.93 795.5,-1481.93 884.5,-1481.93 884.5,-1481.93 890.5,-1481.93 896.5,-1487.93 896.5,-1493.93 896.5,-1493.93 896.5,-1522.93 896.5,-1522.93 896.5,-1528.93 890.5,-1534.93 884.5,-1534.93"/>
<text text-anchor="middle" x="840" y="-1519.73" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 1.3</text>
<text text-anchor="middle" x="840" y="-1504.73" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="840" y="-1489.73" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 2</text>
</g>
<!-- input&#45;&gt;layer1_gpu2 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;layer1_gpu2</title>
<path fill="none" stroke="black" d="M770.63,-1652.82C784.74,-1623.66 807.63,-1576.34 823.23,-1544.1"/>
<polygon fill="black" stroke="black" points="826.42,-1545.55 827.62,-1535.02 820.12,-1542.5 826.42,-1545.55"/>
<text text-anchor="middle" x="828" y="-1585.93" font-family="Helvetica,sans-Serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="828" y="-1574.93" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- layer1_gpu3 -->
<g id="node9" class="node">
<title>layer1_gpu3</title>
<path fill="#fff3e0" stroke="black" d="M1015.5,-1534.93C1015.5,-1534.93 926.5,-1534.93 926.5,-1534.93 920.5,-1534.93 914.5,-1528.93 914.5,-1522.93 914.5,-1522.93 914.5,-1493.93 914.5,-1493.93 914.5,-1487.93 920.5,-1481.93 926.5,-1481.93 926.5,-1481.93 1015.5,-1481.93 1015.5,-1481.93 1021.5,-1481.93 1027.5,-1487.93 1027.5,-1493.93 1027.5,-1493.93 1027.5,-1522.93 1027.5,-1522.93 1027.5,-1528.93 1021.5,-1534.93 1015.5,-1534.93"/>
<text text-anchor="middle" x="971" y="-1519.73" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 1.4</text>
<text text-anchor="middle" x="971" y="-1504.73" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="971" y="-1489.73" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 3</text>
</g>
<!-- input&#45;&gt;layer1_gpu3 -->
<g id="edge4" class="edge">
<title>input&#45;&gt;layer1_gpu3</title>
<path fill="none" stroke="black" d="M791.49,-1653.48C821.67,-1630.4 867.14,-1595.31 906,-1563.93 914.77,-1556.85 924.11,-1549.13 932.89,-1541.79"/>
<polygon fill="black" stroke="black" points="935.36,-1544.29 940.77,-1535.18 930.86,-1538.93 935.36,-1544.29"/>
<text text-anchor="middle" x="914" y="-1585.93" font-family="Helvetica,sans-Serif" font-size="10.00">Input</text>
<text text-anchor="middle" x="914" y="-1574.93" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- layer1_experts -->
<g id="node10" class="node">
<title>layer1_experts</title>
<path fill="#fce4ec" stroke="black" d="M866.87,-1387.79C866.87,-1387.79 827.91,-1416.58 827.91,-1416.58 823.08,-1420.14 812.26,-1423.71 806.26,-1423.71 806.26,-1423.71 713.74,-1423.71 713.74,-1423.71 707.74,-1423.71 696.92,-1420.14 692.09,-1416.58 692.09,-1416.58 653.13,-1387.79 653.13,-1387.79 648.31,-1384.23 648.31,-1377.09 653.13,-1373.53 653.13,-1373.53 692.09,-1344.74 692.09,-1344.74 696.92,-1341.18 707.74,-1337.61 713.74,-1337.61 713.74,-1337.61 806.26,-1337.61 806.26,-1337.61 812.26,-1337.61 823.08,-1341.18 827.91,-1344.74 827.91,-1344.74 866.87,-1373.53 866.87,-1373.53 871.69,-1377.09 871.69,-1384.23 866.87,-1387.79"/>
<text text-anchor="middle" x="760" y="-1391.96" font-family="Helvetica,sans-Serif" font-size="14.00">8 Experts</text>
<text text-anchor="middle" x="760" y="-1376.96" font-family="Helvetica,sans-Serif" font-size="14.00">Distributed across</text>
<text text-anchor="middle" x="760" y="-1361.96" font-family="Helvetica,sans-Serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- layer1_gpu0&#45;&gt;layer1_experts -->
<g id="edge5" class="edge">
<title>layer1_gpu0&#45;&gt;layer1_experts</title>
<path fill="none" stroke="black" d="M615.27,-1481.68C637.32,-1466.44 665.93,-1446.67 691.89,-1428.73"/>
<polygon fill="black" stroke="black" points="693.97,-1431.54 700.21,-1422.98 689.99,-1425.78 693.97,-1431.54"/>
<text text-anchor="middle" x="693.5" y="-1455.93" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="693.5" y="-1444.93" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer1_gpu1&#45;&gt;layer1_experts -->
<g id="edge6" class="edge">
<title>layer1_gpu1&#45;&gt;layer1_experts</title>
<path fill="none" stroke="black" d="M719.44,-1481.68C725.1,-1467.74 732.28,-1450.01 739.04,-1433.36"/>
<polygon fill="black" stroke="black" points="742.43,-1434.3 742.94,-1423.72 735.94,-1431.67 742.43,-1434.3"/>
<text text-anchor="middle" x="759.5" y="-1455.93" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="759.5" y="-1444.93" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer1_gpu2&#45;&gt;layer1_experts -->
<g id="edge7" class="edge">
<title>layer1_gpu2&#45;&gt;layer1_experts</title>
<path fill="none" stroke="black" d="M823.62,-1481.68C814.59,-1467.48 803.05,-1449.35 792.29,-1432.43"/>
<polygon fill="black" stroke="black" points="795.07,-1430.28 786.75,-1423.72 789.17,-1434.04 795.07,-1430.28"/>
<text text-anchor="middle" x="835.5" y="-1455.93" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="835.5" y="-1444.93" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer1_gpu3&#45;&gt;layer1_experts -->
<g id="edge8" class="edge">
<title>layer1_gpu3&#45;&gt;layer1_experts</title>
<path fill="none" stroke="black" d="M929.73,-1481.85C909.92,-1469.65 885.8,-1454.92 864,-1441.93 854.29,-1436.15 844.04,-1430.12 833.91,-1424.2"/>
<polygon fill="black" stroke="black" points="835.45,-1421.05 825.05,-1419.04 831.93,-1427.1 835.45,-1421.05"/>
<text text-anchor="middle" x="923.5" y="-1455.93" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="923.5" y="-1444.93" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- comm1 -->
<g id="node26" class="node">
<title>comm1</title>
<path fill="#ffecb3" stroke="black" d="M748.54,-1275.82C748.54,-1275.82 649.46,-1244.95 649.46,-1244.95 643.73,-1243.17 643.73,-1239.6 649.46,-1237.82 649.46,-1237.82 748.54,-1206.95 748.54,-1206.95 754.27,-1205.17 765.73,-1205.17 771.46,-1206.95 771.46,-1206.95 870.54,-1237.82 870.54,-1237.82 876.27,-1239.6 876.27,-1243.17 870.54,-1244.95 870.54,-1244.95 771.46,-1275.82 771.46,-1275.82 765.73,-1277.6 754.27,-1277.6 748.54,-1275.82"/>
<text text-anchor="middle" x="760" y="-1245.19" font-family="Helvetica,sans-Serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="760" y="-1230.19" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 1 Output</text>
</g>
<!-- layer1_experts&#45;&gt;comm1 -->
<g id="edge9" class="edge">
<title>layer1_experts&#45;&gt;comm1</title>
<path fill="none" stroke="black" d="M760,-1337.35C760,-1322.38 760,-1305.43 760,-1290.03"/>
<polygon fill="black" stroke="black" points="763.5,-1289.67 760,-1279.67 756.5,-1289.67 763.5,-1289.67"/>
<text text-anchor="middle" x="780" y="-1311.39" font-family="Helvetica,sans-Serif" font-size="10.00">Gather</text>
<text text-anchor="middle" x="780" y="-1300.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- layer2_gpu4 -->
<g id="node11" class="node">
<title>layer2_gpu4</title>
<path fill="#fff3e0" stroke="black" d="M639.5,-1126.39C639.5,-1126.39 550.5,-1126.39 550.5,-1126.39 544.5,-1126.39 538.5,-1120.39 538.5,-1114.39 538.5,-1114.39 538.5,-1085.39 538.5,-1085.39 538.5,-1079.39 544.5,-1073.39 550.5,-1073.39 550.5,-1073.39 639.5,-1073.39 639.5,-1073.39 645.5,-1073.39 651.5,-1079.39 651.5,-1085.39 651.5,-1085.39 651.5,-1114.39 651.5,-1114.39 651.5,-1120.39 645.5,-1126.39 639.5,-1126.39"/>
<text text-anchor="middle" x="595" y="-1111.19" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 2.1</text>
<text text-anchor="middle" x="595" y="-1096.19" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="595" y="-1081.19" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer2_experts -->
<g id="node15" class="node">
<title>layer2_experts</title>
<path fill="#fce4ec" stroke="black" d="M847.87,-979.24C847.87,-979.24 808.91,-1008.03 808.91,-1008.03 804.08,-1011.6 793.26,-1015.16 787.26,-1015.16 787.26,-1015.16 694.74,-1015.16 694.74,-1015.16 688.74,-1015.16 677.92,-1011.6 673.09,-1008.03 673.09,-1008.03 634.13,-979.24 634.13,-979.24 629.31,-975.68 629.31,-968.55 634.13,-964.98 634.13,-964.98 673.09,-936.19 673.09,-936.19 677.92,-932.63 688.74,-929.06 694.74,-929.06 694.74,-929.06 787.26,-929.06 787.26,-929.06 793.26,-929.06 804.08,-932.63 808.91,-936.19 808.91,-936.19 847.87,-964.98 847.87,-964.98 852.69,-968.55 852.69,-975.68 847.87,-979.24"/>
<text text-anchor="middle" x="741" y="-983.41" font-family="Helvetica,sans-Serif" font-size="14.00">8 Experts</text>
<text text-anchor="middle" x="741" y="-968.41" font-family="Helvetica,sans-Serif" font-size="14.00">Distributed across</text>
<text text-anchor="middle" x="741" y="-953.41" font-family="Helvetica,sans-Serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- layer2_gpu4&#45;&gt;layer2_experts -->
<g id="edge14" class="edge">
<title>layer2_gpu4&#45;&gt;layer2_experts</title>
<path fill="none" stroke="black" d="M624.9,-1073.13C642.06,-1058.35 664.17,-1039.29 684.49,-1021.79"/>
<polygon fill="black" stroke="black" points="686.88,-1024.35 692.17,-1015.17 682.31,-1019.05 686.88,-1024.35"/>
<text text-anchor="middle" x="692.5" y="-1047.39" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="692.5" y="-1036.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer2_gpu5 -->
<g id="node12" class="node">
<title>layer2_gpu5</title>
<path fill="#fff3e0" stroke="black" d="M770.5,-1126.39C770.5,-1126.39 681.5,-1126.39 681.5,-1126.39 675.5,-1126.39 669.5,-1120.39 669.5,-1114.39 669.5,-1114.39 669.5,-1085.39 669.5,-1085.39 669.5,-1079.39 675.5,-1073.39 681.5,-1073.39 681.5,-1073.39 770.5,-1073.39 770.5,-1073.39 776.5,-1073.39 782.5,-1079.39 782.5,-1085.39 782.5,-1085.39 782.5,-1114.39 782.5,-1114.39 782.5,-1120.39 776.5,-1126.39 770.5,-1126.39"/>
<text text-anchor="middle" x="726" y="-1111.19" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 2.2</text>
<text text-anchor="middle" x="726" y="-1096.19" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="726" y="-1081.19" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer2_gpu5&#45;&gt;layer2_experts -->
<g id="edge15" class="edge">
<title>layer2_gpu5&#45;&gt;layer2_experts</title>
<path fill="none" stroke="black" d="M729.07,-1073.13C730.72,-1059.32 732.81,-1041.79 734.78,-1025.28"/>
<polygon fill="black" stroke="black" points="738.27,-1025.52 735.98,-1015.17 731.32,-1024.69 738.27,-1025.52"/>
<text text-anchor="middle" x="758.5" y="-1047.39" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="758.5" y="-1036.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer2_gpu6 -->
<g id="node13" class="node">
<title>layer2_gpu6</title>
<path fill="#fff3e0" stroke="black" d="M901.5,-1126.39C901.5,-1126.39 812.5,-1126.39 812.5,-1126.39 806.5,-1126.39 800.5,-1120.39 800.5,-1114.39 800.5,-1114.39 800.5,-1085.39 800.5,-1085.39 800.5,-1079.39 806.5,-1073.39 812.5,-1073.39 812.5,-1073.39 901.5,-1073.39 901.5,-1073.39 907.5,-1073.39 913.5,-1079.39 913.5,-1085.39 913.5,-1085.39 913.5,-1114.39 913.5,-1114.39 913.5,-1120.39 907.5,-1126.39 901.5,-1126.39"/>
<text text-anchor="middle" x="857" y="-1111.19" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 2.3</text>
<text text-anchor="middle" x="857" y="-1096.19" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="857" y="-1081.19" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer2_gpu6&#45;&gt;layer2_experts -->
<g id="edge16" class="edge">
<title>layer2_gpu6&#45;&gt;layer2_experts</title>
<path fill="none" stroke="black" d="M833.25,-1073.13C819.91,-1058.67 802.81,-1040.13 786.97,-1022.95"/>
<polygon fill="black" stroke="black" points="789.15,-1020.15 779.79,-1015.17 784,-1024.9 789.15,-1020.15"/>
<text text-anchor="middle" x="840.5" y="-1047.39" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="840.5" y="-1036.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer2_gpu7 -->
<g id="node14" class="node">
<title>layer2_gpu7</title>
<path fill="#fff3e0" stroke="black" d="M1032.5,-1126.39C1032.5,-1126.39 943.5,-1126.39 943.5,-1126.39 937.5,-1126.39 931.5,-1120.39 931.5,-1114.39 931.5,-1114.39 931.5,-1085.39 931.5,-1085.39 931.5,-1079.39 937.5,-1073.39 943.5,-1073.39 943.5,-1073.39 1032.5,-1073.39 1032.5,-1073.39 1038.5,-1073.39 1044.5,-1079.39 1044.5,-1085.39 1044.5,-1085.39 1044.5,-1114.39 1044.5,-1114.39 1044.5,-1120.39 1038.5,-1126.39 1032.5,-1126.39"/>
<text text-anchor="middle" x="988" y="-1111.19" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 2.4</text>
<text text-anchor="middle" x="988" y="-1096.19" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="988" y="-1081.19" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer2_gpu7&#45;&gt;layer2_experts -->
<g id="edge17" class="edge">
<title>layer2_gpu7&#45;&gt;layer2_experts</title>
<path fill="none" stroke="black" d="M943.15,-1073.33C921.01,-1060.93 893.79,-1046.03 869,-1033.39 853.82,-1025.64 837.46,-1017.67 821.69,-1010.16"/>
<polygon fill="black" stroke="black" points="823.01,-1006.92 812.48,-1005.8 820.02,-1013.24 823.01,-1006.92"/>
<text text-anchor="middle" x="932.5" y="-1047.39" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="932.5" y="-1036.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- comm2 -->
<g id="node27" class="node">
<title>comm2</title>
<path fill="#ffecb3" stroke="black" d="M729.54,-867.27C729.54,-867.27 630.46,-836.41 630.46,-836.41 624.73,-834.62 624.73,-831.05 630.46,-829.27 630.46,-829.27 729.54,-798.41 729.54,-798.41 735.27,-796.62 746.73,-796.62 752.46,-798.41 752.46,-798.41 851.54,-829.27 851.54,-829.27 857.27,-831.05 857.27,-834.62 851.54,-836.41 851.54,-836.41 752.46,-867.27 752.46,-867.27 746.73,-869.05 735.27,-869.05 729.54,-867.27"/>
<text text-anchor="middle" x="741" y="-836.64" font-family="Helvetica,sans-Serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="741" y="-821.64" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 2 Output</text>
</g>
<!-- layer2_experts&#45;&gt;comm2 -->
<g id="edge18" class="edge">
<title>layer2_experts&#45;&gt;comm2</title>
<path fill="none" stroke="black" d="M741,-928.8C741,-913.83 741,-896.88 741,-881.49"/>
<polygon fill="black" stroke="black" points="744.5,-881.12 741,-871.12 737.5,-881.12 744.5,-881.12"/>
<text text-anchor="middle" x="761" y="-902.84" font-family="Helvetica,sans-Serif" font-size="10.00">Gather</text>
<text text-anchor="middle" x="761" y="-891.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- layer3_gpu8 -->
<g id="node16" class="node">
<title>layer3_gpu8</title>
<path fill="#fff3e0" stroke="black" d="M606.5,-717.84C606.5,-717.84 517.5,-717.84 517.5,-717.84 511.5,-717.84 505.5,-711.84 505.5,-705.84 505.5,-705.84 505.5,-676.84 505.5,-676.84 505.5,-670.84 511.5,-664.84 517.5,-664.84 517.5,-664.84 606.5,-664.84 606.5,-664.84 612.5,-664.84 618.5,-670.84 618.5,-676.84 618.5,-676.84 618.5,-705.84 618.5,-705.84 618.5,-711.84 612.5,-717.84 606.5,-717.84"/>
<text text-anchor="middle" x="562" y="-702.64" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 3.1</text>
<text text-anchor="middle" x="562" y="-687.64" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="562" y="-672.64" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer3_experts -->
<g id="node20" class="node">
<title>layer3_experts</title>
<path fill="#fce4ec" stroke="black" d="M814.87,-570.69C814.87,-570.69 775.91,-599.48 775.91,-599.48 771.08,-603.05 760.26,-606.61 754.26,-606.61 754.26,-606.61 661.74,-606.61 661.74,-606.61 655.74,-606.61 644.92,-603.05 640.09,-599.48 640.09,-599.48 601.13,-570.69 601.13,-570.69 596.31,-567.13 596.31,-560 601.13,-556.43 601.13,-556.43 640.09,-527.64 640.09,-527.64 644.92,-524.08 655.74,-520.51 661.74,-520.51 661.74,-520.51 754.26,-520.51 754.26,-520.51 760.26,-520.51 771.08,-524.08 775.91,-527.64 775.91,-527.64 814.87,-556.43 814.87,-556.43 819.69,-560 819.69,-567.13 814.87,-570.69"/>
<text text-anchor="middle" x="708" y="-574.86" font-family="Helvetica,sans-Serif" font-size="14.00">8 Experts</text>
<text text-anchor="middle" x="708" y="-559.86" font-family="Helvetica,sans-Serif" font-size="14.00">Distributed across</text>
<text text-anchor="middle" x="708" y="-544.86" font-family="Helvetica,sans-Serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- layer3_gpu8&#45;&gt;layer3_experts -->
<g id="edge23" class="edge">
<title>layer3_gpu8&#45;&gt;layer3_experts</title>
<path fill="none" stroke="black" d="M591.9,-664.58C609.06,-649.8 631.17,-630.75 651.49,-613.24"/>
<polygon fill="black" stroke="black" points="653.88,-615.8 659.17,-606.62 649.31,-610.5 653.88,-615.8"/>
<text text-anchor="middle" x="659.5" y="-638.84" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="659.5" y="-627.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer3_gpu9 -->
<g id="node17" class="node">
<title>layer3_gpu9</title>
<path fill="#fff3e0" stroke="black" d="M737.5,-717.84C737.5,-717.84 648.5,-717.84 648.5,-717.84 642.5,-717.84 636.5,-711.84 636.5,-705.84 636.5,-705.84 636.5,-676.84 636.5,-676.84 636.5,-670.84 642.5,-664.84 648.5,-664.84 648.5,-664.84 737.5,-664.84 737.5,-664.84 743.5,-664.84 749.5,-670.84 749.5,-676.84 749.5,-676.84 749.5,-705.84 749.5,-705.84 749.5,-711.84 743.5,-717.84 737.5,-717.84"/>
<text text-anchor="middle" x="693" y="-702.64" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 3.2</text>
<text text-anchor="middle" x="693" y="-687.64" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="693" y="-672.64" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer3_gpu9&#45;&gt;layer3_experts -->
<g id="edge24" class="edge">
<title>layer3_gpu9&#45;&gt;layer3_experts</title>
<path fill="none" stroke="black" d="M696.07,-664.58C697.72,-650.77 699.81,-633.25 701.78,-616.73"/>
<polygon fill="black" stroke="black" points="705.27,-616.97 702.98,-606.62 698.32,-616.14 705.27,-616.97"/>
<text text-anchor="middle" x="725.5" y="-638.84" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="725.5" y="-627.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer3_gpu10 -->
<g id="node18" class="node">
<title>layer3_gpu10</title>
<path fill="#fff3e0" stroke="black" d="M868.5,-717.84C868.5,-717.84 779.5,-717.84 779.5,-717.84 773.5,-717.84 767.5,-711.84 767.5,-705.84 767.5,-705.84 767.5,-676.84 767.5,-676.84 767.5,-670.84 773.5,-664.84 779.5,-664.84 779.5,-664.84 868.5,-664.84 868.5,-664.84 874.5,-664.84 880.5,-670.84 880.5,-676.84 880.5,-676.84 880.5,-705.84 880.5,-705.84 880.5,-711.84 874.5,-717.84 868.5,-717.84"/>
<text text-anchor="middle" x="824" y="-702.64" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 3.3</text>
<text text-anchor="middle" x="824" y="-687.64" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="824" y="-672.64" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer3_gpu10&#45;&gt;layer3_experts -->
<g id="edge25" class="edge">
<title>layer3_gpu10&#45;&gt;layer3_experts</title>
<path fill="none" stroke="black" d="M800.25,-664.58C786.91,-650.12 769.81,-631.58 753.97,-614.4"/>
<polygon fill="black" stroke="black" points="756.15,-611.6 746.79,-606.62 751,-616.35 756.15,-611.6"/>
<text text-anchor="middle" x="807.5" y="-638.84" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="807.5" y="-627.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer3_gpu11 -->
<g id="node19" class="node">
<title>layer3_gpu11</title>
<path fill="#fff3e0" stroke="black" d="M999.5,-717.84C999.5,-717.84 910.5,-717.84 910.5,-717.84 904.5,-717.84 898.5,-711.84 898.5,-705.84 898.5,-705.84 898.5,-676.84 898.5,-676.84 898.5,-670.84 904.5,-664.84 910.5,-664.84 910.5,-664.84 999.5,-664.84 999.5,-664.84 1005.5,-664.84 1011.5,-670.84 1011.5,-676.84 1011.5,-676.84 1011.5,-705.84 1011.5,-705.84 1011.5,-711.84 1005.5,-717.84 999.5,-717.84"/>
<text text-anchor="middle" x="955" y="-702.64" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 3.4</text>
<text text-anchor="middle" x="955" y="-687.64" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="955" y="-672.64" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer3_gpu11&#45;&gt;layer3_experts -->
<g id="edge26" class="edge">
<title>layer3_gpu11&#45;&gt;layer3_experts</title>
<path fill="none" stroke="black" d="M910.15,-664.78C888.01,-652.38 860.79,-637.48 836,-624.84 820.82,-617.09 804.46,-609.12 788.69,-601.61"/>
<polygon fill="black" stroke="black" points="790.01,-598.37 779.48,-597.25 787.02,-604.69 790.01,-598.37"/>
<text text-anchor="middle" x="899.5" y="-638.84" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="899.5" y="-627.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- comm3 -->
<g id="node28" class="node">
<title>comm3</title>
<path fill="#ffecb3" stroke="black" d="M696.54,-458.72C696.54,-458.72 597.46,-427.86 597.46,-427.86 591.73,-426.07 591.73,-422.5 597.46,-420.72 597.46,-420.72 696.54,-389.86 696.54,-389.86 702.27,-388.07 713.73,-388.07 719.46,-389.86 719.46,-389.86 818.54,-420.72 818.54,-420.72 824.27,-422.5 824.27,-426.07 818.54,-427.86 818.54,-427.86 719.46,-458.72 719.46,-458.72 713.73,-460.5 702.27,-460.5 696.54,-458.72"/>
<text text-anchor="middle" x="708" y="-428.09" font-family="Helvetica,sans-Serif" font-size="14.00">AllReduce</text>
<text text-anchor="middle" x="708" y="-413.09" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 3 Output</text>
</g>
<!-- layer3_experts&#45;&gt;comm3 -->
<g id="edge27" class="edge">
<title>layer3_experts&#45;&gt;comm3</title>
<path fill="none" stroke="black" d="M708,-520.26C708,-505.28 708,-488.33 708,-472.94"/>
<polygon fill="black" stroke="black" points="711.5,-472.57 708,-462.57 704.5,-472.57 711.5,-472.57"/>
<text text-anchor="middle" x="728" y="-494.29" font-family="Helvetica,sans-Serif" font-size="10.00">Gather</text>
<text text-anchor="middle" x="728" y="-483.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- layer4_gpu12 -->
<g id="node21" class="node">
<title>layer4_gpu12</title>
<path fill="#fff3e0" stroke="black" d="M573.5,-309.29C573.5,-309.29 484.5,-309.29 484.5,-309.29 478.5,-309.29 472.5,-303.29 472.5,-297.29 472.5,-297.29 472.5,-268.29 472.5,-268.29 472.5,-262.29 478.5,-256.29 484.5,-256.29 484.5,-256.29 573.5,-256.29 573.5,-256.29 579.5,-256.29 585.5,-262.29 585.5,-268.29 585.5,-268.29 585.5,-297.29 585.5,-297.29 585.5,-303.29 579.5,-309.29 573.5,-309.29"/>
<text text-anchor="middle" x="529" y="-294.09" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 4.1</text>
<text text-anchor="middle" x="529" y="-279.09" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="529" y="-264.09" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer4_experts -->
<g id="node25" class="node">
<title>layer4_experts</title>
<path fill="#fce4ec" stroke="black" d="M817.87,-162.15C817.87,-162.15 778.91,-190.93 778.91,-190.93 774.08,-194.5 763.26,-198.06 757.26,-198.06 757.26,-198.06 664.74,-198.06 664.74,-198.06 658.74,-198.06 647.92,-194.5 643.09,-190.93 643.09,-190.93 604.13,-162.15 604.13,-162.15 599.31,-158.58 599.31,-151.45 604.13,-147.88 604.13,-147.88 643.09,-119.1 643.09,-119.1 647.92,-115.53 658.74,-111.96 664.74,-111.96 664.74,-111.96 757.26,-111.96 757.26,-111.96 763.26,-111.96 774.08,-115.53 778.91,-119.1 778.91,-119.1 817.87,-147.88 817.87,-147.88 822.69,-151.45 822.69,-158.58 817.87,-162.15"/>
<text text-anchor="middle" x="711" y="-166.31" font-family="Helvetica,sans-Serif" font-size="14.00">8 Experts</text>
<text text-anchor="middle" x="711" y="-151.31" font-family="Helvetica,sans-Serif" font-size="14.00">Distributed across</text>
<text text-anchor="middle" x="711" y="-136.31" font-family="Helvetica,sans-Serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- layer4_gpu12&#45;&gt;layer4_experts -->
<g id="edge32" class="edge">
<title>layer4_gpu12&#45;&gt;layer4_experts</title>
<path fill="none" stroke="black" d="M566.27,-256.03C588.32,-240.79 616.93,-221.02 642.89,-203.08"/>
<polygon fill="black" stroke="black" points="644.97,-205.9 651.21,-197.33 640.99,-200.14 644.97,-205.9"/>
<text text-anchor="middle" x="644.5" y="-230.29" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="644.5" y="-219.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer4_gpu13 -->
<g id="node22" class="node">
<title>layer4_gpu13</title>
<path fill="#fff3e0" stroke="black" d="M704.5,-309.29C704.5,-309.29 615.5,-309.29 615.5,-309.29 609.5,-309.29 603.5,-303.29 603.5,-297.29 603.5,-297.29 603.5,-268.29 603.5,-268.29 603.5,-262.29 609.5,-256.29 615.5,-256.29 615.5,-256.29 704.5,-256.29 704.5,-256.29 710.5,-256.29 716.5,-262.29 716.5,-268.29 716.5,-268.29 716.5,-297.29 716.5,-297.29 716.5,-303.29 710.5,-309.29 704.5,-309.29"/>
<text text-anchor="middle" x="660" y="-294.09" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 4.2</text>
<text text-anchor="middle" x="660" y="-279.09" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="660" y="-264.09" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer4_gpu13&#45;&gt;layer4_experts -->
<g id="edge33" class="edge">
<title>layer4_gpu13&#45;&gt;layer4_experts</title>
<path fill="none" stroke="black" d="M670.44,-256.03C676.1,-242.09 683.28,-224.37 690.04,-207.72"/>
<polygon fill="black" stroke="black" points="693.43,-208.66 693.94,-198.08 686.94,-206.03 693.43,-208.66"/>
<text text-anchor="middle" x="710.5" y="-230.29" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="710.5" y="-219.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer4_gpu14 -->
<g id="node23" class="node">
<title>layer4_gpu14</title>
<path fill="#fff3e0" stroke="black" d="M835.5,-309.29C835.5,-309.29 746.5,-309.29 746.5,-309.29 740.5,-309.29 734.5,-303.29 734.5,-297.29 734.5,-297.29 734.5,-268.29 734.5,-268.29 734.5,-262.29 740.5,-256.29 746.5,-256.29 746.5,-256.29 835.5,-256.29 835.5,-256.29 841.5,-256.29 847.5,-262.29 847.5,-268.29 847.5,-268.29 847.5,-297.29 847.5,-297.29 847.5,-303.29 841.5,-309.29 835.5,-309.29"/>
<text text-anchor="middle" x="791" y="-294.09" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 4.3</text>
<text text-anchor="middle" x="791" y="-279.09" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="791" y="-264.09" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer4_gpu14&#45;&gt;layer4_experts -->
<g id="edge34" class="edge">
<title>layer4_gpu14&#45;&gt;layer4_experts</title>
<path fill="none" stroke="black" d="M774.62,-256.03C765.59,-241.83 754.05,-223.7 743.29,-206.78"/>
<polygon fill="black" stroke="black" points="746.07,-204.64 737.75,-198.08 740.17,-208.39 746.07,-204.64"/>
<text text-anchor="middle" x="786.5" y="-230.29" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="786.5" y="-219.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- layer4_gpu15 -->
<g id="node24" class="node">
<title>layer4_gpu15</title>
<path fill="#fff3e0" stroke="black" d="M966.5,-309.29C966.5,-309.29 877.5,-309.29 877.5,-309.29 871.5,-309.29 865.5,-303.29 865.5,-297.29 865.5,-297.29 865.5,-268.29 865.5,-268.29 865.5,-262.29 871.5,-256.29 877.5,-256.29 877.5,-256.29 966.5,-256.29 966.5,-256.29 972.5,-256.29 978.5,-262.29 978.5,-268.29 978.5,-268.29 978.5,-297.29 978.5,-297.29 978.5,-303.29 972.5,-309.29 966.5,-309.29"/>
<text text-anchor="middle" x="922" y="-294.09" font-family="Helvetica,sans-Serif" font-size="14.00">Layer 4.4</text>
<text text-anchor="middle" x="922" y="-279.09" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25%</text>
<text text-anchor="middle" x="922" y="-264.09" font-family="Helvetica,sans-Serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer4_gpu15&#45;&gt;layer4_experts -->
<g id="edge35" class="edge">
<title>layer4_gpu15&#45;&gt;layer4_experts</title>
<path fill="none" stroke="black" d="M880.73,-256.21C860.92,-244.01 836.8,-229.28 815,-216.29 805.29,-210.51 795.04,-204.47 784.91,-198.56"/>
<polygon fill="black" stroke="black" points="786.45,-195.4 776.05,-193.39 782.93,-201.45 786.45,-195.4"/>
<text text-anchor="middle" x="874.5" y="-230.29" font-family="Helvetica,sans-Serif" font-size="10.00">Local</text>
<text text-anchor="middle" x="874.5" y="-219.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H/4)</text>
</g>
<!-- output -->
<g id="node29" class="node">
<title>output</title>
<ellipse fill="#e8f5e8" stroke="black" cx="711" cy="-26.87" rx="170.33" ry="26.74"/>
<text text-anchor="middle" x="711" y="-30.67" font-family="Helvetica,sans-Serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="711" y="-15.67" font-family="Helvetica,sans-Serif" font-size="14.00">(Batch=1024, Hidden=Variable)</text>
</g>
<!-- layer4_experts&#45;&gt;output -->
<g id="edge36" class="edge">
<title>layer4_experts&#45;&gt;output</title>
<path fill="none" stroke="black" d="M711,-111.66C711,-96.22 711,-78.93 711,-64.07"/>
<polygon fill="black" stroke="black" points="714.5,-63.75 711,-53.75 707.5,-63.75 714.5,-63.75"/>
<text text-anchor="middle" x="731" y="-85.74" font-family="Helvetica,sans-Serif" font-size="10.00">Final</text>
<text text-anchor="middle" x="731" y="-74.74" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm1&#45;&gt;layer2_gpu4 -->
<g id="edge10" class="edge">
<title>comm1&#45;&gt;layer2_gpu4</title>
<path fill="none" stroke="black" d="M727.79,-1213.16C700.62,-1190.18 661.67,-1157.25 632.98,-1133"/>
<polygon fill="black" stroke="black" points="635.07,-1130.18 625.18,-1126.4 630.55,-1135.53 635.07,-1130.18"/>
<text text-anchor="middle" x="713" y="-1177.39" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="713" y="-1166.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm1&#45;&gt;layer2_gpu5 -->
<g id="edge11" class="edge">
<title>comm1&#45;&gt;layer2_gpu5</title>
<path fill="none" stroke="black" d="M751.6,-1205.9C746.46,-1184.82 739.9,-1157.91 734.71,-1136.61"/>
<polygon fill="black" stroke="black" points="738.05,-1135.54 732.28,-1126.66 731.25,-1137.2 738.05,-1135.54"/>
<text text-anchor="middle" x="766" y="-1177.39" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="766" y="-1166.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm1&#45;&gt;layer2_gpu6 -->
<g id="edge12" class="edge">
<title>comm1&#45;&gt;layer2_gpu6</title>
<path fill="none" stroke="black" d="M781.29,-1209.77C796.62,-1187.73 817.31,-1157.97 833.19,-1135.13"/>
<polygon fill="black" stroke="black" points="836.18,-1136.96 839.02,-1126.75 830.43,-1132.96 836.18,-1136.96"/>
<text text-anchor="middle" x="831" y="-1177.39" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="831" y="-1166.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm1&#45;&gt;layer2_gpu7 -->
<g id="edge13" class="edge">
<title>comm1&#45;&gt;layer2_gpu7</title>
<path fill="none" stroke="black" d="M808.63,-1218.46C841.88,-1202.65 886.38,-1179.86 923,-1155.39 932.94,-1148.74 943.12,-1140.83 952.38,-1133.12"/>
<polygon fill="black" stroke="black" points="954.89,-1135.57 960.25,-1126.43 950.36,-1130.24 954.89,-1135.57"/>
<text text-anchor="middle" x="930" y="-1177.39" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="930" y="-1166.39" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm2&#45;&gt;layer3_gpu8 -->
<g id="edge19" class="edge">
<title>comm2&#45;&gt;layer3_gpu8</title>
<path fill="none" stroke="black" d="M705.17,-805.93C682.52,-789.35 652.75,-767.21 627,-746.84 617.98,-739.7 608.41,-731.84 599.47,-724.37"/>
<polygon fill="black" stroke="black" points="601.71,-721.69 591.8,-717.93 597.21,-727.05 601.71,-721.69"/>
<text text-anchor="middle" x="685" y="-768.84" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="685" y="-757.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm2&#45;&gt;layer3_gpu9 -->
<g id="edge20" class="edge">
<title>comm2&#45;&gt;layer3_gpu9</title>
<path fill="none" stroke="black" d="M729.38,-798.07C722.02,-776.67 712.51,-749.05 705.07,-727.41"/>
<polygon fill="black" stroke="black" points="708.37,-726.25 701.81,-717.93 701.75,-728.52 708.37,-726.25"/>
<text text-anchor="middle" x="742" y="-768.84" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="742" y="-757.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm2&#45;&gt;layer3_gpu10 -->
<g id="edge21" class="edge">
<title>comm2&#45;&gt;layer3_gpu10</title>
<path fill="none" stroke="black" d="M759.63,-800.53C772.71,-778.55 790.2,-749.15 803.64,-726.55"/>
<polygon fill="black" stroke="black" points="806.66,-728.33 808.77,-717.94 800.64,-724.75 806.66,-728.33"/>
<text text-anchor="middle" x="804" y="-768.84" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="804" y="-757.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm2&#45;&gt;layer3_gpu11 -->
<g id="edge22" class="edge">
<title>comm2&#45;&gt;layer3_gpu11</title>
<path fill="none" stroke="black" d="M786.28,-808.75C816.49,-792.69 856.64,-770.06 890,-746.84 899.72,-740.07 909.75,-732.17 918.94,-724.53"/>
<polygon fill="black" stroke="black" points="921.39,-727.04 926.76,-717.91 916.87,-721.7 921.39,-727.04"/>
<text text-anchor="middle" x="894" y="-768.84" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="894" y="-757.84" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm3&#45;&gt;layer4_gpu12 -->
<g id="edge28" class="edge">
<title>comm3&#45;&gt;layer4_gpu12</title>
<path fill="none" stroke="black" d="M672.17,-397.38C649.52,-380.81 619.75,-358.66 594,-338.29 584.98,-331.15 575.41,-323.3 566.47,-315.82"/>
<polygon fill="black" stroke="black" points="568.71,-313.14 558.8,-309.38 564.21,-318.5 568.71,-313.14"/>
<text text-anchor="middle" x="652" y="-360.29" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="652" y="-349.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm3&#45;&gt;layer4_gpu13 -->
<g id="edge29" class="edge">
<title>comm3&#45;&gt;layer4_gpu13</title>
<path fill="none" stroke="black" d="M696.38,-389.52C689.02,-368.12 679.51,-340.5 672.07,-318.86"/>
<polygon fill="black" stroke="black" points="675.37,-317.7 668.81,-309.38 668.75,-319.97 675.37,-317.7"/>
<text text-anchor="middle" x="709" y="-360.29" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="709" y="-349.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm3&#45;&gt;layer4_gpu14 -->
<g id="edge30" class="edge">
<title>comm3&#45;&gt;layer4_gpu14</title>
<path fill="none" stroke="black" d="M726.63,-391.98C739.71,-370 757.2,-340.6 770.64,-318"/>
<polygon fill="black" stroke="black" points="773.66,-319.78 775.77,-309.39 767.64,-316.2 773.66,-319.78"/>
<text text-anchor="middle" x="771" y="-360.29" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="771" y="-349.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- comm3&#45;&gt;layer4_gpu15 -->
<g id="edge31" class="edge">
<title>comm3&#45;&gt;layer4_gpu15</title>
<path fill="none" stroke="black" d="M753.28,-400.2C783.49,-384.14 823.64,-361.51 857,-338.29 866.72,-331.52 876.75,-323.63 885.94,-315.98"/>
<polygon fill="black" stroke="black" points="888.39,-318.49 893.76,-309.36 883.87,-313.15 888.39,-318.49"/>
<text text-anchor="middle" x="861" y="-360.29" font-family="Helvetica,sans-Serif" font-size="10.00">Scatter</text>
<text text-anchor="middle" x="861" y="-349.29" font-family="Helvetica,sans-Serif" font-size="10.00">(B, S, H)</text>
</g>
<!-- mem1 -->
<g id="node30" class="node">
<title>mem1</title>
<polygon fill="#f5f5f5" stroke="black" stroke-dasharray="5,2" points="1097,-1698.93 949,-1698.93 949,-1660.93 1103,-1660.93 1103,-1692.93 1097,-1698.93"/>
<polyline fill="none" stroke="black" stroke-dasharray="5,2" points="1097,-1698.93 1097,-1692.93 "/>
<polyline fill="none" stroke="black" stroke-dasharray="5,2" points="1103,-1692.93 1097,-1692.93 "/>
<text text-anchor="middle" x="1026" y="-1683.73" font-family="Helvetica,sans-Serif" font-size="14.00">SRAM/L2 Cache</text>
<text text-anchor="middle" x="1026" y="-1668.73" font-family="Helvetica,sans-Serif" font-size="14.00">Constraint: &lt; 40MB</text>
</g>
<!-- mem2 -->
<g id="node31" class="node">
<title>mem2</title>
<polygon fill="#f5f5f5" stroke="black" stroke-dasharray="5,2" points="1289,-1706.43 1121,-1706.43 1121,-1653.43 1295,-1653.43 1295,-1700.43 1289,-1706.43"/>
<polyline fill="none" stroke="black" stroke-dasharray="5,2" points="1289,-1706.43 1289,-1700.43 "/>
<polyline fill="none" stroke="black" stroke-dasharray="5,2" points="1295,-1700.43 1289,-1700.43 "/>
<text text-anchor="middle" x="1208" y="-1691.23" font-family="Helvetica,sans-Serif" font-size="14.00">Weights: 25% per GPU</text>
<text text-anchor="middle" x="1208" y="-1676.23" font-family="Helvetica,sans-Serif" font-size="14.00">Activations: Local</text>
<text text-anchor="middle" x="1208" y="-1661.23" font-family="Helvetica,sans-Serif" font-size="14.00">Batch=1024</text>
</g>
<!-- tp_dense -->
<g id="node32" class="node">
<title>tp_dense</title>
<path fill="#e1f5fe" stroke="black" d="M1711.05,-1747.93C1711.05,-1747.93 1408.86,-1747.93 1408.86,-1747.93 1402.86,-1747.93 1393.71,-1742.83 1390.56,-1737.72 1390.56,-1737.72 1319.25,-1622.15 1319.25,-1622.15 1316.1,-1617.04 1318.95,-1611.93 1324.95,-1611.93 1324.95,-1611.93 1627.14,-1611.93 1627.14,-1611.93 1633.14,-1611.93 1642.29,-1617.04 1645.44,-1622.15 1645.44,-1622.15 1716.75,-1737.72 1716.75,-1737.72 1719.9,-1742.83 1717.05,-1747.93 1711.05,-1747.93"/>
<text text-anchor="middle" x="1518" y="-1698.73" font-family="Helvetica,sans-Serif" font-size="14.00">Dense Layers:</text>
<text text-anchor="middle" x="1518" y="-1683.73" font-family="Helvetica,sans-Serif" font-size="14.00">Column Parallel Linear</text>
<text text-anchor="middle" x="1518" y="-1668.73" font-family="Helvetica,sans-Serif" font-size="14.00">Row Parallel Linear</text>
<text text-anchor="middle" x="1518" y="-1653.73" font-family="Helvetica,sans-Serif" font-size="14.00">AllReduce after each layer</text>
</g>
<!-- tp_moe -->
<g id="node33" class="node">
<title>tp_moe</title>
<path fill="#e1f5fe" stroke="black" d="M2058.69,-1747.93C2058.69,-1747.93 1820.71,-1747.93 1820.71,-1747.93 1814.71,-1747.93 1806.04,-1742.56 1803.38,-1737.18 1803.38,-1737.18 1746.64,-1622.69 1746.64,-1622.69 1743.98,-1617.31 1747.31,-1611.93 1753.31,-1611.93 1753.31,-1611.93 1991.29,-1611.93 1991.29,-1611.93 1997.29,-1611.93 2005.96,-1617.31 2008.62,-1622.69 2008.62,-1622.69 2065.36,-1737.18 2065.36,-1737.18 2068.02,-1742.56 2064.69,-1747.93 2058.69,-1747.93"/>
<text text-anchor="middle" x="1906" y="-1698.73" font-family="Helvetica,sans-Serif" font-size="14.00">MoE Layers:</text>
<text text-anchor="middle" x="1906" y="-1683.73" font-family="Helvetica,sans-Serif" font-size="14.00">Expert Parallelism</text>
<text text-anchor="middle" x="1906" y="-1668.73" font-family="Helvetica,sans-Serif" font-size="14.00">AllToAll for routing</text>
<text text-anchor="middle" x="1906" y="-1653.73" font-family="Helvetica,sans-Serif" font-size="14.00">AllReduce for output</text>
</g>
</g>
</svg>
