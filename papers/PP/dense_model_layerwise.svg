<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: dense_model_layerwise Pages: 1 -->
<svg width="3225pt" height="13170pt"
 viewBox="0.00 0.00 3225.00 13170.10" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 13166.1)">
<title>dense_model_layerwise</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-13166.1 3221,-13166.1 3221,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="#e8f4fd" stroke="black" points="393,-13162.1 127,-13162.1 127,-13109.1 393,-13109.1 393,-13162.1"/>
<text text-anchor="middle" x="260" y="-13146.9" font-family="Helvetica,sans-Serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="260" y="-13131.9" font-family="Helvetica,sans-Serif" font-size="14.00">[batch=1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="260" y="-13116.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: Host</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="#f8f9f9" stroke="black" points="286.5,-13051.1 71.5,-13051.1 71.5,-12998.1 286.5,-12998.1 286.5,-13051.1"/>
<text text-anchor="middle" x="179" y="-13035.9" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="179" y="-13020.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="179" y="-13005.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M206.75,-13109.01C206.75,-13109.01 206.75,-13061.36 206.75,-13061.36"/>
<polygon fill="black" stroke="black" points="210.25,-13061.36 206.75,-13051.36 203.25,-13061.36 210.25,-13061.36"/>
</g>
<!-- residual1_1 -->
<g id="node8" class="node">
<title>residual1_1</title>
<polygon fill="#fadbd8" stroke="black" points="352.5,-12385.1 137.5,-12385.1 137.5,-12332.1 352.5,-12332.1 352.5,-12385.1"/>
<text text-anchor="middle" x="245" y="-12369.9" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="245" y="-12354.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="245" y="-12339.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge7" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M321.25,-13108.86C321.25,-13108.86 321.25,-12395.24 321.25,-12395.24"/>
<polygon fill="black" stroke="black" points="324.75,-12395.24 321.25,-12385.24 317.75,-12395.24 324.75,-12395.24"/>
</g>
<!-- attn_qkv_1 -->
<g id="node3" class="node">
<title>attn_qkv_1</title>
<polygon fill="#ffe6cc" stroke="black" points="279,-12940.1 49,-12940.1 49,-12887.1 279,-12887.1 279,-12940.1"/>
<text text-anchor="middle" x="164" y="-12924.9" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="164" y="-12909.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="164" y="-12894.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_1&#45;&gt;attn_qkv_1 -->
<g id="edge2" class="edge">
<title>ln1_1&#45;&gt;attn_qkv_1</title>
<path fill="none" stroke="black" d="M175.25,-12998.01C175.25,-12998.01 175.25,-12950.36 175.25,-12950.36"/>
<polygon fill="black" stroke="black" points="178.75,-12950.36 175.25,-12940.36 171.75,-12950.36 178.75,-12950.36"/>
</g>
<!-- attn_score_1 -->
<g id="node4" class="node">
<title>attn_score_1</title>
<polygon fill="#ffe6cc" stroke="black" points="289.5,-12829.1 14.5,-12829.1 14.5,-12776.1 289.5,-12776.1 289.5,-12829.1"/>
<text text-anchor="middle" x="152" y="-12813.9" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="152" y="-12798.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="152" y="-12783.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_1&#45;&gt;attn_score_1 -->
<g id="edge3" class="edge">
<title>attn_qkv_1&#45;&gt;attn_score_1</title>
<path fill="none" stroke="black" d="M164,-12887.01C164,-12887.01 164,-12839.36 164,-12839.36"/>
<polygon fill="black" stroke="black" points="167.5,-12839.36 164,-12829.36 160.5,-12839.36 167.5,-12839.36"/>
</g>
<!-- attn_weight_1 -->
<g id="node5" class="node">
<title>attn_weight_1</title>
<polygon fill="#ffe6cc" stroke="black" points="286.5,-12718.1 11.5,-12718.1 11.5,-12665.1 286.5,-12665.1 286.5,-12718.1"/>
<text text-anchor="middle" x="149" y="-12702.9" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="149" y="-12687.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="149" y="-12672.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_1&#45;&gt;attn_weight_1 -->
<g id="edge4" class="edge">
<title>attn_score_1&#45;&gt;attn_weight_1</title>
<path fill="none" stroke="black" d="M150.5,-12776.01C150.5,-12776.01 150.5,-12728.36 150.5,-12728.36"/>
<polygon fill="black" stroke="black" points="154,-12728.36 150.5,-12718.36 147,-12728.36 154,-12728.36"/>
</g>
<!-- attn_context_1 -->
<g id="node6" class="node">
<title>attn_context_1</title>
<polygon fill="#ffe6cc" stroke="black" points="290,-12607.1 0,-12607.1 0,-12554.1 290,-12554.1 290,-12607.1"/>
<text text-anchor="middle" x="145" y="-12591.9" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="145" y="-12576.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="145" y="-12561.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_1&#45;&gt;attn_context_1 -->
<g id="edge5" class="edge">
<title>attn_weight_1&#45;&gt;attn_context_1</title>
<path fill="none" stroke="black" d="M149,-12665.01C149,-12665.01 149,-12617.36 149,-12617.36"/>
<polygon fill="black" stroke="black" points="152.5,-12617.36 149,-12607.36 145.5,-12617.36 152.5,-12617.36"/>
</g>
<!-- attn_out_1 -->
<g id="node7" class="node">
<title>attn_out_1</title>
<polygon fill="#ffe6cc" stroke="black" points="271.5,-12496.1 56.5,-12496.1 56.5,-12443.1 271.5,-12443.1 271.5,-12496.1"/>
<text text-anchor="middle" x="164" y="-12480.9" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="164" y="-12465.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="164" y="-12450.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_1&#45;&gt;attn_out_1 -->
<g id="edge6" class="edge">
<title>attn_context_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M164,-12554.01C164,-12554.01 164,-12506.36 164,-12506.36"/>
<polygon fill="black" stroke="black" points="167.5,-12506.36 164,-12496.36 160.5,-12506.36 167.5,-12506.36"/>
</g>
<!-- attn_out_1&#45;&gt;residual1_1 -->
<g id="edge8" class="edge">
<title>attn_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M204.5,-12443.01C204.5,-12443.01 204.5,-12395.36 204.5,-12395.36"/>
<polygon fill="black" stroke="black" points="208,-12395.36 204.5,-12385.36 201,-12395.36 208,-12395.36"/>
</g>
<!-- ln2_1 -->
<g id="node9" class="node">
<title>ln2_1</title>
<polygon fill="#f8f9f9" stroke="black" points="271.5,-12274.1 56.5,-12274.1 56.5,-12221.1 271.5,-12221.1 271.5,-12274.1"/>
<text text-anchor="middle" x="164" y="-12258.9" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="164" y="-12243.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="164" y="-12228.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge9" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M204.5,-12332.01C204.5,-12332.01 204.5,-12284.36 204.5,-12284.36"/>
<polygon fill="black" stroke="black" points="208,-12284.36 204.5,-12274.36 201,-12284.36 208,-12284.36"/>
</g>
<!-- residual2_1 -->
<g id="node13" class="node">
<title>residual2_1</title>
<polygon fill="#fadbd8" stroke="black" points="385.5,-11830.1 170.5,-11830.1 170.5,-11777.1 385.5,-11777.1 385.5,-11830.1"/>
<text text-anchor="middle" x="278" y="-11814.9" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="278" y="-11799.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="278" y="-11784.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge13" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M313.75,-12331.83C313.75,-12331.83 313.75,-11840.1 313.75,-11840.1"/>
<polygon fill="black" stroke="black" points="317.25,-11840.1 313.75,-11830.1 310.25,-11840.1 317.25,-11840.1"/>
</g>
<!-- ffn_up_1 -->
<g id="node10" class="node">
<title>ffn_up_1</title>
<polygon fill="#d4e6f1" stroke="black" points="275,-12163.1 45,-12163.1 45,-12110.1 275,-12110.1 275,-12163.1"/>
<text text-anchor="middle" x="160" y="-12147.9" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="160" y="-12132.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="160" y="-12117.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_1&#45;&gt;ffn_up_1 -->
<g id="edge10" class="edge">
<title>ln2_1&#45;&gt;ffn_up_1</title>
<path fill="none" stroke="black" d="M164,-12221.01C164,-12221.01 164,-12173.36 164,-12173.36"/>
<polygon fill="black" stroke="black" points="167.5,-12173.36 164,-12163.36 160.5,-12173.36 167.5,-12173.36"/>
</g>
<!-- ffn_act_1 -->
<g id="node11" class="node">
<title>ffn_act_1</title>
<polygon fill="#d4e6f1" stroke="black" points="275,-12052.1 45,-12052.1 45,-11999.1 275,-11999.1 275,-12052.1"/>
<text text-anchor="middle" x="160" y="-12036.9" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="160" y="-12021.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="160" y="-12006.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_1&#45;&gt;ffn_act_1 -->
<g id="edge11" class="edge">
<title>ffn_up_1&#45;&gt;ffn_act_1</title>
<path fill="none" stroke="black" d="M160,-12110.01C160,-12110.01 160,-12062.36 160,-12062.36"/>
<polygon fill="black" stroke="black" points="163.5,-12062.36 160,-12052.36 156.5,-12062.36 163.5,-12062.36"/>
</g>
<!-- ffn_down_1 -->
<g id="node12" class="node">
<title>ffn_down_1</title>
<polygon fill="#d4e6f1" stroke="black" points="271.5,-11941.1 56.5,-11941.1 56.5,-11888.1 271.5,-11888.1 271.5,-11941.1"/>
<text text-anchor="middle" x="164" y="-11925.9" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="164" y="-11910.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="164" y="-11895.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_1&#45;&gt;ffn_down_1 -->
<g id="edge12" class="edge">
<title>ffn_act_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M164,-11999.01C164,-11999.01 164,-11951.36 164,-11951.36"/>
<polygon fill="black" stroke="black" points="167.5,-11951.36 164,-11941.36 160.5,-11951.36 167.5,-11951.36"/>
</g>
<!-- ffn_down_1&#45;&gt;residual2_1 -->
<g id="edge14" class="edge">
<title>ffn_down_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M221,-11888.01C221,-11888.01 221,-11840.36 221,-11840.36"/>
<polygon fill="black" stroke="black" points="224.5,-11840.36 221,-11830.36 217.5,-11840.36 224.5,-11840.36"/>
</g>
<!-- transfer_1 -->
<g id="node14" class="node">
<title>transfer_1</title>
<ellipse fill="#fadbd8" stroke="black" cx="278" cy="-11692.23" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="278" y="-11696.03" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 1</text>
<text text-anchor="middle" x="278" y="-11681.03" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_1&#45;&gt;transfer_1 -->
<g id="edge15" class="edge">
<title>residual2_1&#45;&gt;transfer_1</title>
<path fill="none" stroke="black" d="M278,-11776.93C278,-11776.93 278,-11729.46 278,-11729.46"/>
<polygon fill="black" stroke="black" points="281.5,-11729.46 278,-11719.46 274.5,-11729.46 281.5,-11729.46"/>
</g>
<!-- residual1_2 -->
<g id="node21" class="node">
<title>residual1_2</title>
<polygon fill="#fadbd8" stroke="black" points="533.5,-11607.36 318.5,-11607.36 318.5,-11554.36 533.5,-11554.36 533.5,-11607.36"/>
<text text-anchor="middle" x="426" y="-11592.16" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="426" y="-11577.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="426" y="-11562.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_1&#45;&gt;residual1_2 -->
<g id="edge21" class="edge">
<title>transfer_1&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M374.26,-11671.28C374.26,-11671.28 374.26,-11617.63 374.26,-11617.63"/>
<polygon fill="black" stroke="black" points="377.76,-11617.63 374.26,-11607.63 370.76,-11617.63 377.76,-11617.63"/>
</g>
<!-- ln1_2 -->
<g id="node15" class="node">
<title>ln1_2</title>
<polygon fill="#f8f9f9" stroke="black" points="681.5,-12274.1 466.5,-12274.1 466.5,-12221.1 681.5,-12221.1 681.5,-12274.1"/>
<text text-anchor="middle" x="574" y="-12258.9" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="574" y="-12243.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="574" y="-12228.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_2 -->
<g id="node16" class="node">
<title>attn_qkv_2</title>
<polygon fill="#ffe6cc" stroke="black" points="689,-12163.1 459,-12163.1 459,-12110.1 689,-12110.1 689,-12163.1"/>
<text text-anchor="middle" x="574" y="-12147.9" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="574" y="-12132.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="574" y="-12117.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_2&#45;&gt;attn_qkv_2 -->
<g id="edge16" class="edge">
<title>ln1_2&#45;&gt;attn_qkv_2</title>
<path fill="none" stroke="black" d="M574,-12221.01C574,-12221.01 574,-12173.36 574,-12173.36"/>
<polygon fill="black" stroke="black" points="577.5,-12173.36 574,-12163.36 570.5,-12173.36 577.5,-12173.36"/>
</g>
<!-- attn_score_2 -->
<g id="node17" class="node">
<title>attn_score_2</title>
<polygon fill="#ffe6cc" stroke="black" points="711.5,-12052.1 436.5,-12052.1 436.5,-11999.1 711.5,-11999.1 711.5,-12052.1"/>
<text text-anchor="middle" x="574" y="-12036.9" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="574" y="-12021.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="574" y="-12006.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_2&#45;&gt;attn_score_2 -->
<g id="edge17" class="edge">
<title>attn_qkv_2&#45;&gt;attn_score_2</title>
<path fill="none" stroke="black" d="M574,-12110.01C574,-12110.01 574,-12062.36 574,-12062.36"/>
<polygon fill="black" stroke="black" points="577.5,-12062.36 574,-12052.36 570.5,-12062.36 577.5,-12062.36"/>
</g>
<!-- attn_weight_2 -->
<g id="node18" class="node">
<title>attn_weight_2</title>
<polygon fill="#ffe6cc" stroke="black" points="711.5,-11941.1 436.5,-11941.1 436.5,-11888.1 711.5,-11888.1 711.5,-11941.1"/>
<text text-anchor="middle" x="574" y="-11925.9" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="574" y="-11910.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="574" y="-11895.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_2&#45;&gt;attn_weight_2 -->
<g id="edge18" class="edge">
<title>attn_score_2&#45;&gt;attn_weight_2</title>
<path fill="none" stroke="black" d="M574,-11999.01C574,-11999.01 574,-11951.36 574,-11951.36"/>
<polygon fill="black" stroke="black" points="577.5,-11951.36 574,-11941.36 570.5,-11951.36 577.5,-11951.36"/>
</g>
<!-- attn_context_2 -->
<g id="node19" class="node">
<title>attn_context_2</title>
<polygon fill="#ffe6cc" stroke="black" points="719,-11830.1 429,-11830.1 429,-11777.1 719,-11777.1 719,-11830.1"/>
<text text-anchor="middle" x="574" y="-11814.9" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="574" y="-11799.9" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="574" y="-11784.9" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_2&#45;&gt;attn_context_2 -->
<g id="edge19" class="edge">
<title>attn_weight_2&#45;&gt;attn_context_2</title>
<path fill="none" stroke="black" d="M574,-11888.01C574,-11888.01 574,-11840.36 574,-11840.36"/>
<polygon fill="black" stroke="black" points="577.5,-11840.36 574,-11830.36 570.5,-11840.36 577.5,-11840.36"/>
</g>
<!-- attn_out_2 -->
<g id="node20" class="node">
<title>attn_out_2</title>
<polygon fill="#ffe6cc" stroke="black" points="681.5,-11718.73 466.5,-11718.73 466.5,-11665.73 681.5,-11665.73 681.5,-11718.73"/>
<text text-anchor="middle" x="574" y="-11703.53" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="574" y="-11688.53" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="574" y="-11673.53" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_2&#45;&gt;attn_out_2 -->
<g id="edge20" class="edge">
<title>attn_context_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M574,-11776.93C574,-11776.93 574,-11729.08 574,-11729.08"/>
<polygon fill="black" stroke="black" points="577.5,-11729.08 574,-11719.08 570.5,-11729.08 577.5,-11729.08"/>
</g>
<!-- attn_out_2&#45;&gt;residual1_2 -->
<g id="edge22" class="edge">
<title>attn_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M500,-11665.56C500,-11665.56 500,-11617.71 500,-11617.71"/>
<polygon fill="black" stroke="black" points="503.5,-11617.71 500,-11607.71 496.5,-11617.71 503.5,-11617.71"/>
</g>
<!-- ln2_2 -->
<g id="node22" class="node">
<title>ln2_2</title>
<polygon fill="#f8f9f9" stroke="black" points="448.5,-11496.36 233.5,-11496.36 233.5,-11443.36 448.5,-11443.36 448.5,-11496.36"/>
<text text-anchor="middle" x="341" y="-11481.16" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="341" y="-11466.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="341" y="-11451.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge23" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M383.5,-11554.27C383.5,-11554.27 383.5,-11506.62 383.5,-11506.62"/>
<polygon fill="black" stroke="black" points="387,-11506.62 383.5,-11496.62 380,-11506.62 387,-11506.62"/>
</g>
<!-- residual2_2 -->
<g id="node26" class="node">
<title>residual2_2</title>
<polygon fill="#fadbd8" stroke="black" points="563.5,-11052.36 348.5,-11052.36 348.5,-10999.36 563.5,-10999.36 563.5,-11052.36"/>
<text text-anchor="middle" x="456" y="-11037.16" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="456" y="-11022.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="456" y="-11007.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge27" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M493.25,-11554.09C493.25,-11554.09 493.25,-11062.36 493.25,-11062.36"/>
<polygon fill="black" stroke="black" points="496.75,-11062.36 493.25,-11052.36 489.75,-11062.36 496.75,-11062.36"/>
</g>
<!-- ffn_up_2 -->
<g id="node23" class="node">
<title>ffn_up_2</title>
<polygon fill="#d4e6f1" stroke="black" points="453,-11385.36 223,-11385.36 223,-11332.36 453,-11332.36 453,-11385.36"/>
<text text-anchor="middle" x="338" y="-11370.16" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="338" y="-11355.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="338" y="-11340.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_2&#45;&gt;ffn_up_2 -->
<g id="edge24" class="edge">
<title>ln2_2&#45;&gt;ffn_up_2</title>
<path fill="none" stroke="black" d="M341,-11443.27C341,-11443.27 341,-11395.62 341,-11395.62"/>
<polygon fill="black" stroke="black" points="344.5,-11395.62 341,-11385.62 337.5,-11395.62 344.5,-11395.62"/>
</g>
<!-- ffn_act_2 -->
<g id="node24" class="node">
<title>ffn_act_2</title>
<polygon fill="#d4e6f1" stroke="black" points="453,-11274.36 223,-11274.36 223,-11221.36 453,-11221.36 453,-11274.36"/>
<text text-anchor="middle" x="338" y="-11259.16" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="338" y="-11244.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="338" y="-11229.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_2&#45;&gt;ffn_act_2 -->
<g id="edge25" class="edge">
<title>ffn_up_2&#45;&gt;ffn_act_2</title>
<path fill="none" stroke="black" d="M338,-11332.27C338,-11332.27 338,-11284.62 338,-11284.62"/>
<polygon fill="black" stroke="black" points="341.5,-11284.62 338,-11274.62 334.5,-11284.62 341.5,-11284.62"/>
</g>
<!-- ffn_down_2 -->
<g id="node25" class="node">
<title>ffn_down_2</title>
<polygon fill="#d4e6f1" stroke="black" points="449.5,-11163.36 234.5,-11163.36 234.5,-11110.36 449.5,-11110.36 449.5,-11163.36"/>
<text text-anchor="middle" x="342" y="-11148.16" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="342" y="-11133.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="342" y="-11118.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_2&#45;&gt;ffn_down_2 -->
<g id="edge26" class="edge">
<title>ffn_act_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M342,-11221.27C342,-11221.27 342,-11173.62 342,-11173.62"/>
<polygon fill="black" stroke="black" points="345.5,-11173.62 342,-11163.62 338.5,-11173.62 345.5,-11173.62"/>
</g>
<!-- ffn_down_2&#45;&gt;residual2_2 -->
<g id="edge28" class="edge">
<title>ffn_down_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M399,-11110.27C399,-11110.27 399,-11062.62 399,-11062.62"/>
<polygon fill="black" stroke="black" points="402.5,-11062.62 399,-11052.62 395.5,-11062.62 402.5,-11062.62"/>
</g>
<!-- transfer_2 -->
<g id="node27" class="node">
<title>transfer_2</title>
<ellipse fill="#fadbd8" stroke="black" cx="456" cy="-10914.49" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="456" y="-10918.29" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 2</text>
<text text-anchor="middle" x="456" y="-10903.29" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_2&#45;&gt;transfer_2 -->
<g id="edge29" class="edge">
<title>residual2_2&#45;&gt;transfer_2</title>
<path fill="none" stroke="black" d="M456,-10999.19C456,-10999.19 456,-10951.72 456,-10951.72"/>
<polygon fill="black" stroke="black" points="459.5,-10951.72 456,-10941.72 452.5,-10951.72 459.5,-10951.72"/>
</g>
<!-- residual1_3 -->
<g id="node34" class="node">
<title>residual1_3</title>
<polygon fill="#fadbd8" stroke="black" points="711.5,-10829.62 496.5,-10829.62 496.5,-10776.62 711.5,-10776.62 711.5,-10829.62"/>
<text text-anchor="middle" x="604" y="-10814.42" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="604" y="-10799.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="604" y="-10784.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_2&#45;&gt;residual1_3 -->
<g id="edge35" class="edge">
<title>transfer_2&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M552.26,-10893.54C552.26,-10893.54 552.26,-10839.89 552.26,-10839.89"/>
<polygon fill="black" stroke="black" points="555.76,-10839.89 552.26,-10829.89 548.76,-10839.89 555.76,-10839.89"/>
</g>
<!-- ln1_3 -->
<g id="node28" class="node">
<title>ln1_3</title>
<polygon fill="#f8f9f9" stroke="black" points="859.5,-11496.36 644.5,-11496.36 644.5,-11443.36 859.5,-11443.36 859.5,-11496.36"/>
<text text-anchor="middle" x="752" y="-11481.16" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="752" y="-11466.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="752" y="-11451.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_3 -->
<g id="node29" class="node">
<title>attn_qkv_3</title>
<polygon fill="#ffe6cc" stroke="black" points="867,-11385.36 637,-11385.36 637,-11332.36 867,-11332.36 867,-11385.36"/>
<text text-anchor="middle" x="752" y="-11370.16" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="752" y="-11355.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="752" y="-11340.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_3&#45;&gt;attn_qkv_3 -->
<g id="edge30" class="edge">
<title>ln1_3&#45;&gt;attn_qkv_3</title>
<path fill="none" stroke="black" d="M752,-11443.27C752,-11443.27 752,-11395.62 752,-11395.62"/>
<polygon fill="black" stroke="black" points="755.5,-11395.62 752,-11385.62 748.5,-11395.62 755.5,-11395.62"/>
</g>
<!-- attn_score_3 -->
<g id="node30" class="node">
<title>attn_score_3</title>
<polygon fill="#ffe6cc" stroke="black" points="889.5,-11274.36 614.5,-11274.36 614.5,-11221.36 889.5,-11221.36 889.5,-11274.36"/>
<text text-anchor="middle" x="752" y="-11259.16" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="752" y="-11244.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="752" y="-11229.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_3&#45;&gt;attn_score_3 -->
<g id="edge31" class="edge">
<title>attn_qkv_3&#45;&gt;attn_score_3</title>
<path fill="none" stroke="black" d="M752,-11332.27C752,-11332.27 752,-11284.62 752,-11284.62"/>
<polygon fill="black" stroke="black" points="755.5,-11284.62 752,-11274.62 748.5,-11284.62 755.5,-11284.62"/>
</g>
<!-- attn_weight_3 -->
<g id="node31" class="node">
<title>attn_weight_3</title>
<polygon fill="#ffe6cc" stroke="black" points="889.5,-11163.36 614.5,-11163.36 614.5,-11110.36 889.5,-11110.36 889.5,-11163.36"/>
<text text-anchor="middle" x="752" y="-11148.16" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="752" y="-11133.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="752" y="-11118.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_3&#45;&gt;attn_weight_3 -->
<g id="edge32" class="edge">
<title>attn_score_3&#45;&gt;attn_weight_3</title>
<path fill="none" stroke="black" d="M752,-11221.27C752,-11221.27 752,-11173.62 752,-11173.62"/>
<polygon fill="black" stroke="black" points="755.5,-11173.62 752,-11163.62 748.5,-11173.62 755.5,-11173.62"/>
</g>
<!-- attn_context_3 -->
<g id="node32" class="node">
<title>attn_context_3</title>
<polygon fill="#ffe6cc" stroke="black" points="897,-11052.36 607,-11052.36 607,-10999.36 897,-10999.36 897,-11052.36"/>
<text text-anchor="middle" x="752" y="-11037.16" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="752" y="-11022.16" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="752" y="-11007.16" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_3&#45;&gt;attn_context_3 -->
<g id="edge33" class="edge">
<title>attn_weight_3&#45;&gt;attn_context_3</title>
<path fill="none" stroke="black" d="M752,-11110.27C752,-11110.27 752,-11062.62 752,-11062.62"/>
<polygon fill="black" stroke="black" points="755.5,-11062.62 752,-11052.62 748.5,-11062.62 755.5,-11062.62"/>
</g>
<!-- attn_out_3 -->
<g id="node33" class="node">
<title>attn_out_3</title>
<polygon fill="#ffe6cc" stroke="black" points="859.5,-10940.99 644.5,-10940.99 644.5,-10887.99 859.5,-10887.99 859.5,-10940.99"/>
<text text-anchor="middle" x="752" y="-10925.79" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="752" y="-10910.79" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="752" y="-10895.79" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_3&#45;&gt;attn_out_3 -->
<g id="edge34" class="edge">
<title>attn_context_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M752,-10999.19C752,-10999.19 752,-10951.34 752,-10951.34"/>
<polygon fill="black" stroke="black" points="755.5,-10951.34 752,-10941.34 748.5,-10951.34 755.5,-10951.34"/>
</g>
<!-- attn_out_3&#45;&gt;residual1_3 -->
<g id="edge36" class="edge">
<title>attn_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M678,-10887.82C678,-10887.82 678,-10839.97 678,-10839.97"/>
<polygon fill="black" stroke="black" points="681.5,-10839.97 678,-10829.97 674.5,-10839.97 681.5,-10839.97"/>
</g>
<!-- ln2_3 -->
<g id="node35" class="node">
<title>ln2_3</title>
<polygon fill="#f8f9f9" stroke="black" points="626.5,-10718.62 411.5,-10718.62 411.5,-10665.62 626.5,-10665.62 626.5,-10718.62"/>
<text text-anchor="middle" x="519" y="-10703.42" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="519" y="-10688.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="519" y="-10673.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge37" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M561.5,-10776.53C561.5,-10776.53 561.5,-10728.88 561.5,-10728.88"/>
<polygon fill="black" stroke="black" points="565,-10728.88 561.5,-10718.88 558,-10728.88 565,-10728.88"/>
</g>
<!-- residual2_3 -->
<g id="node39" class="node">
<title>residual2_3</title>
<polygon fill="#fadbd8" stroke="black" points="741.5,-10274.62 526.5,-10274.62 526.5,-10221.62 741.5,-10221.62 741.5,-10274.62"/>
<text text-anchor="middle" x="634" y="-10259.42" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="634" y="-10244.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="634" y="-10229.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge41" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M671.25,-10776.35C671.25,-10776.35 671.25,-10284.62 671.25,-10284.62"/>
<polygon fill="black" stroke="black" points="674.75,-10284.62 671.25,-10274.62 667.75,-10284.62 674.75,-10284.62"/>
</g>
<!-- ffn_up_3 -->
<g id="node36" class="node">
<title>ffn_up_3</title>
<polygon fill="#d4e6f1" stroke="black" points="631,-10607.62 401,-10607.62 401,-10554.62 631,-10554.62 631,-10607.62"/>
<text text-anchor="middle" x="516" y="-10592.42" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="516" y="-10577.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="516" y="-10562.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_3&#45;&gt;ffn_up_3 -->
<g id="edge38" class="edge">
<title>ln2_3&#45;&gt;ffn_up_3</title>
<path fill="none" stroke="black" d="M519,-10665.53C519,-10665.53 519,-10617.88 519,-10617.88"/>
<polygon fill="black" stroke="black" points="522.5,-10617.88 519,-10607.88 515.5,-10617.88 522.5,-10617.88"/>
</g>
<!-- ffn_act_3 -->
<g id="node37" class="node">
<title>ffn_act_3</title>
<polygon fill="#d4e6f1" stroke="black" points="631,-10496.62 401,-10496.62 401,-10443.62 631,-10443.62 631,-10496.62"/>
<text text-anchor="middle" x="516" y="-10481.42" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="516" y="-10466.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="516" y="-10451.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_3&#45;&gt;ffn_act_3 -->
<g id="edge39" class="edge">
<title>ffn_up_3&#45;&gt;ffn_act_3</title>
<path fill="none" stroke="black" d="M516,-10554.53C516,-10554.53 516,-10506.88 516,-10506.88"/>
<polygon fill="black" stroke="black" points="519.5,-10506.88 516,-10496.88 512.5,-10506.88 519.5,-10506.88"/>
</g>
<!-- ffn_down_3 -->
<g id="node38" class="node">
<title>ffn_down_3</title>
<polygon fill="#d4e6f1" stroke="black" points="627.5,-10385.62 412.5,-10385.62 412.5,-10332.62 627.5,-10332.62 627.5,-10385.62"/>
<text text-anchor="middle" x="520" y="-10370.42" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="520" y="-10355.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="520" y="-10340.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_3&#45;&gt;ffn_down_3 -->
<g id="edge40" class="edge">
<title>ffn_act_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M520,-10443.53C520,-10443.53 520,-10395.88 520,-10395.88"/>
<polygon fill="black" stroke="black" points="523.5,-10395.88 520,-10385.88 516.5,-10395.88 523.5,-10395.88"/>
</g>
<!-- ffn_down_3&#45;&gt;residual2_3 -->
<g id="edge42" class="edge">
<title>ffn_down_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M577,-10332.53C577,-10332.53 577,-10284.88 577,-10284.88"/>
<polygon fill="black" stroke="black" points="580.5,-10284.88 577,-10274.88 573.5,-10284.88 580.5,-10284.88"/>
</g>
<!-- transfer_3 -->
<g id="node40" class="node">
<title>transfer_3</title>
<ellipse fill="#fadbd8" stroke="black" cx="634" cy="-10136.75" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="634" y="-10140.55" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 3</text>
<text text-anchor="middle" x="634" y="-10125.55" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_3&#45;&gt;transfer_3 -->
<g id="edge43" class="edge">
<title>residual2_3&#45;&gt;transfer_3</title>
<path fill="none" stroke="black" d="M634,-10221.45C634,-10221.45 634,-10173.98 634,-10173.98"/>
<polygon fill="black" stroke="black" points="637.5,-10173.98 634,-10163.98 630.5,-10173.98 637.5,-10173.98"/>
</g>
<!-- residual1_4 -->
<g id="node47" class="node">
<title>residual1_4</title>
<polygon fill="#fadbd8" stroke="black" points="889.5,-10051.88 674.5,-10051.88 674.5,-9998.88 889.5,-9998.88 889.5,-10051.88"/>
<text text-anchor="middle" x="782" y="-10036.68" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="782" y="-10021.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="782" y="-10006.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_3&#45;&gt;residual1_4 -->
<g id="edge49" class="edge">
<title>transfer_3&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M730.26,-10115.8C730.26,-10115.8 730.26,-10062.15 730.26,-10062.15"/>
<polygon fill="black" stroke="black" points="733.76,-10062.15 730.26,-10052.15 726.76,-10062.15 733.76,-10062.15"/>
</g>
<!-- ln1_4 -->
<g id="node41" class="node">
<title>ln1_4</title>
<polygon fill="#f8f9f9" stroke="black" points="1037.5,-10718.62 822.5,-10718.62 822.5,-10665.62 1037.5,-10665.62 1037.5,-10718.62"/>
<text text-anchor="middle" x="930" y="-10703.42" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="930" y="-10688.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="930" y="-10673.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_4 -->
<g id="node42" class="node">
<title>attn_qkv_4</title>
<polygon fill="#ffe6cc" stroke="black" points="1045,-10607.62 815,-10607.62 815,-10554.62 1045,-10554.62 1045,-10607.62"/>
<text text-anchor="middle" x="930" y="-10592.42" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="930" y="-10577.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="930" y="-10562.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_4&#45;&gt;attn_qkv_4 -->
<g id="edge44" class="edge">
<title>ln1_4&#45;&gt;attn_qkv_4</title>
<path fill="none" stroke="black" d="M930,-10665.53C930,-10665.53 930,-10617.88 930,-10617.88"/>
<polygon fill="black" stroke="black" points="933.5,-10617.88 930,-10607.88 926.5,-10617.88 933.5,-10617.88"/>
</g>
<!-- attn_score_4 -->
<g id="node43" class="node">
<title>attn_score_4</title>
<polygon fill="#ffe6cc" stroke="black" points="1067.5,-10496.62 792.5,-10496.62 792.5,-10443.62 1067.5,-10443.62 1067.5,-10496.62"/>
<text text-anchor="middle" x="930" y="-10481.42" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="930" y="-10466.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="930" y="-10451.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_4&#45;&gt;attn_score_4 -->
<g id="edge45" class="edge">
<title>attn_qkv_4&#45;&gt;attn_score_4</title>
<path fill="none" stroke="black" d="M930,-10554.53C930,-10554.53 930,-10506.88 930,-10506.88"/>
<polygon fill="black" stroke="black" points="933.5,-10506.88 930,-10496.88 926.5,-10506.88 933.5,-10506.88"/>
</g>
<!-- attn_weight_4 -->
<g id="node44" class="node">
<title>attn_weight_4</title>
<polygon fill="#ffe6cc" stroke="black" points="1067.5,-10385.62 792.5,-10385.62 792.5,-10332.62 1067.5,-10332.62 1067.5,-10385.62"/>
<text text-anchor="middle" x="930" y="-10370.42" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="930" y="-10355.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="930" y="-10340.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_4&#45;&gt;attn_weight_4 -->
<g id="edge46" class="edge">
<title>attn_score_4&#45;&gt;attn_weight_4</title>
<path fill="none" stroke="black" d="M930,-10443.53C930,-10443.53 930,-10395.88 930,-10395.88"/>
<polygon fill="black" stroke="black" points="933.5,-10395.88 930,-10385.88 926.5,-10395.88 933.5,-10395.88"/>
</g>
<!-- attn_context_4 -->
<g id="node45" class="node">
<title>attn_context_4</title>
<polygon fill="#ffe6cc" stroke="black" points="1075,-10274.62 785,-10274.62 785,-10221.62 1075,-10221.62 1075,-10274.62"/>
<text text-anchor="middle" x="930" y="-10259.42" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="930" y="-10244.42" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="930" y="-10229.42" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_4&#45;&gt;attn_context_4 -->
<g id="edge47" class="edge">
<title>attn_weight_4&#45;&gt;attn_context_4</title>
<path fill="none" stroke="black" d="M930,-10332.53C930,-10332.53 930,-10284.88 930,-10284.88"/>
<polygon fill="black" stroke="black" points="933.5,-10284.88 930,-10274.88 926.5,-10284.88 933.5,-10284.88"/>
</g>
<!-- attn_out_4 -->
<g id="node46" class="node">
<title>attn_out_4</title>
<polygon fill="#ffe6cc" stroke="black" points="1037.5,-10163.25 822.5,-10163.25 822.5,-10110.25 1037.5,-10110.25 1037.5,-10163.25"/>
<text text-anchor="middle" x="930" y="-10148.05" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="930" y="-10133.05" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="930" y="-10118.05" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_4&#45;&gt;attn_out_4 -->
<g id="edge48" class="edge">
<title>attn_context_4&#45;&gt;attn_out_4</title>
<path fill="none" stroke="black" d="M930,-10221.45C930,-10221.45 930,-10173.6 930,-10173.6"/>
<polygon fill="black" stroke="black" points="933.5,-10173.6 930,-10163.6 926.5,-10173.6 933.5,-10173.6"/>
</g>
<!-- attn_out_4&#45;&gt;residual1_4 -->
<g id="edge50" class="edge">
<title>attn_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M856,-10110.08C856,-10110.08 856,-10062.23 856,-10062.23"/>
<polygon fill="black" stroke="black" points="859.5,-10062.23 856,-10052.23 852.5,-10062.23 859.5,-10062.23"/>
</g>
<!-- ln2_4 -->
<g id="node48" class="node">
<title>ln2_4</title>
<polygon fill="#f8f9f9" stroke="black" points="804.5,-9940.88 589.5,-9940.88 589.5,-9887.88 804.5,-9887.88 804.5,-9940.88"/>
<text text-anchor="middle" x="697" y="-9925.68" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="697" y="-9910.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="697" y="-9895.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge51" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M739.5,-9998.79C739.5,-9998.79 739.5,-9951.14 739.5,-9951.14"/>
<polygon fill="black" stroke="black" points="743,-9951.14 739.5,-9941.14 736,-9951.14 743,-9951.14"/>
</g>
<!-- residual2_4 -->
<g id="node52" class="node">
<title>residual2_4</title>
<polygon fill="#fadbd8" stroke="black" points="919.5,-9496.88 704.5,-9496.88 704.5,-9443.88 919.5,-9443.88 919.5,-9496.88"/>
<text text-anchor="middle" x="812" y="-9481.68" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="812" y="-9466.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="812" y="-9451.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_4&#45;&gt;residual2_4 -->
<g id="edge55" class="edge">
<title>residual1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M849.25,-9998.61C849.25,-9998.61 849.25,-9506.88 849.25,-9506.88"/>
<polygon fill="black" stroke="black" points="852.75,-9506.88 849.25,-9496.88 845.75,-9506.88 852.75,-9506.88"/>
</g>
<!-- ffn_up_4 -->
<g id="node49" class="node">
<title>ffn_up_4</title>
<polygon fill="#d4e6f1" stroke="black" points="809,-9829.88 579,-9829.88 579,-9776.88 809,-9776.88 809,-9829.88"/>
<text text-anchor="middle" x="694" y="-9814.68" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="694" y="-9799.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="694" y="-9784.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_4&#45;&gt;ffn_up_4 -->
<g id="edge52" class="edge">
<title>ln2_4&#45;&gt;ffn_up_4</title>
<path fill="none" stroke="black" d="M697,-9887.79C697,-9887.79 697,-9840.14 697,-9840.14"/>
<polygon fill="black" stroke="black" points="700.5,-9840.14 697,-9830.14 693.5,-9840.14 700.5,-9840.14"/>
</g>
<!-- ffn_act_4 -->
<g id="node50" class="node">
<title>ffn_act_4</title>
<polygon fill="#d4e6f1" stroke="black" points="809,-9718.88 579,-9718.88 579,-9665.88 809,-9665.88 809,-9718.88"/>
<text text-anchor="middle" x="694" y="-9703.68" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="694" y="-9688.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="694" y="-9673.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_4&#45;&gt;ffn_act_4 -->
<g id="edge53" class="edge">
<title>ffn_up_4&#45;&gt;ffn_act_4</title>
<path fill="none" stroke="black" d="M694,-9776.79C694,-9776.79 694,-9729.14 694,-9729.14"/>
<polygon fill="black" stroke="black" points="697.5,-9729.14 694,-9719.14 690.5,-9729.14 697.5,-9729.14"/>
</g>
<!-- ffn_down_4 -->
<g id="node51" class="node">
<title>ffn_down_4</title>
<polygon fill="#d4e6f1" stroke="black" points="805.5,-9607.88 590.5,-9607.88 590.5,-9554.88 805.5,-9554.88 805.5,-9607.88"/>
<text text-anchor="middle" x="698" y="-9592.68" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="698" y="-9577.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="698" y="-9562.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_4&#45;&gt;ffn_down_4 -->
<g id="edge54" class="edge">
<title>ffn_act_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M698,-9665.79C698,-9665.79 698,-9618.14 698,-9618.14"/>
<polygon fill="black" stroke="black" points="701.5,-9618.14 698,-9608.14 694.5,-9618.14 701.5,-9618.14"/>
</g>
<!-- ffn_down_4&#45;&gt;residual2_4 -->
<g id="edge56" class="edge">
<title>ffn_down_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M755,-9554.79C755,-9554.79 755,-9507.14 755,-9507.14"/>
<polygon fill="black" stroke="black" points="758.5,-9507.14 755,-9497.14 751.5,-9507.14 758.5,-9507.14"/>
</g>
<!-- transfer_4 -->
<g id="node53" class="node">
<title>transfer_4</title>
<ellipse fill="#fadbd8" stroke="black" cx="812" cy="-9359.01" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="812" y="-9362.81" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 4</text>
<text text-anchor="middle" x="812" y="-9347.81" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_4&#45;&gt;transfer_4 -->
<g id="edge57" class="edge">
<title>residual2_4&#45;&gt;transfer_4</title>
<path fill="none" stroke="black" d="M812,-9443.71C812,-9443.71 812,-9396.24 812,-9396.24"/>
<polygon fill="black" stroke="black" points="815.5,-9396.24 812,-9386.24 808.5,-9396.24 815.5,-9396.24"/>
</g>
<!-- residual1_5 -->
<g id="node60" class="node">
<title>residual1_5</title>
<polygon fill="#fadbd8" stroke="black" points="1067.5,-9274.14 852.5,-9274.14 852.5,-9221.14 1067.5,-9221.14 1067.5,-9274.14"/>
<text text-anchor="middle" x="960" y="-9258.94" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="960" y="-9243.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="960" y="-9228.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_4&#45;&gt;residual1_5 -->
<g id="edge63" class="edge">
<title>transfer_4&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M908.26,-9338.06C908.26,-9338.06 908.26,-9284.41 908.26,-9284.41"/>
<polygon fill="black" stroke="black" points="911.76,-9284.41 908.26,-9274.41 904.76,-9284.41 911.76,-9284.41"/>
</g>
<!-- ln1_5 -->
<g id="node54" class="node">
<title>ln1_5</title>
<polygon fill="#f8f9f9" stroke="black" points="1215.5,-9940.88 1000.5,-9940.88 1000.5,-9887.88 1215.5,-9887.88 1215.5,-9940.88"/>
<text text-anchor="middle" x="1108" y="-9925.68" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="1108" y="-9910.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1108" y="-9895.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_5 -->
<g id="node55" class="node">
<title>attn_qkv_5</title>
<polygon fill="#ffe6cc" stroke="black" points="1223,-9829.88 993,-9829.88 993,-9776.88 1223,-9776.88 1223,-9829.88"/>
<text text-anchor="middle" x="1108" y="-9814.68" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1108" y="-9799.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1108" y="-9784.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_5&#45;&gt;attn_qkv_5 -->
<g id="edge58" class="edge">
<title>ln1_5&#45;&gt;attn_qkv_5</title>
<path fill="none" stroke="black" d="M1108,-9887.79C1108,-9887.79 1108,-9840.14 1108,-9840.14"/>
<polygon fill="black" stroke="black" points="1111.5,-9840.14 1108,-9830.14 1104.5,-9840.14 1111.5,-9840.14"/>
</g>
<!-- attn_score_5 -->
<g id="node56" class="node">
<title>attn_score_5</title>
<polygon fill="#ffe6cc" stroke="black" points="1245.5,-9718.88 970.5,-9718.88 970.5,-9665.88 1245.5,-9665.88 1245.5,-9718.88"/>
<text text-anchor="middle" x="1108" y="-9703.68" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1108" y="-9688.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1108" y="-9673.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_5&#45;&gt;attn_score_5 -->
<g id="edge59" class="edge">
<title>attn_qkv_5&#45;&gt;attn_score_5</title>
<path fill="none" stroke="black" d="M1108,-9776.79C1108,-9776.79 1108,-9729.14 1108,-9729.14"/>
<polygon fill="black" stroke="black" points="1111.5,-9729.14 1108,-9719.14 1104.5,-9729.14 1111.5,-9729.14"/>
</g>
<!-- attn_weight_5 -->
<g id="node57" class="node">
<title>attn_weight_5</title>
<polygon fill="#ffe6cc" stroke="black" points="1245.5,-9607.88 970.5,-9607.88 970.5,-9554.88 1245.5,-9554.88 1245.5,-9607.88"/>
<text text-anchor="middle" x="1108" y="-9592.68" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1108" y="-9577.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1108" y="-9562.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_5&#45;&gt;attn_weight_5 -->
<g id="edge60" class="edge">
<title>attn_score_5&#45;&gt;attn_weight_5</title>
<path fill="none" stroke="black" d="M1108,-9665.79C1108,-9665.79 1108,-9618.14 1108,-9618.14"/>
<polygon fill="black" stroke="black" points="1111.5,-9618.14 1108,-9608.14 1104.5,-9618.14 1111.5,-9618.14"/>
</g>
<!-- attn_context_5 -->
<g id="node58" class="node">
<title>attn_context_5</title>
<polygon fill="#ffe6cc" stroke="black" points="1253,-9496.88 963,-9496.88 963,-9443.88 1253,-9443.88 1253,-9496.88"/>
<text text-anchor="middle" x="1108" y="-9481.68" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="1108" y="-9466.68" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1108" y="-9451.68" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_5&#45;&gt;attn_context_5 -->
<g id="edge61" class="edge">
<title>attn_weight_5&#45;&gt;attn_context_5</title>
<path fill="none" stroke="black" d="M1108,-9554.79C1108,-9554.79 1108,-9507.14 1108,-9507.14"/>
<polygon fill="black" stroke="black" points="1111.5,-9507.14 1108,-9497.14 1104.5,-9507.14 1111.5,-9507.14"/>
</g>
<!-- attn_out_5 -->
<g id="node59" class="node">
<title>attn_out_5</title>
<polygon fill="#ffe6cc" stroke="black" points="1215.5,-9385.51 1000.5,-9385.51 1000.5,-9332.51 1215.5,-9332.51 1215.5,-9385.51"/>
<text text-anchor="middle" x="1108" y="-9370.31" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1108" y="-9355.31" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="1108" y="-9340.31" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_5&#45;&gt;attn_out_5 -->
<g id="edge62" class="edge">
<title>attn_context_5&#45;&gt;attn_out_5</title>
<path fill="none" stroke="black" d="M1108,-9443.71C1108,-9443.71 1108,-9395.86 1108,-9395.86"/>
<polygon fill="black" stroke="black" points="1111.5,-9395.86 1108,-9385.86 1104.5,-9395.86 1111.5,-9395.86"/>
</g>
<!-- attn_out_5&#45;&gt;residual1_5 -->
<g id="edge64" class="edge">
<title>attn_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M1034,-9332.34C1034,-9332.34 1034,-9284.49 1034,-9284.49"/>
<polygon fill="black" stroke="black" points="1037.5,-9284.49 1034,-9274.49 1030.5,-9284.49 1037.5,-9284.49"/>
</g>
<!-- ln2_5 -->
<g id="node61" class="node">
<title>ln2_5</title>
<polygon fill="#f8f9f9" stroke="black" points="986.5,-9163.14 771.5,-9163.14 771.5,-9110.14 986.5,-9110.14 986.5,-9163.14"/>
<text text-anchor="middle" x="879" y="-9147.94" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="879" y="-9132.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="879" y="-9117.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge65" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M919.5,-9221.05C919.5,-9221.05 919.5,-9173.4 919.5,-9173.4"/>
<polygon fill="black" stroke="black" points="923,-9173.4 919.5,-9163.4 916,-9173.4 923,-9173.4"/>
</g>
<!-- residual2_5 -->
<g id="node65" class="node">
<title>residual2_5</title>
<polygon fill="#fadbd8" stroke="black" points="1100.5,-8719.14 885.5,-8719.14 885.5,-8666.14 1100.5,-8666.14 1100.5,-8719.14"/>
<text text-anchor="middle" x="993" y="-8703.94" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="993" y="-8688.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="993" y="-8673.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_5&#45;&gt;residual2_5 -->
<g id="edge69" class="edge">
<title>residual1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M1028.75,-9220.87C1028.75,-9220.87 1028.75,-8729.14 1028.75,-8729.14"/>
<polygon fill="black" stroke="black" points="1032.25,-8729.14 1028.75,-8719.14 1025.25,-8729.14 1032.25,-8729.14"/>
</g>
<!-- ffn_up_5 -->
<g id="node62" class="node">
<title>ffn_up_5</title>
<polygon fill="#d4e6f1" stroke="black" points="990,-9052.14 760,-9052.14 760,-8999.14 990,-8999.14 990,-9052.14"/>
<text text-anchor="middle" x="875" y="-9036.94" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="875" y="-9021.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="875" y="-9006.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_5&#45;&gt;ffn_up_5 -->
<g id="edge66" class="edge">
<title>ln2_5&#45;&gt;ffn_up_5</title>
<path fill="none" stroke="black" d="M879,-9110.05C879,-9110.05 879,-9062.4 879,-9062.4"/>
<polygon fill="black" stroke="black" points="882.5,-9062.4 879,-9052.4 875.5,-9062.4 882.5,-9062.4"/>
</g>
<!-- ffn_act_5 -->
<g id="node63" class="node">
<title>ffn_act_5</title>
<polygon fill="#d4e6f1" stroke="black" points="990,-8941.14 760,-8941.14 760,-8888.14 990,-8888.14 990,-8941.14"/>
<text text-anchor="middle" x="875" y="-8925.94" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="875" y="-8910.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="875" y="-8895.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_5&#45;&gt;ffn_act_5 -->
<g id="edge67" class="edge">
<title>ffn_up_5&#45;&gt;ffn_act_5</title>
<path fill="none" stroke="black" d="M875,-8999.05C875,-8999.05 875,-8951.4 875,-8951.4"/>
<polygon fill="black" stroke="black" points="878.5,-8951.4 875,-8941.4 871.5,-8951.4 878.5,-8951.4"/>
</g>
<!-- ffn_down_5 -->
<g id="node64" class="node">
<title>ffn_down_5</title>
<polygon fill="#d4e6f1" stroke="black" points="985.5,-8830.14 770.5,-8830.14 770.5,-8777.14 985.5,-8777.14 985.5,-8830.14"/>
<text text-anchor="middle" x="878" y="-8814.94" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="878" y="-8799.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="878" y="-8784.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_5&#45;&gt;ffn_down_5 -->
<g id="edge68" class="edge">
<title>ffn_act_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M878,-8888.05C878,-8888.05 878,-8840.4 878,-8840.4"/>
<polygon fill="black" stroke="black" points="881.5,-8840.4 878,-8830.4 874.5,-8840.4 881.5,-8840.4"/>
</g>
<!-- ffn_down_5&#45;&gt;residual2_5 -->
<g id="edge70" class="edge">
<title>ffn_down_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M935.5,-8777.05C935.5,-8777.05 935.5,-8729.4 935.5,-8729.4"/>
<polygon fill="black" stroke="black" points="939,-8729.4 935.5,-8719.4 932,-8729.4 939,-8729.4"/>
</g>
<!-- transfer_5 -->
<g id="node66" class="node">
<title>transfer_5</title>
<ellipse fill="#fadbd8" stroke="black" cx="993" cy="-8581.27" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="993" y="-8585.07" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 5</text>
<text text-anchor="middle" x="993" y="-8570.07" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_5&#45;&gt;transfer_5 -->
<g id="edge71" class="edge">
<title>residual2_5&#45;&gt;transfer_5</title>
<path fill="none" stroke="black" d="M993,-8665.97C993,-8665.97 993,-8618.5 993,-8618.5"/>
<polygon fill="black" stroke="black" points="996.5,-8618.5 993,-8608.5 989.5,-8618.5 996.5,-8618.5"/>
</g>
<!-- residual1_6 -->
<g id="node73" class="node">
<title>residual1_6</title>
<polygon fill="#fadbd8" stroke="black" points="1248.5,-8496.4 1033.5,-8496.4 1033.5,-8443.4 1248.5,-8443.4 1248.5,-8496.4"/>
<text text-anchor="middle" x="1141" y="-8481.2" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1141" y="-8466.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1141" y="-8451.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_5&#45;&gt;residual1_6 -->
<g id="edge77" class="edge">
<title>transfer_5&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M1089.26,-8560.32C1089.26,-8560.32 1089.26,-8506.67 1089.26,-8506.67"/>
<polygon fill="black" stroke="black" points="1092.76,-8506.67 1089.26,-8496.67 1085.76,-8506.67 1092.76,-8506.67"/>
</g>
<!-- ln1_6 -->
<g id="node67" class="node">
<title>ln1_6</title>
<polygon fill="#f8f9f9" stroke="black" points="1396.5,-9163.14 1181.5,-9163.14 1181.5,-9110.14 1396.5,-9110.14 1396.5,-9163.14"/>
<text text-anchor="middle" x="1289" y="-9147.94" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="1289" y="-9132.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1289" y="-9117.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_6 -->
<g id="node68" class="node">
<title>attn_qkv_6</title>
<polygon fill="#ffe6cc" stroke="black" points="1404,-9052.14 1174,-9052.14 1174,-8999.14 1404,-8999.14 1404,-9052.14"/>
<text text-anchor="middle" x="1289" y="-9036.94" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1289" y="-9021.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1289" y="-9006.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_6&#45;&gt;attn_qkv_6 -->
<g id="edge72" class="edge">
<title>ln1_6&#45;&gt;attn_qkv_6</title>
<path fill="none" stroke="black" d="M1289,-9110.05C1289,-9110.05 1289,-9062.4 1289,-9062.4"/>
<polygon fill="black" stroke="black" points="1292.5,-9062.4 1289,-9052.4 1285.5,-9062.4 1292.5,-9062.4"/>
</g>
<!-- attn_score_6 -->
<g id="node69" class="node">
<title>attn_score_6</title>
<polygon fill="#ffe6cc" stroke="black" points="1426.5,-8941.14 1151.5,-8941.14 1151.5,-8888.14 1426.5,-8888.14 1426.5,-8941.14"/>
<text text-anchor="middle" x="1289" y="-8925.94" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1289" y="-8910.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1289" y="-8895.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_6&#45;&gt;attn_score_6 -->
<g id="edge73" class="edge">
<title>attn_qkv_6&#45;&gt;attn_score_6</title>
<path fill="none" stroke="black" d="M1289,-8999.05C1289,-8999.05 1289,-8951.4 1289,-8951.4"/>
<polygon fill="black" stroke="black" points="1292.5,-8951.4 1289,-8941.4 1285.5,-8951.4 1292.5,-8951.4"/>
</g>
<!-- attn_weight_6 -->
<g id="node70" class="node">
<title>attn_weight_6</title>
<polygon fill="#ffe6cc" stroke="black" points="1426.5,-8830.14 1151.5,-8830.14 1151.5,-8777.14 1426.5,-8777.14 1426.5,-8830.14"/>
<text text-anchor="middle" x="1289" y="-8814.94" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1289" y="-8799.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1289" y="-8784.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_6&#45;&gt;attn_weight_6 -->
<g id="edge74" class="edge">
<title>attn_score_6&#45;&gt;attn_weight_6</title>
<path fill="none" stroke="black" d="M1289,-8888.05C1289,-8888.05 1289,-8840.4 1289,-8840.4"/>
<polygon fill="black" stroke="black" points="1292.5,-8840.4 1289,-8830.4 1285.5,-8840.4 1292.5,-8840.4"/>
</g>
<!-- attn_context_6 -->
<g id="node71" class="node">
<title>attn_context_6</title>
<polygon fill="#ffe6cc" stroke="black" points="1434,-8719.14 1144,-8719.14 1144,-8666.14 1434,-8666.14 1434,-8719.14"/>
<text text-anchor="middle" x="1289" y="-8703.94" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="1289" y="-8688.94" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1289" y="-8673.94" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_6&#45;&gt;attn_context_6 -->
<g id="edge75" class="edge">
<title>attn_weight_6&#45;&gt;attn_context_6</title>
<path fill="none" stroke="black" d="M1289,-8777.05C1289,-8777.05 1289,-8729.4 1289,-8729.4"/>
<polygon fill="black" stroke="black" points="1292.5,-8729.4 1289,-8719.4 1285.5,-8729.4 1292.5,-8729.4"/>
</g>
<!-- attn_out_6 -->
<g id="node72" class="node">
<title>attn_out_6</title>
<polygon fill="#ffe6cc" stroke="black" points="1396.5,-8607.77 1181.5,-8607.77 1181.5,-8554.77 1396.5,-8554.77 1396.5,-8607.77"/>
<text text-anchor="middle" x="1289" y="-8592.57" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1289" y="-8577.57" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1289" y="-8562.57" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_6&#45;&gt;attn_out_6 -->
<g id="edge76" class="edge">
<title>attn_context_6&#45;&gt;attn_out_6</title>
<path fill="none" stroke="black" d="M1289,-8665.97C1289,-8665.97 1289,-8618.12 1289,-8618.12"/>
<polygon fill="black" stroke="black" points="1292.5,-8618.12 1289,-8608.12 1285.5,-8618.12 1292.5,-8618.12"/>
</g>
<!-- attn_out_6&#45;&gt;residual1_6 -->
<g id="edge78" class="edge">
<title>attn_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M1215,-8554.6C1215,-8554.6 1215,-8506.75 1215,-8506.75"/>
<polygon fill="black" stroke="black" points="1218.5,-8506.75 1215,-8496.75 1211.5,-8506.75 1218.5,-8506.75"/>
</g>
<!-- ln2_6 -->
<g id="node74" class="node">
<title>ln2_6</title>
<polygon fill="#f8f9f9" stroke="black" points="1163.5,-8385.4 948.5,-8385.4 948.5,-8332.4 1163.5,-8332.4 1163.5,-8385.4"/>
<text text-anchor="middle" x="1056" y="-8370.2" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="1056" y="-8355.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1056" y="-8340.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge79" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M1098.5,-8443.31C1098.5,-8443.31 1098.5,-8395.66 1098.5,-8395.66"/>
<polygon fill="black" stroke="black" points="1102,-8395.66 1098.5,-8385.66 1095,-8395.66 1102,-8395.66"/>
</g>
<!-- residual2_6 -->
<g id="node78" class="node">
<title>residual2_6</title>
<polygon fill="#fadbd8" stroke="black" points="1278.5,-7941.4 1063.5,-7941.4 1063.5,-7888.4 1278.5,-7888.4 1278.5,-7941.4"/>
<text text-anchor="middle" x="1171" y="-7926.2" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1171" y="-7911.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1171" y="-7896.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_6&#45;&gt;residual2_6 -->
<g id="edge83" class="edge">
<title>residual1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M1208.25,-8443.13C1208.25,-8443.13 1208.25,-7951.4 1208.25,-7951.4"/>
<polygon fill="black" stroke="black" points="1211.75,-7951.4 1208.25,-7941.4 1204.75,-7951.4 1211.75,-7951.4"/>
</g>
<!-- ffn_up_6 -->
<g id="node75" class="node">
<title>ffn_up_6</title>
<polygon fill="#d4e6f1" stroke="black" points="1168,-8274.4 938,-8274.4 938,-8221.4 1168,-8221.4 1168,-8274.4"/>
<text text-anchor="middle" x="1053" y="-8259.2" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1053" y="-8244.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1053" y="-8229.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_6&#45;&gt;ffn_up_6 -->
<g id="edge80" class="edge">
<title>ln2_6&#45;&gt;ffn_up_6</title>
<path fill="none" stroke="black" d="M1056,-8332.31C1056,-8332.31 1056,-8284.66 1056,-8284.66"/>
<polygon fill="black" stroke="black" points="1059.5,-8284.66 1056,-8274.66 1052.5,-8284.66 1059.5,-8284.66"/>
</g>
<!-- ffn_act_6 -->
<g id="node76" class="node">
<title>ffn_act_6</title>
<polygon fill="#d4e6f1" stroke="black" points="1168,-8163.4 938,-8163.4 938,-8110.4 1168,-8110.4 1168,-8163.4"/>
<text text-anchor="middle" x="1053" y="-8148.2" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1053" y="-8133.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1053" y="-8118.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_6&#45;&gt;ffn_act_6 -->
<g id="edge81" class="edge">
<title>ffn_up_6&#45;&gt;ffn_act_6</title>
<path fill="none" stroke="black" d="M1053,-8221.31C1053,-8221.31 1053,-8173.66 1053,-8173.66"/>
<polygon fill="black" stroke="black" points="1056.5,-8173.66 1053,-8163.66 1049.5,-8173.66 1056.5,-8173.66"/>
</g>
<!-- ffn_down_6 -->
<g id="node77" class="node">
<title>ffn_down_6</title>
<polygon fill="#d4e6f1" stroke="black" points="1164.5,-8052.4 949.5,-8052.4 949.5,-7999.4 1164.5,-7999.4 1164.5,-8052.4"/>
<text text-anchor="middle" x="1057" y="-8037.2" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1057" y="-8022.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="1057" y="-8007.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_6&#45;&gt;ffn_down_6 -->
<g id="edge82" class="edge">
<title>ffn_act_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M1057,-8110.31C1057,-8110.31 1057,-8062.66 1057,-8062.66"/>
<polygon fill="black" stroke="black" points="1060.5,-8062.66 1057,-8052.66 1053.5,-8062.66 1060.5,-8062.66"/>
</g>
<!-- ffn_down_6&#45;&gt;residual2_6 -->
<g id="edge84" class="edge">
<title>ffn_down_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M1114,-7999.31C1114,-7999.31 1114,-7951.66 1114,-7951.66"/>
<polygon fill="black" stroke="black" points="1117.5,-7951.66 1114,-7941.66 1110.5,-7951.66 1117.5,-7951.66"/>
</g>
<!-- transfer_6 -->
<g id="node79" class="node">
<title>transfer_6</title>
<ellipse fill="#fadbd8" stroke="black" cx="1171" cy="-7803.53" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="1171" y="-7807.33" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 6</text>
<text text-anchor="middle" x="1171" y="-7792.33" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_6&#45;&gt;transfer_6 -->
<g id="edge85" class="edge">
<title>residual2_6&#45;&gt;transfer_6</title>
<path fill="none" stroke="black" d="M1171,-7888.23C1171,-7888.23 1171,-7840.76 1171,-7840.76"/>
<polygon fill="black" stroke="black" points="1174.5,-7840.76 1171,-7830.76 1167.5,-7840.76 1174.5,-7840.76"/>
</g>
<!-- residual1_7 -->
<g id="node86" class="node">
<title>residual1_7</title>
<polygon fill="#fadbd8" stroke="black" points="1426.5,-7718.66 1211.5,-7718.66 1211.5,-7665.66 1426.5,-7665.66 1426.5,-7718.66"/>
<text text-anchor="middle" x="1319" y="-7703.46" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1319" y="-7688.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1319" y="-7673.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_6&#45;&gt;residual1_7 -->
<g id="edge91" class="edge">
<title>transfer_6&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M1267.26,-7782.58C1267.26,-7782.58 1267.26,-7728.93 1267.26,-7728.93"/>
<polygon fill="black" stroke="black" points="1270.76,-7728.93 1267.26,-7718.93 1263.76,-7728.93 1270.76,-7728.93"/>
</g>
<!-- ln1_7 -->
<g id="node80" class="node">
<title>ln1_7</title>
<polygon fill="#f8f9f9" stroke="black" points="1574.5,-8385.4 1359.5,-8385.4 1359.5,-8332.4 1574.5,-8332.4 1574.5,-8385.4"/>
<text text-anchor="middle" x="1467" y="-8370.2" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="1467" y="-8355.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1467" y="-8340.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_7 -->
<g id="node81" class="node">
<title>attn_qkv_7</title>
<polygon fill="#ffe6cc" stroke="black" points="1582,-8274.4 1352,-8274.4 1352,-8221.4 1582,-8221.4 1582,-8274.4"/>
<text text-anchor="middle" x="1467" y="-8259.2" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1467" y="-8244.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1467" y="-8229.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_7&#45;&gt;attn_qkv_7 -->
<g id="edge86" class="edge">
<title>ln1_7&#45;&gt;attn_qkv_7</title>
<path fill="none" stroke="black" d="M1467,-8332.31C1467,-8332.31 1467,-8284.66 1467,-8284.66"/>
<polygon fill="black" stroke="black" points="1470.5,-8284.66 1467,-8274.66 1463.5,-8284.66 1470.5,-8284.66"/>
</g>
<!-- attn_score_7 -->
<g id="node82" class="node">
<title>attn_score_7</title>
<polygon fill="#ffe6cc" stroke="black" points="1604.5,-8163.4 1329.5,-8163.4 1329.5,-8110.4 1604.5,-8110.4 1604.5,-8163.4"/>
<text text-anchor="middle" x="1467" y="-8148.2" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1467" y="-8133.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1467" y="-8118.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_7&#45;&gt;attn_score_7 -->
<g id="edge87" class="edge">
<title>attn_qkv_7&#45;&gt;attn_score_7</title>
<path fill="none" stroke="black" d="M1467,-8221.31C1467,-8221.31 1467,-8173.66 1467,-8173.66"/>
<polygon fill="black" stroke="black" points="1470.5,-8173.66 1467,-8163.66 1463.5,-8173.66 1470.5,-8173.66"/>
</g>
<!-- attn_weight_7 -->
<g id="node83" class="node">
<title>attn_weight_7</title>
<polygon fill="#ffe6cc" stroke="black" points="1604.5,-8052.4 1329.5,-8052.4 1329.5,-7999.4 1604.5,-7999.4 1604.5,-8052.4"/>
<text text-anchor="middle" x="1467" y="-8037.2" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1467" y="-8022.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1467" y="-8007.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_7&#45;&gt;attn_weight_7 -->
<g id="edge88" class="edge">
<title>attn_score_7&#45;&gt;attn_weight_7</title>
<path fill="none" stroke="black" d="M1467,-8110.31C1467,-8110.31 1467,-8062.66 1467,-8062.66"/>
<polygon fill="black" stroke="black" points="1470.5,-8062.66 1467,-8052.66 1463.5,-8062.66 1470.5,-8062.66"/>
</g>
<!-- attn_context_7 -->
<g id="node84" class="node">
<title>attn_context_7</title>
<polygon fill="#ffe6cc" stroke="black" points="1612,-7941.4 1322,-7941.4 1322,-7888.4 1612,-7888.4 1612,-7941.4"/>
<text text-anchor="middle" x="1467" y="-7926.2" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="1467" y="-7911.2" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1467" y="-7896.2" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_7&#45;&gt;attn_context_7 -->
<g id="edge89" class="edge">
<title>attn_weight_7&#45;&gt;attn_context_7</title>
<path fill="none" stroke="black" d="M1467,-7999.31C1467,-7999.31 1467,-7951.66 1467,-7951.66"/>
<polygon fill="black" stroke="black" points="1470.5,-7951.66 1467,-7941.66 1463.5,-7951.66 1470.5,-7951.66"/>
</g>
<!-- attn_out_7 -->
<g id="node85" class="node">
<title>attn_out_7</title>
<polygon fill="#ffe6cc" stroke="black" points="1574.5,-7830.03 1359.5,-7830.03 1359.5,-7777.03 1574.5,-7777.03 1574.5,-7830.03"/>
<text text-anchor="middle" x="1467" y="-7814.83" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1467" y="-7799.83" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1467" y="-7784.83" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_7&#45;&gt;attn_out_7 -->
<g id="edge90" class="edge">
<title>attn_context_7&#45;&gt;attn_out_7</title>
<path fill="none" stroke="black" d="M1467,-7888.23C1467,-7888.23 1467,-7840.38 1467,-7840.38"/>
<polygon fill="black" stroke="black" points="1470.5,-7840.38 1467,-7830.38 1463.5,-7840.38 1470.5,-7840.38"/>
</g>
<!-- attn_out_7&#45;&gt;residual1_7 -->
<g id="edge92" class="edge">
<title>attn_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M1393,-7776.86C1393,-7776.86 1393,-7729.01 1393,-7729.01"/>
<polygon fill="black" stroke="black" points="1396.5,-7729.01 1393,-7719.01 1389.5,-7729.01 1396.5,-7729.01"/>
</g>
<!-- ln2_7 -->
<g id="node87" class="node">
<title>ln2_7</title>
<polygon fill="#f8f9f9" stroke="black" points="1341.5,-7607.66 1126.5,-7607.66 1126.5,-7554.66 1341.5,-7554.66 1341.5,-7607.66"/>
<text text-anchor="middle" x="1234" y="-7592.46" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="1234" y="-7577.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1234" y="-7562.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge93" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M1276.5,-7665.57C1276.5,-7665.57 1276.5,-7617.92 1276.5,-7617.92"/>
<polygon fill="black" stroke="black" points="1280,-7617.92 1276.5,-7607.92 1273,-7617.92 1280,-7617.92"/>
</g>
<!-- residual2_7 -->
<g id="node91" class="node">
<title>residual2_7</title>
<polygon fill="#fadbd8" stroke="black" points="1456.5,-7163.66 1241.5,-7163.66 1241.5,-7110.66 1456.5,-7110.66 1456.5,-7163.66"/>
<text text-anchor="middle" x="1349" y="-7148.46" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1349" y="-7133.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1349" y="-7118.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_7&#45;&gt;residual2_7 -->
<g id="edge97" class="edge">
<title>residual1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M1386.25,-7665.39C1386.25,-7665.39 1386.25,-7173.66 1386.25,-7173.66"/>
<polygon fill="black" stroke="black" points="1389.75,-7173.66 1386.25,-7163.66 1382.75,-7173.66 1389.75,-7173.66"/>
</g>
<!-- ffn_up_7 -->
<g id="node88" class="node">
<title>ffn_up_7</title>
<polygon fill="#d4e6f1" stroke="black" points="1346,-7496.66 1116,-7496.66 1116,-7443.66 1346,-7443.66 1346,-7496.66"/>
<text text-anchor="middle" x="1231" y="-7481.46" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1231" y="-7466.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1231" y="-7451.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_7&#45;&gt;ffn_up_7 -->
<g id="edge94" class="edge">
<title>ln2_7&#45;&gt;ffn_up_7</title>
<path fill="none" stroke="black" d="M1234,-7554.57C1234,-7554.57 1234,-7506.92 1234,-7506.92"/>
<polygon fill="black" stroke="black" points="1237.5,-7506.92 1234,-7496.92 1230.5,-7506.92 1237.5,-7506.92"/>
</g>
<!-- ffn_act_7 -->
<g id="node89" class="node">
<title>ffn_act_7</title>
<polygon fill="#d4e6f1" stroke="black" points="1346,-7385.66 1116,-7385.66 1116,-7332.66 1346,-7332.66 1346,-7385.66"/>
<text text-anchor="middle" x="1231" y="-7370.46" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1231" y="-7355.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1231" y="-7340.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_7&#45;&gt;ffn_act_7 -->
<g id="edge95" class="edge">
<title>ffn_up_7&#45;&gt;ffn_act_7</title>
<path fill="none" stroke="black" d="M1231,-7443.57C1231,-7443.57 1231,-7395.92 1231,-7395.92"/>
<polygon fill="black" stroke="black" points="1234.5,-7395.92 1231,-7385.92 1227.5,-7395.92 1234.5,-7395.92"/>
</g>
<!-- ffn_down_7 -->
<g id="node90" class="node">
<title>ffn_down_7</title>
<polygon fill="#d4e6f1" stroke="black" points="1342.5,-7274.66 1127.5,-7274.66 1127.5,-7221.66 1342.5,-7221.66 1342.5,-7274.66"/>
<text text-anchor="middle" x="1235" y="-7259.46" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1235" y="-7244.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="1235" y="-7229.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_7&#45;&gt;ffn_down_7 -->
<g id="edge96" class="edge">
<title>ffn_act_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M1235,-7332.57C1235,-7332.57 1235,-7284.92 1235,-7284.92"/>
<polygon fill="black" stroke="black" points="1238.5,-7284.92 1235,-7274.92 1231.5,-7284.92 1238.5,-7284.92"/>
</g>
<!-- ffn_down_7&#45;&gt;residual2_7 -->
<g id="edge98" class="edge">
<title>ffn_down_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M1292,-7221.57C1292,-7221.57 1292,-7173.92 1292,-7173.92"/>
<polygon fill="black" stroke="black" points="1295.5,-7173.92 1292,-7163.92 1288.5,-7173.92 1295.5,-7173.92"/>
</g>
<!-- transfer_7 -->
<g id="node92" class="node">
<title>transfer_7</title>
<ellipse fill="#fadbd8" stroke="black" cx="1349" cy="-7025.79" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="1349" y="-7029.59" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 7</text>
<text text-anchor="middle" x="1349" y="-7014.59" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_7&#45;&gt;transfer_7 -->
<g id="edge99" class="edge">
<title>residual2_7&#45;&gt;transfer_7</title>
<path fill="none" stroke="black" d="M1349,-7110.49C1349,-7110.49 1349,-7063.02 1349,-7063.02"/>
<polygon fill="black" stroke="black" points="1352.5,-7063.02 1349,-7053.02 1345.5,-7063.02 1352.5,-7063.02"/>
</g>
<!-- residual1_8 -->
<g id="node99" class="node">
<title>residual1_8</title>
<polygon fill="#fadbd8" stroke="black" points="1604.5,-6940.92 1389.5,-6940.92 1389.5,-6887.92 1604.5,-6887.92 1604.5,-6940.92"/>
<text text-anchor="middle" x="1497" y="-6925.72" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1497" y="-6910.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1497" y="-6895.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_7&#45;&gt;residual1_8 -->
<g id="edge105" class="edge">
<title>transfer_7&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1445.26,-7004.84C1445.26,-7004.84 1445.26,-6951.19 1445.26,-6951.19"/>
<polygon fill="black" stroke="black" points="1448.76,-6951.19 1445.26,-6941.19 1441.76,-6951.19 1448.76,-6951.19"/>
</g>
<!-- ln1_8 -->
<g id="node93" class="node">
<title>ln1_8</title>
<polygon fill="#f8f9f9" stroke="black" points="1752.5,-7607.66 1537.5,-7607.66 1537.5,-7554.66 1752.5,-7554.66 1752.5,-7607.66"/>
<text text-anchor="middle" x="1645" y="-7592.46" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="1645" y="-7577.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1645" y="-7562.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_8 -->
<g id="node94" class="node">
<title>attn_qkv_8</title>
<polygon fill="#ffe6cc" stroke="black" points="1760,-7496.66 1530,-7496.66 1530,-7443.66 1760,-7443.66 1760,-7496.66"/>
<text text-anchor="middle" x="1645" y="-7481.46" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1645" y="-7466.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1645" y="-7451.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_8&#45;&gt;attn_qkv_8 -->
<g id="edge100" class="edge">
<title>ln1_8&#45;&gt;attn_qkv_8</title>
<path fill="none" stroke="black" d="M1645,-7554.57C1645,-7554.57 1645,-7506.92 1645,-7506.92"/>
<polygon fill="black" stroke="black" points="1648.5,-7506.92 1645,-7496.92 1641.5,-7506.92 1648.5,-7506.92"/>
</g>
<!-- attn_score_8 -->
<g id="node95" class="node">
<title>attn_score_8</title>
<polygon fill="#ffe6cc" stroke="black" points="1782.5,-7385.66 1507.5,-7385.66 1507.5,-7332.66 1782.5,-7332.66 1782.5,-7385.66"/>
<text text-anchor="middle" x="1645" y="-7370.46" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1645" y="-7355.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1645" y="-7340.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_8&#45;&gt;attn_score_8 -->
<g id="edge101" class="edge">
<title>attn_qkv_8&#45;&gt;attn_score_8</title>
<path fill="none" stroke="black" d="M1645,-7443.57C1645,-7443.57 1645,-7395.92 1645,-7395.92"/>
<polygon fill="black" stroke="black" points="1648.5,-7395.92 1645,-7385.92 1641.5,-7395.92 1648.5,-7395.92"/>
</g>
<!-- attn_weight_8 -->
<g id="node96" class="node">
<title>attn_weight_8</title>
<polygon fill="#ffe6cc" stroke="black" points="1782.5,-7274.66 1507.5,-7274.66 1507.5,-7221.66 1782.5,-7221.66 1782.5,-7274.66"/>
<text text-anchor="middle" x="1645" y="-7259.46" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1645" y="-7244.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1645" y="-7229.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_8&#45;&gt;attn_weight_8 -->
<g id="edge102" class="edge">
<title>attn_score_8&#45;&gt;attn_weight_8</title>
<path fill="none" stroke="black" d="M1645,-7332.57C1645,-7332.57 1645,-7284.92 1645,-7284.92"/>
<polygon fill="black" stroke="black" points="1648.5,-7284.92 1645,-7274.92 1641.5,-7284.92 1648.5,-7284.92"/>
</g>
<!-- attn_context_8 -->
<g id="node97" class="node">
<title>attn_context_8</title>
<polygon fill="#ffe6cc" stroke="black" points="1790,-7163.66 1500,-7163.66 1500,-7110.66 1790,-7110.66 1790,-7163.66"/>
<text text-anchor="middle" x="1645" y="-7148.46" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="1645" y="-7133.46" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1645" y="-7118.46" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_8&#45;&gt;attn_context_8 -->
<g id="edge103" class="edge">
<title>attn_weight_8&#45;&gt;attn_context_8</title>
<path fill="none" stroke="black" d="M1645,-7221.57C1645,-7221.57 1645,-7173.92 1645,-7173.92"/>
<polygon fill="black" stroke="black" points="1648.5,-7173.92 1645,-7163.92 1641.5,-7173.92 1648.5,-7173.92"/>
</g>
<!-- attn_out_8 -->
<g id="node98" class="node">
<title>attn_out_8</title>
<polygon fill="#ffe6cc" stroke="black" points="1752.5,-7052.29 1537.5,-7052.29 1537.5,-6999.29 1752.5,-6999.29 1752.5,-7052.29"/>
<text text-anchor="middle" x="1645" y="-7037.09" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1645" y="-7022.09" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1645" y="-7007.09" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_8&#45;&gt;attn_out_8 -->
<g id="edge104" class="edge">
<title>attn_context_8&#45;&gt;attn_out_8</title>
<path fill="none" stroke="black" d="M1645,-7110.49C1645,-7110.49 1645,-7062.64 1645,-7062.64"/>
<polygon fill="black" stroke="black" points="1648.5,-7062.64 1645,-7052.64 1641.5,-7062.64 1648.5,-7062.64"/>
</g>
<!-- attn_out_8&#45;&gt;residual1_8 -->
<g id="edge106" class="edge">
<title>attn_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1571,-6999.12C1571,-6999.12 1571,-6951.27 1571,-6951.27"/>
<polygon fill="black" stroke="black" points="1574.5,-6951.27 1571,-6941.27 1567.5,-6951.27 1574.5,-6951.27"/>
</g>
<!-- ln2_8 -->
<g id="node100" class="node">
<title>ln2_8</title>
<polygon fill="#f8f9f9" stroke="black" points="1519.5,-6829.92 1304.5,-6829.92 1304.5,-6776.92 1519.5,-6776.92 1519.5,-6829.92"/>
<text text-anchor="middle" x="1412" y="-6814.72" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="1412" y="-6799.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1412" y="-6784.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge107" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M1454.5,-6887.83C1454.5,-6887.83 1454.5,-6840.18 1454.5,-6840.18"/>
<polygon fill="black" stroke="black" points="1458,-6840.18 1454.5,-6830.18 1451,-6840.18 1458,-6840.18"/>
</g>
<!-- residual2_8 -->
<g id="node104" class="node">
<title>residual2_8</title>
<polygon fill="#fadbd8" stroke="black" points="1634.5,-6385.92 1419.5,-6385.92 1419.5,-6332.92 1634.5,-6332.92 1634.5,-6385.92"/>
<text text-anchor="middle" x="1527" y="-6370.72" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1527" y="-6355.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1527" y="-6340.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_8&#45;&gt;residual2_8 -->
<g id="edge111" class="edge">
<title>residual1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1564.25,-6887.65C1564.25,-6887.65 1564.25,-6395.92 1564.25,-6395.92"/>
<polygon fill="black" stroke="black" points="1567.75,-6395.92 1564.25,-6385.92 1560.75,-6395.92 1567.75,-6395.92"/>
</g>
<!-- ffn_up_8 -->
<g id="node101" class="node">
<title>ffn_up_8</title>
<polygon fill="#d4e6f1" stroke="black" points="1524,-6718.92 1294,-6718.92 1294,-6665.92 1524,-6665.92 1524,-6718.92"/>
<text text-anchor="middle" x="1409" y="-6703.72" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1409" y="-6688.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1409" y="-6673.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_8&#45;&gt;ffn_up_8 -->
<g id="edge108" class="edge">
<title>ln2_8&#45;&gt;ffn_up_8</title>
<path fill="none" stroke="black" d="M1412,-6776.83C1412,-6776.83 1412,-6729.18 1412,-6729.18"/>
<polygon fill="black" stroke="black" points="1415.5,-6729.18 1412,-6719.18 1408.5,-6729.18 1415.5,-6729.18"/>
</g>
<!-- ffn_act_8 -->
<g id="node102" class="node">
<title>ffn_act_8</title>
<polygon fill="#d4e6f1" stroke="black" points="1524,-6607.92 1294,-6607.92 1294,-6554.92 1524,-6554.92 1524,-6607.92"/>
<text text-anchor="middle" x="1409" y="-6592.72" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1409" y="-6577.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1409" y="-6562.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_8&#45;&gt;ffn_act_8 -->
<g id="edge109" class="edge">
<title>ffn_up_8&#45;&gt;ffn_act_8</title>
<path fill="none" stroke="black" d="M1409,-6665.83C1409,-6665.83 1409,-6618.18 1409,-6618.18"/>
<polygon fill="black" stroke="black" points="1412.5,-6618.18 1409,-6608.18 1405.5,-6618.18 1412.5,-6618.18"/>
</g>
<!-- ffn_down_8 -->
<g id="node103" class="node">
<title>ffn_down_8</title>
<polygon fill="#d4e6f1" stroke="black" points="1520.5,-6496.92 1305.5,-6496.92 1305.5,-6443.92 1520.5,-6443.92 1520.5,-6496.92"/>
<text text-anchor="middle" x="1413" y="-6481.72" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1413" y="-6466.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="1413" y="-6451.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_8&#45;&gt;ffn_down_8 -->
<g id="edge110" class="edge">
<title>ffn_act_8&#45;&gt;ffn_down_8</title>
<path fill="none" stroke="black" d="M1413,-6554.83C1413,-6554.83 1413,-6507.18 1413,-6507.18"/>
<polygon fill="black" stroke="black" points="1416.5,-6507.18 1413,-6497.18 1409.5,-6507.18 1416.5,-6507.18"/>
</g>
<!-- ffn_down_8&#45;&gt;residual2_8 -->
<g id="edge112" class="edge">
<title>ffn_down_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1470,-6443.83C1470,-6443.83 1470,-6396.18 1470,-6396.18"/>
<polygon fill="black" stroke="black" points="1473.5,-6396.18 1470,-6386.18 1466.5,-6396.18 1473.5,-6396.18"/>
</g>
<!-- transfer_8 -->
<g id="node105" class="node">
<title>transfer_8</title>
<ellipse fill="#fadbd8" stroke="black" cx="1527" cy="-6248.05" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="1527" y="-6251.85" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 8</text>
<text text-anchor="middle" x="1527" y="-6236.85" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_8&#45;&gt;transfer_8 -->
<g id="edge113" class="edge">
<title>residual2_8&#45;&gt;transfer_8</title>
<path fill="none" stroke="black" d="M1527,-6332.75C1527,-6332.75 1527,-6285.28 1527,-6285.28"/>
<polygon fill="black" stroke="black" points="1530.5,-6285.28 1527,-6275.28 1523.5,-6285.28 1530.5,-6285.28"/>
</g>
<!-- residual1_9 -->
<g id="node112" class="node">
<title>residual1_9</title>
<polygon fill="#fadbd8" stroke="black" points="1782.5,-6163.18 1567.5,-6163.18 1567.5,-6110.18 1782.5,-6110.18 1782.5,-6163.18"/>
<text text-anchor="middle" x="1675" y="-6147.98" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1675" y="-6132.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1675" y="-6117.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_8&#45;&gt;residual1_9 -->
<g id="edge119" class="edge">
<title>transfer_8&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1623.26,-6227.1C1623.26,-6227.1 1623.26,-6173.45 1623.26,-6173.45"/>
<polygon fill="black" stroke="black" points="1626.76,-6173.45 1623.26,-6163.45 1619.76,-6173.45 1626.76,-6173.45"/>
</g>
<!-- ln1_9 -->
<g id="node106" class="node">
<title>ln1_9</title>
<polygon fill="#f8f9f9" stroke="black" points="1930.5,-6829.92 1715.5,-6829.92 1715.5,-6776.92 1930.5,-6776.92 1930.5,-6829.92"/>
<text text-anchor="middle" x="1823" y="-6814.72" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="1823" y="-6799.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1823" y="-6784.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_9 -->
<g id="node107" class="node">
<title>attn_qkv_9</title>
<polygon fill="#ffe6cc" stroke="black" points="1938,-6718.92 1708,-6718.92 1708,-6665.92 1938,-6665.92 1938,-6718.92"/>
<text text-anchor="middle" x="1823" y="-6703.72" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1823" y="-6688.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1823" y="-6673.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_9&#45;&gt;attn_qkv_9 -->
<g id="edge114" class="edge">
<title>ln1_9&#45;&gt;attn_qkv_9</title>
<path fill="none" stroke="black" d="M1823,-6776.83C1823,-6776.83 1823,-6729.18 1823,-6729.18"/>
<polygon fill="black" stroke="black" points="1826.5,-6729.18 1823,-6719.18 1819.5,-6729.18 1826.5,-6729.18"/>
</g>
<!-- attn_score_9 -->
<g id="node108" class="node">
<title>attn_score_9</title>
<polygon fill="#ffe6cc" stroke="black" points="1960.5,-6607.92 1685.5,-6607.92 1685.5,-6554.92 1960.5,-6554.92 1960.5,-6607.92"/>
<text text-anchor="middle" x="1823" y="-6592.72" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1823" y="-6577.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1823" y="-6562.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_9&#45;&gt;attn_score_9 -->
<g id="edge115" class="edge">
<title>attn_qkv_9&#45;&gt;attn_score_9</title>
<path fill="none" stroke="black" d="M1823,-6665.83C1823,-6665.83 1823,-6618.18 1823,-6618.18"/>
<polygon fill="black" stroke="black" points="1826.5,-6618.18 1823,-6608.18 1819.5,-6618.18 1826.5,-6618.18"/>
</g>
<!-- attn_weight_9 -->
<g id="node109" class="node">
<title>attn_weight_9</title>
<polygon fill="#ffe6cc" stroke="black" points="1960.5,-6496.92 1685.5,-6496.92 1685.5,-6443.92 1960.5,-6443.92 1960.5,-6496.92"/>
<text text-anchor="middle" x="1823" y="-6481.72" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1823" y="-6466.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1823" y="-6451.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_9&#45;&gt;attn_weight_9 -->
<g id="edge116" class="edge">
<title>attn_score_9&#45;&gt;attn_weight_9</title>
<path fill="none" stroke="black" d="M1823,-6554.83C1823,-6554.83 1823,-6507.18 1823,-6507.18"/>
<polygon fill="black" stroke="black" points="1826.5,-6507.18 1823,-6497.18 1819.5,-6507.18 1826.5,-6507.18"/>
</g>
<!-- attn_context_9 -->
<g id="node110" class="node">
<title>attn_context_9</title>
<polygon fill="#ffe6cc" stroke="black" points="1968,-6385.92 1678,-6385.92 1678,-6332.92 1968,-6332.92 1968,-6385.92"/>
<text text-anchor="middle" x="1823" y="-6370.72" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="1823" y="-6355.72" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1823" y="-6340.72" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_9&#45;&gt;attn_context_9 -->
<g id="edge117" class="edge">
<title>attn_weight_9&#45;&gt;attn_context_9</title>
<path fill="none" stroke="black" d="M1823,-6443.83C1823,-6443.83 1823,-6396.18 1823,-6396.18"/>
<polygon fill="black" stroke="black" points="1826.5,-6396.18 1823,-6386.18 1819.5,-6396.18 1826.5,-6396.18"/>
</g>
<!-- attn_out_9 -->
<g id="node111" class="node">
<title>attn_out_9</title>
<polygon fill="#ffe6cc" stroke="black" points="1930.5,-6274.55 1715.5,-6274.55 1715.5,-6221.55 1930.5,-6221.55 1930.5,-6274.55"/>
<text text-anchor="middle" x="1823" y="-6259.35" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1823" y="-6244.35" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1823" y="-6229.35" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_9&#45;&gt;attn_out_9 -->
<g id="edge118" class="edge">
<title>attn_context_9&#45;&gt;attn_out_9</title>
<path fill="none" stroke="black" d="M1823,-6332.75C1823,-6332.75 1823,-6284.9 1823,-6284.9"/>
<polygon fill="black" stroke="black" points="1826.5,-6284.9 1823,-6274.9 1819.5,-6284.9 1826.5,-6284.9"/>
</g>
<!-- attn_out_9&#45;&gt;residual1_9 -->
<g id="edge120" class="edge">
<title>attn_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1749,-6221.37C1749,-6221.37 1749,-6173.53 1749,-6173.53"/>
<polygon fill="black" stroke="black" points="1752.5,-6173.53 1749,-6163.53 1745.5,-6173.53 1752.5,-6173.53"/>
</g>
<!-- ln2_9 -->
<g id="node113" class="node">
<title>ln2_9</title>
<polygon fill="#f8f9f9" stroke="black" points="1697.5,-6052.18 1482.5,-6052.18 1482.5,-5999.18 1697.5,-5999.18 1697.5,-6052.18"/>
<text text-anchor="middle" x="1590" y="-6036.98" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="1590" y="-6021.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1590" y="-6006.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge121" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M1632.5,-6110.09C1632.5,-6110.09 1632.5,-6062.44 1632.5,-6062.44"/>
<polygon fill="black" stroke="black" points="1636,-6062.44 1632.5,-6052.44 1629,-6062.44 1636,-6062.44"/>
</g>
<!-- residual2_9 -->
<g id="node117" class="node">
<title>residual2_9</title>
<polygon fill="#fadbd8" stroke="black" points="1812.5,-5608.18 1597.5,-5608.18 1597.5,-5555.18 1812.5,-5555.18 1812.5,-5608.18"/>
<text text-anchor="middle" x="1705" y="-5592.98" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1705" y="-5577.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1705" y="-5562.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_9&#45;&gt;residual2_9 -->
<g id="edge125" class="edge">
<title>residual1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M1742.25,-6109.91C1742.25,-6109.91 1742.25,-5618.18 1742.25,-5618.18"/>
<polygon fill="black" stroke="black" points="1745.75,-5618.18 1742.25,-5608.18 1738.75,-5618.18 1745.75,-5618.18"/>
</g>
<!-- ffn_up_9 -->
<g id="node114" class="node">
<title>ffn_up_9</title>
<polygon fill="#d4e6f1" stroke="black" points="1702,-5941.18 1472,-5941.18 1472,-5888.18 1702,-5888.18 1702,-5941.18"/>
<text text-anchor="middle" x="1587" y="-5925.98" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1587" y="-5910.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1587" y="-5895.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_9&#45;&gt;ffn_up_9 -->
<g id="edge122" class="edge">
<title>ln2_9&#45;&gt;ffn_up_9</title>
<path fill="none" stroke="black" d="M1590,-5999.09C1590,-5999.09 1590,-5951.44 1590,-5951.44"/>
<polygon fill="black" stroke="black" points="1593.5,-5951.44 1590,-5941.44 1586.5,-5951.44 1593.5,-5951.44"/>
</g>
<!-- ffn_act_9 -->
<g id="node115" class="node">
<title>ffn_act_9</title>
<polygon fill="#d4e6f1" stroke="black" points="1702,-5830.18 1472,-5830.18 1472,-5777.18 1702,-5777.18 1702,-5830.18"/>
<text text-anchor="middle" x="1587" y="-5814.98" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1587" y="-5799.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1587" y="-5784.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_9&#45;&gt;ffn_act_9 -->
<g id="edge123" class="edge">
<title>ffn_up_9&#45;&gt;ffn_act_9</title>
<path fill="none" stroke="black" d="M1587,-5888.09C1587,-5888.09 1587,-5840.44 1587,-5840.44"/>
<polygon fill="black" stroke="black" points="1590.5,-5840.44 1587,-5830.44 1583.5,-5840.44 1590.5,-5840.44"/>
</g>
<!-- ffn_down_9 -->
<g id="node116" class="node">
<title>ffn_down_9</title>
<polygon fill="#d4e6f1" stroke="black" points="1698.5,-5719.18 1483.5,-5719.18 1483.5,-5666.18 1698.5,-5666.18 1698.5,-5719.18"/>
<text text-anchor="middle" x="1591" y="-5703.98" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1591" y="-5688.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="1591" y="-5673.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_9&#45;&gt;ffn_down_9 -->
<g id="edge124" class="edge">
<title>ffn_act_9&#45;&gt;ffn_down_9</title>
<path fill="none" stroke="black" d="M1591,-5777.09C1591,-5777.09 1591,-5729.44 1591,-5729.44"/>
<polygon fill="black" stroke="black" points="1594.5,-5729.44 1591,-5719.44 1587.5,-5729.44 1594.5,-5729.44"/>
</g>
<!-- ffn_down_9&#45;&gt;residual2_9 -->
<g id="edge126" class="edge">
<title>ffn_down_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M1648,-5666.09C1648,-5666.09 1648,-5618.44 1648,-5618.44"/>
<polygon fill="black" stroke="black" points="1651.5,-5618.44 1648,-5608.44 1644.5,-5618.44 1651.5,-5618.44"/>
</g>
<!-- transfer_9 -->
<g id="node118" class="node">
<title>transfer_9</title>
<ellipse fill="#fadbd8" stroke="black" cx="1705" cy="-5470.31" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="1705" y="-5474.11" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 9</text>
<text text-anchor="middle" x="1705" y="-5459.11" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_9&#45;&gt;transfer_9 -->
<g id="edge127" class="edge">
<title>residual2_9&#45;&gt;transfer_9</title>
<path fill="none" stroke="black" d="M1705,-5555C1705,-5555 1705,-5507.54 1705,-5507.54"/>
<polygon fill="black" stroke="black" points="1708.5,-5507.54 1705,-5497.54 1701.5,-5507.54 1708.5,-5507.54"/>
</g>
<!-- residual1_10 -->
<g id="node125" class="node">
<title>residual1_10</title>
<polygon fill="#fadbd8" stroke="black" points="1960.5,-5385.44 1745.5,-5385.44 1745.5,-5332.44 1960.5,-5332.44 1960.5,-5385.44"/>
<text text-anchor="middle" x="1853" y="-5370.24" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1853" y="-5355.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="1853" y="-5340.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_9&#45;&gt;residual1_10 -->
<g id="edge133" class="edge">
<title>transfer_9&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1801.26,-5449.36C1801.26,-5449.36 1801.26,-5395.71 1801.26,-5395.71"/>
<polygon fill="black" stroke="black" points="1804.76,-5395.71 1801.26,-5385.71 1797.76,-5395.71 1804.76,-5395.71"/>
</g>
<!-- ln1_10 -->
<g id="node119" class="node">
<title>ln1_10</title>
<polygon fill="#f8f9f9" stroke="black" points="2108.5,-6052.18 1893.5,-6052.18 1893.5,-5999.18 2108.5,-5999.18 2108.5,-6052.18"/>
<text text-anchor="middle" x="2001" y="-6036.98" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="2001" y="-6021.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2001" y="-6006.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_10 -->
<g id="node120" class="node">
<title>attn_qkv_10</title>
<polygon fill="#ffe6cc" stroke="black" points="2116,-5941.18 1886,-5941.18 1886,-5888.18 2116,-5888.18 2116,-5941.18"/>
<text text-anchor="middle" x="2001" y="-5925.98" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2001" y="-5910.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2001" y="-5895.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_10&#45;&gt;attn_qkv_10 -->
<g id="edge128" class="edge">
<title>ln1_10&#45;&gt;attn_qkv_10</title>
<path fill="none" stroke="black" d="M2001,-5999.09C2001,-5999.09 2001,-5951.44 2001,-5951.44"/>
<polygon fill="black" stroke="black" points="2004.5,-5951.44 2001,-5941.44 1997.5,-5951.44 2004.5,-5951.44"/>
</g>
<!-- attn_score_10 -->
<g id="node121" class="node">
<title>attn_score_10</title>
<polygon fill="#ffe6cc" stroke="black" points="2138.5,-5830.18 1863.5,-5830.18 1863.5,-5777.18 2138.5,-5777.18 2138.5,-5830.18"/>
<text text-anchor="middle" x="2001" y="-5814.98" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2001" y="-5799.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2001" y="-5784.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_10&#45;&gt;attn_score_10 -->
<g id="edge129" class="edge">
<title>attn_qkv_10&#45;&gt;attn_score_10</title>
<path fill="none" stroke="black" d="M2001,-5888.09C2001,-5888.09 2001,-5840.44 2001,-5840.44"/>
<polygon fill="black" stroke="black" points="2004.5,-5840.44 2001,-5830.44 1997.5,-5840.44 2004.5,-5840.44"/>
</g>
<!-- attn_weight_10 -->
<g id="node122" class="node">
<title>attn_weight_10</title>
<polygon fill="#ffe6cc" stroke="black" points="2138.5,-5719.18 1863.5,-5719.18 1863.5,-5666.18 2138.5,-5666.18 2138.5,-5719.18"/>
<text text-anchor="middle" x="2001" y="-5703.98" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2001" y="-5688.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2001" y="-5673.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_10&#45;&gt;attn_weight_10 -->
<g id="edge130" class="edge">
<title>attn_score_10&#45;&gt;attn_weight_10</title>
<path fill="none" stroke="black" d="M2001,-5777.09C2001,-5777.09 2001,-5729.44 2001,-5729.44"/>
<polygon fill="black" stroke="black" points="2004.5,-5729.44 2001,-5719.44 1997.5,-5729.44 2004.5,-5729.44"/>
</g>
<!-- attn_context_10 -->
<g id="node123" class="node">
<title>attn_context_10</title>
<polygon fill="#ffe6cc" stroke="black" points="2146,-5608.18 1856,-5608.18 1856,-5555.18 2146,-5555.18 2146,-5608.18"/>
<text text-anchor="middle" x="2001" y="-5592.98" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="2001" y="-5577.98" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2001" y="-5562.98" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_10&#45;&gt;attn_context_10 -->
<g id="edge131" class="edge">
<title>attn_weight_10&#45;&gt;attn_context_10</title>
<path fill="none" stroke="black" d="M2001,-5666.09C2001,-5666.09 2001,-5618.44 2001,-5618.44"/>
<polygon fill="black" stroke="black" points="2004.5,-5618.44 2001,-5608.44 1997.5,-5618.44 2004.5,-5618.44"/>
</g>
<!-- attn_out_10 -->
<g id="node124" class="node">
<title>attn_out_10</title>
<polygon fill="#ffe6cc" stroke="black" points="2108.5,-5496.81 1893.5,-5496.81 1893.5,-5443.81 2108.5,-5443.81 2108.5,-5496.81"/>
<text text-anchor="middle" x="2001" y="-5481.61" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2001" y="-5466.61" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="2001" y="-5451.61" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_10&#45;&gt;attn_out_10 -->
<g id="edge132" class="edge">
<title>attn_context_10&#45;&gt;attn_out_10</title>
<path fill="none" stroke="black" d="M2001,-5555C2001,-5555 2001,-5507.15 2001,-5507.15"/>
<polygon fill="black" stroke="black" points="2004.5,-5507.15 2001,-5497.15 1997.5,-5507.16 2004.5,-5507.15"/>
</g>
<!-- attn_out_10&#45;&gt;residual1_10 -->
<g id="edge134" class="edge">
<title>attn_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1927,-5443.63C1927,-5443.63 1927,-5395.78 1927,-5395.78"/>
<polygon fill="black" stroke="black" points="1930.5,-5395.78 1927,-5385.78 1923.5,-5395.78 1930.5,-5395.78"/>
</g>
<!-- ln2_10 -->
<g id="node126" class="node">
<title>ln2_10</title>
<polygon fill="#f8f9f9" stroke="black" points="1875.5,-5274.44 1660.5,-5274.44 1660.5,-5221.44 1875.5,-5221.44 1875.5,-5274.44"/>
<text text-anchor="middle" x="1768" y="-5259.24" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="1768" y="-5244.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="1768" y="-5229.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge135" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M1810.5,-5332.35C1810.5,-5332.35 1810.5,-5284.7 1810.5,-5284.7"/>
<polygon fill="black" stroke="black" points="1814,-5284.7 1810.5,-5274.7 1807,-5284.7 1814,-5284.7"/>
</g>
<!-- residual2_10 -->
<g id="node130" class="node">
<title>residual2_10</title>
<polygon fill="#fadbd8" stroke="black" points="1990.5,-4830.44 1775.5,-4830.44 1775.5,-4777.44 1990.5,-4777.44 1990.5,-4830.44"/>
<text text-anchor="middle" x="1883" y="-4815.24" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1883" y="-4800.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="1883" y="-4785.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_10&#45;&gt;residual2_10 -->
<g id="edge139" class="edge">
<title>residual1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M1920.25,-5332.17C1920.25,-5332.17 1920.25,-4840.44 1920.25,-4840.44"/>
<polygon fill="black" stroke="black" points="1923.75,-4840.44 1920.25,-4830.44 1916.75,-4840.44 1923.75,-4840.44"/>
</g>
<!-- ffn_up_10 -->
<g id="node127" class="node">
<title>ffn_up_10</title>
<polygon fill="#d4e6f1" stroke="black" points="1880,-5163.44 1650,-5163.44 1650,-5110.44 1880,-5110.44 1880,-5163.44"/>
<text text-anchor="middle" x="1765" y="-5148.24" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1765" y="-5133.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="1765" y="-5118.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_10&#45;&gt;ffn_up_10 -->
<g id="edge136" class="edge">
<title>ln2_10&#45;&gt;ffn_up_10</title>
<path fill="none" stroke="black" d="M1768,-5221.35C1768,-5221.35 1768,-5173.7 1768,-5173.7"/>
<polygon fill="black" stroke="black" points="1771.5,-5173.7 1768,-5163.7 1764.5,-5173.7 1771.5,-5173.7"/>
</g>
<!-- ffn_act_10 -->
<g id="node128" class="node">
<title>ffn_act_10</title>
<polygon fill="#d4e6f1" stroke="black" points="1880,-5052.44 1650,-5052.44 1650,-4999.44 1880,-4999.44 1880,-5052.44"/>
<text text-anchor="middle" x="1765" y="-5037.24" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1765" y="-5022.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="1765" y="-5007.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_10&#45;&gt;ffn_act_10 -->
<g id="edge137" class="edge">
<title>ffn_up_10&#45;&gt;ffn_act_10</title>
<path fill="none" stroke="black" d="M1765,-5110.35C1765,-5110.35 1765,-5062.7 1765,-5062.7"/>
<polygon fill="black" stroke="black" points="1768.5,-5062.7 1765,-5052.7 1761.5,-5062.7 1768.5,-5062.7"/>
</g>
<!-- ffn_down_10 -->
<g id="node129" class="node">
<title>ffn_down_10</title>
<polygon fill="#d4e6f1" stroke="black" points="1876.5,-4941.44 1661.5,-4941.44 1661.5,-4888.44 1876.5,-4888.44 1876.5,-4941.44"/>
<text text-anchor="middle" x="1769" y="-4926.24" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1769" y="-4911.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="1769" y="-4896.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_10&#45;&gt;ffn_down_10 -->
<g id="edge138" class="edge">
<title>ffn_act_10&#45;&gt;ffn_down_10</title>
<path fill="none" stroke="black" d="M1769,-4999.35C1769,-4999.35 1769,-4951.7 1769,-4951.7"/>
<polygon fill="black" stroke="black" points="1772.5,-4951.7 1769,-4941.7 1765.5,-4951.7 1772.5,-4951.7"/>
</g>
<!-- ffn_down_10&#45;&gt;residual2_10 -->
<g id="edge140" class="edge">
<title>ffn_down_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M1826,-4888.35C1826,-4888.35 1826,-4840.7 1826,-4840.7"/>
<polygon fill="black" stroke="black" points="1829.5,-4840.7 1826,-4830.7 1822.5,-4840.7 1829.5,-4840.7"/>
</g>
<!-- transfer_10 -->
<g id="node131" class="node">
<title>transfer_10</title>
<ellipse fill="#fadbd8" stroke="black" cx="1883" cy="-4692.57" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="1883" y="-4696.37" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 10</text>
<text text-anchor="middle" x="1883" y="-4681.37" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_10&#45;&gt;transfer_10 -->
<g id="edge141" class="edge">
<title>residual2_10&#45;&gt;transfer_10</title>
<path fill="none" stroke="black" d="M1883,-4777.26C1883,-4777.26 1883,-4729.8 1883,-4729.8"/>
<polygon fill="black" stroke="black" points="1886.5,-4729.8 1883,-4719.8 1879.5,-4729.8 1886.5,-4729.8"/>
</g>
<!-- residual1_11 -->
<g id="node138" class="node">
<title>residual1_11</title>
<polygon fill="#fadbd8" stroke="black" points="2138.5,-4607.7 1923.5,-4607.7 1923.5,-4554.7 2138.5,-4554.7 2138.5,-4607.7"/>
<text text-anchor="middle" x="2031" y="-4592.5" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2031" y="-4577.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="2031" y="-4562.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_10&#45;&gt;residual1_11 -->
<g id="edge147" class="edge">
<title>transfer_10&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M1979.26,-4671.62C1979.26,-4671.62 1979.26,-4617.97 1979.26,-4617.97"/>
<polygon fill="black" stroke="black" points="1982.76,-4617.97 1979.26,-4607.97 1975.76,-4617.97 1982.76,-4617.97"/>
</g>
<!-- ln1_11 -->
<g id="node132" class="node">
<title>ln1_11</title>
<polygon fill="#f8f9f9" stroke="black" points="2286.5,-5274.44 2071.5,-5274.44 2071.5,-5221.44 2286.5,-5221.44 2286.5,-5274.44"/>
<text text-anchor="middle" x="2179" y="-5259.24" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="2179" y="-5244.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="2179" y="-5229.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_11 -->
<g id="node133" class="node">
<title>attn_qkv_11</title>
<polygon fill="#ffe6cc" stroke="black" points="2294,-5163.44 2064,-5163.44 2064,-5110.44 2294,-5110.44 2294,-5163.44"/>
<text text-anchor="middle" x="2179" y="-5148.24" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2179" y="-5133.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="2179" y="-5118.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_11&#45;&gt;attn_qkv_11 -->
<g id="edge142" class="edge">
<title>ln1_11&#45;&gt;attn_qkv_11</title>
<path fill="none" stroke="black" d="M2179,-5221.35C2179,-5221.35 2179,-5173.7 2179,-5173.7"/>
<polygon fill="black" stroke="black" points="2182.5,-5173.7 2179,-5163.7 2175.5,-5173.7 2182.5,-5173.7"/>
</g>
<!-- attn_score_11 -->
<g id="node134" class="node">
<title>attn_score_11</title>
<polygon fill="#ffe6cc" stroke="black" points="2316.5,-5052.44 2041.5,-5052.44 2041.5,-4999.44 2316.5,-4999.44 2316.5,-5052.44"/>
<text text-anchor="middle" x="2179" y="-5037.24" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2179" y="-5022.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="2179" y="-5007.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_11&#45;&gt;attn_score_11 -->
<g id="edge143" class="edge">
<title>attn_qkv_11&#45;&gt;attn_score_11</title>
<path fill="none" stroke="black" d="M2179,-5110.35C2179,-5110.35 2179,-5062.7 2179,-5062.7"/>
<polygon fill="black" stroke="black" points="2182.5,-5062.7 2179,-5052.7 2175.5,-5062.7 2182.5,-5062.7"/>
</g>
<!-- attn_weight_11 -->
<g id="node135" class="node">
<title>attn_weight_11</title>
<polygon fill="#ffe6cc" stroke="black" points="2316.5,-4941.44 2041.5,-4941.44 2041.5,-4888.44 2316.5,-4888.44 2316.5,-4941.44"/>
<text text-anchor="middle" x="2179" y="-4926.24" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2179" y="-4911.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="2179" y="-4896.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_11&#45;&gt;attn_weight_11 -->
<g id="edge144" class="edge">
<title>attn_score_11&#45;&gt;attn_weight_11</title>
<path fill="none" stroke="black" d="M2179,-4999.35C2179,-4999.35 2179,-4951.7 2179,-4951.7"/>
<polygon fill="black" stroke="black" points="2182.5,-4951.7 2179,-4941.7 2175.5,-4951.7 2182.5,-4951.7"/>
</g>
<!-- attn_context_11 -->
<g id="node136" class="node">
<title>attn_context_11</title>
<polygon fill="#ffe6cc" stroke="black" points="2324,-4830.44 2034,-4830.44 2034,-4777.44 2324,-4777.44 2324,-4830.44"/>
<text text-anchor="middle" x="2179" y="-4815.24" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="2179" y="-4800.24" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="2179" y="-4785.24" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_11&#45;&gt;attn_context_11 -->
<g id="edge145" class="edge">
<title>attn_weight_11&#45;&gt;attn_context_11</title>
<path fill="none" stroke="black" d="M2179,-4888.35C2179,-4888.35 2179,-4840.7 2179,-4840.7"/>
<polygon fill="black" stroke="black" points="2182.5,-4840.7 2179,-4830.7 2175.5,-4840.7 2182.5,-4840.7"/>
</g>
<!-- attn_out_11 -->
<g id="node137" class="node">
<title>attn_out_11</title>
<polygon fill="#ffe6cc" stroke="black" points="2286.5,-4719.07 2071.5,-4719.07 2071.5,-4666.07 2286.5,-4666.07 2286.5,-4719.07"/>
<text text-anchor="middle" x="2179" y="-4703.87" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2179" y="-4688.87" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="2179" y="-4673.87" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_11&#45;&gt;attn_out_11 -->
<g id="edge146" class="edge">
<title>attn_context_11&#45;&gt;attn_out_11</title>
<path fill="none" stroke="black" d="M2179,-4777.26C2179,-4777.26 2179,-4729.41 2179,-4729.41"/>
<polygon fill="black" stroke="black" points="2182.5,-4729.41 2179,-4719.41 2175.5,-4729.41 2182.5,-4729.41"/>
</g>
<!-- attn_out_11&#45;&gt;residual1_11 -->
<g id="edge148" class="edge">
<title>attn_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M2105,-4665.89C2105,-4665.89 2105,-4618.04 2105,-4618.04"/>
<polygon fill="black" stroke="black" points="2108.5,-4618.04 2105,-4608.04 2101.5,-4618.04 2108.5,-4618.04"/>
</g>
<!-- ln2_11 -->
<g id="node139" class="node">
<title>ln2_11</title>
<polygon fill="#f8f9f9" stroke="black" points="2053.5,-4496.7 1838.5,-4496.7 1838.5,-4443.7 2053.5,-4443.7 2053.5,-4496.7"/>
<text text-anchor="middle" x="1946" y="-4481.5" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="1946" y="-4466.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1946" y="-4451.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge149" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M1988.5,-4554.61C1988.5,-4554.61 1988.5,-4506.96 1988.5,-4506.96"/>
<polygon fill="black" stroke="black" points="1992,-4506.96 1988.5,-4496.96 1985,-4506.96 1992,-4506.96"/>
</g>
<!-- residual2_11 -->
<g id="node143" class="node">
<title>residual2_11</title>
<polygon fill="#fadbd8" stroke="black" points="2168.5,-4052.7 1953.5,-4052.7 1953.5,-3999.7 2168.5,-3999.7 2168.5,-4052.7"/>
<text text-anchor="middle" x="2061" y="-4037.5" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2061" y="-4022.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="2061" y="-4007.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_11&#45;&gt;residual2_11 -->
<g id="edge153" class="edge">
<title>residual1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M2098.25,-4554.43C2098.25,-4554.43 2098.25,-4062.7 2098.25,-4062.7"/>
<polygon fill="black" stroke="black" points="2101.75,-4062.7 2098.25,-4052.7 2094.75,-4062.7 2101.75,-4062.7"/>
</g>
<!-- ffn_up_11 -->
<g id="node140" class="node">
<title>ffn_up_11</title>
<polygon fill="#d4e6f1" stroke="black" points="2058,-4385.7 1828,-4385.7 1828,-4332.7 2058,-4332.7 2058,-4385.7"/>
<text text-anchor="middle" x="1943" y="-4370.5" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1943" y="-4355.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1943" y="-4340.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_11&#45;&gt;ffn_up_11 -->
<g id="edge150" class="edge">
<title>ln2_11&#45;&gt;ffn_up_11</title>
<path fill="none" stroke="black" d="M1946,-4443.61C1946,-4443.61 1946,-4395.96 1946,-4395.96"/>
<polygon fill="black" stroke="black" points="1949.5,-4395.96 1946,-4385.96 1942.5,-4395.96 1949.5,-4395.96"/>
</g>
<!-- ffn_act_11 -->
<g id="node141" class="node">
<title>ffn_act_11</title>
<polygon fill="#d4e6f1" stroke="black" points="2058,-4274.7 1828,-4274.7 1828,-4221.7 2058,-4221.7 2058,-4274.7"/>
<text text-anchor="middle" x="1943" y="-4259.5" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1943" y="-4244.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1943" y="-4229.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_11&#45;&gt;ffn_act_11 -->
<g id="edge151" class="edge">
<title>ffn_up_11&#45;&gt;ffn_act_11</title>
<path fill="none" stroke="black" d="M1943,-4332.61C1943,-4332.61 1943,-4284.96 1943,-4284.96"/>
<polygon fill="black" stroke="black" points="1946.5,-4284.96 1943,-4274.96 1939.5,-4284.96 1946.5,-4284.96"/>
</g>
<!-- ffn_down_11 -->
<g id="node142" class="node">
<title>ffn_down_11</title>
<polygon fill="#d4e6f1" stroke="black" points="2054.5,-4163.7 1839.5,-4163.7 1839.5,-4110.7 2054.5,-4110.7 2054.5,-4163.7"/>
<text text-anchor="middle" x="1947" y="-4148.5" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1947" y="-4133.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="1947" y="-4118.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_11&#45;&gt;ffn_down_11 -->
<g id="edge152" class="edge">
<title>ffn_act_11&#45;&gt;ffn_down_11</title>
<path fill="none" stroke="black" d="M1947,-4221.61C1947,-4221.61 1947,-4173.96 1947,-4173.96"/>
<polygon fill="black" stroke="black" points="1950.5,-4173.96 1947,-4163.96 1943.5,-4173.96 1950.5,-4173.96"/>
</g>
<!-- ffn_down_11&#45;&gt;residual2_11 -->
<g id="edge154" class="edge">
<title>ffn_down_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M2004,-4110.61C2004,-4110.61 2004,-4062.96 2004,-4062.96"/>
<polygon fill="black" stroke="black" points="2007.5,-4062.96 2004,-4052.96 2000.5,-4062.96 2007.5,-4062.96"/>
</g>
<!-- transfer_11 -->
<g id="node144" class="node">
<title>transfer_11</title>
<ellipse fill="#fadbd8" stroke="black" cx="2061" cy="-3914.83" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="2061" y="-3918.63" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 11</text>
<text text-anchor="middle" x="2061" y="-3903.63" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_11&#45;&gt;transfer_11 -->
<g id="edge155" class="edge">
<title>residual2_11&#45;&gt;transfer_11</title>
<path fill="none" stroke="black" d="M2061,-3999.52C2061,-3999.52 2061,-3952.06 2061,-3952.06"/>
<polygon fill="black" stroke="black" points="2064.5,-3952.06 2061,-3942.06 2057.5,-3952.06 2064.5,-3952.06"/>
</g>
<!-- residual1_12 -->
<g id="node151" class="node">
<title>residual1_12</title>
<polygon fill="#fadbd8" stroke="black" points="2316.5,-3829.96 2101.5,-3829.96 2101.5,-3776.96 2316.5,-3776.96 2316.5,-3829.96"/>
<text text-anchor="middle" x="2209" y="-3814.76" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2209" y="-3799.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2209" y="-3784.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_11&#45;&gt;residual1_12 -->
<g id="edge161" class="edge">
<title>transfer_11&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M2157.26,-3893.88C2157.26,-3893.88 2157.26,-3840.23 2157.26,-3840.23"/>
<polygon fill="black" stroke="black" points="2160.76,-3840.23 2157.26,-3830.23 2153.76,-3840.23 2160.76,-3840.23"/>
</g>
<!-- ln1_12 -->
<g id="node145" class="node">
<title>ln1_12</title>
<polygon fill="#f8f9f9" stroke="black" points="2464.5,-4496.7 2249.5,-4496.7 2249.5,-4443.7 2464.5,-4443.7 2464.5,-4496.7"/>
<text text-anchor="middle" x="2357" y="-4481.5" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="2357" y="-4466.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2357" y="-4451.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_12 -->
<g id="node146" class="node">
<title>attn_qkv_12</title>
<polygon fill="#ffe6cc" stroke="black" points="2472,-4385.7 2242,-4385.7 2242,-4332.7 2472,-4332.7 2472,-4385.7"/>
<text text-anchor="middle" x="2357" y="-4370.5" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2357" y="-4355.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2357" y="-4340.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_12&#45;&gt;attn_qkv_12 -->
<g id="edge156" class="edge">
<title>ln1_12&#45;&gt;attn_qkv_12</title>
<path fill="none" stroke="black" d="M2357,-4443.61C2357,-4443.61 2357,-4395.96 2357,-4395.96"/>
<polygon fill="black" stroke="black" points="2360.5,-4395.96 2357,-4385.96 2353.5,-4395.96 2360.5,-4395.96"/>
</g>
<!-- attn_score_12 -->
<g id="node147" class="node">
<title>attn_score_12</title>
<polygon fill="#ffe6cc" stroke="black" points="2494.5,-4274.7 2219.5,-4274.7 2219.5,-4221.7 2494.5,-4221.7 2494.5,-4274.7"/>
<text text-anchor="middle" x="2357" y="-4259.5" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2357" y="-4244.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2357" y="-4229.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_12&#45;&gt;attn_score_12 -->
<g id="edge157" class="edge">
<title>attn_qkv_12&#45;&gt;attn_score_12</title>
<path fill="none" stroke="black" d="M2357,-4332.61C2357,-4332.61 2357,-4284.96 2357,-4284.96"/>
<polygon fill="black" stroke="black" points="2360.5,-4284.96 2357,-4274.96 2353.5,-4284.96 2360.5,-4284.96"/>
</g>
<!-- attn_weight_12 -->
<g id="node148" class="node">
<title>attn_weight_12</title>
<polygon fill="#ffe6cc" stroke="black" points="2494.5,-4163.7 2219.5,-4163.7 2219.5,-4110.7 2494.5,-4110.7 2494.5,-4163.7"/>
<text text-anchor="middle" x="2357" y="-4148.5" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2357" y="-4133.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2357" y="-4118.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_12&#45;&gt;attn_weight_12 -->
<g id="edge158" class="edge">
<title>attn_score_12&#45;&gt;attn_weight_12</title>
<path fill="none" stroke="black" d="M2357,-4221.61C2357,-4221.61 2357,-4173.96 2357,-4173.96"/>
<polygon fill="black" stroke="black" points="2360.5,-4173.96 2357,-4163.96 2353.5,-4173.96 2360.5,-4173.96"/>
</g>
<!-- attn_context_12 -->
<g id="node149" class="node">
<title>attn_context_12</title>
<polygon fill="#ffe6cc" stroke="black" points="2502,-4052.7 2212,-4052.7 2212,-3999.7 2502,-3999.7 2502,-4052.7"/>
<text text-anchor="middle" x="2357" y="-4037.5" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="2357" y="-4022.5" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2357" y="-4007.5" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_12&#45;&gt;attn_context_12 -->
<g id="edge159" class="edge">
<title>attn_weight_12&#45;&gt;attn_context_12</title>
<path fill="none" stroke="black" d="M2357,-4110.61C2357,-4110.61 2357,-4062.96 2357,-4062.96"/>
<polygon fill="black" stroke="black" points="2360.5,-4062.96 2357,-4052.96 2353.5,-4062.96 2360.5,-4062.96"/>
</g>
<!-- attn_out_12 -->
<g id="node150" class="node">
<title>attn_out_12</title>
<polygon fill="#ffe6cc" stroke="black" points="2464.5,-3941.33 2249.5,-3941.33 2249.5,-3888.33 2464.5,-3888.33 2464.5,-3941.33"/>
<text text-anchor="middle" x="2357" y="-3926.13" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2357" y="-3911.13" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2357" y="-3896.13" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_12&#45;&gt;attn_out_12 -->
<g id="edge160" class="edge">
<title>attn_context_12&#45;&gt;attn_out_12</title>
<path fill="none" stroke="black" d="M2357,-3999.52C2357,-3999.52 2357,-3951.67 2357,-3951.67"/>
<polygon fill="black" stroke="black" points="2360.5,-3951.67 2357,-3941.67 2353.5,-3951.67 2360.5,-3951.67"/>
</g>
<!-- attn_out_12&#45;&gt;residual1_12 -->
<g id="edge162" class="edge">
<title>attn_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M2283,-3888.15C2283,-3888.15 2283,-3840.3 2283,-3840.3"/>
<polygon fill="black" stroke="black" points="2286.5,-3840.3 2283,-3830.3 2279.5,-3840.3 2286.5,-3840.3"/>
</g>
<!-- ln2_12 -->
<g id="node152" class="node">
<title>ln2_12</title>
<polygon fill="#f8f9f9" stroke="black" points="2231.5,-3718.96 2016.5,-3718.96 2016.5,-3665.96 2231.5,-3665.96 2231.5,-3718.96"/>
<text text-anchor="middle" x="2124" y="-3703.76" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="2124" y="-3688.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2124" y="-3673.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge163" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M2166.5,-3776.87C2166.5,-3776.87 2166.5,-3729.22 2166.5,-3729.22"/>
<polygon fill="black" stroke="black" points="2170,-3729.22 2166.5,-3719.22 2163,-3729.22 2170,-3729.22"/>
</g>
<!-- residual2_12 -->
<g id="node156" class="node">
<title>residual2_12</title>
<polygon fill="#fadbd8" stroke="black" points="2346.5,-3274.96 2131.5,-3274.96 2131.5,-3221.96 2346.5,-3221.96 2346.5,-3274.96"/>
<text text-anchor="middle" x="2239" y="-3259.76" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2239" y="-3244.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2239" y="-3229.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_12&#45;&gt;residual2_12 -->
<g id="edge167" class="edge">
<title>residual1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M2276.25,-3776.69C2276.25,-3776.69 2276.25,-3284.96 2276.25,-3284.96"/>
<polygon fill="black" stroke="black" points="2279.75,-3284.96 2276.25,-3274.96 2272.75,-3284.96 2279.75,-3284.96"/>
</g>
<!-- ffn_up_12 -->
<g id="node153" class="node">
<title>ffn_up_12</title>
<polygon fill="#d4e6f1" stroke="black" points="2236,-3607.96 2006,-3607.96 2006,-3554.96 2236,-3554.96 2236,-3607.96"/>
<text text-anchor="middle" x="2121" y="-3592.76" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2121" y="-3577.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2121" y="-3562.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_12&#45;&gt;ffn_up_12 -->
<g id="edge164" class="edge">
<title>ln2_12&#45;&gt;ffn_up_12</title>
<path fill="none" stroke="black" d="M2124,-3665.87C2124,-3665.87 2124,-3618.22 2124,-3618.22"/>
<polygon fill="black" stroke="black" points="2127.5,-3618.22 2124,-3608.22 2120.5,-3618.22 2127.5,-3618.22"/>
</g>
<!-- ffn_act_12 -->
<g id="node154" class="node">
<title>ffn_act_12</title>
<polygon fill="#d4e6f1" stroke="black" points="2236,-3496.96 2006,-3496.96 2006,-3443.96 2236,-3443.96 2236,-3496.96"/>
<text text-anchor="middle" x="2121" y="-3481.76" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2121" y="-3466.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2121" y="-3451.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_12&#45;&gt;ffn_act_12 -->
<g id="edge165" class="edge">
<title>ffn_up_12&#45;&gt;ffn_act_12</title>
<path fill="none" stroke="black" d="M2121,-3554.87C2121,-3554.87 2121,-3507.22 2121,-3507.22"/>
<polygon fill="black" stroke="black" points="2124.5,-3507.22 2121,-3497.22 2117.5,-3507.22 2124.5,-3507.22"/>
</g>
<!-- ffn_down_12 -->
<g id="node155" class="node">
<title>ffn_down_12</title>
<polygon fill="#d4e6f1" stroke="black" points="2232.5,-3385.96 2017.5,-3385.96 2017.5,-3332.96 2232.5,-3332.96 2232.5,-3385.96"/>
<text text-anchor="middle" x="2125" y="-3370.76" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2125" y="-3355.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="2125" y="-3340.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_12&#45;&gt;ffn_down_12 -->
<g id="edge166" class="edge">
<title>ffn_act_12&#45;&gt;ffn_down_12</title>
<path fill="none" stroke="black" d="M2125,-3443.87C2125,-3443.87 2125,-3396.22 2125,-3396.22"/>
<polygon fill="black" stroke="black" points="2128.5,-3396.22 2125,-3386.22 2121.5,-3396.22 2128.5,-3396.22"/>
</g>
<!-- ffn_down_12&#45;&gt;residual2_12 -->
<g id="edge168" class="edge">
<title>ffn_down_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M2182,-3332.87C2182,-3332.87 2182,-3285.22 2182,-3285.22"/>
<polygon fill="black" stroke="black" points="2185.5,-3285.22 2182,-3275.22 2178.5,-3285.22 2185.5,-3285.22"/>
</g>
<!-- transfer_12 -->
<g id="node157" class="node">
<title>transfer_12</title>
<ellipse fill="#fadbd8" stroke="black" cx="2239" cy="-3137.09" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="2239" y="-3140.89" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 12</text>
<text text-anchor="middle" x="2239" y="-3125.89" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_12&#45;&gt;transfer_12 -->
<g id="edge169" class="edge">
<title>residual2_12&#45;&gt;transfer_12</title>
<path fill="none" stroke="black" d="M2239,-3221.78C2239,-3221.78 2239,-3174.32 2239,-3174.32"/>
<polygon fill="black" stroke="black" points="2242.5,-3174.32 2239,-3164.32 2235.5,-3174.32 2242.5,-3174.32"/>
</g>
<!-- residual1_13 -->
<g id="node164" class="node">
<title>residual1_13</title>
<polygon fill="#fadbd8" stroke="black" points="2494.5,-3052.22 2279.5,-3052.22 2279.5,-2999.22 2494.5,-2999.22 2494.5,-3052.22"/>
<text text-anchor="middle" x="2387" y="-3037.02" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2387" y="-3022.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2387" y="-3007.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_12&#45;&gt;residual1_13 -->
<g id="edge175" class="edge">
<title>transfer_12&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M2335.26,-3116.14C2335.26,-3116.14 2335.26,-3062.49 2335.26,-3062.49"/>
<polygon fill="black" stroke="black" points="2338.76,-3062.49 2335.26,-3052.49 2331.76,-3062.49 2338.76,-3062.49"/>
</g>
<!-- ln1_13 -->
<g id="node158" class="node">
<title>ln1_13</title>
<polygon fill="#f8f9f9" stroke="black" points="2642.5,-3718.96 2427.5,-3718.96 2427.5,-3665.96 2642.5,-3665.96 2642.5,-3718.96"/>
<text text-anchor="middle" x="2535" y="-3703.76" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="2535" y="-3688.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2535" y="-3673.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_13 -->
<g id="node159" class="node">
<title>attn_qkv_13</title>
<polygon fill="#ffe6cc" stroke="black" points="2650,-3607.96 2420,-3607.96 2420,-3554.96 2650,-3554.96 2650,-3607.96"/>
<text text-anchor="middle" x="2535" y="-3592.76" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2535" y="-3577.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2535" y="-3562.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_13&#45;&gt;attn_qkv_13 -->
<g id="edge170" class="edge">
<title>ln1_13&#45;&gt;attn_qkv_13</title>
<path fill="none" stroke="black" d="M2535,-3665.87C2535,-3665.87 2535,-3618.22 2535,-3618.22"/>
<polygon fill="black" stroke="black" points="2538.5,-3618.22 2535,-3608.22 2531.5,-3618.22 2538.5,-3618.22"/>
</g>
<!-- attn_score_13 -->
<g id="node160" class="node">
<title>attn_score_13</title>
<polygon fill="#ffe6cc" stroke="black" points="2672.5,-3496.96 2397.5,-3496.96 2397.5,-3443.96 2672.5,-3443.96 2672.5,-3496.96"/>
<text text-anchor="middle" x="2535" y="-3481.76" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2535" y="-3466.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2535" y="-3451.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_13&#45;&gt;attn_score_13 -->
<g id="edge171" class="edge">
<title>attn_qkv_13&#45;&gt;attn_score_13</title>
<path fill="none" stroke="black" d="M2535,-3554.87C2535,-3554.87 2535,-3507.22 2535,-3507.22"/>
<polygon fill="black" stroke="black" points="2538.5,-3507.22 2535,-3497.22 2531.5,-3507.22 2538.5,-3507.22"/>
</g>
<!-- attn_weight_13 -->
<g id="node161" class="node">
<title>attn_weight_13</title>
<polygon fill="#ffe6cc" stroke="black" points="2672.5,-3385.96 2397.5,-3385.96 2397.5,-3332.96 2672.5,-3332.96 2672.5,-3385.96"/>
<text text-anchor="middle" x="2535" y="-3370.76" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2535" y="-3355.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2535" y="-3340.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_13&#45;&gt;attn_weight_13 -->
<g id="edge172" class="edge">
<title>attn_score_13&#45;&gt;attn_weight_13</title>
<path fill="none" stroke="black" d="M2535,-3443.87C2535,-3443.87 2535,-3396.22 2535,-3396.22"/>
<polygon fill="black" stroke="black" points="2538.5,-3396.22 2535,-3386.22 2531.5,-3396.22 2538.5,-3396.22"/>
</g>
<!-- attn_context_13 -->
<g id="node162" class="node">
<title>attn_context_13</title>
<polygon fill="#ffe6cc" stroke="black" points="2680,-3274.96 2390,-3274.96 2390,-3221.96 2680,-3221.96 2680,-3274.96"/>
<text text-anchor="middle" x="2535" y="-3259.76" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="2535" y="-3244.76" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2535" y="-3229.76" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_13&#45;&gt;attn_context_13 -->
<g id="edge173" class="edge">
<title>attn_weight_13&#45;&gt;attn_context_13</title>
<path fill="none" stroke="black" d="M2535,-3332.87C2535,-3332.87 2535,-3285.22 2535,-3285.22"/>
<polygon fill="black" stroke="black" points="2538.5,-3285.22 2535,-3275.22 2531.5,-3285.22 2538.5,-3285.22"/>
</g>
<!-- attn_out_13 -->
<g id="node163" class="node">
<title>attn_out_13</title>
<polygon fill="#ffe6cc" stroke="black" points="2642.5,-3163.59 2427.5,-3163.59 2427.5,-3110.59 2642.5,-3110.59 2642.5,-3163.59"/>
<text text-anchor="middle" x="2535" y="-3148.39" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2535" y="-3133.39" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2535" y="-3118.39" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_13&#45;&gt;attn_out_13 -->
<g id="edge174" class="edge">
<title>attn_context_13&#45;&gt;attn_out_13</title>
<path fill="none" stroke="black" d="M2535,-3221.78C2535,-3221.78 2535,-3173.93 2535,-3173.93"/>
<polygon fill="black" stroke="black" points="2538.5,-3173.93 2535,-3163.93 2531.5,-3173.93 2538.5,-3173.93"/>
</g>
<!-- attn_out_13&#45;&gt;residual1_13 -->
<g id="edge176" class="edge">
<title>attn_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M2461,-3110.41C2461,-3110.41 2461,-3062.56 2461,-3062.56"/>
<polygon fill="black" stroke="black" points="2464.5,-3062.56 2461,-3052.56 2457.5,-3062.56 2464.5,-3062.56"/>
</g>
<!-- ln2_13 -->
<g id="node165" class="node">
<title>ln2_13</title>
<polygon fill="#f8f9f9" stroke="black" points="2409.5,-2941.22 2194.5,-2941.22 2194.5,-2888.22 2409.5,-2888.22 2409.5,-2941.22"/>
<text text-anchor="middle" x="2302" y="-2926.02" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="2302" y="-2911.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2302" y="-2896.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge177" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M2344.5,-2999.13C2344.5,-2999.13 2344.5,-2951.48 2344.5,-2951.48"/>
<polygon fill="black" stroke="black" points="2348,-2951.48 2344.5,-2941.48 2341,-2951.48 2348,-2951.48"/>
</g>
<!-- residual2_13 -->
<g id="node169" class="node">
<title>residual2_13</title>
<polygon fill="#fadbd8" stroke="black" points="2524.5,-2497.22 2309.5,-2497.22 2309.5,-2444.22 2524.5,-2444.22 2524.5,-2497.22"/>
<text text-anchor="middle" x="2417" y="-2482.02" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2417" y="-2467.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2417" y="-2452.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_13&#45;&gt;residual2_13 -->
<g id="edge181" class="edge">
<title>residual1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M2454.25,-2998.95C2454.25,-2998.95 2454.25,-2507.22 2454.25,-2507.22"/>
<polygon fill="black" stroke="black" points="2457.75,-2507.22 2454.25,-2497.22 2450.75,-2507.22 2457.75,-2507.22"/>
</g>
<!-- ffn_up_13 -->
<g id="node166" class="node">
<title>ffn_up_13</title>
<polygon fill="#d4e6f1" stroke="black" points="2414,-2830.22 2184,-2830.22 2184,-2777.22 2414,-2777.22 2414,-2830.22"/>
<text text-anchor="middle" x="2299" y="-2815.02" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2299" y="-2800.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2299" y="-2785.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_13&#45;&gt;ffn_up_13 -->
<g id="edge178" class="edge">
<title>ln2_13&#45;&gt;ffn_up_13</title>
<path fill="none" stroke="black" d="M2302,-2888.13C2302,-2888.13 2302,-2840.48 2302,-2840.48"/>
<polygon fill="black" stroke="black" points="2305.5,-2840.48 2302,-2830.48 2298.5,-2840.48 2305.5,-2840.48"/>
</g>
<!-- ffn_act_13 -->
<g id="node167" class="node">
<title>ffn_act_13</title>
<polygon fill="#d4e6f1" stroke="black" points="2414,-2719.22 2184,-2719.22 2184,-2666.22 2414,-2666.22 2414,-2719.22"/>
<text text-anchor="middle" x="2299" y="-2704.02" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2299" y="-2689.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2299" y="-2674.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_13&#45;&gt;ffn_act_13 -->
<g id="edge179" class="edge">
<title>ffn_up_13&#45;&gt;ffn_act_13</title>
<path fill="none" stroke="black" d="M2299,-2777.13C2299,-2777.13 2299,-2729.48 2299,-2729.48"/>
<polygon fill="black" stroke="black" points="2302.5,-2729.48 2299,-2719.48 2295.5,-2729.48 2302.5,-2729.48"/>
</g>
<!-- ffn_down_13 -->
<g id="node168" class="node">
<title>ffn_down_13</title>
<polygon fill="#d4e6f1" stroke="black" points="2410.5,-2608.22 2195.5,-2608.22 2195.5,-2555.22 2410.5,-2555.22 2410.5,-2608.22"/>
<text text-anchor="middle" x="2303" y="-2593.02" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2303" y="-2578.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="2303" y="-2563.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_13&#45;&gt;ffn_down_13 -->
<g id="edge180" class="edge">
<title>ffn_act_13&#45;&gt;ffn_down_13</title>
<path fill="none" stroke="black" d="M2303,-2666.13C2303,-2666.13 2303,-2618.48 2303,-2618.48"/>
<polygon fill="black" stroke="black" points="2306.5,-2618.48 2303,-2608.48 2299.5,-2618.48 2306.5,-2618.48"/>
</g>
<!-- ffn_down_13&#45;&gt;residual2_13 -->
<g id="edge182" class="edge">
<title>ffn_down_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M2360,-2555.13C2360,-2555.13 2360,-2507.48 2360,-2507.48"/>
<polygon fill="black" stroke="black" points="2363.5,-2507.48 2360,-2497.48 2356.5,-2507.48 2363.5,-2507.48"/>
</g>
<!-- transfer_13 -->
<g id="node170" class="node">
<title>transfer_13</title>
<ellipse fill="#fadbd8" stroke="black" cx="2417" cy="-2359.35" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="2417" y="-2363.15" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 13</text>
<text text-anchor="middle" x="2417" y="-2348.15" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_13&#45;&gt;transfer_13 -->
<g id="edge183" class="edge">
<title>residual2_13&#45;&gt;transfer_13</title>
<path fill="none" stroke="black" d="M2417,-2444.04C2417,-2444.04 2417,-2396.58 2417,-2396.58"/>
<polygon fill="black" stroke="black" points="2420.5,-2396.58 2417,-2386.58 2413.5,-2396.58 2420.5,-2396.58"/>
</g>
<!-- residual1_14 -->
<g id="node177" class="node">
<title>residual1_14</title>
<polygon fill="#fadbd8" stroke="black" points="2672.5,-2274.48 2457.5,-2274.48 2457.5,-2221.48 2672.5,-2221.48 2672.5,-2274.48"/>
<text text-anchor="middle" x="2565" y="-2259.28" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2565" y="-2244.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2565" y="-2229.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_13&#45;&gt;residual1_14 -->
<g id="edge189" class="edge">
<title>transfer_13&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M2513.26,-2338.4C2513.26,-2338.4 2513.26,-2284.75 2513.26,-2284.75"/>
<polygon fill="black" stroke="black" points="2516.76,-2284.75 2513.26,-2274.75 2509.76,-2284.75 2516.76,-2284.75"/>
</g>
<!-- ln1_14 -->
<g id="node171" class="node">
<title>ln1_14</title>
<polygon fill="#f8f9f9" stroke="black" points="2820.5,-2941.22 2605.5,-2941.22 2605.5,-2888.22 2820.5,-2888.22 2820.5,-2941.22"/>
<text text-anchor="middle" x="2713" y="-2926.02" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="2713" y="-2911.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2713" y="-2896.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_14 -->
<g id="node172" class="node">
<title>attn_qkv_14</title>
<polygon fill="#ffe6cc" stroke="black" points="2828,-2830.22 2598,-2830.22 2598,-2777.22 2828,-2777.22 2828,-2830.22"/>
<text text-anchor="middle" x="2713" y="-2815.02" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2713" y="-2800.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2713" y="-2785.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_14&#45;&gt;attn_qkv_14 -->
<g id="edge184" class="edge">
<title>ln1_14&#45;&gt;attn_qkv_14</title>
<path fill="none" stroke="black" d="M2713,-2888.13C2713,-2888.13 2713,-2840.48 2713,-2840.48"/>
<polygon fill="black" stroke="black" points="2716.5,-2840.48 2713,-2830.48 2709.5,-2840.48 2716.5,-2840.48"/>
</g>
<!-- attn_score_14 -->
<g id="node173" class="node">
<title>attn_score_14</title>
<polygon fill="#ffe6cc" stroke="black" points="2850.5,-2719.22 2575.5,-2719.22 2575.5,-2666.22 2850.5,-2666.22 2850.5,-2719.22"/>
<text text-anchor="middle" x="2713" y="-2704.02" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2713" y="-2689.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2713" y="-2674.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_14&#45;&gt;attn_score_14 -->
<g id="edge185" class="edge">
<title>attn_qkv_14&#45;&gt;attn_score_14</title>
<path fill="none" stroke="black" d="M2713,-2777.13C2713,-2777.13 2713,-2729.48 2713,-2729.48"/>
<polygon fill="black" stroke="black" points="2716.5,-2729.48 2713,-2719.48 2709.5,-2729.48 2716.5,-2729.48"/>
</g>
<!-- attn_weight_14 -->
<g id="node174" class="node">
<title>attn_weight_14</title>
<polygon fill="#ffe6cc" stroke="black" points="2850.5,-2608.22 2575.5,-2608.22 2575.5,-2555.22 2850.5,-2555.22 2850.5,-2608.22"/>
<text text-anchor="middle" x="2713" y="-2593.02" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2713" y="-2578.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2713" y="-2563.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_14&#45;&gt;attn_weight_14 -->
<g id="edge186" class="edge">
<title>attn_score_14&#45;&gt;attn_weight_14</title>
<path fill="none" stroke="black" d="M2713,-2666.13C2713,-2666.13 2713,-2618.48 2713,-2618.48"/>
<polygon fill="black" stroke="black" points="2716.5,-2618.48 2713,-2608.48 2709.5,-2618.48 2716.5,-2618.48"/>
</g>
<!-- attn_context_14 -->
<g id="node175" class="node">
<title>attn_context_14</title>
<polygon fill="#ffe6cc" stroke="black" points="2858,-2497.22 2568,-2497.22 2568,-2444.22 2858,-2444.22 2858,-2497.22"/>
<text text-anchor="middle" x="2713" y="-2482.02" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="2713" y="-2467.02" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2713" y="-2452.02" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_14&#45;&gt;attn_context_14 -->
<g id="edge187" class="edge">
<title>attn_weight_14&#45;&gt;attn_context_14</title>
<path fill="none" stroke="black" d="M2713,-2555.13C2713,-2555.13 2713,-2507.48 2713,-2507.48"/>
<polygon fill="black" stroke="black" points="2716.5,-2507.48 2713,-2497.48 2709.5,-2507.48 2716.5,-2507.48"/>
</g>
<!-- attn_out_14 -->
<g id="node176" class="node">
<title>attn_out_14</title>
<polygon fill="#ffe6cc" stroke="black" points="2820.5,-2385.85 2605.5,-2385.85 2605.5,-2332.85 2820.5,-2332.85 2820.5,-2385.85"/>
<text text-anchor="middle" x="2713" y="-2370.65" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2713" y="-2355.65" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2713" y="-2340.65" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_14&#45;&gt;attn_out_14 -->
<g id="edge188" class="edge">
<title>attn_context_14&#45;&gt;attn_out_14</title>
<path fill="none" stroke="black" d="M2713,-2444.04C2713,-2444.04 2713,-2396.19 2713,-2396.19"/>
<polygon fill="black" stroke="black" points="2716.5,-2396.19 2713,-2386.19 2709.5,-2396.19 2716.5,-2396.19"/>
</g>
<!-- attn_out_14&#45;&gt;residual1_14 -->
<g id="edge190" class="edge">
<title>attn_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M2639,-2332.67C2639,-2332.67 2639,-2284.82 2639,-2284.82"/>
<polygon fill="black" stroke="black" points="2642.5,-2284.82 2639,-2274.82 2635.5,-2284.82 2642.5,-2284.82"/>
</g>
<!-- ln2_14 -->
<g id="node178" class="node">
<title>ln2_14</title>
<polygon fill="#f8f9f9" stroke="black" points="2591.5,-2163.48 2376.5,-2163.48 2376.5,-2110.48 2591.5,-2110.48 2591.5,-2163.48"/>
<text text-anchor="middle" x="2484" y="-2148.28" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="2484" y="-2133.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2484" y="-2118.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge191" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M2524.5,-2221.39C2524.5,-2221.39 2524.5,-2173.74 2524.5,-2173.74"/>
<polygon fill="black" stroke="black" points="2528,-2173.74 2524.5,-2163.74 2521,-2173.74 2528,-2173.74"/>
</g>
<!-- residual2_14 -->
<g id="node182" class="node">
<title>residual2_14</title>
<polygon fill="#fadbd8" stroke="black" points="2705.5,-1719.48 2490.5,-1719.48 2490.5,-1666.48 2705.5,-1666.48 2705.5,-1719.48"/>
<text text-anchor="middle" x="2598" y="-1704.28" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2598" y="-1689.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2598" y="-1674.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_14&#45;&gt;residual2_14 -->
<g id="edge195" class="edge">
<title>residual1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M2633.75,-2221.21C2633.75,-2221.21 2633.75,-1729.48 2633.75,-1729.48"/>
<polygon fill="black" stroke="black" points="2637.25,-1729.48 2633.75,-1719.48 2630.25,-1729.48 2637.25,-1729.48"/>
</g>
<!-- ffn_up_14 -->
<g id="node179" class="node">
<title>ffn_up_14</title>
<polygon fill="#d4e6f1" stroke="black" points="2595,-2052.48 2365,-2052.48 2365,-1999.48 2595,-1999.48 2595,-2052.48"/>
<text text-anchor="middle" x="2480" y="-2037.28" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2480" y="-2022.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2480" y="-2007.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_14&#45;&gt;ffn_up_14 -->
<g id="edge192" class="edge">
<title>ln2_14&#45;&gt;ffn_up_14</title>
<path fill="none" stroke="black" d="M2484,-2110.39C2484,-2110.39 2484,-2062.74 2484,-2062.74"/>
<polygon fill="black" stroke="black" points="2487.5,-2062.74 2484,-2052.74 2480.5,-2062.74 2487.5,-2062.74"/>
</g>
<!-- ffn_act_14 -->
<g id="node180" class="node">
<title>ffn_act_14</title>
<polygon fill="#d4e6f1" stroke="black" points="2595,-1941.48 2365,-1941.48 2365,-1888.48 2595,-1888.48 2595,-1941.48"/>
<text text-anchor="middle" x="2480" y="-1926.28" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2480" y="-1911.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2480" y="-1896.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_14&#45;&gt;ffn_act_14 -->
<g id="edge193" class="edge">
<title>ffn_up_14&#45;&gt;ffn_act_14</title>
<path fill="none" stroke="black" d="M2480,-1999.39C2480,-1999.39 2480,-1951.74 2480,-1951.74"/>
<polygon fill="black" stroke="black" points="2483.5,-1951.74 2480,-1941.74 2476.5,-1951.74 2483.5,-1951.74"/>
</g>
<!-- ffn_down_14 -->
<g id="node181" class="node">
<title>ffn_down_14</title>
<polygon fill="#d4e6f1" stroke="black" points="2591.5,-1830.48 2376.5,-1830.48 2376.5,-1777.48 2591.5,-1777.48 2591.5,-1830.48"/>
<text text-anchor="middle" x="2484" y="-1815.28" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2484" y="-1800.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="2484" y="-1785.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_14&#45;&gt;ffn_down_14 -->
<g id="edge194" class="edge">
<title>ffn_act_14&#45;&gt;ffn_down_14</title>
<path fill="none" stroke="black" d="M2484,-1888.39C2484,-1888.39 2484,-1840.74 2484,-1840.74"/>
<polygon fill="black" stroke="black" points="2487.5,-1840.74 2484,-1830.74 2480.5,-1840.74 2487.5,-1840.74"/>
</g>
<!-- ffn_down_14&#45;&gt;residual2_14 -->
<g id="edge196" class="edge">
<title>ffn_down_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M2541,-1777.39C2541,-1777.39 2541,-1729.74 2541,-1729.74"/>
<polygon fill="black" stroke="black" points="2544.5,-1729.74 2541,-1719.74 2537.5,-1729.74 2544.5,-1729.74"/>
</g>
<!-- transfer_14 -->
<g id="node183" class="node">
<title>transfer_14</title>
<ellipse fill="#fadbd8" stroke="black" cx="2598" cy="-1581.61" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="2598" y="-1585.41" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 14</text>
<text text-anchor="middle" x="2598" y="-1570.41" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_14&#45;&gt;transfer_14 -->
<g id="edge197" class="edge">
<title>residual2_14&#45;&gt;transfer_14</title>
<path fill="none" stroke="black" d="M2598,-1666.3C2598,-1666.3 2598,-1618.84 2598,-1618.84"/>
<polygon fill="black" stroke="black" points="2601.5,-1618.84 2598,-1608.84 2594.5,-1618.84 2601.5,-1618.84"/>
</g>
<!-- residual1_15 -->
<g id="node190" class="node">
<title>residual1_15</title>
<polygon fill="#fadbd8" stroke="black" points="2853.5,-1496.74 2638.5,-1496.74 2638.5,-1443.74 2853.5,-1443.74 2853.5,-1496.74"/>
<text text-anchor="middle" x="2746" y="-1481.54" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2746" y="-1466.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2746" y="-1451.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_14&#45;&gt;residual1_15 -->
<g id="edge203" class="edge">
<title>transfer_14&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M2694.26,-1560.66C2694.26,-1560.66 2694.26,-1507.01 2694.26,-1507.01"/>
<polygon fill="black" stroke="black" points="2697.76,-1507.01 2694.26,-1497.01 2690.76,-1507.01 2697.76,-1507.01"/>
</g>
<!-- ln1_15 -->
<g id="node184" class="node">
<title>ln1_15</title>
<polygon fill="#f8f9f9" stroke="black" points="3001.5,-2163.48 2786.5,-2163.48 2786.5,-2110.48 3001.5,-2110.48 3001.5,-2163.48"/>
<text text-anchor="middle" x="2894" y="-2148.28" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="2894" y="-2133.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2894" y="-2118.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_15 -->
<g id="node185" class="node">
<title>attn_qkv_15</title>
<polygon fill="#ffe6cc" stroke="black" points="3009,-2052.48 2779,-2052.48 2779,-1999.48 3009,-1999.48 3009,-2052.48"/>
<text text-anchor="middle" x="2894" y="-2037.28" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2894" y="-2022.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2894" y="-2007.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_15&#45;&gt;attn_qkv_15 -->
<g id="edge198" class="edge">
<title>ln1_15&#45;&gt;attn_qkv_15</title>
<path fill="none" stroke="black" d="M2894,-2110.39C2894,-2110.39 2894,-2062.74 2894,-2062.74"/>
<polygon fill="black" stroke="black" points="2897.5,-2062.74 2894,-2052.74 2890.5,-2062.74 2897.5,-2062.74"/>
</g>
<!-- attn_score_15 -->
<g id="node186" class="node">
<title>attn_score_15</title>
<polygon fill="#ffe6cc" stroke="black" points="3031.5,-1941.48 2756.5,-1941.48 2756.5,-1888.48 3031.5,-1888.48 3031.5,-1941.48"/>
<text text-anchor="middle" x="2894" y="-1926.28" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2894" y="-1911.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2894" y="-1896.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_15&#45;&gt;attn_score_15 -->
<g id="edge199" class="edge">
<title>attn_qkv_15&#45;&gt;attn_score_15</title>
<path fill="none" stroke="black" d="M2894,-1999.39C2894,-1999.39 2894,-1951.74 2894,-1951.74"/>
<polygon fill="black" stroke="black" points="2897.5,-1951.74 2894,-1941.74 2890.5,-1951.74 2897.5,-1951.74"/>
</g>
<!-- attn_weight_15 -->
<g id="node187" class="node">
<title>attn_weight_15</title>
<polygon fill="#ffe6cc" stroke="black" points="3031.5,-1830.48 2756.5,-1830.48 2756.5,-1777.48 3031.5,-1777.48 3031.5,-1830.48"/>
<text text-anchor="middle" x="2894" y="-1815.28" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="2894" y="-1800.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2894" y="-1785.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_15&#45;&gt;attn_weight_15 -->
<g id="edge200" class="edge">
<title>attn_score_15&#45;&gt;attn_weight_15</title>
<path fill="none" stroke="black" d="M2894,-1888.39C2894,-1888.39 2894,-1840.74 2894,-1840.74"/>
<polygon fill="black" stroke="black" points="2897.5,-1840.74 2894,-1830.74 2890.5,-1840.74 2897.5,-1840.74"/>
</g>
<!-- attn_context_15 -->
<g id="node188" class="node">
<title>attn_context_15</title>
<polygon fill="#ffe6cc" stroke="black" points="3039,-1719.48 2749,-1719.48 2749,-1666.48 3039,-1666.48 3039,-1719.48"/>
<text text-anchor="middle" x="2894" y="-1704.28" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="2894" y="-1689.28" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2894" y="-1674.28" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_15&#45;&gt;attn_context_15 -->
<g id="edge201" class="edge">
<title>attn_weight_15&#45;&gt;attn_context_15</title>
<path fill="none" stroke="black" d="M2894,-1777.39C2894,-1777.39 2894,-1729.74 2894,-1729.74"/>
<polygon fill="black" stroke="black" points="2897.5,-1729.74 2894,-1719.74 2890.5,-1729.74 2897.5,-1729.74"/>
</g>
<!-- attn_out_15 -->
<g id="node189" class="node">
<title>attn_out_15</title>
<polygon fill="#ffe6cc" stroke="black" points="3001.5,-1608.11 2786.5,-1608.11 2786.5,-1555.11 3001.5,-1555.11 3001.5,-1608.11"/>
<text text-anchor="middle" x="2894" y="-1592.91" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2894" y="-1577.91" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2894" y="-1562.91" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_15&#45;&gt;attn_out_15 -->
<g id="edge202" class="edge">
<title>attn_context_15&#45;&gt;attn_out_15</title>
<path fill="none" stroke="black" d="M2894,-1666.3C2894,-1666.3 2894,-1618.45 2894,-1618.45"/>
<polygon fill="black" stroke="black" points="2897.5,-1618.45 2894,-1608.45 2890.5,-1618.45 2897.5,-1618.45"/>
</g>
<!-- attn_out_15&#45;&gt;residual1_15 -->
<g id="edge204" class="edge">
<title>attn_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M2820,-1554.93C2820,-1554.93 2820,-1507.08 2820,-1507.08"/>
<polygon fill="black" stroke="black" points="2823.5,-1507.08 2820,-1497.08 2816.5,-1507.08 2823.5,-1507.08"/>
</g>
<!-- ln2_15 -->
<g id="node191" class="node">
<title>ln2_15</title>
<polygon fill="#f8f9f9" stroke="black" points="2768.5,-1385.74 2553.5,-1385.74 2553.5,-1332.74 2768.5,-1332.74 2768.5,-1385.74"/>
<text text-anchor="middle" x="2661" y="-1370.54" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="2661" y="-1355.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2661" y="-1340.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge205" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M2703.5,-1443.65C2703.5,-1443.65 2703.5,-1396 2703.5,-1396"/>
<polygon fill="black" stroke="black" points="2707,-1396 2703.5,-1386 2700,-1396 2707,-1396"/>
</g>
<!-- residual2_15 -->
<g id="node195" class="node">
<title>residual2_15</title>
<polygon fill="#fadbd8" stroke="black" points="2883.5,-941.74 2668.5,-941.74 2668.5,-888.74 2883.5,-888.74 2883.5,-941.74"/>
<text text-anchor="middle" x="2776" y="-926.54" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2776" y="-911.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2776" y="-896.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_15&#45;&gt;residual2_15 -->
<g id="edge209" class="edge">
<title>residual1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M2813.25,-1443.47C2813.25,-1443.47 2813.25,-951.74 2813.25,-951.74"/>
<polygon fill="black" stroke="black" points="2816.75,-951.74 2813.25,-941.74 2809.75,-951.74 2816.75,-951.74"/>
</g>
<!-- ffn_up_15 -->
<g id="node192" class="node">
<title>ffn_up_15</title>
<polygon fill="#d4e6f1" stroke="black" points="2773,-1274.74 2543,-1274.74 2543,-1221.74 2773,-1221.74 2773,-1274.74"/>
<text text-anchor="middle" x="2658" y="-1259.54" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2658" y="-1244.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2658" y="-1229.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_15&#45;&gt;ffn_up_15 -->
<g id="edge206" class="edge">
<title>ln2_15&#45;&gt;ffn_up_15</title>
<path fill="none" stroke="black" d="M2661,-1332.65C2661,-1332.65 2661,-1285 2661,-1285"/>
<polygon fill="black" stroke="black" points="2664.5,-1285 2661,-1275 2657.5,-1285 2664.5,-1285"/>
</g>
<!-- ffn_act_15 -->
<g id="node193" class="node">
<title>ffn_act_15</title>
<polygon fill="#d4e6f1" stroke="black" points="2773,-1163.74 2543,-1163.74 2543,-1110.74 2773,-1110.74 2773,-1163.74"/>
<text text-anchor="middle" x="2658" y="-1148.54" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2658" y="-1133.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2658" y="-1118.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_15&#45;&gt;ffn_act_15 -->
<g id="edge207" class="edge">
<title>ffn_up_15&#45;&gt;ffn_act_15</title>
<path fill="none" stroke="black" d="M2658,-1221.65C2658,-1221.65 2658,-1174 2658,-1174"/>
<polygon fill="black" stroke="black" points="2661.5,-1174 2658,-1164 2654.5,-1174 2661.5,-1174"/>
</g>
<!-- ffn_down_15 -->
<g id="node194" class="node">
<title>ffn_down_15</title>
<polygon fill="#d4e6f1" stroke="black" points="2769.5,-1052.74 2554.5,-1052.74 2554.5,-999.74 2769.5,-999.74 2769.5,-1052.74"/>
<text text-anchor="middle" x="2662" y="-1037.54" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2662" y="-1022.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="2662" y="-1007.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_15&#45;&gt;ffn_down_15 -->
<g id="edge208" class="edge">
<title>ffn_act_15&#45;&gt;ffn_down_15</title>
<path fill="none" stroke="black" d="M2662,-1110.65C2662,-1110.65 2662,-1063 2662,-1063"/>
<polygon fill="black" stroke="black" points="2665.5,-1063 2662,-1053 2658.5,-1063 2665.5,-1063"/>
</g>
<!-- ffn_down_15&#45;&gt;residual2_15 -->
<g id="edge210" class="edge">
<title>ffn_down_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M2719,-999.65C2719,-999.65 2719,-952 2719,-952"/>
<polygon fill="black" stroke="black" points="2722.5,-952 2719,-942 2715.5,-952 2722.5,-952"/>
</g>
<!-- transfer_15 -->
<g id="node196" class="node">
<title>transfer_15</title>
<ellipse fill="#fadbd8" stroke="black" cx="2776" cy="-803.87" rx="152.06" ry="26.74"/>
<text text-anchor="middle" x="2776" y="-807.67" font-family="Helvetica,sans-Serif" font-size="14.00">Transfer to GPU 15</text>
<text text-anchor="middle" x="2776" y="-792.67" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual2_15&#45;&gt;transfer_15 -->
<g id="edge211" class="edge">
<title>residual2_15&#45;&gt;transfer_15</title>
<path fill="none" stroke="black" d="M2776,-888.56C2776,-888.56 2776,-841.1 2776,-841.1"/>
<polygon fill="black" stroke="black" points="2779.5,-841.1 2776,-831.1 2772.5,-841.1 2779.5,-841.1"/>
</g>
<!-- residual1_16 -->
<g id="node203" class="node">
<title>residual1_16</title>
<polygon fill="#fadbd8" stroke="black" points="3031.5,-719 2816.5,-719 2816.5,-666 3031.5,-666 3031.5,-719"/>
<text text-anchor="middle" x="2924" y="-703.8" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2924" y="-688.8" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="2924" y="-673.8" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- transfer_15&#45;&gt;residual1_16 -->
<g id="edge217" class="edge">
<title>transfer_15&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M2872.26,-782.92C2872.26,-782.92 2872.26,-729.27 2872.26,-729.27"/>
<polygon fill="black" stroke="black" points="2875.76,-729.27 2872.26,-719.27 2868.76,-729.27 2875.76,-729.27"/>
</g>
<!-- ln1_16 -->
<g id="node197" class="node">
<title>ln1_16</title>
<polygon fill="#f8f9f9" stroke="black" points="3179.5,-1385.74 2964.5,-1385.74 2964.5,-1332.74 3179.5,-1332.74 3179.5,-1385.74"/>
<text text-anchor="middle" x="3072" y="-1370.54" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;Attn)</text>
<text text-anchor="middle" x="3072" y="-1355.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="3072" y="-1340.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_qkv_16 -->
<g id="node198" class="node">
<title>attn_qkv_16</title>
<polygon fill="#ffe6cc" stroke="black" points="3187,-1274.74 2957,-1274.74 2957,-1221.74 3187,-1221.74 3187,-1274.74"/>
<text text-anchor="middle" x="3072" y="-1259.54" font-family="Helvetica,sans-Serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3072" y="-1244.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="3072" y="-1229.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 3*hidden_dim]</text>
</g>
<!-- ln1_16&#45;&gt;attn_qkv_16 -->
<g id="edge212" class="edge">
<title>ln1_16&#45;&gt;attn_qkv_16</title>
<path fill="none" stroke="black" d="M3072,-1332.65C3072,-1332.65 3072,-1285 3072,-1285"/>
<polygon fill="black" stroke="black" points="3075.5,-1285 3072,-1275 3068.5,-1285 3075.5,-1285"/>
</g>
<!-- attn_score_16 -->
<g id="node199" class="node">
<title>attn_score_16</title>
<polygon fill="#ffe6cc" stroke="black" points="3209.5,-1163.74 2934.5,-1163.74 2934.5,-1110.74 3209.5,-1110.74 3209.5,-1163.74"/>
<text text-anchor="middle" x="3072" y="-1148.54" font-family="Helvetica,sans-Serif" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3072" y="-1133.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="3072" y="-1118.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_qkv_16&#45;&gt;attn_score_16 -->
<g id="edge213" class="edge">
<title>attn_qkv_16&#45;&gt;attn_score_16</title>
<path fill="none" stroke="black" d="M3072,-1221.65C3072,-1221.65 3072,-1174 3072,-1174"/>
<polygon fill="black" stroke="black" points="3075.5,-1174 3072,-1164 3068.5,-1174 3075.5,-1174"/>
</g>
<!-- attn_weight_16 -->
<g id="node200" class="node">
<title>attn_weight_16</title>
<polygon fill="#ffe6cc" stroke="black" points="3209.5,-1052.74 2934.5,-1052.74 2934.5,-999.74 3209.5,-999.74 3209.5,-1052.74"/>
<text text-anchor="middle" x="3072" y="-1037.54" font-family="Helvetica,sans-Serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3072" y="-1022.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="3072" y="-1007.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, seq_len]</text>
</g>
<!-- attn_score_16&#45;&gt;attn_weight_16 -->
<g id="edge214" class="edge">
<title>attn_score_16&#45;&gt;attn_weight_16</title>
<path fill="none" stroke="black" d="M3072,-1110.65C3072,-1110.65 3072,-1063 3072,-1063"/>
<polygon fill="black" stroke="black" points="3075.5,-1063 3072,-1053 3068.5,-1063 3075.5,-1063"/>
</g>
<!-- attn_context_16 -->
<g id="node201" class="node">
<title>attn_context_16</title>
<polygon fill="#ffe6cc" stroke="black" points="3217,-941.74 2927,-941.74 2927,-888.74 3217,-888.74 3217,-941.74"/>
<text text-anchor="middle" x="3072" y="-926.54" font-family="Helvetica,sans-Serif" font-size="14.00">Context</text>
<text text-anchor="middle" x="3072" y="-911.54" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="3072" y="-896.54" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, num_heads, seq_len, head_dim]</text>
</g>
<!-- attn_weight_16&#45;&gt;attn_context_16 -->
<g id="edge215" class="edge">
<title>attn_weight_16&#45;&gt;attn_context_16</title>
<path fill="none" stroke="black" d="M3072,-999.65C3072,-999.65 3072,-952 3072,-952"/>
<polygon fill="black" stroke="black" points="3075.5,-952 3072,-942 3068.5,-952 3075.5,-952"/>
</g>
<!-- attn_out_16 -->
<g id="node202" class="node">
<title>attn_out_16</title>
<polygon fill="#ffe6cc" stroke="black" points="3179.5,-830.37 2964.5,-830.37 2964.5,-777.37 3179.5,-777.37 3179.5,-830.37"/>
<text text-anchor="middle" x="3072" y="-815.17" font-family="Helvetica,sans-Serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="3072" y="-800.17" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="3072" y="-785.17" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- attn_context_16&#45;&gt;attn_out_16 -->
<g id="edge216" class="edge">
<title>attn_context_16&#45;&gt;attn_out_16</title>
<path fill="none" stroke="black" d="M3072,-888.56C3072,-888.56 3072,-840.71 3072,-840.71"/>
<polygon fill="black" stroke="black" points="3075.5,-840.71 3072,-830.71 3068.5,-840.71 3075.5,-840.71"/>
</g>
<!-- attn_out_16&#45;&gt;residual1_16 -->
<g id="edge218" class="edge">
<title>attn_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M2998,-777.19C2998,-777.19 2998,-729.34 2998,-729.34"/>
<polygon fill="black" stroke="black" points="3001.5,-729.34 2998,-719.34 2994.5,-729.34 3001.5,-729.34"/>
</g>
<!-- ln2_16 -->
<g id="node204" class="node">
<title>ln2_16</title>
<polygon fill="#f8f9f9" stroke="black" points="2950.5,-608 2735.5,-608 2735.5,-555 2950.5,-555 2950.5,-608"/>
<text text-anchor="middle" x="2843" y="-592.8" font-family="Helvetica,sans-Serif" font-size="14.00">LayerNorm (Pre&#45;FFN)</text>
<text text-anchor="middle" x="2843" y="-577.8" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="2843" y="-562.8" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_16&#45;&gt;ln2_16 -->
<g id="edge219" class="edge">
<title>residual1_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M2883.5,-665.91C2883.5,-665.91 2883.5,-618.26 2883.5,-618.26"/>
<polygon fill="black" stroke="black" points="2887,-618.25 2883.5,-608.26 2880,-618.26 2887,-618.25"/>
</g>
<!-- residual2_16 -->
<g id="node208" class="node">
<title>residual2_16</title>
<polygon fill="#fadbd8" stroke="black" points="3031.5,-164 2816.5,-164 2816.5,-111 3031.5,-111 3031.5,-164"/>
<text text-anchor="middle" x="2924" y="-148.8" font-family="Helvetica,sans-Serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2924" y="-133.8" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="2924" y="-118.8" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- residual1_16&#45;&gt;residual2_16 -->
<g id="edge223" class="edge">
<title>residual1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M2992.75,-665.73C2992.75,-665.73 2992.75,-174 2992.75,-174"/>
<polygon fill="black" stroke="black" points="2996.25,-174 2992.75,-164 2989.25,-174 2996.25,-174"/>
</g>
<!-- ffn_up_16 -->
<g id="node205" class="node">
<title>ffn_up_16</title>
<polygon fill="#d4e6f1" stroke="black" points="2954,-497 2724,-497 2724,-444 2954,-444 2954,-497"/>
<text text-anchor="middle" x="2839" y="-481.8" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2839" y="-466.8" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="2839" y="-451.8" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ln2_16&#45;&gt;ffn_up_16 -->
<g id="edge220" class="edge">
<title>ln2_16&#45;&gt;ffn_up_16</title>
<path fill="none" stroke="black" d="M2843,-554.91C2843,-554.91 2843,-507.26 2843,-507.26"/>
<polygon fill="black" stroke="black" points="2846.5,-507.25 2843,-497.26 2839.5,-507.26 2846.5,-507.25"/>
</g>
<!-- ffn_act_16 -->
<g id="node206" class="node">
<title>ffn_act_16</title>
<polygon fill="#d4e6f1" stroke="black" points="2954,-386 2724,-386 2724,-333 2954,-333 2954,-386"/>
<text text-anchor="middle" x="2839" y="-370.8" font-family="Helvetica,sans-Serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2839" y="-355.8" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="2839" y="-340.8" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
</g>
<!-- ffn_up_16&#45;&gt;ffn_act_16 -->
<g id="edge221" class="edge">
<title>ffn_up_16&#45;&gt;ffn_act_16</title>
<path fill="none" stroke="black" d="M2839,-443.91C2839,-443.91 2839,-396.26 2839,-396.26"/>
<polygon fill="black" stroke="black" points="2842.5,-396.25 2839,-386.26 2835.5,-396.26 2842.5,-396.25"/>
</g>
<!-- ffn_down_16 -->
<g id="node207" class="node">
<title>ffn_down_16</title>
<polygon fill="#d4e6f1" stroke="black" points="2950.5,-275 2735.5,-275 2735.5,-222 2950.5,-222 2950.5,-275"/>
<text text-anchor="middle" x="2843" y="-259.8" font-family="Helvetica,sans-Serif" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2843" y="-244.8" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="2843" y="-229.8" font-family="Helvetica,sans-Serif" font-size="14.00">[1024, seq_len, hidden_dim]</text>
</g>
<!-- ffn_act_16&#45;&gt;ffn_down_16 -->
<g id="edge222" class="edge">
<title>ffn_act_16&#45;&gt;ffn_down_16</title>
<path fill="none" stroke="black" d="M2843,-332.91C2843,-332.91 2843,-285.26 2843,-285.26"/>
<polygon fill="black" stroke="black" points="2846.5,-285.25 2843,-275.26 2839.5,-285.26 2846.5,-285.25"/>
</g>
<!-- ffn_down_16&#45;&gt;residual2_16 -->
<g id="edge224" class="edge">
<title>ffn_down_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M2883.5,-221.91C2883.5,-221.91 2883.5,-174.26 2883.5,-174.26"/>
<polygon fill="black" stroke="black" points="2887,-174.25 2883.5,-164.26 2880,-174.26 2887,-174.25"/>
</g>
<!-- output -->
<g id="node209" class="node">
<title>output</title>
<polygon fill="#d5f4e6" stroke="black" points="3057,-53 2791,-53 2791,0 3057,0 3057,-53"/>
<text text-anchor="middle" x="2924" y="-37.8" font-family="Helvetica,sans-Serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="2924" y="-22.8" font-family="Helvetica,sans-Serif" font-size="14.00">[batch=1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2924" y="-7.8" font-family="Helvetica,sans-Serif" font-size="14.00">GPU: 15</text>
</g>
<!-- residual2_16&#45;&gt;output -->
<g id="edge225" class="edge">
<title>residual2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2924,-110.91C2924,-110.91 2924,-63.26 2924,-63.26"/>
<polygon fill="black" stroke="black" points="2927.5,-63.25 2924,-53.26 2920.5,-63.26 2927.5,-63.25"/>
</g>
</g>
</svg>
