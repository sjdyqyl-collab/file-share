<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Dense_Model_DAG Pages: 1 -->
<svg width="158pt" height="1440pt"
 viewBox="0.00 0.00 158.36 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 25218.79)">
<title>Dense_Model_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-25218.79 2769.77,-25218.79 2769.77,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="white" stroke="black" cx="2504.77" cy="-25177.31" rx="218.49" ry="37.45"/>
<text text-anchor="middle" x="2504.77" y="-25188.61" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="2504.77" y="-25173.61" font-family="Times,serif" font-size="14.00">[Batch=1024, Seq=2048, Hidden=8192]</text>
<text text-anchor="middle" x="2504.77" y="-25158.61" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="lightblue" stroke="black" points="2468.77,-25102.84 2324.77,-25102.84 2324.77,-25049.84 2468.77,-25049.84 2468.77,-25102.84"/>
<text text-anchor="middle" x="2396.77" y="-25087.64" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2396.77" y="-25072.64" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2396.77" y="-25057.64" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M2465.47,-25140.3C2454.6,-25130.34 2442.87,-25119.59 2432.23,-25109.84"/>
<polygon fill="black" stroke="black" points="2434.44,-25107.11 2424.7,-25102.94 2429.71,-25112.27 2434.44,-25107.11"/>
</g>
<!-- residual1_1 -->
<g id="node6" class="node">
<title>residual1_1</title>
<polygon fill="lightblue" stroke="black" points="2472.77,-24504.79 2179.77,-24451.79 2472.77,-24398.79 2765.77,-24451.79 2472.77,-24504.79"/>
<text text-anchor="middle" x="2472.77" y="-24463.09" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="2472.77" y="-24448.09" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="2472.77" y="-24433.09" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge6" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2533.27,-25139.92C2544.5,-25122.08 2554.77,-25099.67 2554.77,-25077.34 2554.77,-25077.34 2554.77,-25077.34 2554.77,-24608.79 2554.77,-24571.75 2536.43,-24534.86 2517.1,-24506.26"/>
<polygon fill="black" stroke="black" points="2519.96,-24504.24 2511.37,-24498.04 2514.22,-24508.25 2519.96,-24504.24"/>
<text text-anchor="middle" x="2583.77" y="-24847.64" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_1 -->
<g id="node3" class="node">
<title>qkv_proj_1</title>
<polygon fill="lightblue" stroke="black" points="2526.31,-25012.84 2043.45,-25012.84 1919.23,-24876.84 2402.09,-24876.84 2526.31,-25012.84"/>
<text text-anchor="middle" x="2222.77" y="-24963.64" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2222.77" y="-24948.64" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="2222.77" y="-24933.64" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="2222.77" y="-24918.64" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_1&#45;&gt;qkv_proj_1 -->
<g id="edge2" class="edge">
<title>ln1_1&#45;&gt;qkv_proj_1</title>
<path fill="none" stroke="black" d="M2362.39,-25049.75C2350.27,-25040.73 2335.98,-25030.09 2321.23,-25019.12"/>
<polygon fill="black" stroke="black" points="2323.12,-25016.16 2313,-25012.99 2318.94,-25021.77 2323.12,-25016.16"/>
</g>
<!-- mha_1 -->
<g id="node4" class="node">
<title>mha_1</title>
<polygon fill="lightblue" stroke="black" points="2465.24,-24770.31 2345.5,-24825.86 2106.04,-24825.86 1986.3,-24770.31 2106.04,-24714.77 2345.5,-24714.77 2465.24,-24770.31"/>
<text text-anchor="middle" x="2225.77" y="-24789.11" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2225.77" y="-24774.11" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="2225.77" y="-24759.11" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2225.77" y="-24744.11" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- qkv_proj_1&#45;&gt;mha_1 -->
<g id="edge3" class="edge">
<title>qkv_proj_1&#45;&gt;mha_1</title>
<path fill="none" stroke="black" d="M2223.94,-24876.64C2224.17,-24863.43 2224.41,-24849.58 2224.64,-24836.44"/>
<polygon fill="black" stroke="black" points="2228.14,-24836.13 2224.82,-24826.07 2221.14,-24836.01 2228.14,-24836.13"/>
</g>
<!-- out_proj_1 -->
<g id="node5" class="node">
<title>out_proj_1</title>
<polygon fill="lightblue" stroke="black" points="2526.14,-24677.79 2057.86,-24677.79 1937.39,-24541.79 2405.68,-24541.79 2526.14,-24677.79"/>
<text text-anchor="middle" x="2231.77" y="-24628.59" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2231.77" y="-24613.59" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2231.77" y="-24598.59" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="2231.77" y="-24583.59" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_1&#45;&gt;out_proj_1 -->
<g id="edge4" class="edge">
<title>mha_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M2227.83,-24714.76C2228.16,-24706.17 2228.5,-24697.15 2228.84,-24688.16"/>
<polygon fill="black" stroke="black" points="2232.34,-24688.18 2229.22,-24678.06 2225.35,-24687.92 2232.34,-24688.18"/>
</g>
<!-- out_proj_1&#45;&gt;residual1_1 -->
<g id="edge5" class="edge">
<title>out_proj_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M2335.37,-24541.73C2357.69,-24527.29 2380.79,-24512.33 2401.54,-24498.9"/>
<polygon fill="black" stroke="black" points="2403.48,-24501.81 2409.97,-24493.44 2399.67,-24495.94 2403.48,-24501.81"/>
</g>
<!-- ln2_1 -->
<g id="node7" class="node">
<title>ln2_1</title>
<polygon fill="lightblue" stroke="black" points="2469.77,-24361.79 2325.77,-24361.79 2325.77,-24308.79 2469.77,-24308.79 2469.77,-24361.79"/>
<text text-anchor="middle" x="2397.77" y="-24346.59" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2397.77" y="-24331.59" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2397.77" y="-24316.59" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge7" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M2442.26,-24404.22C2434.85,-24392.9 2427.06,-24381.01 2420.1,-24370.39"/>
<polygon fill="black" stroke="black" points="2422.89,-24368.26 2414.48,-24361.81 2417.04,-24372.09 2422.89,-24368.26"/>
</g>
<!-- residual2_1 -->
<g id="node11" class="node">
<title>residual2_1</title>
<polygon fill="lightblue" stroke="black" points="2465.77,-23799.84 2172.77,-23746.84 2465.77,-23693.84 2758.77,-23746.84 2465.77,-23799.84"/>
<text text-anchor="middle" x="2465.77" y="-23758.14" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="2465.77" y="-23743.14" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="2465.77" y="-23728.14" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge12" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2523.2,-24407.63C2540.58,-24388.01 2555.77,-24363.18 2555.77,-24336.29 2555.77,-24336.29 2555.77,-24336.29 2555.77,-23903.84 2555.77,-23865.99 2535.65,-23829.05 2514.43,-23800.63"/>
<polygon fill="black" stroke="black" points="2517.01,-23798.25 2508.13,-23792.47 2511.47,-23802.53 2517.01,-23798.25"/>
<text text-anchor="middle" x="2584.77" y="-24106.59" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_1 -->
<g id="node8" class="node">
<title>mlp_fc1_1</title>
<polygon fill="lightblue" stroke="black" points="2527.31,-24271.79 2044.45,-24271.79 1920.23,-24135.79 2403.09,-24135.79 2527.31,-24271.79"/>
<text text-anchor="middle" x="2223.77" y="-24222.59" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="2223.77" y="-24207.59" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="2223.77" y="-24192.59" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="2223.77" y="-24177.59" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_1&#45;&gt;mlp_fc1_1 -->
<g id="edge8" class="edge">
<title>ln2_1&#45;&gt;mlp_fc1_1</title>
<path fill="none" stroke="black" d="M2363.39,-24308.71C2351.27,-24299.69 2336.98,-24289.05 2322.23,-24278.07"/>
<polygon fill="black" stroke="black" points="2324.12,-24275.11 2314,-24271.95 2319.94,-24280.73 2324.12,-24275.11"/>
</g>
<!-- gelu_1 -->
<g id="node9" class="node">
<title>gelu_1</title>
<ellipse fill="lightblue" stroke="black" cx="2223.77" cy="-24047.32" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="2223.77" y="-24058.62" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2223.77" y="-24043.62" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="2223.77" y="-24028.62" font-family="Times,serif" font-size="14.00">GPU0</text>
</g>
<!-- mlp_fc1_1&#45;&gt;gelu_1 -->
<g id="edge9" class="edge">
<title>mlp_fc1_1&#45;&gt;gelu_1</title>
<path fill="none" stroke="black" d="M2223.77,-24135.49C2223.77,-24121.89 2223.77,-24107.88 2223.77,-24095.18"/>
<polygon fill="black" stroke="black" points="2227.27,-24094.85 2223.77,-24084.85 2220.27,-24094.85 2227.27,-24094.85"/>
</g>
<!-- mlp_fc2_1 -->
<g id="node10" class="node">
<title>mlp_fc2_1</title>
<polygon fill="lightblue" stroke="black" points="2527.31,-23972.84 2044.45,-23972.84 1920.23,-23836.84 2403.09,-23836.84 2527.31,-23972.84"/>
<text text-anchor="middle" x="2223.77" y="-23923.64" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="2223.77" y="-23908.64" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2223.77" y="-23893.64" font-family="Times,serif" font-size="14.00">GPU0</text>
<text text-anchor="middle" x="2223.77" y="-23878.64" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_1&#45;&gt;mlp_fc2_1 -->
<g id="edge10" class="edge">
<title>gelu_1&#45;&gt;mlp_fc2_1</title>
<path fill="none" stroke="black" d="M2223.77,-24009.77C2223.77,-24001.48 2223.77,-23992.36 2223.77,-23983.07"/>
<polygon fill="black" stroke="black" points="2227.27,-23982.96 2223.77,-23972.96 2220.27,-23982.96 2227.27,-23982.96"/>
</g>
<!-- mlp_fc2_1&#45;&gt;residual2_1 -->
<g id="edge11" class="edge">
<title>mlp_fc2_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M2327.8,-23836.78C2350.21,-23822.33 2373.41,-23807.38 2394.24,-23793.95"/>
<polygon fill="black" stroke="black" points="2396.2,-23796.85 2402.71,-23788.49 2392.41,-23790.97 2396.2,-23796.85"/>
</g>
<!-- comm_1 -->
<g id="node12" class="node">
<title>comm_1</title>
<polygon fill="yellow" stroke="black" points="2583.51,-23595.45 2583.51,-23629.1 2514.54,-23652.9 2417,-23652.9 2348.03,-23629.1 2348.03,-23595.45 2417,-23571.65 2514.54,-23571.65 2583.51,-23595.45"/>
<polygon fill="none" stroke="black" points="2587.5,-23592.59 2587.5,-23631.96 2515.21,-23656.9 2416.33,-23656.9 2344.04,-23631.96 2344.04,-23592.59 2416.33,-23567.65 2515.21,-23567.65 2587.5,-23592.59"/>
<text text-anchor="middle" x="2465.77" y="-23623.57" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="2465.77" y="-23608.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2465.77" y="-23593.57" font-family="Times,serif" font-size="14.00">GPU0→GPU1</text>
</g>
<!-- residual2_1&#45;&gt;comm_1 -->
<g id="edge13" class="edge">
<title>residual2_1&#45;&gt;comm_1</title>
<path fill="none" stroke="black" d="M2465.77,-23693.83C2465.77,-23685.07 2465.77,-23675.96 2465.77,-23667.16"/>
<polygon fill="black" stroke="black" points="2469.27,-23667 2465.77,-23657 2462.27,-23667 2469.27,-23667"/>
</g>
<!-- ln1_2 -->
<g id="node13" class="node">
<title>ln1_2</title>
<polygon fill="lightcoral" stroke="black" points="2458.77,-23530.71 2314.77,-23530.71 2314.77,-23477.71 2458.77,-23477.71 2458.77,-23530.71"/>
<text text-anchor="middle" x="2386.77" y="-23515.51" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2386.77" y="-23500.51" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2386.77" y="-23485.51" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- comm_1&#45;&gt;ln1_2 -->
<g id="edge14" class="edge">
<title>comm_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M2433.18,-23567.52C2426.09,-23558 2418.69,-23548.06 2411.93,-23538.99"/>
<polygon fill="black" stroke="black" points="2414.72,-23536.88 2405.94,-23530.95 2409.1,-23541.06 2414.72,-23536.88"/>
</g>
<!-- residual1_2 -->
<g id="node17" class="node">
<title>residual1_2</title>
<polygon fill="lightcoral" stroke="black" points="2383.77,-22932.67 2090.77,-22879.67 2383.77,-22826.67 2676.77,-22879.67 2383.77,-22932.67"/>
<text text-anchor="middle" x="2383.77" y="-22890.97" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="2383.77" y="-22875.97" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="2383.77" y="-22860.97" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- comm_1&#45;&gt;residual1_2 -->
<g id="edge19" class="edge">
<title>comm_1&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2516.92,-23567.99C2532.1,-23550.44 2544.77,-23528.75 2544.77,-23505.21 2544.77,-23505.21 2544.77,-23505.21 2544.77,-23036.67 2544.77,-23005.59 2543.55,-22994.43 2524.77,-22969.67 2511.05,-22951.59 2492.52,-22936.23 2473.39,-22923.63"/>
<polygon fill="black" stroke="black" points="2475.2,-22920.63 2464.88,-22918.22 2471.44,-22926.54 2475.2,-22920.63"/>
<text text-anchor="middle" x="2573.77" y="-23275.51" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_2 -->
<g id="node14" class="node">
<title>qkv_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="2516.31,-23440.71 2033.45,-23440.71 1909.23,-23304.71 2392.09,-23304.71 2516.31,-23440.71"/>
<text text-anchor="middle" x="2212.77" y="-23391.51" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2212.77" y="-23376.51" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="2212.77" y="-23361.51" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="2212.77" y="-23346.51" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_2&#45;&gt;qkv_proj_2 -->
<g id="edge15" class="edge">
<title>ln1_2&#45;&gt;qkv_proj_2</title>
<path fill="none" stroke="black" d="M2352.39,-23477.63C2340.27,-23468.61 2325.98,-23457.97 2311.23,-23446.99"/>
<polygon fill="black" stroke="black" points="2313.12,-23444.03 2303,-23440.87 2308.94,-23449.65 2313.12,-23444.03"/>
</g>
<!-- mha_2 -->
<g id="node15" class="node">
<title>mha_2</title>
<polygon fill="lightcoral" stroke="black" points="2458.24,-23198.19 2338.5,-23253.73 2099.04,-23253.73 1979.3,-23198.19 2099.04,-23142.65 2338.5,-23142.65 2458.24,-23198.19"/>
<text text-anchor="middle" x="2218.77" y="-23216.99" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2218.77" y="-23201.99" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="2218.77" y="-23186.99" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2218.77" y="-23171.99" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- qkv_proj_2&#45;&gt;mha_2 -->
<g id="edge16" class="edge">
<title>qkv_proj_2&#45;&gt;mha_2</title>
<path fill="none" stroke="black" d="M2215.11,-23304.52C2215.57,-23291.3 2216.05,-23277.46 2216.5,-23264.31"/>
<polygon fill="black" stroke="black" points="2220.01,-23264.06 2216.86,-23253.95 2213.02,-23263.82 2220.01,-23264.06"/>
</g>
<!-- out_proj_2 -->
<g id="node16" class="node">
<title>out_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="2516.14,-23105.67 2047.86,-23105.67 1927.39,-22969.67 2395.68,-22969.67 2516.14,-23105.67"/>
<text text-anchor="middle" x="2221.77" y="-23056.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2221.77" y="-23041.47" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2221.77" y="-23026.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="2221.77" y="-23011.47" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_2&#45;&gt;out_proj_2 -->
<g id="edge17" class="edge">
<title>mha_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M2219.8,-23142.63C2219.96,-23134.05 2220.13,-23125.03 2220.3,-23116.04"/>
<polygon fill="black" stroke="black" points="2223.81,-23115.99 2220.5,-23105.93 2216.81,-23115.86 2223.81,-23115.99"/>
</g>
<!-- out_proj_2&#45;&gt;residual1_2 -->
<g id="edge18" class="edge">
<title>out_proj_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M2291.41,-22969.6C2304.6,-22956.9 2318.2,-22943.8 2330.78,-22931.7"/>
<polygon fill="black" stroke="black" points="2333.27,-22934.15 2338.05,-22924.69 2328.42,-22929.11 2333.27,-22934.15"/>
</g>
<!-- ln2_2 -->
<g id="node18" class="node">
<title>ln2_2</title>
<polygon fill="lightcoral" stroke="black" points="2376.77,-22789.67 2232.77,-22789.67 2232.77,-22736.67 2376.77,-22736.67 2376.77,-22789.67"/>
<text text-anchor="middle" x="2304.77" y="-22774.47" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2304.77" y="-22759.47" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2304.77" y="-22744.47" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge20" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M2351.86,-22832.43C2343.96,-22820.97 2335.63,-22808.89 2328.21,-22798.14"/>
<polygon fill="black" stroke="black" points="2331.04,-22796.08 2322.48,-22789.84 2325.28,-22800.06 2331.04,-22796.08"/>
</g>
<!-- residual2_2 -->
<g id="node22" class="node">
<title>residual2_2</title>
<polygon fill="lightcoral" stroke="black" points="2296.77,-22227.71 2003.77,-22174.71 2296.77,-22121.71 2589.77,-22174.71 2296.77,-22227.71"/>
<text text-anchor="middle" x="2296.77" y="-22186.01" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="2296.77" y="-22171.01" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="2296.77" y="-22156.01" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge25" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2431.77,-22835.07C2448.32,-22815.38 2462.77,-22790.61 2462.77,-22764.17 2462.77,-22764.17 2462.77,-22764.17 2462.77,-22331.71 2462.77,-22300.76 2462.53,-22289.33 2443.77,-22264.71 2429.52,-22246.03 2410.13,-22230.42 2390.11,-22217.76"/>
<polygon fill="black" stroke="black" points="2391.86,-22214.73 2381.5,-22212.51 2388.22,-22220.71 2391.86,-22214.73"/>
<text text-anchor="middle" x="2491.77" y="-22534.47" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_2 -->
<g id="node19" class="node">
<title>mlp_fc1_2</title>
<polygon fill="lightcoral" stroke="black" points="2434.31,-22699.67 1951.45,-22699.67 1827.23,-22563.67 2310.09,-22563.67 2434.31,-22699.67"/>
<text text-anchor="middle" x="2130.77" y="-22650.47" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="2130.77" y="-22635.47" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="2130.77" y="-22620.47" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="2130.77" y="-22605.47" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_2&#45;&gt;mlp_fc1_2 -->
<g id="edge21" class="edge">
<title>ln2_2&#45;&gt;mlp_fc1_2</title>
<path fill="none" stroke="black" d="M2270.39,-22736.58C2258.27,-22727.56 2243.98,-22716.92 2229.23,-22705.95"/>
<polygon fill="black" stroke="black" points="2231.12,-22702.99 2221,-22699.82 2226.94,-22708.6 2231.12,-22702.99"/>
</g>
<!-- gelu_2 -->
<g id="node20" class="node">
<title>gelu_2</title>
<ellipse fill="lightcoral" stroke="black" cx="2130.77" cy="-22475.19" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="2130.77" y="-22486.49" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="2130.77" y="-22471.49" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="2130.77" y="-22456.49" font-family="Times,serif" font-size="14.00">GPU1</text>
</g>
<!-- mlp_fc1_2&#45;&gt;gelu_2 -->
<g id="edge22" class="edge">
<title>mlp_fc1_2&#45;&gt;gelu_2</title>
<path fill="none" stroke="black" d="M2130.77,-22563.36C2130.77,-22549.77 2130.77,-22535.76 2130.77,-22523.05"/>
<polygon fill="black" stroke="black" points="2134.27,-22522.72 2130.77,-22512.72 2127.27,-22522.72 2134.27,-22522.72"/>
</g>
<!-- mlp_fc2_2 -->
<g id="node21" class="node">
<title>mlp_fc2_2</title>
<polygon fill="lightcoral" stroke="black" points="2434.31,-22400.71 1951.45,-22400.71 1827.23,-22264.71 2310.09,-22264.71 2434.31,-22400.71"/>
<text text-anchor="middle" x="2130.77" y="-22351.51" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="2130.77" y="-22336.51" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2130.77" y="-22321.51" font-family="Times,serif" font-size="14.00">GPU1</text>
<text text-anchor="middle" x="2130.77" y="-22306.51" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_2&#45;&gt;mlp_fc2_2 -->
<g id="edge23" class="edge">
<title>gelu_2&#45;&gt;mlp_fc2_2</title>
<path fill="none" stroke="black" d="M2130.77,-22437.65C2130.77,-22429.35 2130.77,-22420.23 2130.77,-22410.94"/>
<polygon fill="black" stroke="black" points="2134.27,-22410.83 2130.77,-22400.83 2127.27,-22410.83 2134.27,-22410.83"/>
</g>
<!-- mlp_fc2_2&#45;&gt;residual2_2 -->
<g id="edge24" class="edge">
<title>mlp_fc2_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M2202.13,-22264.65C2215.65,-22251.95 2229.58,-22238.85 2242.47,-22226.74"/>
<polygon fill="black" stroke="black" points="2245.03,-22229.14 2249.92,-22219.74 2240.24,-22224.04 2245.03,-22229.14"/>
</g>
<!-- comm_2 -->
<g id="node23" class="node">
<title>comm_2</title>
<polygon fill="yellow" stroke="black" points="2414.51,-22023.32 2414.51,-22056.98 2345.54,-22080.77 2248,-22080.77 2179.03,-22056.98 2179.03,-22023.32 2248,-21999.53 2345.54,-21999.53 2414.51,-22023.32"/>
<polygon fill="none" stroke="black" points="2418.5,-22020.46 2418.5,-22059.83 2346.21,-22084.78 2247.33,-22084.78 2175.04,-22059.83 2175.04,-22020.46 2247.33,-21995.52 2346.21,-21995.52 2418.5,-22020.46"/>
<text text-anchor="middle" x="2296.77" y="-22051.45" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="2296.77" y="-22036.45" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2296.77" y="-22021.45" font-family="Times,serif" font-size="14.00">GPU1→GPU2</text>
</g>
<!-- residual2_2&#45;&gt;comm_2 -->
<g id="edge26" class="edge">
<title>residual2_2&#45;&gt;comm_2</title>
<path fill="none" stroke="black" d="M2296.77,-22121.7C2296.77,-22112.94 2296.77,-22103.83 2296.77,-22095.03"/>
<polygon fill="black" stroke="black" points="2300.27,-22094.87 2296.77,-22084.87 2293.27,-22094.87 2300.27,-22094.87"/>
</g>
<!-- ln1_3 -->
<g id="node24" class="node">
<title>ln1_3</title>
<polygon fill="lightgreen" stroke="black" points="2289.77,-21958.58 2145.77,-21958.58 2145.77,-21905.58 2289.77,-21905.58 2289.77,-21958.58"/>
<text text-anchor="middle" x="2217.77" y="-21943.38" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2217.77" y="-21928.38" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2217.77" y="-21913.38" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- comm_2&#45;&gt;ln1_3 -->
<g id="edge27" class="edge">
<title>comm_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M2264.18,-21995.4C2257.09,-21985.87 2249.69,-21975.94 2242.93,-21966.87"/>
<polygon fill="black" stroke="black" points="2245.72,-21964.75 2236.94,-21958.82 2240.1,-21968.93 2245.72,-21964.75"/>
</g>
<!-- residual1_3 -->
<g id="node28" class="node">
<title>residual1_3</title>
<polygon fill="lightgreen" stroke="black" points="2214.77,-21360.54 1921.77,-21307.54 2214.77,-21254.54 2507.77,-21307.54 2214.77,-21360.54"/>
<text text-anchor="middle" x="2214.77" y="-21318.84" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="2214.77" y="-21303.84" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="2214.77" y="-21288.84" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- comm_2&#45;&gt;residual1_3 -->
<g id="edge32" class="edge">
<title>comm_2&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2347.92,-21995.86C2363.1,-21978.31 2375.77,-21956.62 2375.77,-21933.08 2375.77,-21933.08 2375.77,-21933.08 2375.77,-21464.54 2375.77,-21433.47 2374.55,-21422.3 2355.77,-21397.54 2342.05,-21379.46 2323.52,-21364.11 2304.39,-21351.5"/>
<polygon fill="black" stroke="black" points="2306.2,-21348.5 2295.88,-21346.09 2302.44,-21354.41 2306.2,-21348.5"/>
<text text-anchor="middle" x="2404.77" y="-21703.38" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_3 -->
<g id="node25" class="node">
<title>qkv_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="2347.31,-21868.58 1864.45,-21868.58 1740.23,-21732.58 2223.09,-21732.58 2347.31,-21868.58"/>
<text text-anchor="middle" x="2043.77" y="-21819.38" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2043.77" y="-21804.38" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="2043.77" y="-21789.38" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2043.77" y="-21774.38" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_3&#45;&gt;qkv_proj_3 -->
<g id="edge28" class="edge">
<title>ln1_3&#45;&gt;qkv_proj_3</title>
<path fill="none" stroke="black" d="M2183.39,-21905.5C2171.27,-21896.48 2156.98,-21885.84 2142.23,-21874.87"/>
<polygon fill="black" stroke="black" points="2144.12,-21871.91 2134,-21868.74 2139.94,-21877.52 2144.12,-21871.91"/>
</g>
<!-- mha_3 -->
<g id="node26" class="node">
<title>mha_3</title>
<polygon fill="lightgreen" stroke="black" points="2289.24,-21626.06 2169.5,-21681.61 1930.04,-21681.61 1810.3,-21626.06 1930.04,-21570.52 2169.5,-21570.52 2289.24,-21626.06"/>
<text text-anchor="middle" x="2049.77" y="-21644.86" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="2049.77" y="-21629.86" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="2049.77" y="-21614.86" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2049.77" y="-21599.86" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- qkv_proj_3&#45;&gt;mha_3 -->
<g id="edge29" class="edge">
<title>qkv_proj_3&#45;&gt;mha_3</title>
<path fill="none" stroke="black" d="M2046.11,-21732.39C2046.57,-21719.18 2047.05,-21705.33 2047.5,-21692.19"/>
<polygon fill="black" stroke="black" points="2051.01,-21691.94 2047.86,-21681.82 2044.02,-21691.69 2051.01,-21691.94"/>
</g>
<!-- out_proj_3 -->
<g id="node27" class="node">
<title>out_proj_3</title>
<polygon fill="lightgreen" stroke="black" points="2347.14,-21533.54 1878.86,-21533.54 1758.39,-21397.54 2226.68,-21397.54 2347.14,-21533.54"/>
<text text-anchor="middle" x="2052.77" y="-21484.34" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2052.77" y="-21469.34" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="2052.77" y="-21454.34" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="2052.77" y="-21439.34" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_3&#45;&gt;out_proj_3 -->
<g id="edge30" class="edge">
<title>mha_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M2050.8,-21570.51C2050.96,-21561.92 2051.13,-21552.9 2051.3,-21543.91"/>
<polygon fill="black" stroke="black" points="2054.81,-21543.87 2051.5,-21533.8 2047.81,-21543.74 2054.81,-21543.87"/>
</g>
<!-- out_proj_3&#45;&gt;residual1_3 -->
<g id="edge31" class="edge">
<title>out_proj_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M2122.41,-21397.48C2135.6,-21384.78 2149.2,-21371.68 2161.78,-21359.57"/>
<polygon fill="black" stroke="black" points="2164.27,-21362.02 2169.05,-21352.57 2159.42,-21356.98 2164.27,-21362.02"/>
</g>
<!-- ln2_3 -->
<g id="node29" class="node">
<title>ln2_3</title>
<polygon fill="lightgreen" stroke="black" points="2211.77,-21217.54 2067.77,-21217.54 2067.77,-21164.54 2211.77,-21164.54 2211.77,-21217.54"/>
<text text-anchor="middle" x="2139.77" y="-21202.34" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2139.77" y="-21187.34" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2139.77" y="-21172.34" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge33" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M2184.26,-21259.97C2176.85,-21248.65 2169.06,-21236.76 2162.1,-21226.14"/>
<polygon fill="black" stroke="black" points="2164.89,-21224.01 2156.48,-21217.56 2159.04,-21227.84 2164.89,-21224.01"/>
</g>
<!-- residual2_3 -->
<g id="node33" class="node">
<title>residual2_3</title>
<polygon fill="lightgreen" stroke="black" points="2131.77,-20655.59 1838.77,-20602.59 2131.77,-20549.59 2424.77,-20602.59 2131.77,-20655.59"/>
<text text-anchor="middle" x="2131.77" y="-20613.89" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="2131.77" y="-20598.89" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="2131.77" y="-20583.89" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge38" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2265.2,-21263.38C2282.58,-21243.76 2297.77,-21218.93 2297.77,-21192.04 2297.77,-21192.04 2297.77,-21192.04 2297.77,-20759.59 2297.77,-20728.64 2297.53,-20717.2 2278.77,-20692.59 2264.52,-20673.9 2245.13,-20658.29 2225.11,-20645.63"/>
<polygon fill="black" stroke="black" points="2226.86,-20642.6 2216.5,-20640.39 2223.22,-20648.58 2226.86,-20642.6"/>
<text text-anchor="middle" x="2326.77" y="-20962.34" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_3 -->
<g id="node30" class="node">
<title>mlp_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="2269.31,-21127.54 1786.45,-21127.54 1662.23,-20991.54 2145.09,-20991.54 2269.31,-21127.54"/>
<text text-anchor="middle" x="1965.77" y="-21078.34" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1965.77" y="-21063.34" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1965.77" y="-21048.34" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1965.77" y="-21033.34" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_3&#45;&gt;mlp_fc1_3 -->
<g id="edge34" class="edge">
<title>ln2_3&#45;&gt;mlp_fc1_3</title>
<path fill="none" stroke="black" d="M2105.39,-21164.46C2093.27,-21155.44 2078.98,-21144.8 2064.23,-21133.82"/>
<polygon fill="black" stroke="black" points="2066.12,-21130.86 2056,-21127.7 2061.94,-21136.48 2066.12,-21130.86"/>
</g>
<!-- gelu_3 -->
<g id="node31" class="node">
<title>gelu_3</title>
<ellipse fill="lightgreen" stroke="black" cx="1965.77" cy="-20903.06" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1965.77" y="-20914.36" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1965.77" y="-20899.36" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1965.77" y="-20884.36" font-family="Times,serif" font-size="14.00">GPU2</text>
</g>
<!-- mlp_fc1_3&#45;&gt;gelu_3 -->
<g id="edge35" class="edge">
<title>mlp_fc1_3&#45;&gt;gelu_3</title>
<path fill="none" stroke="black" d="M1965.77,-20991.23C1965.77,-20977.64 1965.77,-20963.63 1965.77,-20950.93"/>
<polygon fill="black" stroke="black" points="1969.27,-20950.6 1965.77,-20940.6 1962.27,-20950.6 1969.27,-20950.6"/>
</g>
<!-- mlp_fc2_3 -->
<g id="node32" class="node">
<title>mlp_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="2269.31,-20828.59 1786.45,-20828.59 1662.23,-20692.59 2145.09,-20692.59 2269.31,-20828.59"/>
<text text-anchor="middle" x="1965.77" y="-20779.39" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1965.77" y="-20764.39" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1965.77" y="-20749.39" font-family="Times,serif" font-size="14.00">GPU2</text>
<text text-anchor="middle" x="1965.77" y="-20734.39" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_3&#45;&gt;mlp_fc2_3 -->
<g id="edge36" class="edge">
<title>gelu_3&#45;&gt;mlp_fc2_3</title>
<path fill="none" stroke="black" d="M1965.77,-20865.52C1965.77,-20857.22 1965.77,-20848.1 1965.77,-20838.82"/>
<polygon fill="black" stroke="black" points="1969.27,-20838.71 1965.77,-20828.71 1962.27,-20838.71 1969.27,-20838.71"/>
</g>
<!-- mlp_fc2_3&#45;&gt;residual2_3 -->
<g id="edge37" class="edge">
<title>mlp_fc2_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M2037.13,-20692.52C2050.65,-20679.82 2064.58,-20666.73 2077.47,-20654.62"/>
<polygon fill="black" stroke="black" points="2080.03,-20657.01 2084.92,-20647.61 2075.24,-20651.91 2080.03,-20657.01"/>
</g>
<!-- comm_3 -->
<g id="node34" class="node">
<title>comm_3</title>
<polygon fill="yellow" stroke="black" points="2249.51,-20451.2 2249.51,-20484.85 2180.54,-20508.65 2083,-20508.65 2014.03,-20484.85 2014.03,-20451.2 2083,-20427.4 2180.54,-20427.4 2249.51,-20451.2"/>
<polygon fill="none" stroke="black" points="2253.5,-20448.34 2253.5,-20487.71 2181.21,-20512.65 2082.33,-20512.65 2010.04,-20487.71 2010.04,-20448.34 2082.33,-20423.39 2181.21,-20423.39 2253.5,-20448.34"/>
<text text-anchor="middle" x="2131.77" y="-20479.32" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="2131.77" y="-20464.32" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2131.77" y="-20449.32" font-family="Times,serif" font-size="14.00">GPU2→GPU3</text>
</g>
<!-- residual2_3&#45;&gt;comm_3 -->
<g id="edge39" class="edge">
<title>residual2_3&#45;&gt;comm_3</title>
<path fill="none" stroke="black" d="M2131.77,-20549.58C2131.77,-20540.82 2131.77,-20531.71 2131.77,-20522.9"/>
<polygon fill="black" stroke="black" points="2135.27,-20522.75 2131.77,-20512.75 2128.27,-20522.75 2135.27,-20522.75"/>
</g>
<!-- ln1_4 -->
<g id="node35" class="node">
<title>ln1_4</title>
<polygon fill="lightyellow" stroke="black" points="2124.77,-20386.46 1980.77,-20386.46 1980.77,-20333.46 2124.77,-20333.46 2124.77,-20386.46"/>
<text text-anchor="middle" x="2052.77" y="-20371.26" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2052.77" y="-20356.26" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="2052.77" y="-20341.26" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- comm_3&#45;&gt;ln1_4 -->
<g id="edge40" class="edge">
<title>comm_3&#45;&gt;ln1_4</title>
<path fill="none" stroke="black" d="M2099.18,-20423.27C2092.09,-20413.75 2084.69,-20403.81 2077.93,-20394.74"/>
<polygon fill="black" stroke="black" points="2080.72,-20392.62 2071.94,-20386.7 2075.1,-20396.81 2080.72,-20392.62"/>
</g>
<!-- residual1_4 -->
<g id="node39" class="node">
<title>residual1_4</title>
<polygon fill="lightyellow" stroke="black" points="2049.77,-19788.42 1756.77,-19735.42 2049.77,-19682.42 2342.77,-19735.42 2049.77,-19788.42"/>
<text text-anchor="middle" x="2049.77" y="-19746.72" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="2049.77" y="-19731.72" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="2049.77" y="-19716.72" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- comm_3&#45;&gt;residual1_4 -->
<g id="edge45" class="edge">
<title>comm_3&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2182.92,-20423.74C2198.1,-20406.19 2210.77,-20384.49 2210.77,-20360.96 2210.77,-20360.96 2210.77,-20360.96 2210.77,-19892.42 2210.77,-19861.34 2209.55,-19850.18 2190.77,-19825.42 2177.05,-19807.33 2158.52,-19791.98 2139.39,-19779.38"/>
<polygon fill="black" stroke="black" points="2141.2,-19776.38 2130.88,-19773.97 2137.44,-19782.29 2141.2,-19776.38"/>
<text text-anchor="middle" x="2239.77" y="-20131.26" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_4 -->
<g id="node36" class="node">
<title>qkv_proj_4</title>
<polygon fill="lightyellow" stroke="black" points="2182.31,-20296.46 1699.45,-20296.46 1575.23,-20160.46 2058.09,-20160.46 2182.31,-20296.46"/>
<text text-anchor="middle" x="1878.77" y="-20247.26" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1878.77" y="-20232.26" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="1878.77" y="-20217.26" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1878.77" y="-20202.26" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_4&#45;&gt;qkv_proj_4 -->
<g id="edge41" class="edge">
<title>ln1_4&#45;&gt;qkv_proj_4</title>
<path fill="none" stroke="black" d="M2018.39,-20333.37C2006.27,-20324.36 1991.98,-20313.71 1977.23,-20302.74"/>
<polygon fill="black" stroke="black" points="1979.12,-20299.78 1969,-20296.62 1974.94,-20305.4 1979.12,-20299.78"/>
</g>
<!-- mha_4 -->
<g id="node37" class="node">
<title>mha_4</title>
<polygon fill="lightyellow" stroke="black" points="2124.24,-20053.94 2004.5,-20109.48 1765.04,-20109.48 1645.3,-20053.94 1765.04,-19998.39 2004.5,-19998.39 2124.24,-20053.94"/>
<text text-anchor="middle" x="1884.77" y="-20072.74" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1884.77" y="-20057.74" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="1884.77" y="-20042.74" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1884.77" y="-20027.74" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- qkv_proj_4&#45;&gt;mha_4 -->
<g id="edge42" class="edge">
<title>qkv_proj_4&#45;&gt;mha_4</title>
<path fill="none" stroke="black" d="M1881.11,-20160.26C1881.57,-20147.05 1882.05,-20133.21 1882.5,-20120.06"/>
<polygon fill="black" stroke="black" points="1886.01,-20119.81 1882.86,-20109.7 1879.02,-20119.57 1886.01,-20119.81"/>
</g>
<!-- out_proj_4 -->
<g id="node38" class="node">
<title>out_proj_4</title>
<polygon fill="lightyellow" stroke="black" points="2182.14,-19961.42 1713.86,-19961.42 1593.39,-19825.42 2061.68,-19825.42 2182.14,-19961.42"/>
<text text-anchor="middle" x="1887.77" y="-19912.22" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1887.77" y="-19897.22" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1887.77" y="-19882.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1887.77" y="-19867.22" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_4&#45;&gt;out_proj_4 -->
<g id="edge43" class="edge">
<title>mha_4&#45;&gt;out_proj_4</title>
<path fill="none" stroke="black" d="M1885.8,-19998.38C1885.96,-19989.79 1886.13,-19980.77 1886.3,-19971.79"/>
<polygon fill="black" stroke="black" points="1889.81,-19971.74 1886.5,-19961.68 1882.81,-19971.61 1889.81,-19971.74"/>
</g>
<!-- out_proj_4&#45;&gt;residual1_4 -->
<g id="edge44" class="edge">
<title>out_proj_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M1957.41,-19825.35C1970.6,-19812.65 1984.2,-19799.55 1996.78,-19787.45"/>
<polygon fill="black" stroke="black" points="1999.27,-19789.9 2004.05,-19780.44 1994.42,-19784.86 1999.27,-19789.9"/>
</g>
<!-- ln2_4 -->
<g id="node40" class="node">
<title>ln2_4</title>
<polygon fill="lightyellow" stroke="black" points="2042.77,-19645.42 1898.77,-19645.42 1898.77,-19592.42 2042.77,-19592.42 2042.77,-19645.42"/>
<text text-anchor="middle" x="1970.77" y="-19630.22" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1970.77" y="-19615.22" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1970.77" y="-19600.22" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge46" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M2017.86,-19688.17C2009.96,-19676.71 2001.63,-19664.64 1994.21,-19653.89"/>
<polygon fill="black" stroke="black" points="1997.04,-19651.83 1988.48,-19645.59 1991.28,-19655.81 1997.04,-19651.83"/>
</g>
<!-- residual2_4 -->
<g id="node44" class="node">
<title>residual2_4</title>
<polygon fill="lightyellow" stroke="black" points="1962.77,-19083.46 1669.77,-19030.46 1962.77,-18977.46 2255.77,-19030.46 1962.77,-19083.46"/>
<text text-anchor="middle" x="1962.77" y="-19041.76" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1962.77" y="-19026.76" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1962.77" y="-19011.76" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- residual1_4&#45;&gt;residual2_4 -->
<g id="edge51" class="edge">
<title>residual1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2097.77,-19690.82C2114.32,-19671.13 2128.77,-19646.36 2128.77,-19619.92 2128.77,-19619.92 2128.77,-19619.92 2128.77,-19187.46 2128.77,-19156.51 2128.53,-19145.08 2109.77,-19120.46 2095.52,-19101.78 2076.13,-19086.17 2056.11,-19073.51"/>
<polygon fill="black" stroke="black" points="2057.86,-19070.48 2047.5,-19068.26 2054.22,-19076.45 2057.86,-19070.48"/>
<text text-anchor="middle" x="2157.77" y="-19390.22" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_4 -->
<g id="node41" class="node">
<title>mlp_fc1_4</title>
<polygon fill="lightyellow" stroke="black" points="2100.31,-19555.42 1617.45,-19555.42 1493.23,-19419.42 1976.09,-19419.42 2100.31,-19555.42"/>
<text text-anchor="middle" x="1796.77" y="-19506.22" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1796.77" y="-19491.22" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1796.77" y="-19476.22" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1796.77" y="-19461.22" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_4&#45;&gt;mlp_fc1_4 -->
<g id="edge47" class="edge">
<title>ln2_4&#45;&gt;mlp_fc1_4</title>
<path fill="none" stroke="black" d="M1936.39,-19592.33C1924.27,-19583.31 1909.98,-19572.67 1895.23,-19561.7"/>
<polygon fill="black" stroke="black" points="1897.12,-19558.74 1887,-19555.57 1892.94,-19564.35 1897.12,-19558.74"/>
</g>
<!-- gelu_4 -->
<g id="node42" class="node">
<title>gelu_4</title>
<ellipse fill="lightyellow" stroke="black" cx="1796.77" cy="-19330.94" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1796.77" y="-19342.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1796.77" y="-19327.24" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1796.77" y="-19312.24" font-family="Times,serif" font-size="14.00">GPU3</text>
</g>
<!-- mlp_fc1_4&#45;&gt;gelu_4 -->
<g id="edge48" class="edge">
<title>mlp_fc1_4&#45;&gt;gelu_4</title>
<path fill="none" stroke="black" d="M1796.77,-19419.11C1796.77,-19405.52 1796.77,-19391.51 1796.77,-19378.8"/>
<polygon fill="black" stroke="black" points="1800.27,-19378.47 1796.77,-19368.47 1793.27,-19378.47 1800.27,-19378.47"/>
</g>
<!-- mlp_fc2_4 -->
<g id="node43" class="node">
<title>mlp_fc2_4</title>
<polygon fill="lightyellow" stroke="black" points="2100.31,-19256.46 1617.45,-19256.46 1493.23,-19120.46 1976.09,-19120.46 2100.31,-19256.46"/>
<text text-anchor="middle" x="1796.77" y="-19207.26" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1796.77" y="-19192.26" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1796.77" y="-19177.26" font-family="Times,serif" font-size="14.00">GPU3</text>
<text text-anchor="middle" x="1796.77" y="-19162.26" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_4&#45;&gt;mlp_fc2_4 -->
<g id="edge49" class="edge">
<title>gelu_4&#45;&gt;mlp_fc2_4</title>
<path fill="none" stroke="black" d="M1796.77,-19293.4C1796.77,-19285.1 1796.77,-19275.98 1796.77,-19266.69"/>
<polygon fill="black" stroke="black" points="1800.27,-19266.58 1796.77,-19256.58 1793.27,-19266.58 1800.27,-19266.58"/>
</g>
<!-- mlp_fc2_4&#45;&gt;residual2_4 -->
<g id="edge50" class="edge">
<title>mlp_fc2_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M1868.13,-19120.4C1881.65,-19107.7 1895.58,-19094.6 1908.47,-19082.49"/>
<polygon fill="black" stroke="black" points="1911.03,-19084.89 1915.92,-19075.49 1906.24,-19079.79 1911.03,-19084.89"/>
</g>
<!-- comm_4 -->
<g id="node45" class="node">
<title>comm_4</title>
<polygon fill="yellow" stroke="black" points="2080.51,-18879.07 2080.51,-18912.72 2011.54,-18936.52 1914,-18936.52 1845.03,-18912.72 1845.03,-18879.07 1914,-18855.27 2011.54,-18855.27 2080.51,-18879.07"/>
<polygon fill="none" stroke="black" points="2084.5,-18876.21 2084.5,-18915.58 2012.21,-18940.53 1913.33,-18940.53 1841.04,-18915.58 1841.04,-18876.21 1913.33,-18851.27 2012.21,-18851.27 2084.5,-18876.21"/>
<text text-anchor="middle" x="1962.77" y="-18907.2" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1962.77" y="-18892.2" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1962.77" y="-18877.2" font-family="Times,serif" font-size="14.00">GPU3→GPU4</text>
</g>
<!-- residual2_4&#45;&gt;comm_4 -->
<g id="edge52" class="edge">
<title>residual2_4&#45;&gt;comm_4</title>
<path fill="none" stroke="black" d="M1962.77,-18977.45C1962.77,-18968.69 1962.77,-18959.58 1962.77,-18950.78"/>
<polygon fill="black" stroke="black" points="1966.27,-18950.62 1962.77,-18940.62 1959.27,-18950.62 1966.27,-18950.62"/>
</g>
<!-- ln1_5 -->
<g id="node46" class="node">
<title>ln1_5</title>
<polygon fill="lightpink" stroke="black" points="1955.77,-18814.33 1811.77,-18814.33 1811.77,-18761.33 1955.77,-18761.33 1955.77,-18814.33"/>
<text text-anchor="middle" x="1883.77" y="-18799.13" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1883.77" y="-18784.13" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1883.77" y="-18769.13" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- comm_4&#45;&gt;ln1_5 -->
<g id="edge53" class="edge">
<title>comm_4&#45;&gt;ln1_5</title>
<path fill="none" stroke="black" d="M1930.18,-18851.14C1923.09,-18841.62 1915.69,-18831.68 1908.93,-18822.62"/>
<polygon fill="black" stroke="black" points="1911.72,-18820.5 1902.94,-18814.57 1906.1,-18824.68 1911.72,-18820.5"/>
</g>
<!-- residual1_5 -->
<g id="node50" class="node">
<title>residual1_5</title>
<polygon fill="lightpink" stroke="black" points="1953.77,-18216.29 1660.77,-18163.29 1953.77,-18110.29 2246.77,-18163.29 1953.77,-18216.29"/>
<text text-anchor="middle" x="1953.77" y="-18174.59" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1953.77" y="-18159.59" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1953.77" y="-18144.59" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- comm_4&#45;&gt;residual1_5 -->
<g id="edge58" class="edge">
<title>comm_4&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2013.92,-18851.61C2029.1,-18834.06 2041.77,-18812.37 2041.77,-18788.83 2041.77,-18788.83 2041.77,-18788.83 2041.77,-18320.29 2041.77,-18282.65 2022.09,-18245.72 2001.35,-18217.26"/>
<polygon fill="black" stroke="black" points="2004,-18214.96 1995.19,-18209.08 1998.41,-18219.17 2004,-18214.96"/>
<text text-anchor="middle" x="2070.77" y="-18559.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_5 -->
<g id="node47" class="node">
<title>qkv_proj_5</title>
<polygon fill="lightpink" stroke="black" points="2013.31,-18724.33 1530.45,-18724.33 1406.23,-18588.33 1889.09,-18588.33 2013.31,-18724.33"/>
<text text-anchor="middle" x="1709.77" y="-18675.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1709.77" y="-18660.13" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="1709.77" y="-18645.13" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1709.77" y="-18630.13" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_5&#45;&gt;qkv_proj_5 -->
<g id="edge54" class="edge">
<title>ln1_5&#45;&gt;qkv_proj_5</title>
<path fill="none" stroke="black" d="M1849.39,-18761.25C1837.27,-18752.23 1822.98,-18741.59 1808.23,-18730.61"/>
<polygon fill="black" stroke="black" points="1810.12,-18727.65 1800,-18724.49 1805.94,-18733.27 1810.12,-18727.65"/>
</g>
<!-- mha_5 -->
<g id="node48" class="node">
<title>mha_5</title>
<polygon fill="lightpink" stroke="black" points="1956.24,-18481.81 1836.5,-18537.36 1597.04,-18537.36 1477.3,-18481.81 1597.04,-18426.27 1836.5,-18426.27 1956.24,-18481.81"/>
<text text-anchor="middle" x="1716.77" y="-18500.61" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1716.77" y="-18485.61" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="1716.77" y="-18470.61" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1716.77" y="-18455.61" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- qkv_proj_5&#45;&gt;mha_5 -->
<g id="edge55" class="edge">
<title>qkv_proj_5&#45;&gt;mha_5</title>
<path fill="none" stroke="black" d="M1712.5,-18588.14C1713.03,-18574.92 1713.59,-18561.08 1714.13,-18547.94"/>
<polygon fill="black" stroke="black" points="1717.64,-18547.7 1714.55,-18537.57 1710.64,-18547.42 1717.64,-18547.7"/>
</g>
<!-- out_proj_5 -->
<g id="node49" class="node">
<title>out_proj_5</title>
<polygon fill="lightpink" stroke="black" points="2013.14,-18389.29 1544.86,-18389.29 1424.39,-18253.29 1892.68,-18253.29 2013.14,-18389.29"/>
<text text-anchor="middle" x="1718.77" y="-18340.09" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1718.77" y="-18325.09" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1718.77" y="-18310.09" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1718.77" y="-18295.09" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_5&#45;&gt;out_proj_5 -->
<g id="edge56" class="edge">
<title>mha_5&#45;&gt;out_proj_5</title>
<path fill="none" stroke="black" d="M1717.46,-18426.26C1717.57,-18417.67 1717.68,-18408.65 1717.79,-18399.66"/>
<polygon fill="black" stroke="black" points="1721.29,-18399.6 1717.92,-18389.55 1714.29,-18399.51 1721.29,-18399.6"/>
</g>
<!-- out_proj_5&#45;&gt;residual1_5 -->
<g id="edge57" class="edge">
<title>out_proj_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M1819.79,-18253.23C1841.35,-18238.92 1863.65,-18224.11 1883.74,-18210.78"/>
<polygon fill="black" stroke="black" points="1885.8,-18213.61 1892.2,-18205.16 1881.93,-18207.78 1885.8,-18213.61"/>
</g>
<!-- ln2_5 -->
<g id="node51" class="node">
<title>ln2_5</title>
<polygon fill="lightpink" stroke="black" points="1946.77,-18073.29 1802.77,-18073.29 1802.77,-18020.29 1946.77,-18020.29 1946.77,-18073.29"/>
<text text-anchor="middle" x="1874.77" y="-18058.09" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1874.77" y="-18043.09" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1874.77" y="-18028.09" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge59" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M1921.86,-18116.05C1913.96,-18104.59 1905.63,-18092.52 1898.21,-18081.77"/>
<polygon fill="black" stroke="black" points="1901.04,-18079.71 1892.48,-18073.46 1895.28,-18083.68 1901.04,-18079.71"/>
</g>
<!-- residual2_5 -->
<g id="node55" class="node">
<title>residual2_5</title>
<polygon fill="lightpink" stroke="black" points="1866.77,-17511.34 1573.77,-17458.34 1866.77,-17405.34 2159.77,-17458.34 1866.77,-17511.34"/>
<text text-anchor="middle" x="1866.77" y="-17469.64" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1866.77" y="-17454.64" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1866.77" y="-17439.64" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- residual1_5&#45;&gt;residual2_5 -->
<g id="edge64" class="edge">
<title>residual1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2001.77,-18118.7C2018.32,-18099.01 2032.77,-18074.23 2032.77,-18047.79 2032.77,-18047.79 2032.77,-18047.79 2032.77,-17615.34 2032.77,-17584.38 2032.53,-17572.95 2013.77,-17548.34 1999.52,-17529.65 1980.13,-17514.04 1960.11,-17501.38"/>
<polygon fill="black" stroke="black" points="1961.86,-17498.35 1951.5,-17496.14 1958.22,-17504.33 1961.86,-17498.35"/>
<text text-anchor="middle" x="2061.77" y="-17818.09" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_5 -->
<g id="node52" class="node">
<title>mlp_fc1_5</title>
<polygon fill="lightpink" stroke="black" points="2004.31,-17983.29 1521.45,-17983.29 1397.23,-17847.29 1880.09,-17847.29 2004.31,-17983.29"/>
<text text-anchor="middle" x="1700.77" y="-17934.09" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1700.77" y="-17919.09" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1700.77" y="-17904.09" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1700.77" y="-17889.09" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_5&#45;&gt;mlp_fc1_5 -->
<g id="edge60" class="edge">
<title>ln2_5&#45;&gt;mlp_fc1_5</title>
<path fill="none" stroke="black" d="M1840.39,-18020.2C1828.27,-18011.19 1813.98,-18000.54 1799.23,-17989.57"/>
<polygon fill="black" stroke="black" points="1801.12,-17986.61 1791,-17983.45 1796.94,-17992.23 1801.12,-17986.61"/>
</g>
<!-- gelu_5 -->
<g id="node53" class="node">
<title>gelu_5</title>
<ellipse fill="lightpink" stroke="black" cx="1700.77" cy="-17758.81" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1700.77" y="-17770.11" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1700.77" y="-17755.11" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1700.77" y="-17740.11" font-family="Times,serif" font-size="14.00">GPU4</text>
</g>
<!-- mlp_fc1_5&#45;&gt;gelu_5 -->
<g id="edge61" class="edge">
<title>mlp_fc1_5&#45;&gt;gelu_5</title>
<path fill="none" stroke="black" d="M1700.77,-17846.98C1700.77,-17833.39 1700.77,-17819.38 1700.77,-17806.67"/>
<polygon fill="black" stroke="black" points="1704.27,-17806.35 1700.77,-17796.35 1697.27,-17806.35 1704.27,-17806.35"/>
</g>
<!-- mlp_fc2_5 -->
<g id="node54" class="node">
<title>mlp_fc2_5</title>
<polygon fill="lightpink" stroke="black" points="2004.31,-17684.34 1521.45,-17684.34 1397.23,-17548.34 1880.09,-17548.34 2004.31,-17684.34"/>
<text text-anchor="middle" x="1700.77" y="-17635.14" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1700.77" y="-17620.14" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1700.77" y="-17605.14" font-family="Times,serif" font-size="14.00">GPU4</text>
<text text-anchor="middle" x="1700.77" y="-17590.14" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_5&#45;&gt;mlp_fc2_5 -->
<g id="edge62" class="edge">
<title>gelu_5&#45;&gt;mlp_fc2_5</title>
<path fill="none" stroke="black" d="M1700.77,-17721.27C1700.77,-17712.97 1700.77,-17703.85 1700.77,-17694.57"/>
<polygon fill="black" stroke="black" points="1704.27,-17694.46 1700.77,-17684.46 1697.27,-17694.46 1704.27,-17694.46"/>
</g>
<!-- mlp_fc2_5&#45;&gt;residual2_5 -->
<g id="edge63" class="edge">
<title>mlp_fc2_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M1772.13,-17548.27C1785.65,-17535.57 1799.58,-17522.47 1812.47,-17510.37"/>
<polygon fill="black" stroke="black" points="1815.03,-17512.76 1819.92,-17503.36 1810.24,-17507.66 1815.03,-17512.76"/>
</g>
<!-- comm_5 -->
<g id="node56" class="node">
<title>comm_5</title>
<polygon fill="yellow" stroke="black" points="1984.51,-17306.95 1984.51,-17340.6 1915.54,-17364.4 1818,-17364.4 1749.03,-17340.6 1749.03,-17306.95 1818,-17283.15 1915.54,-17283.15 1984.51,-17306.95"/>
<polygon fill="none" stroke="black" points="1988.5,-17304.09 1988.5,-17343.46 1916.21,-17368.4 1817.33,-17368.4 1745.04,-17343.46 1745.04,-17304.09 1817.33,-17279.14 1916.21,-17279.14 1988.5,-17304.09"/>
<text text-anchor="middle" x="1866.77" y="-17335.07" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1866.77" y="-17320.07" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1866.77" y="-17305.07" font-family="Times,serif" font-size="14.00">GPU4→GPU5</text>
</g>
<!-- residual2_5&#45;&gt;comm_5 -->
<g id="edge65" class="edge">
<title>residual2_5&#45;&gt;comm_5</title>
<path fill="none" stroke="black" d="M1866.77,-17405.32C1866.77,-17396.57 1866.77,-17387.46 1866.77,-17378.65"/>
<polygon fill="black" stroke="black" points="1870.27,-17378.49 1866.77,-17368.49 1863.27,-17378.49 1870.27,-17378.49"/>
</g>
<!-- ln1_6 -->
<g id="node57" class="node">
<title>ln1_6</title>
<polygon fill="lightcyan" stroke="black" points="1863.77,-17242.21 1719.77,-17242.21 1719.77,-17189.21 1863.77,-17189.21 1863.77,-17242.21"/>
<text text-anchor="middle" x="1791.77" y="-17227.01" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1791.77" y="-17212.01" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1791.77" y="-17197.01" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- comm_5&#45;&gt;ln1_6 -->
<g id="edge66" class="edge">
<title>comm_5&#45;&gt;ln1_6</title>
<path fill="none" stroke="black" d="M1835.83,-17279.02C1829.16,-17269.59 1822.21,-17259.76 1815.85,-17250.77"/>
<polygon fill="black" stroke="black" points="1818.6,-17248.59 1809.97,-17242.44 1812.88,-17252.63 1818.6,-17248.59"/>
</g>
<!-- residual1_6 -->
<g id="node61" class="node">
<title>residual1_6</title>
<polygon fill="lightcyan" stroke="black" points="1788.77,-16644.16 1495.77,-16591.16 1788.77,-16538.16 2081.77,-16591.16 1788.77,-16644.16"/>
<text text-anchor="middle" x="1788.77" y="-16602.46" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1788.77" y="-16587.46" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1788.77" y="-16572.46" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- comm_5&#45;&gt;residual1_6 -->
<g id="edge71" class="edge">
<title>comm_5&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1920.04,-17280.46C1936.2,-17262.88 1949.77,-17240.91 1949.77,-17216.71 1949.77,-17216.71 1949.77,-17216.71 1949.77,-16748.16 1949.77,-16717.09 1948.55,-16705.92 1929.77,-16681.16 1916.05,-16663.08 1897.52,-16647.73 1878.39,-16635.13"/>
<polygon fill="black" stroke="black" points="1880.2,-16632.13 1869.88,-16629.71 1876.44,-16638.03 1880.2,-16632.13"/>
<text text-anchor="middle" x="1978.77" y="-16987.01" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_6 -->
<g id="node58" class="node">
<title>qkv_proj_6</title>
<polygon fill="lightcyan" stroke="black" points="1921.31,-17152.21 1438.45,-17152.21 1314.23,-17016.21 1797.09,-17016.21 1921.31,-17152.21"/>
<text text-anchor="middle" x="1617.77" y="-17103.01" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1617.77" y="-17088.01" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="1617.77" y="-17073.01" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="1617.77" y="-17058.01" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_6&#45;&gt;qkv_proj_6 -->
<g id="edge67" class="edge">
<title>ln1_6&#45;&gt;qkv_proj_6</title>
<path fill="none" stroke="black" d="M1757.39,-17189.12C1745.27,-17180.1 1730.98,-17169.46 1716.23,-17158.49"/>
<polygon fill="black" stroke="black" points="1718.12,-17155.53 1708,-17152.37 1713.94,-17161.14 1718.12,-17155.53"/>
</g>
<!-- mha_6 -->
<g id="node59" class="node">
<title>mha_6</title>
<polygon fill="lightcyan" stroke="black" points="1863.24,-16909.69 1743.5,-16965.23 1504.04,-16965.23 1384.3,-16909.69 1504.04,-16854.14 1743.5,-16854.14 1863.24,-16909.69"/>
<text text-anchor="middle" x="1623.77" y="-16928.49" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1623.77" y="-16913.49" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="1623.77" y="-16898.49" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1623.77" y="-16883.49" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- qkv_proj_6&#45;&gt;mha_6 -->
<g id="edge68" class="edge">
<title>qkv_proj_6&#45;&gt;mha_6</title>
<path fill="none" stroke="black" d="M1620.11,-17016.01C1620.57,-17002.8 1621.05,-16988.96 1621.5,-16975.81"/>
<polygon fill="black" stroke="black" points="1625.01,-16975.56 1621.86,-16965.44 1618.02,-16975.32 1625.01,-16975.56"/>
</g>
<!-- out_proj_6 -->
<g id="node60" class="node">
<title>out_proj_6</title>
<polygon fill="lightcyan" stroke="black" points="1921.14,-16817.16 1452.86,-16817.16 1332.39,-16681.16 1800.68,-16681.16 1921.14,-16817.16"/>
<text text-anchor="middle" x="1626.77" y="-16767.96" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1626.77" y="-16752.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1626.77" y="-16737.96" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="1626.77" y="-16722.96" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_6&#45;&gt;out_proj_6 -->
<g id="edge69" class="edge">
<title>mha_6&#45;&gt;out_proj_6</title>
<path fill="none" stroke="black" d="M1624.8,-16854.13C1624.96,-16845.54 1625.13,-16836.52 1625.3,-16827.54"/>
<polygon fill="black" stroke="black" points="1628.81,-16827.49 1625.5,-16817.43 1621.81,-16827.36 1628.81,-16827.49"/>
</g>
<!-- out_proj_6&#45;&gt;residual1_6 -->
<g id="edge70" class="edge">
<title>out_proj_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M1696.41,-16681.1C1709.6,-16668.4 1723.2,-16655.3 1735.78,-16643.19"/>
<polygon fill="black" stroke="black" points="1738.27,-16645.65 1743.05,-16636.19 1733.42,-16640.61 1738.27,-16645.65"/>
</g>
<!-- ln2_6 -->
<g id="node62" class="node">
<title>ln2_6</title>
<polygon fill="lightcyan" stroke="black" points="1781.77,-16501.16 1637.77,-16501.16 1637.77,-16448.16 1781.77,-16448.16 1781.77,-16501.16"/>
<text text-anchor="middle" x="1709.77" y="-16485.96" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1709.77" y="-16470.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1709.77" y="-16455.96" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge72" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M1756.86,-16543.92C1748.96,-16532.46 1740.63,-16520.39 1733.21,-16509.64"/>
<polygon fill="black" stroke="black" points="1736.04,-16507.58 1727.48,-16501.34 1730.28,-16511.56 1736.04,-16507.58"/>
</g>
<!-- residual2_6 -->
<g id="node66" class="node">
<title>residual2_6</title>
<polygon fill="lightcyan" stroke="black" points="1777.77,-15939.21 1484.77,-15886.21 1777.77,-15833.21 2070.77,-15886.21 1777.77,-15939.21"/>
<text text-anchor="middle" x="1777.77" y="-15897.51" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1777.77" y="-15882.51" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1777.77" y="-15867.51" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- residual1_6&#45;&gt;residual2_6 -->
<g id="edge77" class="edge">
<title>residual1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1836.77,-16546.57C1853.32,-16526.88 1867.77,-16502.11 1867.77,-16475.66 1867.77,-16475.66 1867.77,-16475.66 1867.77,-16043.21 1867.77,-16005.36 1847.65,-15968.43 1826.43,-15940"/>
<polygon fill="black" stroke="black" points="1829.01,-15937.62 1820.13,-15931.84 1823.47,-15941.9 1829.01,-15937.62"/>
<text text-anchor="middle" x="1896.77" y="-16245.96" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_6 -->
<g id="node63" class="node">
<title>mlp_fc1_6</title>
<polygon fill="lightcyan" stroke="black" points="1839.31,-16411.16 1356.45,-16411.16 1232.23,-16275.16 1715.09,-16275.16 1839.31,-16411.16"/>
<text text-anchor="middle" x="1535.77" y="-16361.96" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1535.77" y="-16346.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1535.77" y="-16331.96" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="1535.77" y="-16316.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_6&#45;&gt;mlp_fc1_6 -->
<g id="edge73" class="edge">
<title>ln2_6&#45;&gt;mlp_fc1_6</title>
<path fill="none" stroke="black" d="M1675.39,-16448.08C1663.27,-16439.06 1648.98,-16428.42 1634.23,-16417.44"/>
<polygon fill="black" stroke="black" points="1636.12,-16414.48 1626,-16411.32 1631.94,-16420.1 1636.12,-16414.48"/>
</g>
<!-- gelu_6 -->
<g id="node64" class="node">
<title>gelu_6</title>
<ellipse fill="lightcyan" stroke="black" cx="1535.77" cy="-16186.69" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1535.77" y="-16197.99" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1535.77" y="-16182.99" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1535.77" y="-16167.99" font-family="Times,serif" font-size="14.00">GPU5</text>
</g>
<!-- mlp_fc1_6&#45;&gt;gelu_6 -->
<g id="edge74" class="edge">
<title>mlp_fc1_6&#45;&gt;gelu_6</title>
<path fill="none" stroke="black" d="M1535.77,-16274.86C1535.77,-16261.26 1535.77,-16247.25 1535.77,-16234.55"/>
<polygon fill="black" stroke="black" points="1539.27,-16234.22 1535.77,-16224.22 1532.27,-16234.22 1539.27,-16234.22"/>
</g>
<!-- mlp_fc2_6 -->
<g id="node65" class="node">
<title>mlp_fc2_6</title>
<polygon fill="lightcyan" stroke="black" points="1839.31,-16112.21 1356.45,-16112.21 1232.23,-15976.21 1715.09,-15976.21 1839.31,-16112.21"/>
<text text-anchor="middle" x="1535.77" y="-16063.01" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1535.77" y="-16048.01" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1535.77" y="-16033.01" font-family="Times,serif" font-size="14.00">GPU5</text>
<text text-anchor="middle" x="1535.77" y="-16018.01" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_6&#45;&gt;mlp_fc2_6 -->
<g id="edge75" class="edge">
<title>gelu_6&#45;&gt;mlp_fc2_6</title>
<path fill="none" stroke="black" d="M1535.77,-16149.15C1535.77,-16140.85 1535.77,-16131.73 1535.77,-16122.44"/>
<polygon fill="black" stroke="black" points="1539.27,-16122.33 1535.77,-16112.33 1532.27,-16122.33 1539.27,-16122.33"/>
</g>
<!-- mlp_fc2_6&#45;&gt;residual2_6 -->
<g id="edge76" class="edge">
<title>mlp_fc2_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M1639.8,-15976.15C1662.21,-15961.7 1685.41,-15946.75 1706.24,-15933.32"/>
<polygon fill="black" stroke="black" points="1708.2,-15936.22 1714.71,-15927.86 1704.41,-15930.34 1708.2,-15936.22"/>
</g>
<!-- comm_6 -->
<g id="node67" class="node">
<title>comm_6</title>
<polygon fill="yellow" stroke="black" points="1895.51,-15734.82 1895.51,-15768.47 1826.54,-15792.27 1729,-15792.27 1660.03,-15768.47 1660.03,-15734.82 1729,-15711.02 1826.54,-15711.02 1895.51,-15734.82"/>
<polygon fill="none" stroke="black" points="1899.5,-15731.96 1899.5,-15771.33 1827.21,-15796.28 1728.33,-15796.28 1656.04,-15771.33 1656.04,-15731.96 1728.33,-15707.02 1827.21,-15707.02 1899.5,-15731.96"/>
<text text-anchor="middle" x="1777.77" y="-15762.95" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1777.77" y="-15747.95" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1777.77" y="-15732.95" font-family="Times,serif" font-size="14.00">GPU5→GPU6</text>
</g>
<!-- residual2_6&#45;&gt;comm_6 -->
<g id="edge78" class="edge">
<title>residual2_6&#45;&gt;comm_6</title>
<path fill="none" stroke="black" d="M1777.77,-15833.2C1777.77,-15824.44 1777.77,-15815.33 1777.77,-15806.53"/>
<polygon fill="black" stroke="black" points="1781.27,-15806.37 1777.77,-15796.37 1774.27,-15806.37 1781.27,-15806.37"/>
</g>
<!-- ln1_7 -->
<g id="node68" class="node">
<title>ln1_7</title>
<polygon fill="lightgrey" stroke="black" points="1770.77,-15670.08 1626.77,-15670.08 1626.77,-15617.08 1770.77,-15617.08 1770.77,-15670.08"/>
<text text-anchor="middle" x="1698.77" y="-15654.88" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1698.77" y="-15639.88" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1698.77" y="-15624.88" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- comm_6&#45;&gt;ln1_7 -->
<g id="edge79" class="edge">
<title>comm_6&#45;&gt;ln1_7</title>
<path fill="none" stroke="black" d="M1745.18,-15706.89C1738.09,-15697.37 1730.69,-15687.43 1723.93,-15678.36"/>
<polygon fill="black" stroke="black" points="1726.72,-15676.25 1717.94,-15670.32 1721.1,-15680.43 1726.72,-15676.25"/>
</g>
<!-- residual1_7 -->
<g id="node72" class="node">
<title>residual1_7</title>
<polygon fill="lightgrey" stroke="black" points="1695.77,-15072.04 1402.77,-15019.04 1695.77,-14966.04 1988.77,-15019.04 1695.77,-15072.04"/>
<text text-anchor="middle" x="1695.77" y="-15030.34" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1695.77" y="-15015.34" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1695.77" y="-15000.34" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- comm_6&#45;&gt;residual1_7 -->
<g id="edge84" class="edge">
<title>comm_6&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1828.92,-15707.36C1844.1,-15689.81 1856.77,-15668.12 1856.77,-15644.58 1856.77,-15644.58 1856.77,-15644.58 1856.77,-15176.04 1856.77,-15144.96 1855.55,-15133.8 1836.77,-15109.04 1823.05,-15090.96 1804.52,-15075.6 1785.39,-15063"/>
<polygon fill="black" stroke="black" points="1787.2,-15060 1776.88,-15057.59 1783.44,-15065.91 1787.2,-15060"/>
<text text-anchor="middle" x="1885.77" y="-15414.88" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_7 -->
<g id="node69" class="node">
<title>qkv_proj_7</title>
<polygon fill="lightgrey" stroke="black" points="1828.31,-15580.08 1345.45,-15580.08 1221.23,-15444.08 1704.09,-15444.08 1828.31,-15580.08"/>
<text text-anchor="middle" x="1524.77" y="-15530.88" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1524.77" y="-15515.88" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="1524.77" y="-15500.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="1524.77" y="-15485.88" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_7&#45;&gt;qkv_proj_7 -->
<g id="edge80" class="edge">
<title>ln1_7&#45;&gt;qkv_proj_7</title>
<path fill="none" stroke="black" d="M1664.39,-15617C1652.27,-15607.98 1637.98,-15597.34 1623.23,-15586.36"/>
<polygon fill="black" stroke="black" points="1625.12,-15583.4 1615,-15580.24 1620.94,-15589.02 1625.12,-15583.4"/>
</g>
<!-- mha_7 -->
<g id="node70" class="node">
<title>mha_7</title>
<polygon fill="lightgrey" stroke="black" points="1770.24,-15337.56 1650.5,-15393.1 1411.04,-15393.1 1291.3,-15337.56 1411.04,-15282.02 1650.5,-15282.02 1770.24,-15337.56"/>
<text text-anchor="middle" x="1530.77" y="-15356.36" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1530.77" y="-15341.36" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="1530.77" y="-15326.36" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1530.77" y="-15311.36" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- qkv_proj_7&#45;&gt;mha_7 -->
<g id="edge81" class="edge">
<title>qkv_proj_7&#45;&gt;mha_7</title>
<path fill="none" stroke="black" d="M1527.11,-15443.89C1527.57,-15430.67 1528.05,-15416.83 1528.5,-15403.69"/>
<polygon fill="black" stroke="black" points="1532.01,-15403.43 1528.86,-15393.32 1525.02,-15403.19 1532.01,-15403.43"/>
</g>
<!-- out_proj_7 -->
<g id="node71" class="node">
<title>out_proj_7</title>
<polygon fill="lightgrey" stroke="black" points="1828.14,-15245.04 1359.86,-15245.04 1239.39,-15109.04 1707.68,-15109.04 1828.14,-15245.04"/>
<text text-anchor="middle" x="1533.77" y="-15195.84" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1533.77" y="-15180.84" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1533.77" y="-15165.84" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="1533.77" y="-15150.84" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_7&#45;&gt;out_proj_7 -->
<g id="edge82" class="edge">
<title>mha_7&#45;&gt;out_proj_7</title>
<path fill="none" stroke="black" d="M1531.8,-15282.01C1531.96,-15273.42 1532.13,-15264.4 1532.3,-15255.41"/>
<polygon fill="black" stroke="black" points="1535.81,-15255.37 1532.5,-15245.3 1528.81,-15255.23 1535.81,-15255.37"/>
</g>
<!-- out_proj_7&#45;&gt;residual1_7 -->
<g id="edge83" class="edge">
<title>out_proj_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M1603.41,-15108.97C1616.6,-15096.27 1630.2,-15083.18 1642.78,-15071.07"/>
<polygon fill="black" stroke="black" points="1645.27,-15073.52 1650.05,-15064.06 1640.42,-15068.48 1645.27,-15073.52"/>
</g>
<!-- ln2_7 -->
<g id="node73" class="node">
<title>ln2_7</title>
<polygon fill="lightgrey" stroke="black" points="1688.77,-14929.04 1544.77,-14929.04 1544.77,-14876.04 1688.77,-14876.04 1688.77,-14929.04"/>
<text text-anchor="middle" x="1616.77" y="-14913.84" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1616.77" y="-14898.84" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1616.77" y="-14883.84" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge85" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M1663.86,-14971.8C1655.96,-14960.34 1647.63,-14948.27 1640.21,-14937.51"/>
<polygon fill="black" stroke="black" points="1643.04,-14935.45 1634.48,-14929.21 1637.28,-14939.43 1643.04,-14935.45"/>
</g>
<!-- residual2_7 -->
<g id="node77" class="node">
<title>residual2_7</title>
<polygon fill="lightgrey" stroke="black" points="1608.77,-14367.08 1315.77,-14314.08 1608.77,-14261.08 1901.77,-14314.08 1608.77,-14367.08"/>
<text text-anchor="middle" x="1608.77" y="-14325.38" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1608.77" y="-14310.38" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1608.77" y="-14295.38" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- residual1_7&#45;&gt;residual2_7 -->
<g id="edge90" class="edge">
<title>residual1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1743.77,-14974.44C1760.32,-14954.75 1774.77,-14929.98 1774.77,-14903.54 1774.77,-14903.54 1774.77,-14903.54 1774.77,-14471.08 1774.77,-14440.13 1774.53,-14428.7 1755.77,-14404.08 1741.52,-14385.4 1722.13,-14369.79 1702.11,-14357.13"/>
<polygon fill="black" stroke="black" points="1703.86,-14354.1 1693.5,-14351.88 1700.22,-14360.08 1703.86,-14354.1"/>
<text text-anchor="middle" x="1803.77" y="-14673.84" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_7 -->
<g id="node74" class="node">
<title>mlp_fc1_7</title>
<polygon fill="lightgrey" stroke="black" points="1746.31,-14839.04 1263.45,-14839.04 1139.23,-14703.04 1622.09,-14703.04 1746.31,-14839.04"/>
<text text-anchor="middle" x="1442.77" y="-14789.84" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1442.77" y="-14774.84" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1442.77" y="-14759.84" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="1442.77" y="-14744.84" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_7&#45;&gt;mlp_fc1_7 -->
<g id="edge86" class="edge">
<title>ln2_7&#45;&gt;mlp_fc1_7</title>
<path fill="none" stroke="black" d="M1582.39,-14875.95C1570.27,-14866.94 1555.98,-14856.29 1541.23,-14845.32"/>
<polygon fill="black" stroke="black" points="1543.12,-14842.36 1533,-14839.2 1538.94,-14847.97 1543.12,-14842.36"/>
</g>
<!-- gelu_7 -->
<g id="node75" class="node">
<title>gelu_7</title>
<ellipse fill="lightgrey" stroke="black" cx="1442.77" cy="-14614.56" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1442.77" y="-14625.86" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1442.77" y="-14610.86" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1442.77" y="-14595.86" font-family="Times,serif" font-size="14.00">GPU6</text>
</g>
<!-- mlp_fc1_7&#45;&gt;gelu_7 -->
<g id="edge87" class="edge">
<title>mlp_fc1_7&#45;&gt;gelu_7</title>
<path fill="none" stroke="black" d="M1442.77,-14702.73C1442.77,-14689.14 1442.77,-14675.13 1442.77,-14662.42"/>
<polygon fill="black" stroke="black" points="1446.27,-14662.09 1442.77,-14652.09 1439.27,-14662.09 1446.27,-14662.09"/>
</g>
<!-- mlp_fc2_7 -->
<g id="node76" class="node">
<title>mlp_fc2_7</title>
<polygon fill="lightgrey" stroke="black" points="1746.31,-14540.08 1263.45,-14540.08 1139.23,-14404.08 1622.09,-14404.08 1746.31,-14540.08"/>
<text text-anchor="middle" x="1442.77" y="-14490.88" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1442.77" y="-14475.88" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1442.77" y="-14460.88" font-family="Times,serif" font-size="14.00">GPU6</text>
<text text-anchor="middle" x="1442.77" y="-14445.88" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_7&#45;&gt;mlp_fc2_7 -->
<g id="edge88" class="edge">
<title>gelu_7&#45;&gt;mlp_fc2_7</title>
<path fill="none" stroke="black" d="M1442.77,-14577.02C1442.77,-14568.72 1442.77,-14559.6 1442.77,-14550.32"/>
<polygon fill="black" stroke="black" points="1446.27,-14550.21 1442.77,-14540.21 1439.27,-14550.21 1446.27,-14550.21"/>
</g>
<!-- mlp_fc2_7&#45;&gt;residual2_7 -->
<g id="edge89" class="edge">
<title>mlp_fc2_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M1514.13,-14404.02C1527.65,-14391.32 1541.58,-14378.22 1554.47,-14366.12"/>
<polygon fill="black" stroke="black" points="1557.03,-14368.51 1561.92,-14359.11 1552.24,-14363.41 1557.03,-14368.51"/>
</g>
<!-- comm_7 -->
<g id="node78" class="node">
<title>comm_7</title>
<polygon fill="yellow" stroke="black" points="1726.51,-14162.69 1726.51,-14196.35 1657.54,-14220.14 1560,-14220.14 1491.03,-14196.35 1491.03,-14162.69 1560,-14138.9 1657.54,-14138.9 1726.51,-14162.69"/>
<polygon fill="none" stroke="black" points="1730.5,-14159.84 1730.5,-14199.2 1658.21,-14224.15 1559.33,-14224.15 1487.04,-14199.2 1487.04,-14159.84 1559.33,-14134.89 1658.21,-14134.89 1730.5,-14159.84"/>
<text text-anchor="middle" x="1608.77" y="-14190.82" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1608.77" y="-14175.82" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1608.77" y="-14160.82" font-family="Times,serif" font-size="14.00">GPU6→GPU7</text>
</g>
<!-- residual2_7&#45;&gt;comm_7 -->
<g id="edge91" class="edge">
<title>residual2_7&#45;&gt;comm_7</title>
<path fill="none" stroke="black" d="M1608.77,-14261.07C1608.77,-14252.31 1608.77,-14243.21 1608.77,-14234.4"/>
<polygon fill="black" stroke="black" points="1612.27,-14234.24 1608.77,-14224.24 1605.27,-14234.24 1612.27,-14234.24"/>
</g>
<!-- ln1_8 -->
<g id="node79" class="node">
<title>ln1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1601.77,-14097.96 1457.77,-14097.96 1457.77,-14044.96 1601.77,-14044.96 1601.77,-14097.96"/>
<text text-anchor="middle" x="1529.77" y="-14082.76" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1529.77" y="-14067.76" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1529.77" y="-14052.76" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- comm_7&#45;&gt;ln1_8 -->
<g id="edge92" class="edge">
<title>comm_7&#45;&gt;ln1_8</title>
<path fill="none" stroke="black" d="M1576.18,-14134.77C1569.09,-14125.24 1561.69,-14115.31 1554.93,-14106.24"/>
<polygon fill="black" stroke="black" points="1557.72,-14104.12 1548.94,-14098.19 1552.1,-14108.3 1557.72,-14104.12"/>
</g>
<!-- residual1_8 -->
<g id="node83" class="node">
<title>residual1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1526.77,-13499.91 1233.77,-13446.91 1526.77,-13393.91 1819.77,-13446.91 1526.77,-13499.91"/>
<text text-anchor="middle" x="1526.77" y="-13458.21" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1526.77" y="-13443.21" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1526.77" y="-13428.21" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- comm_7&#45;&gt;residual1_8 -->
<g id="edge97" class="edge">
<title>comm_7&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1659.92,-14135.23C1675.1,-14117.68 1687.77,-14095.99 1687.77,-14072.46 1687.77,-14072.46 1687.77,-14072.46 1687.77,-13603.91 1687.77,-13572.84 1686.55,-13561.67 1667.77,-13536.91 1654.05,-13518.83 1635.52,-13503.48 1616.39,-13490.88"/>
<polygon fill="black" stroke="black" points="1618.2,-13487.88 1607.88,-13485.46 1614.44,-13493.78 1618.2,-13487.88"/>
<text text-anchor="middle" x="1716.77" y="-13842.76" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_8 -->
<g id="node80" class="node">
<title>qkv_proj_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1659.31,-14007.96 1176.45,-14007.96 1052.23,-13871.96 1535.09,-13871.96 1659.31,-14007.96"/>
<text text-anchor="middle" x="1355.77" y="-13958.76" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1355.77" y="-13943.76" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="1355.77" y="-13928.76" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="1355.77" y="-13913.76" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_8&#45;&gt;qkv_proj_8 -->
<g id="edge93" class="edge">
<title>ln1_8&#45;&gt;qkv_proj_8</title>
<path fill="none" stroke="black" d="M1495.39,-14044.87C1483.27,-14035.85 1468.98,-14025.21 1454.23,-14014.24"/>
<polygon fill="black" stroke="black" points="1456.12,-14011.28 1446,-14008.11 1451.94,-14016.89 1456.12,-14011.28"/>
</g>
<!-- mha_8 -->
<g id="node81" class="node">
<title>mha_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1601.24,-13765.43 1481.5,-13820.98 1242.04,-13820.98 1122.3,-13765.43 1242.04,-13709.89 1481.5,-13709.89 1601.24,-13765.43"/>
<text text-anchor="middle" x="1361.77" y="-13784.23" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1361.77" y="-13769.23" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="1361.77" y="-13754.23" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1361.77" y="-13739.23" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- qkv_proj_8&#45;&gt;mha_8 -->
<g id="edge94" class="edge">
<title>qkv_proj_8&#45;&gt;mha_8</title>
<path fill="none" stroke="black" d="M1358.11,-13871.76C1358.57,-13858.55 1359.05,-13844.7 1359.5,-13831.56"/>
<polygon fill="black" stroke="black" points="1363.01,-13831.31 1359.86,-13821.19 1356.02,-13831.07 1363.01,-13831.31"/>
</g>
<!-- out_proj_8 -->
<g id="node82" class="node">
<title>out_proj_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1659.14,-13672.91 1190.86,-13672.91 1070.39,-13536.91 1538.68,-13536.91 1659.14,-13672.91"/>
<text text-anchor="middle" x="1364.77" y="-13623.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1364.77" y="-13608.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1364.77" y="-13593.71" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="1364.77" y="-13578.71" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_8&#45;&gt;out_proj_8 -->
<g id="edge95" class="edge">
<title>mha_8&#45;&gt;out_proj_8</title>
<path fill="none" stroke="black" d="M1362.8,-13709.88C1362.96,-13701.29 1363.13,-13692.27 1363.3,-13683.28"/>
<polygon fill="black" stroke="black" points="1366.81,-13683.24 1363.5,-13673.18 1359.81,-13683.11 1366.81,-13683.24"/>
</g>
<!-- out_proj_8&#45;&gt;residual1_8 -->
<g id="edge96" class="edge">
<title>out_proj_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1434.41,-13536.85C1447.6,-13524.15 1461.2,-13511.05 1473.78,-13498.94"/>
<polygon fill="black" stroke="black" points="1476.27,-13501.4 1481.05,-13491.94 1471.42,-13496.35 1476.27,-13501.4"/>
</g>
<!-- ln2_8 -->
<g id="node84" class="node">
<title>ln2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1519.77,-13356.91 1375.77,-13356.91 1375.77,-13303.91 1519.77,-13303.91 1519.77,-13356.91"/>
<text text-anchor="middle" x="1447.77" y="-13341.71" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1447.77" y="-13326.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1447.77" y="-13311.71" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge98" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M1494.86,-13399.67C1486.96,-13388.21 1478.63,-13376.14 1471.21,-13365.39"/>
<polygon fill="black" stroke="black" points="1474.04,-13363.33 1465.48,-13357.09 1468.28,-13367.3 1474.04,-13363.33"/>
</g>
<!-- residual2_8 -->
<g id="node88" class="node">
<title>residual2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1439.77,-12794.96 1146.77,-12741.96 1439.77,-12688.96 1732.77,-12741.96 1439.77,-12794.96"/>
<text text-anchor="middle" x="1439.77" y="-12753.26" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1439.77" y="-12738.26" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1439.77" y="-12723.26" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- residual1_8&#45;&gt;residual2_8 -->
<g id="edge103" class="edge">
<title>residual1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1574.77,-13402.32C1591.32,-13382.63 1605.77,-13357.86 1605.77,-13331.41 1605.77,-13331.41 1605.77,-13331.41 1605.77,-12898.96 1605.77,-12868.01 1605.53,-12856.57 1586.77,-12831.96 1572.52,-12813.28 1553.13,-12797.66 1533.11,-12785"/>
<polygon fill="black" stroke="black" points="1534.86,-12781.97 1524.5,-12779.76 1531.22,-12787.95 1534.86,-12781.97"/>
<text text-anchor="middle" x="1634.77" y="-13101.71" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_8 -->
<g id="node85" class="node">
<title>mlp_fc1_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1577.31,-13266.91 1094.45,-13266.91 970.23,-13130.91 1453.09,-13130.91 1577.31,-13266.91"/>
<text text-anchor="middle" x="1273.77" y="-13217.71" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1273.77" y="-13202.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1273.77" y="-13187.71" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="1273.77" y="-13172.71" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_8&#45;&gt;mlp_fc1_8 -->
<g id="edge99" class="edge">
<title>ln2_8&#45;&gt;mlp_fc1_8</title>
<path fill="none" stroke="black" d="M1413.39,-13303.83C1401.27,-13294.81 1386.98,-13284.17 1372.23,-13273.19"/>
<polygon fill="black" stroke="black" points="1374.12,-13270.23 1364,-13267.07 1369.94,-13275.85 1374.12,-13270.23"/>
</g>
<!-- gelu_8 -->
<g id="node86" class="node">
<title>gelu_8</title>
<ellipse fill="lightsteelblue" stroke="black" cx="1273.77" cy="-13042.44" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1273.77" y="-13053.74" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1273.77" y="-13038.74" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1273.77" y="-13023.74" font-family="Times,serif" font-size="14.00">GPU7</text>
</g>
<!-- mlp_fc1_8&#45;&gt;gelu_8 -->
<g id="edge100" class="edge">
<title>mlp_fc1_8&#45;&gt;gelu_8</title>
<path fill="none" stroke="black" d="M1273.77,-13130.61C1273.77,-13117.01 1273.77,-13103 1273.77,-13090.3"/>
<polygon fill="black" stroke="black" points="1277.27,-13089.97 1273.77,-13079.97 1270.27,-13089.97 1277.27,-13089.97"/>
</g>
<!-- mlp_fc2_8 -->
<g id="node87" class="node">
<title>mlp_fc2_8</title>
<polygon fill="lightsteelblue" stroke="black" points="1577.31,-12967.96 1094.45,-12967.96 970.23,-12831.96 1453.09,-12831.96 1577.31,-12967.96"/>
<text text-anchor="middle" x="1273.77" y="-12918.76" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1273.77" y="-12903.76" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1273.77" y="-12888.76" font-family="Times,serif" font-size="14.00">GPU7</text>
<text text-anchor="middle" x="1273.77" y="-12873.76" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_8&#45;&gt;mlp_fc2_8 -->
<g id="edge101" class="edge">
<title>gelu_8&#45;&gt;mlp_fc2_8</title>
<path fill="none" stroke="black" d="M1273.77,-13004.89C1273.77,-12996.6 1273.77,-12987.47 1273.77,-12978.19"/>
<polygon fill="black" stroke="black" points="1277.27,-12978.08 1273.77,-12968.08 1270.27,-12978.08 1277.27,-12978.08"/>
</g>
<!-- mlp_fc2_8&#45;&gt;residual2_8 -->
<g id="edge102" class="edge">
<title>mlp_fc2_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1345.13,-12831.9C1358.65,-12819.19 1372.58,-12806.1 1385.47,-12793.99"/>
<polygon fill="black" stroke="black" points="1388.03,-12796.38 1392.92,-12786.99 1383.24,-12791.28 1388.03,-12796.38"/>
</g>
<!-- comm_8 -->
<g id="node89" class="node">
<title>comm_8</title>
<polygon fill="yellow" stroke="black" points="1557.51,-12590.57 1557.51,-12624.22 1488.54,-12648.02 1391,-12648.02 1322.03,-12624.22 1322.03,-12590.57 1391,-12566.77 1488.54,-12566.77 1557.51,-12590.57"/>
<polygon fill="none" stroke="black" points="1561.5,-12587.71 1561.5,-12627.08 1489.21,-12652.02 1390.33,-12652.02 1318.04,-12627.08 1318.04,-12587.71 1390.33,-12562.77 1489.21,-12562.77 1561.5,-12587.71"/>
<text text-anchor="middle" x="1439.77" y="-12618.69" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1439.77" y="-12603.69" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1439.77" y="-12588.69" font-family="Times,serif" font-size="14.00">GPU7→GPU8</text>
</g>
<!-- residual2_8&#45;&gt;comm_8 -->
<g id="edge104" class="edge">
<title>residual2_8&#45;&gt;comm_8</title>
<path fill="none" stroke="black" d="M1439.77,-12688.95C1439.77,-12680.19 1439.77,-12671.08 1439.77,-12662.28"/>
<polygon fill="black" stroke="black" points="1443.27,-12662.12 1439.77,-12652.12 1436.27,-12662.12 1443.27,-12662.12"/>
</g>
<!-- ln1_9 -->
<g id="node90" class="node">
<title>ln1_9</title>
<polygon fill="lightsalmon" stroke="black" points="1432.77,-12525.83 1288.77,-12525.83 1288.77,-12472.83 1432.77,-12472.83 1432.77,-12525.83"/>
<text text-anchor="middle" x="1360.77" y="-12510.63" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1360.77" y="-12495.63" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1360.77" y="-12480.63" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- comm_8&#45;&gt;ln1_9 -->
<g id="edge105" class="edge">
<title>comm_8&#45;&gt;ln1_9</title>
<path fill="none" stroke="black" d="M1407.18,-12562.64C1400.09,-12553.12 1392.69,-12543.18 1385.93,-12534.11"/>
<polygon fill="black" stroke="black" points="1388.72,-12532 1379.94,-12526.07 1383.1,-12536.18 1388.72,-12532"/>
</g>
<!-- residual1_9 -->
<g id="node94" class="node">
<title>residual1_9</title>
<polygon fill="lightsalmon" stroke="black" points="1430.77,-11927.79 1137.77,-11874.79 1430.77,-11821.79 1723.77,-11874.79 1430.77,-11927.79"/>
<text text-anchor="middle" x="1430.77" y="-11886.09" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1430.77" y="-11871.09" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1430.77" y="-11856.09" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- comm_8&#45;&gt;residual1_9 -->
<g id="edge110" class="edge">
<title>comm_8&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1490.92,-12563.11C1506.1,-12545.56 1518.77,-12523.86 1518.77,-12500.33 1518.77,-12500.33 1518.77,-12500.33 1518.77,-12031.79 1518.77,-11994.15 1499.09,-11957.22 1478.35,-11928.75"/>
<polygon fill="black" stroke="black" points="1481,-11926.46 1472.19,-11920.58 1475.41,-11930.67 1481,-11926.46"/>
<text text-anchor="middle" x="1547.77" y="-12270.63" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_9 -->
<g id="node91" class="node">
<title>qkv_proj_9</title>
<polygon fill="lightsalmon" stroke="black" points="1490.31,-12435.83 1007.45,-12435.83 883.23,-12299.83 1366.09,-12299.83 1490.31,-12435.83"/>
<text text-anchor="middle" x="1186.77" y="-12386.63" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1186.77" y="-12371.63" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="1186.77" y="-12356.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="1186.77" y="-12341.63" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_9&#45;&gt;qkv_proj_9 -->
<g id="edge106" class="edge">
<title>ln1_9&#45;&gt;qkv_proj_9</title>
<path fill="none" stroke="black" d="M1326.39,-12472.75C1314.27,-12463.73 1299.98,-12453.09 1285.23,-12442.11"/>
<polygon fill="black" stroke="black" points="1287.12,-12439.15 1277,-12435.99 1282.94,-12444.77 1287.12,-12439.15"/>
</g>
<!-- mha_9 -->
<g id="node92" class="node">
<title>mha_9</title>
<polygon fill="lightsalmon" stroke="black" points="1432.24,-12193.31 1312.5,-12248.85 1073.04,-12248.85 953.3,-12193.31 1073.04,-12137.77 1312.5,-12137.77 1432.24,-12193.31"/>
<text text-anchor="middle" x="1192.77" y="-12212.11" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1192.77" y="-12197.11" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="1192.77" y="-12182.11" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1192.77" y="-12167.11" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- qkv_proj_9&#45;&gt;mha_9 -->
<g id="edge107" class="edge">
<title>qkv_proj_9&#45;&gt;mha_9</title>
<path fill="none" stroke="black" d="M1189.11,-12299.63C1189.57,-12286.42 1190.05,-12272.58 1190.5,-12259.43"/>
<polygon fill="black" stroke="black" points="1194.01,-12259.18 1190.86,-12249.07 1187.02,-12258.94 1194.01,-12259.18"/>
</g>
<!-- out_proj_9 -->
<g id="node93" class="node">
<title>out_proj_9</title>
<polygon fill="lightsalmon" stroke="black" points="1490.14,-12100.79 1021.86,-12100.79 901.39,-11964.79 1369.68,-11964.79 1490.14,-12100.79"/>
<text text-anchor="middle" x="1195.77" y="-12051.59" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1195.77" y="-12036.59" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1195.77" y="-12021.59" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="1195.77" y="-12006.59" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_9&#45;&gt;out_proj_9 -->
<g id="edge108" class="edge">
<title>mha_9&#45;&gt;out_proj_9</title>
<path fill="none" stroke="black" d="M1193.8,-12137.75C1193.96,-12129.17 1194.13,-12120.15 1194.3,-12111.16"/>
<polygon fill="black" stroke="black" points="1197.81,-12111.11 1194.5,-12101.05 1190.81,-12110.98 1197.81,-12111.11"/>
</g>
<!-- out_proj_9&#45;&gt;residual1_9 -->
<g id="edge109" class="edge">
<title>out_proj_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1296.79,-11964.72C1318.35,-11950.42 1340.65,-11935.61 1360.74,-11922.28"/>
<polygon fill="black" stroke="black" points="1362.8,-11925.11 1369.2,-11916.66 1358.93,-11919.27 1362.8,-11925.11"/>
</g>
<!-- ln2_9 -->
<g id="node95" class="node">
<title>ln2_9</title>
<polygon fill="lightsalmon" stroke="black" points="1423.77,-11784.79 1279.77,-11784.79 1279.77,-11731.79 1423.77,-11731.79 1423.77,-11784.79"/>
<text text-anchor="middle" x="1351.77" y="-11769.59" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1351.77" y="-11754.59" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1351.77" y="-11739.59" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge111" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M1398.86,-11827.55C1390.96,-11816.09 1382.63,-11804.01 1375.21,-11793.26"/>
<polygon fill="black" stroke="black" points="1378.04,-11791.2 1369.48,-11784.96 1372.28,-11795.18 1378.04,-11791.2"/>
</g>
<!-- residual2_9 -->
<g id="node99" class="node">
<title>residual2_9</title>
<polygon fill="lightsalmon" stroke="black" points="1419.77,-11222.83 1126.77,-11169.83 1419.77,-11116.83 1712.77,-11169.83 1419.77,-11222.83"/>
<text text-anchor="middle" x="1419.77" y="-11181.13" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1419.77" y="-11166.13" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1419.77" y="-11151.13" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- residual1_9&#45;&gt;residual2_9 -->
<g id="edge116" class="edge">
<title>residual1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1478.77,-11830.19C1495.32,-11810.5 1509.77,-11785.73 1509.77,-11759.29 1509.77,-11759.29 1509.77,-11759.29 1509.77,-11326.83 1509.77,-11288.98 1489.65,-11252.05 1468.43,-11223.63"/>
<polygon fill="black" stroke="black" points="1471.01,-11221.24 1462.13,-11215.47 1465.47,-11225.52 1471.01,-11221.24"/>
<text text-anchor="middle" x="1538.77" y="-11529.59" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_9 -->
<g id="node96" class="node">
<title>mlp_fc1_9</title>
<polygon fill="lightsalmon" stroke="black" points="1481.31,-11694.79 998.45,-11694.79 874.23,-11558.79 1357.09,-11558.79 1481.31,-11694.79"/>
<text text-anchor="middle" x="1177.77" y="-11645.59" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1177.77" y="-11630.59" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1177.77" y="-11615.59" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="1177.77" y="-11600.59" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_9&#45;&gt;mlp_fc1_9 -->
<g id="edge112" class="edge">
<title>ln2_9&#45;&gt;mlp_fc1_9</title>
<path fill="none" stroke="black" d="M1317.39,-11731.7C1305.27,-11722.68 1290.98,-11712.04 1276.23,-11701.07"/>
<polygon fill="black" stroke="black" points="1278.12,-11698.11 1268,-11694.94 1273.94,-11703.72 1278.12,-11698.11"/>
</g>
<!-- gelu_9 -->
<g id="node97" class="node">
<title>gelu_9</title>
<ellipse fill="lightsalmon" stroke="black" cx="1177.77" cy="-11470.31" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1177.77" y="-11481.61" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1177.77" y="-11466.61" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1177.77" y="-11451.61" font-family="Times,serif" font-size="14.00">GPU8</text>
</g>
<!-- mlp_fc1_9&#45;&gt;gelu_9 -->
<g id="edge113" class="edge">
<title>mlp_fc1_9&#45;&gt;gelu_9</title>
<path fill="none" stroke="black" d="M1177.77,-11558.48C1177.77,-11544.89 1177.77,-11530.88 1177.77,-11518.17"/>
<polygon fill="black" stroke="black" points="1181.27,-11517.84 1177.77,-11507.84 1174.27,-11517.84 1181.27,-11517.84"/>
</g>
<!-- mlp_fc2_9 -->
<g id="node98" class="node">
<title>mlp_fc2_9</title>
<polygon fill="lightsalmon" stroke="black" points="1481.31,-11395.83 998.45,-11395.83 874.23,-11259.83 1357.09,-11259.83 1481.31,-11395.83"/>
<text text-anchor="middle" x="1177.77" y="-11346.63" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1177.77" y="-11331.63" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1177.77" y="-11316.63" font-family="Times,serif" font-size="14.00">GPU8</text>
<text text-anchor="middle" x="1177.77" y="-11301.63" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_9&#45;&gt;mlp_fc2_9 -->
<g id="edge114" class="edge">
<title>gelu_9&#45;&gt;mlp_fc2_9</title>
<path fill="none" stroke="black" d="M1177.77,-11432.77C1177.77,-11424.47 1177.77,-11415.35 1177.77,-11406.06"/>
<polygon fill="black" stroke="black" points="1181.27,-11405.95 1177.77,-11395.95 1174.27,-11405.95 1181.27,-11405.95"/>
</g>
<!-- mlp_fc2_9&#45;&gt;residual2_9 -->
<g id="edge115" class="edge">
<title>mlp_fc2_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M1281.8,-11259.77C1304.21,-11245.33 1327.41,-11230.37 1348.24,-11216.94"/>
<polygon fill="black" stroke="black" points="1350.2,-11219.84 1356.71,-11211.48 1346.41,-11213.96 1350.2,-11219.84"/>
</g>
<!-- comm_9 -->
<g id="node100" class="node">
<title>comm_9</title>
<polygon fill="yellow" stroke="black" points="1537.51,-11018.44 1537.51,-11052.1 1468.54,-11075.89 1371,-11075.89 1302.03,-11052.1 1302.03,-11018.44 1371,-10994.65 1468.54,-10994.65 1537.51,-11018.44"/>
<polygon fill="none" stroke="black" points="1541.5,-11015.58 1541.5,-11054.95 1469.21,-11079.9 1370.33,-11079.9 1298.04,-11054.95 1298.04,-11015.58 1370.33,-10990.64 1469.21,-10990.64 1541.5,-11015.58"/>
<text text-anchor="middle" x="1419.77" y="-11046.57" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1419.77" y="-11031.57" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1419.77" y="-11016.57" font-family="Times,serif" font-size="14.00">GPU8→GPU9</text>
</g>
<!-- residual2_9&#45;&gt;comm_9 -->
<g id="edge117" class="edge">
<title>residual2_9&#45;&gt;comm_9</title>
<path fill="none" stroke="black" d="M1419.77,-11116.82C1419.77,-11108.06 1419.77,-11098.95 1419.77,-11090.15"/>
<polygon fill="black" stroke="black" points="1423.27,-11089.99 1419.77,-11079.99 1416.27,-11089.99 1423.27,-11089.99"/>
</g>
<!-- ln1_10 -->
<g id="node101" class="node">
<title>ln1_10</title>
<polygon fill="lightseagreen" stroke="black" points="1412.77,-10953.7 1268.77,-10953.7 1268.77,-10900.7 1412.77,-10900.7 1412.77,-10953.7"/>
<text text-anchor="middle" x="1340.77" y="-10938.5" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1340.77" y="-10923.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1340.77" y="-10908.5" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- comm_9&#45;&gt;ln1_10 -->
<g id="edge118" class="edge">
<title>comm_9&#45;&gt;ln1_10</title>
<path fill="none" stroke="black" d="M1387.18,-10990.52C1380.09,-10980.99 1372.69,-10971.06 1365.93,-10961.99"/>
<polygon fill="black" stroke="black" points="1368.72,-10959.87 1359.94,-10953.94 1363.1,-10964.05 1368.72,-10959.87"/>
</g>
<!-- residual1_10 -->
<g id="node105" class="node">
<title>residual1_10</title>
<polygon fill="lightseagreen" stroke="black" points="1337.77,-10355.66 1044.77,-10302.66 1337.77,-10249.66 1630.77,-10302.66 1337.77,-10355.66"/>
<text text-anchor="middle" x="1337.77" y="-10313.96" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1337.77" y="-10298.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1337.77" y="-10283.96" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- comm_9&#45;&gt;residual1_10 -->
<g id="edge123" class="edge">
<title>comm_9&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1470.92,-10990.98C1486.1,-10973.43 1498.77,-10951.74 1498.77,-10928.2 1498.77,-10928.2 1498.77,-10928.2 1498.77,-10459.66 1498.77,-10428.58 1497.55,-10417.42 1478.77,-10392.66 1465.05,-10374.58 1446.52,-10359.23 1427.39,-10346.62"/>
<polygon fill="black" stroke="black" points="1429.2,-10343.62 1418.88,-10341.21 1425.44,-10349.53 1429.2,-10343.62"/>
<text text-anchor="middle" x="1527.77" y="-10698.5" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_10 -->
<g id="node102" class="node">
<title>qkv_proj_10</title>
<polygon fill="lightseagreen" stroke="black" points="1470.31,-10863.7 987.45,-10863.7 863.23,-10727.7 1346.09,-10727.7 1470.31,-10863.7"/>
<text text-anchor="middle" x="1166.77" y="-10814.5" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1166.77" y="-10799.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="1166.77" y="-10784.5" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="1166.77" y="-10769.5" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_10&#45;&gt;qkv_proj_10 -->
<g id="edge119" class="edge">
<title>ln1_10&#45;&gt;qkv_proj_10</title>
<path fill="none" stroke="black" d="M1306.39,-10900.62C1294.27,-10891.6 1279.98,-10880.96 1265.23,-10869.99"/>
<polygon fill="black" stroke="black" points="1267.12,-10867.03 1257,-10863.86 1262.94,-10872.64 1267.12,-10867.03"/>
</g>
<!-- mha_10 -->
<g id="node103" class="node">
<title>mha_10</title>
<polygon fill="lightseagreen" stroke="black" points="1412.24,-10621.18 1292.5,-10676.73 1053.04,-10676.73 933.3,-10621.18 1053.04,-10565.64 1292.5,-10565.64 1412.24,-10621.18"/>
<text text-anchor="middle" x="1172.77" y="-10639.98" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1172.77" y="-10624.98" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="1172.77" y="-10609.98" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1172.77" y="-10594.98" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- qkv_proj_10&#45;&gt;mha_10 -->
<g id="edge120" class="edge">
<title>qkv_proj_10&#45;&gt;mha_10</title>
<path fill="none" stroke="black" d="M1169.11,-10727.51C1169.57,-10714.3 1170.05,-10700.45 1170.5,-10687.31"/>
<polygon fill="black" stroke="black" points="1174.01,-10687.06 1170.86,-10676.94 1167.02,-10686.81 1174.01,-10687.06"/>
</g>
<!-- out_proj_10 -->
<g id="node104" class="node">
<title>out_proj_10</title>
<polygon fill="lightseagreen" stroke="black" points="1470.14,-10528.66 1001.86,-10528.66 881.39,-10392.66 1349.68,-10392.66 1470.14,-10528.66"/>
<text text-anchor="middle" x="1175.77" y="-10479.46" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1175.77" y="-10464.46" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1175.77" y="-10449.46" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="1175.77" y="-10434.46" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_10&#45;&gt;out_proj_10 -->
<g id="edge121" class="edge">
<title>mha_10&#45;&gt;out_proj_10</title>
<path fill="none" stroke="black" d="M1173.8,-10565.63C1173.96,-10557.04 1174.13,-10548.02 1174.3,-10539.03"/>
<polygon fill="black" stroke="black" points="1177.81,-10538.99 1174.5,-10528.92 1170.81,-10538.86 1177.81,-10538.99"/>
</g>
<!-- out_proj_10&#45;&gt;residual1_10 -->
<g id="edge122" class="edge">
<title>out_proj_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1245.41,-10392.6C1258.6,-10379.9 1272.2,-10366.8 1284.78,-10354.69"/>
<polygon fill="black" stroke="black" points="1287.27,-10357.14 1292.05,-10347.69 1282.42,-10352.1 1287.27,-10357.14"/>
</g>
<!-- ln2_10 -->
<g id="node106" class="node">
<title>ln2_10</title>
<polygon fill="lightseagreen" stroke="black" points="1334.77,-10212.66 1190.77,-10212.66 1190.77,-10159.66 1334.77,-10159.66 1334.77,-10212.66"/>
<text text-anchor="middle" x="1262.77" y="-10197.46" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1262.77" y="-10182.46" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1262.77" y="-10167.46" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge124" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M1307.26,-10255.09C1299.85,-10243.77 1292.06,-10231.87 1285.1,-10221.26"/>
<polygon fill="black" stroke="black" points="1287.89,-10219.13 1279.48,-10212.68 1282.04,-10222.96 1287.89,-10219.13"/>
</g>
<!-- residual2_10 -->
<g id="node110" class="node">
<title>residual2_10</title>
<polygon fill="lightseagreen" stroke="black" points="1254.77,-9650.71 961.77,-9597.71 1254.77,-9544.71 1547.77,-9597.71 1254.77,-9650.71"/>
<text text-anchor="middle" x="1254.77" y="-9609.01" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1254.77" y="-9594.01" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1254.77" y="-9579.01" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- residual1_10&#45;&gt;residual2_10 -->
<g id="edge129" class="edge">
<title>residual1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1388.2,-10258.5C1405.58,-10238.88 1420.77,-10214.05 1420.77,-10187.16 1420.77,-10187.16 1420.77,-10187.16 1420.77,-9754.71 1420.77,-9723.76 1420.53,-9712.32 1401.77,-9687.71 1387.52,-9669.02 1368.13,-9653.41 1348.11,-9640.75"/>
<polygon fill="black" stroke="black" points="1349.86,-9637.72 1339.5,-9635.51 1346.22,-9643.7 1349.86,-9637.72"/>
<text text-anchor="middle" x="1449.77" y="-9957.46" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_10 -->
<g id="node107" class="node">
<title>mlp_fc1_10</title>
<polygon fill="lightseagreen" stroke="black" points="1392.31,-10122.66 909.45,-10122.66 785.23,-9986.66 1268.09,-9986.66 1392.31,-10122.66"/>
<text text-anchor="middle" x="1088.77" y="-10073.46" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="1088.77" y="-10058.46" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="1088.77" y="-10043.46" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="1088.77" y="-10028.46" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_10&#45;&gt;mlp_fc1_10 -->
<g id="edge125" class="edge">
<title>ln2_10&#45;&gt;mlp_fc1_10</title>
<path fill="none" stroke="black" d="M1228.39,-10159.58C1216.27,-10150.56 1201.98,-10139.92 1187.23,-10128.94"/>
<polygon fill="black" stroke="black" points="1189.12,-10125.98 1179,-10122.82 1184.94,-10131.6 1189.12,-10125.98"/>
</g>
<!-- gelu_10 -->
<g id="node108" class="node">
<title>gelu_10</title>
<ellipse fill="lightseagreen" stroke="black" cx="1088.77" cy="-9898.18" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="1088.77" y="-9909.48" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1088.77" y="-9894.48" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="1088.77" y="-9879.48" font-family="Times,serif" font-size="14.00">GPU9</text>
</g>
<!-- mlp_fc1_10&#45;&gt;gelu_10 -->
<g id="edge126" class="edge">
<title>mlp_fc1_10&#45;&gt;gelu_10</title>
<path fill="none" stroke="black" d="M1088.77,-9986.35C1088.77,-9972.76 1088.77,-9958.75 1088.77,-9946.05"/>
<polygon fill="black" stroke="black" points="1092.27,-9945.72 1088.77,-9935.72 1085.27,-9945.72 1092.27,-9945.72"/>
</g>
<!-- mlp_fc2_10 -->
<g id="node109" class="node">
<title>mlp_fc2_10</title>
<polygon fill="lightseagreen" stroke="black" points="1392.31,-9823.71 909.45,-9823.71 785.23,-9687.71 1268.09,-9687.71 1392.31,-9823.71"/>
<text text-anchor="middle" x="1088.77" y="-9774.51" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="1088.77" y="-9759.51" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1088.77" y="-9744.51" font-family="Times,serif" font-size="14.00">GPU9</text>
<text text-anchor="middle" x="1088.77" y="-9729.51" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_10&#45;&gt;mlp_fc2_10 -->
<g id="edge127" class="edge">
<title>gelu_10&#45;&gt;mlp_fc2_10</title>
<path fill="none" stroke="black" d="M1088.77,-9860.64C1088.77,-9852.34 1088.77,-9843.22 1088.77,-9833.94"/>
<polygon fill="black" stroke="black" points="1092.27,-9833.83 1088.77,-9823.83 1085.27,-9833.83 1092.27,-9833.83"/>
</g>
<!-- mlp_fc2_10&#45;&gt;residual2_10 -->
<g id="edge128" class="edge">
<title>mlp_fc2_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M1160.13,-9687.64C1173.65,-9674.94 1187.58,-9661.85 1200.47,-9649.74"/>
<polygon fill="black" stroke="black" points="1203.03,-9652.13 1207.92,-9642.73 1198.24,-9647.03 1203.03,-9652.13"/>
</g>
<!-- comm_10 -->
<g id="node111" class="node">
<title>comm_10</title>
<polygon fill="yellow" stroke="black" points="1372.51,-9446.32 1372.51,-9479.97 1303.54,-9503.77 1206,-9503.77 1137.03,-9479.97 1137.03,-9446.32 1206,-9422.52 1303.54,-9422.52 1372.51,-9446.32"/>
<polygon fill="none" stroke="black" points="1376.5,-9443.46 1376.5,-9482.83 1304.21,-9507.77 1205.33,-9507.77 1133.04,-9482.83 1133.04,-9443.46 1205.33,-9418.51 1304.21,-9418.51 1376.5,-9443.46"/>
<text text-anchor="middle" x="1254.77" y="-9474.44" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1254.77" y="-9459.44" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1254.77" y="-9444.44" font-family="Times,serif" font-size="14.00">GPU9→GPU10</text>
</g>
<!-- residual2_10&#45;&gt;comm_10 -->
<g id="edge130" class="edge">
<title>residual2_10&#45;&gt;comm_10</title>
<path fill="none" stroke="black" d="M1254.77,-9544.7C1254.77,-9535.94 1254.77,-9526.83 1254.77,-9518.02"/>
<polygon fill="black" stroke="black" points="1258.27,-9517.87 1254.77,-9507.87 1251.27,-9517.87 1258.27,-9517.87"/>
</g>
<!-- ln1_11 -->
<g id="node112" class="node">
<title>ln1_11</title>
<polygon fill="lightskyblue" stroke="black" points="1247.77,-9381.58 1103.77,-9381.58 1103.77,-9328.58 1247.77,-9328.58 1247.77,-9381.58"/>
<text text-anchor="middle" x="1175.77" y="-9366.38" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1175.77" y="-9351.38" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1175.77" y="-9336.38" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- comm_10&#45;&gt;ln1_11 -->
<g id="edge131" class="edge">
<title>comm_10&#45;&gt;ln1_11</title>
<path fill="none" stroke="black" d="M1222.18,-9418.39C1215.09,-9408.87 1207.69,-9398.93 1200.93,-9389.86"/>
<polygon fill="black" stroke="black" points="1203.72,-9387.74 1194.94,-9381.82 1198.1,-9391.93 1203.72,-9387.74"/>
</g>
<!-- residual1_11 -->
<g id="node116" class="node">
<title>residual1_11</title>
<polygon fill="lightskyblue" stroke="black" points="1172.77,-8783.54 879.77,-8730.54 1172.77,-8677.54 1465.77,-8730.54 1172.77,-8783.54"/>
<text text-anchor="middle" x="1172.77" y="-8741.84" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1172.77" y="-8726.84" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1172.77" y="-8711.84" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- comm_10&#45;&gt;residual1_11 -->
<g id="edge136" class="edge">
<title>comm_10&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1305.92,-9418.86C1321.1,-9401.31 1333.77,-9379.61 1333.77,-9356.08 1333.77,-9356.08 1333.77,-9356.08 1333.77,-8887.54 1333.77,-8856.46 1332.55,-8845.29 1313.77,-8820.54 1300.05,-8802.45 1281.52,-8787.1 1262.39,-8774.5"/>
<polygon fill="black" stroke="black" points="1264.2,-8771.5 1253.88,-8769.09 1260.44,-8777.41 1264.2,-8771.5"/>
<text text-anchor="middle" x="1362.77" y="-9126.38" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_11 -->
<g id="node113" class="node">
<title>qkv_proj_11</title>
<polygon fill="lightskyblue" stroke="black" points="1305.31,-9291.58 822.45,-9291.58 698.23,-9155.58 1181.09,-9155.58 1305.31,-9291.58"/>
<text text-anchor="middle" x="1001.77" y="-9242.38" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1001.77" y="-9227.38" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="1001.77" y="-9212.38" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="1001.77" y="-9197.38" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_11&#45;&gt;qkv_proj_11 -->
<g id="edge132" class="edge">
<title>ln1_11&#45;&gt;qkv_proj_11</title>
<path fill="none" stroke="black" d="M1141.39,-9328.49C1129.27,-9319.48 1114.98,-9308.83 1100.23,-9297.86"/>
<polygon fill="black" stroke="black" points="1102.12,-9294.9 1092,-9291.74 1097.94,-9300.51 1102.12,-9294.9"/>
</g>
<!-- mha_11 -->
<g id="node114" class="node">
<title>mha_11</title>
<polygon fill="lightskyblue" stroke="black" points="1248.24,-9049.06 1128.5,-9104.6 889.04,-9104.6 769.3,-9049.06 889.04,-8993.51 1128.5,-8993.51 1248.24,-9049.06"/>
<text text-anchor="middle" x="1008.77" y="-9067.86" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="1008.77" y="-9052.86" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="1008.77" y="-9037.86" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1008.77" y="-9022.86" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- qkv_proj_11&#45;&gt;mha_11 -->
<g id="edge133" class="edge">
<title>qkv_proj_11&#45;&gt;mha_11</title>
<path fill="none" stroke="black" d="M1004.5,-9155.38C1005.03,-9142.17 1005.59,-9128.33 1006.13,-9115.18"/>
<polygon fill="black" stroke="black" points="1009.64,-9114.95 1006.55,-9104.82 1002.64,-9114.67 1009.64,-9114.95"/>
</g>
<!-- out_proj_11 -->
<g id="node115" class="node">
<title>out_proj_11</title>
<polygon fill="lightskyblue" stroke="black" points="1305.14,-8956.54 836.86,-8956.54 716.39,-8820.54 1184.68,-8820.54 1305.14,-8956.54"/>
<text text-anchor="middle" x="1010.77" y="-8907.34" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1010.77" y="-8892.34" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="1010.77" y="-8877.34" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="1010.77" y="-8862.34" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_11&#45;&gt;out_proj_11 -->
<g id="edge134" class="edge">
<title>mha_11&#45;&gt;out_proj_11</title>
<path fill="none" stroke="black" d="M1009.46,-8993.5C1009.57,-8984.91 1009.68,-8975.89 1009.79,-8966.91"/>
<polygon fill="black" stroke="black" points="1013.29,-8966.84 1009.92,-8956.8 1006.29,-8966.75 1013.29,-8966.84"/>
</g>
<!-- out_proj_11&#45;&gt;residual1_11 -->
<g id="edge135" class="edge">
<title>out_proj_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M1080.41,-8820.47C1093.6,-8807.77 1107.2,-8794.67 1119.78,-8782.57"/>
<polygon fill="black" stroke="black" points="1122.27,-8785.02 1127.05,-8775.56 1117.42,-8779.98 1122.27,-8785.02"/>
</g>
<!-- ln2_11 -->
<g id="node117" class="node">
<title>ln2_11</title>
<polygon fill="lightskyblue" stroke="black" points="1165.77,-8640.54 1021.77,-8640.54 1021.77,-8587.54 1165.77,-8587.54 1165.77,-8640.54"/>
<text text-anchor="middle" x="1093.77" y="-8625.34" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1093.77" y="-8610.34" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1093.77" y="-8595.34" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge137" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M1140.86,-8683.29C1132.96,-8671.83 1124.63,-8659.76 1117.21,-8649.01"/>
<polygon fill="black" stroke="black" points="1120.04,-8646.95 1111.48,-8640.71 1114.28,-8650.93 1120.04,-8646.95"/>
</g>
<!-- residual2_11 -->
<g id="node121" class="node">
<title>residual2_11</title>
<polygon fill="lightskyblue" stroke="black" points="1161.77,-8078.58 868.77,-8025.58 1161.77,-7972.58 1454.77,-8025.58 1161.77,-8078.58"/>
<text text-anchor="middle" x="1161.77" y="-8036.88" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1161.77" y="-8021.88" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1161.77" y="-8006.88" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- residual1_11&#45;&gt;residual2_11 -->
<g id="edge142" class="edge">
<title>residual1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1220.77,-8685.94C1237.32,-8666.25 1251.77,-8641.48 1251.77,-8615.04 1251.77,-8615.04 1251.77,-8615.04 1251.77,-8182.58 1251.77,-8144.73 1231.65,-8107.8 1210.43,-8079.37"/>
<polygon fill="black" stroke="black" points="1213.01,-8076.99 1204.13,-8071.21 1207.47,-8081.27 1213.01,-8076.99"/>
<text text-anchor="middle" x="1280.77" y="-8385.34" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_11 -->
<g id="node118" class="node">
<title>mlp_fc1_11</title>
<polygon fill="lightskyblue" stroke="black" points="1223.31,-8550.54 740.45,-8550.54 616.23,-8414.54 1099.09,-8414.54 1223.31,-8550.54"/>
<text text-anchor="middle" x="919.77" y="-8501.34" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="919.77" y="-8486.34" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="919.77" y="-8471.34" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="919.77" y="-8456.34" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_11&#45;&gt;mlp_fc1_11 -->
<g id="edge138" class="edge">
<title>ln2_11&#45;&gt;mlp_fc1_11</title>
<path fill="none" stroke="black" d="M1059.39,-8587.45C1047.27,-8578.43 1032.98,-8567.79 1018.23,-8556.82"/>
<polygon fill="black" stroke="black" points="1020.12,-8553.86 1010,-8550.69 1015.94,-8559.47 1020.12,-8553.86"/>
</g>
<!-- gelu_11 -->
<g id="node119" class="node">
<title>gelu_11</title>
<ellipse fill="lightskyblue" stroke="black" cx="919.77" cy="-8326.06" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="919.77" y="-8337.36" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="919.77" y="-8322.36" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="919.77" y="-8307.36" font-family="Times,serif" font-size="14.00">GPU10</text>
</g>
<!-- mlp_fc1_11&#45;&gt;gelu_11 -->
<g id="edge139" class="edge">
<title>mlp_fc1_11&#45;&gt;gelu_11</title>
<path fill="none" stroke="black" d="M919.77,-8414.23C919.77,-8400.64 919.77,-8386.63 919.77,-8373.92"/>
<polygon fill="black" stroke="black" points="923.27,-8373.59 919.77,-8363.59 916.27,-8373.59 923.27,-8373.59"/>
</g>
<!-- mlp_fc2_11 -->
<g id="node120" class="node">
<title>mlp_fc2_11</title>
<polygon fill="lightskyblue" stroke="black" points="1223.31,-8251.58 740.45,-8251.58 616.23,-8115.58 1099.09,-8115.58 1223.31,-8251.58"/>
<text text-anchor="middle" x="919.77" y="-8202.38" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="919.77" y="-8187.38" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="919.77" y="-8172.38" font-family="Times,serif" font-size="14.00">GPU10</text>
<text text-anchor="middle" x="919.77" y="-8157.38" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_11&#45;&gt;mlp_fc2_11 -->
<g id="edge140" class="edge">
<title>gelu_11&#45;&gt;mlp_fc2_11</title>
<path fill="none" stroke="black" d="M919.77,-8288.52C919.77,-8280.22 919.77,-8271.1 919.77,-8261.81"/>
<polygon fill="black" stroke="black" points="923.27,-8261.7 919.77,-8251.7 916.27,-8261.7 923.27,-8261.7"/>
</g>
<!-- mlp_fc2_11&#45;&gt;residual2_11 -->
<g id="edge141" class="edge">
<title>mlp_fc2_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M1023.8,-8115.52C1046.21,-8101.08 1069.41,-8086.12 1090.24,-8072.69"/>
<polygon fill="black" stroke="black" points="1092.2,-8075.59 1098.71,-8067.23 1088.41,-8069.71 1092.2,-8075.59"/>
</g>
<!-- comm_11 -->
<g id="node122" class="node">
<title>comm_11</title>
<polygon fill="yellow" stroke="black" points="1279.51,-7874.19 1279.51,-7907.84 1210.54,-7931.64 1113,-7931.64 1044.03,-7907.84 1044.03,-7874.19 1113,-7850.39 1210.54,-7850.39 1279.51,-7874.19"/>
<polygon fill="none" stroke="black" points="1283.5,-7871.33 1283.5,-7910.7 1211.21,-7935.65 1112.33,-7935.65 1040.04,-7910.7 1040.04,-7871.33 1112.33,-7846.39 1211.21,-7846.39 1283.5,-7871.33"/>
<text text-anchor="middle" x="1161.77" y="-7902.32" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1161.77" y="-7887.32" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1161.77" y="-7872.32" font-family="Times,serif" font-size="14.00">GPU10→GPU11</text>
</g>
<!-- residual2_11&#45;&gt;comm_11 -->
<g id="edge143" class="edge">
<title>residual2_11&#45;&gt;comm_11</title>
<path fill="none" stroke="black" d="M1161.77,-7972.57C1161.77,-7963.81 1161.77,-7954.7 1161.77,-7945.9"/>
<polygon fill="black" stroke="black" points="1165.27,-7945.74 1161.77,-7935.74 1158.27,-7945.74 1165.27,-7945.74"/>
</g>
<!-- ln1_12 -->
<g id="node123" class="node">
<title>ln1_12</title>
<polygon fill="#eedd82" stroke="black" points="1154.77,-7809.45 1010.77,-7809.45 1010.77,-7756.45 1154.77,-7756.45 1154.77,-7809.45"/>
<text text-anchor="middle" x="1082.77" y="-7794.25" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1082.77" y="-7779.25" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1082.77" y="-7764.25" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- comm_11&#45;&gt;ln1_12 -->
<g id="edge144" class="edge">
<title>comm_11&#45;&gt;ln1_12</title>
<path fill="none" stroke="black" d="M1129.18,-7846.26C1122.09,-7836.74 1114.69,-7826.8 1107.93,-7817.74"/>
<polygon fill="black" stroke="black" points="1110.72,-7815.62 1101.94,-7809.69 1105.1,-7819.8 1110.72,-7815.62"/>
</g>
<!-- residual1_12 -->
<g id="node127" class="node">
<title>residual1_12</title>
<polygon fill="#eedd82" stroke="black" points="1079.77,-7211.41 786.77,-7158.41 1079.77,-7105.41 1372.77,-7158.41 1079.77,-7211.41"/>
<text text-anchor="middle" x="1079.77" y="-7169.71" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1079.77" y="-7154.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="1079.77" y="-7139.71" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- comm_11&#45;&gt;residual1_12 -->
<g id="edge149" class="edge">
<title>comm_11&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1212.92,-7846.73C1228.1,-7829.18 1240.77,-7807.49 1240.77,-7783.95 1240.77,-7783.95 1240.77,-7783.95 1240.77,-7315.41 1240.77,-7284.33 1239.55,-7273.17 1220.77,-7248.41 1207.05,-7230.33 1188.52,-7214.97 1169.39,-7202.37"/>
<polygon fill="black" stroke="black" points="1171.2,-7199.37 1160.88,-7196.96 1167.44,-7205.28 1171.2,-7199.37"/>
<text text-anchor="middle" x="1269.77" y="-7554.25" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_12 -->
<g id="node124" class="node">
<title>qkv_proj_12</title>
<polygon fill="#eedd82" stroke="black" points="1212.31,-7719.45 729.45,-7719.45 605.23,-7583.45 1088.09,-7583.45 1212.31,-7719.45"/>
<text text-anchor="middle" x="908.77" y="-7670.25" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="908.77" y="-7655.25" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="908.77" y="-7640.25" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="908.77" y="-7625.25" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_12&#45;&gt;qkv_proj_12 -->
<g id="edge145" class="edge">
<title>ln1_12&#45;&gt;qkv_proj_12</title>
<path fill="none" stroke="black" d="M1048.39,-7756.37C1036.27,-7747.35 1021.98,-7736.71 1007.23,-7725.73"/>
<polygon fill="black" stroke="black" points="1009.12,-7722.77 999,-7719.61 1004.94,-7728.39 1009.12,-7722.77"/>
</g>
<!-- mha_12 -->
<g id="node125" class="node">
<title>mha_12</title>
<polygon fill="#eedd82" stroke="black" points="1154.24,-7476.93 1034.5,-7532.47 795.04,-7532.47 675.3,-7476.93 795.04,-7421.39 1034.5,-7421.39 1154.24,-7476.93"/>
<text text-anchor="middle" x="914.77" y="-7495.73" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="914.77" y="-7480.73" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="914.77" y="-7465.73" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="914.77" y="-7450.73" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- qkv_proj_12&#45;&gt;mha_12 -->
<g id="edge146" class="edge">
<title>qkv_proj_12&#45;&gt;mha_12</title>
<path fill="none" stroke="black" d="M911.11,-7583.26C911.57,-7570.04 912.05,-7556.2 912.5,-7543.06"/>
<polygon fill="black" stroke="black" points="916.01,-7542.81 912.86,-7532.69 909.02,-7542.56 916.01,-7542.81"/>
</g>
<!-- out_proj_12 -->
<g id="node126" class="node">
<title>out_proj_12</title>
<polygon fill="#eedd82" stroke="black" points="1212.14,-7384.41 743.86,-7384.41 623.39,-7248.41 1091.68,-7248.41 1212.14,-7384.41"/>
<text text-anchor="middle" x="917.77" y="-7335.21" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="917.77" y="-7320.21" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="917.77" y="-7305.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="917.77" y="-7290.21" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_12&#45;&gt;out_proj_12 -->
<g id="edge147" class="edge">
<title>mha_12&#45;&gt;out_proj_12</title>
<path fill="none" stroke="black" d="M915.8,-7421.38C915.96,-7412.79 916.13,-7403.77 916.3,-7394.78"/>
<polygon fill="black" stroke="black" points="919.81,-7394.74 916.5,-7384.67 912.81,-7394.6 919.81,-7394.74"/>
</g>
<!-- out_proj_12&#45;&gt;residual1_12 -->
<g id="edge148" class="edge">
<title>out_proj_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M987.41,-7248.35C1000.6,-7235.64 1014.2,-7222.55 1026.78,-7210.44"/>
<polygon fill="black" stroke="black" points="1029.27,-7212.89 1034.05,-7203.44 1024.42,-7207.85 1029.27,-7212.89"/>
</g>
<!-- ln2_12 -->
<g id="node128" class="node">
<title>ln2_12</title>
<polygon fill="#eedd82" stroke="black" points="1072.77,-7068.41 928.77,-7068.41 928.77,-7015.41 1072.77,-7015.41 1072.77,-7068.41"/>
<text text-anchor="middle" x="1000.77" y="-7053.21" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1000.77" y="-7038.21" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="1000.77" y="-7023.21" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge150" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M1047.86,-7111.17C1039.96,-7099.71 1031.63,-7087.64 1024.21,-7076.88"/>
<polygon fill="black" stroke="black" points="1027.04,-7074.83 1018.48,-7068.58 1021.28,-7078.8 1027.04,-7074.83"/>
</g>
<!-- residual2_12 -->
<g id="node132" class="node">
<title>residual2_12</title>
<polygon fill="#eedd82" stroke="black" points="992.77,-6506.46 699.77,-6453.46 992.77,-6400.46 1285.77,-6453.46 992.77,-6506.46"/>
<text text-anchor="middle" x="992.77" y="-6464.76" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="992.77" y="-6449.76" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="992.77" y="-6434.76" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- residual1_12&#45;&gt;residual2_12 -->
<g id="edge155" class="edge">
<title>residual1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1127.77,-7113.82C1144.32,-7094.13 1158.77,-7069.35 1158.77,-7042.91 1158.77,-7042.91 1158.77,-7042.91 1158.77,-6610.46 1158.77,-6579.5 1158.53,-6568.07 1139.77,-6543.46 1125.52,-6524.77 1106.13,-6509.16 1086.11,-6496.5"/>
<polygon fill="black" stroke="black" points="1087.86,-6493.47 1077.5,-6491.26 1084.22,-6499.45 1087.86,-6493.47"/>
<text text-anchor="middle" x="1187.77" y="-6813.21" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_12 -->
<g id="node129" class="node">
<title>mlp_fc1_12</title>
<polygon fill="#eedd82" stroke="black" points="1130.31,-6978.41 647.45,-6978.41 523.23,-6842.41 1006.09,-6842.41 1130.31,-6978.41"/>
<text text-anchor="middle" x="826.77" y="-6929.21" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="826.77" y="-6914.21" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="826.77" y="-6899.21" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="826.77" y="-6884.21" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_12&#45;&gt;mlp_fc1_12 -->
<g id="edge151" class="edge">
<title>ln2_12&#45;&gt;mlp_fc1_12</title>
<path fill="none" stroke="black" d="M966.39,-7015.32C954.27,-7006.31 939.98,-6995.66 925.23,-6984.69"/>
<polygon fill="black" stroke="black" points="927.12,-6981.73 917,-6978.57 922.94,-6987.35 927.12,-6981.73"/>
</g>
<!-- gelu_12 -->
<g id="node130" class="node">
<title>gelu_12</title>
<ellipse fill="#eedd82" stroke="black" cx="826.77" cy="-6753.93" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="826.77" y="-6765.23" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="826.77" y="-6750.23" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="826.77" y="-6735.23" font-family="Times,serif" font-size="14.00">GPU11</text>
</g>
<!-- mlp_fc1_12&#45;&gt;gelu_12 -->
<g id="edge152" class="edge">
<title>mlp_fc1_12&#45;&gt;gelu_12</title>
<path fill="none" stroke="black" d="M826.77,-6842.1C826.77,-6828.51 826.77,-6814.5 826.77,-6801.79"/>
<polygon fill="black" stroke="black" points="830.27,-6801.47 826.77,-6791.47 823.27,-6801.47 830.27,-6801.47"/>
</g>
<!-- mlp_fc2_12 -->
<g id="node131" class="node">
<title>mlp_fc2_12</title>
<polygon fill="#eedd82" stroke="black" points="1130.31,-6679.46 647.45,-6679.46 523.23,-6543.46 1006.09,-6543.46 1130.31,-6679.46"/>
<text text-anchor="middle" x="826.77" y="-6630.26" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="826.77" y="-6615.26" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="826.77" y="-6600.26" font-family="Times,serif" font-size="14.00">GPU11</text>
<text text-anchor="middle" x="826.77" y="-6585.26" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_12&#45;&gt;mlp_fc2_12 -->
<g id="edge153" class="edge">
<title>gelu_12&#45;&gt;mlp_fc2_12</title>
<path fill="none" stroke="black" d="M826.77,-6716.39C826.77,-6708.09 826.77,-6698.97 826.77,-6689.69"/>
<polygon fill="black" stroke="black" points="830.27,-6689.58 826.77,-6679.58 823.27,-6689.58 830.27,-6689.58"/>
</g>
<!-- mlp_fc2_12&#45;&gt;residual2_12 -->
<g id="edge154" class="edge">
<title>mlp_fc2_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M898.13,-6543.39C911.65,-6530.69 925.58,-6517.59 938.47,-6505.49"/>
<polygon fill="black" stroke="black" points="941.03,-6507.88 945.92,-6498.48 936.24,-6502.78 941.03,-6507.88"/>
</g>
<!-- comm_12 -->
<g id="node133" class="node">
<title>comm_12</title>
<polygon fill="yellow" stroke="black" points="1110.51,-6302.07 1110.51,-6335.72 1041.54,-6359.52 944,-6359.52 875.03,-6335.72 875.03,-6302.07 944,-6278.27 1041.54,-6278.27 1110.51,-6302.07"/>
<polygon fill="none" stroke="black" points="1114.5,-6299.21 1114.5,-6338.58 1042.21,-6363.52 943.33,-6363.52 871.04,-6338.58 871.04,-6299.21 943.33,-6274.26 1042.21,-6274.26 1114.5,-6299.21"/>
<text text-anchor="middle" x="992.77" y="-6330.19" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="992.77" y="-6315.19" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="992.77" y="-6300.19" font-family="Times,serif" font-size="14.00">GPU11→GPU12</text>
</g>
<!-- residual2_12&#45;&gt;comm_12 -->
<g id="edge156" class="edge">
<title>residual2_12&#45;&gt;comm_12</title>
<path fill="none" stroke="black" d="M992.77,-6400.44C992.77,-6391.69 992.77,-6382.58 992.77,-6373.77"/>
<polygon fill="black" stroke="black" points="996.27,-6373.61 992.77,-6363.61 989.27,-6373.61 996.27,-6373.61"/>
</g>
<!-- ln1_13 -->
<g id="node134" class="node">
<title>ln1_13</title>
<polygon fill="lightcoral" stroke="black" points="985.77,-6237.33 841.77,-6237.33 841.77,-6184.33 985.77,-6184.33 985.77,-6237.33"/>
<text text-anchor="middle" x="913.77" y="-6222.13" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="913.77" y="-6207.13" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="913.77" y="-6192.13" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- comm_12&#45;&gt;ln1_13 -->
<g id="edge157" class="edge">
<title>comm_12&#45;&gt;ln1_13</title>
<path fill="none" stroke="black" d="M960.18,-6274.14C953.09,-6264.61 945.69,-6254.68 938.93,-6245.61"/>
<polygon fill="black" stroke="black" points="941.72,-6243.49 932.94,-6237.56 936.1,-6247.67 941.72,-6243.49"/>
</g>
<!-- residual1_13 -->
<g id="node138" class="node">
<title>residual1_13</title>
<polygon fill="lightcoral" stroke="black" points="910.77,-5639.28 617.77,-5586.28 910.77,-5533.28 1203.77,-5586.28 910.77,-5639.28"/>
<text text-anchor="middle" x="910.77" y="-5597.58" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="910.77" y="-5582.58" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="910.77" y="-5567.58" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- comm_12&#45;&gt;residual1_13 -->
<g id="edge162" class="edge">
<title>comm_12&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1043.92,-6274.61C1059.1,-6257.05 1071.77,-6235.36 1071.77,-6211.83 1071.77,-6211.83 1071.77,-6211.83 1071.77,-5743.28 1071.77,-5712.21 1070.55,-5701.04 1051.77,-5676.28 1038.05,-5658.2 1019.52,-5642.85 1000.39,-5630.25"/>
<polygon fill="black" stroke="black" points="1002.2,-5627.25 991.88,-5624.83 998.44,-5633.15 1002.2,-5627.25"/>
<text text-anchor="middle" x="1100.77" y="-5982.13" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_13 -->
<g id="node135" class="node">
<title>qkv_proj_13</title>
<polygon fill="lightcoral" stroke="black" points="1043.31,-6147.33 560.45,-6147.33 436.23,-6011.33 919.09,-6011.33 1043.31,-6147.33"/>
<text text-anchor="middle" x="739.77" y="-6098.13" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="739.77" y="-6083.13" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="739.77" y="-6068.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="739.77" y="-6053.13" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_13&#45;&gt;qkv_proj_13 -->
<g id="edge158" class="edge">
<title>ln1_13&#45;&gt;qkv_proj_13</title>
<path fill="none" stroke="black" d="M879.39,-6184.24C867.27,-6175.22 852.98,-6164.58 838.23,-6153.61"/>
<polygon fill="black" stroke="black" points="840.12,-6150.65 830,-6147.49 835.94,-6156.26 840.12,-6150.65"/>
</g>
<!-- mha_13 -->
<g id="node136" class="node">
<title>mha_13</title>
<polygon fill="lightcoral" stroke="black" points="985.24,-5904.81 865.5,-5960.35 626.04,-5960.35 506.3,-5904.81 626.04,-5849.26 865.5,-5849.26 985.24,-5904.81"/>
<text text-anchor="middle" x="745.77" y="-5923.61" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="745.77" y="-5908.61" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="745.77" y="-5893.61" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="745.77" y="-5878.61" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- qkv_proj_13&#45;&gt;mha_13 -->
<g id="edge159" class="edge">
<title>qkv_proj_13&#45;&gt;mha_13</title>
<path fill="none" stroke="black" d="M742.11,-6011.13C742.57,-5997.92 743.05,-5984.08 743.5,-5970.93"/>
<polygon fill="black" stroke="black" points="747.01,-5970.68 743.86,-5960.56 740.02,-5970.44 747.01,-5970.68"/>
</g>
<!-- out_proj_13 -->
<g id="node137" class="node">
<title>out_proj_13</title>
<polygon fill="lightcoral" stroke="black" points="1043.14,-5812.28 574.86,-5812.28 454.39,-5676.28 922.68,-5676.28 1043.14,-5812.28"/>
<text text-anchor="middle" x="748.77" y="-5763.08" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="748.77" y="-5748.08" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="748.77" y="-5733.08" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="748.77" y="-5718.08" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_13&#45;&gt;out_proj_13 -->
<g id="edge160" class="edge">
<title>mha_13&#45;&gt;out_proj_13</title>
<path fill="none" stroke="black" d="M746.8,-5849.25C746.96,-5840.66 747.13,-5831.64 747.3,-5822.66"/>
<polygon fill="black" stroke="black" points="750.81,-5822.61 747.5,-5812.55 743.81,-5822.48 750.81,-5822.61"/>
</g>
<!-- out_proj_13&#45;&gt;residual1_13 -->
<g id="edge161" class="edge">
<title>out_proj_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M818.41,-5676.22C831.6,-5663.52 845.2,-5650.42 857.78,-5638.31"/>
<polygon fill="black" stroke="black" points="860.27,-5640.77 865.05,-5631.31 855.42,-5635.72 860.27,-5640.77"/>
</g>
<!-- ln2_13 -->
<g id="node139" class="node">
<title>ln2_13</title>
<polygon fill="lightcoral" stroke="black" points="903.77,-5496.28 759.77,-5496.28 759.77,-5443.28 903.77,-5443.28 903.77,-5496.28"/>
<text text-anchor="middle" x="831.77" y="-5481.08" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="831.77" y="-5466.08" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="831.77" y="-5451.08" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge163" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M878.86,-5539.04C870.96,-5527.58 862.63,-5515.51 855.21,-5504.76"/>
<polygon fill="black" stroke="black" points="858.04,-5502.7 849.48,-5496.46 852.28,-5506.68 858.04,-5502.7"/>
</g>
<!-- residual2_13 -->
<g id="node143" class="node">
<title>residual2_13</title>
<polygon fill="lightcoral" stroke="black" points="823.77,-4934.33 530.77,-4881.33 823.77,-4828.33 1116.77,-4881.33 823.77,-4934.33"/>
<text text-anchor="middle" x="823.77" y="-4892.63" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="823.77" y="-4877.63" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="823.77" y="-4862.63" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- residual1_13&#45;&gt;residual2_13 -->
<g id="edge168" class="edge">
<title>residual1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.77,-5541.69C975.32,-5522 989.77,-5497.23 989.77,-5470.78 989.77,-5470.78 989.77,-5470.78 989.77,-5038.33 989.77,-5007.38 989.53,-4995.95 970.77,-4971.33 956.52,-4952.65 937.13,-4937.04 917.11,-4924.38"/>
<polygon fill="black" stroke="black" points="918.86,-4921.35 908.5,-4919.13 915.22,-4927.32 918.86,-4921.35"/>
<text text-anchor="middle" x="1018.77" y="-5241.08" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_13 -->
<g id="node140" class="node">
<title>mlp_fc1_13</title>
<polygon fill="lightcoral" stroke="black" points="961.31,-5406.28 478.45,-5406.28 354.23,-5270.28 837.09,-5270.28 961.31,-5406.28"/>
<text text-anchor="middle" x="657.77" y="-5357.08" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="657.77" y="-5342.08" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="657.77" y="-5327.08" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="657.77" y="-5312.08" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_13&#45;&gt;mlp_fc1_13 -->
<g id="edge164" class="edge">
<title>ln2_13&#45;&gt;mlp_fc1_13</title>
<path fill="none" stroke="black" d="M797.39,-5443.2C785.27,-5434.18 770.98,-5423.54 756.23,-5412.56"/>
<polygon fill="black" stroke="black" points="758.12,-5409.6 748,-5406.44 753.94,-5415.22 758.12,-5409.6"/>
</g>
<!-- gelu_13 -->
<g id="node141" class="node">
<title>gelu_13</title>
<ellipse fill="lightcoral" stroke="black" cx="657.77" cy="-5181.81" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="657.77" y="-5193.11" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="657.77" y="-5178.11" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="657.77" y="-5163.11" font-family="Times,serif" font-size="14.00">GPU12</text>
</g>
<!-- mlp_fc1_13&#45;&gt;gelu_13 -->
<g id="edge165" class="edge">
<title>mlp_fc1_13&#45;&gt;gelu_13</title>
<path fill="none" stroke="black" d="M657.77,-5269.98C657.77,-5256.38 657.77,-5242.37 657.77,-5229.67"/>
<polygon fill="black" stroke="black" points="661.27,-5229.34 657.77,-5219.34 654.27,-5229.34 661.27,-5229.34"/>
</g>
<!-- mlp_fc2_13 -->
<g id="node142" class="node">
<title>mlp_fc2_13</title>
<polygon fill="lightcoral" stroke="black" points="961.31,-5107.33 478.45,-5107.33 354.23,-4971.33 837.09,-4971.33 961.31,-5107.33"/>
<text text-anchor="middle" x="657.77" y="-5058.13" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="657.77" y="-5043.13" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="657.77" y="-5028.13" font-family="Times,serif" font-size="14.00">GPU12</text>
<text text-anchor="middle" x="657.77" y="-5013.13" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_13&#45;&gt;mlp_fc2_13 -->
<g id="edge166" class="edge">
<title>gelu_13&#45;&gt;mlp_fc2_13</title>
<path fill="none" stroke="black" d="M657.77,-5144.27C657.77,-5135.97 657.77,-5126.85 657.77,-5117.56"/>
<polygon fill="black" stroke="black" points="661.27,-5117.45 657.77,-5107.45 654.27,-5117.45 661.27,-5117.45"/>
</g>
<!-- mlp_fc2_13&#45;&gt;residual2_13 -->
<g id="edge167" class="edge">
<title>mlp_fc2_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M729.13,-4971.27C742.65,-4958.57 756.58,-4945.47 769.47,-4933.36"/>
<polygon fill="black" stroke="black" points="772.03,-4935.76 776.92,-4926.36 767.24,-4930.65 772.03,-4935.76"/>
</g>
<!-- comm_13 -->
<g id="node144" class="node">
<title>comm_13</title>
<polygon fill="yellow" stroke="black" points="941.51,-4729.94 941.51,-4763.59 872.54,-4787.39 775,-4787.39 706.03,-4763.59 706.03,-4729.94 775,-4706.14 872.54,-4706.14 941.51,-4729.94"/>
<polygon fill="none" stroke="black" points="945.5,-4727.08 945.5,-4766.45 873.21,-4791.4 774.33,-4791.4 702.04,-4766.45 702.04,-4727.08 774.33,-4702.14 873.21,-4702.14 945.5,-4727.08"/>
<text text-anchor="middle" x="823.77" y="-4758.07" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="823.77" y="-4743.07" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="823.77" y="-4728.07" font-family="Times,serif" font-size="14.00">GPU12→GPU13</text>
</g>
<!-- residual2_13&#45;&gt;comm_13 -->
<g id="edge169" class="edge">
<title>residual2_13&#45;&gt;comm_13</title>
<path fill="none" stroke="black" d="M823.77,-4828.32C823.77,-4819.56 823.77,-4810.45 823.77,-4801.65"/>
<polygon fill="black" stroke="black" points="827.27,-4801.49 823.77,-4791.49 820.27,-4801.49 827.27,-4801.49"/>
</g>
<!-- ln1_14 -->
<g id="node145" class="node">
<title>ln1_14</title>
<polygon fill="lightgreen" stroke="black" points="816.77,-4665.2 672.77,-4665.2 672.77,-4612.2 816.77,-4612.2 816.77,-4665.2"/>
<text text-anchor="middle" x="744.77" y="-4650" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="744.77" y="-4635" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="744.77" y="-4620" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- comm_13&#45;&gt;ln1_14 -->
<g id="edge170" class="edge">
<title>comm_13&#45;&gt;ln1_14</title>
<path fill="none" stroke="black" d="M791.18,-4702.01C784.09,-4692.49 776.69,-4682.55 769.93,-4673.48"/>
<polygon fill="black" stroke="black" points="772.72,-4671.37 763.94,-4665.44 767.1,-4675.55 772.72,-4671.37"/>
</g>
<!-- residual1_14 -->
<g id="node149" class="node">
<title>residual1_14</title>
<polygon fill="lightgreen" stroke="black" points="741.77,-4067.16 448.77,-4014.16 741.77,-3961.16 1034.77,-4014.16 741.77,-4067.16"/>
<text text-anchor="middle" x="741.77" y="-4025.46" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="741.77" y="-4010.46" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="741.77" y="-3995.46" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- comm_13&#45;&gt;residual1_14 -->
<g id="edge175" class="edge">
<title>comm_13&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M874.92,-4702.48C890.1,-4684.93 902.77,-4663.24 902.77,-4639.7 902.77,-4639.7 902.77,-4639.7 902.77,-4171.16 902.77,-4140.08 901.55,-4128.92 882.77,-4104.16 869.05,-4086.08 850.52,-4070.72 831.39,-4058.12"/>
<polygon fill="black" stroke="black" points="833.2,-4055.12 822.88,-4052.71 829.44,-4061.03 833.2,-4055.12"/>
<text text-anchor="middle" x="931.77" y="-4410" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_14 -->
<g id="node146" class="node">
<title>qkv_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="874.31,-4575.2 391.45,-4575.2 267.23,-4439.2 750.09,-4439.2 874.31,-4575.2"/>
<text text-anchor="middle" x="570.77" y="-4526" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="570.77" y="-4511" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="570.77" y="-4496" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="570.77" y="-4481" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_14&#45;&gt;qkv_proj_14 -->
<g id="edge171" class="edge">
<title>ln1_14&#45;&gt;qkv_proj_14</title>
<path fill="none" stroke="black" d="M710.39,-4612.12C698.27,-4603.1 683.98,-4592.46 669.23,-4581.48"/>
<polygon fill="black" stroke="black" points="671.12,-4578.52 661,-4575.36 666.94,-4584.14 671.12,-4578.52"/>
</g>
<!-- mha_14 -->
<g id="node147" class="node">
<title>mha_14</title>
<polygon fill="lightgreen" stroke="black" points="816.24,-4332.68 696.5,-4388.22 457.04,-4388.22 337.3,-4332.68 457.04,-4277.14 696.5,-4277.14 816.24,-4332.68"/>
<text text-anchor="middle" x="576.77" y="-4351.48" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="576.77" y="-4336.48" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="576.77" y="-4321.48" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="576.77" y="-4306.48" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- qkv_proj_14&#45;&gt;mha_14 -->
<g id="edge172" class="edge">
<title>qkv_proj_14&#45;&gt;mha_14</title>
<path fill="none" stroke="black" d="M573.11,-4439.01C573.57,-4425.79 574.05,-4411.95 574.5,-4398.81"/>
<polygon fill="black" stroke="black" points="578.01,-4398.55 574.86,-4388.44 571.02,-4398.31 578.01,-4398.55"/>
</g>
<!-- out_proj_14 -->
<g id="node148" class="node">
<title>out_proj_14</title>
<polygon fill="lightgreen" stroke="black" points="874.14,-4240.16 405.86,-4240.16 285.39,-4104.16 753.68,-4104.16 874.14,-4240.16"/>
<text text-anchor="middle" x="579.77" y="-4190.96" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="579.77" y="-4175.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="579.77" y="-4160.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="579.77" y="-4145.96" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_14&#45;&gt;out_proj_14 -->
<g id="edge173" class="edge">
<title>mha_14&#45;&gt;out_proj_14</title>
<path fill="none" stroke="black" d="M577.8,-4277.13C577.96,-4268.54 578.13,-4259.52 578.3,-4250.53"/>
<polygon fill="black" stroke="black" points="581.81,-4250.49 578.5,-4240.42 574.81,-4250.35 581.81,-4250.49"/>
</g>
<!-- out_proj_14&#45;&gt;residual1_14 -->
<g id="edge174" class="edge">
<title>out_proj_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M649.41,-4104.09C662.6,-4091.39 676.2,-4078.3 688.78,-4066.19"/>
<polygon fill="black" stroke="black" points="691.27,-4068.64 696.05,-4059.18 686.42,-4063.6 691.27,-4068.64"/>
</g>
<!-- ln2_14 -->
<g id="node150" class="node">
<title>ln2_14</title>
<polygon fill="lightgreen" stroke="black" points="734.77,-3924.16 590.77,-3924.16 590.77,-3871.16 734.77,-3871.16 734.77,-3924.16"/>
<text text-anchor="middle" x="662.77" y="-3908.96" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="662.77" y="-3893.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="662.77" y="-3878.96" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge176" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M709.86,-3966.92C701.96,-3955.46 693.63,-3943.39 686.21,-3932.63"/>
<polygon fill="black" stroke="black" points="689.04,-3930.57 680.48,-3924.33 683.28,-3934.55 689.04,-3930.57"/>
</g>
<!-- residual2_14 -->
<g id="node154" class="node">
<title>residual2_14</title>
<polygon fill="lightgreen" stroke="black" points="654.77,-3362.2 361.77,-3309.2 654.77,-3256.2 947.77,-3309.2 654.77,-3362.2"/>
<text text-anchor="middle" x="654.77" y="-3320.5" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="654.77" y="-3305.5" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="654.77" y="-3290.5" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- residual1_14&#45;&gt;residual2_14 -->
<g id="edge181" class="edge">
<title>residual1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M789.77,-3969.56C806.32,-3949.87 820.77,-3925.1 820.77,-3898.66 820.77,-3898.66 820.77,-3898.66 820.77,-3466.2 820.77,-3435.25 820.53,-3423.82 801.77,-3399.2 787.52,-3380.52 768.13,-3364.91 748.11,-3352.25"/>
<polygon fill="black" stroke="black" points="749.86,-3349.22 739.5,-3347 746.22,-3355.2 749.86,-3349.22"/>
<text text-anchor="middle" x="849.77" y="-3668.96" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_14 -->
<g id="node151" class="node">
<title>mlp_fc1_14</title>
<polygon fill="lightgreen" stroke="black" points="792.31,-3834.16 309.45,-3834.16 185.23,-3698.16 668.09,-3698.16 792.31,-3834.16"/>
<text text-anchor="middle" x="488.77" y="-3784.96" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="488.77" y="-3769.96" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="488.77" y="-3754.96" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="488.77" y="-3739.96" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_14&#45;&gt;mlp_fc1_14 -->
<g id="edge177" class="edge">
<title>ln2_14&#45;&gt;mlp_fc1_14</title>
<path fill="none" stroke="black" d="M628.39,-3871.07C616.27,-3862.05 601.98,-3851.41 587.23,-3840.44"/>
<polygon fill="black" stroke="black" points="589.12,-3837.48 579,-3834.32 584.94,-3843.09 589.12,-3837.48"/>
</g>
<!-- gelu_14 -->
<g id="node152" class="node">
<title>gelu_14</title>
<ellipse fill="lightgreen" stroke="black" cx="488.77" cy="-3609.68" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="488.77" y="-3620.98" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="488.77" y="-3605.98" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="488.77" y="-3590.98" font-family="Times,serif" font-size="14.00">GPU13</text>
</g>
<!-- mlp_fc1_14&#45;&gt;gelu_14 -->
<g id="edge178" class="edge">
<title>mlp_fc1_14&#45;&gt;gelu_14</title>
<path fill="none" stroke="black" d="M488.77,-3697.85C488.77,-3684.26 488.77,-3670.25 488.77,-3657.54"/>
<polygon fill="black" stroke="black" points="492.27,-3657.21 488.77,-3647.21 485.27,-3657.21 492.27,-3657.21"/>
</g>
<!-- mlp_fc2_14 -->
<g id="node153" class="node">
<title>mlp_fc2_14</title>
<polygon fill="lightgreen" stroke="black" points="792.31,-3535.2 309.45,-3535.2 185.23,-3399.2 668.09,-3399.2 792.31,-3535.2"/>
<text text-anchor="middle" x="488.77" y="-3486" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="488.77" y="-3471" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="488.77" y="-3456" font-family="Times,serif" font-size="14.00">GPU13</text>
<text text-anchor="middle" x="488.77" y="-3441" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_14&#45;&gt;mlp_fc2_14 -->
<g id="edge179" class="edge">
<title>gelu_14&#45;&gt;mlp_fc2_14</title>
<path fill="none" stroke="black" d="M488.77,-3572.14C488.77,-3563.84 488.77,-3554.72 488.77,-3545.44"/>
<polygon fill="black" stroke="black" points="492.27,-3545.33 488.77,-3535.33 485.27,-3545.33 492.27,-3545.33"/>
</g>
<!-- mlp_fc2_14&#45;&gt;residual2_14 -->
<g id="edge180" class="edge">
<title>mlp_fc2_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M560.13,-3399.14C573.65,-3386.44 587.58,-3373.34 600.47,-3361.23"/>
<polygon fill="black" stroke="black" points="603.03,-3363.63 607.92,-3354.23 598.24,-3358.53 603.03,-3363.63"/>
</g>
<!-- comm_14 -->
<g id="node155" class="node">
<title>comm_14</title>
<polygon fill="yellow" stroke="black" points="772.51,-3157.81 772.51,-3191.47 703.54,-3215.26 606,-3215.26 537.03,-3191.47 537.03,-3157.81 606,-3134.02 703.54,-3134.02 772.51,-3157.81"/>
<polygon fill="none" stroke="black" points="776.5,-3154.96 776.5,-3194.32 704.21,-3219.27 605.33,-3219.27 533.04,-3194.32 533.04,-3154.96 605.33,-3130.01 704.21,-3130.01 776.5,-3154.96"/>
<text text-anchor="middle" x="654.77" y="-3185.94" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="654.77" y="-3170.94" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="654.77" y="-3155.94" font-family="Times,serif" font-size="14.00">GPU13→GPU14</text>
</g>
<!-- residual2_14&#45;&gt;comm_14 -->
<g id="edge182" class="edge">
<title>residual2_14&#45;&gt;comm_14</title>
<path fill="none" stroke="black" d="M654.77,-3256.19C654.77,-3247.43 654.77,-3238.33 654.77,-3229.52"/>
<polygon fill="black" stroke="black" points="658.27,-3229.36 654.77,-3219.36 651.27,-3229.36 658.27,-3229.36"/>
</g>
<!-- ln1_15 -->
<g id="node156" class="node">
<title>ln1_15</title>
<polygon fill="lightyellow" stroke="black" points="647.77,-3093.08 503.77,-3093.08 503.77,-3040.08 647.77,-3040.08 647.77,-3093.08"/>
<text text-anchor="middle" x="575.77" y="-3077.88" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="575.77" y="-3062.88" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="575.77" y="-3047.88" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- comm_14&#45;&gt;ln1_15 -->
<g id="edge183" class="edge">
<title>comm_14&#45;&gt;ln1_15</title>
<path fill="none" stroke="black" d="M622.18,-3129.89C615.09,-3120.36 607.69,-3110.43 600.93,-3101.36"/>
<polygon fill="black" stroke="black" points="603.72,-3099.24 594.94,-3093.31 598.1,-3103.42 603.72,-3099.24"/>
</g>
<!-- residual1_15 -->
<g id="node160" class="node">
<title>residual1_15</title>
<polygon fill="lightyellow" stroke="black" points="572.77,-2495.03 279.77,-2442.03 572.77,-2389.03 865.77,-2442.03 572.77,-2495.03"/>
<text text-anchor="middle" x="572.77" y="-2453.33" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="572.77" y="-2438.33" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="572.77" y="-2423.33" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- comm_14&#45;&gt;residual1_15 -->
<g id="edge188" class="edge">
<title>comm_14&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M705.92,-3130.35C721.1,-3112.8 733.77,-3091.11 733.77,-3067.58 733.77,-3067.58 733.77,-3067.58 733.77,-2599.03 733.77,-2567.96 732.55,-2556.79 713.77,-2532.03 700.05,-2513.95 681.52,-2498.6 662.39,-2486"/>
<polygon fill="black" stroke="black" points="664.2,-2483 653.88,-2480.58 660.44,-2488.9 664.2,-2483"/>
<text text-anchor="middle" x="762.77" y="-2837.88" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_15 -->
<g id="node157" class="node">
<title>qkv_proj_15</title>
<polygon fill="lightyellow" stroke="black" points="705.31,-3003.08 222.45,-3003.08 98.23,-2867.08 581.09,-2867.08 705.31,-3003.08"/>
<text text-anchor="middle" x="401.77" y="-2953.88" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="401.77" y="-2938.88" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="401.77" y="-2923.88" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="401.77" y="-2908.88" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_15&#45;&gt;qkv_proj_15 -->
<g id="edge184" class="edge">
<title>ln1_15&#45;&gt;qkv_proj_15</title>
<path fill="none" stroke="black" d="M541.39,-3039.99C529.27,-3030.97 514.98,-3020.33 500.23,-3009.36"/>
<polygon fill="black" stroke="black" points="502.12,-3006.4 492,-3003.23 497.94,-3012.01 502.12,-3006.4"/>
</g>
<!-- mha_15 -->
<g id="node158" class="node">
<title>mha_15</title>
<polygon fill="lightyellow" stroke="black" points="647.24,-2760.55 527.5,-2816.1 288.04,-2816.1 168.3,-2760.55 288.04,-2705.01 527.5,-2705.01 647.24,-2760.55"/>
<text text-anchor="middle" x="407.77" y="-2779.35" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="407.77" y="-2764.35" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="407.77" y="-2749.35" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="407.77" y="-2734.35" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- qkv_proj_15&#45;&gt;mha_15 -->
<g id="edge185" class="edge">
<title>qkv_proj_15&#45;&gt;mha_15</title>
<path fill="none" stroke="black" d="M404.11,-2866.88C404.57,-2853.67 405.05,-2839.82 405.5,-2826.68"/>
<polygon fill="black" stroke="black" points="409.01,-2826.43 405.86,-2816.31 402.02,-2826.19 409.01,-2826.43"/>
</g>
<!-- out_proj_15 -->
<g id="node159" class="node">
<title>out_proj_15</title>
<polygon fill="lightyellow" stroke="black" points="705.14,-2668.03 236.86,-2668.03 116.39,-2532.03 584.68,-2532.03 705.14,-2668.03"/>
<text text-anchor="middle" x="410.77" y="-2618.83" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="410.77" y="-2603.83" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="410.77" y="-2588.83" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="410.77" y="-2573.83" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_15&#45;&gt;out_proj_15 -->
<g id="edge186" class="edge">
<title>mha_15&#45;&gt;out_proj_15</title>
<path fill="none" stroke="black" d="M408.8,-2705C408.96,-2696.41 409.13,-2687.39 409.3,-2678.4"/>
<polygon fill="black" stroke="black" points="412.81,-2678.36 409.5,-2668.3 405.81,-2678.23 412.81,-2678.36"/>
</g>
<!-- out_proj_15&#45;&gt;residual1_15 -->
<g id="edge187" class="edge">
<title>out_proj_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M480.41,-2531.97C493.6,-2519.27 507.2,-2506.17 519.78,-2494.06"/>
<polygon fill="black" stroke="black" points="522.27,-2496.52 527.05,-2487.06 517.42,-2491.47 522.27,-2496.52"/>
</g>
<!-- ln2_15 -->
<g id="node161" class="node">
<title>ln2_15</title>
<polygon fill="lightyellow" stroke="black" points="565.77,-2352.03 421.77,-2352.03 421.77,-2299.03 565.77,-2299.03 565.77,-2352.03"/>
<text text-anchor="middle" x="493.77" y="-2336.83" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="493.77" y="-2321.83" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="493.77" y="-2306.83" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge189" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M540.86,-2394.79C532.96,-2383.33 524.63,-2371.26 517.21,-2360.51"/>
<polygon fill="black" stroke="black" points="520.04,-2358.45 511.48,-2352.21 514.28,-2362.42 520.04,-2358.45"/>
</g>
<!-- residual2_15 -->
<g id="node165" class="node">
<title>residual2_15</title>
<polygon fill="lightyellow" stroke="black" points="561.77,-1790.08 268.77,-1737.08 561.77,-1684.08 854.77,-1737.08 561.77,-1790.08"/>
<text text-anchor="middle" x="561.77" y="-1748.38" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="561.77" y="-1733.38" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="561.77" y="-1718.38" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- residual1_15&#45;&gt;residual2_15 -->
<g id="edge194" class="edge">
<title>residual1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M620.77,-2397.44C637.32,-2377.75 651.77,-2352.98 651.77,-2326.53 651.77,-2326.53 651.77,-2326.53 651.77,-1894.08 651.77,-1856.23 631.65,-1819.29 610.43,-1790.87"/>
<polygon fill="black" stroke="black" points="613.01,-1788.49 604.13,-1782.71 607.47,-1792.77 613.01,-1788.49"/>
<text text-anchor="middle" x="680.77" y="-2096.83" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_15 -->
<g id="node162" class="node">
<title>mlp_fc1_15</title>
<polygon fill="lightyellow" stroke="black" points="623.31,-2262.03 140.45,-2262.03 16.23,-2126.03 499.09,-2126.03 623.31,-2262.03"/>
<text text-anchor="middle" x="319.77" y="-2212.83" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="319.77" y="-2197.83" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="319.77" y="-2182.83" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="319.77" y="-2167.83" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_15&#45;&gt;mlp_fc1_15 -->
<g id="edge190" class="edge">
<title>ln2_15&#45;&gt;mlp_fc1_15</title>
<path fill="none" stroke="black" d="M459.39,-2298.95C447.27,-2289.93 432.98,-2279.29 418.23,-2268.31"/>
<polygon fill="black" stroke="black" points="420.12,-2265.35 410,-2262.19 415.94,-2270.97 420.12,-2265.35"/>
</g>
<!-- gelu_15 -->
<g id="node163" class="node">
<title>gelu_15</title>
<ellipse fill="lightyellow" stroke="black" cx="319.77" cy="-2037.56" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="319.77" y="-2048.86" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="319.77" y="-2033.86" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="319.77" y="-2018.86" font-family="Times,serif" font-size="14.00">GPU14</text>
</g>
<!-- mlp_fc1_15&#45;&gt;gelu_15 -->
<g id="edge191" class="edge">
<title>mlp_fc1_15&#45;&gt;gelu_15</title>
<path fill="none" stroke="black" d="M319.77,-2125.73C319.77,-2112.13 319.77,-2098.12 319.77,-2085.42"/>
<polygon fill="black" stroke="black" points="323.27,-2085.09 319.77,-2075.09 316.27,-2085.09 323.27,-2085.09"/>
</g>
<!-- mlp_fc2_15 -->
<g id="node164" class="node">
<title>mlp_fc2_15</title>
<polygon fill="lightyellow" stroke="black" points="623.31,-1963.08 140.45,-1963.08 16.23,-1827.08 499.09,-1827.08 623.31,-1963.08"/>
<text text-anchor="middle" x="319.77" y="-1913.88" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="319.77" y="-1898.88" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="319.77" y="-1883.88" font-family="Times,serif" font-size="14.00">GPU14</text>
<text text-anchor="middle" x="319.77" y="-1868.88" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_15&#45;&gt;mlp_fc2_15 -->
<g id="edge192" class="edge">
<title>gelu_15&#45;&gt;mlp_fc2_15</title>
<path fill="none" stroke="black" d="M319.77,-2000.01C319.77,-1991.72 319.77,-1982.59 319.77,-1973.31"/>
<polygon fill="black" stroke="black" points="323.27,-1973.2 319.77,-1963.2 316.27,-1973.2 323.27,-1973.2"/>
</g>
<!-- mlp_fc2_15&#45;&gt;residual2_15 -->
<g id="edge193" class="edge">
<title>mlp_fc2_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M423.8,-1827.02C446.21,-1812.57 469.41,-1797.62 490.24,-1784.19"/>
<polygon fill="black" stroke="black" points="492.2,-1787.09 498.71,-1778.73 488.41,-1781.21 492.2,-1787.09"/>
</g>
<!-- comm_15 -->
<g id="node166" class="node">
<title>comm_15</title>
<polygon fill="yellow" stroke="black" points="679.51,-1585.69 679.51,-1619.34 610.54,-1643.14 513,-1643.14 444.03,-1619.34 444.03,-1585.69 513,-1561.89 610.54,-1561.89 679.51,-1585.69"/>
<polygon fill="none" stroke="black" points="683.5,-1582.83 683.5,-1622.2 611.21,-1647.14 512.33,-1647.14 440.04,-1622.2 440.04,-1582.83 512.33,-1557.89 611.21,-1557.89 683.5,-1582.83"/>
<text text-anchor="middle" x="561.77" y="-1613.81" font-family="Times,serif" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="561.77" y="-1598.81" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="561.77" y="-1583.81" font-family="Times,serif" font-size="14.00">GPU14→GPU15</text>
</g>
<!-- residual2_15&#45;&gt;comm_15 -->
<g id="edge195" class="edge">
<title>residual2_15&#45;&gt;comm_15</title>
<path fill="none" stroke="black" d="M561.77,-1684.07C561.77,-1675.31 561.77,-1666.2 561.77,-1657.4"/>
<polygon fill="black" stroke="black" points="565.27,-1657.24 561.77,-1647.24 558.27,-1657.24 565.27,-1657.24"/>
</g>
<!-- ln1_16 -->
<g id="node167" class="node">
<title>ln1_16</title>
<polygon fill="lightpink" stroke="black" points="554.77,-1520.95 410.77,-1520.95 410.77,-1467.95 554.77,-1467.95 554.77,-1520.95"/>
<text text-anchor="middle" x="482.77" y="-1505.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="482.77" y="-1490.75" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="482.77" y="-1475.75" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- comm_15&#45;&gt;ln1_16 -->
<g id="edge196" class="edge">
<title>comm_15&#45;&gt;ln1_16</title>
<path fill="none" stroke="black" d="M529.18,-1557.76C522.09,-1548.24 514.69,-1538.3 507.93,-1529.23"/>
<polygon fill="black" stroke="black" points="510.72,-1527.12 501.94,-1521.19 505.1,-1531.3 510.72,-1527.12"/>
</g>
<!-- residual1_16 -->
<g id="node171" class="node">
<title>residual1_16</title>
<polygon fill="lightpink" stroke="black" points="552.77,-922.91 259.77,-869.91 552.77,-816.91 845.77,-869.91 552.77,-922.91"/>
<text text-anchor="middle" x="552.77" y="-881.21" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="552.77" y="-866.21" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="552.77" y="-851.21" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- comm_15&#45;&gt;residual1_16 -->
<g id="edge201" class="edge">
<title>comm_15&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M612.92,-1558.23C628.1,-1540.68 640.77,-1518.98 640.77,-1495.45 640.77,-1495.45 640.77,-1495.45 640.77,-1026.91 640.77,-989.27 621.09,-952.34 600.35,-923.87"/>
<polygon fill="black" stroke="black" points="603,-921.58 594.19,-915.7 597.41,-925.79 603,-921.58"/>
<text text-anchor="middle" x="669.77" y="-1265.75" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- qkv_proj_16 -->
<g id="node168" class="node">
<title>qkv_proj_16</title>
<polygon fill="lightpink" stroke="black" points="612.31,-1430.95 129.45,-1430.95 5.23,-1294.95 488.09,-1294.95 612.31,-1430.95"/>
<text text-anchor="middle" x="308.77" y="-1381.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="308.77" y="-1366.75" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,12288]</text>
<text text-anchor="middle" x="308.77" y="-1351.75" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="308.77" y="-1336.75" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln1_16&#45;&gt;qkv_proj_16 -->
<g id="edge197" class="edge">
<title>ln1_16&#45;&gt;qkv_proj_16</title>
<path fill="none" stroke="black" d="M448.39,-1467.87C436.27,-1458.85 421.98,-1448.21 407.23,-1437.23"/>
<polygon fill="black" stroke="black" points="409.12,-1434.27 399,-1431.11 404.94,-1439.89 409.12,-1434.27"/>
</g>
<!-- mha_16 -->
<g id="node169" class="node">
<title>mha_16</title>
<polygon fill="lightpink" stroke="black" points="554.24,-1188.43 434.5,-1243.97 195.04,-1243.97 75.3,-1188.43 195.04,-1132.88 434.5,-1132.88 554.24,-1188.43"/>
<text text-anchor="middle" x="314.77" y="-1207.23" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="314.77" y="-1192.23" font-family="Times,serif" font-size="14.00">16 heads × 512 dim</text>
<text text-anchor="middle" x="314.77" y="-1177.23" font-family="Times,serif" font-size="14.00">[1024,2048,12288]→[1024,2048,8192]</text>
<text text-anchor="middle" x="314.77" y="-1162.23" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- qkv_proj_16&#45;&gt;mha_16 -->
<g id="edge198" class="edge">
<title>qkv_proj_16&#45;&gt;mha_16</title>
<path fill="none" stroke="black" d="M311.11,-1294.75C311.57,-1281.54 312.05,-1267.7 312.5,-1254.55"/>
<polygon fill="black" stroke="black" points="316.01,-1254.3 312.86,-1244.19 309.02,-1254.06 316.01,-1254.3"/>
</g>
<!-- out_proj_16 -->
<g id="node170" class="node">
<title>out_proj_16</title>
<polygon fill="lightpink" stroke="black" points="612.14,-1095.91 143.86,-1095.91 23.39,-959.91 491.68,-959.91 612.14,-1095.91"/>
<text text-anchor="middle" x="317.77" y="-1046.71" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="317.77" y="-1031.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,8192]</text>
<text text-anchor="middle" x="317.77" y="-1016.71" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="317.77" y="-1001.71" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- mha_16&#45;&gt;out_proj_16 -->
<g id="edge199" class="edge">
<title>mha_16&#45;&gt;out_proj_16</title>
<path fill="none" stroke="black" d="M315.8,-1132.87C315.96,-1124.28 316.13,-1115.27 316.3,-1106.28"/>
<polygon fill="black" stroke="black" points="319.81,-1106.23 316.5,-1096.17 312.81,-1106.1 319.81,-1106.23"/>
</g>
<!-- out_proj_16&#45;&gt;residual1_16 -->
<g id="edge200" class="edge">
<title>out_proj_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M418.79,-959.84C440.35,-945.54 462.65,-930.73 482.74,-917.4"/>
<polygon fill="black" stroke="black" points="484.8,-920.23 491.2,-911.78 480.93,-914.39 484.8,-920.23"/>
</g>
<!-- ln2_16 -->
<g id="node172" class="node">
<title>ln2_16</title>
<polygon fill="lightpink" stroke="black" points="549.77,-779.91 405.77,-779.91 405.77,-726.91 549.77,-726.91 549.77,-779.91"/>
<text text-anchor="middle" x="477.77" y="-764.71" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="477.77" y="-749.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192]</text>
<text text-anchor="middle" x="477.77" y="-734.71" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- residual1_16&#45;&gt;ln2_16 -->
<g id="edge202" class="edge">
<title>residual1_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M522.26,-822.34C514.85,-811.02 507.06,-799.12 500.1,-788.5"/>
<polygon fill="black" stroke="black" points="502.89,-786.37 494.48,-779.92 497.04,-790.21 502.89,-786.37"/>
</g>
<!-- residual2_16 -->
<g id="node176" class="node">
<title>residual2_16</title>
<polygon fill="lightpink" stroke="black" points="469.77,-217.95 176.77,-164.95 469.77,-111.95 762.77,-164.95 469.77,-217.95"/>
<text text-anchor="middle" x="469.77" y="-176.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="469.77" y="-161.25" font-family="Times,serif" font-size="14.00">[1024,2048,8192] + [1024,2048,8192]</text>
<text text-anchor="middle" x="469.77" y="-146.25" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- residual1_16&#45;&gt;residual2_16 -->
<g id="edge207" class="edge">
<title>residual1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M603.2,-825.74C620.58,-806.13 635.77,-781.29 635.77,-754.41 635.77,-754.41 635.77,-754.41 635.77,-321.95 635.77,-291 635.53,-279.57 616.77,-254.95 602.52,-236.27 583.13,-220.66 563.11,-208"/>
<polygon fill="black" stroke="black" points="564.86,-204.97 554.5,-202.75 561.22,-210.95 564.86,-204.97"/>
<text text-anchor="middle" x="664.77" y="-524.71" font-family="Times,serif" font-size="14.00">residual</text>
</g>
<!-- mlp_fc1_16 -->
<g id="node173" class="node">
<title>mlp_fc1_16</title>
<polygon fill="lightpink" stroke="black" points="607.31,-689.91 124.45,-689.91 0.23,-553.91 483.09,-553.91 607.31,-689.91"/>
<text text-anchor="middle" x="303.77" y="-640.71" font-family="Times,serif" font-size="14.00">MLP FC1</text>
<text text-anchor="middle" x="303.77" y="-625.71" font-family="Times,serif" font-size="14.00">[1024,2048,8192]→[1024,2048,32768]</text>
<text text-anchor="middle" x="303.77" y="-610.71" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="303.77" y="-595.71" font-family="Times,serif" font-size="14.00">(Column Parallel, Split=2)</text>
</g>
<!-- ln2_16&#45;&gt;mlp_fc1_16 -->
<g id="edge203" class="edge">
<title>ln2_16&#45;&gt;mlp_fc1_16</title>
<path fill="none" stroke="black" d="M443.39,-726.82C431.27,-717.8 416.98,-707.16 402.23,-696.19"/>
<polygon fill="black" stroke="black" points="404.12,-693.23 394,-690.06 399.94,-698.84 404.12,-693.23"/>
</g>
<!-- gelu_16 -->
<g id="node174" class="node">
<title>gelu_16</title>
<ellipse fill="lightpink" stroke="black" cx="303.77" cy="-465.43" rx="108.38" ry="37.45"/>
<text text-anchor="middle" x="303.77" y="-476.73" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="303.77" y="-461.73" font-family="Times,serif" font-size="14.00">[1024,2048,32768]</text>
<text text-anchor="middle" x="303.77" y="-446.73" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- mlp_fc1_16&#45;&gt;gelu_16 -->
<g id="edge204" class="edge">
<title>mlp_fc1_16&#45;&gt;gelu_16</title>
<path fill="none" stroke="black" d="M303.77,-553.6C303.77,-540.01 303.77,-526 303.77,-513.29"/>
<polygon fill="black" stroke="black" points="307.27,-512.96 303.77,-502.96 300.27,-512.96 307.27,-512.96"/>
</g>
<!-- mlp_fc2_16 -->
<g id="node175" class="node">
<title>mlp_fc2_16</title>
<polygon fill="lightpink" stroke="black" points="607.31,-390.95 124.45,-390.95 0.23,-254.95 483.09,-254.95 607.31,-390.95"/>
<text text-anchor="middle" x="303.77" y="-341.75" font-family="Times,serif" font-size="14.00">MLP FC2</text>
<text text-anchor="middle" x="303.77" y="-326.75" font-family="Times,serif" font-size="14.00">[1024,2048,32768]→[1024,2048,8192]</text>
<text text-anchor="middle" x="303.77" y="-311.75" font-family="Times,serif" font-size="14.00">GPU15</text>
<text text-anchor="middle" x="303.77" y="-296.75" font-family="Times,serif" font-size="14.00">(Row Parallel, Reduce)</text>
</g>
<!-- gelu_16&#45;&gt;mlp_fc2_16 -->
<g id="edge205" class="edge">
<title>gelu_16&#45;&gt;mlp_fc2_16</title>
<path fill="none" stroke="black" d="M303.77,-427.89C303.77,-419.59 303.77,-410.47 303.77,-401.18"/>
<polygon fill="black" stroke="black" points="307.27,-401.07 303.77,-391.07 300.27,-401.07 307.27,-401.07"/>
</g>
<!-- mlp_fc2_16&#45;&gt;residual2_16 -->
<g id="edge206" class="edge">
<title>mlp_fc2_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M375.13,-254.89C388.65,-242.19 402.58,-229.09 415.47,-216.98"/>
<polygon fill="black" stroke="black" points="418.03,-219.38 422.92,-209.98 413.24,-214.28 418.03,-219.38"/>
</g>
<!-- output -->
<g id="node177" class="node">
<title>output</title>
<ellipse fill="white" stroke="black" cx="469.77" cy="-37.48" rx="218.49" ry="37.45"/>
<text text-anchor="middle" x="469.77" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="469.77" y="-33.78" font-family="Times,serif" font-size="14.00">[Batch=1024, Seq=2048, Hidden=8192]</text>
<text text-anchor="middle" x="469.77" y="-18.78" font-family="Times,serif" font-size="14.00">GPU15</text>
</g>
<!-- residual2_16&#45;&gt;output -->
<g id="edge208" class="edge">
<title>residual2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M469.77,-111.83C469.77,-102.93 469.77,-93.73 469.77,-84.98"/>
<polygon fill="black" stroke="black" points="473.27,-84.96 469.77,-74.96 466.27,-84.96 473.27,-84.96"/>
</g>
</g>
</svg>
