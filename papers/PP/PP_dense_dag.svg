<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Dense_Model_Layerwise_Deployment Pages: 1 -->
<svg width="521pt" height="1440pt"
 viewBox="0.00 0.00 520.85 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.13 0.13) rotate(0) translate(4 10889)">
<title>Dense_Model_Layerwise_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-10889 3936,-10889 3936,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="#e6f3ff" stroke="black" points="470,-10885 242,-10885 242,-10832 470,-10832 470,-10885"/>
<text text-anchor="middle" x="356" y="-10869.8" font-family="Arial" font-size="14.00">Input</text>
<text text-anchor="middle" x="356" y="-10854.8" font-family="Arial" font-size="14.00">[batch=1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="356" y="-10839.8" font-family="Arial" font-size="14.00">GPU: All GPUs</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="#ffe4e1" stroke="black" points="389.5,-10796 202.5,-10796 202.5,-10743 389.5,-10743 389.5,-10796"/>
<text text-anchor="middle" x="296" y="-10780.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="296" y="-10765.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="296" y="-10750.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M338.32,-10831.87C332.45,-10823.36 325.83,-10813.75 319.59,-10804.7"/>
<polygon fill="black" stroke="black" points="322.32,-10802.49 313.76,-10796.25 316.55,-10806.47 322.32,-10802.49"/>
</g>
<!-- residual1_1 -->
<g id="node3" class="node">
<title>residual1_1</title>
<polygon fill="#f0f8ff" stroke="black" points="452.5,-10262 265.5,-10262 265.5,-10209 452.5,-10209 452.5,-10262"/>
<text text-anchor="middle" x="359" y="-10246.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="359" y="-10231.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="359" y="-10216.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M385.72,-10831.82C418.9,-10800.14 468,-10742.89 468,-10681.5 468,-10681.5 468,-10681.5 468,-10412.5 468,-10360.92 476.75,-10341.49 449,-10298 441.55,-10286.32 430.99,-10276.29 419.72,-10267.92"/>
<polygon fill="black" stroke="black" points="421.63,-10264.98 411.42,-10262.12 417.62,-10270.72 421.63,-10264.98"/>
</g>
<!-- attn_qkv_1 -->
<g id="node4" class="node">
<title>attn_qkv_1</title>
<polygon fill="#ffe6e6" stroke="black" points="440,-10707 48,-10707 48,-10654 440,-10654 440,-10707"/>
<text text-anchor="middle" x="244" y="-10691.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="244" y="-10676.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="244" y="-10661.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- ln1_1&#45;&gt;attn_qkv_1 -->
<g id="edge3" class="edge">
<title>ln1_1&#45;&gt;attn_qkv_1</title>
<path fill="none" stroke="black" d="M280.68,-10742.87C275.65,-10734.45 269.97,-10724.95 264.61,-10715.98"/>
<polygon fill="black" stroke="black" points="267.53,-10714.04 259.39,-10707.25 261.52,-10717.63 267.53,-10714.04"/>
</g>
<!-- ln2_1 -->
<g id="node9" class="node">
<title>ln2_1</title>
<polygon fill="#ffe4e1" stroke="black" points="340.5,-10173 153.5,-10173 153.5,-10120 340.5,-10120 340.5,-10173"/>
<text text-anchor="middle" x="247" y="-10157.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="247" y="-10142.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="247" y="-10127.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge9" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M326,-10208.87C314.15,-10199.66 300.62,-10189.15 288.16,-10179.47"/>
<polygon fill="black" stroke="black" points="290.19,-10176.62 280.15,-10173.25 285.9,-10182.15 290.19,-10176.62"/>
</g>
<!-- residual2_1 -->
<g id="node10" class="node">
<title>residual2_1</title>
<polygon fill="#f0f8ff" stroke="black" points="455.5,-9817 268.5,-9817 268.5,-9764 455.5,-9764 455.5,-9817"/>
<text text-anchor="middle" x="362" y="-9801.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="362" y="-9786.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="362" y="-9771.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge10" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M373.92,-10208.93C391.98,-10175.5 420,-10114.61 420,-10058.5 420,-10058.5 420,-10058.5 420,-9967.5 420,-9915.92 419.4,-9901.19 401,-9853 397.45,-9843.71 392.4,-9834.32 387.11,-9825.77"/>
<polygon fill="black" stroke="black" points="389.93,-9823.69 381.55,-9817.2 384.06,-9827.5 389.93,-9823.69"/>
</g>
<!-- attn_score_1 -->
<g id="node5" class="node">
<title>attn_score_1</title>
<polygon fill="#ffe6e6" stroke="black" points="327,-10618 163,-10618 163,-10565 327,-10565 327,-10618"/>
<text text-anchor="middle" x="245" y="-10602.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="245" y="-10587.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="245" y="-10572.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_qkv_1&#45;&gt;attn_score_1 -->
<g id="edge4" class="edge">
<title>attn_qkv_1&#45;&gt;attn_score_1</title>
<path fill="none" stroke="black" d="M244.29,-10653.87C244.39,-10645.89 244.49,-10636.93 244.59,-10628.38"/>
<polygon fill="black" stroke="black" points="248.09,-10628.29 244.7,-10618.25 241.09,-10628.21 248.09,-10628.29"/>
</g>
<!-- attn_weight_1 -->
<g id="node6" class="node">
<title>attn_weight_1</title>
<polygon fill="#ffe6e6" stroke="black" points="329,-10529 165,-10529 165,-10476 329,-10476 329,-10529"/>
<text text-anchor="middle" x="247" y="-10513.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="247" y="-10498.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="247" y="-10483.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_score_1&#45;&gt;attn_weight_1 -->
<g id="edge5" class="edge">
<title>attn_score_1&#45;&gt;attn_weight_1</title>
<path fill="none" stroke="black" d="M245.59,-10564.87C245.77,-10556.89 245.98,-10547.93 246.18,-10539.38"/>
<polygon fill="black" stroke="black" points="249.68,-10539.33 246.41,-10529.25 242.68,-10539.17 249.68,-10539.33"/>
</g>
<!-- attn_context_1 -->
<g id="node7" class="node">
<title>attn_context_1</title>
<polygon fill="#ffe6e6" stroke="black" points="343.5,-10440 156.5,-10440 156.5,-10387 343.5,-10387 343.5,-10440"/>
<text text-anchor="middle" x="250" y="-10424.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="250" y="-10409.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="250" y="-10394.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_weight_1&#45;&gt;attn_context_1 -->
<g id="edge6" class="edge">
<title>attn_weight_1&#45;&gt;attn_context_1</title>
<path fill="none" stroke="black" d="M247.88,-10475.87C248.16,-10467.89 248.47,-10458.93 248.76,-10450.38"/>
<polygon fill="black" stroke="black" points="252.27,-10450.36 249.11,-10440.25 245.27,-10450.12 252.27,-10450.36"/>
</g>
<!-- attn_out_1 -->
<g id="node8" class="node">
<title>attn_out_1</title>
<polygon fill="#ffe6e6" stroke="black" points="440.5,-10351 61.5,-10351 61.5,-10298 440.5,-10298 440.5,-10351"/>
<text text-anchor="middle" x="251" y="-10335.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="251" y="-10320.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="251" y="-10305.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- attn_context_1&#45;&gt;attn_out_1 -->
<g id="edge7" class="edge">
<title>attn_context_1&#45;&gt;attn_out_1</title>
<path fill="none" stroke="black" d="M250.29,-10386.87C250.39,-10378.89 250.49,-10369.93 250.59,-10361.38"/>
<polygon fill="black" stroke="black" points="254.09,-10361.29 250.7,-10351.25 247.09,-10361.21 254.09,-10361.29"/>
</g>
<!-- attn_out_1&#45;&gt;residual1_1 -->
<g id="edge8" class="edge">
<title>attn_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M282.82,-10297.87C294.14,-10288.75 307.04,-10278.35 318.97,-10268.75"/>
<polygon fill="black" stroke="black" points="321.44,-10271.25 327.03,-10262.25 317.05,-10265.8 321.44,-10271.25"/>
</g>
<!-- ffn_up_1 -->
<g id="node11" class="node">
<title>ffn_up_1</title>
<polygon fill="#e6ffe6" stroke="black" points="392,-10084 0,-10084 0,-10031 392,-10031 392,-10084"/>
<text text-anchor="middle" x="196" y="-10068.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="196" y="-10053.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="196" y="-10038.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- ln2_1&#45;&gt;ffn_up_1 -->
<g id="edge11" class="edge">
<title>ln2_1&#45;&gt;ffn_up_1</title>
<path fill="none" stroke="black" d="M231.97,-10119.87C227.04,-10111.45 221.47,-10101.95 216.21,-10092.98"/>
<polygon fill="black" stroke="black" points="219.17,-10091.11 211.09,-10084.25 213.13,-10094.65 219.17,-10091.11"/>
</g>
<!-- comm_1_2 -->
<g id="node14" class="node">
<title>comm_1_2</title>
<ellipse fill="#f0e6ff" stroke="black" cx="362" cy="-9690.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="362" y="-9701.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="362" y="-9686.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="362" y="-9671.8" font-family="Arial" font-size="14.00">GPU: 0 → GPU: 1</text>
</g>
<!-- residual2_1&#45;&gt;comm_1_2 -->
<g id="edge15" class="edge">
<title>residual2_1&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M362,-9763.75C362,-9755.93 362,-9747.07 362,-9738.31"/>
<polygon fill="black" stroke="black" points="365.5,-9738.13 362,-9728.13 358.5,-9738.13 365.5,-9738.13"/>
</g>
<!-- ffn_act_1 -->
<g id="node12" class="node">
<title>ffn_act_1</title>
<polygon fill="#e6ffe6" stroke="black" points="296,-9995 96,-9995 96,-9942 296,-9942 296,-9995"/>
<text text-anchor="middle" x="196" y="-9979.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="196" y="-9964.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="196" y="-9949.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_up_1&#45;&gt;ffn_act_1 -->
<g id="edge12" class="edge">
<title>ffn_up_1&#45;&gt;ffn_act_1</title>
<path fill="none" stroke="black" d="M196,-10030.87C196,-10022.89 196,-10013.93 196,-10005.38"/>
<polygon fill="black" stroke="black" points="199.5,-10005.25 196,-9995.25 192.5,-10005.25 199.5,-10005.25"/>
</g>
<!-- ffn_down_1 -->
<g id="node13" class="node">
<title>ffn_down_1</title>
<polygon fill="#e6ffe6" stroke="black" points="392,-9906 0,-9906 0,-9853 392,-9853 392,-9906"/>
<text text-anchor="middle" x="196" y="-9890.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="196" y="-9875.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="196" y="-9860.8" font-family="Arial" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn_act_1&#45;&gt;ffn_down_1 -->
<g id="edge13" class="edge">
<title>ffn_act_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M196,-9941.87C196,-9933.89 196,-9924.93 196,-9916.38"/>
<polygon fill="black" stroke="black" points="199.5,-9916.25 196,-9906.25 192.5,-9916.25 199.5,-9916.25"/>
</g>
<!-- ffn_down_1&#45;&gt;residual2_1 -->
<g id="edge14" class="edge">
<title>ffn_down_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M244.91,-9852.87C263.48,-9843.13 284.82,-9831.95 304.14,-9821.82"/>
<polygon fill="black" stroke="black" points="305.92,-9824.84 313.16,-9817.1 302.67,-9818.64 305.92,-9824.84"/>
</g>
<!-- residual1_2 -->
<g id="node15" class="node">
<title>residual1_2</title>
<polygon fill="#f0f8ff" stroke="black" points="625.5,-9617 438.5,-9617 438.5,-9564 625.5,-9564 625.5,-9617"/>
<text text-anchor="middle" x="532" y="-9601.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="532" y="-9586.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="532" y="-9571.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- comm_1_2&#45;&gt;residual1_2 -->
<g id="edge16" class="edge">
<title>comm_1_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M419.08,-9656.59C438.4,-9645.46 459.88,-9633.07 478.88,-9622.12"/>
<polygon fill="black" stroke="black" points="480.79,-9625.06 487.7,-9617.04 477.29,-9619 480.79,-9625.06"/>
</g>
<!-- ln2_2 -->
<g id="node22" class="node">
<title>ln2_2</title>
<polygon fill="#ffe4e1" stroke="black" points="565.5,-9528 378.5,-9528 378.5,-9475 565.5,-9475 565.5,-9528"/>
<text text-anchor="middle" x="472" y="-9512.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="472" y="-9497.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="472" y="-9482.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge23" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M514.32,-9563.87C508.45,-9555.36 501.83,-9545.75 495.59,-9536.7"/>
<polygon fill="black" stroke="black" points="498.32,-9534.49 489.76,-9528.25 492.55,-9538.47 498.32,-9534.49"/>
</g>
<!-- residual2_2 -->
<g id="node23" class="node">
<title>residual2_2</title>
<polygon fill="#f0f8ff" stroke="black" points="679.5,-9172 492.5,-9172 492.5,-9119 679.5,-9119 679.5,-9172"/>
<text text-anchor="middle" x="586" y="-9156.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="586" y="-9141.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="586" y="-9126.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge24" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M561.72,-9563.82C594.9,-9532.14 644,-9474.89 644,-9413.5 644,-9413.5 644,-9413.5 644,-9322.5 644,-9270.92 643.4,-9256.19 625,-9208 621.45,-9198.71 616.4,-9189.32 611.11,-9180.77"/>
<polygon fill="black" stroke="black" points="613.93,-9178.69 605.55,-9172.2 608.06,-9182.5 613.93,-9178.69"/>
</g>
<!-- ln1_2 -->
<g id="node16" class="node">
<title>ln1_2</title>
<polygon fill="#ffe4e1" stroke="black" points="795.5,-10173 608.5,-10173 608.5,-10120 795.5,-10120 795.5,-10173"/>
<text text-anchor="middle" x="702" y="-10157.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="702" y="-10142.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="702" y="-10127.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_qkv_2 -->
<g id="node17" class="node">
<title>attn_qkv_2</title>
<polygon fill="#ffe6e6" stroke="black" points="898,-10084 506,-10084 506,-10031 898,-10031 898,-10084"/>
<text text-anchor="middle" x="702" y="-10068.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="702" y="-10053.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="702" y="-10038.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- ln1_2&#45;&gt;attn_qkv_2 -->
<g id="edge17" class="edge">
<title>ln1_2&#45;&gt;attn_qkv_2</title>
<path fill="none" stroke="black" d="M702,-10119.87C702,-10111.89 702,-10102.93 702,-10094.38"/>
<polygon fill="black" stroke="black" points="705.5,-10094.25 702,-10084.25 698.5,-10094.25 705.5,-10094.25"/>
</g>
<!-- attn_score_2 -->
<g id="node18" class="node">
<title>attn_score_2</title>
<polygon fill="#ffe6e6" stroke="black" points="784,-9995 620,-9995 620,-9942 784,-9942 784,-9995"/>
<text text-anchor="middle" x="702" y="-9979.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="702" y="-9964.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="702" y="-9949.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_qkv_2&#45;&gt;attn_score_2 -->
<g id="edge18" class="edge">
<title>attn_qkv_2&#45;&gt;attn_score_2</title>
<path fill="none" stroke="black" d="M702,-10030.87C702,-10022.89 702,-10013.93 702,-10005.38"/>
<polygon fill="black" stroke="black" points="705.5,-10005.25 702,-9995.25 698.5,-10005.25 705.5,-10005.25"/>
</g>
<!-- attn_weight_2 -->
<g id="node19" class="node">
<title>attn_weight_2</title>
<polygon fill="#ffe6e6" stroke="black" points="784,-9906 620,-9906 620,-9853 784,-9853 784,-9906"/>
<text text-anchor="middle" x="702" y="-9890.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="702" y="-9875.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="702" y="-9860.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_score_2&#45;&gt;attn_weight_2 -->
<g id="edge19" class="edge">
<title>attn_score_2&#45;&gt;attn_weight_2</title>
<path fill="none" stroke="black" d="M702,-9941.87C702,-9933.89 702,-9924.93 702,-9916.38"/>
<polygon fill="black" stroke="black" points="705.5,-9916.25 702,-9906.25 698.5,-9916.25 705.5,-9916.25"/>
</g>
<!-- attn_context_2 -->
<g id="node20" class="node">
<title>attn_context_2</title>
<polygon fill="#ffe6e6" stroke="black" points="795.5,-9817 608.5,-9817 608.5,-9764 795.5,-9764 795.5,-9817"/>
<text text-anchor="middle" x="702" y="-9801.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="702" y="-9786.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="702" y="-9771.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_weight_2&#45;&gt;attn_context_2 -->
<g id="edge20" class="edge">
<title>attn_weight_2&#45;&gt;attn_context_2</title>
<path fill="none" stroke="black" d="M702,-9852.87C702,-9844.89 702,-9835.93 702,-9827.38"/>
<polygon fill="black" stroke="black" points="705.5,-9827.25 702,-9817.25 698.5,-9827.25 705.5,-9827.25"/>
</g>
<!-- attn_out_2 -->
<g id="node21" class="node">
<title>attn_out_2</title>
<polygon fill="#ffe6e6" stroke="black" points="891.5,-9717 512.5,-9717 512.5,-9664 891.5,-9664 891.5,-9717"/>
<text text-anchor="middle" x="702" y="-9701.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="702" y="-9686.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="702" y="-9671.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- attn_context_2&#45;&gt;attn_out_2 -->
<g id="edge21" class="edge">
<title>attn_context_2&#45;&gt;attn_out_2</title>
<path fill="none" stroke="black" d="M702,-9763.75C702,-9752.61 702,-9739.38 702,-9727.31"/>
<polygon fill="black" stroke="black" points="705.5,-9727.08 702,-9717.08 698.5,-9727.08 705.5,-9727.08"/>
</g>
<!-- attn_out_2&#45;&gt;residual1_2 -->
<g id="edge22" class="edge">
<title>attn_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M657.33,-9663.75C635.18,-9650.98 608.26,-9635.46 585.06,-9622.09"/>
<polygon fill="black" stroke="black" points="586.78,-9619.04 576.37,-9617.08 583.28,-9625.1 586.78,-9619.04"/>
</g>
<!-- ffn_up_2 -->
<g id="node24" class="node">
<title>ffn_up_2</title>
<polygon fill="#e6ffe6" stroke="black" points="616,-9439 224,-9439 224,-9386 616,-9386 616,-9439"/>
<text text-anchor="middle" x="420" y="-9423.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="420" y="-9408.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="420" y="-9393.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- ln2_2&#45;&gt;ffn_up_2 -->
<g id="edge25" class="edge">
<title>ln2_2&#45;&gt;ffn_up_2</title>
<path fill="none" stroke="black" d="M456.68,-9474.87C451.65,-9466.45 445.97,-9456.95 440.61,-9447.98"/>
<polygon fill="black" stroke="black" points="443.53,-9446.04 435.39,-9439.25 437.52,-9449.63 443.53,-9446.04"/>
</g>
<!-- comm_2_3 -->
<g id="node27" class="node">
<title>comm_2_3</title>
<ellipse fill="#f0e6ff" stroke="black" cx="586" cy="-9045.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="586" y="-9056.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="586" y="-9041.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="586" y="-9026.8" font-family="Arial" font-size="14.00">GPU: 1 → GPU: 2</text>
</g>
<!-- residual2_2&#45;&gt;comm_2_3 -->
<g id="edge29" class="edge">
<title>residual2_2&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M586,-9118.75C586,-9110.93 586,-9102.07 586,-9093.31"/>
<polygon fill="black" stroke="black" points="589.5,-9093.13 586,-9083.13 582.5,-9093.13 589.5,-9093.13"/>
</g>
<!-- ffn_act_2 -->
<g id="node25" class="node">
<title>ffn_act_2</title>
<polygon fill="#e6ffe6" stroke="black" points="520,-9350 320,-9350 320,-9297 520,-9297 520,-9350"/>
<text text-anchor="middle" x="420" y="-9334.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="420" y="-9319.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="420" y="-9304.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_up_2&#45;&gt;ffn_act_2 -->
<g id="edge26" class="edge">
<title>ffn_up_2&#45;&gt;ffn_act_2</title>
<path fill="none" stroke="black" d="M420,-9385.87C420,-9377.89 420,-9368.93 420,-9360.38"/>
<polygon fill="black" stroke="black" points="423.5,-9360.25 420,-9350.25 416.5,-9360.25 423.5,-9360.25"/>
</g>
<!-- ffn_down_2 -->
<g id="node26" class="node">
<title>ffn_down_2</title>
<polygon fill="#e6ffe6" stroke="black" points="616,-9261 224,-9261 224,-9208 616,-9208 616,-9261"/>
<text text-anchor="middle" x="420" y="-9245.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="420" y="-9230.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="420" y="-9215.8" font-family="Arial" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn_act_2&#45;&gt;ffn_down_2 -->
<g id="edge27" class="edge">
<title>ffn_act_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M420,-9296.87C420,-9288.89 420,-9279.93 420,-9271.38"/>
<polygon fill="black" stroke="black" points="423.5,-9271.25 420,-9261.25 416.5,-9271.25 423.5,-9271.25"/>
</g>
<!-- ffn_down_2&#45;&gt;residual2_2 -->
<g id="edge28" class="edge">
<title>ffn_down_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M468.91,-9207.87C487.48,-9198.13 508.82,-9186.95 528.14,-9176.82"/>
<polygon fill="black" stroke="black" points="529.92,-9179.84 537.16,-9172.1 526.67,-9173.64 529.92,-9179.84"/>
</g>
<!-- residual1_3 -->
<g id="node28" class="node">
<title>residual1_3</title>
<polygon fill="#f0f8ff" stroke="black" points="849.5,-8972 662.5,-8972 662.5,-8919 849.5,-8919 849.5,-8972"/>
<text text-anchor="middle" x="756" y="-8956.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="756" y="-8941.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="756" y="-8926.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- comm_2_3&#45;&gt;residual1_3 -->
<g id="edge30" class="edge">
<title>comm_2_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M643.08,-9011.59C662.4,-9000.46 683.88,-8988.07 702.88,-8977.12"/>
<polygon fill="black" stroke="black" points="704.79,-8980.06 711.7,-8972.04 701.29,-8974 704.79,-8980.06"/>
</g>
<!-- ln2_3 -->
<g id="node35" class="node">
<title>ln2_3</title>
<polygon fill="#ffe4e1" stroke="black" points="789.5,-8883 602.5,-8883 602.5,-8830 789.5,-8830 789.5,-8883"/>
<text text-anchor="middle" x="696" y="-8867.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="696" y="-8852.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="696" y="-8837.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge37" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M738.32,-8918.87C732.45,-8910.36 725.83,-8900.75 719.59,-8891.7"/>
<polygon fill="black" stroke="black" points="722.32,-8889.49 713.76,-8883.25 716.55,-8893.47 722.32,-8889.49"/>
</g>
<!-- residual2_3 -->
<g id="node36" class="node">
<title>residual2_3</title>
<polygon fill="#f0f8ff" stroke="black" points="903.5,-8527 716.5,-8527 716.5,-8474 903.5,-8474 903.5,-8527"/>
<text text-anchor="middle" x="810" y="-8511.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="810" y="-8496.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="810" y="-8481.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge38" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M785.72,-8918.82C818.9,-8887.14 868,-8829.89 868,-8768.5 868,-8768.5 868,-8768.5 868,-8677.5 868,-8625.92 867.4,-8611.19 849,-8563 845.45,-8553.71 840.4,-8544.32 835.11,-8535.77"/>
<polygon fill="black" stroke="black" points="837.93,-8533.69 829.55,-8527.2 832.06,-8537.5 837.93,-8533.69"/>
</g>
<!-- ln1_3 -->
<g id="node29" class="node">
<title>ln1_3</title>
<polygon fill="#ffe4e1" stroke="black" points="1019.5,-9528 832.5,-9528 832.5,-9475 1019.5,-9475 1019.5,-9528"/>
<text text-anchor="middle" x="926" y="-9512.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="926" y="-9497.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="926" y="-9482.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_qkv_3 -->
<g id="node30" class="node">
<title>attn_qkv_3</title>
<polygon fill="#ffe6e6" stroke="black" points="1122,-9439 730,-9439 730,-9386 1122,-9386 1122,-9439"/>
<text text-anchor="middle" x="926" y="-9423.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="926" y="-9408.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="926" y="-9393.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- ln1_3&#45;&gt;attn_qkv_3 -->
<g id="edge31" class="edge">
<title>ln1_3&#45;&gt;attn_qkv_3</title>
<path fill="none" stroke="black" d="M926,-9474.87C926,-9466.89 926,-9457.93 926,-9449.38"/>
<polygon fill="black" stroke="black" points="929.5,-9449.25 926,-9439.25 922.5,-9449.25 929.5,-9449.25"/>
</g>
<!-- attn_score_3 -->
<g id="node31" class="node">
<title>attn_score_3</title>
<polygon fill="#ffe6e6" stroke="black" points="1008,-9350 844,-9350 844,-9297 1008,-9297 1008,-9350"/>
<text text-anchor="middle" x="926" y="-9334.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="926" y="-9319.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="926" y="-9304.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_qkv_3&#45;&gt;attn_score_3 -->
<g id="edge32" class="edge">
<title>attn_qkv_3&#45;&gt;attn_score_3</title>
<path fill="none" stroke="black" d="M926,-9385.87C926,-9377.89 926,-9368.93 926,-9360.38"/>
<polygon fill="black" stroke="black" points="929.5,-9360.25 926,-9350.25 922.5,-9360.25 929.5,-9360.25"/>
</g>
<!-- attn_weight_3 -->
<g id="node32" class="node">
<title>attn_weight_3</title>
<polygon fill="#ffe6e6" stroke="black" points="1008,-9261 844,-9261 844,-9208 1008,-9208 1008,-9261"/>
<text text-anchor="middle" x="926" y="-9245.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="926" y="-9230.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="926" y="-9215.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_score_3&#45;&gt;attn_weight_3 -->
<g id="edge33" class="edge">
<title>attn_score_3&#45;&gt;attn_weight_3</title>
<path fill="none" stroke="black" d="M926,-9296.87C926,-9288.89 926,-9279.93 926,-9271.38"/>
<polygon fill="black" stroke="black" points="929.5,-9271.25 926,-9261.25 922.5,-9271.25 929.5,-9271.25"/>
</g>
<!-- attn_context_3 -->
<g id="node33" class="node">
<title>attn_context_3</title>
<polygon fill="#ffe6e6" stroke="black" points="1019.5,-9172 832.5,-9172 832.5,-9119 1019.5,-9119 1019.5,-9172"/>
<text text-anchor="middle" x="926" y="-9156.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="926" y="-9141.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="926" y="-9126.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_weight_3&#45;&gt;attn_context_3 -->
<g id="edge34" class="edge">
<title>attn_weight_3&#45;&gt;attn_context_3</title>
<path fill="none" stroke="black" d="M926,-9207.87C926,-9199.89 926,-9190.93 926,-9182.38"/>
<polygon fill="black" stroke="black" points="929.5,-9182.25 926,-9172.25 922.5,-9182.25 929.5,-9182.25"/>
</g>
<!-- attn_out_3 -->
<g id="node34" class="node">
<title>attn_out_3</title>
<polygon fill="#ffe6e6" stroke="black" points="1115.5,-9072 736.5,-9072 736.5,-9019 1115.5,-9019 1115.5,-9072"/>
<text text-anchor="middle" x="926" y="-9056.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="926" y="-9041.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="926" y="-9026.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- attn_context_3&#45;&gt;attn_out_3 -->
<g id="edge35" class="edge">
<title>attn_context_3&#45;&gt;attn_out_3</title>
<path fill="none" stroke="black" d="M926,-9118.75C926,-9107.61 926,-9094.38 926,-9082.31"/>
<polygon fill="black" stroke="black" points="929.5,-9082.08 926,-9072.08 922.5,-9082.08 929.5,-9082.08"/>
</g>
<!-- attn_out_3&#45;&gt;residual1_3 -->
<g id="edge36" class="edge">
<title>attn_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M881.33,-9018.75C859.18,-9005.98 832.26,-8990.46 809.06,-8977.09"/>
<polygon fill="black" stroke="black" points="810.78,-8974.04 800.37,-8972.08 807.28,-8980.1 810.78,-8974.04"/>
</g>
<!-- ffn_up_3 -->
<g id="node37" class="node">
<title>ffn_up_3</title>
<polygon fill="#e6ffe6" stroke="black" points="840,-8794 448,-8794 448,-8741 840,-8741 840,-8794"/>
<text text-anchor="middle" x="644" y="-8778.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="644" y="-8763.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="644" y="-8748.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- ln2_3&#45;&gt;ffn_up_3 -->
<g id="edge39" class="edge">
<title>ln2_3&#45;&gt;ffn_up_3</title>
<path fill="none" stroke="black" d="M680.68,-8829.87C675.65,-8821.45 669.97,-8811.95 664.61,-8802.98"/>
<polygon fill="black" stroke="black" points="667.53,-8801.04 659.39,-8794.25 661.52,-8804.63 667.53,-8801.04"/>
</g>
<!-- comm_3_4 -->
<g id="node40" class="node">
<title>comm_3_4</title>
<ellipse fill="#f0e6ff" stroke="black" cx="810" cy="-8400.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="810" y="-8411.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="810" y="-8396.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="810" y="-8381.8" font-family="Arial" font-size="14.00">GPU: 2 → GPU: 3</text>
</g>
<!-- residual2_3&#45;&gt;comm_3_4 -->
<g id="edge43" class="edge">
<title>residual2_3&#45;&gt;comm_3_4</title>
<path fill="none" stroke="black" d="M810,-8473.75C810,-8465.93 810,-8457.07 810,-8448.31"/>
<polygon fill="black" stroke="black" points="813.5,-8448.13 810,-8438.13 806.5,-8448.13 813.5,-8448.13"/>
</g>
<!-- ffn_act_3 -->
<g id="node38" class="node">
<title>ffn_act_3</title>
<polygon fill="#e6ffe6" stroke="black" points="744,-8705 544,-8705 544,-8652 744,-8652 744,-8705"/>
<text text-anchor="middle" x="644" y="-8689.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="644" y="-8674.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="644" y="-8659.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_up_3&#45;&gt;ffn_act_3 -->
<g id="edge40" class="edge">
<title>ffn_up_3&#45;&gt;ffn_act_3</title>
<path fill="none" stroke="black" d="M644,-8740.87C644,-8732.89 644,-8723.93 644,-8715.38"/>
<polygon fill="black" stroke="black" points="647.5,-8715.25 644,-8705.25 640.5,-8715.25 647.5,-8715.25"/>
</g>
<!-- ffn_down_3 -->
<g id="node39" class="node">
<title>ffn_down_3</title>
<polygon fill="#e6ffe6" stroke="black" points="840,-8616 448,-8616 448,-8563 840,-8563 840,-8616"/>
<text text-anchor="middle" x="644" y="-8600.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="644" y="-8585.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="644" y="-8570.8" font-family="Arial" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn_act_3&#45;&gt;ffn_down_3 -->
<g id="edge41" class="edge">
<title>ffn_act_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M644,-8651.87C644,-8643.89 644,-8634.93 644,-8626.38"/>
<polygon fill="black" stroke="black" points="647.5,-8626.25 644,-8616.25 640.5,-8626.25 647.5,-8626.25"/>
</g>
<!-- ffn_down_3&#45;&gt;residual2_3 -->
<g id="edge42" class="edge">
<title>ffn_down_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M692.91,-8562.87C711.48,-8553.13 732.82,-8541.95 752.14,-8531.82"/>
<polygon fill="black" stroke="black" points="753.92,-8534.84 761.16,-8527.1 750.67,-8528.64 753.92,-8534.84"/>
</g>
<!-- residual1_4 -->
<g id="node41" class="node">
<title>residual1_4</title>
<polygon fill="#f0f8ff" stroke="black" points="1073.5,-8327 886.5,-8327 886.5,-8274 1073.5,-8274 1073.5,-8327"/>
<text text-anchor="middle" x="980" y="-8311.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="980" y="-8296.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="980" y="-8281.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- comm_3_4&#45;&gt;residual1_4 -->
<g id="edge44" class="edge">
<title>comm_3_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M867.08,-8366.59C886.4,-8355.46 907.88,-8343.07 926.88,-8332.12"/>
<polygon fill="black" stroke="black" points="928.79,-8335.06 935.7,-8327.04 925.29,-8329 928.79,-8335.06"/>
</g>
<!-- ln2_4 -->
<g id="node48" class="node">
<title>ln2_4</title>
<polygon fill="#ffe4e1" stroke="black" points="1013.5,-8238 826.5,-8238 826.5,-8185 1013.5,-8185 1013.5,-8238"/>
<text text-anchor="middle" x="920" y="-8222.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="920" y="-8207.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="920" y="-8192.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge51" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M962.32,-8273.87C956.45,-8265.36 949.83,-8255.75 943.59,-8246.7"/>
<polygon fill="black" stroke="black" points="946.32,-8244.49 937.76,-8238.25 940.55,-8248.47 946.32,-8244.49"/>
</g>
<!-- residual2_4 -->
<g id="node49" class="node">
<title>residual2_4</title>
<polygon fill="#f0f8ff" stroke="black" points="1127.5,-7882 940.5,-7882 940.5,-7829 1127.5,-7829 1127.5,-7882"/>
<text text-anchor="middle" x="1034" y="-7866.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1034" y="-7851.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1034" y="-7836.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- residual1_4&#45;&gt;residual2_4 -->
<g id="edge52" class="edge">
<title>residual1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M1009.72,-8273.82C1042.9,-8242.14 1092,-8184.89 1092,-8123.5 1092,-8123.5 1092,-8123.5 1092,-8032.5 1092,-7980.92 1091.4,-7966.19 1073,-7918 1069.45,-7908.71 1064.4,-7899.32 1059.11,-7890.77"/>
<polygon fill="black" stroke="black" points="1061.93,-7888.69 1053.55,-7882.2 1056.06,-7892.5 1061.93,-7888.69"/>
</g>
<!-- ln1_4 -->
<g id="node42" class="node">
<title>ln1_4</title>
<polygon fill="#ffe4e1" stroke="black" points="1243.5,-8883 1056.5,-8883 1056.5,-8830 1243.5,-8830 1243.5,-8883"/>
<text text-anchor="middle" x="1150" y="-8867.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1150" y="-8852.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1150" y="-8837.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_qkv_4 -->
<g id="node43" class="node">
<title>attn_qkv_4</title>
<polygon fill="#ffe6e6" stroke="black" points="1346,-8794 954,-8794 954,-8741 1346,-8741 1346,-8794"/>
<text text-anchor="middle" x="1150" y="-8778.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1150" y="-8763.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="1150" y="-8748.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- ln1_4&#45;&gt;attn_qkv_4 -->
<g id="edge45" class="edge">
<title>ln1_4&#45;&gt;attn_qkv_4</title>
<path fill="none" stroke="black" d="M1150,-8829.87C1150,-8821.89 1150,-8812.93 1150,-8804.38"/>
<polygon fill="black" stroke="black" points="1153.5,-8804.25 1150,-8794.25 1146.5,-8804.25 1153.5,-8804.25"/>
</g>
<!-- attn_score_4 -->
<g id="node44" class="node">
<title>attn_score_4</title>
<polygon fill="#ffe6e6" stroke="black" points="1232,-8705 1068,-8705 1068,-8652 1232,-8652 1232,-8705"/>
<text text-anchor="middle" x="1150" y="-8689.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1150" y="-8674.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="1150" y="-8659.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_qkv_4&#45;&gt;attn_score_4 -->
<g id="edge46" class="edge">
<title>attn_qkv_4&#45;&gt;attn_score_4</title>
<path fill="none" stroke="black" d="M1150,-8740.87C1150,-8732.89 1150,-8723.93 1150,-8715.38"/>
<polygon fill="black" stroke="black" points="1153.5,-8715.25 1150,-8705.25 1146.5,-8715.25 1153.5,-8715.25"/>
</g>
<!-- attn_weight_4 -->
<g id="node45" class="node">
<title>attn_weight_4</title>
<polygon fill="#ffe6e6" stroke="black" points="1232,-8616 1068,-8616 1068,-8563 1232,-8563 1232,-8616"/>
<text text-anchor="middle" x="1150" y="-8600.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="1150" y="-8585.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="1150" y="-8570.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_score_4&#45;&gt;attn_weight_4 -->
<g id="edge47" class="edge">
<title>attn_score_4&#45;&gt;attn_weight_4</title>
<path fill="none" stroke="black" d="M1150,-8651.87C1150,-8643.89 1150,-8634.93 1150,-8626.38"/>
<polygon fill="black" stroke="black" points="1153.5,-8626.25 1150,-8616.25 1146.5,-8626.25 1153.5,-8626.25"/>
</g>
<!-- attn_context_4 -->
<g id="node46" class="node">
<title>attn_context_4</title>
<polygon fill="#ffe6e6" stroke="black" points="1243.5,-8527 1056.5,-8527 1056.5,-8474 1243.5,-8474 1243.5,-8527"/>
<text text-anchor="middle" x="1150" y="-8511.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="1150" y="-8496.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1150" y="-8481.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_weight_4&#45;&gt;attn_context_4 -->
<g id="edge48" class="edge">
<title>attn_weight_4&#45;&gt;attn_context_4</title>
<path fill="none" stroke="black" d="M1150,-8562.87C1150,-8554.89 1150,-8545.93 1150,-8537.38"/>
<polygon fill="black" stroke="black" points="1153.5,-8537.25 1150,-8527.25 1146.5,-8537.25 1153.5,-8537.25"/>
</g>
<!-- attn_out_4 -->
<g id="node47" class="node">
<title>attn_out_4</title>
<polygon fill="#ffe6e6" stroke="black" points="1339.5,-8427 960.5,-8427 960.5,-8374 1339.5,-8374 1339.5,-8427"/>
<text text-anchor="middle" x="1150" y="-8411.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1150" y="-8396.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1150" y="-8381.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- attn_context_4&#45;&gt;attn_out_4 -->
<g id="edge49" class="edge">
<title>attn_context_4&#45;&gt;attn_out_4</title>
<path fill="none" stroke="black" d="M1150,-8473.75C1150,-8462.61 1150,-8449.38 1150,-8437.31"/>
<polygon fill="black" stroke="black" points="1153.5,-8437.08 1150,-8427.08 1146.5,-8437.08 1153.5,-8437.08"/>
</g>
<!-- attn_out_4&#45;&gt;residual1_4 -->
<g id="edge50" class="edge">
<title>attn_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M1105.33,-8373.75C1083.18,-8360.98 1056.26,-8345.46 1033.06,-8332.09"/>
<polygon fill="black" stroke="black" points="1034.78,-8329.04 1024.37,-8327.08 1031.28,-8335.1 1034.78,-8329.04"/>
</g>
<!-- ffn_up_4 -->
<g id="node50" class="node">
<title>ffn_up_4</title>
<polygon fill="#e6ffe6" stroke="black" points="1064,-8149 672,-8149 672,-8096 1064,-8096 1064,-8149"/>
<text text-anchor="middle" x="868" y="-8133.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="868" y="-8118.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="868" y="-8103.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- ln2_4&#45;&gt;ffn_up_4 -->
<g id="edge53" class="edge">
<title>ln2_4&#45;&gt;ffn_up_4</title>
<path fill="none" stroke="black" d="M904.68,-8184.87C899.65,-8176.45 893.97,-8166.95 888.61,-8157.98"/>
<polygon fill="black" stroke="black" points="891.53,-8156.04 883.39,-8149.25 885.52,-8159.63 891.53,-8156.04"/>
</g>
<!-- comm_4_5 -->
<g id="node53" class="node">
<title>comm_4_5</title>
<ellipse fill="#f0e6ff" stroke="black" cx="1034" cy="-7755.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="1034" y="-7766.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1034" y="-7751.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1034" y="-7736.8" font-family="Arial" font-size="14.00">GPU: 3 → GPU: 4</text>
</g>
<!-- residual2_4&#45;&gt;comm_4_5 -->
<g id="edge57" class="edge">
<title>residual2_4&#45;&gt;comm_4_5</title>
<path fill="none" stroke="black" d="M1034,-7828.75C1034,-7820.93 1034,-7812.07 1034,-7803.31"/>
<polygon fill="black" stroke="black" points="1037.5,-7803.13 1034,-7793.13 1030.5,-7803.13 1037.5,-7803.13"/>
</g>
<!-- ffn_act_4 -->
<g id="node51" class="node">
<title>ffn_act_4</title>
<polygon fill="#e6ffe6" stroke="black" points="968,-8060 768,-8060 768,-8007 968,-8007 968,-8060"/>
<text text-anchor="middle" x="868" y="-8044.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="868" y="-8029.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="868" y="-8014.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_up_4&#45;&gt;ffn_act_4 -->
<g id="edge54" class="edge">
<title>ffn_up_4&#45;&gt;ffn_act_4</title>
<path fill="none" stroke="black" d="M868,-8095.87C868,-8087.89 868,-8078.93 868,-8070.38"/>
<polygon fill="black" stroke="black" points="871.5,-8070.25 868,-8060.25 864.5,-8070.25 871.5,-8070.25"/>
</g>
<!-- ffn_down_4 -->
<g id="node52" class="node">
<title>ffn_down_4</title>
<polygon fill="#e6ffe6" stroke="black" points="1064,-7971 672,-7971 672,-7918 1064,-7918 1064,-7971"/>
<text text-anchor="middle" x="868" y="-7955.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="868" y="-7940.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="868" y="-7925.8" font-family="Arial" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn_act_4&#45;&gt;ffn_down_4 -->
<g id="edge55" class="edge">
<title>ffn_act_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M868,-8006.87C868,-7998.89 868,-7989.93 868,-7981.38"/>
<polygon fill="black" stroke="black" points="871.5,-7981.25 868,-7971.25 864.5,-7981.25 871.5,-7981.25"/>
</g>
<!-- ffn_down_4&#45;&gt;residual2_4 -->
<g id="edge56" class="edge">
<title>ffn_down_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M916.91,-7917.87C935.48,-7908.13 956.82,-7896.95 976.14,-7886.82"/>
<polygon fill="black" stroke="black" points="977.92,-7889.84 985.16,-7882.1 974.67,-7883.64 977.92,-7889.84"/>
</g>
<!-- residual1_5 -->
<g id="node54" class="node">
<title>residual1_5</title>
<polygon fill="#f0f8ff" stroke="black" points="1297.5,-7682 1110.5,-7682 1110.5,-7629 1297.5,-7629 1297.5,-7682"/>
<text text-anchor="middle" x="1204" y="-7666.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1204" y="-7651.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1204" y="-7636.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- comm_4_5&#45;&gt;residual1_5 -->
<g id="edge58" class="edge">
<title>comm_4_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M1091.08,-7721.59C1110.4,-7710.46 1131.88,-7698.07 1150.88,-7687.12"/>
<polygon fill="black" stroke="black" points="1152.79,-7690.06 1159.7,-7682.04 1149.29,-7684 1152.79,-7690.06"/>
</g>
<!-- ln2_5 -->
<g id="node61" class="node">
<title>ln2_5</title>
<polygon fill="#ffe4e1" stroke="black" points="1237.5,-7593 1050.5,-7593 1050.5,-7540 1237.5,-7540 1237.5,-7593"/>
<text text-anchor="middle" x="1144" y="-7577.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1144" y="-7562.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1144" y="-7547.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge65" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M1186.32,-7628.87C1180.45,-7620.36 1173.83,-7610.75 1167.59,-7601.7"/>
<polygon fill="black" stroke="black" points="1170.32,-7599.49 1161.76,-7593.25 1164.55,-7603.47 1170.32,-7599.49"/>
</g>
<!-- residual2_5 -->
<g id="node62" class="node">
<title>residual2_5</title>
<polygon fill="#f0f8ff" stroke="black" points="1351.5,-7237 1164.5,-7237 1164.5,-7184 1351.5,-7184 1351.5,-7237"/>
<text text-anchor="middle" x="1258" y="-7221.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1258" y="-7206.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1258" y="-7191.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- residual1_5&#45;&gt;residual2_5 -->
<g id="edge66" class="edge">
<title>residual1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M1233.72,-7628.82C1266.9,-7597.14 1316,-7539.89 1316,-7478.5 1316,-7478.5 1316,-7478.5 1316,-7387.5 1316,-7335.92 1315.4,-7321.19 1297,-7273 1293.45,-7263.71 1288.4,-7254.32 1283.11,-7245.77"/>
<polygon fill="black" stroke="black" points="1285.93,-7243.69 1277.55,-7237.2 1280.06,-7247.5 1285.93,-7243.69"/>
</g>
<!-- ln1_5 -->
<g id="node55" class="node">
<title>ln1_5</title>
<polygon fill="#ffe4e1" stroke="black" points="1467.5,-8238 1280.5,-8238 1280.5,-8185 1467.5,-8185 1467.5,-8238"/>
<text text-anchor="middle" x="1374" y="-8222.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1374" y="-8207.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1374" y="-8192.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_qkv_5 -->
<g id="node56" class="node">
<title>attn_qkv_5</title>
<polygon fill="#ffe6e6" stroke="black" points="1570,-8149 1178,-8149 1178,-8096 1570,-8096 1570,-8149"/>
<text text-anchor="middle" x="1374" y="-8133.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1374" y="-8118.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="1374" y="-8103.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- ln1_5&#45;&gt;attn_qkv_5 -->
<g id="edge59" class="edge">
<title>ln1_5&#45;&gt;attn_qkv_5</title>
<path fill="none" stroke="black" d="M1374,-8184.87C1374,-8176.89 1374,-8167.93 1374,-8159.38"/>
<polygon fill="black" stroke="black" points="1377.5,-8159.25 1374,-8149.25 1370.5,-8159.25 1377.5,-8159.25"/>
</g>
<!-- attn_score_5 -->
<g id="node57" class="node">
<title>attn_score_5</title>
<polygon fill="#ffe6e6" stroke="black" points="1456,-8060 1292,-8060 1292,-8007 1456,-8007 1456,-8060"/>
<text text-anchor="middle" x="1374" y="-8044.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1374" y="-8029.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="1374" y="-8014.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_qkv_5&#45;&gt;attn_score_5 -->
<g id="edge60" class="edge">
<title>attn_qkv_5&#45;&gt;attn_score_5</title>
<path fill="none" stroke="black" d="M1374,-8095.87C1374,-8087.89 1374,-8078.93 1374,-8070.38"/>
<polygon fill="black" stroke="black" points="1377.5,-8070.25 1374,-8060.25 1370.5,-8070.25 1377.5,-8070.25"/>
</g>
<!-- attn_weight_5 -->
<g id="node58" class="node">
<title>attn_weight_5</title>
<polygon fill="#ffe6e6" stroke="black" points="1456,-7971 1292,-7971 1292,-7918 1456,-7918 1456,-7971"/>
<text text-anchor="middle" x="1374" y="-7955.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="1374" y="-7940.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="1374" y="-7925.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_score_5&#45;&gt;attn_weight_5 -->
<g id="edge61" class="edge">
<title>attn_score_5&#45;&gt;attn_weight_5</title>
<path fill="none" stroke="black" d="M1374,-8006.87C1374,-7998.89 1374,-7989.93 1374,-7981.38"/>
<polygon fill="black" stroke="black" points="1377.5,-7981.25 1374,-7971.25 1370.5,-7981.25 1377.5,-7981.25"/>
</g>
<!-- attn_context_5 -->
<g id="node59" class="node">
<title>attn_context_5</title>
<polygon fill="#ffe6e6" stroke="black" points="1467.5,-7882 1280.5,-7882 1280.5,-7829 1467.5,-7829 1467.5,-7882"/>
<text text-anchor="middle" x="1374" y="-7866.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="1374" y="-7851.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1374" y="-7836.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_weight_5&#45;&gt;attn_context_5 -->
<g id="edge62" class="edge">
<title>attn_weight_5&#45;&gt;attn_context_5</title>
<path fill="none" stroke="black" d="M1374,-7917.87C1374,-7909.89 1374,-7900.93 1374,-7892.38"/>
<polygon fill="black" stroke="black" points="1377.5,-7892.25 1374,-7882.25 1370.5,-7892.25 1377.5,-7892.25"/>
</g>
<!-- attn_out_5 -->
<g id="node60" class="node">
<title>attn_out_5</title>
<polygon fill="#ffe6e6" stroke="black" points="1563.5,-7782 1184.5,-7782 1184.5,-7729 1563.5,-7729 1563.5,-7782"/>
<text text-anchor="middle" x="1374" y="-7766.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1374" y="-7751.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1374" y="-7736.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- attn_context_5&#45;&gt;attn_out_5 -->
<g id="edge63" class="edge">
<title>attn_context_5&#45;&gt;attn_out_5</title>
<path fill="none" stroke="black" d="M1374,-7828.75C1374,-7817.61 1374,-7804.38 1374,-7792.31"/>
<polygon fill="black" stroke="black" points="1377.5,-7792.08 1374,-7782.08 1370.5,-7792.08 1377.5,-7792.08"/>
</g>
<!-- attn_out_5&#45;&gt;residual1_5 -->
<g id="edge64" class="edge">
<title>attn_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M1329.33,-7728.75C1307.18,-7715.98 1280.26,-7700.46 1257.06,-7687.09"/>
<polygon fill="black" stroke="black" points="1258.78,-7684.04 1248.37,-7682.08 1255.28,-7690.1 1258.78,-7684.04"/>
</g>
<!-- ffn_up_5 -->
<g id="node63" class="node">
<title>ffn_up_5</title>
<polygon fill="#e6ffe6" stroke="black" points="1288,-7504 896,-7504 896,-7451 1288,-7451 1288,-7504"/>
<text text-anchor="middle" x="1092" y="-7488.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1092" y="-7473.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1092" y="-7458.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- ln2_5&#45;&gt;ffn_up_5 -->
<g id="edge67" class="edge">
<title>ln2_5&#45;&gt;ffn_up_5</title>
<path fill="none" stroke="black" d="M1128.68,-7539.87C1123.65,-7531.45 1117.97,-7521.95 1112.61,-7512.98"/>
<polygon fill="black" stroke="black" points="1115.53,-7511.04 1107.39,-7504.25 1109.52,-7514.63 1115.53,-7511.04"/>
</g>
<!-- comm_5_6 -->
<g id="node66" class="node">
<title>comm_5_6</title>
<ellipse fill="#f0e6ff" stroke="black" cx="1258" cy="-7110.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="1258" y="-7121.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1258" y="-7106.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1258" y="-7091.8" font-family="Arial" font-size="14.00">GPU: 4 → GPU: 5</text>
</g>
<!-- residual2_5&#45;&gt;comm_5_6 -->
<g id="edge71" class="edge">
<title>residual2_5&#45;&gt;comm_5_6</title>
<path fill="none" stroke="black" d="M1258,-7183.75C1258,-7175.93 1258,-7167.07 1258,-7158.31"/>
<polygon fill="black" stroke="black" points="1261.5,-7158.13 1258,-7148.13 1254.5,-7158.13 1261.5,-7158.13"/>
</g>
<!-- ffn_act_5 -->
<g id="node64" class="node">
<title>ffn_act_5</title>
<polygon fill="#e6ffe6" stroke="black" points="1192,-7415 992,-7415 992,-7362 1192,-7362 1192,-7415"/>
<text text-anchor="middle" x="1092" y="-7399.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1092" y="-7384.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1092" y="-7369.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_up_5&#45;&gt;ffn_act_5 -->
<g id="edge68" class="edge">
<title>ffn_up_5&#45;&gt;ffn_act_5</title>
<path fill="none" stroke="black" d="M1092,-7450.87C1092,-7442.89 1092,-7433.93 1092,-7425.38"/>
<polygon fill="black" stroke="black" points="1095.5,-7425.25 1092,-7415.25 1088.5,-7425.25 1095.5,-7425.25"/>
</g>
<!-- ffn_down_5 -->
<g id="node65" class="node">
<title>ffn_down_5</title>
<polygon fill="#e6ffe6" stroke="black" points="1288,-7326 896,-7326 896,-7273 1288,-7273 1288,-7326"/>
<text text-anchor="middle" x="1092" y="-7310.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1092" y="-7295.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1092" y="-7280.8" font-family="Arial" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn_act_5&#45;&gt;ffn_down_5 -->
<g id="edge69" class="edge">
<title>ffn_act_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M1092,-7361.87C1092,-7353.89 1092,-7344.93 1092,-7336.38"/>
<polygon fill="black" stroke="black" points="1095.5,-7336.25 1092,-7326.25 1088.5,-7336.25 1095.5,-7336.25"/>
</g>
<!-- ffn_down_5&#45;&gt;residual2_5 -->
<g id="edge70" class="edge">
<title>ffn_down_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M1140.91,-7272.87C1159.48,-7263.13 1180.82,-7251.95 1200.14,-7241.82"/>
<polygon fill="black" stroke="black" points="1201.92,-7244.84 1209.16,-7237.1 1198.67,-7238.64 1201.92,-7244.84"/>
</g>
<!-- residual1_6 -->
<g id="node67" class="node">
<title>residual1_6</title>
<polygon fill="#f0f8ff" stroke="black" points="1521.5,-7037 1334.5,-7037 1334.5,-6984 1521.5,-6984 1521.5,-7037"/>
<text text-anchor="middle" x="1428" y="-7021.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1428" y="-7006.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1428" y="-6991.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- comm_5_6&#45;&gt;residual1_6 -->
<g id="edge72" class="edge">
<title>comm_5_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M1315.08,-7076.59C1334.4,-7065.46 1355.88,-7053.07 1374.88,-7042.12"/>
<polygon fill="black" stroke="black" points="1376.79,-7045.06 1383.7,-7037.04 1373.29,-7039 1376.79,-7045.06"/>
</g>
<!-- ln2_6 -->
<g id="node74" class="node">
<title>ln2_6</title>
<polygon fill="#ffe4e1" stroke="black" points="1461.5,-6948 1274.5,-6948 1274.5,-6895 1461.5,-6895 1461.5,-6948"/>
<text text-anchor="middle" x="1368" y="-6932.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1368" y="-6917.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1368" y="-6902.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge79" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M1410.32,-6983.87C1404.45,-6975.36 1397.83,-6965.75 1391.59,-6956.7"/>
<polygon fill="black" stroke="black" points="1394.32,-6954.49 1385.76,-6948.25 1388.55,-6958.47 1394.32,-6954.49"/>
</g>
<!-- residual2_6 -->
<g id="node75" class="node">
<title>residual2_6</title>
<polygon fill="#f0f8ff" stroke="black" points="1575.5,-6592 1388.5,-6592 1388.5,-6539 1575.5,-6539 1575.5,-6592"/>
<text text-anchor="middle" x="1482" y="-6576.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1482" y="-6561.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1482" y="-6546.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- residual1_6&#45;&gt;residual2_6 -->
<g id="edge80" class="edge">
<title>residual1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M1457.72,-6983.82C1490.9,-6952.14 1540,-6894.89 1540,-6833.5 1540,-6833.5 1540,-6833.5 1540,-6742.5 1540,-6690.92 1539.4,-6676.19 1521,-6628 1517.45,-6618.71 1512.4,-6609.32 1507.11,-6600.77"/>
<polygon fill="black" stroke="black" points="1509.93,-6598.69 1501.55,-6592.2 1504.06,-6602.5 1509.93,-6598.69"/>
</g>
<!-- ln1_6 -->
<g id="node68" class="node">
<title>ln1_6</title>
<polygon fill="#ffe4e1" stroke="black" points="1691.5,-7593 1504.5,-7593 1504.5,-7540 1691.5,-7540 1691.5,-7593"/>
<text text-anchor="middle" x="1598" y="-7577.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1598" y="-7562.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1598" y="-7547.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_qkv_6 -->
<g id="node69" class="node">
<title>attn_qkv_6</title>
<polygon fill="#ffe6e6" stroke="black" points="1794,-7504 1402,-7504 1402,-7451 1794,-7451 1794,-7504"/>
<text text-anchor="middle" x="1598" y="-7488.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1598" y="-7473.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="1598" y="-7458.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- ln1_6&#45;&gt;attn_qkv_6 -->
<g id="edge73" class="edge">
<title>ln1_6&#45;&gt;attn_qkv_6</title>
<path fill="none" stroke="black" d="M1598,-7539.87C1598,-7531.89 1598,-7522.93 1598,-7514.38"/>
<polygon fill="black" stroke="black" points="1601.5,-7514.25 1598,-7504.25 1594.5,-7514.25 1601.5,-7514.25"/>
</g>
<!-- attn_score_6 -->
<g id="node70" class="node">
<title>attn_score_6</title>
<polygon fill="#ffe6e6" stroke="black" points="1680,-7415 1516,-7415 1516,-7362 1680,-7362 1680,-7415"/>
<text text-anchor="middle" x="1598" y="-7399.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1598" y="-7384.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="1598" y="-7369.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_qkv_6&#45;&gt;attn_score_6 -->
<g id="edge74" class="edge">
<title>attn_qkv_6&#45;&gt;attn_score_6</title>
<path fill="none" stroke="black" d="M1598,-7450.87C1598,-7442.89 1598,-7433.93 1598,-7425.38"/>
<polygon fill="black" stroke="black" points="1601.5,-7425.25 1598,-7415.25 1594.5,-7425.25 1601.5,-7425.25"/>
</g>
<!-- attn_weight_6 -->
<g id="node71" class="node">
<title>attn_weight_6</title>
<polygon fill="#ffe6e6" stroke="black" points="1680,-7326 1516,-7326 1516,-7273 1680,-7273 1680,-7326"/>
<text text-anchor="middle" x="1598" y="-7310.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="1598" y="-7295.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="1598" y="-7280.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_score_6&#45;&gt;attn_weight_6 -->
<g id="edge75" class="edge">
<title>attn_score_6&#45;&gt;attn_weight_6</title>
<path fill="none" stroke="black" d="M1598,-7361.87C1598,-7353.89 1598,-7344.93 1598,-7336.38"/>
<polygon fill="black" stroke="black" points="1601.5,-7336.25 1598,-7326.25 1594.5,-7336.25 1601.5,-7336.25"/>
</g>
<!-- attn_context_6 -->
<g id="node72" class="node">
<title>attn_context_6</title>
<polygon fill="#ffe6e6" stroke="black" points="1691.5,-7237 1504.5,-7237 1504.5,-7184 1691.5,-7184 1691.5,-7237"/>
<text text-anchor="middle" x="1598" y="-7221.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="1598" y="-7206.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1598" y="-7191.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_weight_6&#45;&gt;attn_context_6 -->
<g id="edge76" class="edge">
<title>attn_weight_6&#45;&gt;attn_context_6</title>
<path fill="none" stroke="black" d="M1598,-7272.87C1598,-7264.89 1598,-7255.93 1598,-7247.38"/>
<polygon fill="black" stroke="black" points="1601.5,-7247.25 1598,-7237.25 1594.5,-7247.25 1601.5,-7247.25"/>
</g>
<!-- attn_out_6 -->
<g id="node73" class="node">
<title>attn_out_6</title>
<polygon fill="#ffe6e6" stroke="black" points="1787.5,-7137 1408.5,-7137 1408.5,-7084 1787.5,-7084 1787.5,-7137"/>
<text text-anchor="middle" x="1598" y="-7121.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1598" y="-7106.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1598" y="-7091.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- attn_context_6&#45;&gt;attn_out_6 -->
<g id="edge77" class="edge">
<title>attn_context_6&#45;&gt;attn_out_6</title>
<path fill="none" stroke="black" d="M1598,-7183.75C1598,-7172.61 1598,-7159.38 1598,-7147.31"/>
<polygon fill="black" stroke="black" points="1601.5,-7147.08 1598,-7137.08 1594.5,-7147.08 1601.5,-7147.08"/>
</g>
<!-- attn_out_6&#45;&gt;residual1_6 -->
<g id="edge78" class="edge">
<title>attn_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M1553.33,-7083.75C1531.18,-7070.98 1504.26,-7055.46 1481.06,-7042.09"/>
<polygon fill="black" stroke="black" points="1482.78,-7039.04 1472.37,-7037.08 1479.28,-7045.1 1482.78,-7039.04"/>
</g>
<!-- ffn_up_6 -->
<g id="node76" class="node">
<title>ffn_up_6</title>
<polygon fill="#e6ffe6" stroke="black" points="1512,-6859 1120,-6859 1120,-6806 1512,-6806 1512,-6859"/>
<text text-anchor="middle" x="1316" y="-6843.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1316" y="-6828.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1316" y="-6813.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- ln2_6&#45;&gt;ffn_up_6 -->
<g id="edge81" class="edge">
<title>ln2_6&#45;&gt;ffn_up_6</title>
<path fill="none" stroke="black" d="M1352.68,-6894.87C1347.65,-6886.45 1341.97,-6876.95 1336.61,-6867.98"/>
<polygon fill="black" stroke="black" points="1339.53,-6866.04 1331.39,-6859.25 1333.52,-6869.63 1339.53,-6866.04"/>
</g>
<!-- comm_6_7 -->
<g id="node79" class="node">
<title>comm_6_7</title>
<ellipse fill="#f0e6ff" stroke="black" cx="1482" cy="-6465.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="1482" y="-6476.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1482" y="-6461.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1482" y="-6446.8" font-family="Arial" font-size="14.00">GPU: 5 → GPU: 6</text>
</g>
<!-- residual2_6&#45;&gt;comm_6_7 -->
<g id="edge85" class="edge">
<title>residual2_6&#45;&gt;comm_6_7</title>
<path fill="none" stroke="black" d="M1482,-6538.75C1482,-6530.93 1482,-6522.07 1482,-6513.31"/>
<polygon fill="black" stroke="black" points="1485.5,-6513.13 1482,-6503.13 1478.5,-6513.13 1485.5,-6513.13"/>
</g>
<!-- ffn_act_6 -->
<g id="node77" class="node">
<title>ffn_act_6</title>
<polygon fill="#e6ffe6" stroke="black" points="1416,-6770 1216,-6770 1216,-6717 1416,-6717 1416,-6770"/>
<text text-anchor="middle" x="1316" y="-6754.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1316" y="-6739.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1316" y="-6724.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_up_6&#45;&gt;ffn_act_6 -->
<g id="edge82" class="edge">
<title>ffn_up_6&#45;&gt;ffn_act_6</title>
<path fill="none" stroke="black" d="M1316,-6805.87C1316,-6797.89 1316,-6788.93 1316,-6780.38"/>
<polygon fill="black" stroke="black" points="1319.5,-6780.25 1316,-6770.25 1312.5,-6780.25 1319.5,-6780.25"/>
</g>
<!-- ffn_down_6 -->
<g id="node78" class="node">
<title>ffn_down_6</title>
<polygon fill="#e6ffe6" stroke="black" points="1512,-6681 1120,-6681 1120,-6628 1512,-6628 1512,-6681"/>
<text text-anchor="middle" x="1316" y="-6665.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1316" y="-6650.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1316" y="-6635.8" font-family="Arial" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn_act_6&#45;&gt;ffn_down_6 -->
<g id="edge83" class="edge">
<title>ffn_act_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M1316,-6716.87C1316,-6708.89 1316,-6699.93 1316,-6691.38"/>
<polygon fill="black" stroke="black" points="1319.5,-6691.25 1316,-6681.25 1312.5,-6691.25 1319.5,-6691.25"/>
</g>
<!-- ffn_down_6&#45;&gt;residual2_6 -->
<g id="edge84" class="edge">
<title>ffn_down_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M1364.91,-6627.87C1383.48,-6618.13 1404.82,-6606.95 1424.14,-6596.82"/>
<polygon fill="black" stroke="black" points="1425.92,-6599.84 1433.16,-6592.1 1422.67,-6593.64 1425.92,-6599.84"/>
</g>
<!-- residual1_7 -->
<g id="node80" class="node">
<title>residual1_7</title>
<polygon fill="#f0f8ff" stroke="black" points="1745.5,-6392 1558.5,-6392 1558.5,-6339 1745.5,-6339 1745.5,-6392"/>
<text text-anchor="middle" x="1652" y="-6376.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1652" y="-6361.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1652" y="-6346.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- comm_6_7&#45;&gt;residual1_7 -->
<g id="edge86" class="edge">
<title>comm_6_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M1539.08,-6431.59C1558.4,-6420.46 1579.88,-6408.07 1598.88,-6397.12"/>
<polygon fill="black" stroke="black" points="1600.79,-6400.06 1607.7,-6392.04 1597.29,-6394 1600.79,-6400.06"/>
</g>
<!-- ln2_7 -->
<g id="node87" class="node">
<title>ln2_7</title>
<polygon fill="#ffe4e1" stroke="black" points="1685.5,-6303 1498.5,-6303 1498.5,-6250 1685.5,-6250 1685.5,-6303"/>
<text text-anchor="middle" x="1592" y="-6287.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1592" y="-6272.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1592" y="-6257.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge93" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M1634.32,-6338.87C1628.45,-6330.36 1621.83,-6320.75 1615.59,-6311.7"/>
<polygon fill="black" stroke="black" points="1618.32,-6309.49 1609.76,-6303.25 1612.55,-6313.47 1618.32,-6309.49"/>
</g>
<!-- residual2_7 -->
<g id="node88" class="node">
<title>residual2_7</title>
<polygon fill="#f0f8ff" stroke="black" points="1799.5,-5947 1612.5,-5947 1612.5,-5894 1799.5,-5894 1799.5,-5947"/>
<text text-anchor="middle" x="1706" y="-5931.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1706" y="-5916.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1706" y="-5901.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- residual1_7&#45;&gt;residual2_7 -->
<g id="edge94" class="edge">
<title>residual1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M1681.72,-6338.82C1714.9,-6307.14 1764,-6249.89 1764,-6188.5 1764,-6188.5 1764,-6188.5 1764,-6097.5 1764,-6045.92 1763.4,-6031.19 1745,-5983 1741.45,-5973.71 1736.4,-5964.32 1731.11,-5955.77"/>
<polygon fill="black" stroke="black" points="1733.93,-5953.69 1725.55,-5947.2 1728.06,-5957.5 1733.93,-5953.69"/>
</g>
<!-- ln1_7 -->
<g id="node81" class="node">
<title>ln1_7</title>
<polygon fill="#ffe4e1" stroke="black" points="1915.5,-6948 1728.5,-6948 1728.5,-6895 1915.5,-6895 1915.5,-6948"/>
<text text-anchor="middle" x="1822" y="-6932.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1822" y="-6917.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1822" y="-6902.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_qkv_7 -->
<g id="node82" class="node">
<title>attn_qkv_7</title>
<polygon fill="#ffe6e6" stroke="black" points="2018,-6859 1626,-6859 1626,-6806 2018,-6806 2018,-6859"/>
<text text-anchor="middle" x="1822" y="-6843.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="1822" y="-6828.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="1822" y="-6813.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- ln1_7&#45;&gt;attn_qkv_7 -->
<g id="edge87" class="edge">
<title>ln1_7&#45;&gt;attn_qkv_7</title>
<path fill="none" stroke="black" d="M1822,-6894.87C1822,-6886.89 1822,-6877.93 1822,-6869.38"/>
<polygon fill="black" stroke="black" points="1825.5,-6869.25 1822,-6859.25 1818.5,-6869.25 1825.5,-6869.25"/>
</g>
<!-- attn_score_7 -->
<g id="node83" class="node">
<title>attn_score_7</title>
<polygon fill="#ffe6e6" stroke="black" points="1904,-6770 1740,-6770 1740,-6717 1904,-6717 1904,-6770"/>
<text text-anchor="middle" x="1822" y="-6754.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="1822" y="-6739.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="1822" y="-6724.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_qkv_7&#45;&gt;attn_score_7 -->
<g id="edge88" class="edge">
<title>attn_qkv_7&#45;&gt;attn_score_7</title>
<path fill="none" stroke="black" d="M1822,-6805.87C1822,-6797.89 1822,-6788.93 1822,-6780.38"/>
<polygon fill="black" stroke="black" points="1825.5,-6780.25 1822,-6770.25 1818.5,-6780.25 1825.5,-6780.25"/>
</g>
<!-- attn_weight_7 -->
<g id="node84" class="node">
<title>attn_weight_7</title>
<polygon fill="#ffe6e6" stroke="black" points="1904,-6681 1740,-6681 1740,-6628 1904,-6628 1904,-6681"/>
<text text-anchor="middle" x="1822" y="-6665.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="1822" y="-6650.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="1822" y="-6635.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_score_7&#45;&gt;attn_weight_7 -->
<g id="edge89" class="edge">
<title>attn_score_7&#45;&gt;attn_weight_7</title>
<path fill="none" stroke="black" d="M1822,-6716.87C1822,-6708.89 1822,-6699.93 1822,-6691.38"/>
<polygon fill="black" stroke="black" points="1825.5,-6691.25 1822,-6681.25 1818.5,-6691.25 1825.5,-6691.25"/>
</g>
<!-- attn_context_7 -->
<g id="node85" class="node">
<title>attn_context_7</title>
<polygon fill="#ffe6e6" stroke="black" points="1915.5,-6592 1728.5,-6592 1728.5,-6539 1915.5,-6539 1915.5,-6592"/>
<text text-anchor="middle" x="1822" y="-6576.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="1822" y="-6561.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1822" y="-6546.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_weight_7&#45;&gt;attn_context_7 -->
<g id="edge90" class="edge">
<title>attn_weight_7&#45;&gt;attn_context_7</title>
<path fill="none" stroke="black" d="M1822,-6627.87C1822,-6619.89 1822,-6610.93 1822,-6602.38"/>
<polygon fill="black" stroke="black" points="1825.5,-6602.25 1822,-6592.25 1818.5,-6602.25 1825.5,-6602.25"/>
</g>
<!-- attn_out_7 -->
<g id="node86" class="node">
<title>attn_out_7</title>
<polygon fill="#ffe6e6" stroke="black" points="2011.5,-6492 1632.5,-6492 1632.5,-6439 2011.5,-6439 2011.5,-6492"/>
<text text-anchor="middle" x="1822" y="-6476.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="1822" y="-6461.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1822" y="-6446.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- attn_context_7&#45;&gt;attn_out_7 -->
<g id="edge91" class="edge">
<title>attn_context_7&#45;&gt;attn_out_7</title>
<path fill="none" stroke="black" d="M1822,-6538.75C1822,-6527.61 1822,-6514.38 1822,-6502.31"/>
<polygon fill="black" stroke="black" points="1825.5,-6502.08 1822,-6492.08 1818.5,-6502.08 1825.5,-6502.08"/>
</g>
<!-- attn_out_7&#45;&gt;residual1_7 -->
<g id="edge92" class="edge">
<title>attn_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M1777.33,-6438.75C1755.18,-6425.98 1728.26,-6410.46 1705.06,-6397.09"/>
<polygon fill="black" stroke="black" points="1706.78,-6394.04 1696.37,-6392.08 1703.28,-6400.1 1706.78,-6394.04"/>
</g>
<!-- ffn_up_7 -->
<g id="node89" class="node">
<title>ffn_up_7</title>
<polygon fill="#e6ffe6" stroke="black" points="1736,-6214 1344,-6214 1344,-6161 1736,-6161 1736,-6214"/>
<text text-anchor="middle" x="1540" y="-6198.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1540" y="-6183.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1540" y="-6168.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- ln2_7&#45;&gt;ffn_up_7 -->
<g id="edge95" class="edge">
<title>ln2_7&#45;&gt;ffn_up_7</title>
<path fill="none" stroke="black" d="M1576.68,-6249.87C1571.65,-6241.45 1565.97,-6231.95 1560.61,-6222.98"/>
<polygon fill="black" stroke="black" points="1563.53,-6221.04 1555.39,-6214.25 1557.52,-6224.63 1563.53,-6221.04"/>
</g>
<!-- comm_7_8 -->
<g id="node92" class="node">
<title>comm_7_8</title>
<ellipse fill="#f0e6ff" stroke="black" cx="1706" cy="-5820.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="1706" y="-5831.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1706" y="-5816.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1706" y="-5801.8" font-family="Arial" font-size="14.00">GPU: 6 → GPU: 7</text>
</g>
<!-- residual2_7&#45;&gt;comm_7_8 -->
<g id="edge99" class="edge">
<title>residual2_7&#45;&gt;comm_7_8</title>
<path fill="none" stroke="black" d="M1706,-5893.75C1706,-5885.93 1706,-5877.07 1706,-5868.31"/>
<polygon fill="black" stroke="black" points="1709.5,-5868.13 1706,-5858.13 1702.5,-5868.13 1709.5,-5868.13"/>
</g>
<!-- ffn_act_7 -->
<g id="node90" class="node">
<title>ffn_act_7</title>
<polygon fill="#e6ffe6" stroke="black" points="1640,-6125 1440,-6125 1440,-6072 1640,-6072 1640,-6125"/>
<text text-anchor="middle" x="1540" y="-6109.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1540" y="-6094.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1540" y="-6079.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_up_7&#45;&gt;ffn_act_7 -->
<g id="edge96" class="edge">
<title>ffn_up_7&#45;&gt;ffn_act_7</title>
<path fill="none" stroke="black" d="M1540,-6160.87C1540,-6152.89 1540,-6143.93 1540,-6135.38"/>
<polygon fill="black" stroke="black" points="1543.5,-6135.25 1540,-6125.25 1536.5,-6135.25 1543.5,-6135.25"/>
</g>
<!-- ffn_down_7 -->
<g id="node91" class="node">
<title>ffn_down_7</title>
<polygon fill="#e6ffe6" stroke="black" points="1736,-6036 1344,-6036 1344,-5983 1736,-5983 1736,-6036"/>
<text text-anchor="middle" x="1540" y="-6020.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1540" y="-6005.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1540" y="-5990.8" font-family="Arial" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn_act_7&#45;&gt;ffn_down_7 -->
<g id="edge97" class="edge">
<title>ffn_act_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M1540,-6071.87C1540,-6063.89 1540,-6054.93 1540,-6046.38"/>
<polygon fill="black" stroke="black" points="1543.5,-6046.25 1540,-6036.25 1536.5,-6046.25 1543.5,-6046.25"/>
</g>
<!-- ffn_down_7&#45;&gt;residual2_7 -->
<g id="edge98" class="edge">
<title>ffn_down_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M1588.91,-5982.87C1607.48,-5973.13 1628.82,-5961.95 1648.14,-5951.82"/>
<polygon fill="black" stroke="black" points="1649.92,-5954.84 1657.16,-5947.1 1646.67,-5948.64 1649.92,-5954.84"/>
</g>
<!-- residual1_8 -->
<g id="node93" class="node">
<title>residual1_8</title>
<polygon fill="#f0f8ff" stroke="black" points="1969.5,-5747 1782.5,-5747 1782.5,-5694 1969.5,-5694 1969.5,-5747"/>
<text text-anchor="middle" x="1876" y="-5731.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1876" y="-5716.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1876" y="-5701.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- comm_7_8&#45;&gt;residual1_8 -->
<g id="edge100" class="edge">
<title>comm_7_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1763.08,-5786.59C1782.4,-5775.46 1803.88,-5763.07 1822.88,-5752.12"/>
<polygon fill="black" stroke="black" points="1824.79,-5755.06 1831.7,-5747.04 1821.29,-5749 1824.79,-5755.06"/>
</g>
<!-- ln2_8 -->
<g id="node100" class="node">
<title>ln2_8</title>
<polygon fill="#ffe4e1" stroke="black" points="1909.5,-5658 1722.5,-5658 1722.5,-5605 1909.5,-5605 1909.5,-5658"/>
<text text-anchor="middle" x="1816" y="-5642.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1816" y="-5627.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1816" y="-5612.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge107" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M1858.32,-5693.87C1852.45,-5685.36 1845.83,-5675.75 1839.59,-5666.7"/>
<polygon fill="black" stroke="black" points="1842.32,-5664.49 1833.76,-5658.25 1836.55,-5668.47 1842.32,-5664.49"/>
</g>
<!-- residual2_8 -->
<g id="node101" class="node">
<title>residual2_8</title>
<polygon fill="#f0f8ff" stroke="black" points="2023.5,-5302 1836.5,-5302 1836.5,-5249 2023.5,-5249 2023.5,-5302"/>
<text text-anchor="middle" x="1930" y="-5286.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1930" y="-5271.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1930" y="-5256.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- residual1_8&#45;&gt;residual2_8 -->
<g id="edge108" class="edge">
<title>residual1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1905.72,-5693.82C1938.9,-5662.14 1988,-5604.89 1988,-5543.5 1988,-5543.5 1988,-5543.5 1988,-5452.5 1988,-5400.92 1987.4,-5386.19 1969,-5338 1965.45,-5328.71 1960.4,-5319.32 1955.11,-5310.77"/>
<polygon fill="black" stroke="black" points="1957.93,-5308.69 1949.55,-5302.2 1952.06,-5312.5 1957.93,-5308.69"/>
</g>
<!-- ln1_8 -->
<g id="node94" class="node">
<title>ln1_8</title>
<polygon fill="#ffe4e1" stroke="black" points="2139.5,-6303 1952.5,-6303 1952.5,-6250 2139.5,-6250 2139.5,-6303"/>
<text text-anchor="middle" x="2046" y="-6287.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2046" y="-6272.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2046" y="-6257.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_qkv_8 -->
<g id="node95" class="node">
<title>attn_qkv_8</title>
<polygon fill="#ffe6e6" stroke="black" points="2242,-6214 1850,-6214 1850,-6161 2242,-6161 2242,-6214"/>
<text text-anchor="middle" x="2046" y="-6198.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2046" y="-6183.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="2046" y="-6168.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- ln1_8&#45;&gt;attn_qkv_8 -->
<g id="edge101" class="edge">
<title>ln1_8&#45;&gt;attn_qkv_8</title>
<path fill="none" stroke="black" d="M2046,-6249.87C2046,-6241.89 2046,-6232.93 2046,-6224.38"/>
<polygon fill="black" stroke="black" points="2049.5,-6224.25 2046,-6214.25 2042.5,-6224.25 2049.5,-6224.25"/>
</g>
<!-- attn_score_8 -->
<g id="node96" class="node">
<title>attn_score_8</title>
<polygon fill="#ffe6e6" stroke="black" points="2128,-6125 1964,-6125 1964,-6072 2128,-6072 2128,-6125"/>
<text text-anchor="middle" x="2046" y="-6109.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2046" y="-6094.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2046" y="-6079.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_qkv_8&#45;&gt;attn_score_8 -->
<g id="edge102" class="edge">
<title>attn_qkv_8&#45;&gt;attn_score_8</title>
<path fill="none" stroke="black" d="M2046,-6160.87C2046,-6152.89 2046,-6143.93 2046,-6135.38"/>
<polygon fill="black" stroke="black" points="2049.5,-6135.25 2046,-6125.25 2042.5,-6135.25 2049.5,-6135.25"/>
</g>
<!-- attn_weight_8 -->
<g id="node97" class="node">
<title>attn_weight_8</title>
<polygon fill="#ffe6e6" stroke="black" points="2128,-6036 1964,-6036 1964,-5983 2128,-5983 2128,-6036"/>
<text text-anchor="middle" x="2046" y="-6020.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="2046" y="-6005.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2046" y="-5990.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_score_8&#45;&gt;attn_weight_8 -->
<g id="edge103" class="edge">
<title>attn_score_8&#45;&gt;attn_weight_8</title>
<path fill="none" stroke="black" d="M2046,-6071.87C2046,-6063.89 2046,-6054.93 2046,-6046.38"/>
<polygon fill="black" stroke="black" points="2049.5,-6046.25 2046,-6036.25 2042.5,-6046.25 2049.5,-6046.25"/>
</g>
<!-- attn_context_8 -->
<g id="node98" class="node">
<title>attn_context_8</title>
<polygon fill="#ffe6e6" stroke="black" points="2139.5,-5947 1952.5,-5947 1952.5,-5894 2139.5,-5894 2139.5,-5947"/>
<text text-anchor="middle" x="2046" y="-5931.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="2046" y="-5916.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2046" y="-5901.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_weight_8&#45;&gt;attn_context_8 -->
<g id="edge104" class="edge">
<title>attn_weight_8&#45;&gt;attn_context_8</title>
<path fill="none" stroke="black" d="M2046,-5982.87C2046,-5974.89 2046,-5965.93 2046,-5957.38"/>
<polygon fill="black" stroke="black" points="2049.5,-5957.25 2046,-5947.25 2042.5,-5957.25 2049.5,-5957.25"/>
</g>
<!-- attn_out_8 -->
<g id="node99" class="node">
<title>attn_out_8</title>
<polygon fill="#ffe6e6" stroke="black" points="2235.5,-5847 1856.5,-5847 1856.5,-5794 2235.5,-5794 2235.5,-5847"/>
<text text-anchor="middle" x="2046" y="-5831.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2046" y="-5816.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2046" y="-5801.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- attn_context_8&#45;&gt;attn_out_8 -->
<g id="edge105" class="edge">
<title>attn_context_8&#45;&gt;attn_out_8</title>
<path fill="none" stroke="black" d="M2046,-5893.75C2046,-5882.61 2046,-5869.38 2046,-5857.31"/>
<polygon fill="black" stroke="black" points="2049.5,-5857.08 2046,-5847.08 2042.5,-5857.08 2049.5,-5857.08"/>
</g>
<!-- attn_out_8&#45;&gt;residual1_8 -->
<g id="edge106" class="edge">
<title>attn_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M2001.33,-5793.75C1979.18,-5780.98 1952.26,-5765.46 1929.06,-5752.09"/>
<polygon fill="black" stroke="black" points="1930.78,-5749.04 1920.37,-5747.08 1927.28,-5755.1 1930.78,-5749.04"/>
</g>
<!-- ffn_up_8 -->
<g id="node102" class="node">
<title>ffn_up_8</title>
<polygon fill="#e6ffe6" stroke="black" points="1960,-5569 1568,-5569 1568,-5516 1960,-5516 1960,-5569"/>
<text text-anchor="middle" x="1764" y="-5553.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1764" y="-5538.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1764" y="-5523.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- ln2_8&#45;&gt;ffn_up_8 -->
<g id="edge109" class="edge">
<title>ln2_8&#45;&gt;ffn_up_8</title>
<path fill="none" stroke="black" d="M1800.68,-5604.87C1795.65,-5596.45 1789.97,-5586.95 1784.61,-5577.98"/>
<polygon fill="black" stroke="black" points="1787.53,-5576.04 1779.39,-5569.25 1781.52,-5579.63 1787.53,-5576.04"/>
</g>
<!-- comm_8_9 -->
<g id="node105" class="node">
<title>comm_8_9</title>
<ellipse fill="#f0e6ff" stroke="black" cx="1930" cy="-5175.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="1930" y="-5186.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="1930" y="-5171.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1930" y="-5156.8" font-family="Arial" font-size="14.00">GPU: 7 → GPU: 8</text>
</g>
<!-- residual2_8&#45;&gt;comm_8_9 -->
<g id="edge113" class="edge">
<title>residual2_8&#45;&gt;comm_8_9</title>
<path fill="none" stroke="black" d="M1930,-5248.75C1930,-5240.93 1930,-5232.07 1930,-5223.31"/>
<polygon fill="black" stroke="black" points="1933.5,-5223.13 1930,-5213.13 1926.5,-5223.13 1933.5,-5223.13"/>
</g>
<!-- ffn_act_8 -->
<g id="node103" class="node">
<title>ffn_act_8</title>
<polygon fill="#e6ffe6" stroke="black" points="1864,-5480 1664,-5480 1664,-5427 1864,-5427 1864,-5480"/>
<text text-anchor="middle" x="1764" y="-5464.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1764" y="-5449.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1764" y="-5434.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_up_8&#45;&gt;ffn_act_8 -->
<g id="edge110" class="edge">
<title>ffn_up_8&#45;&gt;ffn_act_8</title>
<path fill="none" stroke="black" d="M1764,-5515.87C1764,-5507.89 1764,-5498.93 1764,-5490.38"/>
<polygon fill="black" stroke="black" points="1767.5,-5490.25 1764,-5480.25 1760.5,-5490.25 1767.5,-5490.25"/>
</g>
<!-- ffn_down_8 -->
<g id="node104" class="node">
<title>ffn_down_8</title>
<polygon fill="#e6ffe6" stroke="black" points="1960,-5391 1568,-5391 1568,-5338 1960,-5338 1960,-5391"/>
<text text-anchor="middle" x="1764" y="-5375.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1764" y="-5360.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1764" y="-5345.8" font-family="Arial" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn_act_8&#45;&gt;ffn_down_8 -->
<g id="edge111" class="edge">
<title>ffn_act_8&#45;&gt;ffn_down_8</title>
<path fill="none" stroke="black" d="M1764,-5426.87C1764,-5418.89 1764,-5409.93 1764,-5401.38"/>
<polygon fill="black" stroke="black" points="1767.5,-5401.25 1764,-5391.25 1760.5,-5401.25 1767.5,-5401.25"/>
</g>
<!-- ffn_down_8&#45;&gt;residual2_8 -->
<g id="edge112" class="edge">
<title>ffn_down_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1812.91,-5337.87C1831.48,-5328.13 1852.82,-5316.95 1872.14,-5306.82"/>
<polygon fill="black" stroke="black" points="1873.92,-5309.84 1881.16,-5302.1 1870.67,-5303.64 1873.92,-5309.84"/>
</g>
<!-- residual1_9 -->
<g id="node106" class="node">
<title>residual1_9</title>
<polygon fill="#f0f8ff" stroke="black" points="2193.5,-5102 2006.5,-5102 2006.5,-5049 2193.5,-5049 2193.5,-5102"/>
<text text-anchor="middle" x="2100" y="-5086.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2100" y="-5071.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2100" y="-5056.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- comm_8_9&#45;&gt;residual1_9 -->
<g id="edge114" class="edge">
<title>comm_8_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1987.08,-5141.59C2006.4,-5130.46 2027.88,-5118.07 2046.88,-5107.12"/>
<polygon fill="black" stroke="black" points="2048.79,-5110.06 2055.7,-5102.04 2045.29,-5104 2048.79,-5110.06"/>
</g>
<!-- ln2_9 -->
<g id="node113" class="node">
<title>ln2_9</title>
<polygon fill="#ffe4e1" stroke="black" points="2133.5,-5013 1946.5,-5013 1946.5,-4960 2133.5,-4960 2133.5,-5013"/>
<text text-anchor="middle" x="2040" y="-4997.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2040" y="-4982.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2040" y="-4967.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge121" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M2082.32,-5048.87C2076.45,-5040.36 2069.83,-5030.75 2063.59,-5021.7"/>
<polygon fill="black" stroke="black" points="2066.32,-5019.49 2057.76,-5013.25 2060.55,-5023.47 2066.32,-5019.49"/>
</g>
<!-- residual2_9 -->
<g id="node114" class="node">
<title>residual2_9</title>
<polygon fill="#f0f8ff" stroke="black" points="2247.5,-4657 2060.5,-4657 2060.5,-4604 2247.5,-4604 2247.5,-4657"/>
<text text-anchor="middle" x="2154" y="-4641.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2154" y="-4626.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2154" y="-4611.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- residual1_9&#45;&gt;residual2_9 -->
<g id="edge122" class="edge">
<title>residual1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M2129.72,-5048.82C2162.9,-5017.14 2212,-4959.89 2212,-4898.5 2212,-4898.5 2212,-4898.5 2212,-4807.5 2212,-4755.92 2211.4,-4741.19 2193,-4693 2189.45,-4683.71 2184.4,-4674.32 2179.11,-4665.77"/>
<polygon fill="black" stroke="black" points="2181.93,-4663.69 2173.55,-4657.2 2176.06,-4667.5 2181.93,-4663.69"/>
</g>
<!-- ln1_9 -->
<g id="node107" class="node">
<title>ln1_9</title>
<polygon fill="#ffe4e1" stroke="black" points="2363.5,-5658 2176.5,-5658 2176.5,-5605 2363.5,-5605 2363.5,-5658"/>
<text text-anchor="middle" x="2270" y="-5642.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2270" y="-5627.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2270" y="-5612.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_qkv_9 -->
<g id="node108" class="node">
<title>attn_qkv_9</title>
<polygon fill="#ffe6e6" stroke="black" points="2466,-5569 2074,-5569 2074,-5516 2466,-5516 2466,-5569"/>
<text text-anchor="middle" x="2270" y="-5553.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2270" y="-5538.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="2270" y="-5523.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- ln1_9&#45;&gt;attn_qkv_9 -->
<g id="edge115" class="edge">
<title>ln1_9&#45;&gt;attn_qkv_9</title>
<path fill="none" stroke="black" d="M2270,-5604.87C2270,-5596.89 2270,-5587.93 2270,-5579.38"/>
<polygon fill="black" stroke="black" points="2273.5,-5579.25 2270,-5569.25 2266.5,-5579.25 2273.5,-5579.25"/>
</g>
<!-- attn_score_9 -->
<g id="node109" class="node">
<title>attn_score_9</title>
<polygon fill="#ffe6e6" stroke="black" points="2352,-5480 2188,-5480 2188,-5427 2352,-5427 2352,-5480"/>
<text text-anchor="middle" x="2270" y="-5464.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2270" y="-5449.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2270" y="-5434.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_qkv_9&#45;&gt;attn_score_9 -->
<g id="edge116" class="edge">
<title>attn_qkv_9&#45;&gt;attn_score_9</title>
<path fill="none" stroke="black" d="M2270,-5515.87C2270,-5507.89 2270,-5498.93 2270,-5490.38"/>
<polygon fill="black" stroke="black" points="2273.5,-5490.25 2270,-5480.25 2266.5,-5490.25 2273.5,-5490.25"/>
</g>
<!-- attn_weight_9 -->
<g id="node110" class="node">
<title>attn_weight_9</title>
<polygon fill="#ffe6e6" stroke="black" points="2352,-5391 2188,-5391 2188,-5338 2352,-5338 2352,-5391"/>
<text text-anchor="middle" x="2270" y="-5375.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="2270" y="-5360.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2270" y="-5345.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_score_9&#45;&gt;attn_weight_9 -->
<g id="edge117" class="edge">
<title>attn_score_9&#45;&gt;attn_weight_9</title>
<path fill="none" stroke="black" d="M2270,-5426.87C2270,-5418.89 2270,-5409.93 2270,-5401.38"/>
<polygon fill="black" stroke="black" points="2273.5,-5401.25 2270,-5391.25 2266.5,-5401.25 2273.5,-5401.25"/>
</g>
<!-- attn_context_9 -->
<g id="node111" class="node">
<title>attn_context_9</title>
<polygon fill="#ffe6e6" stroke="black" points="2363.5,-5302 2176.5,-5302 2176.5,-5249 2363.5,-5249 2363.5,-5302"/>
<text text-anchor="middle" x="2270" y="-5286.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="2270" y="-5271.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2270" y="-5256.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_weight_9&#45;&gt;attn_context_9 -->
<g id="edge118" class="edge">
<title>attn_weight_9&#45;&gt;attn_context_9</title>
<path fill="none" stroke="black" d="M2270,-5337.87C2270,-5329.89 2270,-5320.93 2270,-5312.38"/>
<polygon fill="black" stroke="black" points="2273.5,-5312.25 2270,-5302.25 2266.5,-5312.25 2273.5,-5312.25"/>
</g>
<!-- attn_out_9 -->
<g id="node112" class="node">
<title>attn_out_9</title>
<polygon fill="#ffe6e6" stroke="black" points="2459.5,-5202 2080.5,-5202 2080.5,-5149 2459.5,-5149 2459.5,-5202"/>
<text text-anchor="middle" x="2270" y="-5186.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2270" y="-5171.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2270" y="-5156.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- attn_context_9&#45;&gt;attn_out_9 -->
<g id="edge119" class="edge">
<title>attn_context_9&#45;&gt;attn_out_9</title>
<path fill="none" stroke="black" d="M2270,-5248.75C2270,-5237.61 2270,-5224.38 2270,-5212.31"/>
<polygon fill="black" stroke="black" points="2273.5,-5212.08 2270,-5202.08 2266.5,-5212.08 2273.5,-5212.08"/>
</g>
<!-- attn_out_9&#45;&gt;residual1_9 -->
<g id="edge120" class="edge">
<title>attn_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M2225.33,-5148.75C2203.18,-5135.98 2176.26,-5120.46 2153.06,-5107.09"/>
<polygon fill="black" stroke="black" points="2154.78,-5104.04 2144.37,-5102.08 2151.28,-5110.1 2154.78,-5104.04"/>
</g>
<!-- ffn_up_9 -->
<g id="node115" class="node">
<title>ffn_up_9</title>
<polygon fill="#e6ffe6" stroke="black" points="2184,-4924 1792,-4924 1792,-4871 2184,-4871 2184,-4924"/>
<text text-anchor="middle" x="1988" y="-4908.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="1988" y="-4893.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1988" y="-4878.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- ln2_9&#45;&gt;ffn_up_9 -->
<g id="edge123" class="edge">
<title>ln2_9&#45;&gt;ffn_up_9</title>
<path fill="none" stroke="black" d="M2024.68,-4959.87C2019.65,-4951.45 2013.97,-4941.95 2008.61,-4932.98"/>
<polygon fill="black" stroke="black" points="2011.53,-4931.04 2003.39,-4924.25 2005.52,-4934.63 2011.53,-4931.04"/>
</g>
<!-- comm_9_10 -->
<g id="node118" class="node">
<title>comm_9_10</title>
<ellipse fill="#f0e6ff" stroke="black" cx="2154" cy="-4530.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="2154" y="-4541.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="2154" y="-4526.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2154" y="-4511.8" font-family="Arial" font-size="14.00">GPU: 8 → GPU: 9</text>
</g>
<!-- residual2_9&#45;&gt;comm_9_10 -->
<g id="edge127" class="edge">
<title>residual2_9&#45;&gt;comm_9_10</title>
<path fill="none" stroke="black" d="M2154,-4603.75C2154,-4595.93 2154,-4587.07 2154,-4578.31"/>
<polygon fill="black" stroke="black" points="2157.5,-4578.13 2154,-4568.13 2150.5,-4578.13 2157.5,-4578.13"/>
</g>
<!-- ffn_act_9 -->
<g id="node116" class="node">
<title>ffn_act_9</title>
<polygon fill="#e6ffe6" stroke="black" points="2088,-4835 1888,-4835 1888,-4782 2088,-4782 2088,-4835"/>
<text text-anchor="middle" x="1988" y="-4819.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1988" y="-4804.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="1988" y="-4789.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn_up_9&#45;&gt;ffn_act_9 -->
<g id="edge124" class="edge">
<title>ffn_up_9&#45;&gt;ffn_act_9</title>
<path fill="none" stroke="black" d="M1988,-4870.87C1988,-4862.89 1988,-4853.93 1988,-4845.38"/>
<polygon fill="black" stroke="black" points="1991.5,-4845.25 1988,-4835.25 1984.5,-4845.25 1991.5,-4845.25"/>
</g>
<!-- ffn_down_9 -->
<g id="node117" class="node">
<title>ffn_down_9</title>
<polygon fill="#e6ffe6" stroke="black" points="2184,-4746 1792,-4746 1792,-4693 2184,-4693 2184,-4746"/>
<text text-anchor="middle" x="1988" y="-4730.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="1988" y="-4715.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="1988" y="-4700.8" font-family="Arial" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn_act_9&#45;&gt;ffn_down_9 -->
<g id="edge125" class="edge">
<title>ffn_act_9&#45;&gt;ffn_down_9</title>
<path fill="none" stroke="black" d="M1988,-4781.87C1988,-4773.89 1988,-4764.93 1988,-4756.38"/>
<polygon fill="black" stroke="black" points="1991.5,-4756.25 1988,-4746.25 1984.5,-4756.25 1991.5,-4756.25"/>
</g>
<!-- ffn_down_9&#45;&gt;residual2_9 -->
<g id="edge126" class="edge">
<title>ffn_down_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M2036.91,-4692.87C2055.48,-4683.13 2076.82,-4671.95 2096.14,-4661.82"/>
<polygon fill="black" stroke="black" points="2097.92,-4664.84 2105.16,-4657.1 2094.67,-4658.64 2097.92,-4664.84"/>
</g>
<!-- residual1_10 -->
<g id="node119" class="node">
<title>residual1_10</title>
<polygon fill="#f0f8ff" stroke="black" points="2417.5,-4457 2230.5,-4457 2230.5,-4404 2417.5,-4404 2417.5,-4457"/>
<text text-anchor="middle" x="2324" y="-4441.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2324" y="-4426.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2324" y="-4411.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- comm_9_10&#45;&gt;residual1_10 -->
<g id="edge128" class="edge">
<title>comm_9_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M2211.08,-4496.59C2230.4,-4485.46 2251.88,-4473.07 2270.88,-4462.12"/>
<polygon fill="black" stroke="black" points="2272.79,-4465.06 2279.7,-4457.04 2269.29,-4459 2272.79,-4465.06"/>
</g>
<!-- ln2_10 -->
<g id="node126" class="node">
<title>ln2_10</title>
<polygon fill="#ffe4e1" stroke="black" points="2305.5,-4368 2118.5,-4368 2118.5,-4315 2305.5,-4315 2305.5,-4368"/>
<text text-anchor="middle" x="2212" y="-4352.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2212" y="-4337.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2212" y="-4322.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge135" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M2291,-4403.87C2279.15,-4394.66 2265.62,-4384.15 2253.16,-4374.47"/>
<polygon fill="black" stroke="black" points="2255.19,-4371.62 2245.15,-4368.25 2250.9,-4377.15 2255.19,-4371.62"/>
</g>
<!-- residual2_10 -->
<g id="node127" class="node">
<title>residual2_10</title>
<polygon fill="#f0f8ff" stroke="black" points="2420.5,-4012 2233.5,-4012 2233.5,-3959 2420.5,-3959 2420.5,-4012"/>
<text text-anchor="middle" x="2327" y="-3996.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2327" y="-3981.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2327" y="-3966.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- residual1_10&#45;&gt;residual2_10 -->
<g id="edge136" class="edge">
<title>residual1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M2338.92,-4403.93C2356.98,-4370.5 2385,-4309.61 2385,-4253.5 2385,-4253.5 2385,-4253.5 2385,-4162.5 2385,-4110.92 2384.4,-4096.19 2366,-4048 2362.45,-4038.71 2357.4,-4029.32 2352.11,-4020.77"/>
<polygon fill="black" stroke="black" points="2354.93,-4018.69 2346.55,-4012.2 2349.06,-4022.5 2354.93,-4018.69"/>
</g>
<!-- ln1_10 -->
<g id="node120" class="node">
<title>ln1_10</title>
<polygon fill="#ffe4e1" stroke="black" points="2587.5,-5013 2400.5,-5013 2400.5,-4960 2587.5,-4960 2587.5,-5013"/>
<text text-anchor="middle" x="2494" y="-4997.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2494" y="-4982.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2494" y="-4967.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_qkv_10 -->
<g id="node121" class="node">
<title>attn_qkv_10</title>
<polygon fill="#ffe6e6" stroke="black" points="2690,-4924 2298,-4924 2298,-4871 2690,-4871 2690,-4924"/>
<text text-anchor="middle" x="2494" y="-4908.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2494" y="-4893.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="2494" y="-4878.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- ln1_10&#45;&gt;attn_qkv_10 -->
<g id="edge129" class="edge">
<title>ln1_10&#45;&gt;attn_qkv_10</title>
<path fill="none" stroke="black" d="M2494,-4959.87C2494,-4951.89 2494,-4942.93 2494,-4934.38"/>
<polygon fill="black" stroke="black" points="2497.5,-4934.25 2494,-4924.25 2490.5,-4934.25 2497.5,-4934.25"/>
</g>
<!-- attn_score_10 -->
<g id="node122" class="node">
<title>attn_score_10</title>
<polygon fill="#ffe6e6" stroke="black" points="2576,-4835 2412,-4835 2412,-4782 2576,-4782 2576,-4835"/>
<text text-anchor="middle" x="2494" y="-4819.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2494" y="-4804.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2494" y="-4789.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_qkv_10&#45;&gt;attn_score_10 -->
<g id="edge130" class="edge">
<title>attn_qkv_10&#45;&gt;attn_score_10</title>
<path fill="none" stroke="black" d="M2494,-4870.87C2494,-4862.89 2494,-4853.93 2494,-4845.38"/>
<polygon fill="black" stroke="black" points="2497.5,-4845.25 2494,-4835.25 2490.5,-4845.25 2497.5,-4845.25"/>
</g>
<!-- attn_weight_10 -->
<g id="node123" class="node">
<title>attn_weight_10</title>
<polygon fill="#ffe6e6" stroke="black" points="2576,-4746 2412,-4746 2412,-4693 2576,-4693 2576,-4746"/>
<text text-anchor="middle" x="2494" y="-4730.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="2494" y="-4715.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2494" y="-4700.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_score_10&#45;&gt;attn_weight_10 -->
<g id="edge131" class="edge">
<title>attn_score_10&#45;&gt;attn_weight_10</title>
<path fill="none" stroke="black" d="M2494,-4781.87C2494,-4773.89 2494,-4764.93 2494,-4756.38"/>
<polygon fill="black" stroke="black" points="2497.5,-4756.25 2494,-4746.25 2490.5,-4756.25 2497.5,-4756.25"/>
</g>
<!-- attn_context_10 -->
<g id="node124" class="node">
<title>attn_context_10</title>
<polygon fill="#ffe6e6" stroke="black" points="2587.5,-4657 2400.5,-4657 2400.5,-4604 2587.5,-4604 2587.5,-4657"/>
<text text-anchor="middle" x="2494" y="-4641.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="2494" y="-4626.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2494" y="-4611.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_weight_10&#45;&gt;attn_context_10 -->
<g id="edge132" class="edge">
<title>attn_weight_10&#45;&gt;attn_context_10</title>
<path fill="none" stroke="black" d="M2494,-4692.87C2494,-4684.89 2494,-4675.93 2494,-4667.38"/>
<polygon fill="black" stroke="black" points="2497.5,-4667.25 2494,-4657.25 2490.5,-4667.25 2497.5,-4667.25"/>
</g>
<!-- attn_out_10 -->
<g id="node125" class="node">
<title>attn_out_10</title>
<polygon fill="#ffe6e6" stroke="black" points="2683.5,-4557 2304.5,-4557 2304.5,-4504 2683.5,-4504 2683.5,-4557"/>
<text text-anchor="middle" x="2494" y="-4541.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2494" y="-4526.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2494" y="-4511.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- attn_context_10&#45;&gt;attn_out_10 -->
<g id="edge133" class="edge">
<title>attn_context_10&#45;&gt;attn_out_10</title>
<path fill="none" stroke="black" d="M2494,-4603.75C2494,-4592.61 2494,-4579.38 2494,-4567.31"/>
<polygon fill="black" stroke="black" points="2497.5,-4567.08 2494,-4557.08 2490.5,-4567.08 2497.5,-4567.08"/>
</g>
<!-- attn_out_10&#45;&gt;residual1_10 -->
<g id="edge134" class="edge">
<title>attn_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M2449.33,-4503.75C2427.18,-4490.98 2400.26,-4475.46 2377.06,-4462.09"/>
<polygon fill="black" stroke="black" points="2378.78,-4459.04 2368.37,-4457.08 2375.28,-4465.1 2378.78,-4459.04"/>
</g>
<!-- ffn_up_10 -->
<g id="node128" class="node">
<title>ffn_up_10</title>
<polygon fill="#e6ffe6" stroke="black" points="2357,-4279 1965,-4279 1965,-4226 2357,-4226 2357,-4279"/>
<text text-anchor="middle" x="2161" y="-4263.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2161" y="-4248.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="2161" y="-4233.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- ln2_10&#45;&gt;ffn_up_10 -->
<g id="edge137" class="edge">
<title>ln2_10&#45;&gt;ffn_up_10</title>
<path fill="none" stroke="black" d="M2196.97,-4314.87C2192.04,-4306.45 2186.47,-4296.95 2181.21,-4287.98"/>
<polygon fill="black" stroke="black" points="2184.17,-4286.11 2176.09,-4279.25 2178.13,-4289.65 2184.17,-4286.11"/>
</g>
<!-- comm_10_11 -->
<g id="node131" class="node">
<title>comm_10_11</title>
<ellipse fill="#f0e6ff" stroke="black" cx="2327" cy="-3885.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="2327" y="-3896.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="2327" y="-3881.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2327" y="-3866.8" font-family="Arial" font-size="14.00">GPU: 9 → GPU: 10</text>
</g>
<!-- residual2_10&#45;&gt;comm_10_11 -->
<g id="edge141" class="edge">
<title>residual2_10&#45;&gt;comm_10_11</title>
<path fill="none" stroke="black" d="M2327,-3958.75C2327,-3950.93 2327,-3942.07 2327,-3933.31"/>
<polygon fill="black" stroke="black" points="2330.5,-3933.13 2327,-3923.13 2323.5,-3933.13 2330.5,-3933.13"/>
</g>
<!-- ffn_act_10 -->
<g id="node129" class="node">
<title>ffn_act_10</title>
<polygon fill="#e6ffe6" stroke="black" points="2261,-4190 2061,-4190 2061,-4137 2261,-4137 2261,-4190"/>
<text text-anchor="middle" x="2161" y="-4174.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="2161" y="-4159.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="2161" y="-4144.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn_up_10&#45;&gt;ffn_act_10 -->
<g id="edge138" class="edge">
<title>ffn_up_10&#45;&gt;ffn_act_10</title>
<path fill="none" stroke="black" d="M2161,-4225.87C2161,-4217.89 2161,-4208.93 2161,-4200.38"/>
<polygon fill="black" stroke="black" points="2164.5,-4200.25 2161,-4190.25 2157.5,-4200.25 2164.5,-4200.25"/>
</g>
<!-- ffn_down_10 -->
<g id="node130" class="node">
<title>ffn_down_10</title>
<polygon fill="#e6ffe6" stroke="black" points="2357,-4101 1965,-4101 1965,-4048 2357,-4048 2357,-4101"/>
<text text-anchor="middle" x="2161" y="-4085.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2161" y="-4070.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2161" y="-4055.8" font-family="Arial" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn_act_10&#45;&gt;ffn_down_10 -->
<g id="edge139" class="edge">
<title>ffn_act_10&#45;&gt;ffn_down_10</title>
<path fill="none" stroke="black" d="M2161,-4136.87C2161,-4128.89 2161,-4119.93 2161,-4111.38"/>
<polygon fill="black" stroke="black" points="2164.5,-4111.25 2161,-4101.25 2157.5,-4111.25 2164.5,-4111.25"/>
</g>
<!-- ffn_down_10&#45;&gt;residual2_10 -->
<g id="edge140" class="edge">
<title>ffn_down_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M2209.91,-4047.87C2228.48,-4038.13 2249.82,-4026.95 2269.14,-4016.82"/>
<polygon fill="black" stroke="black" points="2270.92,-4019.84 2278.16,-4012.1 2267.67,-4013.64 2270.92,-4019.84"/>
</g>
<!-- residual1_11 -->
<g id="node132" class="node">
<title>residual1_11</title>
<polygon fill="#f0f8ff" stroke="black" points="2590.5,-3812 2403.5,-3812 2403.5,-3759 2590.5,-3759 2590.5,-3812"/>
<text text-anchor="middle" x="2497" y="-3796.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2497" y="-3781.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2497" y="-3766.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- comm_10_11&#45;&gt;residual1_11 -->
<g id="edge142" class="edge">
<title>comm_10_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M2384.08,-3851.59C2403.4,-3840.46 2424.88,-3828.07 2443.88,-3817.12"/>
<polygon fill="black" stroke="black" points="2445.79,-3820.06 2452.7,-3812.04 2442.29,-3814 2445.79,-3820.06"/>
</g>
<!-- ln2_11 -->
<g id="node139" class="node">
<title>ln2_11</title>
<polygon fill="#ffe4e1" stroke="black" points="2478.5,-3723 2291.5,-3723 2291.5,-3670 2478.5,-3670 2478.5,-3723"/>
<text text-anchor="middle" x="2385" y="-3707.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2385" y="-3692.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2385" y="-3677.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge149" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M2464,-3758.87C2452.15,-3749.66 2438.62,-3739.15 2426.16,-3729.47"/>
<polygon fill="black" stroke="black" points="2428.19,-3726.62 2418.15,-3723.25 2423.9,-3732.15 2428.19,-3726.62"/>
</g>
<!-- residual2_11 -->
<g id="node140" class="node">
<title>residual2_11</title>
<polygon fill="#f0f8ff" stroke="black" points="2593.5,-3367 2406.5,-3367 2406.5,-3314 2593.5,-3314 2593.5,-3367"/>
<text text-anchor="middle" x="2500" y="-3351.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2500" y="-3336.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2500" y="-3321.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- residual1_11&#45;&gt;residual2_11 -->
<g id="edge150" class="edge">
<title>residual1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M2511.92,-3758.93C2529.98,-3725.5 2558,-3664.61 2558,-3608.5 2558,-3608.5 2558,-3608.5 2558,-3517.5 2558,-3465.92 2557.4,-3451.19 2539,-3403 2535.45,-3393.71 2530.4,-3384.32 2525.11,-3375.77"/>
<polygon fill="black" stroke="black" points="2527.93,-3373.69 2519.55,-3367.2 2522.06,-3377.5 2527.93,-3373.69"/>
</g>
<!-- ln1_11 -->
<g id="node133" class="node">
<title>ln1_11</title>
<polygon fill="#ffe4e1" stroke="black" points="2760.5,-4368 2573.5,-4368 2573.5,-4315 2760.5,-4315 2760.5,-4368"/>
<text text-anchor="middle" x="2667" y="-4352.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2667" y="-4337.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2667" y="-4322.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_qkv_11 -->
<g id="node134" class="node">
<title>attn_qkv_11</title>
<polygon fill="#ffe6e6" stroke="black" points="2863,-4279 2471,-4279 2471,-4226 2863,-4226 2863,-4279"/>
<text text-anchor="middle" x="2667" y="-4263.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2667" y="-4248.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="2667" y="-4233.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- ln1_11&#45;&gt;attn_qkv_11 -->
<g id="edge143" class="edge">
<title>ln1_11&#45;&gt;attn_qkv_11</title>
<path fill="none" stroke="black" d="M2667,-4314.87C2667,-4306.89 2667,-4297.93 2667,-4289.38"/>
<polygon fill="black" stroke="black" points="2670.5,-4289.25 2667,-4279.25 2663.5,-4289.25 2670.5,-4289.25"/>
</g>
<!-- attn_score_11 -->
<g id="node135" class="node">
<title>attn_score_11</title>
<polygon fill="#ffe6e6" stroke="black" points="2749,-4190 2585,-4190 2585,-4137 2749,-4137 2749,-4190"/>
<text text-anchor="middle" x="2667" y="-4174.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2667" y="-4159.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2667" y="-4144.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_qkv_11&#45;&gt;attn_score_11 -->
<g id="edge144" class="edge">
<title>attn_qkv_11&#45;&gt;attn_score_11</title>
<path fill="none" stroke="black" d="M2667,-4225.87C2667,-4217.89 2667,-4208.93 2667,-4200.38"/>
<polygon fill="black" stroke="black" points="2670.5,-4200.25 2667,-4190.25 2663.5,-4200.25 2670.5,-4200.25"/>
</g>
<!-- attn_weight_11 -->
<g id="node136" class="node">
<title>attn_weight_11</title>
<polygon fill="#ffe6e6" stroke="black" points="2749,-4101 2585,-4101 2585,-4048 2749,-4048 2749,-4101"/>
<text text-anchor="middle" x="2667" y="-4085.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="2667" y="-4070.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2667" y="-4055.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_score_11&#45;&gt;attn_weight_11 -->
<g id="edge145" class="edge">
<title>attn_score_11&#45;&gt;attn_weight_11</title>
<path fill="none" stroke="black" d="M2667,-4136.87C2667,-4128.89 2667,-4119.93 2667,-4111.38"/>
<polygon fill="black" stroke="black" points="2670.5,-4111.25 2667,-4101.25 2663.5,-4111.25 2670.5,-4111.25"/>
</g>
<!-- attn_context_11 -->
<g id="node137" class="node">
<title>attn_context_11</title>
<polygon fill="#ffe6e6" stroke="black" points="2760.5,-4012 2573.5,-4012 2573.5,-3959 2760.5,-3959 2760.5,-4012"/>
<text text-anchor="middle" x="2667" y="-3996.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="2667" y="-3981.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2667" y="-3966.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_weight_11&#45;&gt;attn_context_11 -->
<g id="edge146" class="edge">
<title>attn_weight_11&#45;&gt;attn_context_11</title>
<path fill="none" stroke="black" d="M2667,-4047.87C2667,-4039.89 2667,-4030.93 2667,-4022.38"/>
<polygon fill="black" stroke="black" points="2670.5,-4022.25 2667,-4012.25 2663.5,-4022.25 2670.5,-4022.25"/>
</g>
<!-- attn_out_11 -->
<g id="node138" class="node">
<title>attn_out_11</title>
<polygon fill="#ffe6e6" stroke="black" points="2856.5,-3912 2477.5,-3912 2477.5,-3859 2856.5,-3859 2856.5,-3912"/>
<text text-anchor="middle" x="2667" y="-3896.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2667" y="-3881.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2667" y="-3866.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- attn_context_11&#45;&gt;attn_out_11 -->
<g id="edge147" class="edge">
<title>attn_context_11&#45;&gt;attn_out_11</title>
<path fill="none" stroke="black" d="M2667,-3958.75C2667,-3947.61 2667,-3934.38 2667,-3922.31"/>
<polygon fill="black" stroke="black" points="2670.5,-3922.08 2667,-3912.08 2663.5,-3922.08 2670.5,-3922.08"/>
</g>
<!-- attn_out_11&#45;&gt;residual1_11 -->
<g id="edge148" class="edge">
<title>attn_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M2622.33,-3858.75C2600.18,-3845.98 2573.26,-3830.46 2550.06,-3817.09"/>
<polygon fill="black" stroke="black" points="2551.78,-3814.04 2541.37,-3812.08 2548.28,-3820.1 2551.78,-3814.04"/>
</g>
<!-- ffn_up_11 -->
<g id="node141" class="node">
<title>ffn_up_11</title>
<polygon fill="#e6ffe6" stroke="black" points="2530,-3634 2138,-3634 2138,-3581 2530,-3581 2530,-3634"/>
<text text-anchor="middle" x="2334" y="-3618.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2334" y="-3603.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="2334" y="-3588.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- ln2_11&#45;&gt;ffn_up_11 -->
<g id="edge151" class="edge">
<title>ln2_11&#45;&gt;ffn_up_11</title>
<path fill="none" stroke="black" d="M2369.97,-3669.87C2365.04,-3661.45 2359.47,-3651.95 2354.21,-3642.98"/>
<polygon fill="black" stroke="black" points="2357.17,-3641.11 2349.09,-3634.25 2351.13,-3644.65 2357.17,-3641.11"/>
</g>
<!-- comm_11_12 -->
<g id="node144" class="node">
<title>comm_11_12</title>
<ellipse fill="#f0e6ff" stroke="black" cx="2500" cy="-3240.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="2500" y="-3251.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="2500" y="-3236.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2500" y="-3221.8" font-family="Arial" font-size="14.00">GPU: 10 → GPU: 11</text>
</g>
<!-- residual2_11&#45;&gt;comm_11_12 -->
<g id="edge155" class="edge">
<title>residual2_11&#45;&gt;comm_11_12</title>
<path fill="none" stroke="black" d="M2500,-3313.75C2500,-3305.93 2500,-3297.07 2500,-3288.31"/>
<polygon fill="black" stroke="black" points="2503.5,-3288.13 2500,-3278.13 2496.5,-3288.13 2503.5,-3288.13"/>
</g>
<!-- ffn_act_11 -->
<g id="node142" class="node">
<title>ffn_act_11</title>
<polygon fill="#e6ffe6" stroke="black" points="2434,-3545 2234,-3545 2234,-3492 2434,-3492 2434,-3545"/>
<text text-anchor="middle" x="2334" y="-3529.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="2334" y="-3514.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="2334" y="-3499.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn_up_11&#45;&gt;ffn_act_11 -->
<g id="edge152" class="edge">
<title>ffn_up_11&#45;&gt;ffn_act_11</title>
<path fill="none" stroke="black" d="M2334,-3580.87C2334,-3572.89 2334,-3563.93 2334,-3555.38"/>
<polygon fill="black" stroke="black" points="2337.5,-3555.25 2334,-3545.25 2330.5,-3555.25 2337.5,-3555.25"/>
</g>
<!-- ffn_down_11 -->
<g id="node143" class="node">
<title>ffn_down_11</title>
<polygon fill="#e6ffe6" stroke="black" points="2530,-3456 2138,-3456 2138,-3403 2530,-3403 2530,-3456"/>
<text text-anchor="middle" x="2334" y="-3440.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2334" y="-3425.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2334" y="-3410.8" font-family="Arial" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn_act_11&#45;&gt;ffn_down_11 -->
<g id="edge153" class="edge">
<title>ffn_act_11&#45;&gt;ffn_down_11</title>
<path fill="none" stroke="black" d="M2334,-3491.87C2334,-3483.89 2334,-3474.93 2334,-3466.38"/>
<polygon fill="black" stroke="black" points="2337.5,-3466.25 2334,-3456.25 2330.5,-3466.25 2337.5,-3466.25"/>
</g>
<!-- ffn_down_11&#45;&gt;residual2_11 -->
<g id="edge154" class="edge">
<title>ffn_down_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M2382.91,-3402.87C2401.48,-3393.13 2422.82,-3381.95 2442.14,-3371.82"/>
<polygon fill="black" stroke="black" points="2443.92,-3374.84 2451.16,-3367.1 2440.67,-3368.64 2443.92,-3374.84"/>
</g>
<!-- residual1_12 -->
<g id="node145" class="node">
<title>residual1_12</title>
<polygon fill="#f0f8ff" stroke="black" points="2763.5,-3167 2576.5,-3167 2576.5,-3114 2763.5,-3114 2763.5,-3167"/>
<text text-anchor="middle" x="2670" y="-3151.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2670" y="-3136.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2670" y="-3121.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- comm_11_12&#45;&gt;residual1_12 -->
<g id="edge156" class="edge">
<title>comm_11_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M2557.08,-3206.59C2576.4,-3195.46 2597.88,-3183.07 2616.88,-3172.12"/>
<polygon fill="black" stroke="black" points="2618.79,-3175.06 2625.7,-3167.04 2615.29,-3169 2618.79,-3175.06"/>
</g>
<!-- ln2_12 -->
<g id="node152" class="node">
<title>ln2_12</title>
<polygon fill="#ffe4e1" stroke="black" points="2703.5,-3078 2516.5,-3078 2516.5,-3025 2703.5,-3025 2703.5,-3078"/>
<text text-anchor="middle" x="2610" y="-3062.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2610" y="-3047.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2610" y="-3032.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge163" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M2652.32,-3113.87C2646.45,-3105.36 2639.83,-3095.75 2633.59,-3086.7"/>
<polygon fill="black" stroke="black" points="2636.32,-3084.49 2627.76,-3078.25 2630.55,-3088.47 2636.32,-3084.49"/>
</g>
<!-- residual2_12 -->
<g id="node153" class="node">
<title>residual2_12</title>
<polygon fill="#f0f8ff" stroke="black" points="2817.5,-2722 2630.5,-2722 2630.5,-2669 2817.5,-2669 2817.5,-2722"/>
<text text-anchor="middle" x="2724" y="-2706.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2724" y="-2691.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2724" y="-2676.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- residual1_12&#45;&gt;residual2_12 -->
<g id="edge164" class="edge">
<title>residual1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M2699.72,-3113.82C2732.9,-3082.14 2782,-3024.89 2782,-2963.5 2782,-2963.5 2782,-2963.5 2782,-2872.5 2782,-2820.92 2781.4,-2806.19 2763,-2758 2759.45,-2748.71 2754.4,-2739.32 2749.11,-2730.77"/>
<polygon fill="black" stroke="black" points="2751.93,-2728.69 2743.55,-2722.2 2746.06,-2732.5 2751.93,-2728.69"/>
</g>
<!-- ln1_12 -->
<g id="node146" class="node">
<title>ln1_12</title>
<polygon fill="#ffe4e1" stroke="black" points="2933.5,-3723 2746.5,-3723 2746.5,-3670 2933.5,-3670 2933.5,-3723"/>
<text text-anchor="middle" x="2840" y="-3707.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2840" y="-3692.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2840" y="-3677.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_qkv_12 -->
<g id="node147" class="node">
<title>attn_qkv_12</title>
<polygon fill="#ffe6e6" stroke="black" points="3036,-3634 2644,-3634 2644,-3581 3036,-3581 3036,-3634"/>
<text text-anchor="middle" x="2840" y="-3618.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="2840" y="-3603.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="2840" y="-3588.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- ln1_12&#45;&gt;attn_qkv_12 -->
<g id="edge157" class="edge">
<title>ln1_12&#45;&gt;attn_qkv_12</title>
<path fill="none" stroke="black" d="M2840,-3669.87C2840,-3661.89 2840,-3652.93 2840,-3644.38"/>
<polygon fill="black" stroke="black" points="2843.5,-3644.25 2840,-3634.25 2836.5,-3644.25 2843.5,-3644.25"/>
</g>
<!-- attn_score_12 -->
<g id="node148" class="node">
<title>attn_score_12</title>
<polygon fill="#ffe6e6" stroke="black" points="2922,-3545 2758,-3545 2758,-3492 2922,-3492 2922,-3545"/>
<text text-anchor="middle" x="2840" y="-3529.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="2840" y="-3514.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2840" y="-3499.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_qkv_12&#45;&gt;attn_score_12 -->
<g id="edge158" class="edge">
<title>attn_qkv_12&#45;&gt;attn_score_12</title>
<path fill="none" stroke="black" d="M2840,-3580.87C2840,-3572.89 2840,-3563.93 2840,-3555.38"/>
<polygon fill="black" stroke="black" points="2843.5,-3555.25 2840,-3545.25 2836.5,-3555.25 2843.5,-3555.25"/>
</g>
<!-- attn_weight_12 -->
<g id="node149" class="node">
<title>attn_weight_12</title>
<polygon fill="#ffe6e6" stroke="black" points="2922,-3456 2758,-3456 2758,-3403 2922,-3403 2922,-3456"/>
<text text-anchor="middle" x="2840" y="-3440.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="2840" y="-3425.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="2840" y="-3410.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_score_12&#45;&gt;attn_weight_12 -->
<g id="edge159" class="edge">
<title>attn_score_12&#45;&gt;attn_weight_12</title>
<path fill="none" stroke="black" d="M2840,-3491.87C2840,-3483.89 2840,-3474.93 2840,-3466.38"/>
<polygon fill="black" stroke="black" points="2843.5,-3466.25 2840,-3456.25 2836.5,-3466.25 2843.5,-3466.25"/>
</g>
<!-- attn_context_12 -->
<g id="node150" class="node">
<title>attn_context_12</title>
<polygon fill="#ffe6e6" stroke="black" points="2933.5,-3367 2746.5,-3367 2746.5,-3314 2933.5,-3314 2933.5,-3367"/>
<text text-anchor="middle" x="2840" y="-3351.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="2840" y="-3336.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2840" y="-3321.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_weight_12&#45;&gt;attn_context_12 -->
<g id="edge160" class="edge">
<title>attn_weight_12&#45;&gt;attn_context_12</title>
<path fill="none" stroke="black" d="M2840,-3402.87C2840,-3394.89 2840,-3385.93 2840,-3377.38"/>
<polygon fill="black" stroke="black" points="2843.5,-3377.25 2840,-3367.25 2836.5,-3377.25 2843.5,-3377.25"/>
</g>
<!-- attn_out_12 -->
<g id="node151" class="node">
<title>attn_out_12</title>
<polygon fill="#ffe6e6" stroke="black" points="3029.5,-3267 2650.5,-3267 2650.5,-3214 3029.5,-3214 3029.5,-3267"/>
<text text-anchor="middle" x="2840" y="-3251.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="2840" y="-3236.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2840" y="-3221.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- attn_context_12&#45;&gt;attn_out_12 -->
<g id="edge161" class="edge">
<title>attn_context_12&#45;&gt;attn_out_12</title>
<path fill="none" stroke="black" d="M2840,-3313.75C2840,-3302.61 2840,-3289.38 2840,-3277.31"/>
<polygon fill="black" stroke="black" points="2843.5,-3277.08 2840,-3267.08 2836.5,-3277.08 2843.5,-3277.08"/>
</g>
<!-- attn_out_12&#45;&gt;residual1_12 -->
<g id="edge162" class="edge">
<title>attn_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M2795.33,-3213.75C2773.18,-3200.98 2746.26,-3185.46 2723.06,-3172.09"/>
<polygon fill="black" stroke="black" points="2724.78,-3169.04 2714.37,-3167.08 2721.28,-3175.1 2724.78,-3169.04"/>
</g>
<!-- ffn_up_12 -->
<g id="node154" class="node">
<title>ffn_up_12</title>
<polygon fill="#e6ffe6" stroke="black" points="2754,-2989 2362,-2989 2362,-2936 2754,-2936 2754,-2989"/>
<text text-anchor="middle" x="2558" y="-2973.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2558" y="-2958.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="2558" y="-2943.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- ln2_12&#45;&gt;ffn_up_12 -->
<g id="edge165" class="edge">
<title>ln2_12&#45;&gt;ffn_up_12</title>
<path fill="none" stroke="black" d="M2594.68,-3024.87C2589.65,-3016.45 2583.97,-3006.95 2578.61,-2997.98"/>
<polygon fill="black" stroke="black" points="2581.53,-2996.04 2573.39,-2989.25 2575.52,-2999.63 2581.53,-2996.04"/>
</g>
<!-- comm_12_13 -->
<g id="node157" class="node">
<title>comm_12_13</title>
<ellipse fill="#f0e6ff" stroke="black" cx="2724" cy="-2595.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="2724" y="-2606.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="2724" y="-2591.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2724" y="-2576.8" font-family="Arial" font-size="14.00">GPU: 11 → GPU: 12</text>
</g>
<!-- residual2_12&#45;&gt;comm_12_13 -->
<g id="edge169" class="edge">
<title>residual2_12&#45;&gt;comm_12_13</title>
<path fill="none" stroke="black" d="M2724,-2668.75C2724,-2660.93 2724,-2652.07 2724,-2643.31"/>
<polygon fill="black" stroke="black" points="2727.5,-2643.13 2724,-2633.13 2720.5,-2643.13 2727.5,-2643.13"/>
</g>
<!-- ffn_act_12 -->
<g id="node155" class="node">
<title>ffn_act_12</title>
<polygon fill="#e6ffe6" stroke="black" points="2658,-2900 2458,-2900 2458,-2847 2658,-2847 2658,-2900"/>
<text text-anchor="middle" x="2558" y="-2884.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="2558" y="-2869.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="2558" y="-2854.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn_up_12&#45;&gt;ffn_act_12 -->
<g id="edge166" class="edge">
<title>ffn_up_12&#45;&gt;ffn_act_12</title>
<path fill="none" stroke="black" d="M2558,-2935.87C2558,-2927.89 2558,-2918.93 2558,-2910.38"/>
<polygon fill="black" stroke="black" points="2561.5,-2910.25 2558,-2900.25 2554.5,-2910.25 2561.5,-2910.25"/>
</g>
<!-- ffn_down_12 -->
<g id="node156" class="node">
<title>ffn_down_12</title>
<polygon fill="#e6ffe6" stroke="black" points="2754,-2811 2362,-2811 2362,-2758 2754,-2758 2754,-2811"/>
<text text-anchor="middle" x="2558" y="-2795.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2558" y="-2780.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2558" y="-2765.8" font-family="Arial" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn_act_12&#45;&gt;ffn_down_12 -->
<g id="edge167" class="edge">
<title>ffn_act_12&#45;&gt;ffn_down_12</title>
<path fill="none" stroke="black" d="M2558,-2846.87C2558,-2838.89 2558,-2829.93 2558,-2821.38"/>
<polygon fill="black" stroke="black" points="2561.5,-2821.25 2558,-2811.25 2554.5,-2821.25 2561.5,-2821.25"/>
</g>
<!-- ffn_down_12&#45;&gt;residual2_12 -->
<g id="edge168" class="edge">
<title>ffn_down_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M2606.91,-2757.87C2625.48,-2748.13 2646.82,-2736.95 2666.14,-2726.82"/>
<polygon fill="black" stroke="black" points="2667.92,-2729.84 2675.16,-2722.1 2664.67,-2723.64 2667.92,-2729.84"/>
</g>
<!-- residual1_13 -->
<g id="node158" class="node">
<title>residual1_13</title>
<polygon fill="#f0f8ff" stroke="black" points="2987.5,-2522 2800.5,-2522 2800.5,-2469 2987.5,-2469 2987.5,-2522"/>
<text text-anchor="middle" x="2894" y="-2506.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2894" y="-2491.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2894" y="-2476.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- comm_12_13&#45;&gt;residual1_13 -->
<g id="edge170" class="edge">
<title>comm_12_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M2781.08,-2561.59C2800.4,-2550.46 2821.88,-2538.07 2840.88,-2527.12"/>
<polygon fill="black" stroke="black" points="2842.79,-2530.06 2849.7,-2522.04 2839.29,-2524 2842.79,-2530.06"/>
</g>
<!-- ln2_13 -->
<g id="node165" class="node">
<title>ln2_13</title>
<polygon fill="#ffe4e1" stroke="black" points="2927.5,-2433 2740.5,-2433 2740.5,-2380 2927.5,-2380 2927.5,-2433"/>
<text text-anchor="middle" x="2834" y="-2417.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2834" y="-2402.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2834" y="-2387.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge177" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M2876.32,-2468.87C2870.45,-2460.36 2863.83,-2450.75 2857.59,-2441.7"/>
<polygon fill="black" stroke="black" points="2860.32,-2439.49 2851.76,-2433.25 2854.55,-2443.47 2860.32,-2439.49"/>
</g>
<!-- residual2_13 -->
<g id="node166" class="node">
<title>residual2_13</title>
<polygon fill="#f0f8ff" stroke="black" points="3041.5,-2077 2854.5,-2077 2854.5,-2024 3041.5,-2024 3041.5,-2077"/>
<text text-anchor="middle" x="2948" y="-2061.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2948" y="-2046.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2948" y="-2031.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- residual1_13&#45;&gt;residual2_13 -->
<g id="edge178" class="edge">
<title>residual1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M2923.72,-2468.82C2956.9,-2437.14 3006,-2379.89 3006,-2318.5 3006,-2318.5 3006,-2318.5 3006,-2227.5 3006,-2175.92 3005.4,-2161.19 2987,-2113 2983.45,-2103.71 2978.4,-2094.32 2973.11,-2085.77"/>
<polygon fill="black" stroke="black" points="2975.93,-2083.69 2967.55,-2077.2 2970.06,-2087.5 2975.93,-2083.69"/>
</g>
<!-- ln1_13 -->
<g id="node159" class="node">
<title>ln1_13</title>
<polygon fill="#ffe4e1" stroke="black" points="3157.5,-3078 2970.5,-3078 2970.5,-3025 3157.5,-3025 3157.5,-3078"/>
<text text-anchor="middle" x="3064" y="-3062.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3064" y="-3047.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3064" y="-3032.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_qkv_13 -->
<g id="node160" class="node">
<title>attn_qkv_13</title>
<polygon fill="#ffe6e6" stroke="black" points="3260,-2989 2868,-2989 2868,-2936 3260,-2936 3260,-2989"/>
<text text-anchor="middle" x="3064" y="-2973.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3064" y="-2958.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="3064" y="-2943.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- ln1_13&#45;&gt;attn_qkv_13 -->
<g id="edge171" class="edge">
<title>ln1_13&#45;&gt;attn_qkv_13</title>
<path fill="none" stroke="black" d="M3064,-3024.87C3064,-3016.89 3064,-3007.93 3064,-2999.38"/>
<polygon fill="black" stroke="black" points="3067.5,-2999.25 3064,-2989.25 3060.5,-2999.25 3067.5,-2999.25"/>
</g>
<!-- attn_score_13 -->
<g id="node161" class="node">
<title>attn_score_13</title>
<polygon fill="#ffe6e6" stroke="black" points="3146,-2900 2982,-2900 2982,-2847 3146,-2847 3146,-2900"/>
<text text-anchor="middle" x="3064" y="-2884.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3064" y="-2869.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3064" y="-2854.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_qkv_13&#45;&gt;attn_score_13 -->
<g id="edge172" class="edge">
<title>attn_qkv_13&#45;&gt;attn_score_13</title>
<path fill="none" stroke="black" d="M3064,-2935.87C3064,-2927.89 3064,-2918.93 3064,-2910.38"/>
<polygon fill="black" stroke="black" points="3067.5,-2910.25 3064,-2900.25 3060.5,-2910.25 3067.5,-2910.25"/>
</g>
<!-- attn_weight_13 -->
<g id="node162" class="node">
<title>attn_weight_13</title>
<polygon fill="#ffe6e6" stroke="black" points="3146,-2811 2982,-2811 2982,-2758 3146,-2758 3146,-2811"/>
<text text-anchor="middle" x="3064" y="-2795.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="3064" y="-2780.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3064" y="-2765.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_score_13&#45;&gt;attn_weight_13 -->
<g id="edge173" class="edge">
<title>attn_score_13&#45;&gt;attn_weight_13</title>
<path fill="none" stroke="black" d="M3064,-2846.87C3064,-2838.89 3064,-2829.93 3064,-2821.38"/>
<polygon fill="black" stroke="black" points="3067.5,-2821.25 3064,-2811.25 3060.5,-2821.25 3067.5,-2821.25"/>
</g>
<!-- attn_context_13 -->
<g id="node163" class="node">
<title>attn_context_13</title>
<polygon fill="#ffe6e6" stroke="black" points="3157.5,-2722 2970.5,-2722 2970.5,-2669 3157.5,-2669 3157.5,-2722"/>
<text text-anchor="middle" x="3064" y="-2706.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="3064" y="-2691.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3064" y="-2676.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_weight_13&#45;&gt;attn_context_13 -->
<g id="edge174" class="edge">
<title>attn_weight_13&#45;&gt;attn_context_13</title>
<path fill="none" stroke="black" d="M3064,-2757.87C3064,-2749.89 3064,-2740.93 3064,-2732.38"/>
<polygon fill="black" stroke="black" points="3067.5,-2732.25 3064,-2722.25 3060.5,-2732.25 3067.5,-2732.25"/>
</g>
<!-- attn_out_13 -->
<g id="node164" class="node">
<title>attn_out_13</title>
<polygon fill="#ffe6e6" stroke="black" points="3253.5,-2622 2874.5,-2622 2874.5,-2569 3253.5,-2569 3253.5,-2622"/>
<text text-anchor="middle" x="3064" y="-2606.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3064" y="-2591.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3064" y="-2576.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- attn_context_13&#45;&gt;attn_out_13 -->
<g id="edge175" class="edge">
<title>attn_context_13&#45;&gt;attn_out_13</title>
<path fill="none" stroke="black" d="M3064,-2668.75C3064,-2657.61 3064,-2644.38 3064,-2632.31"/>
<polygon fill="black" stroke="black" points="3067.5,-2632.08 3064,-2622.08 3060.5,-2632.08 3067.5,-2632.08"/>
</g>
<!-- attn_out_13&#45;&gt;residual1_13 -->
<g id="edge176" class="edge">
<title>attn_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M3019.33,-2568.75C2997.18,-2555.98 2970.26,-2540.46 2947.06,-2527.09"/>
<polygon fill="black" stroke="black" points="2948.78,-2524.04 2938.37,-2522.08 2945.28,-2530.1 2948.78,-2524.04"/>
</g>
<!-- ffn_up_13 -->
<g id="node167" class="node">
<title>ffn_up_13</title>
<polygon fill="#e6ffe6" stroke="black" points="2978,-2344 2586,-2344 2586,-2291 2978,-2291 2978,-2344"/>
<text text-anchor="middle" x="2782" y="-2328.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="2782" y="-2313.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="2782" y="-2298.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- ln2_13&#45;&gt;ffn_up_13 -->
<g id="edge179" class="edge">
<title>ln2_13&#45;&gt;ffn_up_13</title>
<path fill="none" stroke="black" d="M2818.68,-2379.87C2813.65,-2371.45 2807.97,-2361.95 2802.61,-2352.98"/>
<polygon fill="black" stroke="black" points="2805.53,-2351.04 2797.39,-2344.25 2799.52,-2354.63 2805.53,-2351.04"/>
</g>
<!-- comm_13_14 -->
<g id="node170" class="node">
<title>comm_13_14</title>
<ellipse fill="#f0e6ff" stroke="black" cx="2948" cy="-1950.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="2948" y="-1961.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="2948" y="-1946.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2948" y="-1931.8" font-family="Arial" font-size="14.00">GPU: 12 → GPU: 13</text>
</g>
<!-- residual2_13&#45;&gt;comm_13_14 -->
<g id="edge183" class="edge">
<title>residual2_13&#45;&gt;comm_13_14</title>
<path fill="none" stroke="black" d="M2948,-2023.75C2948,-2015.93 2948,-2007.07 2948,-1998.31"/>
<polygon fill="black" stroke="black" points="2951.5,-1998.13 2948,-1988.13 2944.5,-1998.13 2951.5,-1998.13"/>
</g>
<!-- ffn_act_13 -->
<g id="node168" class="node">
<title>ffn_act_13</title>
<polygon fill="#e6ffe6" stroke="black" points="2882,-2255 2682,-2255 2682,-2202 2882,-2202 2882,-2255"/>
<text text-anchor="middle" x="2782" y="-2239.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="2782" y="-2224.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="2782" y="-2209.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn_up_13&#45;&gt;ffn_act_13 -->
<g id="edge180" class="edge">
<title>ffn_up_13&#45;&gt;ffn_act_13</title>
<path fill="none" stroke="black" d="M2782,-2290.87C2782,-2282.89 2782,-2273.93 2782,-2265.38"/>
<polygon fill="black" stroke="black" points="2785.5,-2265.25 2782,-2255.25 2778.5,-2265.25 2785.5,-2265.25"/>
</g>
<!-- ffn_down_13 -->
<g id="node169" class="node">
<title>ffn_down_13</title>
<polygon fill="#e6ffe6" stroke="black" points="2978,-2166 2586,-2166 2586,-2113 2978,-2113 2978,-2166"/>
<text text-anchor="middle" x="2782" y="-2150.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="2782" y="-2135.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="2782" y="-2120.8" font-family="Arial" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn_act_13&#45;&gt;ffn_down_13 -->
<g id="edge181" class="edge">
<title>ffn_act_13&#45;&gt;ffn_down_13</title>
<path fill="none" stroke="black" d="M2782,-2201.87C2782,-2193.89 2782,-2184.93 2782,-2176.38"/>
<polygon fill="black" stroke="black" points="2785.5,-2176.25 2782,-2166.25 2778.5,-2176.25 2785.5,-2176.25"/>
</g>
<!-- ffn_down_13&#45;&gt;residual2_13 -->
<g id="edge182" class="edge">
<title>ffn_down_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M2830.91,-2112.87C2849.48,-2103.13 2870.82,-2091.95 2890.14,-2081.82"/>
<polygon fill="black" stroke="black" points="2891.92,-2084.84 2899.16,-2077.1 2888.67,-2078.64 2891.92,-2084.84"/>
</g>
<!-- residual1_14 -->
<g id="node171" class="node">
<title>residual1_14</title>
<polygon fill="#f0f8ff" stroke="black" points="3211.5,-1877 3024.5,-1877 3024.5,-1824 3211.5,-1824 3211.5,-1877"/>
<text text-anchor="middle" x="3118" y="-1861.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3118" y="-1846.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3118" y="-1831.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- comm_13_14&#45;&gt;residual1_14 -->
<g id="edge184" class="edge">
<title>comm_13_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M3005.08,-1916.59C3024.4,-1905.46 3045.88,-1893.07 3064.88,-1882.12"/>
<polygon fill="black" stroke="black" points="3066.79,-1885.06 3073.7,-1877.04 3063.29,-1879 3066.79,-1885.06"/>
</g>
<!-- ln2_14 -->
<g id="node178" class="node">
<title>ln2_14</title>
<polygon fill="#ffe4e1" stroke="black" points="3151.5,-1788 2964.5,-1788 2964.5,-1735 3151.5,-1735 3151.5,-1788"/>
<text text-anchor="middle" x="3058" y="-1772.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3058" y="-1757.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3058" y="-1742.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge191" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M3100.32,-1823.87C3094.45,-1815.36 3087.83,-1805.75 3081.59,-1796.7"/>
<polygon fill="black" stroke="black" points="3084.32,-1794.49 3075.76,-1788.25 3078.55,-1798.47 3084.32,-1794.49"/>
</g>
<!-- residual2_14 -->
<g id="node179" class="node">
<title>residual2_14</title>
<polygon fill="#f0f8ff" stroke="black" points="3265.5,-1432 3078.5,-1432 3078.5,-1379 3265.5,-1379 3265.5,-1432"/>
<text text-anchor="middle" x="3172" y="-1416.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3172" y="-1401.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3172" y="-1386.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- residual1_14&#45;&gt;residual2_14 -->
<g id="edge192" class="edge">
<title>residual1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M3147.72,-1823.82C3180.9,-1792.14 3230,-1734.89 3230,-1673.5 3230,-1673.5 3230,-1673.5 3230,-1582.5 3230,-1530.92 3229.4,-1516.19 3211,-1468 3207.45,-1458.71 3202.4,-1449.32 3197.11,-1440.77"/>
<polygon fill="black" stroke="black" points="3199.93,-1438.69 3191.55,-1432.2 3194.06,-1442.5 3199.93,-1438.69"/>
</g>
<!-- ln1_14 -->
<g id="node172" class="node">
<title>ln1_14</title>
<polygon fill="#ffe4e1" stroke="black" points="3381.5,-2433 3194.5,-2433 3194.5,-2380 3381.5,-2380 3381.5,-2433"/>
<text text-anchor="middle" x="3288" y="-2417.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3288" y="-2402.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3288" y="-2387.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_qkv_14 -->
<g id="node173" class="node">
<title>attn_qkv_14</title>
<polygon fill="#ffe6e6" stroke="black" points="3484,-2344 3092,-2344 3092,-2291 3484,-2291 3484,-2344"/>
<text text-anchor="middle" x="3288" y="-2328.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3288" y="-2313.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="3288" y="-2298.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- ln1_14&#45;&gt;attn_qkv_14 -->
<g id="edge185" class="edge">
<title>ln1_14&#45;&gt;attn_qkv_14</title>
<path fill="none" stroke="black" d="M3288,-2379.87C3288,-2371.89 3288,-2362.93 3288,-2354.38"/>
<polygon fill="black" stroke="black" points="3291.5,-2354.25 3288,-2344.25 3284.5,-2354.25 3291.5,-2354.25"/>
</g>
<!-- attn_score_14 -->
<g id="node174" class="node">
<title>attn_score_14</title>
<polygon fill="#ffe6e6" stroke="black" points="3370,-2255 3206,-2255 3206,-2202 3370,-2202 3370,-2255"/>
<text text-anchor="middle" x="3288" y="-2239.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3288" y="-2224.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3288" y="-2209.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_qkv_14&#45;&gt;attn_score_14 -->
<g id="edge186" class="edge">
<title>attn_qkv_14&#45;&gt;attn_score_14</title>
<path fill="none" stroke="black" d="M3288,-2290.87C3288,-2282.89 3288,-2273.93 3288,-2265.38"/>
<polygon fill="black" stroke="black" points="3291.5,-2265.25 3288,-2255.25 3284.5,-2265.25 3291.5,-2265.25"/>
</g>
<!-- attn_weight_14 -->
<g id="node175" class="node">
<title>attn_weight_14</title>
<polygon fill="#ffe6e6" stroke="black" points="3370,-2166 3206,-2166 3206,-2113 3370,-2113 3370,-2166"/>
<text text-anchor="middle" x="3288" y="-2150.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="3288" y="-2135.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3288" y="-2120.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_score_14&#45;&gt;attn_weight_14 -->
<g id="edge187" class="edge">
<title>attn_score_14&#45;&gt;attn_weight_14</title>
<path fill="none" stroke="black" d="M3288,-2201.87C3288,-2193.89 3288,-2184.93 3288,-2176.38"/>
<polygon fill="black" stroke="black" points="3291.5,-2176.25 3288,-2166.25 3284.5,-2176.25 3291.5,-2176.25"/>
</g>
<!-- attn_context_14 -->
<g id="node176" class="node">
<title>attn_context_14</title>
<polygon fill="#ffe6e6" stroke="black" points="3381.5,-2077 3194.5,-2077 3194.5,-2024 3381.5,-2024 3381.5,-2077"/>
<text text-anchor="middle" x="3288" y="-2061.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="3288" y="-2046.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3288" y="-2031.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_weight_14&#45;&gt;attn_context_14 -->
<g id="edge188" class="edge">
<title>attn_weight_14&#45;&gt;attn_context_14</title>
<path fill="none" stroke="black" d="M3288,-2112.87C3288,-2104.89 3288,-2095.93 3288,-2087.38"/>
<polygon fill="black" stroke="black" points="3291.5,-2087.25 3288,-2077.25 3284.5,-2087.25 3291.5,-2087.25"/>
</g>
<!-- attn_out_14 -->
<g id="node177" class="node">
<title>attn_out_14</title>
<polygon fill="#ffe6e6" stroke="black" points="3477.5,-1977 3098.5,-1977 3098.5,-1924 3477.5,-1924 3477.5,-1977"/>
<text text-anchor="middle" x="3288" y="-1961.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3288" y="-1946.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3288" y="-1931.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- attn_context_14&#45;&gt;attn_out_14 -->
<g id="edge189" class="edge">
<title>attn_context_14&#45;&gt;attn_out_14</title>
<path fill="none" stroke="black" d="M3288,-2023.75C3288,-2012.61 3288,-1999.38 3288,-1987.31"/>
<polygon fill="black" stroke="black" points="3291.5,-1987.08 3288,-1977.08 3284.5,-1987.08 3291.5,-1987.08"/>
</g>
<!-- attn_out_14&#45;&gt;residual1_14 -->
<g id="edge190" class="edge">
<title>attn_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M3243.33,-1923.75C3221.18,-1910.98 3194.26,-1895.46 3171.06,-1882.09"/>
<polygon fill="black" stroke="black" points="3172.78,-1879.04 3162.37,-1877.08 3169.28,-1885.1 3172.78,-1879.04"/>
</g>
<!-- ffn_up_14 -->
<g id="node180" class="node">
<title>ffn_up_14</title>
<polygon fill="#e6ffe6" stroke="black" points="3202,-1699 2810,-1699 2810,-1646 3202,-1646 3202,-1699"/>
<text text-anchor="middle" x="3006" y="-1683.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3006" y="-1668.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="3006" y="-1653.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- ln2_14&#45;&gt;ffn_up_14 -->
<g id="edge193" class="edge">
<title>ln2_14&#45;&gt;ffn_up_14</title>
<path fill="none" stroke="black" d="M3042.68,-1734.87C3037.65,-1726.45 3031.97,-1716.95 3026.61,-1707.98"/>
<polygon fill="black" stroke="black" points="3029.53,-1706.04 3021.39,-1699.25 3023.52,-1709.63 3029.53,-1706.04"/>
</g>
<!-- comm_14_15 -->
<g id="node183" class="node">
<title>comm_14_15</title>
<ellipse fill="#f0e6ff" stroke="black" cx="3172" cy="-1305.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="3172" y="-1316.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="3172" y="-1301.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3172" y="-1286.8" font-family="Arial" font-size="14.00">GPU: 13 → GPU: 14</text>
</g>
<!-- residual2_14&#45;&gt;comm_14_15 -->
<g id="edge197" class="edge">
<title>residual2_14&#45;&gt;comm_14_15</title>
<path fill="none" stroke="black" d="M3172,-1378.75C3172,-1370.93 3172,-1362.07 3172,-1353.31"/>
<polygon fill="black" stroke="black" points="3175.5,-1353.13 3172,-1343.13 3168.5,-1353.13 3175.5,-1353.13"/>
</g>
<!-- ffn_act_14 -->
<g id="node181" class="node">
<title>ffn_act_14</title>
<polygon fill="#e6ffe6" stroke="black" points="3106,-1610 2906,-1610 2906,-1557 3106,-1557 3106,-1610"/>
<text text-anchor="middle" x="3006" y="-1594.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="3006" y="-1579.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="3006" y="-1564.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn_up_14&#45;&gt;ffn_act_14 -->
<g id="edge194" class="edge">
<title>ffn_up_14&#45;&gt;ffn_act_14</title>
<path fill="none" stroke="black" d="M3006,-1645.87C3006,-1637.89 3006,-1628.93 3006,-1620.38"/>
<polygon fill="black" stroke="black" points="3009.5,-1620.25 3006,-1610.25 3002.5,-1620.25 3009.5,-1620.25"/>
</g>
<!-- ffn_down_14 -->
<g id="node182" class="node">
<title>ffn_down_14</title>
<polygon fill="#e6ffe6" stroke="black" points="3202,-1521 2810,-1521 2810,-1468 3202,-1468 3202,-1521"/>
<text text-anchor="middle" x="3006" y="-1505.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3006" y="-1490.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3006" y="-1475.8" font-family="Arial" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn_act_14&#45;&gt;ffn_down_14 -->
<g id="edge195" class="edge">
<title>ffn_act_14&#45;&gt;ffn_down_14</title>
<path fill="none" stroke="black" d="M3006,-1556.87C3006,-1548.89 3006,-1539.93 3006,-1531.38"/>
<polygon fill="black" stroke="black" points="3009.5,-1531.25 3006,-1521.25 3002.5,-1531.25 3009.5,-1531.25"/>
</g>
<!-- ffn_down_14&#45;&gt;residual2_14 -->
<g id="edge196" class="edge">
<title>ffn_down_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M3054.91,-1467.87C3073.48,-1458.13 3094.82,-1446.95 3114.14,-1436.82"/>
<polygon fill="black" stroke="black" points="3115.92,-1439.84 3123.16,-1432.1 3112.67,-1433.64 3115.92,-1439.84"/>
</g>
<!-- residual1_15 -->
<g id="node184" class="node">
<title>residual1_15</title>
<polygon fill="#f0f8ff" stroke="black" points="3435.5,-1232 3248.5,-1232 3248.5,-1179 3435.5,-1179 3435.5,-1232"/>
<text text-anchor="middle" x="3342" y="-1216.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3342" y="-1201.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3342" y="-1186.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- comm_14_15&#45;&gt;residual1_15 -->
<g id="edge198" class="edge">
<title>comm_14_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M3229.08,-1271.59C3248.4,-1260.46 3269.88,-1248.07 3288.88,-1237.12"/>
<polygon fill="black" stroke="black" points="3290.79,-1240.06 3297.7,-1232.04 3287.29,-1234 3290.79,-1240.06"/>
</g>
<!-- ln2_15 -->
<g id="node191" class="node">
<title>ln2_15</title>
<polygon fill="#ffe4e1" stroke="black" points="3375.5,-1143 3188.5,-1143 3188.5,-1090 3375.5,-1090 3375.5,-1143"/>
<text text-anchor="middle" x="3282" y="-1127.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3282" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3282" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge205" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M3324.32,-1178.87C3318.45,-1170.36 3311.83,-1160.75 3305.59,-1151.7"/>
<polygon fill="black" stroke="black" points="3308.32,-1149.49 3299.76,-1143.25 3302.55,-1153.47 3308.32,-1149.49"/>
</g>
<!-- residual2_15 -->
<g id="node192" class="node">
<title>residual2_15</title>
<polygon fill="#f0f8ff" stroke="black" points="3489.5,-787 3302.5,-787 3302.5,-734 3489.5,-734 3489.5,-787"/>
<text text-anchor="middle" x="3396" y="-771.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3396" y="-756.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3396" y="-741.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- residual1_15&#45;&gt;residual2_15 -->
<g id="edge206" class="edge">
<title>residual1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M3371.72,-1178.82C3404.9,-1147.14 3454,-1089.89 3454,-1028.5 3454,-1028.5 3454,-1028.5 3454,-937.5 3454,-885.92 3453.4,-871.19 3435,-823 3431.45,-813.71 3426.4,-804.32 3421.11,-795.77"/>
<polygon fill="black" stroke="black" points="3423.93,-793.69 3415.55,-787.2 3418.06,-797.5 3423.93,-793.69"/>
</g>
<!-- ln1_15 -->
<g id="node185" class="node">
<title>ln1_15</title>
<polygon fill="#ffe4e1" stroke="black" points="3605.5,-1788 3418.5,-1788 3418.5,-1735 3605.5,-1735 3605.5,-1788"/>
<text text-anchor="middle" x="3512" y="-1772.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3512" y="-1757.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3512" y="-1742.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_qkv_15 -->
<g id="node186" class="node">
<title>attn_qkv_15</title>
<polygon fill="#ffe6e6" stroke="black" points="3708,-1699 3316,-1699 3316,-1646 3708,-1646 3708,-1699"/>
<text text-anchor="middle" x="3512" y="-1683.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3512" y="-1668.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="3512" y="-1653.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- ln1_15&#45;&gt;attn_qkv_15 -->
<g id="edge199" class="edge">
<title>ln1_15&#45;&gt;attn_qkv_15</title>
<path fill="none" stroke="black" d="M3512,-1734.87C3512,-1726.89 3512,-1717.93 3512,-1709.38"/>
<polygon fill="black" stroke="black" points="3515.5,-1709.25 3512,-1699.25 3508.5,-1709.25 3515.5,-1709.25"/>
</g>
<!-- attn_score_15 -->
<g id="node187" class="node">
<title>attn_score_15</title>
<polygon fill="#ffe6e6" stroke="black" points="3594,-1610 3430,-1610 3430,-1557 3594,-1557 3594,-1610"/>
<text text-anchor="middle" x="3512" y="-1594.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3512" y="-1579.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3512" y="-1564.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_qkv_15&#45;&gt;attn_score_15 -->
<g id="edge200" class="edge">
<title>attn_qkv_15&#45;&gt;attn_score_15</title>
<path fill="none" stroke="black" d="M3512,-1645.87C3512,-1637.89 3512,-1628.93 3512,-1620.38"/>
<polygon fill="black" stroke="black" points="3515.5,-1620.25 3512,-1610.25 3508.5,-1620.25 3515.5,-1620.25"/>
</g>
<!-- attn_weight_15 -->
<g id="node188" class="node">
<title>attn_weight_15</title>
<polygon fill="#ffe6e6" stroke="black" points="3594,-1521 3430,-1521 3430,-1468 3594,-1468 3594,-1521"/>
<text text-anchor="middle" x="3512" y="-1505.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="3512" y="-1490.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3512" y="-1475.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_score_15&#45;&gt;attn_weight_15 -->
<g id="edge201" class="edge">
<title>attn_score_15&#45;&gt;attn_weight_15</title>
<path fill="none" stroke="black" d="M3512,-1556.87C3512,-1548.89 3512,-1539.93 3512,-1531.38"/>
<polygon fill="black" stroke="black" points="3515.5,-1531.25 3512,-1521.25 3508.5,-1531.25 3515.5,-1531.25"/>
</g>
<!-- attn_context_15 -->
<g id="node189" class="node">
<title>attn_context_15</title>
<polygon fill="#ffe6e6" stroke="black" points="3605.5,-1432 3418.5,-1432 3418.5,-1379 3605.5,-1379 3605.5,-1432"/>
<text text-anchor="middle" x="3512" y="-1416.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="3512" y="-1401.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3512" y="-1386.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_weight_15&#45;&gt;attn_context_15 -->
<g id="edge202" class="edge">
<title>attn_weight_15&#45;&gt;attn_context_15</title>
<path fill="none" stroke="black" d="M3512,-1467.87C3512,-1459.89 3512,-1450.93 3512,-1442.38"/>
<polygon fill="black" stroke="black" points="3515.5,-1442.25 3512,-1432.25 3508.5,-1442.25 3515.5,-1442.25"/>
</g>
<!-- attn_out_15 -->
<g id="node190" class="node">
<title>attn_out_15</title>
<polygon fill="#ffe6e6" stroke="black" points="3701.5,-1332 3322.5,-1332 3322.5,-1279 3701.5,-1279 3701.5,-1332"/>
<text text-anchor="middle" x="3512" y="-1316.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3512" y="-1301.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3512" y="-1286.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- attn_context_15&#45;&gt;attn_out_15 -->
<g id="edge203" class="edge">
<title>attn_context_15&#45;&gt;attn_out_15</title>
<path fill="none" stroke="black" d="M3512,-1378.75C3512,-1367.61 3512,-1354.38 3512,-1342.31"/>
<polygon fill="black" stroke="black" points="3515.5,-1342.08 3512,-1332.08 3508.5,-1342.08 3515.5,-1342.08"/>
</g>
<!-- attn_out_15&#45;&gt;residual1_15 -->
<g id="edge204" class="edge">
<title>attn_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M3467.33,-1278.75C3445.18,-1265.98 3418.26,-1250.46 3395.06,-1237.09"/>
<polygon fill="black" stroke="black" points="3396.78,-1234.04 3386.37,-1232.08 3393.28,-1240.1 3396.78,-1234.04"/>
</g>
<!-- ffn_up_15 -->
<g id="node193" class="node">
<title>ffn_up_15</title>
<polygon fill="#e6ffe6" stroke="black" points="3426,-1054 3034,-1054 3034,-1001 3426,-1001 3426,-1054"/>
<text text-anchor="middle" x="3230" y="-1038.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3230" y="-1023.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="3230" y="-1008.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- ln2_15&#45;&gt;ffn_up_15 -->
<g id="edge207" class="edge">
<title>ln2_15&#45;&gt;ffn_up_15</title>
<path fill="none" stroke="black" d="M3266.68,-1089.87C3261.65,-1081.45 3255.97,-1071.95 3250.61,-1062.98"/>
<polygon fill="black" stroke="black" points="3253.53,-1061.04 3245.39,-1054.25 3247.52,-1064.63 3253.53,-1061.04"/>
</g>
<!-- comm_15_16 -->
<g id="node196" class="node">
<title>comm_15_16</title>
<ellipse fill="#f0e6ff" stroke="black" cx="3396" cy="-660.5" rx="132.29" ry="37.5"/>
<text text-anchor="middle" x="3396" y="-671.8" font-family="Arial" font-size="14.00">Inter&#45;GPU Transfer</text>
<text text-anchor="middle" x="3396" y="-656.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3396" y="-641.8" font-family="Arial" font-size="14.00">GPU: 14 → GPU: 15</text>
</g>
<!-- residual2_15&#45;&gt;comm_15_16 -->
<g id="edge211" class="edge">
<title>residual2_15&#45;&gt;comm_15_16</title>
<path fill="none" stroke="black" d="M3396,-733.75C3396,-725.93 3396,-717.07 3396,-708.31"/>
<polygon fill="black" stroke="black" points="3399.5,-708.13 3396,-698.13 3392.5,-708.13 3399.5,-708.13"/>
</g>
<!-- ffn_act_15 -->
<g id="node194" class="node">
<title>ffn_act_15</title>
<polygon fill="#e6ffe6" stroke="black" points="3330,-965 3130,-965 3130,-912 3330,-912 3330,-965"/>
<text text-anchor="middle" x="3230" y="-949.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="3230" y="-934.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="3230" y="-919.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn_up_15&#45;&gt;ffn_act_15 -->
<g id="edge208" class="edge">
<title>ffn_up_15&#45;&gt;ffn_act_15</title>
<path fill="none" stroke="black" d="M3230,-1000.87C3230,-992.89 3230,-983.93 3230,-975.38"/>
<polygon fill="black" stroke="black" points="3233.5,-975.25 3230,-965.25 3226.5,-975.25 3233.5,-975.25"/>
</g>
<!-- ffn_down_15 -->
<g id="node195" class="node">
<title>ffn_down_15</title>
<polygon fill="#e6ffe6" stroke="black" points="3426,-876 3034,-876 3034,-823 3426,-823 3426,-876"/>
<text text-anchor="middle" x="3230" y="-860.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3230" y="-845.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3230" y="-830.8" font-family="Arial" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn_act_15&#45;&gt;ffn_down_15 -->
<g id="edge209" class="edge">
<title>ffn_act_15&#45;&gt;ffn_down_15</title>
<path fill="none" stroke="black" d="M3230,-911.87C3230,-903.89 3230,-894.93 3230,-886.38"/>
<polygon fill="black" stroke="black" points="3233.5,-886.25 3230,-876.25 3226.5,-886.25 3233.5,-886.25"/>
</g>
<!-- ffn_down_15&#45;&gt;residual2_15 -->
<g id="edge210" class="edge">
<title>ffn_down_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M3278.91,-822.87C3297.48,-813.13 3318.82,-801.95 3338.14,-791.82"/>
<polygon fill="black" stroke="black" points="3339.92,-794.84 3347.16,-787.1 3336.67,-788.64 3339.92,-794.84"/>
</g>
<!-- residual1_16 -->
<g id="node197" class="node">
<title>residual1_16</title>
<polygon fill="#f0f8ff" stroke="black" points="3659.5,-587 3472.5,-587 3472.5,-534 3659.5,-534 3659.5,-587"/>
<text text-anchor="middle" x="3566" y="-571.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3566" y="-556.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3566" y="-541.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- comm_15_16&#45;&gt;residual1_16 -->
<g id="edge212" class="edge">
<title>comm_15_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M3453.08,-626.59C3472.4,-615.46 3493.88,-603.07 3512.88,-592.12"/>
<polygon fill="black" stroke="black" points="3514.79,-595.06 3521.7,-587.04 3511.29,-589 3514.79,-595.06"/>
</g>
<!-- ln2_16 -->
<g id="node204" class="node">
<title>ln2_16</title>
<polygon fill="#ffe4e1" stroke="black" points="3599.5,-498 3412.5,-498 3412.5,-445 3599.5,-445 3599.5,-498"/>
<text text-anchor="middle" x="3506" y="-482.8" font-family="Arial" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3506" y="-467.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3506" y="-452.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- residual1_16&#45;&gt;ln2_16 -->
<g id="edge219" class="edge">
<title>residual1_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M3548.32,-533.87C3542.45,-525.36 3535.83,-515.75 3529.59,-506.7"/>
<polygon fill="black" stroke="black" points="3532.32,-504.49 3523.76,-498.25 3526.55,-508.47 3532.32,-504.49"/>
</g>
<!-- residual2_16 -->
<g id="node205" class="node">
<title>residual2_16</title>
<polygon fill="#f0f8ff" stroke="black" points="3659.5,-142 3472.5,-142 3472.5,-89 3659.5,-89 3659.5,-142"/>
<text text-anchor="middle" x="3566" y="-126.8" font-family="Arial" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3566" y="-111.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3566" y="-96.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- residual1_16&#45;&gt;residual2_16 -->
<g id="edge220" class="edge">
<title>residual1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M3595.72,-533.82C3628.9,-502.14 3678,-444.89 3678,-383.5 3678,-383.5 3678,-383.5 3678,-292.5 3678,-240.92 3687.07,-221.28 3659,-178 3651.37,-166.24 3640.61,-156.21 3629.11,-147.88"/>
<polygon fill="black" stroke="black" points="3630.87,-144.84 3620.64,-142.11 3626.93,-150.63 3630.87,-144.84"/>
</g>
<!-- ln1_16 -->
<g id="node198" class="node">
<title>ln1_16</title>
<polygon fill="#ffe4e1" stroke="black" points="3829.5,-1143 3642.5,-1143 3642.5,-1090 3829.5,-1090 3829.5,-1143"/>
<text text-anchor="middle" x="3736" y="-1127.8" font-family="Arial" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3736" y="-1112.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3736" y="-1097.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_qkv_16 -->
<g id="node199" class="node">
<title>attn_qkv_16</title>
<polygon fill="#ffe6e6" stroke="black" points="3932,-1054 3540,-1054 3540,-1001 3932,-1001 3932,-1054"/>
<text text-anchor="middle" x="3736" y="-1038.8" font-family="Arial" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="3736" y="-1023.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 3*hidden_dim]</text>
<text text-anchor="middle" x="3736" y="-1008.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- ln1_16&#45;&gt;attn_qkv_16 -->
<g id="edge213" class="edge">
<title>ln1_16&#45;&gt;attn_qkv_16</title>
<path fill="none" stroke="black" d="M3736,-1089.87C3736,-1081.89 3736,-1072.93 3736,-1064.38"/>
<polygon fill="black" stroke="black" points="3739.5,-1064.25 3736,-1054.25 3732.5,-1064.25 3739.5,-1064.25"/>
</g>
<!-- attn_score_16 -->
<g id="node200" class="node">
<title>attn_score_16</title>
<polygon fill="#ffe6e6" stroke="black" points="3818,-965 3654,-965 3654,-912 3818,-912 3818,-965"/>
<text text-anchor="middle" x="3736" y="-949.8" font-family="Arial" font-size="14.00">Attention Scores</text>
<text text-anchor="middle" x="3736" y="-934.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3736" y="-919.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_qkv_16&#45;&gt;attn_score_16 -->
<g id="edge214" class="edge">
<title>attn_qkv_16&#45;&gt;attn_score_16</title>
<path fill="none" stroke="black" d="M3736,-1000.87C3736,-992.89 3736,-983.93 3736,-975.38"/>
<polygon fill="black" stroke="black" points="3739.5,-975.25 3736,-965.25 3732.5,-975.25 3739.5,-975.25"/>
</g>
<!-- attn_weight_16 -->
<g id="node201" class="node">
<title>attn_weight_16</title>
<polygon fill="#ffe6e6" stroke="black" points="3818,-876 3654,-876 3654,-823 3818,-823 3818,-876"/>
<text text-anchor="middle" x="3736" y="-860.8" font-family="Arial" font-size="14.00">Attention Weights</text>
<text text-anchor="middle" x="3736" y="-845.8" font-family="Arial" font-size="14.00">[1024, seq_len, seq_len]</text>
<text text-anchor="middle" x="3736" y="-830.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_score_16&#45;&gt;attn_weight_16 -->
<g id="edge215" class="edge">
<title>attn_score_16&#45;&gt;attn_weight_16</title>
<path fill="none" stroke="black" d="M3736,-911.87C3736,-903.89 3736,-894.93 3736,-886.38"/>
<polygon fill="black" stroke="black" points="3739.5,-886.25 3736,-876.25 3732.5,-886.25 3739.5,-886.25"/>
</g>
<!-- attn_context_16 -->
<g id="node202" class="node">
<title>attn_context_16</title>
<polygon fill="#ffe6e6" stroke="black" points="3829.5,-787 3642.5,-787 3642.5,-734 3829.5,-734 3829.5,-787"/>
<text text-anchor="middle" x="3736" y="-771.8" font-family="Arial" font-size="14.00">Context</text>
<text text-anchor="middle" x="3736" y="-756.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3736" y="-741.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_weight_16&#45;&gt;attn_context_16 -->
<g id="edge216" class="edge">
<title>attn_weight_16&#45;&gt;attn_context_16</title>
<path fill="none" stroke="black" d="M3736,-822.87C3736,-814.89 3736,-805.93 3736,-797.38"/>
<polygon fill="black" stroke="black" points="3739.5,-797.25 3736,-787.25 3732.5,-797.25 3739.5,-797.25"/>
</g>
<!-- attn_out_16 -->
<g id="node203" class="node">
<title>attn_out_16</title>
<polygon fill="#ffe6e6" stroke="black" points="3925.5,-687 3546.5,-687 3546.5,-634 3925.5,-634 3925.5,-687"/>
<text text-anchor="middle" x="3736" y="-671.8" font-family="Arial" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="3736" y="-656.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3736" y="-641.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- attn_context_16&#45;&gt;attn_out_16 -->
<g id="edge217" class="edge">
<title>attn_context_16&#45;&gt;attn_out_16</title>
<path fill="none" stroke="black" d="M3736,-733.75C3736,-722.61 3736,-709.38 3736,-697.31"/>
<polygon fill="black" stroke="black" points="3739.5,-697.08 3736,-687.08 3732.5,-697.08 3739.5,-697.08"/>
</g>
<!-- attn_out_16&#45;&gt;residual1_16 -->
<g id="edge218" class="edge">
<title>attn_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M3691.33,-633.75C3669.18,-620.98 3642.26,-605.46 3619.06,-592.09"/>
<polygon fill="black" stroke="black" points="3620.78,-589.04 3610.37,-587.08 3617.28,-595.1 3620.78,-589.04"/>
</g>
<!-- ffn_up_16 -->
<g id="node206" class="node">
<title>ffn_up_16</title>
<polygon fill="#e6ffe6" stroke="black" points="3650,-409 3258,-409 3258,-356 3650,-356 3650,-409"/>
<text text-anchor="middle" x="3454" y="-393.8" font-family="Arial" font-size="14.00">FFN Up</text>
<text text-anchor="middle" x="3454" y="-378.8" font-family="Arial" font-size="14.00">[1024, seq_len, hidden_dim] → [1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="3454" y="-363.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- ln2_16&#45;&gt;ffn_up_16 -->
<g id="edge221" class="edge">
<title>ln2_16&#45;&gt;ffn_up_16</title>
<path fill="none" stroke="black" d="M3490.68,-444.87C3485.65,-436.45 3479.97,-426.95 3474.61,-417.98"/>
<polygon fill="black" stroke="black" points="3477.53,-416.04 3469.39,-409.25 3471.52,-419.63 3477.53,-416.04"/>
</g>
<!-- output -->
<g id="node209" class="node">
<title>output</title>
<polygon fill="#fff0e6" stroke="black" points="3680,-53 3452,-53 3452,0 3680,0 3680,-53"/>
<text text-anchor="middle" x="3566" y="-37.8" font-family="Arial" font-size="14.00">Output</text>
<text text-anchor="middle" x="3566" y="-22.8" font-family="Arial" font-size="14.00">[batch=1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3566" y="-7.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- residual2_16&#45;&gt;output -->
<g id="edge225" class="edge">
<title>residual2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3566,-88.87C3566,-80.89 3566,-71.93 3566,-63.38"/>
<polygon fill="black" stroke="black" points="3569.5,-63.25 3566,-53.25 3562.5,-63.25 3569.5,-63.25"/>
</g>
<!-- ffn_act_16 -->
<g id="node207" class="node">
<title>ffn_act_16</title>
<polygon fill="#e6ffe6" stroke="black" points="3554,-320 3354,-320 3354,-267 3554,-267 3554,-320"/>
<text text-anchor="middle" x="3454" y="-304.8" font-family="Arial" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="3454" y="-289.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim]</text>
<text text-anchor="middle" x="3454" y="-274.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn_up_16&#45;&gt;ffn_act_16 -->
<g id="edge222" class="edge">
<title>ffn_up_16&#45;&gt;ffn_act_16</title>
<path fill="none" stroke="black" d="M3454,-355.87C3454,-347.89 3454,-338.93 3454,-330.38"/>
<polygon fill="black" stroke="black" points="3457.5,-330.25 3454,-320.25 3450.5,-330.25 3457.5,-330.25"/>
</g>
<!-- ffn_down_16 -->
<g id="node208" class="node">
<title>ffn_down_16</title>
<polygon fill="#e6ffe6" stroke="black" points="3650,-231 3258,-231 3258,-178 3650,-178 3650,-231"/>
<text text-anchor="middle" x="3454" y="-215.8" font-family="Arial" font-size="14.00">FFN Down</text>
<text text-anchor="middle" x="3454" y="-200.8" font-family="Arial" font-size="14.00">[1024, seq_len, 4*hidden_dim] → [1024, seq_len, hidden_dim]</text>
<text text-anchor="middle" x="3454" y="-185.8" font-family="Arial" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn_act_16&#45;&gt;ffn_down_16 -->
<g id="edge223" class="edge">
<title>ffn_act_16&#45;&gt;ffn_down_16</title>
<path fill="none" stroke="black" d="M3454,-266.87C3454,-258.89 3454,-249.93 3454,-241.38"/>
<polygon fill="black" stroke="black" points="3457.5,-241.25 3454,-231.25 3450.5,-241.25 3457.5,-241.25"/>
</g>
<!-- ffn_down_16&#45;&gt;residual2_16 -->
<g id="edge224" class="edge">
<title>ffn_down_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M3487,-177.87C3498.85,-168.66 3512.38,-158.15 3524.84,-148.47"/>
<polygon fill="black" stroke="black" points="3527.1,-151.15 3532.85,-142.25 3522.81,-145.62 3527.1,-151.15"/>
</g>
</g>
</svg>
