<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Dense_Model_DAG Pages: 1 -->
<svg width="35pt" height="1440pt"
 viewBox="0.00 0.00 35.21 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.07 0.07) rotate(0) translate(4 19217.91)">
<title>Dense_Model_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-19217.91 466,-19217.91 466,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<path fill="lightgray" stroke="black" d="M20,-17968.95C20,-17968.95 442,-17968.95 442,-17968.95 448,-17968.95 454,-17974.95 454,-17980.95 454,-17980.95 454,-19099.95 454,-19099.95 454,-19105.95 448,-19111.95 442,-19111.95 442,-19111.95 20,-19111.95 20,-19111.95 14,-19111.95 8,-19105.95 8,-19099.95 8,-19099.95 8,-17980.95 8,-17980.95 8,-17974.95 14,-17968.95 20,-17968.95"/>
<text text-anchor="middle" x="231" y="-19096.75" font-family="Times,serif" font-size="14.00">Layer 0 (GPU 0)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1</title>
<path fill="lightgray" stroke="black" d="M20,-16777.95C20,-16777.95 442,-16777.95 442,-16777.95 448,-16777.95 454,-16783.95 454,-16789.95 454,-16789.95 454,-17908.95 454,-17908.95 454,-17914.95 448,-17920.95 442,-17920.95 442,-17920.95 20,-17920.95 20,-17920.95 14,-17920.95 8,-17914.95 8,-17908.95 8,-17908.95 8,-16789.95 8,-16789.95 8,-16783.95 14,-16777.95 20,-16777.95"/>
<text text-anchor="middle" x="231" y="-17905.75" font-family="Times,serif" font-size="14.00">Layer 1 (GPU 1)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2</title>
<path fill="lightgray" stroke="black" d="M20,-15586.95C20,-15586.95 442,-15586.95 442,-15586.95 448,-15586.95 454,-15592.95 454,-15598.95 454,-15598.95 454,-16717.95 454,-16717.95 454,-16723.95 448,-16729.95 442,-16729.95 442,-16729.95 20,-16729.95 20,-16729.95 14,-16729.95 8,-16723.95 8,-16717.95 8,-16717.95 8,-15598.95 8,-15598.95 8,-15592.95 14,-15586.95 20,-15586.95"/>
<text text-anchor="middle" x="231" y="-16714.75" font-family="Times,serif" font-size="14.00">Layer 2 (GPU 2)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3</title>
<path fill="lightgray" stroke="black" d="M20,-14395.95C20,-14395.95 442,-14395.95 442,-14395.95 448,-14395.95 454,-14401.95 454,-14407.95 454,-14407.95 454,-15526.95 454,-15526.95 454,-15532.95 448,-15538.95 442,-15538.95 442,-15538.95 20,-15538.95 20,-15538.95 14,-15538.95 8,-15532.95 8,-15526.95 8,-15526.95 8,-14407.95 8,-14407.95 8,-14401.95 14,-14395.95 20,-14395.95"/>
<text text-anchor="middle" x="231" y="-15523.75" font-family="Times,serif" font-size="14.00">Layer 3 (GPU 3)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_4</title>
<path fill="lightgray" stroke="black" d="M20,-13204.95C20,-13204.95 442,-13204.95 442,-13204.95 448,-13204.95 454,-13210.95 454,-13216.95 454,-13216.95 454,-14335.95 454,-14335.95 454,-14341.95 448,-14347.95 442,-14347.95 442,-14347.95 20,-14347.95 20,-14347.95 14,-14347.95 8,-14341.95 8,-14335.95 8,-14335.95 8,-13216.95 8,-13216.95 8,-13210.95 14,-13204.95 20,-13204.95"/>
<text text-anchor="middle" x="231" y="-14332.75" font-family="Times,serif" font-size="14.00">Layer 4 (GPU 4)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_5</title>
<path fill="lightgray" stroke="black" d="M20,-12013.95C20,-12013.95 442,-12013.95 442,-12013.95 448,-12013.95 454,-12019.95 454,-12025.95 454,-12025.95 454,-13144.95 454,-13144.95 454,-13150.95 448,-13156.95 442,-13156.95 442,-13156.95 20,-13156.95 20,-13156.95 14,-13156.95 8,-13150.95 8,-13144.95 8,-13144.95 8,-12025.95 8,-12025.95 8,-12019.95 14,-12013.95 20,-12013.95"/>
<text text-anchor="middle" x="231" y="-13141.75" font-family="Times,serif" font-size="14.00">Layer 5 (GPU 5)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_6</title>
<path fill="lightgray" stroke="black" d="M20,-10822.95C20,-10822.95 442,-10822.95 442,-10822.95 448,-10822.95 454,-10828.95 454,-10834.95 454,-10834.95 454,-11953.95 454,-11953.95 454,-11959.95 448,-11965.95 442,-11965.95 442,-11965.95 20,-11965.95 20,-11965.95 14,-11965.95 8,-11959.95 8,-11953.95 8,-11953.95 8,-10834.95 8,-10834.95 8,-10828.95 14,-10822.95 20,-10822.95"/>
<text text-anchor="middle" x="231" y="-11950.75" font-family="Times,serif" font-size="14.00">Layer 6 (GPU 6)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer_7</title>
<path fill="lightgray" stroke="black" d="M20,-9631.95C20,-9631.95 442,-9631.95 442,-9631.95 448,-9631.95 454,-9637.95 454,-9643.95 454,-9643.95 454,-10762.95 454,-10762.95 454,-10768.95 448,-10774.95 442,-10774.95 442,-10774.95 20,-10774.95 20,-10774.95 14,-10774.95 8,-10768.95 8,-10762.95 8,-10762.95 8,-9643.95 8,-9643.95 8,-9637.95 14,-9631.95 20,-9631.95"/>
<text text-anchor="middle" x="231" y="-10759.75" font-family="Times,serif" font-size="14.00">Layer 7 (GPU 7)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer_8</title>
<path fill="lightgray" stroke="black" d="M20,-8440.95C20,-8440.95 442,-8440.95 442,-8440.95 448,-8440.95 454,-8446.95 454,-8452.95 454,-8452.95 454,-9571.95 454,-9571.95 454,-9577.95 448,-9583.95 442,-9583.95 442,-9583.95 20,-9583.95 20,-9583.95 14,-9583.95 8,-9577.95 8,-9571.95 8,-9571.95 8,-8452.95 8,-8452.95 8,-8446.95 14,-8440.95 20,-8440.95"/>
<text text-anchor="middle" x="231" y="-9568.75" font-family="Times,serif" font-size="14.00">Layer 8 (GPU 8)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_9</title>
<path fill="lightgray" stroke="black" d="M20,-7249.95C20,-7249.95 442,-7249.95 442,-7249.95 448,-7249.95 454,-7255.95 454,-7261.95 454,-7261.95 454,-8380.95 454,-8380.95 454,-8386.95 448,-8392.95 442,-8392.95 442,-8392.95 20,-8392.95 20,-8392.95 14,-8392.95 8,-8386.95 8,-8380.95 8,-8380.95 8,-7261.95 8,-7261.95 8,-7255.95 14,-7249.95 20,-7249.95"/>
<text text-anchor="middle" x="231" y="-8377.75" font-family="Times,serif" font-size="14.00">Layer 9 (GPU 9)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_10</title>
<path fill="lightgray" stroke="black" d="M20,-6058.95C20,-6058.95 442,-6058.95 442,-6058.95 448,-6058.95 454,-6064.95 454,-6070.95 454,-6070.95 454,-7189.95 454,-7189.95 454,-7195.95 448,-7201.95 442,-7201.95 442,-7201.95 20,-7201.95 20,-7201.95 14,-7201.95 8,-7195.95 8,-7189.95 8,-7189.95 8,-6070.95 8,-6070.95 8,-6064.95 14,-6058.95 20,-6058.95"/>
<text text-anchor="middle" x="231" y="-7186.75" font-family="Times,serif" font-size="14.00">Layer 10 (GPU 10)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer_11</title>
<path fill="lightgray" stroke="black" d="M20,-4867.95C20,-4867.95 442,-4867.95 442,-4867.95 448,-4867.95 454,-4873.95 454,-4879.95 454,-4879.95 454,-5998.95 454,-5998.95 454,-6004.95 448,-6010.95 442,-6010.95 442,-6010.95 20,-6010.95 20,-6010.95 14,-6010.95 8,-6004.95 8,-5998.95 8,-5998.95 8,-4879.95 8,-4879.95 8,-4873.95 14,-4867.95 20,-4867.95"/>
<text text-anchor="middle" x="231" y="-5995.75" font-family="Times,serif" font-size="14.00">Layer 11 (GPU 11)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer_12</title>
<path fill="lightgray" stroke="black" d="M20,-3676.95C20,-3676.95 442,-3676.95 442,-3676.95 448,-3676.95 454,-3682.95 454,-3688.95 454,-3688.95 454,-4807.95 454,-4807.95 454,-4813.95 448,-4819.95 442,-4819.95 442,-4819.95 20,-4819.95 20,-4819.95 14,-4819.95 8,-4813.95 8,-4807.95 8,-4807.95 8,-3688.95 8,-3688.95 8,-3682.95 14,-3676.95 20,-3676.95"/>
<text text-anchor="middle" x="231" y="-4804.75" font-family="Times,serif" font-size="14.00">Layer 12 (GPU 12)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer_13</title>
<path fill="lightgray" stroke="black" d="M20,-2485.95C20,-2485.95 442,-2485.95 442,-2485.95 448,-2485.95 454,-2491.95 454,-2497.95 454,-2497.95 454,-3616.95 454,-3616.95 454,-3622.95 448,-3628.95 442,-3628.95 442,-3628.95 20,-3628.95 20,-3628.95 14,-3628.95 8,-3622.95 8,-3616.95 8,-3616.95 8,-2497.95 8,-2497.95 8,-2491.95 14,-2485.95 20,-2485.95"/>
<text text-anchor="middle" x="231" y="-3613.75" font-family="Times,serif" font-size="14.00">Layer 13 (GPU 13)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer_14</title>
<path fill="lightgray" stroke="black" d="M20,-1294.95C20,-1294.95 442,-1294.95 442,-1294.95 448,-1294.95 454,-1300.95 454,-1306.95 454,-1306.95 454,-2425.95 454,-2425.95 454,-2431.95 448,-2437.95 442,-2437.95 442,-2437.95 20,-2437.95 20,-2437.95 14,-2437.95 8,-2431.95 8,-2425.95 8,-2425.95 8,-1306.95 8,-1306.95 8,-1300.95 14,-1294.95 20,-1294.95"/>
<text text-anchor="middle" x="231" y="-2422.75" font-family="Times,serif" font-size="14.00">Layer 14 (GPU 14)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer_15</title>
<path fill="lightgray" stroke="black" d="M20,-103.95C20,-103.95 442,-103.95 442,-103.95 448,-103.95 454,-109.95 454,-115.95 454,-115.95 454,-1234.95 454,-1234.95 454,-1240.95 448,-1246.95 442,-1246.95 442,-1246.95 20,-1246.95 20,-1246.95 14,-1246.95 8,-1240.95 8,-1234.95 8,-1234.95 8,-115.95 8,-115.95 8,-109.95 14,-103.95 20,-103.95"/>
<text text-anchor="middle" x="231" y="-1231.75" font-family="Times,serif" font-size="14.00">Layer 15 (GPU 15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="231" cy="-19176.43" rx="200.22" ry="37.45"/>
<text text-anchor="middle" x="231" y="-19187.73" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="231" y="-19172.73" font-family="Times,serif" font-size="14.00">[batch=1024, seq_len, hidden=8192]</text>
<text text-anchor="middle" x="231" y="-19157.73" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- ln1_0 -->
<g id="node2" class="node">
<title>ln1_0</title>
<polygon fill="none" stroke="black" points="316,-19080.95 146,-19080.95 146,-19027.95 316,-19027.95 316,-19080.95"/>
<text text-anchor="middle" x="231" y="-19065.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-19050.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-19035.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- input&#45;&gt;ln1_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_0</title>
<path fill="none" stroke="black" d="M231,-19138.78C231,-19123.81 231,-19106.54 231,-19091.62"/>
<polygon fill="black" stroke="black" points="234.5,-19091.23 231,-19081.23 227.5,-19091.23 234.5,-19091.23"/>
</g>
<!-- qkv_proj_0 -->
<g id="node3" class="node">
<title>qkv_proj_0</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-18990.95 16.5,-18990.95 16.5,-18907.95 445.5,-18907.95 445.5,-18990.95"/>
<text text-anchor="middle" x="231" y="-18975.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-18960.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-18945.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-18930.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="231" y="-18915.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_0&#45;&gt;qkv_proj_0 -->
<g id="edge2" class="edge">
<title>ln1_0&#45;&gt;qkv_proj_0</title>
<path fill="none" stroke="black" d="M231,-19027.73C231,-19019.68 231,-19010.49 231,-19001.33"/>
<polygon fill="black" stroke="black" points="234.5,-19001.06 231,-18991.06 227.5,-19001.06 234.5,-19001.06"/>
</g>
<!-- mha_0 -->
<g id="node4" class="node">
<title>mha_0</title>
<polygon fill="none" stroke="black" points="406,-18870.95 56,-18870.95 56,-18802.95 406,-18802.95 406,-18870.95"/>
<text text-anchor="middle" x="231" y="-18855.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-18840.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-18825.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-18810.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- qkv_proj_0&#45;&gt;mha_0 -->
<g id="edge3" class="edge">
<title>qkv_proj_0&#45;&gt;mha_0</title>
<path fill="none" stroke="black" d="M231,-18907.93C231,-18899.26 231,-18890.06 231,-18881.28"/>
<polygon fill="black" stroke="black" points="234.5,-18881.22 231,-18871.22 227.5,-18881.22 234.5,-18881.22"/>
</g>
<!-- out_proj_0 -->
<g id="node5" class="node">
<title>out_proj_0</title>
<polygon fill="lightyellow" stroke="black" points="406,-18765.95 56,-18765.95 56,-18682.95 406,-18682.95 406,-18765.95"/>
<text text-anchor="middle" x="231" y="-18750.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-18735.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-18720.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-18705.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="231" y="-18690.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_0&#45;&gt;out_proj_0 -->
<g id="edge4" class="edge">
<title>mha_0&#45;&gt;out_proj_0</title>
<path fill="none" stroke="black" d="M231,-18802.8C231,-18794.39 231,-18785.17 231,-18776.11"/>
<polygon fill="black" stroke="black" points="234.5,-18776.01 231,-18766.01 227.5,-18776.01 234.5,-18776.01"/>
</g>
<!-- residual1_0 -->
<g id="node6" class="node">
<title>residual1_0</title>
<polygon fill="none" stroke="black" points="231,-18645.95 61,-18592.95 231,-18539.95 401,-18592.95 231,-18645.95"/>
<text text-anchor="middle" x="231" y="-18604.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-18589.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-18574.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- out_proj_0&#45;&gt;residual1_0 -->
<g id="edge5" class="edge">
<title>out_proj_0&#45;&gt;residual1_0</title>
<path fill="none" stroke="black" d="M231,-18682.83C231,-18674.43 231,-18665.39 231,-18656.4"/>
<polygon fill="black" stroke="black" points="234.5,-18656.33 231,-18646.33 227.5,-18656.33 234.5,-18656.33"/>
</g>
<!-- ln2_0 -->
<g id="node7" class="node">
<title>ln2_0</title>
<polygon fill="none" stroke="black" points="316,-18502.95 146,-18502.95 146,-18449.95 316,-18449.95 316,-18502.95"/>
<text text-anchor="middle" x="231" y="-18487.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-18472.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-18457.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- residual1_0&#45;&gt;ln2_0 -->
<g id="edge6" class="edge">
<title>residual1_0&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M231,-18539.73C231,-18530.77 231,-18521.65 231,-18513.25"/>
<polygon fill="black" stroke="black" points="234.5,-18513.06 231,-18503.06 227.5,-18513.06 234.5,-18513.06"/>
</g>
<!-- ffn1_0 -->
<g id="node8" class="node">
<title>ffn1_0</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-18412.95 16.5,-18412.95 16.5,-18329.95 445.5,-18329.95 445.5,-18412.95"/>
<text text-anchor="middle" x="231" y="-18397.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-18382.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-18367.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-18352.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="231" y="-18337.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_0&#45;&gt;ffn1_0 -->
<g id="edge7" class="edge">
<title>ln2_0&#45;&gt;ffn1_0</title>
<path fill="none" stroke="black" d="M231,-18449.73C231,-18441.68 231,-18432.49 231,-18423.33"/>
<polygon fill="black" stroke="black" points="234.5,-18423.06 231,-18413.06 227.5,-18423.06 234.5,-18423.06"/>
</g>
<!-- gelu_0 -->
<g id="node9" class="node">
<title>gelu_0</title>
<polygon fill="none" stroke="black" points="316,-18292.95 146,-18292.95 146,-18239.95 316,-18239.95 316,-18292.95"/>
<text text-anchor="middle" x="231" y="-18277.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-18262.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-18247.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn1_0&#45;&gt;gelu_0 -->
<g id="edge8" class="edge">
<title>ffn1_0&#45;&gt;gelu_0</title>
<path fill="none" stroke="black" d="M231,-18329.74C231,-18320.95 231,-18311.72 231,-18303.13"/>
<polygon fill="black" stroke="black" points="234.5,-18303.05 231,-18293.05 227.5,-18303.05 234.5,-18303.05"/>
</g>
<!-- ffn2_0 -->
<g id="node10" class="node">
<title>ffn2_0</title>
<polygon fill="lightyellow" stroke="black" points="406,-18202.95 56,-18202.95 56,-18119.95 406,-18119.95 406,-18202.95"/>
<text text-anchor="middle" x="231" y="-18187.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-18172.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-18157.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-18142.75" font-family="Times,serif" font-size="14.00">GPU: 0</text>
<text text-anchor="middle" x="231" y="-18127.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_0&#45;&gt;ffn2_0 -->
<g id="edge9" class="edge">
<title>gelu_0&#45;&gt;ffn2_0</title>
<path fill="none" stroke="black" d="M231,-18239.73C231,-18231.68 231,-18222.49 231,-18213.33"/>
<polygon fill="black" stroke="black" points="234.5,-18213.06 231,-18203.06 227.5,-18213.06 234.5,-18213.06"/>
</g>
<!-- residual2_0 -->
<g id="node11" class="node">
<title>residual2_0</title>
<polygon fill="none" stroke="black" points="231,-18082.95 61,-18029.95 231,-17976.95 401,-18029.95 231,-18082.95"/>
<text text-anchor="middle" x="231" y="-18041.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-18026.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-18011.25" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn2_0&#45;&gt;residual2_0 -->
<g id="edge10" class="edge">
<title>ffn2_0&#45;&gt;residual2_0</title>
<path fill="none" stroke="black" d="M231,-18119.83C231,-18111.43 231,-18102.39 231,-18093.4"/>
<polygon fill="black" stroke="black" points="234.5,-18093.33 231,-18083.33 227.5,-18093.33 234.5,-18093.33"/>
</g>
<!-- ln1_1 -->
<g id="node12" class="node">
<title>ln1_1</title>
<polygon fill="none" stroke="black" points="316,-17889.95 146,-17889.95 146,-17836.95 316,-17836.95 316,-17889.95"/>
<text text-anchor="middle" x="231" y="-17874.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-17859.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-17844.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- residual2_0&#45;&gt;ln1_1 -->
<g id="edge146" class="edge">
<title>residual2_0&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-17976.9C231,-17951.88 231,-17922.52 231,-17900.07"/>
<polygon fill="black" stroke="black" points="234.5,-17899.98 231,-17889.98 227.5,-17899.98 234.5,-17899.98"/>
<text text-anchor="middle" x="290" y="-17947.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-17932.75" font-family="Times,serif" font-size="14.00">GPU 0 &#45;&gt; GPU 1</text>
</g>
<!-- qkv_proj_1 -->
<g id="node13" class="node">
<title>qkv_proj_1</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-17799.95 16.5,-17799.95 16.5,-17716.95 445.5,-17716.95 445.5,-17799.95"/>
<text text-anchor="middle" x="231" y="-17784.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-17769.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-17754.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-17739.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="231" y="-17724.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_1&#45;&gt;qkv_proj_1 -->
<g id="edge11" class="edge">
<title>ln1_1&#45;&gt;qkv_proj_1</title>
<path fill="none" stroke="black" d="M231,-17836.73C231,-17828.68 231,-17819.49 231,-17810.33"/>
<polygon fill="black" stroke="black" points="234.5,-17810.06 231,-17800.06 227.5,-17810.06 234.5,-17810.06"/>
</g>
<!-- mha_1 -->
<g id="node14" class="node">
<title>mha_1</title>
<polygon fill="none" stroke="black" points="406,-17679.95 56,-17679.95 56,-17611.95 406,-17611.95 406,-17679.95"/>
<text text-anchor="middle" x="231" y="-17664.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-17649.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-17634.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-17619.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- qkv_proj_1&#45;&gt;mha_1 -->
<g id="edge12" class="edge">
<title>qkv_proj_1&#45;&gt;mha_1</title>
<path fill="none" stroke="black" d="M231,-17716.93C231,-17708.26 231,-17699.06 231,-17690.28"/>
<polygon fill="black" stroke="black" points="234.5,-17690.22 231,-17680.22 227.5,-17690.22 234.5,-17690.22"/>
</g>
<!-- out_proj_1 -->
<g id="node15" class="node">
<title>out_proj_1</title>
<polygon fill="lightyellow" stroke="black" points="406,-17574.95 56,-17574.95 56,-17491.95 406,-17491.95 406,-17574.95"/>
<text text-anchor="middle" x="231" y="-17559.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-17544.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-17529.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-17514.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="231" y="-17499.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_1&#45;&gt;out_proj_1 -->
<g id="edge13" class="edge">
<title>mha_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M231,-17611.8C231,-17603.39 231,-17594.17 231,-17585.11"/>
<polygon fill="black" stroke="black" points="234.5,-17585.01 231,-17575.01 227.5,-17585.01 234.5,-17585.01"/>
</g>
<!-- residual1_1 -->
<g id="node16" class="node">
<title>residual1_1</title>
<polygon fill="none" stroke="black" points="231,-17454.95 61,-17401.95 231,-17348.95 401,-17401.95 231,-17454.95"/>
<text text-anchor="middle" x="231" y="-17413.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-17398.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-17383.25" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- out_proj_1&#45;&gt;residual1_1 -->
<g id="edge14" class="edge">
<title>out_proj_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M231,-17491.83C231,-17483.43 231,-17474.39 231,-17465.4"/>
<polygon fill="black" stroke="black" points="234.5,-17465.33 231,-17455.33 227.5,-17465.33 234.5,-17465.33"/>
</g>
<!-- ln2_1 -->
<g id="node17" class="node">
<title>ln2_1</title>
<polygon fill="none" stroke="black" points="316,-17311.95 146,-17311.95 146,-17258.95 316,-17258.95 316,-17311.95"/>
<text text-anchor="middle" x="231" y="-17296.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-17281.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-17266.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge15" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M231,-17348.73C231,-17339.77 231,-17330.65 231,-17322.25"/>
<polygon fill="black" stroke="black" points="234.5,-17322.06 231,-17312.06 227.5,-17322.06 234.5,-17322.06"/>
</g>
<!-- ffn1_1 -->
<g id="node18" class="node">
<title>ffn1_1</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-17221.95 16.5,-17221.95 16.5,-17138.95 445.5,-17138.95 445.5,-17221.95"/>
<text text-anchor="middle" x="231" y="-17206.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-17191.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-17176.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-17161.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="231" y="-17146.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_1&#45;&gt;ffn1_1 -->
<g id="edge16" class="edge">
<title>ln2_1&#45;&gt;ffn1_1</title>
<path fill="none" stroke="black" d="M231,-17258.73C231,-17250.68 231,-17241.49 231,-17232.33"/>
<polygon fill="black" stroke="black" points="234.5,-17232.06 231,-17222.06 227.5,-17232.06 234.5,-17232.06"/>
</g>
<!-- gelu_1 -->
<g id="node19" class="node">
<title>gelu_1</title>
<polygon fill="none" stroke="black" points="316,-17101.95 146,-17101.95 146,-17048.95 316,-17048.95 316,-17101.95"/>
<text text-anchor="middle" x="231" y="-17086.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-17071.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-17056.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn1_1&#45;&gt;gelu_1 -->
<g id="edge17" class="edge">
<title>ffn1_1&#45;&gt;gelu_1</title>
<path fill="none" stroke="black" d="M231,-17138.74C231,-17129.95 231,-17120.72 231,-17112.13"/>
<polygon fill="black" stroke="black" points="234.5,-17112.05 231,-17102.05 227.5,-17112.05 234.5,-17112.05"/>
</g>
<!-- ffn2_1 -->
<g id="node20" class="node">
<title>ffn2_1</title>
<polygon fill="lightyellow" stroke="black" points="406,-17011.95 56,-17011.95 56,-16928.95 406,-16928.95 406,-17011.95"/>
<text text-anchor="middle" x="231" y="-16996.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-16981.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-16966.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-16951.75" font-family="Times,serif" font-size="14.00">GPU: 1</text>
<text text-anchor="middle" x="231" y="-16936.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_1&#45;&gt;ffn2_1 -->
<g id="edge18" class="edge">
<title>gelu_1&#45;&gt;ffn2_1</title>
<path fill="none" stroke="black" d="M231,-17048.73C231,-17040.68 231,-17031.49 231,-17022.33"/>
<polygon fill="black" stroke="black" points="234.5,-17022.06 231,-17012.06 227.5,-17022.06 234.5,-17022.06"/>
</g>
<!-- residual2_1 -->
<g id="node21" class="node">
<title>residual2_1</title>
<polygon fill="none" stroke="black" points="231,-16891.95 61,-16838.95 231,-16785.95 401,-16838.95 231,-16891.95"/>
<text text-anchor="middle" x="231" y="-16850.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-16835.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-16820.25" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn2_1&#45;&gt;residual2_1 -->
<g id="edge19" class="edge">
<title>ffn2_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M231,-16928.83C231,-16920.43 231,-16911.39 231,-16902.4"/>
<polygon fill="black" stroke="black" points="234.5,-16902.33 231,-16892.33 227.5,-16902.33 234.5,-16902.33"/>
</g>
<!-- ln1_2 -->
<g id="node22" class="node">
<title>ln1_2</title>
<polygon fill="none" stroke="black" points="316,-16698.95 146,-16698.95 146,-16645.95 316,-16645.95 316,-16698.95"/>
<text text-anchor="middle" x="231" y="-16683.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-16668.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-16653.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- residual2_1&#45;&gt;ln1_2 -->
<g id="edge147" class="edge">
<title>residual2_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-16785.9C231,-16760.88 231,-16731.52 231,-16709.07"/>
<polygon fill="black" stroke="black" points="234.5,-16708.98 231,-16698.98 227.5,-16708.98 234.5,-16708.98"/>
<text text-anchor="middle" x="290" y="-16756.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-16741.75" font-family="Times,serif" font-size="14.00">GPU 1 &#45;&gt; GPU 2</text>
</g>
<!-- qkv_proj_2 -->
<g id="node23" class="node">
<title>qkv_proj_2</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-16608.95 16.5,-16608.95 16.5,-16525.95 445.5,-16525.95 445.5,-16608.95"/>
<text text-anchor="middle" x="231" y="-16593.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-16578.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-16563.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-16548.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="231" y="-16533.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_2&#45;&gt;qkv_proj_2 -->
<g id="edge20" class="edge">
<title>ln1_2&#45;&gt;qkv_proj_2</title>
<path fill="none" stroke="black" d="M231,-16645.73C231,-16637.68 231,-16628.49 231,-16619.33"/>
<polygon fill="black" stroke="black" points="234.5,-16619.06 231,-16609.06 227.5,-16619.06 234.5,-16619.06"/>
</g>
<!-- mha_2 -->
<g id="node24" class="node">
<title>mha_2</title>
<polygon fill="none" stroke="black" points="406,-16488.95 56,-16488.95 56,-16420.95 406,-16420.95 406,-16488.95"/>
<text text-anchor="middle" x="231" y="-16473.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-16458.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-16443.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-16428.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- qkv_proj_2&#45;&gt;mha_2 -->
<g id="edge21" class="edge">
<title>qkv_proj_2&#45;&gt;mha_2</title>
<path fill="none" stroke="black" d="M231,-16525.93C231,-16517.26 231,-16508.06 231,-16499.28"/>
<polygon fill="black" stroke="black" points="234.5,-16499.22 231,-16489.22 227.5,-16499.22 234.5,-16499.22"/>
</g>
<!-- out_proj_2 -->
<g id="node25" class="node">
<title>out_proj_2</title>
<polygon fill="lightyellow" stroke="black" points="406,-16383.95 56,-16383.95 56,-16300.95 406,-16300.95 406,-16383.95"/>
<text text-anchor="middle" x="231" y="-16368.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-16353.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-16338.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-16323.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="231" y="-16308.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_2&#45;&gt;out_proj_2 -->
<g id="edge22" class="edge">
<title>mha_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M231,-16420.8C231,-16412.39 231,-16403.17 231,-16394.11"/>
<polygon fill="black" stroke="black" points="234.5,-16394.01 231,-16384.01 227.5,-16394.01 234.5,-16394.01"/>
</g>
<!-- residual1_2 -->
<g id="node26" class="node">
<title>residual1_2</title>
<polygon fill="none" stroke="black" points="231,-16263.95 61,-16210.95 231,-16157.95 401,-16210.95 231,-16263.95"/>
<text text-anchor="middle" x="231" y="-16222.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-16207.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-16192.25" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- out_proj_2&#45;&gt;residual1_2 -->
<g id="edge23" class="edge">
<title>out_proj_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M231,-16300.83C231,-16292.43 231,-16283.39 231,-16274.4"/>
<polygon fill="black" stroke="black" points="234.5,-16274.33 231,-16264.33 227.5,-16274.33 234.5,-16274.33"/>
</g>
<!-- ln2_2 -->
<g id="node27" class="node">
<title>ln2_2</title>
<polygon fill="none" stroke="black" points="316,-16120.95 146,-16120.95 146,-16067.95 316,-16067.95 316,-16120.95"/>
<text text-anchor="middle" x="231" y="-16105.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-16090.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-16075.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge24" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M231,-16157.73C231,-16148.77 231,-16139.65 231,-16131.25"/>
<polygon fill="black" stroke="black" points="234.5,-16131.06 231,-16121.06 227.5,-16131.06 234.5,-16131.06"/>
</g>
<!-- ffn1_2 -->
<g id="node28" class="node">
<title>ffn1_2</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-16030.95 16.5,-16030.95 16.5,-15947.95 445.5,-15947.95 445.5,-16030.95"/>
<text text-anchor="middle" x="231" y="-16015.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-16000.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-15985.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-15970.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="231" y="-15955.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_2&#45;&gt;ffn1_2 -->
<g id="edge25" class="edge">
<title>ln2_2&#45;&gt;ffn1_2</title>
<path fill="none" stroke="black" d="M231,-16067.73C231,-16059.68 231,-16050.49 231,-16041.33"/>
<polygon fill="black" stroke="black" points="234.5,-16041.06 231,-16031.06 227.5,-16041.06 234.5,-16041.06"/>
</g>
<!-- gelu_2 -->
<g id="node29" class="node">
<title>gelu_2</title>
<polygon fill="none" stroke="black" points="316,-15910.95 146,-15910.95 146,-15857.95 316,-15857.95 316,-15910.95"/>
<text text-anchor="middle" x="231" y="-15895.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-15880.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-15865.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn1_2&#45;&gt;gelu_2 -->
<g id="edge26" class="edge">
<title>ffn1_2&#45;&gt;gelu_2</title>
<path fill="none" stroke="black" d="M231,-15947.74C231,-15938.95 231,-15929.72 231,-15921.13"/>
<polygon fill="black" stroke="black" points="234.5,-15921.05 231,-15911.05 227.5,-15921.05 234.5,-15921.05"/>
</g>
<!-- ffn2_2 -->
<g id="node30" class="node">
<title>ffn2_2</title>
<polygon fill="lightyellow" stroke="black" points="406,-15820.95 56,-15820.95 56,-15737.95 406,-15737.95 406,-15820.95"/>
<text text-anchor="middle" x="231" y="-15805.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-15790.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-15775.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-15760.75" font-family="Times,serif" font-size="14.00">GPU: 2</text>
<text text-anchor="middle" x="231" y="-15745.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_2&#45;&gt;ffn2_2 -->
<g id="edge27" class="edge">
<title>gelu_2&#45;&gt;ffn2_2</title>
<path fill="none" stroke="black" d="M231,-15857.73C231,-15849.68 231,-15840.49 231,-15831.33"/>
<polygon fill="black" stroke="black" points="234.5,-15831.06 231,-15821.06 227.5,-15831.06 234.5,-15831.06"/>
</g>
<!-- residual2_2 -->
<g id="node31" class="node">
<title>residual2_2</title>
<polygon fill="none" stroke="black" points="231,-15700.95 61,-15647.95 231,-15594.95 401,-15647.95 231,-15700.95"/>
<text text-anchor="middle" x="231" y="-15659.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-15644.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-15629.25" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn2_2&#45;&gt;residual2_2 -->
<g id="edge28" class="edge">
<title>ffn2_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M231,-15737.83C231,-15729.43 231,-15720.39 231,-15711.4"/>
<polygon fill="black" stroke="black" points="234.5,-15711.33 231,-15701.33 227.5,-15711.33 234.5,-15711.33"/>
</g>
<!-- ln1_3 -->
<g id="node32" class="node">
<title>ln1_3</title>
<polygon fill="none" stroke="black" points="316,-15507.95 146,-15507.95 146,-15454.95 316,-15454.95 316,-15507.95"/>
<text text-anchor="middle" x="231" y="-15492.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-15477.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-15462.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- residual2_2&#45;&gt;ln1_3 -->
<g id="edge148" class="edge">
<title>residual2_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-15594.9C231,-15569.88 231,-15540.52 231,-15518.07"/>
<polygon fill="black" stroke="black" points="234.5,-15517.98 231,-15507.98 227.5,-15517.98 234.5,-15517.98"/>
<text text-anchor="middle" x="290" y="-15565.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-15550.75" font-family="Times,serif" font-size="14.00">GPU 2 &#45;&gt; GPU 3</text>
</g>
<!-- qkv_proj_3 -->
<g id="node33" class="node">
<title>qkv_proj_3</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-15417.95 16.5,-15417.95 16.5,-15334.95 445.5,-15334.95 445.5,-15417.95"/>
<text text-anchor="middle" x="231" y="-15402.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-15387.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-15372.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-15357.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="231" y="-15342.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_3&#45;&gt;qkv_proj_3 -->
<g id="edge29" class="edge">
<title>ln1_3&#45;&gt;qkv_proj_3</title>
<path fill="none" stroke="black" d="M231,-15454.73C231,-15446.68 231,-15437.49 231,-15428.33"/>
<polygon fill="black" stroke="black" points="234.5,-15428.06 231,-15418.06 227.5,-15428.06 234.5,-15428.06"/>
</g>
<!-- mha_3 -->
<g id="node34" class="node">
<title>mha_3</title>
<polygon fill="none" stroke="black" points="406,-15297.95 56,-15297.95 56,-15229.95 406,-15229.95 406,-15297.95"/>
<text text-anchor="middle" x="231" y="-15282.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-15267.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-15252.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-15237.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- qkv_proj_3&#45;&gt;mha_3 -->
<g id="edge30" class="edge">
<title>qkv_proj_3&#45;&gt;mha_3</title>
<path fill="none" stroke="black" d="M231,-15334.93C231,-15326.26 231,-15317.06 231,-15308.28"/>
<polygon fill="black" stroke="black" points="234.5,-15308.22 231,-15298.22 227.5,-15308.22 234.5,-15308.22"/>
</g>
<!-- out_proj_3 -->
<g id="node35" class="node">
<title>out_proj_3</title>
<polygon fill="lightyellow" stroke="black" points="406,-15192.95 56,-15192.95 56,-15109.95 406,-15109.95 406,-15192.95"/>
<text text-anchor="middle" x="231" y="-15177.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-15162.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-15147.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-15132.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="231" y="-15117.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_3&#45;&gt;out_proj_3 -->
<g id="edge31" class="edge">
<title>mha_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M231,-15229.8C231,-15221.39 231,-15212.17 231,-15203.11"/>
<polygon fill="black" stroke="black" points="234.5,-15203.01 231,-15193.01 227.5,-15203.01 234.5,-15203.01"/>
</g>
<!-- residual1_3 -->
<g id="node36" class="node">
<title>residual1_3</title>
<polygon fill="none" stroke="black" points="231,-15072.95 61,-15019.95 231,-14966.95 401,-15019.95 231,-15072.95"/>
<text text-anchor="middle" x="231" y="-15031.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-15016.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-15001.25" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- out_proj_3&#45;&gt;residual1_3 -->
<g id="edge32" class="edge">
<title>out_proj_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M231,-15109.83C231,-15101.43 231,-15092.39 231,-15083.4"/>
<polygon fill="black" stroke="black" points="234.5,-15083.33 231,-15073.33 227.5,-15083.33 234.5,-15083.33"/>
</g>
<!-- ln2_3 -->
<g id="node37" class="node">
<title>ln2_3</title>
<polygon fill="none" stroke="black" points="316,-14929.95 146,-14929.95 146,-14876.95 316,-14876.95 316,-14929.95"/>
<text text-anchor="middle" x="231" y="-14914.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-14899.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-14884.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge33" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M231,-14966.73C231,-14957.77 231,-14948.65 231,-14940.25"/>
<polygon fill="black" stroke="black" points="234.5,-14940.06 231,-14930.06 227.5,-14940.06 234.5,-14940.06"/>
</g>
<!-- ffn1_3 -->
<g id="node38" class="node">
<title>ffn1_3</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-14839.95 16.5,-14839.95 16.5,-14756.95 445.5,-14756.95 445.5,-14839.95"/>
<text text-anchor="middle" x="231" y="-14824.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-14809.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-14794.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-14779.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="231" y="-14764.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_3&#45;&gt;ffn1_3 -->
<g id="edge34" class="edge">
<title>ln2_3&#45;&gt;ffn1_3</title>
<path fill="none" stroke="black" d="M231,-14876.73C231,-14868.68 231,-14859.49 231,-14850.33"/>
<polygon fill="black" stroke="black" points="234.5,-14850.06 231,-14840.06 227.5,-14850.06 234.5,-14850.06"/>
</g>
<!-- gelu_3 -->
<g id="node39" class="node">
<title>gelu_3</title>
<polygon fill="none" stroke="black" points="316,-14719.95 146,-14719.95 146,-14666.95 316,-14666.95 316,-14719.95"/>
<text text-anchor="middle" x="231" y="-14704.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-14689.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-14674.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn1_3&#45;&gt;gelu_3 -->
<g id="edge35" class="edge">
<title>ffn1_3&#45;&gt;gelu_3</title>
<path fill="none" stroke="black" d="M231,-14756.74C231,-14747.95 231,-14738.72 231,-14730.13"/>
<polygon fill="black" stroke="black" points="234.5,-14730.05 231,-14720.05 227.5,-14730.05 234.5,-14730.05"/>
</g>
<!-- ffn2_3 -->
<g id="node40" class="node">
<title>ffn2_3</title>
<polygon fill="lightyellow" stroke="black" points="406,-14629.95 56,-14629.95 56,-14546.95 406,-14546.95 406,-14629.95"/>
<text text-anchor="middle" x="231" y="-14614.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-14599.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-14584.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-14569.75" font-family="Times,serif" font-size="14.00">GPU: 3</text>
<text text-anchor="middle" x="231" y="-14554.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_3&#45;&gt;ffn2_3 -->
<g id="edge36" class="edge">
<title>gelu_3&#45;&gt;ffn2_3</title>
<path fill="none" stroke="black" d="M231,-14666.73C231,-14658.68 231,-14649.49 231,-14640.33"/>
<polygon fill="black" stroke="black" points="234.5,-14640.06 231,-14630.06 227.5,-14640.06 234.5,-14640.06"/>
</g>
<!-- residual2_3 -->
<g id="node41" class="node">
<title>residual2_3</title>
<polygon fill="none" stroke="black" points="231,-14509.95 61,-14456.95 231,-14403.95 401,-14456.95 231,-14509.95"/>
<text text-anchor="middle" x="231" y="-14468.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-14453.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-14438.25" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn2_3&#45;&gt;residual2_3 -->
<g id="edge37" class="edge">
<title>ffn2_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M231,-14546.83C231,-14538.43 231,-14529.39 231,-14520.4"/>
<polygon fill="black" stroke="black" points="234.5,-14520.33 231,-14510.33 227.5,-14520.33 234.5,-14520.33"/>
</g>
<!-- ln1_4 -->
<g id="node42" class="node">
<title>ln1_4</title>
<polygon fill="none" stroke="black" points="316,-14316.95 146,-14316.95 146,-14263.95 316,-14263.95 316,-14316.95"/>
<text text-anchor="middle" x="231" y="-14301.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-14286.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-14271.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- residual2_3&#45;&gt;ln1_4 -->
<g id="edge149" class="edge">
<title>residual2_3&#45;&gt;ln1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-14403.9C231,-14378.88 231,-14349.52 231,-14327.07"/>
<polygon fill="black" stroke="black" points="234.5,-14326.98 231,-14316.98 227.5,-14326.98 234.5,-14326.98"/>
<text text-anchor="middle" x="290" y="-14374.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-14359.75" font-family="Times,serif" font-size="14.00">GPU 3 &#45;&gt; GPU 4</text>
</g>
<!-- qkv_proj_4 -->
<g id="node43" class="node">
<title>qkv_proj_4</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-14226.95 16.5,-14226.95 16.5,-14143.95 445.5,-14143.95 445.5,-14226.95"/>
<text text-anchor="middle" x="231" y="-14211.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-14196.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-14181.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-14166.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="231" y="-14151.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_4&#45;&gt;qkv_proj_4 -->
<g id="edge38" class="edge">
<title>ln1_4&#45;&gt;qkv_proj_4</title>
<path fill="none" stroke="black" d="M231,-14263.73C231,-14255.68 231,-14246.49 231,-14237.33"/>
<polygon fill="black" stroke="black" points="234.5,-14237.06 231,-14227.06 227.5,-14237.06 234.5,-14237.06"/>
</g>
<!-- mha_4 -->
<g id="node44" class="node">
<title>mha_4</title>
<polygon fill="none" stroke="black" points="406,-14106.95 56,-14106.95 56,-14038.95 406,-14038.95 406,-14106.95"/>
<text text-anchor="middle" x="231" y="-14091.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-14076.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-14061.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-14046.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- qkv_proj_4&#45;&gt;mha_4 -->
<g id="edge39" class="edge">
<title>qkv_proj_4&#45;&gt;mha_4</title>
<path fill="none" stroke="black" d="M231,-14143.93C231,-14135.26 231,-14126.06 231,-14117.28"/>
<polygon fill="black" stroke="black" points="234.5,-14117.22 231,-14107.22 227.5,-14117.22 234.5,-14117.22"/>
</g>
<!-- out_proj_4 -->
<g id="node45" class="node">
<title>out_proj_4</title>
<polygon fill="lightyellow" stroke="black" points="406,-14001.95 56,-14001.95 56,-13918.95 406,-13918.95 406,-14001.95"/>
<text text-anchor="middle" x="231" y="-13986.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-13971.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-13956.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-13941.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="231" y="-13926.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_4&#45;&gt;out_proj_4 -->
<g id="edge40" class="edge">
<title>mha_4&#45;&gt;out_proj_4</title>
<path fill="none" stroke="black" d="M231,-14038.8C231,-14030.39 231,-14021.17 231,-14012.11"/>
<polygon fill="black" stroke="black" points="234.5,-14012.01 231,-14002.01 227.5,-14012.01 234.5,-14012.01"/>
</g>
<!-- residual1_4 -->
<g id="node46" class="node">
<title>residual1_4</title>
<polygon fill="none" stroke="black" points="231,-13881.95 61,-13828.95 231,-13775.95 401,-13828.95 231,-13881.95"/>
<text text-anchor="middle" x="231" y="-13840.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-13825.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-13810.25" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- out_proj_4&#45;&gt;residual1_4 -->
<g id="edge41" class="edge">
<title>out_proj_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M231,-13918.83C231,-13910.43 231,-13901.39 231,-13892.4"/>
<polygon fill="black" stroke="black" points="234.5,-13892.33 231,-13882.33 227.5,-13892.33 234.5,-13892.33"/>
</g>
<!-- ln2_4 -->
<g id="node47" class="node">
<title>ln2_4</title>
<polygon fill="none" stroke="black" points="316,-13738.95 146,-13738.95 146,-13685.95 316,-13685.95 316,-13738.95"/>
<text text-anchor="middle" x="231" y="-13723.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-13708.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-13693.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge42" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M231,-13775.73C231,-13766.77 231,-13757.65 231,-13749.25"/>
<polygon fill="black" stroke="black" points="234.5,-13749.06 231,-13739.06 227.5,-13749.06 234.5,-13749.06"/>
</g>
<!-- ffn1_4 -->
<g id="node48" class="node">
<title>ffn1_4</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-13648.95 16.5,-13648.95 16.5,-13565.95 445.5,-13565.95 445.5,-13648.95"/>
<text text-anchor="middle" x="231" y="-13633.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-13618.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-13603.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-13588.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="231" y="-13573.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_4&#45;&gt;ffn1_4 -->
<g id="edge43" class="edge">
<title>ln2_4&#45;&gt;ffn1_4</title>
<path fill="none" stroke="black" d="M231,-13685.73C231,-13677.68 231,-13668.49 231,-13659.33"/>
<polygon fill="black" stroke="black" points="234.5,-13659.06 231,-13649.06 227.5,-13659.06 234.5,-13659.06"/>
</g>
<!-- gelu_4 -->
<g id="node49" class="node">
<title>gelu_4</title>
<polygon fill="none" stroke="black" points="316,-13528.95 146,-13528.95 146,-13475.95 316,-13475.95 316,-13528.95"/>
<text text-anchor="middle" x="231" y="-13513.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-13498.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-13483.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn1_4&#45;&gt;gelu_4 -->
<g id="edge44" class="edge">
<title>ffn1_4&#45;&gt;gelu_4</title>
<path fill="none" stroke="black" d="M231,-13565.74C231,-13556.95 231,-13547.72 231,-13539.13"/>
<polygon fill="black" stroke="black" points="234.5,-13539.05 231,-13529.05 227.5,-13539.05 234.5,-13539.05"/>
</g>
<!-- ffn2_4 -->
<g id="node50" class="node">
<title>ffn2_4</title>
<polygon fill="lightyellow" stroke="black" points="406,-13438.95 56,-13438.95 56,-13355.95 406,-13355.95 406,-13438.95"/>
<text text-anchor="middle" x="231" y="-13423.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-13408.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-13393.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-13378.75" font-family="Times,serif" font-size="14.00">GPU: 4</text>
<text text-anchor="middle" x="231" y="-13363.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_4&#45;&gt;ffn2_4 -->
<g id="edge45" class="edge">
<title>gelu_4&#45;&gt;ffn2_4</title>
<path fill="none" stroke="black" d="M231,-13475.73C231,-13467.68 231,-13458.49 231,-13449.33"/>
<polygon fill="black" stroke="black" points="234.5,-13449.06 231,-13439.06 227.5,-13449.06 234.5,-13449.06"/>
</g>
<!-- residual2_4 -->
<g id="node51" class="node">
<title>residual2_4</title>
<polygon fill="none" stroke="black" points="231,-13318.95 61,-13265.95 231,-13212.95 401,-13265.95 231,-13318.95"/>
<text text-anchor="middle" x="231" y="-13277.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-13262.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-13247.25" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn2_4&#45;&gt;residual2_4 -->
<g id="edge46" class="edge">
<title>ffn2_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M231,-13355.83C231,-13347.43 231,-13338.39 231,-13329.4"/>
<polygon fill="black" stroke="black" points="234.5,-13329.33 231,-13319.33 227.5,-13329.33 234.5,-13329.33"/>
</g>
<!-- ln1_5 -->
<g id="node52" class="node">
<title>ln1_5</title>
<polygon fill="none" stroke="black" points="316,-13125.95 146,-13125.95 146,-13072.95 316,-13072.95 316,-13125.95"/>
<text text-anchor="middle" x="231" y="-13110.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-13095.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-13080.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- residual2_4&#45;&gt;ln1_5 -->
<g id="edge150" class="edge">
<title>residual2_4&#45;&gt;ln1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-13212.9C231,-13187.88 231,-13158.52 231,-13136.07"/>
<polygon fill="black" stroke="black" points="234.5,-13135.98 231,-13125.98 227.5,-13135.98 234.5,-13135.98"/>
<text text-anchor="middle" x="290" y="-13183.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-13168.75" font-family="Times,serif" font-size="14.00">GPU 4 &#45;&gt; GPU 5</text>
</g>
<!-- qkv_proj_5 -->
<g id="node53" class="node">
<title>qkv_proj_5</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-13035.95 16.5,-13035.95 16.5,-12952.95 445.5,-12952.95 445.5,-13035.95"/>
<text text-anchor="middle" x="231" y="-13020.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-13005.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-12990.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-12975.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="231" y="-12960.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_5&#45;&gt;qkv_proj_5 -->
<g id="edge47" class="edge">
<title>ln1_5&#45;&gt;qkv_proj_5</title>
<path fill="none" stroke="black" d="M231,-13072.73C231,-13064.68 231,-13055.49 231,-13046.33"/>
<polygon fill="black" stroke="black" points="234.5,-13046.06 231,-13036.06 227.5,-13046.06 234.5,-13046.06"/>
</g>
<!-- mha_5 -->
<g id="node54" class="node">
<title>mha_5</title>
<polygon fill="none" stroke="black" points="406,-12915.95 56,-12915.95 56,-12847.95 406,-12847.95 406,-12915.95"/>
<text text-anchor="middle" x="231" y="-12900.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-12885.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-12870.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-12855.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- qkv_proj_5&#45;&gt;mha_5 -->
<g id="edge48" class="edge">
<title>qkv_proj_5&#45;&gt;mha_5</title>
<path fill="none" stroke="black" d="M231,-12952.93C231,-12944.26 231,-12935.06 231,-12926.28"/>
<polygon fill="black" stroke="black" points="234.5,-12926.22 231,-12916.22 227.5,-12926.22 234.5,-12926.22"/>
</g>
<!-- out_proj_5 -->
<g id="node55" class="node">
<title>out_proj_5</title>
<polygon fill="lightyellow" stroke="black" points="406,-12810.95 56,-12810.95 56,-12727.95 406,-12727.95 406,-12810.95"/>
<text text-anchor="middle" x="231" y="-12795.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-12780.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-12765.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-12750.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="231" y="-12735.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_5&#45;&gt;out_proj_5 -->
<g id="edge49" class="edge">
<title>mha_5&#45;&gt;out_proj_5</title>
<path fill="none" stroke="black" d="M231,-12847.8C231,-12839.39 231,-12830.17 231,-12821.11"/>
<polygon fill="black" stroke="black" points="234.5,-12821.01 231,-12811.01 227.5,-12821.01 234.5,-12821.01"/>
</g>
<!-- residual1_5 -->
<g id="node56" class="node">
<title>residual1_5</title>
<polygon fill="none" stroke="black" points="231,-12690.95 61,-12637.95 231,-12584.95 401,-12637.95 231,-12690.95"/>
<text text-anchor="middle" x="231" y="-12649.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-12634.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-12619.25" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- out_proj_5&#45;&gt;residual1_5 -->
<g id="edge50" class="edge">
<title>out_proj_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M231,-12727.83C231,-12719.43 231,-12710.39 231,-12701.4"/>
<polygon fill="black" stroke="black" points="234.5,-12701.33 231,-12691.33 227.5,-12701.33 234.5,-12701.33"/>
</g>
<!-- ln2_5 -->
<g id="node57" class="node">
<title>ln2_5</title>
<polygon fill="none" stroke="black" points="316,-12547.95 146,-12547.95 146,-12494.95 316,-12494.95 316,-12547.95"/>
<text text-anchor="middle" x="231" y="-12532.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-12517.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-12502.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge51" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M231,-12584.73C231,-12575.77 231,-12566.65 231,-12558.25"/>
<polygon fill="black" stroke="black" points="234.5,-12558.06 231,-12548.06 227.5,-12558.06 234.5,-12558.06"/>
</g>
<!-- ffn1_5 -->
<g id="node58" class="node">
<title>ffn1_5</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-12457.95 16.5,-12457.95 16.5,-12374.95 445.5,-12374.95 445.5,-12457.95"/>
<text text-anchor="middle" x="231" y="-12442.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-12427.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-12412.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-12397.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="231" y="-12382.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_5&#45;&gt;ffn1_5 -->
<g id="edge52" class="edge">
<title>ln2_5&#45;&gt;ffn1_5</title>
<path fill="none" stroke="black" d="M231,-12494.73C231,-12486.68 231,-12477.49 231,-12468.33"/>
<polygon fill="black" stroke="black" points="234.5,-12468.06 231,-12458.06 227.5,-12468.06 234.5,-12468.06"/>
</g>
<!-- gelu_5 -->
<g id="node59" class="node">
<title>gelu_5</title>
<polygon fill="none" stroke="black" points="316,-12337.95 146,-12337.95 146,-12284.95 316,-12284.95 316,-12337.95"/>
<text text-anchor="middle" x="231" y="-12322.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-12307.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-12292.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn1_5&#45;&gt;gelu_5 -->
<g id="edge53" class="edge">
<title>ffn1_5&#45;&gt;gelu_5</title>
<path fill="none" stroke="black" d="M231,-12374.74C231,-12365.95 231,-12356.72 231,-12348.13"/>
<polygon fill="black" stroke="black" points="234.5,-12348.05 231,-12338.05 227.5,-12348.05 234.5,-12348.05"/>
</g>
<!-- ffn2_5 -->
<g id="node60" class="node">
<title>ffn2_5</title>
<polygon fill="lightyellow" stroke="black" points="406,-12247.95 56,-12247.95 56,-12164.95 406,-12164.95 406,-12247.95"/>
<text text-anchor="middle" x="231" y="-12232.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-12217.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-12202.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-12187.75" font-family="Times,serif" font-size="14.00">GPU: 5</text>
<text text-anchor="middle" x="231" y="-12172.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_5&#45;&gt;ffn2_5 -->
<g id="edge54" class="edge">
<title>gelu_5&#45;&gt;ffn2_5</title>
<path fill="none" stroke="black" d="M231,-12284.73C231,-12276.68 231,-12267.49 231,-12258.33"/>
<polygon fill="black" stroke="black" points="234.5,-12258.06 231,-12248.06 227.5,-12258.06 234.5,-12258.06"/>
</g>
<!-- residual2_5 -->
<g id="node61" class="node">
<title>residual2_5</title>
<polygon fill="none" stroke="black" points="231,-12127.95 61,-12074.95 231,-12021.95 401,-12074.95 231,-12127.95"/>
<text text-anchor="middle" x="231" y="-12086.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-12071.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-12056.25" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn2_5&#45;&gt;residual2_5 -->
<g id="edge55" class="edge">
<title>ffn2_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M231,-12164.83C231,-12156.43 231,-12147.39 231,-12138.4"/>
<polygon fill="black" stroke="black" points="234.5,-12138.33 231,-12128.33 227.5,-12138.33 234.5,-12138.33"/>
</g>
<!-- ln1_6 -->
<g id="node62" class="node">
<title>ln1_6</title>
<polygon fill="none" stroke="black" points="316,-11934.95 146,-11934.95 146,-11881.95 316,-11881.95 316,-11934.95"/>
<text text-anchor="middle" x="231" y="-11919.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-11904.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-11889.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- residual2_5&#45;&gt;ln1_6 -->
<g id="edge151" class="edge">
<title>residual2_5&#45;&gt;ln1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-12021.9C231,-11996.88 231,-11967.52 231,-11945.07"/>
<polygon fill="black" stroke="black" points="234.5,-11944.98 231,-11934.98 227.5,-11944.98 234.5,-11944.98"/>
<text text-anchor="middle" x="290" y="-11992.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-11977.75" font-family="Times,serif" font-size="14.00">GPU 5 &#45;&gt; GPU 6</text>
</g>
<!-- qkv_proj_6 -->
<g id="node63" class="node">
<title>qkv_proj_6</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-11844.95 16.5,-11844.95 16.5,-11761.95 445.5,-11761.95 445.5,-11844.95"/>
<text text-anchor="middle" x="231" y="-11829.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-11814.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-11799.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-11784.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="231" y="-11769.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_6&#45;&gt;qkv_proj_6 -->
<g id="edge56" class="edge">
<title>ln1_6&#45;&gt;qkv_proj_6</title>
<path fill="none" stroke="black" d="M231,-11881.73C231,-11873.68 231,-11864.49 231,-11855.33"/>
<polygon fill="black" stroke="black" points="234.5,-11855.06 231,-11845.06 227.5,-11855.06 234.5,-11855.06"/>
</g>
<!-- mha_6 -->
<g id="node64" class="node">
<title>mha_6</title>
<polygon fill="none" stroke="black" points="406,-11724.95 56,-11724.95 56,-11656.95 406,-11656.95 406,-11724.95"/>
<text text-anchor="middle" x="231" y="-11709.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-11694.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-11679.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-11664.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- qkv_proj_6&#45;&gt;mha_6 -->
<g id="edge57" class="edge">
<title>qkv_proj_6&#45;&gt;mha_6</title>
<path fill="none" stroke="black" d="M231,-11761.93C231,-11753.26 231,-11744.06 231,-11735.28"/>
<polygon fill="black" stroke="black" points="234.5,-11735.22 231,-11725.22 227.5,-11735.22 234.5,-11735.22"/>
</g>
<!-- out_proj_6 -->
<g id="node65" class="node">
<title>out_proj_6</title>
<polygon fill="lightyellow" stroke="black" points="406,-11619.95 56,-11619.95 56,-11536.95 406,-11536.95 406,-11619.95"/>
<text text-anchor="middle" x="231" y="-11604.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-11589.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-11574.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-11559.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="231" y="-11544.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_6&#45;&gt;out_proj_6 -->
<g id="edge58" class="edge">
<title>mha_6&#45;&gt;out_proj_6</title>
<path fill="none" stroke="black" d="M231,-11656.8C231,-11648.39 231,-11639.17 231,-11630.11"/>
<polygon fill="black" stroke="black" points="234.5,-11630.01 231,-11620.01 227.5,-11630.01 234.5,-11630.01"/>
</g>
<!-- residual1_6 -->
<g id="node66" class="node">
<title>residual1_6</title>
<polygon fill="none" stroke="black" points="231,-11499.95 61,-11446.95 231,-11393.95 401,-11446.95 231,-11499.95"/>
<text text-anchor="middle" x="231" y="-11458.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-11443.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-11428.25" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- out_proj_6&#45;&gt;residual1_6 -->
<g id="edge59" class="edge">
<title>out_proj_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M231,-11536.83C231,-11528.43 231,-11519.39 231,-11510.4"/>
<polygon fill="black" stroke="black" points="234.5,-11510.33 231,-11500.33 227.5,-11510.33 234.5,-11510.33"/>
</g>
<!-- ln2_6 -->
<g id="node67" class="node">
<title>ln2_6</title>
<polygon fill="none" stroke="black" points="316,-11356.95 146,-11356.95 146,-11303.95 316,-11303.95 316,-11356.95"/>
<text text-anchor="middle" x="231" y="-11341.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-11326.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-11311.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge60" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M231,-11393.73C231,-11384.77 231,-11375.65 231,-11367.25"/>
<polygon fill="black" stroke="black" points="234.5,-11367.06 231,-11357.06 227.5,-11367.06 234.5,-11367.06"/>
</g>
<!-- ffn1_6 -->
<g id="node68" class="node">
<title>ffn1_6</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-11266.95 16.5,-11266.95 16.5,-11183.95 445.5,-11183.95 445.5,-11266.95"/>
<text text-anchor="middle" x="231" y="-11251.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-11236.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-11221.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-11206.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="231" y="-11191.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_6&#45;&gt;ffn1_6 -->
<g id="edge61" class="edge">
<title>ln2_6&#45;&gt;ffn1_6</title>
<path fill="none" stroke="black" d="M231,-11303.73C231,-11295.68 231,-11286.49 231,-11277.33"/>
<polygon fill="black" stroke="black" points="234.5,-11277.06 231,-11267.06 227.5,-11277.06 234.5,-11277.06"/>
</g>
<!-- gelu_6 -->
<g id="node69" class="node">
<title>gelu_6</title>
<polygon fill="none" stroke="black" points="316,-11146.95 146,-11146.95 146,-11093.95 316,-11093.95 316,-11146.95"/>
<text text-anchor="middle" x="231" y="-11131.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-11116.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-11101.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn1_6&#45;&gt;gelu_6 -->
<g id="edge62" class="edge">
<title>ffn1_6&#45;&gt;gelu_6</title>
<path fill="none" stroke="black" d="M231,-11183.74C231,-11174.95 231,-11165.72 231,-11157.13"/>
<polygon fill="black" stroke="black" points="234.5,-11157.05 231,-11147.05 227.5,-11157.05 234.5,-11157.05"/>
</g>
<!-- ffn2_6 -->
<g id="node70" class="node">
<title>ffn2_6</title>
<polygon fill="lightyellow" stroke="black" points="406,-11056.95 56,-11056.95 56,-10973.95 406,-10973.95 406,-11056.95"/>
<text text-anchor="middle" x="231" y="-11041.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-11026.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-11011.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-10996.75" font-family="Times,serif" font-size="14.00">GPU: 6</text>
<text text-anchor="middle" x="231" y="-10981.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_6&#45;&gt;ffn2_6 -->
<g id="edge63" class="edge">
<title>gelu_6&#45;&gt;ffn2_6</title>
<path fill="none" stroke="black" d="M231,-11093.73C231,-11085.68 231,-11076.49 231,-11067.33"/>
<polygon fill="black" stroke="black" points="234.5,-11067.06 231,-11057.06 227.5,-11067.06 234.5,-11067.06"/>
</g>
<!-- residual2_6 -->
<g id="node71" class="node">
<title>residual2_6</title>
<polygon fill="none" stroke="black" points="231,-10936.95 61,-10883.95 231,-10830.95 401,-10883.95 231,-10936.95"/>
<text text-anchor="middle" x="231" y="-10895.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-10880.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-10865.25" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn2_6&#45;&gt;residual2_6 -->
<g id="edge64" class="edge">
<title>ffn2_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M231,-10973.83C231,-10965.43 231,-10956.39 231,-10947.4"/>
<polygon fill="black" stroke="black" points="234.5,-10947.33 231,-10937.33 227.5,-10947.33 234.5,-10947.33"/>
</g>
<!-- ln1_7 -->
<g id="node72" class="node">
<title>ln1_7</title>
<polygon fill="none" stroke="black" points="316,-10743.95 146,-10743.95 146,-10690.95 316,-10690.95 316,-10743.95"/>
<text text-anchor="middle" x="231" y="-10728.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-10713.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-10698.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- residual2_6&#45;&gt;ln1_7 -->
<g id="edge152" class="edge">
<title>residual2_6&#45;&gt;ln1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-10830.9C231,-10805.88 231,-10776.52 231,-10754.07"/>
<polygon fill="black" stroke="black" points="234.5,-10753.98 231,-10743.98 227.5,-10753.98 234.5,-10753.98"/>
<text text-anchor="middle" x="290" y="-10801.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-10786.75" font-family="Times,serif" font-size="14.00">GPU 6 &#45;&gt; GPU 7</text>
</g>
<!-- qkv_proj_7 -->
<g id="node73" class="node">
<title>qkv_proj_7</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-10653.95 16.5,-10653.95 16.5,-10570.95 445.5,-10570.95 445.5,-10653.95"/>
<text text-anchor="middle" x="231" y="-10638.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-10623.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-10608.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-10593.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="231" y="-10578.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_7&#45;&gt;qkv_proj_7 -->
<g id="edge65" class="edge">
<title>ln1_7&#45;&gt;qkv_proj_7</title>
<path fill="none" stroke="black" d="M231,-10690.73C231,-10682.68 231,-10673.49 231,-10664.33"/>
<polygon fill="black" stroke="black" points="234.5,-10664.06 231,-10654.06 227.5,-10664.06 234.5,-10664.06"/>
</g>
<!-- mha_7 -->
<g id="node74" class="node">
<title>mha_7</title>
<polygon fill="none" stroke="black" points="406,-10533.95 56,-10533.95 56,-10465.95 406,-10465.95 406,-10533.95"/>
<text text-anchor="middle" x="231" y="-10518.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-10503.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-10488.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-10473.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- qkv_proj_7&#45;&gt;mha_7 -->
<g id="edge66" class="edge">
<title>qkv_proj_7&#45;&gt;mha_7</title>
<path fill="none" stroke="black" d="M231,-10570.93C231,-10562.26 231,-10553.06 231,-10544.28"/>
<polygon fill="black" stroke="black" points="234.5,-10544.22 231,-10534.22 227.5,-10544.22 234.5,-10544.22"/>
</g>
<!-- out_proj_7 -->
<g id="node75" class="node">
<title>out_proj_7</title>
<polygon fill="lightyellow" stroke="black" points="406,-10428.95 56,-10428.95 56,-10345.95 406,-10345.95 406,-10428.95"/>
<text text-anchor="middle" x="231" y="-10413.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-10398.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-10383.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-10368.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="231" y="-10353.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_7&#45;&gt;out_proj_7 -->
<g id="edge67" class="edge">
<title>mha_7&#45;&gt;out_proj_7</title>
<path fill="none" stroke="black" d="M231,-10465.8C231,-10457.39 231,-10448.17 231,-10439.11"/>
<polygon fill="black" stroke="black" points="234.5,-10439.01 231,-10429.01 227.5,-10439.01 234.5,-10439.01"/>
</g>
<!-- residual1_7 -->
<g id="node76" class="node">
<title>residual1_7</title>
<polygon fill="none" stroke="black" points="231,-10308.95 61,-10255.95 231,-10202.95 401,-10255.95 231,-10308.95"/>
<text text-anchor="middle" x="231" y="-10267.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-10252.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-10237.25" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- out_proj_7&#45;&gt;residual1_7 -->
<g id="edge68" class="edge">
<title>out_proj_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M231,-10345.83C231,-10337.43 231,-10328.39 231,-10319.4"/>
<polygon fill="black" stroke="black" points="234.5,-10319.33 231,-10309.33 227.5,-10319.33 234.5,-10319.33"/>
</g>
<!-- ln2_7 -->
<g id="node77" class="node">
<title>ln2_7</title>
<polygon fill="none" stroke="black" points="316,-10165.95 146,-10165.95 146,-10112.95 316,-10112.95 316,-10165.95"/>
<text text-anchor="middle" x="231" y="-10150.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-10135.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-10120.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge69" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M231,-10202.73C231,-10193.77 231,-10184.65 231,-10176.25"/>
<polygon fill="black" stroke="black" points="234.5,-10176.06 231,-10166.06 227.5,-10176.06 234.5,-10176.06"/>
</g>
<!-- ffn1_7 -->
<g id="node78" class="node">
<title>ffn1_7</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-10075.95 16.5,-10075.95 16.5,-9992.95 445.5,-9992.95 445.5,-10075.95"/>
<text text-anchor="middle" x="231" y="-10060.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-10045.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-10030.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-10015.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="231" y="-10000.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_7&#45;&gt;ffn1_7 -->
<g id="edge70" class="edge">
<title>ln2_7&#45;&gt;ffn1_7</title>
<path fill="none" stroke="black" d="M231,-10112.73C231,-10104.68 231,-10095.49 231,-10086.33"/>
<polygon fill="black" stroke="black" points="234.5,-10086.06 231,-10076.06 227.5,-10086.06 234.5,-10086.06"/>
</g>
<!-- gelu_7 -->
<g id="node79" class="node">
<title>gelu_7</title>
<polygon fill="none" stroke="black" points="316,-9955.95 146,-9955.95 146,-9902.95 316,-9902.95 316,-9955.95"/>
<text text-anchor="middle" x="231" y="-9940.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-9925.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-9910.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn1_7&#45;&gt;gelu_7 -->
<g id="edge71" class="edge">
<title>ffn1_7&#45;&gt;gelu_7</title>
<path fill="none" stroke="black" d="M231,-9992.74C231,-9983.95 231,-9974.72 231,-9966.13"/>
<polygon fill="black" stroke="black" points="234.5,-9966.05 231,-9956.05 227.5,-9966.05 234.5,-9966.05"/>
</g>
<!-- ffn2_7 -->
<g id="node80" class="node">
<title>ffn2_7</title>
<polygon fill="lightyellow" stroke="black" points="406,-9865.95 56,-9865.95 56,-9782.95 406,-9782.95 406,-9865.95"/>
<text text-anchor="middle" x="231" y="-9850.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-9835.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-9820.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-9805.75" font-family="Times,serif" font-size="14.00">GPU: 7</text>
<text text-anchor="middle" x="231" y="-9790.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_7&#45;&gt;ffn2_7 -->
<g id="edge72" class="edge">
<title>gelu_7&#45;&gt;ffn2_7</title>
<path fill="none" stroke="black" d="M231,-9902.73C231,-9894.68 231,-9885.49 231,-9876.33"/>
<polygon fill="black" stroke="black" points="234.5,-9876.06 231,-9866.06 227.5,-9876.06 234.5,-9876.06"/>
</g>
<!-- residual2_7 -->
<g id="node81" class="node">
<title>residual2_7</title>
<polygon fill="none" stroke="black" points="231,-9745.95 61,-9692.95 231,-9639.95 401,-9692.95 231,-9745.95"/>
<text text-anchor="middle" x="231" y="-9704.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-9689.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-9674.25" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn2_7&#45;&gt;residual2_7 -->
<g id="edge73" class="edge">
<title>ffn2_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M231,-9782.83C231,-9774.43 231,-9765.39 231,-9756.4"/>
<polygon fill="black" stroke="black" points="234.5,-9756.33 231,-9746.33 227.5,-9756.33 234.5,-9756.33"/>
</g>
<!-- ln1_8 -->
<g id="node82" class="node">
<title>ln1_8</title>
<polygon fill="none" stroke="black" points="316,-9552.95 146,-9552.95 146,-9499.95 316,-9499.95 316,-9552.95"/>
<text text-anchor="middle" x="231" y="-9537.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-9522.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-9507.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- residual2_7&#45;&gt;ln1_8 -->
<g id="edge153" class="edge">
<title>residual2_7&#45;&gt;ln1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-9639.9C231,-9614.88 231,-9585.52 231,-9563.07"/>
<polygon fill="black" stroke="black" points="234.5,-9562.98 231,-9552.98 227.5,-9562.98 234.5,-9562.98"/>
<text text-anchor="middle" x="290" y="-9610.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-9595.75" font-family="Times,serif" font-size="14.00">GPU 7 &#45;&gt; GPU 8</text>
</g>
<!-- qkv_proj_8 -->
<g id="node83" class="node">
<title>qkv_proj_8</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-9462.95 16.5,-9462.95 16.5,-9379.95 445.5,-9379.95 445.5,-9462.95"/>
<text text-anchor="middle" x="231" y="-9447.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-9432.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-9417.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-9402.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="231" y="-9387.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_8&#45;&gt;qkv_proj_8 -->
<g id="edge74" class="edge">
<title>ln1_8&#45;&gt;qkv_proj_8</title>
<path fill="none" stroke="black" d="M231,-9499.73C231,-9491.68 231,-9482.49 231,-9473.33"/>
<polygon fill="black" stroke="black" points="234.5,-9473.06 231,-9463.06 227.5,-9473.06 234.5,-9473.06"/>
</g>
<!-- mha_8 -->
<g id="node84" class="node">
<title>mha_8</title>
<polygon fill="none" stroke="black" points="406,-9342.95 56,-9342.95 56,-9274.95 406,-9274.95 406,-9342.95"/>
<text text-anchor="middle" x="231" y="-9327.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-9312.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-9297.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-9282.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- qkv_proj_8&#45;&gt;mha_8 -->
<g id="edge75" class="edge">
<title>qkv_proj_8&#45;&gt;mha_8</title>
<path fill="none" stroke="black" d="M231,-9379.93C231,-9371.26 231,-9362.06 231,-9353.28"/>
<polygon fill="black" stroke="black" points="234.5,-9353.22 231,-9343.22 227.5,-9353.22 234.5,-9353.22"/>
</g>
<!-- out_proj_8 -->
<g id="node85" class="node">
<title>out_proj_8</title>
<polygon fill="lightyellow" stroke="black" points="406,-9237.95 56,-9237.95 56,-9154.95 406,-9154.95 406,-9237.95"/>
<text text-anchor="middle" x="231" y="-9222.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-9207.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-9192.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-9177.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="231" y="-9162.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_8&#45;&gt;out_proj_8 -->
<g id="edge76" class="edge">
<title>mha_8&#45;&gt;out_proj_8</title>
<path fill="none" stroke="black" d="M231,-9274.8C231,-9266.39 231,-9257.17 231,-9248.11"/>
<polygon fill="black" stroke="black" points="234.5,-9248.01 231,-9238.01 227.5,-9248.01 234.5,-9248.01"/>
</g>
<!-- residual1_8 -->
<g id="node86" class="node">
<title>residual1_8</title>
<polygon fill="none" stroke="black" points="231,-9117.95 61,-9064.95 231,-9011.95 401,-9064.95 231,-9117.95"/>
<text text-anchor="middle" x="231" y="-9076.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-9061.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-9046.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- out_proj_8&#45;&gt;residual1_8 -->
<g id="edge77" class="edge">
<title>out_proj_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M231,-9154.83C231,-9146.43 231,-9137.39 231,-9128.4"/>
<polygon fill="black" stroke="black" points="234.5,-9128.33 231,-9118.33 227.5,-9128.33 234.5,-9128.33"/>
</g>
<!-- ln2_8 -->
<g id="node87" class="node">
<title>ln2_8</title>
<polygon fill="none" stroke="black" points="316,-8974.95 146,-8974.95 146,-8921.95 316,-8921.95 316,-8974.95"/>
<text text-anchor="middle" x="231" y="-8959.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-8944.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-8929.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge78" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M231,-9011.73C231,-9002.77 231,-8993.65 231,-8985.25"/>
<polygon fill="black" stroke="black" points="234.5,-8985.06 231,-8975.06 227.5,-8985.06 234.5,-8985.06"/>
</g>
<!-- ffn1_8 -->
<g id="node88" class="node">
<title>ffn1_8</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-8884.95 16.5,-8884.95 16.5,-8801.95 445.5,-8801.95 445.5,-8884.95"/>
<text text-anchor="middle" x="231" y="-8869.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-8854.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-8839.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-8824.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="231" y="-8809.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_8&#45;&gt;ffn1_8 -->
<g id="edge79" class="edge">
<title>ln2_8&#45;&gt;ffn1_8</title>
<path fill="none" stroke="black" d="M231,-8921.73C231,-8913.68 231,-8904.49 231,-8895.33"/>
<polygon fill="black" stroke="black" points="234.5,-8895.06 231,-8885.06 227.5,-8895.06 234.5,-8895.06"/>
</g>
<!-- gelu_8 -->
<g id="node89" class="node">
<title>gelu_8</title>
<polygon fill="none" stroke="black" points="316,-8764.95 146,-8764.95 146,-8711.95 316,-8711.95 316,-8764.95"/>
<text text-anchor="middle" x="231" y="-8749.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-8734.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-8719.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn1_8&#45;&gt;gelu_8 -->
<g id="edge80" class="edge">
<title>ffn1_8&#45;&gt;gelu_8</title>
<path fill="none" stroke="black" d="M231,-8801.74C231,-8792.95 231,-8783.72 231,-8775.13"/>
<polygon fill="black" stroke="black" points="234.5,-8775.05 231,-8765.05 227.5,-8775.05 234.5,-8775.05"/>
</g>
<!-- ffn2_8 -->
<g id="node90" class="node">
<title>ffn2_8</title>
<polygon fill="lightyellow" stroke="black" points="406,-8674.95 56,-8674.95 56,-8591.95 406,-8591.95 406,-8674.95"/>
<text text-anchor="middle" x="231" y="-8659.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-8644.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-8629.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-8614.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
<text text-anchor="middle" x="231" y="-8599.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_8&#45;&gt;ffn2_8 -->
<g id="edge81" class="edge">
<title>gelu_8&#45;&gt;ffn2_8</title>
<path fill="none" stroke="black" d="M231,-8711.73C231,-8703.68 231,-8694.49 231,-8685.33"/>
<polygon fill="black" stroke="black" points="234.5,-8685.06 231,-8675.06 227.5,-8685.06 234.5,-8685.06"/>
</g>
<!-- residual2_8 -->
<g id="node91" class="node">
<title>residual2_8</title>
<polygon fill="none" stroke="black" points="231,-8554.95 61,-8501.95 231,-8448.95 401,-8501.95 231,-8554.95"/>
<text text-anchor="middle" x="231" y="-8513.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-8498.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-8483.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn2_8&#45;&gt;residual2_8 -->
<g id="edge82" class="edge">
<title>ffn2_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M231,-8591.83C231,-8583.43 231,-8574.39 231,-8565.4"/>
<polygon fill="black" stroke="black" points="234.5,-8565.33 231,-8555.33 227.5,-8565.33 234.5,-8565.33"/>
</g>
<!-- ln1_9 -->
<g id="node92" class="node">
<title>ln1_9</title>
<polygon fill="none" stroke="black" points="316,-8361.95 146,-8361.95 146,-8308.95 316,-8308.95 316,-8361.95"/>
<text text-anchor="middle" x="231" y="-8346.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-8331.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-8316.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- residual2_8&#45;&gt;ln1_9 -->
<g id="edge154" class="edge">
<title>residual2_8&#45;&gt;ln1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-8448.9C231,-8423.88 231,-8394.52 231,-8372.07"/>
<polygon fill="black" stroke="black" points="234.5,-8371.98 231,-8361.98 227.5,-8371.98 234.5,-8371.98"/>
<text text-anchor="middle" x="290" y="-8419.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="290" y="-8404.75" font-family="Times,serif" font-size="14.00">GPU 8 &#45;&gt; GPU 9</text>
</g>
<!-- qkv_proj_9 -->
<g id="node93" class="node">
<title>qkv_proj_9</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-8271.95 16.5,-8271.95 16.5,-8188.95 445.5,-8188.95 445.5,-8271.95"/>
<text text-anchor="middle" x="231" y="-8256.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-8241.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-8226.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-8211.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="231" y="-8196.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_9&#45;&gt;qkv_proj_9 -->
<g id="edge83" class="edge">
<title>ln1_9&#45;&gt;qkv_proj_9</title>
<path fill="none" stroke="black" d="M231,-8308.73C231,-8300.68 231,-8291.49 231,-8282.33"/>
<polygon fill="black" stroke="black" points="234.5,-8282.06 231,-8272.06 227.5,-8282.06 234.5,-8282.06"/>
</g>
<!-- mha_9 -->
<g id="node94" class="node">
<title>mha_9</title>
<polygon fill="none" stroke="black" points="406,-8151.95 56,-8151.95 56,-8083.95 406,-8083.95 406,-8151.95"/>
<text text-anchor="middle" x="231" y="-8136.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-8121.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-8106.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-8091.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- qkv_proj_9&#45;&gt;mha_9 -->
<g id="edge84" class="edge">
<title>qkv_proj_9&#45;&gt;mha_9</title>
<path fill="none" stroke="black" d="M231,-8188.93C231,-8180.26 231,-8171.06 231,-8162.28"/>
<polygon fill="black" stroke="black" points="234.5,-8162.22 231,-8152.22 227.5,-8162.22 234.5,-8162.22"/>
</g>
<!-- out_proj_9 -->
<g id="node95" class="node">
<title>out_proj_9</title>
<polygon fill="lightyellow" stroke="black" points="406,-8046.95 56,-8046.95 56,-7963.95 406,-7963.95 406,-8046.95"/>
<text text-anchor="middle" x="231" y="-8031.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-8016.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-8001.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-7986.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="231" y="-7971.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_9&#45;&gt;out_proj_9 -->
<g id="edge85" class="edge">
<title>mha_9&#45;&gt;out_proj_9</title>
<path fill="none" stroke="black" d="M231,-8083.8C231,-8075.39 231,-8066.17 231,-8057.11"/>
<polygon fill="black" stroke="black" points="234.5,-8057.01 231,-8047.01 227.5,-8057.01 234.5,-8057.01"/>
</g>
<!-- residual1_9 -->
<g id="node96" class="node">
<title>residual1_9</title>
<polygon fill="none" stroke="black" points="231,-7926.95 61,-7873.95 231,-7820.95 401,-7873.95 231,-7926.95"/>
<text text-anchor="middle" x="231" y="-7885.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-7870.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-7855.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- out_proj_9&#45;&gt;residual1_9 -->
<g id="edge86" class="edge">
<title>out_proj_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M231,-7963.83C231,-7955.43 231,-7946.39 231,-7937.4"/>
<polygon fill="black" stroke="black" points="234.5,-7937.33 231,-7927.33 227.5,-7937.33 234.5,-7937.33"/>
</g>
<!-- ln2_9 -->
<g id="node97" class="node">
<title>ln2_9</title>
<polygon fill="none" stroke="black" points="316,-7783.95 146,-7783.95 146,-7730.95 316,-7730.95 316,-7783.95"/>
<text text-anchor="middle" x="231" y="-7768.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-7753.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-7738.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge87" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M231,-7820.73C231,-7811.77 231,-7802.65 231,-7794.25"/>
<polygon fill="black" stroke="black" points="234.5,-7794.06 231,-7784.06 227.5,-7794.06 234.5,-7794.06"/>
</g>
<!-- ffn1_9 -->
<g id="node98" class="node">
<title>ffn1_9</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-7693.95 16.5,-7693.95 16.5,-7610.95 445.5,-7610.95 445.5,-7693.95"/>
<text text-anchor="middle" x="231" y="-7678.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-7663.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-7648.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-7633.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="231" y="-7618.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_9&#45;&gt;ffn1_9 -->
<g id="edge88" class="edge">
<title>ln2_9&#45;&gt;ffn1_9</title>
<path fill="none" stroke="black" d="M231,-7730.73C231,-7722.68 231,-7713.49 231,-7704.33"/>
<polygon fill="black" stroke="black" points="234.5,-7704.06 231,-7694.06 227.5,-7704.06 234.5,-7704.06"/>
</g>
<!-- gelu_9 -->
<g id="node99" class="node">
<title>gelu_9</title>
<polygon fill="none" stroke="black" points="316,-7573.95 146,-7573.95 146,-7520.95 316,-7520.95 316,-7573.95"/>
<text text-anchor="middle" x="231" y="-7558.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-7543.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-7528.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn1_9&#45;&gt;gelu_9 -->
<g id="edge89" class="edge">
<title>ffn1_9&#45;&gt;gelu_9</title>
<path fill="none" stroke="black" d="M231,-7610.74C231,-7601.95 231,-7592.72 231,-7584.13"/>
<polygon fill="black" stroke="black" points="234.5,-7584.05 231,-7574.05 227.5,-7584.05 234.5,-7584.05"/>
</g>
<!-- ffn2_9 -->
<g id="node100" class="node">
<title>ffn2_9</title>
<polygon fill="lightyellow" stroke="black" points="406,-7483.95 56,-7483.95 56,-7400.95 406,-7400.95 406,-7483.95"/>
<text text-anchor="middle" x="231" y="-7468.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-7453.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-7438.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-7423.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
<text text-anchor="middle" x="231" y="-7408.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_9&#45;&gt;ffn2_9 -->
<g id="edge90" class="edge">
<title>gelu_9&#45;&gt;ffn2_9</title>
<path fill="none" stroke="black" d="M231,-7520.73C231,-7512.68 231,-7503.49 231,-7494.33"/>
<polygon fill="black" stroke="black" points="234.5,-7494.06 231,-7484.06 227.5,-7494.06 234.5,-7494.06"/>
</g>
<!-- residual2_9 -->
<g id="node101" class="node">
<title>residual2_9</title>
<polygon fill="none" stroke="black" points="231,-7363.95 61,-7310.95 231,-7257.95 401,-7310.95 231,-7363.95"/>
<text text-anchor="middle" x="231" y="-7322.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-7307.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-7292.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn2_9&#45;&gt;residual2_9 -->
<g id="edge91" class="edge">
<title>ffn2_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M231,-7400.83C231,-7392.43 231,-7383.39 231,-7374.4"/>
<polygon fill="black" stroke="black" points="234.5,-7374.33 231,-7364.33 227.5,-7374.33 234.5,-7374.33"/>
</g>
<!-- ln1_10 -->
<g id="node102" class="node">
<title>ln1_10</title>
<polygon fill="none" stroke="black" points="316,-7170.95 146,-7170.95 146,-7117.95 316,-7117.95 316,-7170.95"/>
<text text-anchor="middle" x="231" y="-7155.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-7140.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-7125.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- residual2_9&#45;&gt;ln1_10 -->
<g id="edge155" class="edge">
<title>residual2_9&#45;&gt;ln1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-7257.9C231,-7232.88 231,-7203.52 231,-7181.07"/>
<polygon fill="black" stroke="black" points="234.5,-7180.98 231,-7170.98 227.5,-7180.98 234.5,-7180.98"/>
<text text-anchor="middle" x="294.5" y="-7228.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="294.5" y="-7213.75" font-family="Times,serif" font-size="14.00">GPU 9 &#45;&gt; GPU 10</text>
</g>
<!-- qkv_proj_10 -->
<g id="node103" class="node">
<title>qkv_proj_10</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-7080.95 16.5,-7080.95 16.5,-6997.95 445.5,-6997.95 445.5,-7080.95"/>
<text text-anchor="middle" x="231" y="-7065.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-7050.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-7035.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-7020.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="231" y="-7005.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_10&#45;&gt;qkv_proj_10 -->
<g id="edge92" class="edge">
<title>ln1_10&#45;&gt;qkv_proj_10</title>
<path fill="none" stroke="black" d="M231,-7117.73C231,-7109.68 231,-7100.49 231,-7091.33"/>
<polygon fill="black" stroke="black" points="234.5,-7091.06 231,-7081.06 227.5,-7091.06 234.5,-7091.06"/>
</g>
<!-- mha_10 -->
<g id="node104" class="node">
<title>mha_10</title>
<polygon fill="none" stroke="black" points="406,-6960.95 56,-6960.95 56,-6892.95 406,-6892.95 406,-6960.95"/>
<text text-anchor="middle" x="231" y="-6945.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-6930.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-6915.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-6900.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- qkv_proj_10&#45;&gt;mha_10 -->
<g id="edge93" class="edge">
<title>qkv_proj_10&#45;&gt;mha_10</title>
<path fill="none" stroke="black" d="M231,-6997.93C231,-6989.26 231,-6980.06 231,-6971.28"/>
<polygon fill="black" stroke="black" points="234.5,-6971.22 231,-6961.22 227.5,-6971.22 234.5,-6971.22"/>
</g>
<!-- out_proj_10 -->
<g id="node105" class="node">
<title>out_proj_10</title>
<polygon fill="lightyellow" stroke="black" points="406,-6855.95 56,-6855.95 56,-6772.95 406,-6772.95 406,-6855.95"/>
<text text-anchor="middle" x="231" y="-6840.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-6825.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-6810.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-6795.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="231" y="-6780.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_10&#45;&gt;out_proj_10 -->
<g id="edge94" class="edge">
<title>mha_10&#45;&gt;out_proj_10</title>
<path fill="none" stroke="black" d="M231,-6892.8C231,-6884.39 231,-6875.17 231,-6866.11"/>
<polygon fill="black" stroke="black" points="234.5,-6866.01 231,-6856.01 227.5,-6866.01 234.5,-6866.01"/>
</g>
<!-- residual1_10 -->
<g id="node106" class="node">
<title>residual1_10</title>
<polygon fill="none" stroke="black" points="231,-6735.95 61,-6682.95 231,-6629.95 401,-6682.95 231,-6735.95"/>
<text text-anchor="middle" x="231" y="-6694.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-6679.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-6664.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- out_proj_10&#45;&gt;residual1_10 -->
<g id="edge95" class="edge">
<title>out_proj_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M231,-6772.83C231,-6764.43 231,-6755.39 231,-6746.4"/>
<polygon fill="black" stroke="black" points="234.5,-6746.33 231,-6736.33 227.5,-6746.33 234.5,-6746.33"/>
</g>
<!-- ln2_10 -->
<g id="node107" class="node">
<title>ln2_10</title>
<polygon fill="none" stroke="black" points="316,-6592.95 146,-6592.95 146,-6539.95 316,-6539.95 316,-6592.95"/>
<text text-anchor="middle" x="231" y="-6577.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-6562.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-6547.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge96" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M231,-6629.73C231,-6620.77 231,-6611.65 231,-6603.25"/>
<polygon fill="black" stroke="black" points="234.5,-6603.06 231,-6593.06 227.5,-6603.06 234.5,-6603.06"/>
</g>
<!-- ffn1_10 -->
<g id="node108" class="node">
<title>ffn1_10</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-6502.95 16.5,-6502.95 16.5,-6419.95 445.5,-6419.95 445.5,-6502.95"/>
<text text-anchor="middle" x="231" y="-6487.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-6472.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-6457.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-6442.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="231" y="-6427.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_10&#45;&gt;ffn1_10 -->
<g id="edge97" class="edge">
<title>ln2_10&#45;&gt;ffn1_10</title>
<path fill="none" stroke="black" d="M231,-6539.73C231,-6531.68 231,-6522.49 231,-6513.33"/>
<polygon fill="black" stroke="black" points="234.5,-6513.06 231,-6503.06 227.5,-6513.06 234.5,-6513.06"/>
</g>
<!-- gelu_10 -->
<g id="node109" class="node">
<title>gelu_10</title>
<polygon fill="none" stroke="black" points="316,-6382.95 146,-6382.95 146,-6329.95 316,-6329.95 316,-6382.95"/>
<text text-anchor="middle" x="231" y="-6367.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-6352.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-6337.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn1_10&#45;&gt;gelu_10 -->
<g id="edge98" class="edge">
<title>ffn1_10&#45;&gt;gelu_10</title>
<path fill="none" stroke="black" d="M231,-6419.74C231,-6410.95 231,-6401.72 231,-6393.13"/>
<polygon fill="black" stroke="black" points="234.5,-6393.05 231,-6383.05 227.5,-6393.05 234.5,-6393.05"/>
</g>
<!-- ffn2_10 -->
<g id="node110" class="node">
<title>ffn2_10</title>
<polygon fill="lightyellow" stroke="black" points="406,-6292.95 56,-6292.95 56,-6209.95 406,-6209.95 406,-6292.95"/>
<text text-anchor="middle" x="231" y="-6277.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-6262.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-6247.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-6232.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
<text text-anchor="middle" x="231" y="-6217.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_10&#45;&gt;ffn2_10 -->
<g id="edge99" class="edge">
<title>gelu_10&#45;&gt;ffn2_10</title>
<path fill="none" stroke="black" d="M231,-6329.73C231,-6321.68 231,-6312.49 231,-6303.33"/>
<polygon fill="black" stroke="black" points="234.5,-6303.06 231,-6293.06 227.5,-6303.06 234.5,-6303.06"/>
</g>
<!-- residual2_10 -->
<g id="node111" class="node">
<title>residual2_10</title>
<polygon fill="none" stroke="black" points="231,-6172.95 61,-6119.95 231,-6066.95 401,-6119.95 231,-6172.95"/>
<text text-anchor="middle" x="231" y="-6131.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-6116.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-6101.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn2_10&#45;&gt;residual2_10 -->
<g id="edge100" class="edge">
<title>ffn2_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M231,-6209.83C231,-6201.43 231,-6192.39 231,-6183.4"/>
<polygon fill="black" stroke="black" points="234.5,-6183.33 231,-6173.33 227.5,-6183.33 234.5,-6183.33"/>
</g>
<!-- ln1_11 -->
<g id="node112" class="node">
<title>ln1_11</title>
<polygon fill="none" stroke="black" points="316,-5979.95 146,-5979.95 146,-5926.95 316,-5926.95 316,-5979.95"/>
<text text-anchor="middle" x="231" y="-5964.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-5949.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-5934.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- residual2_10&#45;&gt;ln1_11 -->
<g id="edge156" class="edge">
<title>residual2_10&#45;&gt;ln1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-6066.9C231,-6041.88 231,-6012.52 231,-5990.07"/>
<polygon fill="black" stroke="black" points="234.5,-5989.98 231,-5979.98 227.5,-5989.98 234.5,-5989.98"/>
<text text-anchor="middle" x="299" y="-6037.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="299" y="-6022.75" font-family="Times,serif" font-size="14.00">GPU 10 &#45;&gt; GPU 11</text>
</g>
<!-- qkv_proj_11 -->
<g id="node113" class="node">
<title>qkv_proj_11</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-5889.95 16.5,-5889.95 16.5,-5806.95 445.5,-5806.95 445.5,-5889.95"/>
<text text-anchor="middle" x="231" y="-5874.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-5859.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-5844.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-5829.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="231" y="-5814.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_11&#45;&gt;qkv_proj_11 -->
<g id="edge101" class="edge">
<title>ln1_11&#45;&gt;qkv_proj_11</title>
<path fill="none" stroke="black" d="M231,-5926.73C231,-5918.68 231,-5909.49 231,-5900.33"/>
<polygon fill="black" stroke="black" points="234.5,-5900.06 231,-5890.06 227.5,-5900.06 234.5,-5900.06"/>
</g>
<!-- mha_11 -->
<g id="node114" class="node">
<title>mha_11</title>
<polygon fill="none" stroke="black" points="406,-5769.95 56,-5769.95 56,-5701.95 406,-5701.95 406,-5769.95"/>
<text text-anchor="middle" x="231" y="-5754.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-5739.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-5724.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-5709.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- qkv_proj_11&#45;&gt;mha_11 -->
<g id="edge102" class="edge">
<title>qkv_proj_11&#45;&gt;mha_11</title>
<path fill="none" stroke="black" d="M231,-5806.93C231,-5798.26 231,-5789.06 231,-5780.28"/>
<polygon fill="black" stroke="black" points="234.5,-5780.22 231,-5770.22 227.5,-5780.22 234.5,-5780.22"/>
</g>
<!-- out_proj_11 -->
<g id="node115" class="node">
<title>out_proj_11</title>
<polygon fill="lightyellow" stroke="black" points="406,-5664.95 56,-5664.95 56,-5581.95 406,-5581.95 406,-5664.95"/>
<text text-anchor="middle" x="231" y="-5649.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-5634.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-5619.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-5604.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="231" y="-5589.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_11&#45;&gt;out_proj_11 -->
<g id="edge103" class="edge">
<title>mha_11&#45;&gt;out_proj_11</title>
<path fill="none" stroke="black" d="M231,-5701.8C231,-5693.39 231,-5684.17 231,-5675.11"/>
<polygon fill="black" stroke="black" points="234.5,-5675.01 231,-5665.01 227.5,-5675.01 234.5,-5675.01"/>
</g>
<!-- residual1_11 -->
<g id="node116" class="node">
<title>residual1_11</title>
<polygon fill="none" stroke="black" points="231,-5544.95 61,-5491.95 231,-5438.95 401,-5491.95 231,-5544.95"/>
<text text-anchor="middle" x="231" y="-5503.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-5488.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-5473.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- out_proj_11&#45;&gt;residual1_11 -->
<g id="edge104" class="edge">
<title>out_proj_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M231,-5581.83C231,-5573.43 231,-5564.39 231,-5555.4"/>
<polygon fill="black" stroke="black" points="234.5,-5555.33 231,-5545.33 227.5,-5555.33 234.5,-5555.33"/>
</g>
<!-- ln2_11 -->
<g id="node117" class="node">
<title>ln2_11</title>
<polygon fill="none" stroke="black" points="316,-5401.95 146,-5401.95 146,-5348.95 316,-5348.95 316,-5401.95"/>
<text text-anchor="middle" x="231" y="-5386.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-5371.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-5356.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge105" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M231,-5438.73C231,-5429.77 231,-5420.65 231,-5412.25"/>
<polygon fill="black" stroke="black" points="234.5,-5412.06 231,-5402.06 227.5,-5412.06 234.5,-5412.06"/>
</g>
<!-- ffn1_11 -->
<g id="node118" class="node">
<title>ffn1_11</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-5311.95 16.5,-5311.95 16.5,-5228.95 445.5,-5228.95 445.5,-5311.95"/>
<text text-anchor="middle" x="231" y="-5296.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-5281.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-5266.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-5251.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="231" y="-5236.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_11&#45;&gt;ffn1_11 -->
<g id="edge106" class="edge">
<title>ln2_11&#45;&gt;ffn1_11</title>
<path fill="none" stroke="black" d="M231,-5348.73C231,-5340.68 231,-5331.49 231,-5322.33"/>
<polygon fill="black" stroke="black" points="234.5,-5322.06 231,-5312.06 227.5,-5322.06 234.5,-5322.06"/>
</g>
<!-- gelu_11 -->
<g id="node119" class="node">
<title>gelu_11</title>
<polygon fill="none" stroke="black" points="316,-5191.95 146,-5191.95 146,-5138.95 316,-5138.95 316,-5191.95"/>
<text text-anchor="middle" x="231" y="-5176.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-5161.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-5146.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn1_11&#45;&gt;gelu_11 -->
<g id="edge107" class="edge">
<title>ffn1_11&#45;&gt;gelu_11</title>
<path fill="none" stroke="black" d="M231,-5228.74C231,-5219.95 231,-5210.72 231,-5202.13"/>
<polygon fill="black" stroke="black" points="234.5,-5202.05 231,-5192.05 227.5,-5202.05 234.5,-5202.05"/>
</g>
<!-- ffn2_11 -->
<g id="node120" class="node">
<title>ffn2_11</title>
<polygon fill="lightyellow" stroke="black" points="406,-5101.95 56,-5101.95 56,-5018.95 406,-5018.95 406,-5101.95"/>
<text text-anchor="middle" x="231" y="-5086.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-5071.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-5056.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-5041.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
<text text-anchor="middle" x="231" y="-5026.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_11&#45;&gt;ffn2_11 -->
<g id="edge108" class="edge">
<title>gelu_11&#45;&gt;ffn2_11</title>
<path fill="none" stroke="black" d="M231,-5138.73C231,-5130.68 231,-5121.49 231,-5112.33"/>
<polygon fill="black" stroke="black" points="234.5,-5112.06 231,-5102.06 227.5,-5112.06 234.5,-5112.06"/>
</g>
<!-- residual2_11 -->
<g id="node121" class="node">
<title>residual2_11</title>
<polygon fill="none" stroke="black" points="231,-4981.95 61,-4928.95 231,-4875.95 401,-4928.95 231,-4981.95"/>
<text text-anchor="middle" x="231" y="-4940.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-4925.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-4910.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn2_11&#45;&gt;residual2_11 -->
<g id="edge109" class="edge">
<title>ffn2_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M231,-5018.83C231,-5010.43 231,-5001.39 231,-4992.4"/>
<polygon fill="black" stroke="black" points="234.5,-4992.33 231,-4982.33 227.5,-4992.33 234.5,-4992.33"/>
</g>
<!-- ln1_12 -->
<g id="node122" class="node">
<title>ln1_12</title>
<polygon fill="none" stroke="black" points="316,-4788.95 146,-4788.95 146,-4735.95 316,-4735.95 316,-4788.95"/>
<text text-anchor="middle" x="231" y="-4773.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-4758.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-4743.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- residual2_11&#45;&gt;ln1_12 -->
<g id="edge157" class="edge">
<title>residual2_11&#45;&gt;ln1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-4875.9C231,-4850.88 231,-4821.52 231,-4799.07"/>
<polygon fill="black" stroke="black" points="234.5,-4798.98 231,-4788.98 227.5,-4798.98 234.5,-4798.98"/>
<text text-anchor="middle" x="299" y="-4846.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="299" y="-4831.75" font-family="Times,serif" font-size="14.00">GPU 11 &#45;&gt; GPU 12</text>
</g>
<!-- qkv_proj_12 -->
<g id="node123" class="node">
<title>qkv_proj_12</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-4698.95 16.5,-4698.95 16.5,-4615.95 445.5,-4615.95 445.5,-4698.95"/>
<text text-anchor="middle" x="231" y="-4683.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-4668.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-4653.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-4638.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="231" y="-4623.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_12&#45;&gt;qkv_proj_12 -->
<g id="edge110" class="edge">
<title>ln1_12&#45;&gt;qkv_proj_12</title>
<path fill="none" stroke="black" d="M231,-4735.73C231,-4727.68 231,-4718.49 231,-4709.33"/>
<polygon fill="black" stroke="black" points="234.5,-4709.06 231,-4699.06 227.5,-4709.06 234.5,-4709.06"/>
</g>
<!-- mha_12 -->
<g id="node124" class="node">
<title>mha_12</title>
<polygon fill="none" stroke="black" points="406,-4578.95 56,-4578.95 56,-4510.95 406,-4510.95 406,-4578.95"/>
<text text-anchor="middle" x="231" y="-4563.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-4548.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-4533.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-4518.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- qkv_proj_12&#45;&gt;mha_12 -->
<g id="edge111" class="edge">
<title>qkv_proj_12&#45;&gt;mha_12</title>
<path fill="none" stroke="black" d="M231,-4615.93C231,-4607.26 231,-4598.06 231,-4589.28"/>
<polygon fill="black" stroke="black" points="234.5,-4589.22 231,-4579.22 227.5,-4589.22 234.5,-4589.22"/>
</g>
<!-- out_proj_12 -->
<g id="node125" class="node">
<title>out_proj_12</title>
<polygon fill="lightyellow" stroke="black" points="406,-4473.95 56,-4473.95 56,-4390.95 406,-4390.95 406,-4473.95"/>
<text text-anchor="middle" x="231" y="-4458.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-4443.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-4428.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-4413.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="231" y="-4398.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_12&#45;&gt;out_proj_12 -->
<g id="edge112" class="edge">
<title>mha_12&#45;&gt;out_proj_12</title>
<path fill="none" stroke="black" d="M231,-4510.8C231,-4502.39 231,-4493.17 231,-4484.11"/>
<polygon fill="black" stroke="black" points="234.5,-4484.01 231,-4474.01 227.5,-4484.01 234.5,-4484.01"/>
</g>
<!-- residual1_12 -->
<g id="node126" class="node">
<title>residual1_12</title>
<polygon fill="none" stroke="black" points="231,-4353.95 61,-4300.95 231,-4247.95 401,-4300.95 231,-4353.95"/>
<text text-anchor="middle" x="231" y="-4312.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-4297.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-4282.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- out_proj_12&#45;&gt;residual1_12 -->
<g id="edge113" class="edge">
<title>out_proj_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M231,-4390.83C231,-4382.43 231,-4373.39 231,-4364.4"/>
<polygon fill="black" stroke="black" points="234.5,-4364.33 231,-4354.33 227.5,-4364.33 234.5,-4364.33"/>
</g>
<!-- ln2_12 -->
<g id="node127" class="node">
<title>ln2_12</title>
<polygon fill="none" stroke="black" points="316,-4210.95 146,-4210.95 146,-4157.95 316,-4157.95 316,-4210.95"/>
<text text-anchor="middle" x="231" y="-4195.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-4180.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-4165.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge114" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M231,-4247.73C231,-4238.77 231,-4229.65 231,-4221.25"/>
<polygon fill="black" stroke="black" points="234.5,-4221.06 231,-4211.06 227.5,-4221.06 234.5,-4221.06"/>
</g>
<!-- ffn1_12 -->
<g id="node128" class="node">
<title>ffn1_12</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-4120.95 16.5,-4120.95 16.5,-4037.95 445.5,-4037.95 445.5,-4120.95"/>
<text text-anchor="middle" x="231" y="-4105.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-4090.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-4075.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-4060.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="231" y="-4045.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_12&#45;&gt;ffn1_12 -->
<g id="edge115" class="edge">
<title>ln2_12&#45;&gt;ffn1_12</title>
<path fill="none" stroke="black" d="M231,-4157.73C231,-4149.68 231,-4140.49 231,-4131.33"/>
<polygon fill="black" stroke="black" points="234.5,-4131.06 231,-4121.06 227.5,-4131.06 234.5,-4131.06"/>
</g>
<!-- gelu_12 -->
<g id="node129" class="node">
<title>gelu_12</title>
<polygon fill="none" stroke="black" points="316,-4000.95 146,-4000.95 146,-3947.95 316,-3947.95 316,-4000.95"/>
<text text-anchor="middle" x="231" y="-3985.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-3970.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-3955.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn1_12&#45;&gt;gelu_12 -->
<g id="edge116" class="edge">
<title>ffn1_12&#45;&gt;gelu_12</title>
<path fill="none" stroke="black" d="M231,-4037.74C231,-4028.95 231,-4019.72 231,-4011.13"/>
<polygon fill="black" stroke="black" points="234.5,-4011.05 231,-4001.05 227.5,-4011.05 234.5,-4011.05"/>
</g>
<!-- ffn2_12 -->
<g id="node130" class="node">
<title>ffn2_12</title>
<polygon fill="lightyellow" stroke="black" points="406,-3910.95 56,-3910.95 56,-3827.95 406,-3827.95 406,-3910.95"/>
<text text-anchor="middle" x="231" y="-3895.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-3880.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-3865.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-3850.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
<text text-anchor="middle" x="231" y="-3835.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_12&#45;&gt;ffn2_12 -->
<g id="edge117" class="edge">
<title>gelu_12&#45;&gt;ffn2_12</title>
<path fill="none" stroke="black" d="M231,-3947.73C231,-3939.68 231,-3930.49 231,-3921.33"/>
<polygon fill="black" stroke="black" points="234.5,-3921.06 231,-3911.06 227.5,-3921.06 234.5,-3921.06"/>
</g>
<!-- residual2_12 -->
<g id="node131" class="node">
<title>residual2_12</title>
<polygon fill="none" stroke="black" points="231,-3790.95 61,-3737.95 231,-3684.95 401,-3737.95 231,-3790.95"/>
<text text-anchor="middle" x="231" y="-3749.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-3734.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-3719.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn2_12&#45;&gt;residual2_12 -->
<g id="edge118" class="edge">
<title>ffn2_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M231,-3827.83C231,-3819.43 231,-3810.39 231,-3801.4"/>
<polygon fill="black" stroke="black" points="234.5,-3801.33 231,-3791.33 227.5,-3801.33 234.5,-3801.33"/>
</g>
<!-- ln1_13 -->
<g id="node132" class="node">
<title>ln1_13</title>
<polygon fill="none" stroke="black" points="316,-3597.95 146,-3597.95 146,-3544.95 316,-3544.95 316,-3597.95"/>
<text text-anchor="middle" x="231" y="-3582.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-3567.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-3552.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- residual2_12&#45;&gt;ln1_13 -->
<g id="edge158" class="edge">
<title>residual2_12&#45;&gt;ln1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-3684.9C231,-3659.88 231,-3630.52 231,-3608.07"/>
<polygon fill="black" stroke="black" points="234.5,-3607.98 231,-3597.98 227.5,-3607.98 234.5,-3607.98"/>
<text text-anchor="middle" x="299" y="-3655.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="299" y="-3640.75" font-family="Times,serif" font-size="14.00">GPU 12 &#45;&gt; GPU 13</text>
</g>
<!-- qkv_proj_13 -->
<g id="node133" class="node">
<title>qkv_proj_13</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-3507.95 16.5,-3507.95 16.5,-3424.95 445.5,-3424.95 445.5,-3507.95"/>
<text text-anchor="middle" x="231" y="-3492.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-3477.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-3462.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-3447.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="231" y="-3432.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_13&#45;&gt;qkv_proj_13 -->
<g id="edge119" class="edge">
<title>ln1_13&#45;&gt;qkv_proj_13</title>
<path fill="none" stroke="black" d="M231,-3544.73C231,-3536.68 231,-3527.49 231,-3518.33"/>
<polygon fill="black" stroke="black" points="234.5,-3518.06 231,-3508.06 227.5,-3518.06 234.5,-3518.06"/>
</g>
<!-- mha_13 -->
<g id="node134" class="node">
<title>mha_13</title>
<polygon fill="none" stroke="black" points="406,-3387.95 56,-3387.95 56,-3319.95 406,-3319.95 406,-3387.95"/>
<text text-anchor="middle" x="231" y="-3372.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-3357.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-3342.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-3327.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- qkv_proj_13&#45;&gt;mha_13 -->
<g id="edge120" class="edge">
<title>qkv_proj_13&#45;&gt;mha_13</title>
<path fill="none" stroke="black" d="M231,-3424.93C231,-3416.26 231,-3407.06 231,-3398.28"/>
<polygon fill="black" stroke="black" points="234.5,-3398.22 231,-3388.22 227.5,-3398.22 234.5,-3398.22"/>
</g>
<!-- out_proj_13 -->
<g id="node135" class="node">
<title>out_proj_13</title>
<polygon fill="lightyellow" stroke="black" points="406,-3282.95 56,-3282.95 56,-3199.95 406,-3199.95 406,-3282.95"/>
<text text-anchor="middle" x="231" y="-3267.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-3252.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-3237.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-3222.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="231" y="-3207.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_13&#45;&gt;out_proj_13 -->
<g id="edge121" class="edge">
<title>mha_13&#45;&gt;out_proj_13</title>
<path fill="none" stroke="black" d="M231,-3319.8C231,-3311.39 231,-3302.17 231,-3293.11"/>
<polygon fill="black" stroke="black" points="234.5,-3293.01 231,-3283.01 227.5,-3293.01 234.5,-3293.01"/>
</g>
<!-- residual1_13 -->
<g id="node136" class="node">
<title>residual1_13</title>
<polygon fill="none" stroke="black" points="231,-3162.95 61,-3109.95 231,-3056.95 401,-3109.95 231,-3162.95"/>
<text text-anchor="middle" x="231" y="-3121.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-3106.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-3091.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- out_proj_13&#45;&gt;residual1_13 -->
<g id="edge122" class="edge">
<title>out_proj_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M231,-3199.83C231,-3191.43 231,-3182.39 231,-3173.4"/>
<polygon fill="black" stroke="black" points="234.5,-3173.33 231,-3163.33 227.5,-3173.33 234.5,-3173.33"/>
</g>
<!-- ln2_13 -->
<g id="node137" class="node">
<title>ln2_13</title>
<polygon fill="none" stroke="black" points="316,-3019.95 146,-3019.95 146,-2966.95 316,-2966.95 316,-3019.95"/>
<text text-anchor="middle" x="231" y="-3004.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-2989.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-2974.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge123" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M231,-3056.73C231,-3047.77 231,-3038.65 231,-3030.25"/>
<polygon fill="black" stroke="black" points="234.5,-3030.06 231,-3020.06 227.5,-3030.06 234.5,-3030.06"/>
</g>
<!-- ffn1_13 -->
<g id="node138" class="node">
<title>ffn1_13</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-2929.95 16.5,-2929.95 16.5,-2846.95 445.5,-2846.95 445.5,-2929.95"/>
<text text-anchor="middle" x="231" y="-2914.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-2899.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-2884.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-2869.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="231" y="-2854.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_13&#45;&gt;ffn1_13 -->
<g id="edge124" class="edge">
<title>ln2_13&#45;&gt;ffn1_13</title>
<path fill="none" stroke="black" d="M231,-2966.73C231,-2958.68 231,-2949.49 231,-2940.33"/>
<polygon fill="black" stroke="black" points="234.5,-2940.06 231,-2930.06 227.5,-2940.06 234.5,-2940.06"/>
</g>
<!-- gelu_13 -->
<g id="node139" class="node">
<title>gelu_13</title>
<polygon fill="none" stroke="black" points="316,-2809.95 146,-2809.95 146,-2756.95 316,-2756.95 316,-2809.95"/>
<text text-anchor="middle" x="231" y="-2794.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-2779.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-2764.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn1_13&#45;&gt;gelu_13 -->
<g id="edge125" class="edge">
<title>ffn1_13&#45;&gt;gelu_13</title>
<path fill="none" stroke="black" d="M231,-2846.74C231,-2837.95 231,-2828.72 231,-2820.13"/>
<polygon fill="black" stroke="black" points="234.5,-2820.05 231,-2810.05 227.5,-2820.05 234.5,-2820.05"/>
</g>
<!-- ffn2_13 -->
<g id="node140" class="node">
<title>ffn2_13</title>
<polygon fill="lightyellow" stroke="black" points="406,-2719.95 56,-2719.95 56,-2636.95 406,-2636.95 406,-2719.95"/>
<text text-anchor="middle" x="231" y="-2704.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-2689.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-2674.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-2659.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
<text text-anchor="middle" x="231" y="-2644.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_13&#45;&gt;ffn2_13 -->
<g id="edge126" class="edge">
<title>gelu_13&#45;&gt;ffn2_13</title>
<path fill="none" stroke="black" d="M231,-2756.73C231,-2748.68 231,-2739.49 231,-2730.33"/>
<polygon fill="black" stroke="black" points="234.5,-2730.06 231,-2720.06 227.5,-2730.06 234.5,-2730.06"/>
</g>
<!-- residual2_13 -->
<g id="node141" class="node">
<title>residual2_13</title>
<polygon fill="none" stroke="black" points="231,-2599.95 61,-2546.95 231,-2493.95 401,-2546.95 231,-2599.95"/>
<text text-anchor="middle" x="231" y="-2558.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-2543.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-2528.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn2_13&#45;&gt;residual2_13 -->
<g id="edge127" class="edge">
<title>ffn2_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M231,-2636.83C231,-2628.43 231,-2619.39 231,-2610.4"/>
<polygon fill="black" stroke="black" points="234.5,-2610.33 231,-2600.33 227.5,-2610.33 234.5,-2610.33"/>
</g>
<!-- ln1_14 -->
<g id="node142" class="node">
<title>ln1_14</title>
<polygon fill="none" stroke="black" points="316,-2406.95 146,-2406.95 146,-2353.95 316,-2353.95 316,-2406.95"/>
<text text-anchor="middle" x="231" y="-2391.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-2376.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-2361.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- residual2_13&#45;&gt;ln1_14 -->
<g id="edge159" class="edge">
<title>residual2_13&#45;&gt;ln1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-2493.9C231,-2468.88 231,-2439.52 231,-2417.07"/>
<polygon fill="black" stroke="black" points="234.5,-2416.98 231,-2406.98 227.5,-2416.98 234.5,-2416.98"/>
<text text-anchor="middle" x="299" y="-2464.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="299" y="-2449.75" font-family="Times,serif" font-size="14.00">GPU 13 &#45;&gt; GPU 14</text>
</g>
<!-- qkv_proj_14 -->
<g id="node143" class="node">
<title>qkv_proj_14</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-2316.95 16.5,-2316.95 16.5,-2233.95 445.5,-2233.95 445.5,-2316.95"/>
<text text-anchor="middle" x="231" y="-2301.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-2286.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-2271.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-2256.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="231" y="-2241.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_14&#45;&gt;qkv_proj_14 -->
<g id="edge128" class="edge">
<title>ln1_14&#45;&gt;qkv_proj_14</title>
<path fill="none" stroke="black" d="M231,-2353.73C231,-2345.68 231,-2336.49 231,-2327.33"/>
<polygon fill="black" stroke="black" points="234.5,-2327.06 231,-2317.06 227.5,-2327.06 234.5,-2327.06"/>
</g>
<!-- mha_14 -->
<g id="node144" class="node">
<title>mha_14</title>
<polygon fill="none" stroke="black" points="406,-2196.95 56,-2196.95 56,-2128.95 406,-2128.95 406,-2196.95"/>
<text text-anchor="middle" x="231" y="-2181.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-2166.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-2151.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-2136.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- qkv_proj_14&#45;&gt;mha_14 -->
<g id="edge129" class="edge">
<title>qkv_proj_14&#45;&gt;mha_14</title>
<path fill="none" stroke="black" d="M231,-2233.93C231,-2225.26 231,-2216.06 231,-2207.28"/>
<polygon fill="black" stroke="black" points="234.5,-2207.22 231,-2197.22 227.5,-2207.22 234.5,-2207.22"/>
</g>
<!-- out_proj_14 -->
<g id="node145" class="node">
<title>out_proj_14</title>
<polygon fill="lightyellow" stroke="black" points="406,-2091.95 56,-2091.95 56,-2008.95 406,-2008.95 406,-2091.95"/>
<text text-anchor="middle" x="231" y="-2076.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-2061.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-2046.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-2031.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="231" y="-2016.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_14&#45;&gt;out_proj_14 -->
<g id="edge130" class="edge">
<title>mha_14&#45;&gt;out_proj_14</title>
<path fill="none" stroke="black" d="M231,-2128.8C231,-2120.39 231,-2111.17 231,-2102.11"/>
<polygon fill="black" stroke="black" points="234.5,-2102.01 231,-2092.01 227.5,-2102.01 234.5,-2102.01"/>
</g>
<!-- residual1_14 -->
<g id="node146" class="node">
<title>residual1_14</title>
<polygon fill="none" stroke="black" points="231,-1971.95 61,-1918.95 231,-1865.95 401,-1918.95 231,-1971.95"/>
<text text-anchor="middle" x="231" y="-1930.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-1915.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-1900.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- out_proj_14&#45;&gt;residual1_14 -->
<g id="edge131" class="edge">
<title>out_proj_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M231,-2008.83C231,-2000.43 231,-1991.39 231,-1982.4"/>
<polygon fill="black" stroke="black" points="234.5,-1982.33 231,-1972.33 227.5,-1982.33 234.5,-1982.33"/>
</g>
<!-- ln2_14 -->
<g id="node147" class="node">
<title>ln2_14</title>
<polygon fill="none" stroke="black" points="316,-1828.95 146,-1828.95 146,-1775.95 316,-1775.95 316,-1828.95"/>
<text text-anchor="middle" x="231" y="-1813.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-1798.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-1783.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge132" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M231,-1865.73C231,-1856.77 231,-1847.65 231,-1839.25"/>
<polygon fill="black" stroke="black" points="234.5,-1839.06 231,-1829.06 227.5,-1839.06 234.5,-1839.06"/>
</g>
<!-- ffn1_14 -->
<g id="node148" class="node">
<title>ffn1_14</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-1738.95 16.5,-1738.95 16.5,-1655.95 445.5,-1655.95 445.5,-1738.95"/>
<text text-anchor="middle" x="231" y="-1723.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-1708.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-1693.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-1678.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="231" y="-1663.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_14&#45;&gt;ffn1_14 -->
<g id="edge133" class="edge">
<title>ln2_14&#45;&gt;ffn1_14</title>
<path fill="none" stroke="black" d="M231,-1775.73C231,-1767.68 231,-1758.49 231,-1749.33"/>
<polygon fill="black" stroke="black" points="234.5,-1749.06 231,-1739.06 227.5,-1749.06 234.5,-1749.06"/>
</g>
<!-- gelu_14 -->
<g id="node149" class="node">
<title>gelu_14</title>
<polygon fill="none" stroke="black" points="316,-1618.95 146,-1618.95 146,-1565.95 316,-1565.95 316,-1618.95"/>
<text text-anchor="middle" x="231" y="-1603.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-1588.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-1573.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn1_14&#45;&gt;gelu_14 -->
<g id="edge134" class="edge">
<title>ffn1_14&#45;&gt;gelu_14</title>
<path fill="none" stroke="black" d="M231,-1655.74C231,-1646.95 231,-1637.72 231,-1629.13"/>
<polygon fill="black" stroke="black" points="234.5,-1629.05 231,-1619.05 227.5,-1629.05 234.5,-1629.05"/>
</g>
<!-- ffn2_14 -->
<g id="node150" class="node">
<title>ffn2_14</title>
<polygon fill="lightyellow" stroke="black" points="406,-1528.95 56,-1528.95 56,-1445.95 406,-1445.95 406,-1528.95"/>
<text text-anchor="middle" x="231" y="-1513.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-1498.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-1483.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-1468.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
<text text-anchor="middle" x="231" y="-1453.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_14&#45;&gt;ffn2_14 -->
<g id="edge135" class="edge">
<title>gelu_14&#45;&gt;ffn2_14</title>
<path fill="none" stroke="black" d="M231,-1565.73C231,-1557.68 231,-1548.49 231,-1539.33"/>
<polygon fill="black" stroke="black" points="234.5,-1539.06 231,-1529.06 227.5,-1539.06 234.5,-1539.06"/>
</g>
<!-- residual2_14 -->
<g id="node151" class="node">
<title>residual2_14</title>
<polygon fill="none" stroke="black" points="231,-1408.95 61,-1355.95 231,-1302.95 401,-1355.95 231,-1408.95"/>
<text text-anchor="middle" x="231" y="-1367.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-1352.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-1337.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn2_14&#45;&gt;residual2_14 -->
<g id="edge136" class="edge">
<title>ffn2_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M231,-1445.83C231,-1437.43 231,-1428.39 231,-1419.4"/>
<polygon fill="black" stroke="black" points="234.5,-1419.33 231,-1409.33 227.5,-1419.33 234.5,-1419.33"/>
</g>
<!-- ln1_15 -->
<g id="node152" class="node">
<title>ln1_15</title>
<polygon fill="none" stroke="black" points="316,-1215.95 146,-1215.95 146,-1162.95 316,-1162.95 316,-1215.95"/>
<text text-anchor="middle" x="231" y="-1200.75" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="231" y="-1185.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-1170.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- residual2_14&#45;&gt;ln1_15 -->
<g id="edge160" class="edge">
<title>residual2_14&#45;&gt;ln1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M231,-1302.9C231,-1277.88 231,-1248.52 231,-1226.07"/>
<polygon fill="black" stroke="black" points="234.5,-1225.98 231,-1215.98 227.5,-1225.98 234.5,-1225.98"/>
<text text-anchor="middle" x="299" y="-1273.75" font-family="Times,serif" font-size="14.00">Data Transfer</text>
<text text-anchor="middle" x="299" y="-1258.75" font-family="Times,serif" font-size="14.00">GPU 14 &#45;&gt; GPU 15</text>
</g>
<!-- qkv_proj_15 -->
<g id="node153" class="node">
<title>qkv_proj_15</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-1125.95 16.5,-1125.95 16.5,-1042.95 445.5,-1042.95 445.5,-1125.95"/>
<text text-anchor="middle" x="231" y="-1110.75" font-family="Times,serif" font-size="14.00">QKV Projection</text>
<text text-anchor="middle" x="231" y="-1095.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-1080.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576/16=1536]</text>
<text text-anchor="middle" x="231" y="-1065.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="231" y="-1050.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln1_15&#45;&gt;qkv_proj_15 -->
<g id="edge137" class="edge">
<title>ln1_15&#45;&gt;qkv_proj_15</title>
<path fill="none" stroke="black" d="M231,-1162.73C231,-1154.68 231,-1145.49 231,-1136.33"/>
<polygon fill="black" stroke="black" points="234.5,-1136.06 231,-1126.06 227.5,-1136.06 234.5,-1136.06"/>
</g>
<!-- mha_15 -->
<g id="node154" class="node">
<title>mha_15</title>
<polygon fill="none" stroke="black" points="406,-1005.95 56,-1005.95 56,-937.95 406,-937.95 406,-1005.95"/>
<text text-anchor="middle" x="231" y="-990.75" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="231" y="-975.75" font-family="Times,serif" font-size="14.00">16 heads, 512 dim each</text>
<text text-anchor="middle" x="231" y="-960.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 1536]</text>
<text text-anchor="middle" x="231" y="-945.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- qkv_proj_15&#45;&gt;mha_15 -->
<g id="edge138" class="edge">
<title>qkv_proj_15&#45;&gt;mha_15</title>
<path fill="none" stroke="black" d="M231,-1042.93C231,-1034.26 231,-1025.06 231,-1016.28"/>
<polygon fill="black" stroke="black" points="234.5,-1016.22 231,-1006.22 227.5,-1016.22 234.5,-1016.22"/>
</g>
<!-- out_proj_15 -->
<g id="node155" class="node">
<title>out_proj_15</title>
<polygon fill="lightyellow" stroke="black" points="406,-900.95 56,-900.95 56,-817.95 406,-817.95 406,-900.95"/>
<text text-anchor="middle" x="231" y="-885.75" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="231" y="-870.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-855.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-840.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="231" y="-825.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- mha_15&#45;&gt;out_proj_15 -->
<g id="edge139" class="edge">
<title>mha_15&#45;&gt;out_proj_15</title>
<path fill="none" stroke="black" d="M231,-937.8C231,-929.39 231,-920.17 231,-911.11"/>
<polygon fill="black" stroke="black" points="234.5,-911.01 231,-901.01 227.5,-911.01 234.5,-911.01"/>
</g>
<!-- residual1_15 -->
<g id="node156" class="node">
<title>residual1_15</title>
<polygon fill="none" stroke="black" points="231,-780.95 61,-727.95 231,-674.95 401,-727.95 231,-780.95"/>
<text text-anchor="middle" x="231" y="-739.25" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="231" y="-724.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-709.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- out_proj_15&#45;&gt;residual1_15 -->
<g id="edge140" class="edge">
<title>out_proj_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M231,-817.83C231,-809.43 231,-800.39 231,-791.4"/>
<polygon fill="black" stroke="black" points="234.5,-791.33 231,-781.33 227.5,-791.33 234.5,-791.33"/>
</g>
<!-- ln2_15 -->
<g id="node157" class="node">
<title>ln2_15</title>
<polygon fill="none" stroke="black" points="316,-637.95 146,-637.95 146,-584.95 316,-584.95 316,-637.95"/>
<text text-anchor="middle" x="231" y="-622.75" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="231" y="-607.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-592.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge141" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M231,-674.73C231,-665.77 231,-656.65 231,-648.25"/>
<polygon fill="black" stroke="black" points="234.5,-648.06 231,-638.06 227.5,-648.06 234.5,-648.06"/>
</g>
<!-- ffn1_15 -->
<g id="node158" class="node">
<title>ffn1_15</title>
<polygon fill="lightyellow" stroke="black" points="445.5,-547.95 16.5,-547.95 16.5,-464.95 445.5,-464.95 445.5,-547.95"/>
<text text-anchor="middle" x="231" y="-532.75" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="231" y="-517.75" font-family="Times,serif" font-size="14.00">Column Parallel</text>
<text text-anchor="middle" x="231" y="-502.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 32768/16=2048]</text>
<text text-anchor="middle" x="231" y="-487.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="231" y="-472.75" font-family="Times,serif" font-size="14.00">Type: Column Parallel</text>
</g>
<!-- ln2_15&#45;&gt;ffn1_15 -->
<g id="edge142" class="edge">
<title>ln2_15&#45;&gt;ffn1_15</title>
<path fill="none" stroke="black" d="M231,-584.73C231,-576.68 231,-567.49 231,-558.33"/>
<polygon fill="black" stroke="black" points="234.5,-558.06 231,-548.06 227.5,-558.06 234.5,-558.06"/>
</g>
<!-- gelu_15 -->
<g id="node159" class="node">
<title>gelu_15</title>
<polygon fill="none" stroke="black" points="316,-427.95 146,-427.95 146,-374.95 316,-374.95 316,-427.95"/>
<text text-anchor="middle" x="231" y="-412.75" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="231" y="-397.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048]</text>
<text text-anchor="middle" x="231" y="-382.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn1_15&#45;&gt;gelu_15 -->
<g id="edge143" class="edge">
<title>ffn1_15&#45;&gt;gelu_15</title>
<path fill="none" stroke="black" d="M231,-464.74C231,-455.95 231,-446.72 231,-438.13"/>
<polygon fill="black" stroke="black" points="234.5,-438.05 231,-428.05 227.5,-438.05 234.5,-438.05"/>
</g>
<!-- ffn2_15 -->
<g id="node160" class="node">
<title>ffn2_15</title>
<polygon fill="lightyellow" stroke="black" points="406,-337.95 56,-337.95 56,-254.95 406,-254.95 406,-337.95"/>
<text text-anchor="middle" x="231" y="-322.75" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="231" y="-307.75" font-family="Times,serif" font-size="14.00">Row Parallel</text>
<text text-anchor="middle" x="231" y="-292.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 2048] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-277.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
<text text-anchor="middle" x="231" y="-262.75" font-family="Times,serif" font-size="14.00">Type: Row Parallel</text>
</g>
<!-- gelu_15&#45;&gt;ffn2_15 -->
<g id="edge144" class="edge">
<title>gelu_15&#45;&gt;ffn2_15</title>
<path fill="none" stroke="black" d="M231,-374.73C231,-366.68 231,-357.49 231,-348.33"/>
<polygon fill="black" stroke="black" points="234.5,-348.06 231,-338.06 227.5,-348.06 234.5,-348.06"/>
</g>
<!-- residual2_15 -->
<g id="node161" class="node">
<title>residual2_15</title>
<polygon fill="none" stroke="black" points="231,-217.95 61,-164.95 231,-111.95 401,-164.95 231,-217.95"/>
<text text-anchor="middle" x="231" y="-176.25" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="231" y="-161.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="231" y="-146.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn2_15&#45;&gt;residual2_15 -->
<g id="edge145" class="edge">
<title>ffn2_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M231,-254.83C231,-246.43 231,-237.39 231,-228.4"/>
<polygon fill="black" stroke="black" points="234.5,-228.33 231,-218.33 227.5,-228.33 234.5,-228.33"/>
</g>
<!-- output -->
<g id="node162" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="231" cy="-37.48" rx="200.22" ry="37.45"/>
<text text-anchor="middle" x="231" y="-48.78" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="231" y="-33.78" font-family="Times,serif" font-size="14.00">[batch=1024, seq_len, hidden=8192]</text>
<text text-anchor="middle" x="231" y="-18.78" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- residual2_15&#45;&gt;output -->
<g id="edge161" class="edge">
<title>residual2_15&#45;&gt;output</title>
<path fill="none" stroke="black" d="M231,-111.83C231,-102.93 231,-93.73 231,-84.98"/>
<polygon fill="black" stroke="black" points="234.5,-84.96 231,-74.96 227.5,-84.96 234.5,-84.96"/>
</g>
</g>
</svg>
